function launchFG(e,t=null){let n=0,l=0;function i(e){let t="",n=0;if(e.startsWith("https://"))t="https://",n=8;else if(e.startsWith("http://"))t="http://",n=7;else{console.error("invalid link: make sure it starts with either http:// or https://");return}for(;n<e.length;n++){if("/"==e[n]){t+=e[n];break}t+=e[n]}return t}window.addEventListener("scroll",()=>{window.scrollTo(n,l)}),n=window.scrollX,l=window.scrollY;let o=!1,r=0,s=document.createElement("style");s.textContent="body { overflow: hidden; }",document.body.appendChild(s),window.addEventListener("beforeunload",function(e){e.preventDefault(),userHasUnsavedChanges&&(e.preventDefault(),e.returnValue="")});let a=document.createElement("style");a.textContent=' .sim-chrome-root * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial; } .sim-chrome-top { background: linear-gradient(#f6f7f8,#ededf0); height: 44px; display:flex; align-items:center; padding:0 8px; gap:8px; } .sim-chrome-tabs { display:flex; gap:2px; ms-overflow-style: none; scrollbar-width: none; align-items:center; padding:0; height: 32px; } .sim-chrome-tabs::-webkit-scrollbar { display:none; } .sim-tab { display:flex; align-items:center; gap:8px; padding:6px 10px; background:transparent; border-radius:6px; cursor:pointer; user-select:none; font-size:13px; color:#333; max-width:200px; min-width:185px; overflow:hidden; white-space:nowrap; text-overflow:ellipsis;} .sim-tab.active { background: rgba(0,0,0,0.06); box-shadow: inset 0 -1px 0 rgba(0,0,0,0.04); } .sim-tab .close { font-weight:700; color:#777; cursor:pointer; padding-left:6px; margin-left: auto;} .sim-address-row { display:flex; align-items:center; gap:8px; flex:1; margin: 0 8px; } .sim-url-input { flex:1; height:32px; border-radius:6px; border:1px solid rgba(0,0,0,0.12); padding:0 10px; font-size:14px; } .sim-proxy-input { flex:0.1; size:10; height:32px; border-radius:6px; border:1px solid rgba(0,0,0,0.12); padding:0 10px; font-size:14px; } .sim-open-btn, .sim-fullscreen-btn, .sim-netab-btn { height:28px; padding:0 12px; border-radius:12px; border:1px solid rgba(0,0,0,0.12); background:#fff; cursor:pointer; font-size:13px; } .sim-toolbar { display:flex; align-items:center; gap:8px; padding:8px; background: #fff; border-top: 1px solid rgba(0,0,0,0.06); } .sim-iframe { width:100%; height: calc(100% - 84px); border:0; background:#fff; padding:10} .sim-status { font-size:12px; color:#666; margin-left:8px; } /* Tiny responsive */ @media (max-width: 600px) { .sim-chrome-root { left:6px; right:6px; width:auto; height:480px; } } ',document.head.appendChild(a);var d=goldenbodywebsite;window.addEventListener("contextmenu",function(e){e.preventDefault()}),window.addEventListener("keydown",function(e){if(e.ctrlKey&&"n"===e.key)e.preventDefault(),("browser"==y||""==y)&&g();else if(e.ctrlKey&&e.shiftKey&&"W"===e.key&&"browser"==y){let t=[];for(let n=0;n<c.length;n++)t.push(c[n].rootElement._goldenbodyId);let l=Math.max(...t);for(let i=0;i<c.length;i++)c[i].rootElement._goldenbodyId==l&&(c[i].rootElement.remove(),c[i].rootElement=null,c.splice(i,1))}});var c=[],p=0,y="",u=e[2];let f=10;function m(e){e&&(e.style.zIndex=String(++f))}function h(){console.log([username,password,u])}function g(t=null,n=100,l=20,i=20){function s(e){return e===goldenbodywebsite+"newtab.html"?"goldenbody://newtab/":e.slice(55,e.length)}var a=null,f=0;let h=!1,x=!1;l<0&&(l=0),i<0&&(i=0),y="browser";let b=function u(){var $,E,k=document.createElement("div");k.className="sim-chrome-root",Object.assign(k.style,{position:"fixed",top:i+"px",left:l+"px",width:"1000px",height:"640px",boxShadow:"0 12px 40px rgba(0,0,0,0.35)",borderRadius:"10px",overflow:"hidden",background:"#ffffff"}),m(k),p++,k._goldenbodyId=p,k.tabIndex="0",k.addEventListener("keydown",e=>{e.ctrlKey&&"t"===e.key&&(e.preventDefault(),Q("goldenbody://newtab/","New Tab"))});let _=document.createElement("div");_.className="sim-chrome-top",_.style.justifyContent="space-between",k.appendChild(_),_.addEventListener("click",function(){m(k)});var C=!1;C||((C=document.createElement("div")).className="browserTopBar",C.style.display="flex",C.style.justifyContent="flex-end",C.style.alignItems="center",C.style.padding="2px",C.style.background="#ccc",C.style.cursor="move",C.style.flexShrink="0");var L=document.createElement("button");L.innerText="‎    –    ‎",L.title="Minimize",C.appendChild(L);var W=document.createElement("button");W.innerText="‎     □    ‎ ",W.title="Maximize/Restore",C.appendChild(W);var I=document.createElement("button");function z(){return{left:k.style.left,top:k.style.top,width:k.style.width,height:k.style.height,position:k.style.position||"fixed"}}I.innerText="‎     x    ‎ ",I.title="Close",I.style.color="white",I.style.backgroundColor="red",C.appendChild(I),[C,L,W,I].forEach(e=>{e.style.margin="0 2px",e.style.border="none",e.style.padding="2px 5px",e.style.fontSize="14px",e.style.cursor="pointer"});var K=z();function D(e){if("100%"===e.width&&"100%"===e.height){k.style.left=e.left,k.style.top=e.top,k.style.width="1000px",k.style.height="640px";return}k.style.position="absolute",k.style.left=e.left,k.style.top=e.top,k.style.width=e.width,k.style.height=e.height}L.addEventListener("click",function(){h||(K=z()),k.style.display="none",x=!0}),W.addEventListener("click",function(){h?(D(K),W.textContent="‎     □    ‎ ",h=!1):(K=z(),k.style.position="absolute",k.style.left="0",k.style.top="0",k.style.width="100%",k.style.height="calc(100% - 60px)",W.textContent="‎     ⧉    ‎ ",h=!0,isMinimized=!1)}),I.addEventListener("click",function(){k.remove(),k=null;let e=c.indexOf(b);-1!==e&&c.splice(e,1),_browserCalled=!1});let A=document.createElement("div");A.className="sim-chrome-tabs",A.style.flex="0 1 auto",A.style.minWidth="0px",A.style.overflowX="auto",A.style.whiteSpace="nowrap";let S=document.createElement("button");S.className="sim-open-btn",S.innerText="+",S.title="New tab",Object.assign(S.style,{width:"28px",padding:"6px",fontSize:"16px",display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:"0"});let T=document.createElement("div");T.className="sim-address-row",k.appendChild(T);let M=document.createElement("input");M.className="sim-url-input",M.type="text",M.placeholder="Enter URL (e.g. https://example.com)",M.autocapitalize="off",M.autocomplete="off",M.spellcheck=!1,T.appendChild(M);let N=document.createElement("button");N.className="sim-open-btn",N.innerText="Open",T.appendChild(N);var R=document.createElement("button");R.textContent="⟳",R.className="sim-open-btn",R.style.fontSize="20px",R.style.justifyContent="center",R.style.alignItems="center",T.prepend(R);var P=document.createElement("button");P.textContent="->",P.className="sim-open-btn",T.prepend(P);var X=document.createElement("button");X.textContent="<-",X.className="sim-open-btn",T.prepend(X);let H=document.createElement("button");H.className="sim-open-btn",H.innerText="⤢",H.title="Toggle fullscreen",T.prepend(H);let Y=document.createElement("div");Y.className="sim-status",Y.style.flex="0 0 auto",Y.innerText="";let F=document.createElement("div");F.style.backgroundColor="gray",F.style.position="absolute",F.style.width="5%",F.style.height="3%",F.style.left="85%",F.style.top="10%",F.style.zIndex="9999",F.style.display="none",T.prepend(F),k.addEventListener("mousedown",function(){F.style.display="none"});let B=f.resizeP;setInterval(()=>{B===f.resizeP&&(F.style.display="none"),B=f.resizeP},3e3);let O=document.createElement("div");O.style.display="flex",O.style.alignItems="center",O.style.gap="0px",O.style.flex="1",O.style.minWidth="0",O.appendChild(A),O.appendChild(Y),_.appendChild(O),_.appendChild(C),document.body.appendChild(k);let q=[],j=null,U=0;A.style.display="flex",A.style.flex="1 1 0",A.style.minWidth="0",A.style.flexWrap="nowrap",A.style.overflowX="auto",A.style.overflowY="hidden",O.style.flex="1 1 auto",O.style.minWidth="0",o=!1;let G="",V=0;function J(){for(var e=0;A.firstChild;)A.removeChild(A.firstChild);O.appendChild(S),q.forEach(t=>{let n=document.createElement("div");function l(e,t){let n=e.children,l=0;for(let i=0;i<n.length&&n[i]!==t;i++)l++;return l}n.style.flex="0 0 auto",n.id="id-"+e,e++,n.draggable=!0,n.name="tabs",n.style.minWidth="13.5%",n.style.maxWidth="13.5%",n.style.overflow="hidden",n.style.display="flex",n.style.whiteSpace="nowrap",n.tabIndex="0",n.setAttribute("draggable","true"),n.addEventListener("mouseup",function(){k.focus()}),n.addEventListener("mousedown",e=>{e.target.classList.contains("close")||Z(t.id)}),n.addEventListener("mouseup",function(){m(k)}),n.addEventListener("dragstart",()=>{o=!0,dragMoved=!1,r=q[V=l(A,n)],G=n.id;let e=(t,n)=>{if(!o)return;k.querySelector(`#${G}`);let l;try{l=t.target.closest(".sim-tab")}catch(i){}try{if("sim-chrome-tabs"===t.target.className||t.target.classList.contains("sim-tab")||t.target.classList.contains("sim-tab-title")||t.target.classList.contains("close")||t.target.classList.contains("sim-open-btn")){for(let s=0;s<c.length;s++){let a=t.target,d=null;for(;a;){if(a._goldenbodyId){d=a;break}a=a.parentElement}if(d===k){o=!1,dragMoved=!1,r=null,window.removeEventListener("mouseup",e);return}try{c[s].rootElement._goldenbodyId===d._goldenbodyId&&c[s].addTab(r.url,"",r.resizeP)}catch(p){}}ee(r.id),o=!1,dragMoved=!1,r=null,window.removeEventListener("mouseup",e);return}}catch(y){}l&&l.id===G||(g(q[V].url,r.resizeP,t.clientX-100,t.clientY-20),ee(r.id)),o=!1,dragMoved=!1,r=null,window.removeEventListener("mouseup",e)};window.addEventListener("mouseup",e),window.addEventListener("message",t=>{let n=t.data;if(n?.type==="iframe-mouseup"){console.log("Mouseup from iframe:"),console.log("Coordinates:",n.x,n.y),console.log("Button pressed:",n.button);let l={clientX:n.x,clientY:n.y,pageX:n.pageX,pageY:n.pageY,button:n.button,buttons:n.buttons,altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey};e(l,!0)}})}),n.addEventListener("mousemove",()=>{o&&(dragMoved=!0)}),n.addEventListener("mouseup",()=>{if(o&&dragMoved){let e=k.querySelector(`#${G}`);if(!e||e===n)return;let t=e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING,i=l(A,n);t&&i++,q=function e(t,n,l){if(-1===n||-1===l||n===l)return t;let[i]=t.splice(n,1);return n<l&&l--,t.splice(l,0,i),t}(q,V,i),A.insertBefore(e,t?n.nextSibling:n)}o=!1,r=null,dragMoved=!1});let i=n.querySelector(".sim-tab-title");i&&(i.style.textOverflow="ellipsis"),n.className="sim-tab"+(t.id===j?" active":""),n.title=t.title||"Untitled",n.innerHTML=`<span style='display: inline-block;overflow: hidden;white-space: nowrap; text-overflow: ellipsis;' class='sim-tab-title'>${t.title||"Untitled"}</span> <span class='close' title='Close tab'>&times;</span>`,n.querySelector(".close").addEventListener("click",e=>{e.stopPropagation(),ee(t.id)}),A.appendChild(n),A.appendChild(S)})}function Q(t,l,i=n){let o="tab-"+ ++U,r=document.createElement("iframe");r.onload=()=>{let e=r.contentDocument;e&&""!==e.body.innerHTML.trim()||(r.contentWindow.location=goldenbodywebsite+"connectionfailed.html")},r.addEventListener("load",function(){function t(e){var t,n;let l;t=e,n=p,t.ctrlKey&&("="===t.key||"+"===t.key)?(t.preventDefault(),n.resizeP+=5,n.resizeP>500&&(n.resizeP=500),F.style.display="block"):t.ctrlKey&&"-"===t.key?(t.preventDefault(),n.resizeP-=5,n.resizeP<25&&(n.resizeP=25),F.style.display="block"):F.style.display="none",(l=document.createElement("script")).textContent=`document.body.style.zoom = ${n.resizeP} + '%' || '100%'; // shrink page inside iframe`,n.iframe.contentDocument.head.appendChild(l)}p.iframe.contentWindow.postMessage({message:"GOLDENBODY_id",website:goldenbodywebsite,value:e[2]},"*"),p.iframe.contentWindow.addEventListener("keydown",t),k.addEventListener("keydown",t),M.value=s(r.contentWindow.location.href);let n=document.createElement("script");n.textContent=`document.body.style.zoom = ${p.resizeP} + '%' || '100%'; // shrink page inside iframe`,p.iframe.contentDocument.head.appendChild(n);var l=p.iframe.contentDocument.createElement("script");l.textContent='setInterval(function(){var _goldenbody = document.getElementsByTagName(\'a\'); for(let i = 0; i < _goldenbody.length; i++) {_goldenbody[i].target="_self";}},2000*1); function callParent(url) { window.parent.postMessage( { type: "FROM_IFRAME", message: url }, "*" ); } window.showOpenFilePicker = function(){alert(\'this feature is during construction, please use the drop files for now!\');}; ',p.iframe.contentDocument.head.appendChild(l)}),r.addEventListener("load",function e(){let t=r.contentDocument,n=r.contentWindow;t&&n&&(n.removeEventListener("keydown",n.erudaKeyHandler),n.erudaKeyHandler=function(e){if(e.ctrlKey&&e.shiftKey&&"i"===e.key.toLowerCase()){if(n.eruda)try{n._goldenbodyIns?(n.eruda.hide(),n._goldenbodyIns=!1):(n.eruda.show(),n._goldenbodyIns=!0)}catch(l){console.error(l)}else{r.contentWindow._goldenbodyIns=!0;let i=t.createElement("script");i.src="https://cdn.jsdelivr.net/npm/eruda",i.onload=()=>{n.eruda.init(),n.eruda.get("entryBtn").hide(),n.eruda.show()},t.head.appendChild(i)}}},n.addEventListener("keydown",n.erudaKeyHandler))});let a=setInterval(()=>{try{if(!r||!r.contentDocument){clearInterval(a),console.warn("Interval cleared: iframe is gone");return}if(p.url=s(r.contentWindow.location.href),"complete"!==r.contentDocument.readyState||p.donotm)p.title="Loading...";else{let e=r.contentDocument.title||"Untitled";p.title=e}}catch(t){clearInterval(a),console.warn("Interval cleared due to error:",t)}u!==p.title&&J(),u=p.title},1e3);r.tabIndex="0",r.className="sim-iframe",r.allow=" accelerometer; autoplay; camera; clipboard-read; clipboard-write; cross-origin-isolated; display-capture; encrypted-media; fullscreen; geolocation; gyroscope; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; sync-xhr; usb; web-share; xr-spatial-tracking; idle-detection; ",r.allowFullscreen=!0,r.sandbox="allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-presentation allow-same-origin allow-scripts",r.onload=function(){let e=r.contentDocument||r.contentWindow.document;r.contentWindow.addEventListener("keydown",function(e){if(e.ctrlKey&&"n"===e.key)e.preventDefault(),("browser"==y||""==y)&&g();else if(e.ctrlKey&&e.shiftKey&&"W"===e.key&&"browser"==y){let t=[];for(let n=0;n<c.length;n++)t.push(c[n].rootElement._goldenbodyId);let l=Math.max(...t);for(let i=0;i<c.length;i++)c[i].rootElement._goldenbodyId==l&&(c[i].rootElement.remove(),c[i].rootElement=null,c.splice(i,1))}else e.ctrlKey&&"t"===e.key&&(e.preventDefault(),Q("goldenbody://newtab/","New Tab"))});let t=e.createElement("div");function n(n,i,o,s){if(s){t.innerHTML="";let a=e.createElement("div");a.style.all="unset",a.textContent="Open link in new tabㅤㅤㅤㅤㅤ",a.style.display="block",a.style.textAlign="left",a.style.padding="6px 16px",a.style.cursor="pointer",a.onmouseenter=()=>a.style.background="#444",a.style.font="Arial",a.onmouseleave=()=>a.style.background="none",a.onclick=()=>{Q(o.href,"New Tab"),l()},t.appendChild(a);let d=e.createElement("div");d.style.all="unset",d.textContent="Open link in new windowㅤㅤㅤㅤㅤ",d.style.display="block",d.style.textAlign="left",d.style.padding="6px 16px",d.style.cursor="pointer",d.onmouseenter=()=>d.style.background="#444",d.style.font="Arial",d.onmouseleave=()=>d.style.background="none",d.onclick=()=>{g(o.href),l()},t.appendChild(d);let c=e.createElement("div");c.style.all="unset",c.style.display="block",c.style.textAlign="left",c.textContent="Copy link address",c.style.padding="6px 16px",c.style.cursor="pointer",c.style.font="Arial",c.onmouseenter=()=>c.style.background="#444",c.onmouseleave=()=>c.style.background="none",c.onclick=async()=>{await navigator.clipboard.writeText(o.href),l()},t.appendChild(c);let y=e.createElement("div");y.style.all="unset",y.style.display="block",y.style.textAlign="left",y.textContent="inspect ㅤㅤㅤㅤㅤㅤㅤㅤCtrl+Shift+I",y.style.padding="6px 16px",y.style.font="Arial",y.style.cursor="pointer",y.onmouseenter=()=>y.style.background="#444",y.onmouseleave=()=>y.style.background="none",y.onclick=()=>{let e=p.iframe.contentWindow,t=p.iframe.contentDocument;if(e){if(!e.eruda){p.iframe.contentWindow._goldenbodyIns=!0;let n=t.createElement("script");n.src="https://cdn.jsdelivr.net/npm/eruda",n.onload=()=>{e.eruda.init(),e.eruda.get("entryBtn").hide(),e.eruda.show()},t.head.appendChild(n)}e.eruda[e._goldenbodyIns?"hide":"show"](),e._goldenbodyIns=!e._goldenbodyIns,l()}},t.appendChild(y),t.style.left="-9999px",t.style.top="-9999px",t.style.display="block";let u=t.getBoundingClientRect(),f=e.documentElement.clientWidth,m=e.documentElement.clientHeight,h=n,x=i;n+u.width>f&&(h=n-u.width),i+u.height>m&&(x=i-u.height),t.style.left=`${Math.max(0,h)}px`,t.style.top=`${Math.max(0,x)}px`}else{t.innerHTML="",t.style.display="block";let b=e.createElement("div");b.style.all="unset",b.style.display="block",b.textContent="Backㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤ",b.style.padding="6px 16px",b.style.textAlign="left",b.style.font="Arial",b.style.cursor="pointer",b.onmouseenter=()=>b.style.background="#444",b.onmouseleave=()=>b.style.background="none",b.onclick=()=>{r.contentWindow.history.back(),l()},t.appendChild(b);let w=e.createElement("div");w.style.all="unset",w.style.display="block",w.style.textAlign="left",w.textContent="Forward",w.style.font="Arial",w.style.padding="6px 16px",w.style.cursor="pointer",w.onmouseenter=()=>w.style.background="#444",w.onmouseleave=()=>w.style.background="none",w.onclick=()=>{r.contentWindow.history.forward(),l()},t.appendChild(w);let $=e.createElement("div");$.style.all="unset",$.style.display="block",$.style.textAlign="left",$.textContent="Reload",$.style.padding="6px 16px",$.style.font="Arial",$.style.cursor="pointer",$.onmouseenter=()=>$.style.background="#444",$.onmouseleave=()=>$.style.background="none",$.onclick=()=>{r.contentWindow.location.reload(),l()},t.appendChild($);let E=e.createElement("div");E.style.all="unset",E.style.display="block",E.style.textAlign="left",E.textContent="inspect ㅤㅤㅤㅤㅤㅤㅤㅤCtrl+Shift+I",E.style.padding="6px 16px",E.style.font="Arial",E.style.cursor="pointer",E.onmouseenter=()=>E.style.background="#444",E.onmouseleave=()=>E.style.background="none",E.onclick=()=>{let e=p.iframe.contentWindow,t=p.iframe.contentDocument;if(e){if(!e.eruda){p.iframe.contentWindow._goldenbodyIns=!0;let n=t.createElement("script");n.src="https://cdn.jsdelivr.net/npm/eruda",n.onload=()=>{e.eruda.init(),e.eruda.get("entryBtn").hide(),e.eruda.show()},t.head.appendChild(n)}e.eruda[e._goldenbodyIns?"hide":"show"](),e._goldenbodyIns=!e._goldenbodyIns,l()}},t.appendChild(E),t.style.left="-9999px",t.style.top="-9999px",t.style.display="block";let k=t.getBoundingClientRect(),_=e.documentElement.clientWidth,C=e.documentElement.clientHeight,L=n,W=i;n+k.width>_&&(L=n-k.width),i+k.height>C&&(W=i-k.height),t.style.left=`${Math.max(0,L)}px`,t.style.top=`${Math.max(0,W)}px`}}function l(){t.style.display="none"}function i(e){let t=p.iframe.contentWindow;t.document.body.getBoundingClientRect();let n=e.clientX,l=e.clientY,i=e.view;for(;i&&i!==t;){let o=i.frameElement;if(!o)break;let r=o.getBoundingClientRect();n+=r.left,l+=r.top,i=i.parent}return{x:n,y:l}}function o(e){if(!e)return;let t=e.querySelectorAll("iframe");for(let s of t)try{try{let a=s.contentWindow;function d(){s.contentWindow.removeEventListener("keydown",s.contentWindow.handleArrows),s.contentWindow.addEventListener("keydown",s.contentWindow.handleArrows),s.contentWindow.removeEventListener("mouseup",s.contentWindow.onMouseUp),s.contentWindow.addEventListener("mouseup",s.contentWindow.onMouseUp),a.removeEventListener("keydown",a.suberudaKeyHandler),a.addEventListener("keydown",a.suberudaKeyHandler),s.contentWindow.removeEventListener("contextmenu",a.contextMenuHandler),s.contentWindow.addEventListener("contextmenu",a.contextMenuHandler)}a.handleArrows||(a.handleArrows=function(e){if(document.activeElement===s&&e.ctrlKey&&e.altKey){if(e.preventDefault(),"ArrowRight"===e.key){let t=0,n="";for(let l=0;l<q.length;l++)q[l].id===f.id&&(t=l),l-t==1&&(n=q[l].id);Z(n)}else if("ArrowLeft"===e.key){let i=0;for(let o=0;o<q.length;o++){let r=o;if(q[o].id===f.id){Z(q[i].id);break}i=r}}}}),s.contentDocument.addEventListener("keydown",function(){document.activeElement.focus()}),s.contentDocument.addEventListener("click",l),s.contentWindow.onMouseUp||(s.contentWindow.onMouseUp=function(e){window.top.postMessage({type:"iframe-mouseup",x:e.clientX,y:e.clientY,pageX:e.pageX,pageY:e.pageY,button:e.button,buttons:e.buttons,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey},"*")}),a.contextMenuHandler||(a.contextMenuHandler=function(e){let t=null!==e.target.oncontextmenu;if(t||e.defaultPrevented)return;e.preventDefault(),e.stopPropagation();let{x:l,y:o}=i(e,s.contentDocument),r=e.target,a=r.closest("a");a&&a.href?(console.log("Right-clicked on a link:",a.href),n(l,o,a,!0)):(n(l,o,null,!1),console.log("Right-clicked on a non-link element."))}),p.iframe.contentWindow,a.tabIndex="0",a.suberudaKeyHandler||(a.erudaKeyHandler=function(t){if(t.ctrlKey&&t.shiftKey&&"i"===t.key.toLowerCase()){if(a.eruda)try{a._goldenbodyIns?(a.eruda.hide(),a._goldenbodyIns=!1):(a.eruda.show(),a._goldenbodyIns=!0)}catch(n){console.error(n)}else{r.contentWindow._goldenbodyIns=!0;let l=e.createElement("script");l.src="https://cdn.jsdelivr.net/npm/eruda",l.onload=()=>{a.eruda.init(),a.eruda.get("entryBtn").hide(),a.eruda.show()},e.head.appendChild(l)}}},a.suberudaKeyHandler=function(e){if(console.log("eruda eky handajfiohsdif"),e.ctrlKey&&e.shiftKey&&"i"===e.key.toLowerCase()||e.ctrlKey&&("+"===e.key||"="===e.key)||e.ctrlKey&&"-"===e.key){s.contentWindow.parent!==window&&document.activeElement.contentDocument.body.focus();return}}),d()}catch(c){}s.contentDocument&&"complete"===s.contentDocument.readyState&&o(s.contentDocument)}catch(y){console.warn("Blocked or cross-origin iframe:",s.src)}}t.style.all="unset",t.id="custom-context-menu",t.style.display="block",t.style.position="fixed",t.style.background="#222",t.style.color="#fff",t.style.padding="8px 0",t.style.borderRadius="6px",t.style.boxShadow="0 2px 10px rgba(0,0,0,0.3)",t.style.fontFamily="sans-serif",t.style.fontSize="14px",t.style.display="none",t.style.zIndex="9999",e.body.appendChild(t),window.addEventListener("mousedown",function(){t.style.display="none"}),console.log("keydown handler attached"),k.addEventListener("keydown",e=>{e.ctrlKey&&e.shiftKey&&"i"===e.key.toLowerCase()&&console.log("fired!")}),r.contentWindow.addEventListener("contextmenu",function(e){let t=null!==e.target.oncontextmenu;if(t&&e.defaultPrevented)return;e.preventDefault(),e.stopPropagation();let l=e.target,i=l.closest("a");i&&i.href?(console.log("Right-clicked on a link:",i.href),n(e.pageX,e.pageY,i,!0)):(n(e.pageX,e.pageY,null,!1),console.log("Right-clicked on a non-link element."))});let s=setInterval(()=>{try{if(!r||!r.contentDocument){clearInterval(s),console.warn("Recurse interval cleared: iframe missing");return}o(k)}catch(e){clearInterval(s),console.warn("Recurse interval cleared due to error:",e)}},2e3);o(r.contentDocument),e.addEventListener("click",l)},""!=d?r.src=w(t,d):r.src=t,r.style.display="none",k.appendChild(r);let p={id:o,url:t,title:l,iframe:r,resizeP:i,loadedurl:t,donotm:!1},u=p.title;return p.title="Loading...",q.push(p),Z(o),J(),document.addEventListener("keyup",function(e){if(k.contains(document.activeElement)&&e.ctrlKey&&e.shiftKey&&"i"===e.key.toLowerCase()){e.preventDefault(),e.stopPropagation();let t=p.iframe.contentWindow,n=p.iframe.contentDocument;if(t){if(!t.eruda){p.iframe.contentWindow._goldenbodyIns=!0;let l=n.createElement("script");l.src="https://cdn.jsdelivr.net/npm/eruda",l.onload=()=>{t.eruda.init(),t.eruda.get("entryBtn").hide(),t.eruda.show()},n.head.appendChild(l)}t.eruda[t._goldenbodyIns?"hide":"show"](),t._goldenbodyIns=!t._goldenbodyIns}}}),o}function Z(e){try{clearInterval(a)}catch(t){}let n=q.find(t=>t.id===e);if(!n)return;n.iframe.contentWindow.addEventListener("keydown",function(t){t.ctrlKey&&"w"===t.key&&"none"!==n.iframe.style.display&&ee(e)}),k.addEventListener("keydown",function(t){t.ctrlKey&&"w"===t.key&&"none"!==n.iframe.style.display&&ee(e)}),k.focus(),q.forEach(e=>e.iframe.style.display="none"),n.iframe.style.display="block",X.onclick=function(){n.iframe.contentWindow.history.back()},P.onclick=function(){n.iframe.contentWindow.history.forward()},R.onclick=function(){"x"===R.textContent?n.iframe.contentWindow.stop():n.iframe.contentWindow.location.reload()},j=e,M.value=s(n.iframe.contentWindow.location.href);let l=s(n.iframe.contentWindow.location.href),i=n.title;a=setInterval(()=>{0==c.length&&clearInterval(a);try{let e=s(n.iframe.contentWindow.location.href);if(e!==l&&(l=e,M.value=e),F.innerText=n.resizeP+"%",f=n,"complete"!==n.iframe.contentDocument.readyState)R.textContent="x",n.title="Loading...";else{R.textContent="⟳";try{if("complete"===n.iframe.contentDocument.readyState){let t=n.iframe.contentDocument&&n.iframe.contentDocument.title;n.title=t}}catch(o){}}i!==n.title&&J(),i=n.title}catch(r){console.error(r),clearInterval(a)}},250),J()}function ee(e){let t=q.findIndex(t=>t.id===e);if(-1===t)return;let n=q[t].id===j;q[t].iframe.remove(),q.splice(t,1),n?q.length?Z(q[Math.max(0,t-1)].id):function e(){k.remove(),k=null;let t=c.indexOf(b);-1!==t&&c.splice(t,1),_browserCalled=!1}():J()}function et(e){var t;let n=("/"!=(t=e)[t.length-1]&&(t+="/"),t[0]+t[1]+t[2]+t[3]+t[4]+t[5]+t[6]+t[7]=="https://"||t[0]+t[1]+t[2]+t[3]+t[4]+t[5]+t[6]=="http://"||t.startsWith("goldenbody://"))?t:"https://"+t,l=q.findIndex(e=>e.id===j);if(-1===l)return;q[l].url=n;let i=q[l];if(i.loadedurl=n,i.title="Loading...",q[l].iframe){if(n.startsWith("goldenbody://"))try{q[l].iframe.contentWindow.location.href=w(n,d)}catch(o){console.error(o),q[l].src=w(n,d)}else try{q[l].iframe.contentWindow.location.href=w(n,d)}catch(r){console.error(r),q[l].src=w(n,d)}}M.value=n,setTimeout(()=>Y.innerText="",3e3)}window.addEventListener("message",function(e){"FROM_IFRAME"===e.data.type&&Q(e.data.message,"New Tab")}),t&&Q(t,"New Tab"),window.addEventListener("keydown",function(e){if((document.activeElement===k||k.contains(document.activeElement))&&e.ctrlKey&&e.altKey){if(e.preventDefault(),"ArrowRight"===e.key){let t=0,n="";for(let l=0;l<q.length;l++)q[l].id===f.id&&(t=l),l-t==1&&(n=q[l].id);Z(n)}else if("ArrowLeft"===e.key){let i=0;for(let o=0;o<q.length;o++){let r=o;if(q[o].id===f.id){Z(q[i].id);break}i=r}}}}),t||Q("goldenbody://newtab/","New Tab"),N.addEventListener("click",()=>et(M.value)),M.addEventListener("keydown",e=>{"Enter"===e.key&&et(M.value)}),S.addEventListener("click",()=>{let e=Q("goldenbody://newtab/","New Tab");Z(e),M.focus()});let en=!1;async function el(){k.requestFullscreen?await k.requestFullscreen():k.webkitRequestFullscreen&&await k.webkitRequestFullscreen(),en=!0,H.innerText="⤡"}async function ei(){document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen&&await document.webkitExitFullscreen(),en=!1,H.innerText="⤢"}H.addEventListener("click",()=>{en?ei():el()});let eo,er,es,ea,ed;eo=!1,er=0,es=0,ea=0,ed=0,_.addEventListener("mousedown",e=>{e.target.closest(".sim-tab")||e.target===S||e.target===M||e.target===N||(eo=!0,er=e.clientX,es=e.clientY,ea=k.offsetLeft,ed=k.offsetTop,document.body.style.userSelect="none",$=e.clientX,E=e.clientY)}),window.addEventListener("mousemove",e=>{if(!eo){er=0,es=0;return}if((e.clientX-$>1&&eo||e.clientY-E>1&&eo)&&(D(K),h&&(k.style.left=e.clientX-k.clientWidth/2+"px",ea=e.clientX-k.clientWidth/2,W.textContent="‎     □    ‎ ",h=!1)),!eo)return;let t=e.clientX-er,n=e.clientY-es;k.style.left=ea+t+"px",ed+n>0?k.style.top=ed+n+"px":k.style.top="0px"}),window.addEventListener("mouseup",()=>{eo=!1,document.body.style.userSelect=""});let ec;return!function e(){let t=k;t.style.position||(t.style.position="fixed"),t.style.top||(t.style.top="20px"),t.style.left||(t.style.left="20px");let n=null,l="",i=e=>{let n=t.getBoundingClientRect(),l=e.clientX,i=e.clientY,o=l>=n.left&&l<=n.left+8,r=l<=n.right&&l>=n.right-8,s=i>=n.top&&i<=n.top+8,a=i<=n.bottom&&i>=n.bottom-8;return s&&o?"nw":s&&r?"ne":a&&o?"sw":a&&r?"se":o?"w":r?"e":s?"n":a?"s":""};t.addEventListener("pointermove",e=>{if(n)return;let l=i(e);t.style.cursor="nw"===l||"se"===l?"nwse-resize":"ne"===l||"sw"===l?"nesw-resize":"n"===l||"s"===l?"ns-resize":"e"===l||"w"===l?"ew-resize":"default"}),t.addEventListener("pointerdown",e=>{var o;if(!(l=i(e)))return;ec=!0,e.preventDefault(),t.setPointerCapture(e.pointerId);let r=t.getBoundingClientRect();n={dir:l,sx:e.clientX,sy:e.clientY,sw:r.width,sh:r.height,sl:r.left,st:r.top},t.querySelectorAll("iframe").forEach(e=>{e._oldPE=e.style.pointerEvents,e.style.pointerEvents="none"}),document.body.style.userSelect="none",document.body.style.cursor=(o=l,"nw"===o||"se"===o?"nwse-resize":"ne"===o||"sw"===o?"nesw-resize":"n"===o||"s"===o?"ns-resize":"e"===o||"w"===o?"ew-resize":"default"),t.style.willChange="width, height, left, top"},{passive:!1});let o;function r(){clearInterval(o),n&&(K=z(),n=null,ec=!1,document.body.style.userSelect="",document.body.style.cursor="",t.style.cursor="default",t.style.willChange="",t.querySelectorAll("iframe").forEach(e=>{e.style.pointerEvents=e._oldPE||"",delete e._oldPE}))}t.addEventListener("pointermove",e=>{if(!n)return;let l=e.clientX-n.sx,i=e.clientY-n.sy;if((l>1&&ec||i>1&&ec)&&(D(z()),W.textContent="‎     □    ‎ ",h=!1),n.dir.includes("e")&&(t.style.width=Math.max(450,n.sw+l)+"px"),n.dir.includes("s")&&(t.style.height=Math.max(350,n.sh+i)+"px"),n.dir.includes("w")){let o=Math.max(450,n.sw-l);t.style.width=o+"px",t.style.left=n.sl+l+"px"}if(n.dir.includes("n")){let r=n.st+i;if(r>=0){let s=Math.max(350,n.sh-i);t.style.height=s+"px",t.style.top=r+"px"}else t.style.top="0px"}}),t.addEventListener("pointerup",r),t.addEventListener("pointercancel",r),t.style.touchAction="none"}(),{rootElement:k,iframes:[],urlInput:M,openBtn:N,fullscreenBtn:H,activatedTab:f,addTab:Q,activateTab:Z,closeTab:ee,openUrl:et,enterFullscreen:el,exitFullscreen:ei,btnMax:W,get isMaximized(){return h},set isMaximized(v){h=!!v},get isMinimized(){return isMinimized},set isMinimized(v){isMinimized=!!v},addAndOpen:function(e){let t=Q(e);Z(t)},get tabs(){return q}}}();function w(e,t){var n,l;function i(e){return encodeURIComponent(e.split("").map((e,t)=>t%2?String.fromCharCode(2^e.charCodeAt(0)):e).join(""))}function o(e,t){return t+"scramjet/"+e}return n=e,l=t,"goldenbody://newtab/"===n?goldenbodywebsite+"newtab.html":l+u+"/"+e}setInterval(function(){"string"==typeof f.title&&""!=typeof f.title?b.title=f.title:b.title="undefined"},1e3),b.rootElement.setAttribute("data-title",b.title),c.push(b)}var x=document.createElement("div");function b(e,t){var n=document.createElement("button");n.innerText=e,n.value=e,n.id=e,n.style.padding="3px",n.style.marginRight="5px",n.style.border="none",n.style.borderRadius="3px",n.style.cursor="pointer",n.style.background="#444",n.style.color="#fff",n.style.height="40px",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.minWidth="60px",n.style.fontSize="30px",n.addEventListener("click",()=>{console.log("Task clicked:",n.value),t()}),x.appendChild(n)}x.id="taskbar",x.style.position="fixed",x.style.zIndex=9999,x.style.bottom="0",x.style.left="0",x.style.width="100%",x.style.height="60px",x.style.background="#222",x.style.display="flex",x.style.alignItems="center",x.style.paddingLeft="50px",x.style.boxSizing="border-box",document.body.appendChild(x),b("⤢",function e(){document.documentElement.requestFullscreen(),_isfullscreen=!0}),b("\uD83C\uDF10",g);let w=[...x.querySelectorAll("button")].find(e=>"\uD83C\uDF10"===e.innerText);w.addEventListener("contextmenu",function(e){e.preventDefault(),document.querySelectorAll(".browser-menu").forEach(e=>e.remove());let t=document.createElement("div");t.className="browser-menu",Object.assign(t.style,{position:"fixed",top:"0px",left:`${e.clientX}px`,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 6px rgba(0,0,0,0.2)",zIndex:9999999,padding:"4px 0",minWidth:"160px",fontSize:"13px",visibility:"hidden"}),requestAnimationFrame(()=>{let n=t.offsetHeight,l=e.clientY-n;t.style.top=`${l}px`,t.style.visibility="visible"});let n=document.createElement("div");if(n.textContent="close all",n.style.padding="6px 10px",n.style.cursor="pointer",n.addEventListener("click",function(){for(let e=0;e<c.length;e++)c[e].rootElement.remove(),c[e].rootElement=null;c=[]}),t.appendChild(n),0===c.length){let l=document.createElement("div");l.textContent="No open windows",l.style.padding="6px 10px",t.appendChild(l)}else c.forEach((e,n)=>{let l=document.createElement("div");l.textContent=e.title||"Loading...",l.style.padding="6px 10px",l.style.cursor="pointer",l.style.maxWidth="185px",l.style.maxHeight="15px",l.style.overflow="hidden",l.addEventListener("click",()=>{m(e.rootElement);let n=e.rootElement;n.style.display="none",n.style.display="block",e._isMinimized=!1,e.isMaximized=!1,e.btnMax.textContent="‎     □    ‎ ",e._isMinimized=!1,e._isMinimized=!1,t.remove()}),t.appendChild(l)});document.body.appendChild(t),window.addEventListener("click",()=>t.remove(),{once:!0})})}
/*hammerhead|script|start*/if (typeof window !== 'undefined' && window){window['hammerhead|process-dom-method'] && window['hammerhead|process-dom-method']();if (window.__get$ && typeof __get$ === 'undefined')var __get$Loc = window.__get$Loc,__set$Loc = window.__set$Loc,__set$ = window.__set$,__get$ = window.__get$,__call$ = window.__call$,__get$Eval = window.__get$Eval,__proc$Script = window.__proc$Script,__proc$Html = window.__proc$Html,__get$PostMessage = window.__get$PostMessage,__get$ProxyUrl = window.__get$ProxyUrl,__rest$Array = window.__rest$Array,__rest$Object = window.__rest$Object,__arrayFrom$ = window.__arrayFrom$;} else {if (typeof __get$ === 'undefined')var __get$Loc = function(l){return l},__set$Loc = function(l,v){return l = v},__set$ = function(o,p,v){return o[p] = v},__get$ = function(o,p){return o[p]},__call$ = function(o,p,a){return o[p].apply(o,a)},__get$Eval = function(e){return e},__proc$Script = function(s){return s},__proc$Html = function(h){return h},__get$PostMessage = function(w,p){return arguments.length===1?w.postMessage:p},__get$ProxyUrl = function(u,d){return u},__rest$Array = function(a,i){return Array.prototype.slice.call(a, i)},__rest$Object = function(o,p){var k=Object.keys(o),n={};for(var i=0;i<k.length;++i)if(p.indexOf(k[i])<0)n[k[i]]=o[k[i]];return n},__arrayFrom$ = function(r){if(!r)return r;return!Array.isArray(r)&&"function"==typeof r[Symbol.iterator]?Array.from(r):r};if (typeof importScripts !== "undefined" && /\[native code]/g.test(importScripts.toString())) {var __getWorkerSettings$ = function () {return null};importScripts((location.origin || (location.protocol + "//" + location.host)) + "/worker-hammerhead.js");}}/*hammerhead|script|processing-header-end*/
import{n as e,t}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/rolldown-runtime-Cn8xt2Gj.js" ;var n,r,i,a,o=e((()=>{n=`modulepreload`,r=function(e){return`/js/client-prod/`+e},i={},a=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),s=document.querySelector(`meta[property=csp-nonce]`),c=s?.nonce||s?.getAttribute(`nonce`);function l(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}o=l(t.map(t=>{if(t=r(t,a),t in i)return; __set$(i,t,!0) ;let o=t.endsWith(`.css`),s=o?`[rel="stylesheet"]`:``;if(a)for(let n=e.length-1;n>=0;n--){let r= __get$(e,n) ;if( __get$(r,"href") ===t&&(!o||r.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${s}`))return;let l=document.createElement(`link`);if(l.rel=o?`stylesheet`:n,o||(l.as=`script`),l.crossOrigin=``, __set$(l,"href",t) ,c&&l.setAttribute(`nonce`,c),document.head.appendChild(l),o)return new Promise((e,n)=>{l.addEventListener(`load`,e),l.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function s(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then(t=>{for(let e of t||[])e.status===`rejected`&&s(e.reason);return e().catch(s)})}}));function s(){let e=[];return{emit:t,listeners:e,off:n,offAll:r,offMany:i,on:a,onAll:o,onMany:s,once:c};function t(t,n){let r;for(r of e)r.type!==t&&r.type!==`all`||r.handler(n)}function n(t){let n=e.findIndex(e=>t.type===e.type&&t.handler===e.handler);n!==-1&&e.splice(n,1)}function r(e){return n({handler:e,type:`all`})}function i(e=[]){e.forEach(e=>n(e))}function a(t,n){let r={handler:n,type:t};e.push(r)}function o(e){a(`all`,e)}function s(e=[],t){e.forEach(e=>a(e,t))}function c(t,r){let i={handler:(...e)=>{n(i),r(...e)},type:t};e.push(i)}}function c( _hh$temp0 ,r=s()){ var e=_hh$temp0.data,t=_hh$temp0.initialState,n=_hh$temp0.states; let i=t;return  __call$(Object,"assign",[__call$(Object,"assign",[{},r]),{getCurrentState:a,getData:o,transition:c}]) ;function a(){return i}function o(){return  __call$(Object,"assign",[{},e]) }function c(t,a){if(! __get$(__get$(n,i),t) )return r.emit(W.Event.Types.NoTransition,{action:t,data:e,state:i}),!1;let o= __call$(__get$(n,i),t,[a]) ,s=typeof o==`string`?o:o.nextState,c=n=>({action:t,currentState:i,data:e,event:n,nextState:s,params:a});return i!==s&&r.emit(W.Event.Types.OnExit,c(W.Event.Types.OnExit)),o.data&& __call$(Object,"assign",[e,o.data]) ,i!==s&&r.emit(W.Event.Types.OnEnter,c(W.Event.Types.OnEnter)),i===s?r.emit(W.Event.Types.OnReEnter,c(W.Event.Types.OnReEnter)):i=s,!0}}function l(e){var t={exports:{}};return e(t,t.exports),t.exports}function u(e){Ke||(Ke=!0,Ge.forEach(t=>window.addEventListener(t,e)))}function d(e){Ke&&(Ke=!1,Ge.forEach(t=>window.removeEventListener(t,e)))}function f(e,t){function n(r){r?.data?.key===e&&(t(),window.removeEventListener(`message`,n))}window.addEventListener(`message`,n)}function p(){try{return new Je}catch{return null}}function m(){return Ye}function h(e){if(Je){if(qe.audioContext||=p(),!qe.audioContext||!qe.audioContext.resume){Ye=!1,e();return}qe.audioContext.resume().then(()=>{Ye=!1,e()})}}function g(){m()&&h(()=>{ __call$(window,"postMessage",[{key:We.Enabled},__get$(window,"location").origin]) ,d(g)})}function _(e,t=!1){let n=new Ue(e,t);return m()?(u(g),f(We.Enabled,()=>n.load())):n.load(),n}function v(e){m()?!Qe&&Ze>Xe?(Ze=0,Qe=!0, __call$(window,"postMessage",[{key:We.Suspended},__get$(window,"location").origin]) ):Qe||(Ze++,g(),f(We.Enabled,()=>e.play())):e.play()}function y(){return et||=new $e,et}function b(e,t=y()){let n;return t._withIDBStore(`readonly`,t=>{n=t.get(e)}).then(()=>n.result)}function x(e,t,n=y()){return n._withIDBStore(`readwrite`,n=>{n.put(t,e)})}function S(){}function C(e,t){for(let n in t) __set$(e,n,__get$(t,n)) ;return e}function w(e){return e()}function T(){return Object.create(null)}function E(e){e.forEach(w)}function D(e){return typeof e==`function`}function O(e,t){return e==e?e!==t||e&&typeof e==`object`||typeof e==`function`:t==t}function k(e){return Object.keys(e).length===0}function ee(e,...t){if(e==null)return S;let n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function A(e,t,n){e.$$.on_destroy.push(ee(t,n))}function j(e){return e??``}function M(e,t){e.appendChild(t)}function N(e,t,n){e.insertBefore(t,n||null)}function P(e){e.parentNode&&e.parentNode.removeChild(e)}function te(e,t){for(let n=0;n<e.length;n+=1) __get$(e,n) && __get$(e,n) .d(t)}function F(e){return document.createElement(e)}function ne(e){return document.createElementNS(`http://www.w3.org/2000/svg`,e)}function I(e){return document.createTextNode(e)}function re(){return I(` `)}function ie(){return I(``)}function L(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function R(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ae(e){return Array.from(e.childNodes)}function oe(e,t){t=``+t,e.data!==t&&(e.data=t)}function se(e,t){t=``+t,e.wholeText!==t&&(e.data=t)}function ce(e,t,n){~tt.indexOf(n)?se(e,t):oe(e,t)}function le(){if(nt===void 0){nt=!1;try{typeof window<`u`&&window.parent&&window.parent.document}catch{nt=!0}}return nt}function ue(e,t){getComputedStyle(e).position===`static`&&(e.style.position=`relative`);let n=F(`iframe`);n.setAttribute(`style`,`display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;`),n.setAttribute(`aria-hidden`,`true`),n.tabIndex=-1;let r=le(),i;return r?(n.src=`data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>`,i=L(window,`message`,e=>{e.source===n.contentWindow&&t()})):(n.src=`about:blank`,n.onload=()=>{i=L(n.contentWindow,`resize`,t),t()}),M(e,n),()=>{(r||i&&n.contentWindow)&&i(),P(n)}}function de(e,t,n){ __call$(e.classList,n?`add`:`remove`,[t]) }function fe(e,t, _hh$temp1 ={}){ var _hh$temp1$bubbles=_hh$temp1.bubbles,n=_hh$temp1$bubbles===void 0?!1:_hh$temp1$bubbles,_hh$temp1$cancelable=_hh$temp1.cancelable,r=_hh$temp1$cancelable===void 0?!1:_hh$temp1$cancelable; let i=document.createEvent(`CustomEvent`);return i.initCustomEvent(e,n,r,t),i}function pe(e){it=e}function me(){if(!it)throw Error(`Function called outside component initialization`);return it}function z(e){me().$$.on_mount.push(e)}function he(e){me().$$.on_destroy.push(e)}function ge(){let e=me();return(t,n, _hh$temp2 ={})=>{ var _hh$temp2$cancelable=_hh$temp2.cancelable,r=_hh$temp2$cancelable===void 0?!1:_hh$temp2$cancelable; let i= __get$(e.$$.callbacks,t) ;if(i){let a=fe(t,n,{cancelable:r});return i.slice().forEach(t=>{t.call(e,a)}),!a.defaultPrevented}return!0}}function _e(e,t){return me().$$.context.set(e,t),t}function ve(e){return me().$$.context.get(e)}function ye(){ut||(ut=!0,lt.then(xe))}function be(e){st.push(e)}function xe(){if(ft!==0)return;let e=it;do{try{for(;ft<at.length;){let e= __get$(at,ft) ;ft++,pe(e),Se(e.$$)}}catch(e){throw at.length=0,ft=0,e}for(pe(null),at.length=0,ft=0;ot.length;)ot.pop()();for(let e=0;e<st.length;e+=1){let t= __get$(st,e) ;dt.has(t)||(dt.add(t),t())}st.length=0}while(at.length);for(;ct.length;)ct.pop()();ut=!1,dt.clear(),pe(e)}function Se(e){if(e.fragment!==null){e.update(),E(e.before_update);let t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(be)}}function B(e){let t=[],n=[];st.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(e=>e()),st=t}function Ce(){mt={r:0,c:[],p:mt}}function we(){mt.r||E(mt.c),mt=mt.p}function V(e,t){e&&e.i&&(pt.delete(e),e.i(t))}function Te(e,t,n,r){if(e&&e.o){if(pt.has(e))return;pt.add(e),mt.c.push(()=>{pt.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function Ee(e,t){Te(e,1,1,()=>{t.delete(e.key)})}function De(e,t,n,r,i,a,o,s,c,l,u,d){let f=e.length,p=a.length,m=f,h={};for(;m--;) __set$(h,__get$(e,m).key,m) ;let g=[],_=new Map,v=new Map,y=[];for(m=p;m--;){let e=d(i,a,m),s=n(e),c=o.get(s);c?r&&y.push(()=>c.p(e,t)):(c=l(s,e),c.c()),_.set(s, __set$(g,m,c) ),s in h&&v.set(s,Math.abs(m- __get$(h,s) ))}let b=new Set,x=new Set;function S(e){V(e,1),e.m(s,u),o.set(e.key,e),u=e.first,p--}for(;f&&p;){let t= __get$(g,p-1) ,n= __get$(e,f-1) ,r=t.key,i=n.key;t===n?(u=t.first,f--,p--):_.has(i)?!o.has(r)||b.has(r)?S(t):x.has(i)?f--:v.get(r)>v.get(i)?(x.add(r),S(t)):(b.add(i),f--):(c(n,o),f--)}for(;f--;){let t= __get$(e,f) ;_.has(t.key)||c(t,o)}for(;p;)S( __get$(g,p-1) );return E(y),g}function Oe(e,t){let n={},r={},i={$$scope:1},a=e.length;for(;a--;){let o= __get$(e,a) ,s= __get$(t,a) ;if(s){for(let e in o)e in s||( __set$(r,e,1) );for(let e in s) __get$(i,e) ||( __set$(n,e,__get$(s,e)) , __set$(i,e,1) ); __set$(e,a,s) }else for(let e in o) __set$(i,e,1) }for(let e in r)e in n||( __set$(n,e,void 0) );return n}function ke(e){return typeof e==`object`&&e?e:{}}function Ae(e){e&&e.c()}function je(e,t,n,r){ let _hh$temp3=e.$$,i=_hh$temp3.fragment,a=_hh$temp3.after_update; i&&i.m(t,n),r||be(()=>{let t=e.$$.on_mount.map(w).filter(D);e.$$.on_destroy?e.$$.on_destroy.push(...t):E(t),e.$$.on_mount=[]}),a.forEach(be)}function Me(e,t){let n=e.$$;n.fragment!==null&&(B(n.after_update),E(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ne(e,t){e.$$.dirty[0]===-1&&(at.push(e),ye(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Pe(e,t,n,r,i,a,o,s=[-1]){let c=it;pe(e);let l=e.$$={fragment:null,ctx:[],props:a,update:S,not_equal:i,bound:T(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:T(),dirty:s,skip_bound:!1,root:t.target||c.$$.root};o&&o(l.root);let u=!1;if(l.ctx=n?n(e,t.props||{},(t,n,...r)=>{let a=r.length?r[0]:n;return l.ctx&&i( __get$(l.ctx,t) , __set$(l.ctx,t,a) )&&(!l.skip_bound&& __get$(l.bound,t) && __call$(l.bound,t,[a]) ,u&&Ne(e,t)),n}):[],l.update(),u=!0,E(l.before_update),l.fragment=r?r(l.ctx):!1,t.target){if(t.hydrate){let e=ae(t.target);l.fragment&&l.fragment.l(e),e.forEach(P)}else l.fragment&&l.fragment.c();t.intro&&V(e.$$.fragment),je(e,t.target,t.anchor,t.customElement),xe()}pe(c)}function Fe(e){return Object.keys(e).reduce((t,n)=> __call$(Object,"assign",[__call$(Object,"assign",[{},t]),{[__get$(e,n)]:n}]) ,{})}function Ie(e,t){return t.reduce((t,n)=>(Object.prototype.hasOwnProperty.call(e,n)&&( __set$(t,n,__get$(e,n)) ),t),{})}function Le(e,t=S){let n,r=new Set;function i(t){if(O(e,t)&&(e=t,n)){let t=!gt.length;for(let t of r)t[1](),gt.push(t,e);if(t){for(let e=0;e<gt.length;e+=2) __get$(gt,e) [0]( __get$(gt,e+1) );gt.length=0}}}function a(t){i(t(e))}function o(a,o=S){let s=[a,o];return r.add(s),r.size===1&&(n=t(i)||S),a(e),()=>{r.delete(s),r.size===0&&n&&(n(),n=null)}}return{set:i,update:a,subscribe:o}}function Re(e,t=`.`){return`${t}${e}`}function ze(e){return`${e[0].toUpperCase()}${e.slice(1)}`}var H,Be,Ve,U,W,G,He,Ue,We,Ge,Ke,qe,Je,Ye,Xe,Ze,Qe,$e,et,tt,nt,rt,it,at,ot,st,ct,lt,ut,dt,ft,pt,mt,ht,gt,_t,vt,yt,bt=e((()=>{H=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},Be={},(function(e){(function(){var t=function(){var e=[[2637767806,863464769],[720845184,95069639],[1155203408,610415943],[2618685246,1655139042],[1971536997,1218186377],[848342074,540017087],[263957791,1627660921],[3896152207,4076560586],[226391645,1484086288],[436746274,3467632685],[2516964848,3797861296],[3491888988,3510251221],[1086189917,1248276018],[18044180,1876255637],[1572111136,1190386149],[597658413,2146900428],[97624494,2243205793],[1738507407,1854916977],[1950989311,2149575947],[2098318769,3283594736],[2194108574,2015279052],[4079062812,2500884588],[856979699,2941369318],[1270058469,3877737539],[2858720366,3170717948],[2378012835,1387254795],[2278688587,2178388503],[435406673,3555273441],[3031118064,1655806655],[2063925420,1107589828],[3376753832,436852829],[615148625,1302492416],[1285502018,1963045959],[346460119,1016137793],[2803604355,1176288659],[55085973,2968618255],[1669016372,4287873088],[164740250,1037634196],[896886403,883023163],[1935551383,2764331555],[410153072,4055711755],[533441746,1505690343],[3541084098,3466290517],[3214426080,4267541060],[2675233103,1951705124],[1374411850,3115986997],[1552073989,3684348154],[4244110986,875606593],[844343081,3115990494],[2356462440,135999605],[3116133511,377238503],[2129956651,2197966368],[299173332,3276914047],[1701379241,745972291],[1306570996,254977976],[2530644806,214138461],[1122123979,1667800879],[1831591130,3801192033],[1116211970,920967505],[1594837592,2551651254],[972591349,2046373768],[2479207924,1935030411],[1675376029,2367888248],[3960916618,3935874422],[1398143232,3265801671],[133930885,1520005442],[1351827834,2829577566],[2076951437,2723839804],[435980918,2364847828],[1668970368,3738157273],[2185864314,3993911799],[2041407829,31969768],[346864372,2004703094],[4047877822,3437142421],[3669961416,538399484],[616810829,4190688246],[3144558884,4030272234],[216165387,2513010905],[2761740594,3216997572],[3919406634,4096014649],[669429112,2434161727],[2234904640,3111407601],[1421079802,1598085235],[1924213810,310373675],[4002762044,2067865415],[2592451728,2586110625],[1890340057,4031717877],[4189625662,2577429954],[2276713138,3049850801],[2741429688,3310307512],[2924122950,3426712818],[421576781,1193704381],[2277442246,3030264553],[153237420,595540057],[4278711886,4176286928],[2380848297,4030514510],[2618700582,1303682185],[3018992701,185284845],[957243316,1291916363],[1543415220,1898408169],[504378001,531073412],[2591337657,1692896435],[1333852064,903543556],[1661259930,188168388],[561112646,2197961224],[1536910315,2632972300],[1349168372,2307429186],[411152329,2745631190],[1694697476,1081411140],[3755185459,2631660711],[4019355068,4027326706],[2066937809,3761668332],[3120395808,3878773315],[94890149,2109283191],[3045629038,358812277],[1249184265,3465901047],[3477490924,2308583306],[4114113436,3875911716],[1014604031,1434513279],[3991324799,2222416029],[2040431088,1539915569],[2253613964,4081224332],[2547464012,1611168627],[2722521980,4281500978],[71289574,213969824],[2450408597,903689630],[1894451515,364024012],[1939968537,374938813],[1447259295,3785468557],[4021046128,1664847745],[3139524504,3562928047],[1173487682,4065269608],[2467266804,3907744866],[4284945151,3486998177],[2925674454,1953016432],[3710671816,1271453948],[2129465869,1422863833],[587093076,18243356],[3373793513,2411305257],[2156648078,1791034213],[3737413652,1534461430],[468575139,2935304962],[1129551363,3603256834],[2861996892,1763494778],[2826449619,2465197654],[1704209531,1014895022],[3738359347,3402630390],[569410928,4095796581],[3021312909,2108247612],[2444777957,2664129360],[282063667,3773661258],[682545472,3188439005],[3318488457,1917822038],[1447622272,4045023041],[757420137,4038580915],[2613420942,4146703316],[4012836163,150381244],[2938127093,3428591704],[1208226490,3086335530],[2935205706,1446903363],[430957978,3830532479],[1381578755,3757172800],[4109399782,1596778224],[288855589,1954372339],[3169178148,2256716053],[2644780093,3895892303],[107966643,1071681559],[1304747544,2607225372],[1359190711,1898207171],[3229237120,3273634996],[3027167685,3863637628],[3011615298,2883984519],[564135827,978463264],[770797430,362326607],[1983662611,1907583229],[4153656423,48268960],[3609759233,720080177],[3727911466,1270989899],[200708787,2366086947],[744508026,393422515],[1213261630,65757284],[3485747185,3845951003],[2958861301,1680248217],[2598470344,3163845864],[2767997908,4233451722],[3881113485,1492930166],[1773764017,2764062206],[4189435844,2898689174],[4234838742,1267095035],[2624081078,3302114327],[2395569449,390426320],[1728307101,690284926],[3309827454,1118258254],[2028172868,3888829086],[4271523049,909051386],[146617804,942892565],[2467685867,974297806],[2483428231,503635829],[3743260573,2018222096],[1002067894,2289153437],[3535252974,3738302271],[4154611160,1002664952],[3623154244,2349656961],[3646679180,3524329383],[862933752,4282853607],[2806008282,3272780913],[2734037942,3828874677],[1328176304,2137666995],[2278785213,2780788825],[381286368,1816476193],[2074232908,2316293454],[4087773386,3651330956],[967884669,3728964514],[4239349185,3213509668],[419231360,1463788948],[1275421624,2672384707],[1088456595,436245261],[2365565249,783696577],[1758083333,845223583],[2048846183,3530914274],[2635948261,124738415],[940630937,3069598626],[839474029,1253439921],[902477345,165479306],[2836079689,2681188273],[2007115168,2093139645],[1363041891,1282466609],[1130479818,1063857938],[3644959908,1260430427],[1385135238,46497915],[1386975934,3110156681],[2635987502,4233461619],[1915744629,4117939016],[487743653,285736599],[2049219159,3960249250],[69242857,3908563670],[1511066720,1488527520],[215590039,1703564952],[1459430344,4184955468],[676103291,2642967214],[83799035,3182827979],[1949179493,476101251],[2593534694,1493478716],[2283504289,995211746],[1349412676,3449243940],[2954378677,1878813305],[249149717,3329151870],[1578231917,1483986052],[4135085182,890874990],[461755528,3505523909],[3669622373,634949665],[219487622,2914465301],[2825233742,3703631897],[2479105382,2935590907],[2582097898,3187672881],[1221328648,1843341402],[2140891889,3958868911],[1482849818,345750049],[751922730,3178831411],[3546542069,4036458902],[216179596,877293293],[444615341,3117393729],[2424254530,494454238],[1344234989,3003337991],[929188581,2760877801],[2507911009,1879899982],[980166547,1311840394],[3566535507,1790747461],[143525013,2311336672],[4181962471,4273938872],[1815842366,862009811],[911175674,1179575598],[3591335374,3694215714],[1452686093,3393294272],[385158879,2447709103],[4011414929,1264623507],[1448477120,911094312],[3971299641,2289992053],[3133647265,2234591563],[3007628400,964409938],[1708345684,3673411261],[3031964479,2843021794],[3022128657,2480338599],[118850112,473449293],[2048127371,3202109429],[3158349745,382018770],[1505327237,3807570472],[2568424029,3272693060],[1866609495,3888556537],[844703982,1852802964],[3504617058,682636099],[1448882679,3733580327],[821387540,2215744532],[3631471417,311618895],[2077838877,2383929020],[3352949096,1688694420],[2491080787,3998672444],[3368630402,4182204255],[983299419,2837414346],[3651215291,1033373924],[265429091,3988955082],[3019003608,2896212153],[2955948456,3025235588],[903690197,2266253487],[3925215275,89402958],[3959093811,3609545561],[2455088053,223552128],[3115011301,2133669107],[1765081558,673805649],[3324795129,2111392191],[3443871631,432345706],[3152559950,3425427147],[3699649406,672784944],[3129545774,7668664],[2747044893,173040075],[3925243406,852328481],[164095314,3161868591],[2234471571,1302682825],[2164784335,105893718],[159995093,536831360],[599199451,425051327],[3274759746,1680930461],[1192619331,3903085578],[2832721114,3078660237],[91404660,4030521531],[3044880024,1578375623],[3906596030,754177855],[803516785,1894094672],[288455592,2030430096],[2143232492,2317305324],[388352703,3406060288],[2521731420,3588403719],[1043041227,4028028525],[3195290851,2468913324],[4166724431,3168683191],[1228226538,968516529],[500177583,3444787306],[533367442,4252082053],[4236023256,657816314],[413575568,3367198397],[3435884549,3334062733],[1004255532,1135705894],[2859513268,4170618274],[3914086821,1251487871],[3080761716,3489067886],[3571165255,699353261],[773372954,3648014952],[769693293,2939128604],[3116440923,507748478],[1687629160,3739431776],[2489486648,3502376324],[3686847158,2878383449],[3530767427,902211375],[2121652637,2493976397],[1827477891,930064171],[2549918411,4029725732],[2071415163,844118802],[2236083679,3088894868],[2040110303,4144562891],[3489536313,1133419300],[2190878435,2301466071],[2465915458,2448602097],[1675766804,2073834499],[3329799896,1613253148],[1483966600,1348836071],[159505618,2527621997],[2674227354,1695130688],[2683539437,1927873839],[3833196123,2570082188],[3891433165,759819981],[1455453349,2179602430],[1430583255,1957776111],[2067726741,4235143439],[303380021,2998980439],[2136024795,3126725799],[2054591852,1051702291],[1029141665,489794361],[2317027384,569642164],[2068461795,624418658],[2499875684,1830645251],[1302894490,4319401],[1002663431,2406815191],[1560941298,2060652753],[2141002286,515773223],[3661248027,475092913],[3705503008,2419919909],[914567990,3496539911],[3462935583,2039034761],[2878378006,2379243316],[1133857586,1390159333],[3023618742,2140726761],[282908558,944874642],[3686955701,1148723903],[2604456805,4163675010],[3061545110,377179268],[3218002352,76459088],[2836503392,916455101],[536836808,151306053],[2886925079,404221671],[2936593041,2011015485],[453815187,1852163908],[3042568989,82176306],[3279635891,4174836410],[3282689058,2360003049],[4088968807,1516570623],[2680453086,1322680794],[1731693966,3438253771],[1842894553,1294307894],[2736377365,2964642609],[121205621,521330014],[2324595870,3005710757],[3784465521,676493813],[1958759409,2030833406],[1306150933,1016370058],[2636541290,482366508],[1950415745,1695073534],[322077955,3746046623],[3602873262,3829181504],[1211684447,1861645455],[504701736,4080111082],[2407799203,1223857855],[1925743434,1498920209],[3617596327,845198428],[2498480299,3484773806],[2680229135,2560201696],[3731399221,1536412390],[2756509305,2924710846],[2635957500,3459716133],[1372762539,769635894],[802677945,3878474636],[1707760534,3075809808],[3714687192,2872792173],[1615679922,1606381794],[1940556374,1337437342],[445390489,731124040],[2864974375,64601760],[1984806574,2141516710],[513390958,1890172555],[744398315,1475299139],[982749166,852662657],[652663695,4260736510],[1184061125,82616221],[3363191899,147951756],[1064069880,1507328085],[2138882964,547595589],[2616926846,3186935246],[2298715513,3606862940],[2414381911,811477686],[2694745228,900437726],[4202576185,2201114451],[3602305260,3323446937],[3756663274,2658490339],[3061587876,2171079416],[3390977925,2850497765],[486312941,224925241],[3515712841,3510684394],[1322319486,2647200565],[3839619171,1148450258],[392296762,1154854654],[1401523788,957405781],[1934485528,527352730],[645968162,3131215255],[696971825,3361451947],[2038689491,1946699733],[1723966113,2785859721],[2652365974,1118037185],[3988018407,3134982149],[1354171594,3053634345],[1287854075,2631782435],[1723106141,2662328866],[563845090,1878819261],[639520332,171129501],[534957223,1696062352],[3612364282,2283204027],[3109494688,1304463816],[500957989,630925278],[3477030536,2149497258],[4109750364,281719363],[951472732,564407054],[922095147,2767874048],[3946156928,829677774],[2622281253,2086286851],[2936811901,850242186],[630086272,3340782667],[2340986210,1296336989],[4107355543,3865114709],[3560210278,3968418243],[3868847493,2967450637],[611513888,2083325060],[3265390517,3025776309],[2874106961,3424470508],[1668707698,2923258228],[2778598353,24320552],[292356118,3415510793],[754567370,86994591],[185141877,1621715171],[2884558258,3722473457],[1492107531,111281805],[3336927864,4225337056],[782994598,1021838039],[346133860,18281270],[2080909533,1649329040],[3612065399,3859901127],[2151962287,284556115],[3957975594,3745718727],[52533817,3998775856],[1232633839,397383972],[2716413964,3629253960],[1531307298,3836851439],[3030137657,2500401718],[3561556693,653345841],[313061910,2945718466],[2065276,3342140708],[410498334,1470588117],[2726640512,4051654894],[2570984935,758567696],[3008987264,3462702678],[623860175,228525243],[3527183895,1829844480],[467272850,3890501742],[568376656,650516927],[990477018,4035508558],[2366955227,817792110],[4183621538,989198068],[946958343,1639184195],[3395758993,3924097558],[1690887473,3220519765],[605184237,1255270525],[275515833,1926424610],[2142902612,283494960],[2021972412,1823828440],[105373677,3448326697],[1666662384,1042433908],[1338566998,261206307],[498685668,1344755577],[3101233780,3119109371],[2733370951,3808165089],[3656512268,3449289481],[4025308119,1607880299],[778896067,1612183167],[2846510368,3674754715],[3058428120,2991822529],[1892379383,3268787440],[2565895844,4154602030],[3213117192,98999135],[2495816991,116985075],[1040203361,1785041385],[3106252493,69316595],[1639829808,2087117568],[3213709576,3799911752],[604681594,2340981536],[4236730699,2938666503],[4009938384,1878897714],[2701667332,1725918218],[2182473079,1258184],[3550198211,2760750799],[657991062,875584532],[1640976276,3380476221],[460041378,2924352091],[1972323596,2287414795],[2510248061,1350206297],[2959337826,3762681165],[1625877874,3235902929],[2070189957,1429368735],[4245163299,1839731898],[2358312347,138364248],[275739390,2179122576],[2037777210,972544338],[2766930226,1984733259],[1933485829,4209310327],[3034118011,3286589799],[2653025529,62078937],[2641780289,2679545709],[3540781195,2787026415],[1569993599,3215949659],[441337890,3947723353],[1878946792,459505587],[3724105660,920173002],[1691411102,3934795955],[148741087,3647709027],[142506469,2776440083],[3811107376,3823285243],[472209891,252266174],[1913386482,1867329194],[2960608550,482740699],[1145005292,1513558421],[1091751784,1687823886],[3625186042,3086337482],[1712140887,940065262],[1504455800,1945702563],[3896940088,2003245591],[2478191531,4197739e3],[3233871270,250924495],[3404865229,1131917964],[1462204167,429621621],[1349259705,3641608989],[3627860584,2048468319],[1244251718,1513180369],[3979211282,371413143],[3043187861,4285699810],[581894202,3060983825],[1390895705,1811317301],[2599134010,3337406128],[2488233440,2436161462],[1816641224,2208816697],[1792034756,815866116],[2779893723,2695577703],[2084952115,2951772258],[1351806869,169269771],[2469979804,86740603],[1163545420,4264616949],[1795352113,2511146232],[1796715044,3134635815],[3521170642,1538900329],[3725363621,1455009392],[1342594643,1512127734],[2618386938,662157428],[2028859350,2494504685],[1841905045,648351336],[4002935891,4033319405],[850071259,1768358867],[979915719,3876018087],[830889197,1629549437],[1744763229,2455795856],[522919199,368499868],[3063822504,2522639205],[2861636095,407686388],[4097602344,1945259027],[4215946617,1251639506],[894485042,534122652],[924809191,1807237502],[1811585710,1589663609],[3439653887,1722232],[3810997538,105152714],[2677100683,4291805514],[77233985,102407776],[4239834691,2851274395],[148802076,2006440603],[2409138150,126301601],[3048474397,3217504870],[588133437,4221603123],[1139638106,263087485],[982032635,3165674595],[562514827,1294842959],[467575086,905357513],[1405117894,3370530088],[3813285157,242912619],[3601878331,1985076606],[1586505598,2092146221],[738488098,103663229],[2970334297,321718822],[1068097019,1742926233],[235518094,420804527],[283685722,4092504887],[2666392744,3799169331],[3569817788,1256762975],[2169728352,292617248],[2444571896,2239859206],[3967907832,1066404216],[420376911,2913277294],[3046293305,2956347747],[2311278792,2477686209],[2885955184,4172514290],[3030078181,2275536480],[4212469731,4280736393],[1046900335,1773022229],[995380926,1414273529],[3892683234,2429494358],[615726237,2127712535],[3880203074,2071130305],[176180504,3070850165],[1474506861,2283723599],[1256707747,1857412043],[764236850,359687368],[3521530334,511649419],[2318567964,3992868140],[128167623,2518992858],[2220129756,1042300052],[2567608573,1349636707],[441446694,384760969],[4143447316,829506048],[817912603,2738025500],[2368091832,357934982],[1187643061,1561463042],[3438021235,3030161697],[1318922279,895468690],[434876457,1130220303],[1180291767,1132759596],[2520707785,1798553137],[1962430872,2958700157],[1510954061,3534879512],[57831539,3269538993],[3354831405,3852135009],[891783098,2698494511],[2555636406,996018997],[2881342935,3982231648],[3473267445,2894952368],[1238029452,3958679326],[2051805420,559465638],[3655936674,1186951582],[330209165,167662935],[1929681327,2450868735],[1313566811,2458925988],[4283920930,3243182650],[1438004300,4185567150],[3093439067,89876832],[3401620219,3721579956],[3673745794,2682874719],[3053321309,825410712],[822915968,3681514755],[3900685126,561657358],[553823814,1857753416],[4166295066,983949325],[128359165,3426887194],[3300989119,3884968622],[4193552686,3647722552],[452189154,1569670618],[4122259632,3537825460],[2519387887,2821594244],[74333898,2940550377],[4032631446,2173999692],[2521268686,1934310532],[2620314688,2177785789],[1378755571,2455646622],[394133753,4231198609],[734399075,2800989170],[573292462,1634883078],[1214417373,3426576256],[2110224475,2399009920],[2331215665,3224086912],[531326186,698539511],[3839443603,583861850],[2644531398,2017784332],[616620850,3070237104],[590349237,2798642861],[3582377217,3317831670],[1582708616,1596570667],[2126148205,2358511947],[173450736,3219362418],[3616831144,1323437318],[2655785577,3131359031],[401600069,2967397952],[496349349,4244179910],[2479612086,2579650653],[1710903074,2049666425],[3589924952,690291925],[3266682943,1900485231],[1496318498,3025542656],[3459221058,3389461212],[2091479615,3140389256],[663040899,1207089672],[3323704225,1105530508],[353318429,2879253542],[2674540957,941987316],[1688550857,620657353],[338551967,4286217277],[204689992,2239736295],[178008789,3940832005],[3871613304,3300636974],[1911672356,2429684487],[4055679954,1974461722],[3878217928,1009991796],[2533095482,310920740],[2174833823,3596041637],[1604814460,2939543881],[1452830254,4092397851],[2441027029,4169690209],[3524103304,3372213855]],t=[[836181454,1689436944],[2776523577,3710710688],[4049974663,3750330768],[519497435,2979405513]],n=[[1892447193,197291556],[3793382197,3742120663],[3838936,2994760034],[479846099,1018728609],[3476112862,182272649],[3504620154,1427438450],[2009473484,2679350403],[1738755500,1129731339]],r=[4174784170,2938602761],i={p:0,P:1,n:2,N:3,b:4,B:5,r:6,R:7,q:8,Q:9,k:10,K:11},a=[];a[5]=1,a[6]=0,a[9]=3,a[10]=2,a[17]=5,a[18]=4,a[33]=7,a[34]=6,a[65]=9,a[66]=8,a[129]=11,a[130]=10;var o=[2,5,10,20,40,80,160,64],s=`nbrq`,c=[``,`0000000`,`000000`,`00000`,`0000`,`000`,`00`,`0`,``],l=16;function u(e){var t=e.toString(16);return  __get$(c,t.length) +t}function d(e){return u(e[0])+u(e[1])}function f(e){return[parseInt(e.substr(0,8),16),parseInt(e.substr(8),16)]}function p(a,s){var c,l,u=a.split(` `),f=u[0].split(`/`),p,m,h,g,_,v,y,b,x=u[1]===`w`,S=0,C,w,T=Number(x),E=T?3:4;for(p=7;p>=0;--p)for(m=0,h= __get$(f,p) ,_=h.length,g=0;g<_;g+=1)v= __get$(h,g) ,C= __get$(i,v) ,C>=0&&(y= __get$(e,64*C+8*(7-p)+m) ,c=(c^y[0])>>>0,l=(l^y[1])>>>0,C===T&&p===E&&(S|=1<<m)),m+=Number(v)||1;return u[2]!==`-`&&(b=u[2],b.indexOf(`K`)>-1&&(y=t[0],c=(c^y[0])>>>0,l=(l^y[1])>>>0),b.indexOf(`Q`)>-1&&(y=t[2],c=(c^y[0])>>>0,l=(l^y[1])>>>0),b.indexOf(`k`)>-1&&(y=t[1],c=(c^y[0])>>>0,l=(l^y[1])>>>0),b.indexOf(`q`)>-1&&(y=t[3],c=(c^y[0])>>>0,l=(l^y[1])>>>0)),u[3]&&u[3]!==`-`&&(w=u[3].charCodeAt(0)-97, __get$(o,w) &S&&(y= __get$(n,w) ,c=(c^y[0])>>>0,l=(l^y[1])>>>0)),x&&(c=(c^r[0])>>>0,l=(l^r[1])>>>0),s&&s===`hex`?d([c,l]):[c,l]}function m(e,t){var n=new XMLHttpRequest,r=e.toLowerCase().indexOf(`.json`)>-1;function i(){var e;if(n.status>=200&&n.status<300||n.status===304||n.status===0||n.status===1223)if(r)try{t(null,JSON.parse(n.response))}catch(e){t(e)}else e=new DataView(n.response),t(null,e);else t(Error(`Error code: `+n.status))}n.open(`GET`,e,!0),r||(n.responseType=`arraybuffer`),n.onload=i,n.onerror=i,n.send()}function h(e){var t,n={},r,i,a;function o(e,t){var n=r.getUint16(e+8),i=r.getUint16(e+10),a,o=n>>9&7,c=n>>6&7,l=n>>3&7,u=n&7,d=n>>12&7;return c===4&&t&&o===l&&t!==`-`&&(u===7&&(o===0&&t.indexOf(`K`)>-1||o===7&&t.indexOf(`k`)>-1)?--u:u===0&&(o===0&&t.indexOf(`Q`)>-1||o===7&&t.indexOf(`q`)>-1)&&(u+=2)),a=String.fromCharCode(c+97)+(o+1)+String.fromCharCode(u+97)+(l+1),d&&(a+= __get$(s,d-1) ),{move:a,weight:i}}function c(e){e.sort(function(e,t){return t.weight-e.weight})}function u(e){return typeof e==`string`&&(e={fen:e}),t(e)}function d(e){var t,n,r,i,a,o=0;if(e||={},t=e.moves||u(e),c(t),r=t.length,r){if(!e.type||r===1||e.type===`best`)return t[0].move;if(e.type===`random`){for(i=Math.floor(Math.random()*t.sum)+1,a=0;a<r-1&&(o+= __get$(t,a) .weight,!(i<=o));a+=1);return  __get$(t,a) .move}else if(e.type===`randomDisregardWeight`)return  __get$(t,Math.floor(Math.random()*r)) .move;else if(e.type===`worst`)return  __get$(t,r-1) .move;else return n=parseInt(e.type)||1,n<0&&(n=r+n+1),n<1?n=1:n>r&&(n=r), __get$(t,n-1) .move}}function m(e){var t=r.length||r.byteLength||0,n=e.offset||0,i,a=e.fen,s=e.chess960,c=e.checkAll,u,d=[],m=0,h,g,_;for(e.hash?(i=e.hash,typeof i==`string`&&(i=f(i))):i=p(a),!s&&a&&(_=a.split(` `)[2]),n=0;n<t;n+=l)if(r.getUint32(n)===i[0]&&r.getUint32(n+4)===i[1])h=o(n,_), __set$(d,d.length,h) ,m+=h.weight,u=!0;else if(u&&!c)break;if(d.sum=m,e.relative)for(g=d.length-1;g>=0;--g) __get$(d,g) .relative=Math.round( __get$(d,g) .weight/m*1e4);return d}function h(e){var t=[],n,r=e.b.length;for(n=0;n<r;++n)t.push({move: __get$(e.b,n) ,weight: __get$(e.w,n) });return t}function g(e){var t,r,a=0,o,s,c,l=e.fen,u;if(n.useFen)o= __call$(l,"replace",[/ \d+ \d+$/,``]) ,t= __get$(i,o) ,t||(s= __call$(o,"replace",[/[a-h][1-8]$/,`-`]) ,s!==o&&(t= __get$(i,s) ));else if(e.hash||=p(l,`hex`),t= __get$(i,e.hash) ,t){if(t[0]&&t[0].n&&(t=t[0]),t.n&&!t.b)return[];if(t.b)t=h(t);else if(!e.chess960&&l)for(u=l.split(` `)[2],r=t.length-1;r>=0;--r)c= __get$(t,r) .move.match(/e([18])([ah])\1/),c&&(c[2]===`h`&&(c[1]===`1`&&u.indexOf(`K`)>-1||c[1]===`8`&&u.indexOf(`k`)>-1)? __set$(t,r,{move:`e`+c[1]+`g`+c[1],weight:__get$(t,r).weight}) :c[2]===`a`&&(c[1]===`1`&&u.indexOf(`Q`)>-1||c[1]===`8`&&u.indexOf(`q`)>-1)&&( __set$(t,r,{move:`e`+c[1]+`c`+c[1],weight:__get$(t,r).weight}) ))}if(t)for(r=t.length-1;r>=0;--r)a+=Number( __get$(t,r) .weight);else t=[];return t.sum=a,t}if(n={query:u,pick:d},e.getUint32)t=m,r=e,n.buffer=r;else for(a in t=g,i=e,n.json=i,i){n.useFen=a.indexOf(` `)>-1;break}return n}function g(e,t){function n(e,n){var r;if(n&&(r=h(n)),t)return t(e,r);if(e)throw e;return r}m(e,n)}return{hash:p,loadBook:function(){var e={};return function(t,n){if( __get$(e,t) ){ __get$(e,t) .book?setTimeout(function(){n(null, __get$(e,t) .book)},0): __get$(e,t) .cbs.push(n);return} __set$(e,t,{cbs:[n]}) ,g(t,function(n,r){var i= __get$(e,t) .cbs;n?delete e[t]:( __get$(e,t) .book=r, __get$(e,t) .cbs=void 0),i.forEach(function(e){setTimeout(function(){e(n,r)},0)})})}}(),to64BitHex:d,zobristPiece:e,zobristCastle:t,zobristEnPassant:n,zobristTurn:r,zobristPieceValue:i,zobristPieceValueNumbers:a}}(),n=function(){var e={Chess:0,Chess960:1,Crazyhouse:2,"3-check":3,"King of the Hill":4,Bughouse:5,chess960:1,fischerandom:1,fischerrandom:1,fischer:1,chess9lx:1,960:1,crazyhouse:2,"three-check":3,threecheck:3,"3check":3,kingofthehill:4,koth:4,bughouse:5},n=[`Chess`,`Chess960`,`Crazyhouse`,`3-check`,`King of the Hill`,`Bughouse`],r={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},i,a,o,s,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0,u=0,d=0,f=-1,p=1,m=2,h=4,g=8,_=16,v=32,y=64,b=128,x=3,S=252,C=255,w=256,T=512,E=112,D=1,O=2,k=4,ee=3,A=7,j=14,M=21,N=127,P=`pnbrqkPNBRQK`,te=`rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1`,F=[];F[5]=[-16,-17,-15],F[6]=[16,17,15],F[8]=[-18,-33,-31,-14,18,33,31,14],F[16]=[-17,-15,17,15],F[32]=[-16,1,16,-1],F[64]=[-17,-16,-15,1,17,16,15,-1],F[128]=[-17,-16,-15,1,17,16,15,-1];var ne={P:5,p:6,N:9,n:10,B:17,b:18,R:33,r:34,Q:65,q:66,K:129,k:130},I={P:4,p:4,N:8,n:8,B:16,b:16,R:32,r:32,Q:64,q:64,K:128,k:128},re={5:`P`,6:`p`,9:`N`,10:`n`,17:`B`,18:`b`,33:`R`,34:`r`,65:`Q`,66:`q`,129:`K`,130:`k`},ie={9:`N`,10:`N`,17:`B`,18:`B`,33:`R`,34:`R`,65:`Q`,66:`Q`,129:`K`,130:`K`},L=[80,0,0,0,0,0,0,96,0,0,0,0,0,0,80,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,96,96,96,96,96,96,224,0,224,96,96,96,96,96,96,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,80,0,0,0,0,0,0,96,0,0,0,0,0,0,80],R=[336,80,80,0,0,0,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,360,508,252,0,252,508,360,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,0,0,0,80,80,336],ae=[336,80,80,0,0,0,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,360,508,252,0,252,508,488,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,96,0,0,80,80,336],oe=[336,80,80,0,0,96,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,488,508,252,0,252,508,360,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,0,0,0,80,80,336],se=[336,80,80,0,0,96,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,488,508,252,0,252,508,488,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,96,0,0,80,80,336],ce=[336,80,80,112,112,112,96,352,96,96,112,112,112,80,336,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,352,352,480,480,488,508,252,0,252,508,488,480,480,480,352,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,336,80,80,112,112,112,96,352,96,96,112,112,112,80,336],le=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,33,16,31,15,0,0,0,0,0,0,0,0,0,0,0,18,17,16,15,14,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,-14,-15,-16,-17,-18,0,0,0,0,0,0,0,0,0,0,0,-15,-31,-16,-33,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],ue=[0,5,8,11,14],de=[31,7,7,7,63],fe={P:0,p:0,N:5,n:5,B:8,b:8,R:11,r:11,Q:14,q:14},pe=[h,g,_,v,y],me=[``,`N`,`B`,`R`,`Q`],z={CAPTURE:1,BIG_PAWN:2,EP_CAPTURE:4,ANY_CAPTURE:5,PROMOTION:8,KSIDE_CASTLE:16,QSIDE_CASTLE:32,KQSIDE_CASTLE:48,DROP:64,DROP_OR_PROMOTE:72},he=[0,6,1],ge={K:119,Q:112,k:7,q:0,A:112,B:113,C:114,D:115,E:116,F:117,G:118,H:119,a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},_e=[`Event`,`Site`,`Date`,`Round`,`White`,`Black`,`Result`],ve=[`Event`,`Site`,`Date`,`Round`,`White`,`Black`,`Result`,`Variant`,`SetUp`,`FEN`,`WhiteA`,`WhiteB`,`BlackA`,`BlackB`];function ye(e){return e>>4}function be(e){return e&7}function xe(e){return String.fromCharCode(be(e)+97)+(8-ye(e))}function Se(e){return 3-e}function B(e,t){e[0]=(e[0]^t[0])>>>0,e[1]=(e[1]^t[1])>>>0}function Ce(e,t,n){return t<1?e:(t=typeof t==`number`?t:80, __call$(e,"replace",[RegExp(`(.{1,`+t+`})(?: |$|\r?
)`,`g`),`$1`+n]) .slice(0,-n.length))}function we(e){var t,n;return e=e.trim(),n=e.split(` `),t= __get$([``,` w - - 0 1`,` - - 0 1`,` - 0 1`,` 0 1`,` 1`],n.length) ,t&&e?e+=t:n[5]===`0`&&(n[5]=1,e=n.join(` `)),e}function V(e){var t=Math.floor(e%36e3/600),n=Math.floor(e%36e3%600)/10;return Math.floor(e/36e3)+`:`+(t<10?`0`:``)+t+`:`+(n<10?`0`:``)+n}function Te(e){var t=e.split(`:`);return(t[0]*3600+t[1]*60+t[2]*1)*10}function Ee(){t.zobristCheck=[[441249556,340005552],[1040760204,311043682],[1621584863,1749286446],[1006868636,1625552915],[1953853171,24921145],[161251506,1935545265]]}function De(t,n){var r=t.length,i,a=0,o=0,s=n&&(n===e.Crazyhouse||n===e.Bughouse),c;for(i=0;i<r;++i)if(c= __get$(t,i) ,+c!=+c)if(c===`/`){if(o!==8&&(t=t.substr(0,i)+(8-o)+t.substr(i),++i,++r),o=0,++a>7){if(!s&&i<r-1||!/^[pnbrq]{0,63}$/i.test(t.substr(i+1)))return!1;break}}else if( __get$(ne,c) ){if(++o>8)return!1}else if(c===`~`)(!s||!i||!/[nbrq]/i.test( __get$(t,i-1) ))&&(t=t.substr(0,i)+t.substr(i+1),--i,--r);else return!1;else o+=c*1,o>8&&(t=t.substr(0,i)+(c-(o-8))+t.substr(i+1),o=8);return t}function Oe(t,n){var r,i,a,o=/^(?:[A-H]{1,2}[a-h]{0,2}|[A-H]{0,2}[a-h]{1,2}|KQ?k?q?|Qk?q?|kq?|q|-)$/,s= __get$(e,n) ||n*1|| __get$(e,__call$(String(n),"replace",[/\s/g,``]).toLowerCase()) ,c=s===e.Crazyhouse||s===e.Bughouse,l,u,d,f=0,p=0,m,h=!0,g=``,_={0:0,7:0},v={0:0,7:0},y={0:`k`,7:`K`},b={0:`r`,7:`R`},x,S,C=s===e.Chess960,w,T,E,D,O,k,ee,A,j,M,N;if(!t)return 1;if(s===e.Bughouse&&(u=t.split(` | `),u.length===2))return d=Oe(u[0],n),d===0&&(d=Oe(u[1],n)),d;if(u=t.split(/\s+/),s=== __get$(e,`3-check`) &&u.length===7&&(l=u.pop(),!/^\+[0-3]\+[0-3]$/.test(l)||l===`+3+3`))return 14;if(u.length!==6)return 1;if(/\D|.{7,}|^0|^$/.test(u[5]))return 2;if(/\D|.{7,}|^0.|^$/.test(u[4]))return 3;if(!/^(?:-|[abcdefgh][36])$/.test(u[3]))return 4;if(w=u[2],C){if(!o.test(w))return 12}else if(!/^(?:KQ?k?q?|Qk?q?|kq?|q|-)$/.test(w)){if(n!==void 0||!o.test(w))return 5;C=!0}if(u[1]!==`w`&&u[1]!==`b`)return 6;if(c&&(u[0]= __call$(u[0],"replace",[/~(?=.*\/)/g,``]) ),i=u[0].split(`/`),c&&i.length===9&&(l=i.pop(),!/^[pnbrq]{0,63}$/i.test(l)))return 13;if(i.length!==8)return 7;if(u[3][1]===`3`&&u[1]===`w`||u[3][1]===`6`&&u[1]===`b`)return 11;for(u[3]!==`-`&&(p=u[3][1]===`3`?4:3,m=p===4?5:2,f=u[3].charCodeAt(0)-97,h=!1,g=p===4?`P`:`p`),r=0;r<i.length;++r){for(j=0,M=!1,N=0;N< __get$(i,r) .length;N++)if(a= __get$(__get$(i,r),N) ,+a==+a){if(M)return 8;j+=a*1,M=!0}else{if(P.indexOf(a)===-1)return 9;if(!h&&p===r&&f===j&&g===a&&(h=!0),m===r&&f===j)return 11;r%7==0&&(a=== __get$(y,r) ? __set$(v,r,1<<j) :a=== __get$(b,r) &&(_[r]|=1<<j)),++j,M=!1}if(j!==8)return 10}if(!h)return 11;if(w!==`-`){if(C){for(E={0:0,1:0,2:252,4:248,8:240,16:224,32:192,64:128,128:0},T={0:0,1:0,2:1,4:3,8:7,16:15,32:31,64:63,128:0},A={0:[0,0],7:[0,0]},r=w.length-1;r>=0;--r)if(k=w.charCodeAt(r),ee&&ee>k&&ee-k<8||(k===75?(O=7,D= __get$(_,O) & __get$(E,__get$(v,O)) ):k===81?(O=7,D= __get$(_,O) & __get$(T,__get$(v,O)) ):k===107?(O=0,D= __get$(_,O) & __get$(E,__get$(v,O)) ):k===113?(O=0,D= __get$(_,O) & __get$(T,__get$(v,O)) ):(O=k>=97?0:7,D=1<<k-(O?65:97),ee=k),!D||D&D-1)|| __get$(v,O) <2|| __get$(v,O) >64||(D& __get$(_,O) )!==D||++ __get$(A,O) [( __get$(v,O) <D)*1]>1)return 15}else if(x=(w.indexOf(`K`)>-1?128:0)|(w.indexOf(`Q`)>-1?1:0),x&&(v[7]!==16||(x&_[7])!==x)||(S=(w.indexOf(`k`)>-1?128:0)|(w.indexOf(`q`)>-1?1:0),S&&(v[0]!==16||(S&_[0])!==S)))return 15}return 0}function ke(e,t){var n=``,r=0,i,a,o=t?6:0;if(e)for(;r<5;){for(i=e>> __get$(ue,r) & __get$(de,r) ,a=0;a<i;++a)n+= __get$(P,r+o) ;++r}return n}function Ae(e,n){ __get$(n,p) &&B(e, __get$(t.zobristCheck,__get$(n,p)-1) ), __get$(n,m) &&B(e, __get$(t.zobristCheck,__get$(n,m)+2) )}function je(e,n){var r,i,a,o,s=0,c,l,u;for(r=1;r<3;++r){if(i= __get$(n,r) ,i)for(a=0;a<5;){for(c=s+a*63,o=i>> __get$(ue,a) & __get$(de,a) ,l=0;l<o;++l)u= __get$(t.zobristPiece,c++) ,B(e,[u[0]*31>>>0,u[1]*17>>>0]);++a}s=315}}function Me(e,n,r,i){( __get$(e,r+1) ===i|| __get$(e,r-1) ===i)&&B(n, __get$(t.zobristEnPassant,be(r)) )}function Ne(e,t){var n=[],r,i;for(r=0;r<120;++r)if(r&136&&(r+=8),i= __get$(e,r) ,i&&(i&t)===t){n.push(r);continue}return n}function Pe(e,t,n,r){var i;(a===0|| __get$(e,n+8) &O)&&(ye(n)%7==0?(i=r|z.PROMOTION|t<<A|n<<j, __set$(c,u++,i|4<<M) , __set$(c,u++,i|3<<M) , __set$(c,u++,i|2<<M) , __set$(c,u++,i|1<<M) ): __set$(c,u++,r|t<<A|n<<j) )}function Fe(e){switch(e){case 67:case 68:case 51:case 52:return!0}return!1}function Ie(e,t,n,r){var i=t+(n-t%8),a=n>t%8?1:-1,o,s,c;for(c=t+a;c!==i;c+=a)if( __get$(e,c) )return!1;if(o=r===p?a===1?118:114:a===1?6:2,s=o-a, __get$(e,o+8) || __get$(e,o) &&o!==t&&o!==i|| __get$(e,s) &&s!==t&&s!==i)return!1;if(o!==t){for(a=o>t?1:-1,c=t+a;c!==o;c+=a)if(c!==i&& __get$(e,c) || __get$(e,c+8) )return!1}return!0}var Le=function(){function t(n,r,i,a,o,s,c){var l=[],u=``,d=!0,f,h,g,_,v,y,b= __get$(r,i) ,x=b.length,S,C,w=``;if(b.commands)for(_ in b.commands)(!s||s.indexOf(_)>-1)&&(w+=`[%`+_+` `+ __get$(b.commands,_) +`]`);for(b.initComment&&!c&&(w=(w+` `+ __call$(b.initComment,"replace",[/(\"|\}|\%|\\)/g,`\\$1`]) ).trim()),w&&l.push(`{`+w+`}`),h=0;h<x;++h){if(f= __get$(b,h) ,y=f.color===p,u=``,w=``,a===e.Bughouse?(l.bughouseOrder||=[],l.bughouseOrder.push(f.bughouseOrder),h||(l.blackCountOffset=b[0].color===m?1:0)):(d&&!y?u=n+`...`:y&&(u=n+`.`),o&&(y||d)&&(u+=` `)),u+=f.san,f.annotation&&(u+=f.annotation),f.additionalAnnotation&&(u+=` `+f.additionalAnnotation.join(` `)),d=!1,f.time!==void 0&&!f.commands&&(f.commands={clk:V(f.time)}),f.commands)for(_ in f.commands)(!s||s.indexOf(_)>-1)&&(w+=`[%`+_+` `+ __get$(f.commands,_) +`]`);if(f.comment&&!c&&(w=(w+` `+ __call$(f.comment,"replace",[/(\"|\}|\%|\\)/g,`\\$1`]) ).trim()),w&&(u+=` {`+w+`}`,d=!0),l.push(u),f.lines)for(S=f.lines.length,g=0;g<S;++g)C= __get$(f.lines,g) , __get$(r,C) .length&&(v=t(n,r,C,a,o,s,c),v[0]=`(`+v[0], __set$(v,v.length-1,__get$(v,v.length-1)+`)`) ,l=l.concat(v),d=!0);y||n++}return l}function n(e,t,n){var r=t,i=e.siblingGame.pgn(),a=0,o=0,s=[];for(t.bughouseOrder=t.bughouseOrder||[],i.bughouseOrder=i.bughouseOrder||[];t.bughouseOrder.length||i.bughouseOrder.length;)!t.bughouseOrder.length||i.bughouseOrder.length&&t.bughouseOrder[0]>i.bughouseOrder[0]?(i.bughouseOrder.shift(),s.push(`B`)):(t.bughouseOrder.shift(),s.push(`A`));return t=[],s.forEach(function(s){var c,l,u=``,d;s===`A`?(c=r,++a,l=a,d=e.startingMoveNumber()):(c=i,++o,l=o,d=e.siblingGame.startingMoveNumber()),u=String(Math.floor((l+1)/2)+d-1),(c.blackCountOffset+l)%2?u+=s:u+=s.toLowerCase(),u+=`.`+(n?` `:``)+c.shift(),t.push(u)}),t}function r(e,t){return`[`+e+` "`+ __call$(String(t),"replace",[/(\"|\\)/g,`\\$1`]) +`"]`}return function(i,a,o,s,c,l){var u=typeof i.newline==`string`?i.newline:`
`,d=i.spaceAfterPeriods===void 0?!0:i.spaceAfterPeriods,f=``,p,m;for(p in f+=r(`Event`,a.Event)+u,f+=r(`Site`,a.Site)+u,f+=r(`Date`,a.Date)+u,f+=r(`Round`,a.Round)+u,c===e.Bughouse?(f+=r(`WhiteA`,a.WhiteA||`?`)+u,f+=r(`BlackA`,a.BlackA||`?`)+u,f+=r(`WhiteB`,a.WhiteB||`?`)+u,f+=r(`BlackB`,a.BlackB||`?`)+u):(f+=r(`White`,a.White)+u,f+=r(`Black`,a.Black)+u),f+=r(`Result`,a.Result)+u,c&&(f+=r(`Variant`,a.Variant)+u),a.FEN&&a.FEN!==te&&(f+=r(`SetUp`,`1`)+u,f+=r(`FEN`,a.FEN)+u),a)ve.indexOf(p)===-1&&(f+=r(p, __get$(a,p) )+u);if(f+=u,m=t(s,o,0,c,d,i.hideCommands?[]:i.restrictCommands,i.hideComments),c===e.Bughouse){if(l.isDependent)return m;m=n(l,m,d)}return m.push(a.Result),f+Ce(m.join(` `),i.maxWidth,u)}}(),Re=function(){var e=`!?~`,t=/\[%(\S+)\s([^\]]+)\]/,n=/^(?:[+=~\/\-\u2212]+|T?N|RR|D)$/;function r(e){for(var n,r=e.commands||{};n=t.exec(e.value);)e.value= __call$(e.value,"replace",[n[0],``]) .trim(), __set$(r,n[1],n[2]) ,e.commands=r}function i(e,t,n,r){for(var i;++t<n;)if((i= __get$(e,t) .trim())&&i[0]!==`%`)return i[0]===`[`&&(!r||/^\[\S+\s+".*"\]$/.test(i))}return function(t,a){var o,s,c,l,u=`tags`,d,f,p,m=[],h={type:u,value:``},g=0,_=[],v=!0;a||={},o=t.split(/\r?\n/),l=o.length;nextLine:for(s=0;s<l;++s)if(c= __get$(o,s) .trim(),c[0]!==`%`)if(!c)m.length&&(u===`tags`?(u=`san`,v=!1):u!==`tagValueStart`&&i(o,s,l,g||u===`comment`)&&(u===`comment`&&m.push(h), __get$(m,m.length-1) .type!==`tagValue`&&(_.push(m),m=[]),u=`tags`,v=!0,g=0));else{if(c=` `+c+` `,f=c.length,d=0,v)for(;d<f;++d)if(p= __get$(c,d) ,u===`tags`){if(p===`[`)u=`tagName`,h={type:u,value:``};else if(p.trim()){u=`san`,h={type:u,value:``},v=!1;break}}else if(u===`tagName`)h.value&&p.trim()===``?(m.push(h),u=`tagValueStart`):p!==` `&&(h.value+=p);else if(u===`tagValueStart`){if(p===`"`||p===``)u=`tagValue`,h={type:u,value:``};else if(p.trim()){m.push({type:`tagValue`,value:c.slice(d,-1).match(/(.*?)"?\]?$/)[1]}),u=`tags`,h={type:u,value:``};continue nextLine}}else if(u===`tagValue`)if(p===`"`||p===``)if(m.push(h), __get$(c,d+1) ===`]`)u=`tags`,h={type:u,value:``},++d;else if(c.slice(-2,-1)===`]`){h.value+=c.substr(d).match(/(.*?)"?\s*\] $/)[1],u=`tags`,h={type:u,value:``};continue nextLine}else u=`tagEnd`;else p===`\\`&&d+2<f&&(++d,p= __get$(c,d) ),d>0&&(h.value+=p);else{if(p!==`]`){if(!p.trim())continue;--d}u=`tags`,h={type:u,value:``}}for(;d<f;++d)if(p= __get$(c,d) ,u===`san`){if(e.indexOf(p)>-1)p===`!`||p===`?`||e.indexOf(p)<6&&(p= __get$([`!!`,`??`,`!?`,`?!`],e.indexOf(p)-2) )?(h.value&&m.push(h),h={type:`a`,value:p},( __get$(c,d+1) ===`!`|| __get$(c,d+1) ===`?`)&&(h.value+= __get$(c,++d) ),m.push(h),h={type:`san`,value:``}):(p===``&&h.value===`=/`?(h.type=`aa`,h.value+=p):(h.value&&(n.test(h.value)&&(h.value!==`--`||a.rejectNullMoves)&&(h.type=`aa`),m.push(h)),h={type:`aa`,value:p},p===``&& __get$(c,d+1) ===``&&(h.value=``,++d)),m.push(h),h={type:`san`,value:``});else if(p===` `||p===`	`||p===`\r`||p===`{`||p===`(`||p===`)`){if(h.value){if(h.value[0]===`$`)h.type=`nag`;else if(h.value===`*`||h.value===`1-0`||h.value===`0-1`||h.value===`1/2-1/2`||h.value===`-`)if(g||d+1<f)h.type=h.value===`*`?`cont`:`comment`;else{if(h.type=`result`,h.value===`-`&&(h.value=`1/2-1/2`),m.push(h),_.push(m),s+1===l||s+2===l&&! __get$(o,s+1) )return _;u=`tags`,v=!0,h={type:u,value:``},m=[];break}n.test(h.value)&&(h.value!==`--`||a.rejectNullMoves)&&(h.type=`aa`),m.push(h),h={type:u,value:``}}if(p===` `||p===`	`||p===`\r`)u=`san`;else if(p===`{`)u=`comment`,m.length&& __get$(m,m.length-1) .type===`comment`&&(h=m.pop(),h.value+=` `);else if(p===`(`)u=`san`,m.push({type:`variationStart`,value:++g});else{if(g<1){if(!a.commentErrors)return!1}else m.push({type:`variationEnd`,value:g--});u=`san`}h.type=u}else if(p!==`.`&&(h.value||+p!=+p|| __get$(c,d+1) ===`-`|| __get$(c,d+1) ===`/`))h.value+=p;else if(+p==+p)switch(h.number||=``,h.number+=p, __get$(c,d+1) ){case`A`:case`a`:case`B`:case`b`:h.number+= __get$(c,++d) ,m.push({type:`number`,value:h.number}),delete h.number}}else d===0&&(h.value=h.value.trim()),p===`}`?(h.value=h.value.trim(),h.value.indexOf(`[`)>-1&&r(h),m.push(h),u=`san`,h={type:u,value:``}):(p===`\\`&&d+2<f&&(p= __get$(c,++d) ),h.value+=p)}return h.value&&m.push(h),(m.length||!_.length)&&_.push(m),_}}();function ze(ve,Ce){var V,H,Be=0,Ve=!0,U=[],W=p,G=[],He=f,Ue=0,We=1,Ge=1,Ke=[],qe=[Ke],Je=0;Ke.id=Je;var Ye={},Xe=[],Ze=!1,Qe=!1,$e=jt,et=function(e,t){var n=``,r,i,a,o,s,c;return e&z.KQSIDE_CASTLE?n=e&z.KSIDE_CASTLE?`O-O`:`O-O-O`:e&z.DROP?(a=e>>j&N,r=e>>M,r&&(n+= __get$(me,r) ),n+=`@`+xe(a)):(a=e>>j&N,i=e>>A&N,o= __get$(H,i) ,o&h?(e&z.ANY_CAPTURE&&(n+=String.fromCharCode(be(i)+97)+`x`),n+=xe(a),e&z.PROMOTION&&(r=e>>M,n+=`=`+ __get$(me,r) )):(n+= __get$(ie,o&C) ,d>1&&(n+=Ft(o,i,a)),e&z.ANY_CAPTURE&&(n+=`x`),n+=xe(a))),t||(e&z.KQSIDE_CASTLE?(i=e>>A&N,a=e>>j&N):e&z.DROP_OR_PROMOTE&&(o= __get$(pe,r) +W),xt(o,i,a,e)&&($e(e,i,a,r),s=l,l=u,c=d,Be&&Lt()||bt()===l?n+=`#`:n+=`+`,u=l,l=s,d=c,Pt(Ke.pop()))),n};function tt(){var n=W===p?[4174784170,2938602761]:[0,0],r,i,a;for(a=0;a<120;++a)a&136&&(a+=8),r= __get$(H,a) ,r&&B(n, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,r&C)+8*(7-ye(a))+be(a)) );if(Qe)for(i=1;i<3;++i) __get$(G,i) &&( __get$(G,i) & __get$(G,i) -1?(B(n, __get$(t.zobristCastle,i-1) ),B(n, __get$(t.zobristCastle,i+1) )): __get$(G,i) >1<<be( __get$(U,i) )?B(n, __get$(t.zobristCastle,i-1) ):B(n, __get$(t.zobristCastle,i+1) ));else{for(i=1;i<3;++i) __get$(G,i) &&( __get$(G,i) &z.KSIDE_CASTLE&&B(n, __get$(t.zobristCastle,i-1) ), __get$(G,i) &z.QSIDE_CASTLE&&B(n, __get$(t.zobristCastle,i+1) ));Ze?je(n,V._hand):Be=== __get$(e,`3-check`) &&Ae(n,Xe)}return He!==f&&Me(H,n,He+(W===p?16:-16),h|W),n}function nt(){var e;return Ke.length?e= __get$(Ke,Ke.length-1) .hash:(Ke.hash||=tt(),e=Ke.hash),[e[0],e[1]]}function rt(e){function t(e){return/#/.test(e)&&Tt()&&(e= __call$(e,"replace",[`#`,`+`]) ),e}function n(n,r){var i=e(n,r);return i&&(typeof i==`string`?i=t(i):(i.san=t(i.san), __get$(Ke,Ke.length-1) .san=i.san)),i}return n._isBughouseified=!0,n._orig=e,n}function it(t,n){var r=Be;Be=t? __get$(e,t) ||t*1|| __get$(e,__call$(String(t),"replace",[/\s/g,``]).toLowerCase()) ||e.Chess:0,r!==Be&&(Be===e.Bughouse?(Ze=!0,V.isDependent||(V.siblingGame=ze(),V.siblingGame.hashing(Ve),V.siblingGame.isDependent=!0,V.siblingGame.siblingGame=V,V.siblingGame.header({Variant:`Bughouse`})),Ee(),$e=Nt,et=rt(et),V.move=rt(V.move)):(delete V.siblingGame,Ze=Be===e.Crazyhouse,Qe=Be===e.Chess960,Be?(Ee(),$e=Nt):$e=jt,et._isBughouseified&&(et=et._orig,V.move=V.move._orig)),n||pt(dt()))}function at(e,t){for(var n=e>7?p:m,r,i;!(e&136);){if(r= __get$(H,e) ,r&n){if(r&v){if(i)return;i=e%8+(n===p?65:97)}else if(r&b)return i}e+=t}}function ot(e,t,n){H=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=p, __set$(U,p,f) , __set$(U,m,f) , __set$(G,p,0) , __set$(G,m,0) , __set$(V._hand,p,0) , __set$(V._hand,m,0) , __set$(Xe,p,0) , __set$(Xe,m,0) ,He=f,Ue=0,We=1,t||(Ke=[],qe=[Ke],Je=0,Ke.id=Je,Ye={Event:`?`,Site:`?`,Date:`????.??.??`,Round:`?`,White:`?`,Black:`?`,Result:`*`},e?ft([`Variant`,e]):it(!1,n),n||pt(dt()))}function st(){ot(0,!1,!0),Ke.hash=[1178310168,378666140],H=[34,10,18,66,130,18,10,34,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,33,9,17,65,129,17,9,33,0,0,0,0,0,0,0,0],Ge=1, __set$(U,p,116) , __set$(U,m,4) , __set$(G,p,48) , __set$(G,m,48) }function ct(t,i,a,o){var s=0,c,l,u,d,g,_,y,S,C,w,E,D;if(o?(c=t.split(` `),D=c[3],E=c[2]):(c=t.trim().split(/\s+/),D=c[3]||`-`,E=c[2]||`-`),i===void 0?(E.charCodeAt(0)&31)<9&&it(e.Chess960,!0):it(i,!0),l=c[0],!o&&!(l=De(l,Be)))return!1;if(d=l.length,ot( __get$(n,Be) ,a,!0),Ze){if(Be===e.Bughouse&&!V.isDependent&&(_=t.split(` | `),!V.siblingGame.load(_.length===1?t:_[1],i,a,o)))return st(),!1;for(g=0;g<d;++g)if(y= __get$(l,g) ,+y!=+y)if(y===`/`)if(s>111){for(++g;g<d;++g)y= __get$(l,g) , __set$(V._hand,y<`a`?p:m,__get$(V._hand,y<`a`?p:m)+(1<<__get$(fe,y)>>>0)) ;break}else s+=8;else  __set$(H,s,__get$(ne,y)) , __get$(l,g+1) ===`~`&&(++g,H[s]|=T), __get$(H,s) &b&&( __set$(U,__get$(H,s)&x,s) ),++s;else s+=y*1}else for(g=0;g<d;++g)y= __get$(l,g) ,+y==+y?s+=y*1:y===`/`?s+=8:( __set$(H,s,__get$(ne,y)) , __get$(H,s) &b&&( __set$(U,__get$(H,s)&x,s) ),++s);if(W=c[1]===`b`?m:p,E!==`-`)if(Qe){for(C={1:[0,0],2:[0,0]},g=E.length-1;g>=0;--g)u=E.charCodeAt(g),u===75?u=at(119,-1):u===81?u=at(112,1):u===107?u=at(7,-1):u===113&&(u=at(0,1)),S=u<97?p:m,w= __get$(ge,String.fromCharCode(u)) ,(o|| __get$(H,w) ===(v|S))&&(u>=97? __get$(U,S) >=1&& __get$(U,S) <=6&&(G[S]|=1<<w): __get$(U,S) >=113&& __get$(U,S) <=118&&(G[S]|=1<<w-112),++ __get$(C,S) [( __get$(U,S) <w)*1]);( __get$(C,p) [0]>1|| __get$(C,p) [1]>1)&&( __set$(G,p,0) ),( __get$(C,m) [0]>1|| __get$(C,m) [1]>1)&&( __set$(G,m,0) )}else{if(!o)for(g=E.length-1;g>=0;--g)S=E.charCodeAt(g)<97?p:m,( __get$(H,__get$(ge,__get$(E,g))) !==(v|S)|| __get$(U,S) !==(S===p?116:4))&&(E=E.substr(0,g)+E.substr(g+1));for(g=E.length-1;g>=0;--g)switch( __get$(E,g) ){case`K`:G[p]|=z.KSIDE_CASTLE;break;case`Q`:G[p]|=z.QSIDE_CASTLE;break;case`k`:G[m]|=z.KSIDE_CASTLE;break;case`q`:G[m]|=z.QSIDE_CASTLE;break}}return!o&&(D.length!==2||W===p&&D[1]!==`6`||W===m&&D[1]!==`3`|| __get$(H,D.charCodeAt(0)-97+(8-(D[1]===`3`?4:5))*16) !==(h|Se(W))|| __get$(H,__get$(r,D)) )&&(D=`-`),He=D===`-`?f: __get$(r,D) ,Ue=c[4]*1||0,We=c[5]*1||1,Be=== __get$(e,`3-check`) &&(c[6]&&c[6]!==`+3+3`&&(_=c[6].match(/^\+([0-3])\+([0-3])$/)),_||=[0,0,0], __set$(Xe,p,_[1]*1) , __set$(Xe,m,_[2]*1) ),a||(Ge=We,pt(dt())),!0}function lt(){var e=0,t=``,n,r=``,i;for(n=0;n<120;++n)n&136&&(e&&(t+=e),t+=`/`,e=0,n+=8),i= __get$(H,n) ,i?(e&&=(t+=e,0),t+= __get$(re,i&C) ):++e;return e&&(t+=e), __get$(G,p) &z.KSIDE_CASTLE&&(r+=`K`), __get$(G,p) &z.QSIDE_CASTLE&&(r+=`Q`), __get$(G,m) &z.KSIDE_CASTLE&&(r+=`k`), __get$(G,m) &z.QSIDE_CASTLE&&(r+=`q`),t+=` `+(W===p?`w`:`b`)+` `+(r||`-`)+` `+(He===f?`-`:xe(He))+` `+Ue+` `+We,t}function ut(){var t=0,n=``,r,i,a=``,o;for(r=0;r<120;++r)r&136&&(t&&(n+=t),n+=`/`,t=0,r+=8),o= __get$(H,r) ,o?(t&&=(n+=t,0),n+= __get$(re,o&C) ,Ze&&o&T&&(n+=`~`)):++t;if(t&&(n+=t),Ze&&(n+=`/`+ke( __get$(V._hand,p) ,!0)+ke( __get$(V._hand,m) )),Qe){for(i= __get$(G,m) ,r=0;i;)i&1&&(a=String.fromCharCode(r+97)+a),i>>=1,++r;for(i= __get$(G,p) ,r=0;i;)i&1&&(a=String.fromCharCode(r+65)+a),i>>=1,++r}else  __get$(G,p) &z.KSIDE_CASTLE&&(a+=`K`), __get$(G,p) &z.QSIDE_CASTLE&&(a+=`Q`), __get$(G,m) &z.KSIDE_CASTLE&&(a+=`k`), __get$(G,m) &z.QSIDE_CASTLE&&(a+=`q`);return n+=` `+(W===p?`w`:`b`)+` `+(a||`-`)+` `+(He===f?`-`:xe(He))+` `+Ue+` `+We,Be=== __get$(e,`3-check`) ?n+=` +`+ __get$(Xe,p) +`+`+ __get$(Xe,m) :Be===e.Bughouse&&!V.isDependent&&(n+=` | `+V.siblingGame.fen()),n}function dt(){return Be?ut():lt()}function ft(e){var t,r,i;for(t=0;t<e.length;t+=2)r= __get$(e,t) ,i= __get$(e,t+1) ,r&&(r===`Variant`&&(it(i),i=Be? __get$(n,Be) :void 0),r===`Result`&&i!==`*`&&i!==`1-0`&&i!==`0-1`&&i!==`1/2-1/2`&&(i=`*`),i===void 0?_e.indexOf(r)>-1?r===`Date`? __set$(Ye,r,`????.??.??`) : __set$(Ye,r,`?`) :delete Ye[r]: __set$(Ye,r,String(i)) );return Ye}function pt(e){Ke.length>0||Je||(e===te?(delete Ye.SetUp,delete Ye.FEN,Ke.hash=[1178310168,378666140]):(Ye.SetUp=`1`,Ye.FEN=e,Ke.hash=null))}function mt(e){var t= __get$(H,__get$(r,e)) ;return t?{type: __get$(re,t&S|m) ,color:t&x,promoted:(t&T)!==0}:null}function ht(e,t){return Qe&& __get$(G,e) ?ce: __get$(G,e) &z.KSIDE_CASTLE&&! __get$(H,t+1) &&! __get$(H,t+2) ? __get$(G,e) &z.QSIDE_CASTLE&&! __get$(H,t-1) &&! __get$(H,t-2) &&! __get$(H,t-3) ?(s=z.KQSIDE_CASTLE,se):(s=z.KSIDE_CASTLE,ae): __get$(G,e) &z.QSIDE_CASTLE&&! __get$(H,t-1) &&! __get$(H,t-2) &&! __get$(H,t-3) ?(s=z.QSIDE_CASTLE,oe):R}function gt(e,t){var n,r,c,l=W,u,d,p,m,g,_,v,y,b,x,C=H;if(i=[],a=0,o=0,s=0,C[8]=C[9]=C[10]=C[11]=C[12]=C[13]=C[14]=C[15]=C[24]=C[25]=C[26]=C[27]=C[28]=C[29]=C[30]=C[31]=C[40]=C[41]=C[42]=C[43]=C[44]=C[45]=C[46]=C[47]=C[56]=C[57]=C[58]=C[59]=C[60]=C[61]=C[62]=C[63]=C[72]=C[73]=C[74]=C[75]=C[76]=C[77]=C[78]=C[79]=C[88]=C[89]=C[90]=C[91]=C[92]=C[93]=C[94]=C[95]=C[104]=C[105]=C[106]=C[107]=C[108]=C[109]=C[110]=C[111]=C[120]=C[121]=C[122]=C[123]=C[124]=C[125]=C[126]=C[127]=0,t===f){i=Ne(H,l|e);return}for(b=ht(l,t),n=0;n<120;++n)if(n&136&&(n+=8),u= __get$(H,n) ,u){if(u&l){(!e||(u|0)&e)&&i.push(n);continue}if(x= __get$(b,n-t+119) ,(x&u)!==0)if(u&h)for(_= __get$(F,u) ,r=1;r<3;++r)m=n+ __get$(_,r) ,!(m&136)&&(C[m+8]|=D,m===t&&(++a,C[n+8]|=O));else{_= __get$(F,u&S) ,g=_.length,y=u&E;attackLoop:for(r=0;r<g;++r)if(v= __get$(_,r) ,m=n,!(t>m&&v<0&&t-m>16||t<m&&v>0&&m-t>16))for(;!((m+=v)&136);){if(C[m+8]|=D,d= __get$(H,m) ,d){if(d&l){if(m===t){for(c=m-v;c!==n;c-=v)C[c+8]|=O;C[n+8]|=O,++a,y&&(m+=v,m&136||(C[m+8]|=D))}else if(y&&x&w){for(p=m;(p+=v)!==t;)if(p&136|| __get$(H,p) )continue attackLoop;C[m+8]|=k+(Math.abs(v)<<ee),++o}}break}if(!y)break}}}a>1&&(i=[t])}function _t(e,t){var n,r,i=t+16*(W===p?1:-1),o;return a===1&&( __get$(H,t+8) &O)===0&&( __get$(H,i+8) &O)===0?!1:(n= __get$(H,e) , __set$(H,t,n) , __set$(H,e,0) ,r= __get$(H,i) , __set$(H,i,0) ,o=wt(), __set$(H,e,n) , __set$(H,t,0) , __set$(H,i,r) ,!o)}function vt(e){var t,n,r;if(Qe){if( __get$(G,e) )for(t= __get$(U,e) ,n=t%8,r=0;r<8;++r) __get$(G,e) &1<<r&&Ie(H,t,r,e)&&( __set$(c,u++,(r>n?z.KSIDE_CASTLE:z.QSIDE_CASTLE)+(t<<A)+(t+(r-n)<<j)) ,++r)}else s&z.KSIDE_CASTLE&&(t= __get$(U,e) ,n=t+2, __get$(H,t+9) ===0&& __get$(H,t+10) ===0&&( __set$(c,u++,z.KSIDE_CASTLE+(t<<A)+(n<<j)) )),s&z.QSIDE_CASTLE&&(t= __get$(U,e) ,n=t-2, __get$(H,t+7) ===0&& __get$(H,t+6) ===0&&( __set$(c,u++,z.QSIDE_CASTLE+(t<<A)+(n<<j)) ))}function yt(e,t,n){var r,i,o,s,l;if(!e){for(t&&(t>>=26),s=0;s<5;++s)if((!t||(t|0)==1<<s)&& __get$(V._hand,n) & __get$(de,s) << __get$(ue,s) ){for(s===0?(r=16,i=103,o=z.DROP):(r=0,i=119,o=z.DROP|s<<M),l=r;l<=i;++l)l&136&&(l+=8), __get$(H,l) ||(a===0||a===1&& __get$(H,l+8) &O)&&( __set$(c,u++,o|l<<j) );if(t)return}}}function bt(e,t){var n,r,s,f=W,p=Se(f),m,_,v,y,b,x= __get$(U,f) ,C,w;for(gt(e,x),d=i.length,u=l,C=0;C<d;++C)if(n= __get$(i,C) ,m= __get$(H,n) ,!(a&&o&& __get$(H,n+8) &k))if(m&h)for(v= __get$(F,m) ,(o===0||( __get$(H,n+8) &k)===0|| __get$(H,n+8) >>ee===16)&&(_=n+v[0], __get$(H,_) ===0&&(Pe(H,n,_,0), __get$(he,f) ===ye(n)&&(_+=v[0], __get$(H,_) ||Pe(H,n,_,z.BIG_PAWN)))),r=1;r<3;++r)y= __get$(v,r) ,_=n+y,!(_&136||o&& __get$(H,n+8) &k&& __get$(H,n+8) >>ee!==Math.abs(y))&&( __get$(H,_) &p?Pe(H,n,_,z.CAPTURE):_===He&&_t(n,_)&&( __set$(c,u++,z.EP_CAPTURE|n<<A|_<<j) ));else{if(o&& __get$(H,n+8) &k){if(m&g)continue;if( __get$(L,n-__get$(U,f)+119) &m)y= __get$(H,n+8) >>ee,v=[y,-y];else continue}else v= __get$(F,m&S) ;if(w=n<<A,n===x){for(r=0;r<8;++r)y= __get$(v,r) ,_=n+y,_&136||( __get$(H,_) ? __get$(H,_) &p&&( __get$(H,_+8) &D)===0&&( __set$(c,u++,z.CAPTURE|w|_<<j) ):( __get$(H,_+8) &D)===0&&( __set$(c,u++,w|_<<j) ));a===0&&vt(f)}else for(s=v.length,b=m&E,r=0;r<s;++r)for(y= __get$(v,r) ,_=n;_+=y,!(_&136);){if( __get$(H,_) ){ __get$(H,_) &p&&(a===0|| __get$(H,_+8) &O)&&( __set$(c,u++,z.CAPTURE|w|_<<j) );break}else (a===0|| __get$(H,_+8) &O)&&( __set$(c,u++,w|_<<j) );if(!b)break}}return Be&&(Ze?yt(t,e,f):!Qe&&Lt()&&(u=l)),u}function xt(t,n,r,i){var a,o,s,c,l,u,d,m,g;if(Be=== __get$(e,`King of the Hill`) &&t&b&&Fe(r))return!0;if(i&z.KQSIDE_CASTLE&&(r=W===p?i&z.KSIDE_CASTLE?117:115:i&z.KSIDE_CASTLE?5:3,t=v,g=!0),a= __get$(U,Se(W)) ,a===f)return!1;if((t&b)===0&&(o= __get$(L,r-a+119) ,o&t))for(c= __get$(le,r-a+119) ,u=t&E,l=r+c;!(l&136);){if(l===a){if(t&h){if((t&x)===p?a-r<0:a-r>0)return!0;break}return!0}if(l!==n&& __get$(H,l) ||!u)break;l+=c}if(!g){if(s= __get$(L,n-a+119) ,s&E&&(c= __get$(le,n-a+119) ,c!== __get$(le,r-a+119) ))for(l=a-c;!(l&136);){if(l!==n&&(d= __get$(H,l) ,d)){if(d&W&&s&d&&d&E)return!0;break}l-=c}if(i&z.EP_CAPTURE&&(m=r+16*(W===p?1:-1),s= __get$(L,m-a+119) ,s&E))for(c= __get$(le,m-a+119) ,l=a-c;!(l&136);){if(l!==n&&l!==m){if(l===r)break;if(d= __get$(H,l) ,d){if(d&W&&s&d&&d&E)return!0;break}}l-=c}}return!1}function St(e,t){var n,r,i,a= __get$(F,g) ,o,s=g|e;for(n=0;n<8;++n)if(i=t+ __get$(a,n) ,!(i&136)&&(r= __get$(H,i) ,(r&s)===s))return!0;for(a= __get$(F,b) ,n=0;n<8;++n)for(o= __get$(a,n) ,i=t+o;!(i&136);){if(r= __get$(H,i) ,r){if(r&e&& __get$(L,t-i+119) &r)if(r&h){if(e===p?t-i<0:t-i>0)return!0}else return!0;break}i+=o}return!1}function Ct(e){return  __get$(U,e) !==f&&St(Se(e), __get$(U,e) )}function wt(){return Ct(W)}function Tt(){var e,t,n,r=1<<ue[4];return  __set$(V._hand,W,__get$(V._hand,W)+r) ,e=l,l=u,t=d,n=bt()!==l,u=l,l=e,d=t,V._hand[W]-=r,n}function Et(){return wt()&&(c[0]=0)===bt()&&!c[0]&&(Be!==e.Bughouse||!Tt())}function Dt(){var t=!wt()&&(c[0]=0)===bt()&&!c[0];return t&&Be===e.Bughouse&&!V.isDependent&&(t=V.siblingGame.inStalemate()),t&& __get$(U,W) !==f}function Ot(e){var t,n,r=100,i=0,a=0,o=0;for(n=0;n<120;++n)if(n&136&&(n+=8),t= __get$(H,n) ,t){if(e&&(t&e)===0)continue;if(r&t)return!1;if(t&g){if(a||i++)return!1}else if(t&_&&(i||(++a,(ye(n)+n)%2&&++o,o&&a!==o)))return!1}return  __get$(U,p) !==f&& __get$(U,m) !==f}function kt(){if(Ue<8)return!1;for(var e=nt(),t=!1,n,r=Ue,i=!1,a=Ke,o=a.length-1;;){if(o-=2,o<0){if(a.id){o=a.atMoveNode+o+2,a= __get$(qe,a.parentId) ;continue}if(o===-2)return!1;n=a.hash,i=!0}else n= __get$(a,o) .hash, __get$(a,o) .halfMoves>r||r<2?i=!0:r= __get$(a,o) .halfMoves;if(n[0]===e[0]&&n[1]===e[1]){if(t)return!0;t=!0}if(i)return!1}}function At(n){var r=n.move,i,a,o,s,c,l,u,d,f,m;if(Be===e.Crazyhouse||r&z.DROP?(a=V._hand,l=n.hash,m=n.color):(a=V.siblingGame._hand,n.handSibling=!0,Ve&&(u=V.siblingGame._history(),u.length?l= __get$(u,u.length-1) .hash:(u.hash||=V.siblingGame._hashPosition(),l=u.hash)),m=Se(n.color)),n.captured){switch(o=n.captured&T?h:n.captured&S,o&S){case h:d=0;break;case g:d=1;break;case _:d=2;break;case v:d=3;break;default:d=4}i=1<< __get$(ue,d) ,Ve&&(c= __get$(a,m) >> __get$(ue,d) & __get$(de,d) ,f= __get$(t.zobristPiece,c+63*d+(m===p?0:315)) )}else s=r>>M,i=-1<< __get$(ue,s) ,Ve&&(c= __get$(a,m) >> __get$(ue,s) & __get$(de,s) ,f= __get$(t.zobristPiece,c-1+63*s+(m===p?0:315)) ); __set$(a,m,__get$(a,m)+i) ,n.handChange=i,Ve&&B(l,[f[0]*31>>>0,f[1]*17>>>0])}function jt(e,n,r,i){var a=W,o=Se(a),s,c,l,u,d={move:e,epSquare:He,halfMoves:Ue,castlingW: __get$(G,p) ,castlingB: __get$(G,m) ,color:a},g,_,y=a===p,x,S;Ve&&(u=nt(),d.hash=u,B(u,t.zobristTurn),He!==f&&Me(H,u,He+(y?16:-16),h|a)),(e&z.KQSIDE_CASTLE)===0?Ze&&e&z.DROP?( __set$(H,r,__get$(pe,i)|a) ,Ve&&B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,__get$(H,r))+8*(7-ye(r))+be(r)) ),At(d),x=0):(x= __get$(H,n) ,S= __get$(H,r) ,S&&(d.captured=S,Ve&&B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,__get$(H,r)&C)+8*(7-ye(r))+be(r)) ),S&v&& __get$(G,o) &&(Qe?ye(r)===(y?0:7)&&(l=1<<be(r), __get$(G,o) &l&&(G[o]^=l,Ve&&(l>1<<be( __get$(U,a) )?B(u, __get$(t.zobristCastle,o-1) ):B(u, __get$(t.zobristCastle,o+1) )))):r===(y?7:119)? __get$(G,o) &z.KSIDE_CASTLE&&(G[o]^=z.KSIDE_CASTLE,Ve&&B(u, __get$(t.zobristCastle,o-1) )):r===(y?0:112)&& __get$(G,o) &z.QSIDE_CASTLE&&(G[o]^=z.QSIDE_CASTLE,Ve&&B(u, __get$(t.zobristCastle,o+1) )))),e&z.PROMOTION? __set$(H,r,__get$(pe,i)|a|T) : __set$(H,r,__get$(H,n)) , __set$(H,n,0) ,Ve&&(B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,x&C)+8*(7-ye(n))+be(n)) ),B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,__get$(H,r)&C)+8*(7-ye(r))+be(r)) ))):x=b,e&z.EP_CAPTURE?(y?(_=r+16,g=6):(_=r-16,g=8),d.captured=h|o, __set$(H,_,0) ,Ve&&B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,h|o)+8*(g-ye(r))+be(r)) )):x&b?(Qe?(e&z.KQSIDE_CASTLE&&( __set$(H,r,0) , __set$(H,n,0) ,e&z.KSIDE_CASTLE?y?(s=118,c=117):(s=6,c=5):y?(s=114,c=115):(s=2,c=3), __set$(H,s,a|b) , __set$(H,c,a|v) ,Ve&&(B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,b|a)+8*(7-ye(n))+be(n)) ),B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,v|a)+8*(7-ye(r))+be(r)) ),B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,b|a)+8*(7-ye(s))+be(s)) ),B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,v|a)+8*(7-ye(c))+be(c)) ))),Ve&&( __get$(G,a) & __get$(G,a) -1?(B(u, __get$(t.zobristCastle,a-1) ),B(u, __get$(t.zobristCastle,a+1) )): __get$(G,a) >1<<be( __get$(U,a) )?B(u, __get$(t.zobristCastle,a-1) ):B(u, __get$(t.zobristCastle,a+1) )), __set$(U,a,s||r) ):(e&z.KQSIDE_CASTLE&&( __set$(H,r,__get$(H,n)) , __set$(H,n,0) ,e&z.KSIDE_CASTLE?(s=r-1,c=r+1):(s=r+1,c=r-2), __set$(H,s,__get$(H,c)) , __set$(H,c,0) ,Ve&&(B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,b|a)+8*(7-ye(n))+be(n)) ),B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,v|a)+8*(7-ye(c))+be(c)) ),B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,b|a)+8*(7-ye(r))+be(r)) ),B(u, __get$(t.zobristPiece,64*__get$(t.zobristPieceValueNumbers,v|a)+8*(7-ye(s))+be(s)) ))),Ve&&( __get$(G,a) &z.KSIDE_CASTLE&&B(u, __get$(t.zobristCastle,a-1) ), __get$(G,a) &z.QSIDE_CASTLE&&B(u, __get$(t.zobristCastle,a+1) )), __set$(U,a,r) ), __set$(G,a,0) ):x&v&& __get$(G,a) &&(Qe?ye(n)===(y?7:0)&&(l=1<<be(n), __get$(G,a) &l&&(G[a]^=l,Ve&&(l>1<<be( __get$(U,a) )?B(u, __get$(t.zobristCastle,a-1) ):B(u, __get$(t.zobristCastle,a+1) )))):n===(y?119:7)? __get$(G,a) &z.KSIDE_CASTLE&&(G[a]^=z.KSIDE_CASTLE,Ve&&B(u, __get$(t.zobristCastle,a-1) )):n===(y?112:0)&& __get$(G,a) &z.QSIDE_CASTLE&&(G[a]^=z.QSIDE_CASTLE,Ve&&B(u, __get$(t.zobristCastle,a+1) ))),e&z.BIG_PAWN?(He=y?r+16:r-16,Ve&&Me(H,u,r,h|o)):He=f,x&h||e&z.ANY_CAPTURE?Ue=0:Ue++,W=o,Ke.push(d)}function Mt(){var e={color:W,san:`--`,epSquare:He},n={color:W,san:`--`},r;return Ve&&(r=nt(),e.hash=r,B(r,t.zobristTurn),He!==f&&Me(H,r,He+(W===p?16:-16),h|W)),He=f,Ue++,W=Se(W),W===p&&++We,Ke.push(e),n}function Nt(n,r,i,a){var o,s=W;jt(n,r,i,a),o= __get$(Ke,Ke.length-1) ,Ze?(Ue=o.halfMoves+1,o.captured&&At(o),Be===e.Bughouse&&(o.bughouseOrder=V.moveCount()-1+V.siblingGame.moveCount())):Be=== __get$(e,`3-check`) &&Ct(W)&&(o.checked=!0,Ve&& __get$(Xe,s) &&B(o.hash, __get$(t.zobristCheck,__get$(Xe,s)+(s===p?-1:2)) ),++Xe[s],Ve&&B(o.hash, __get$(t.zobristCheck,__get$(Xe,s)+(s===p?-1:2)) ))}function Pt(t){var n,r,i=W,a=Se(i),o=t.move,s=o>>j&N,c=o>>A&N;if(W=a, __set$(G,m,t.castlingB) , __set$(G,p,t.castlingW) ,He=t.epSquare,Ue=t.halfMoves,Be){if(Qe&&o&z.KQSIDE_CASTLE){o&z.KSIDE_CASTLE?a===p?(r=118,n=117):(r=6,n=5):a===p?(r=114,n=115):(r=2,n=3), __set$(H,r,0) , __set$(H,n,0) , __set$(H,c,a|b) , __set$(H,s,a|v) , __set$(U,a,c) ;return}if(t.handChange&&(Be===e.Crazyhouse||!t.handSibling?V._hand[a]-=t.handChange:V.siblingGame._hand[Se(a)]-=t.handChange),o&z.DROP){ __set$(H,s,0) ;return}t.checked&&--Xe[a]}o&z.PROMOTION?( __set$(H,c,h|a) ,o&z.CAPTURE? __set$(H,s,t.captured) : __set$(H,s,0) ):( __set$(H,c,__get$(H,s)) ,o&z.KQSIDE_CASTLE?( __set$(H,s,0) ,o&z.KSIDE_CASTLE?(n=s+1,r=s-1):(n=s-2,r=s+1), __set$(H,n,a|v) , __set$(H,r,0) , __set$(U,a,c) ):(s=== __get$(U,a) &&( __set$(U,a,c) ),o&z.CAPTURE? __set$(H,s,t.captured) :( __set$(H,s,0) ,o&z.EP_CAPTURE&&( __set$(H,s-(a===p?-16:16),h|i) ))))}function Ft(e,t,n){var r,i,a,o,s,l,d,f;if(u<2)return``;for(e&=S,f=0;f<u;++f)if(r= __get$(c,f) ,d=r>>j,n===d&&(o=r>>A&N,o!==t&&(i= __get$(H,o) ,i&e))){if(a=!0,ye(t)===ye(o)){if(s)return xe(t);l=!0}if(be(t)===be(o)){if(l)return xe(t);s=!0}}return a?s?String(8-ye(t)):String.fromCharCode(be(t)+97):``}function It(e,t,n){var r,i,a=e>>j&N,o={color:W,to:xe(a),flags:e&N};return!Ze||(e&z.DROP)===0?(r=e>>A&N,o.from=xe(r),o.piece= __get$(H,r) ,e&z.PROMOTION&&(i=e>>M,o.promotion= __get$(pe,i) +W),e&z.CAPTURE?o.captured= __get$(H,a) :e&z.EP_CAPTURE&&(o.captured=h|Se(W))):(i=e>>M,o.drop=i,o.piece= __get$(pe,i) +W),t?o.san=t:o.san=et(e,n),o}function Lt(){if(Be=== __get$(e,`3-check`) )return  __get$(Xe,Se(W)) ===3;if(Be=== __get$(e,`King of the Hill`) )return Fe( __get$(U,Se(W)) )}function Rt(){if(Be===e.Bughouse)return V.siblingGame.inCheckmate()}function zt(){if(Be===e.Bughouse)return V.siblingGame.in50MoveRule()||V.siblingGame.inThreefoldRepetition()}function Bt(){var e=[],t=dt(),n=Ke.length-1,r= __get$(Ke,n) ;return r?(e.parentId=Je,e.id=qe.length,Ke.curFen=t,r.lines||=[],r.lines.push(e.id),r.move?Pt(r):(He=r.epSquare,--Ue,W=Se(W)),W===m&&--We,e.atMoveNode=n,n?e.hash= __get$(Ke,n-1) .hash:e.hash=Ke.hash,Je=e.id,qe.push(e),Ke=e,!0):!1}function Vt(e){Ke.curFen=dt(),Ke= __get$(qe,e) ,Je=e,ct(Ke.curFen,Be,!0,!0)}return V={WHITE:p,BLACK:m,PAWN:h,KNIGHT:g,BISHOP:_,ROOK:v,QUEEN:y,KING:b,FLAGS:z,load:ct,reset:st,moves:function(e){var t=[],n,r=et,i,a;for(e&&(e.verbose&&(r=It),e.type&&(i=e.type|e.type<<24),a=e.noDrop),bt(i,a),n=0;n<u;++n)t.push(r( __get$(c,n) ));return t},inCheck:wt,inCheckmate:Et,inStalemate:Dt,isBughouseWin:Rt,in50MoveRule:function(){return Ue>=100},inDraw:function(){return Ue>=100||Dt()||Ot()||kt()||!!zt()},insufficientMaterial:Ot,inThreefoldRepetition:kt,isVariantWin:Lt,gameOver:function(){return V.inDraw()||Et()||!!Lt()||!!Rt()},isPositionValid:function(e){var t,n,r=0,i;if(e||={},e.pawns!==!1)for(t=0;t<=119;){if(i= __get$(H,t) ,i&h)return!1;++t===8&&(t=112)}if(e.kings!==!1){for(t=0;t<=119;++t)if(t&136&&(t+=8),i= __get$(H,t) ,i&b){if(++r>2||n&&n&i)return!1;n=i&x}if(r!==2)return!1}return!(e.check!==!1&&!(e.kings===!1&& __get$(U,Se(W)) ===f)&&Ct(Se(W)))},validateFen:Oe,fen:dt,pgn:function(e){return e||={},!e.useResultHeader&&!Je&&(Lt()||Et()?Ye.Result=W===m?`1-0`:`0-1`:V.inStalemate()?Ye.Result=`1/2-1/2`:Rt()&&(Ye.Result=V.siblingGame.turn()===p?`1-0`:`0-1`)),Le(e,Ye,qe,Ge,Be,V)},loadPgn:function(e,t,n){var r,i,a,o,s={},c,l,u=0,d;if(typeof t!=`number`&&(n||=t,t=0),n||={},typeof e==`string`&&(n.singleGame&&(e= __call$(e,"replace",[/(?:\r?\n\s*){2,}/g,`
`]) ),e=V.tokenizePgn(e,n)),t<0&&(t=e.length+t),o= __get$(e,t) ,!o)return!1;for(st(),i=o.length,r=0;r<i&&(a= __get$(o,r) ,a.type===`tagName`);++r){if(! __get$(o,r+1) || __get$(o,r+1) .type!==`tagValue`)return!1;++r,a.value===`FEN`?d=we( __get$(o,r) .value): __set$(s,a.value,__get$(o,r).value) }if(n.variant&&(s.Variant=n.variant),s.Variant&&!d&&(d=te),d||s.SetUp===`1`){if(s.SetUp===`0`)s.FEN=d;else if(!d||!ct(d,s.Variant))return!1}for(V.header(s),c=V,l=c._history();r<i;++r)if(a= __get$(o,r) ,a.type===`san`&&u===0){if(!c.move(a.value)&&(a.value!==`Z0`&&a.value!==`<>`||n.rejectNullMoves||!c.move(`--`)))if(n.commentErrors)l.length? __get$(l,l.length-1) .comment=(( __get$(l,l.length-1) .comment||``)+` `+a.value).trim():l.initComment=((l.initComment||``)+` `+a.value).trim();else if(n.skipBadLines&&(Je!==0||Ke.length&&n.allowBadMainLine))u=1;else return st(),!1}else if(a.type===`result`&&Ye.Result===`*`)ft([`Result`,a.value]);else if(a.type===`a`&&u===0&& __get$(l,l.length-1) ) __get$(l,l.length-1) .annotation=a.value;else if((a.type===`nag`||a.type===`aa`)&&u===0&& __get$(l,l.length-1) ) __get$(l,l.length-1) .additionalAnnotation||( __get$(l,l.length-1) .additionalAnnotation=[]), __get$(l,l.length-1) .additionalAnnotation.indexOf(a.value)===-1&& __get$(l,l.length-1) .additionalAnnotation.push(a.value);else if(a.type===`comment`&&u===0)l.length?(a.value&&( __get$(l,l.length-1) .comment=a.value),a.commands&&( __get$(l,l.length-1) .commands=a.commands,a.commands.clk&&( __get$(l,l.length-1) .time=Te(a.commands.clk)))):(l.initComment=String(a.value),a.commands&&(l.commands=a.commands));else if(a.type===`variationStart`){if(u>0)++u;else if(!Bt())return st(),!1;l=c._history()}else if(a.type===`variationEnd`)u>0&&--u,u===0&&(Vt(l.parentId),l=c._history());else if(a.type===`number`){if(c=/b/i.test(a.value.slice(-1))?V.siblingGame:V,!c)return!1;l=c._history()}else a.type===`cont`&&Je&&!l.length&&c.move( __get$(__get$(c._lines(),l.parentId),l.atMoveNode) .san);return!0},header:function(e){return Array.isArray(e)?ft(e):(typeof e==`object`&&Object.keys(e).forEach(function(t){ft([t, __get$(e,t) ])}),Ye)},turn:function(e){return(e===p||e===m)&&(W=e),W},move:function e(t){var n,i,a,o,s,l,d,f,m,g,_,v,y;if(typeof t==`string`){switch(o=t.length-1, __get$(t,o) ){case`+`:case`#`:t=t.substr(0,o)}for(m=P.indexOf(t[0])>6? __get$(I,t[0]) :t[0]===`O`?b:h,Ze&&(t.indexOf(`@`)===-1?g=!0:(g=!1,m<<=24)),bt(m,g),o=0;o<u;++o)if(l=et( __get$(c,o) ,!0),t===l){i= __get$(c,o) ;break}if(i)d=i>>A&N,f=i>>j&N,a=i>>M;else if(t===`--`)return Mt();else{if(t=V.fixMove(t))try{return e(t)}catch{}return null}}else{if(t.drop){switch(t.drop){case`p`:a=0;break;case`n`:a=1;break;case`b`:a=2;break;case`r`:a=3;break;case`q`:a=4;break;default:return null}m=1<<26+a}else{if(t.promotion)switch(t.promotion){case`q`:a=4;break;case`n`:a=1;break;case`r`:a=3;break;case`b`:a=2;break;default:return null}d= __get$(r,t.from) ,g=!0,m= __get$(H,d) &S}for(f= __get$(r,t.to) ,n=((a?a<<M:0)|f<<j)>>A|d,bt(m,g),o=0;o<u;++o)if( __get$(c,o) >>A===n){i= __get$(c,o) ;break}if(!i)return(t=V.fixMove(t))?e(t):null}return y=i&z.DROP_OR_PROMOTE? __get$(pe,a) +W: __get$(H,d) ,s=It(i,l,!0),_=xt(y,d,f,i),$e(i,d,f,a),_&&(Be&&Lt()||bt()===0?s.san+=`#`:s.san+=`+`),v= __get$(Ke,Ke.length-1) ,v.san=s.san,s.piece&T&&(v.promoted=!0),W===p&&++We,s},undo:function(e){var t=Ke.pop();return t?(W===p&&--We,t.move?(Pt(t),e?!0:It(t.move,t.san)):(He=t.epSquare,--Ue,W=Se(W),e?!0:{san:`--`,color:t.color})):null},clear:function(e){ot(e)},put:function(e,t,n){var i= __get$(r,t) ,a=!1,o,s= __get$(H,i) ,c=s&x,l=e.color;if(isNaN(i)||!e.type||!l||P.indexOf(e.type)===-1)return!1;if( __set$(H,i,__get$(I,e.type)|l|(e.promoted?T:0)) , __get$(H,i) &b&&( __set$(U,l,i) ),s&& __get$(H,__get$(U,c)) && __get$(H,__get$(U,c)) !==(b|c)){for(o=0;o<120;++o)o&136&&(o+=8), __get$(H,o) ===(b|c)&&( __set$(U,c,o) ,a=!0);a||( __set$(U,c,f) )}return n||ct(dt(),Be,!1,!1),!0},get:mt,remove:function(e,t){var n= __get$(H,__get$(r,e)) ,i=mt(e),a=n&x,o;if( __set$(H,__get$(r,e),0) ,n&b){for( __set$(U,a,f) , __set$(G,a,0) ,o=0;o<120;++o)if(o&136&&(o+=8), __get$(H,o) ===(b|a)){ __set$(U,n.color,o) ;break}}return t||ct(dt(),Be,!0,!1),i},history:function(e,t){for(var n=[],r,i=Ke,a=i.length;;){if(--a===-1)if(i.id&&!t){a=i.atMoveNode,i= __get$(qe,i.parentId) ;continue}else break;e?(r=It( __get$(i,a) .move, __get$(i,a) .san),r.color= __get$(i,a) .color,!a&&i.initComment&&(r.firstComment=i.initComment), __get$(i,a) .comment!==void 0&&(r.comment= __get$(i,a) .comment), __get$(i,a) .time!==void 0&&(r.time= __get$(i,a) .time), __get$(i,a) .annotation!==void 0&&(r.annotation= __get$(i,a) .annotation), __get$(i,a) .additionalAnnotation!==void 0&&(r.additionalAnnotation= __get$(i,a) .additionalAnnotation), __get$(i,a) .commands!==void 0&&(r.commands= __get$(i,a) .commands), __get$(i,a) .captured!==void 0&&(r.captured= __get$(i,a) .captured), __get$(i,a) .promoted!==void 0&&(r.promoted= __get$(i,a) .promoted), __get$(i,a) .lines!==void 0&&(r.lines= __get$(i,a) .lines), __get$(i,a) .bughouseOrder!==void 0&&(r.bughouseOrder= __get$(i,a) .bughouseOrder),P.indexOf( __get$(i,a) .san[0])>6?r.piece= __get$(I,__get$(i,a).san[0]) : __get$(i,a) .san[0]===`O`?r.piece=b:r.piece=h,r.piece|=r.color,n.unshift(r)):n.unshift( __get$(i,a) .san)}return n},hashes:function(){for(var e=[],t=Ke,n=t.length;;){if(--n===-1)if(t.id){n=t.atMoveNode,t= __get$(qe,t.parentId) ;continue}else{t.hash||nt(),e.unshift(t.hash);break}e.unshift( __get$(t,n) .hash)}return e},moveCount:function(){return Ke.length},startingMoveNumber:function(){return Ge},completeFen:we,createVariation:Bt,selectLine:Vt,hash:function(){var t=nt();return Be===e.Bughouse&&!V.isDependent?[t,V.siblingGame.hash()]:t},hashing:function(t){Ve=t,Be===e.Bughouse&&!V.isDependent&&V.siblingGame.hashing(Ve)},hand:function(){if(Ze)return ke( __get$(V._hand,p) ,!0)+ke( __get$(V._hand,m) )},checks:function(){if(Be=== __get$(e,`3-check`) )return[ __get$(Xe,p) , __get$(Xe,m) ]},threats:function(){var e=W,t=Se(e),n=[],r=[],i=[],s=[],d=[],p=He,m,h,g,_,v,y,b;if(gt(0, __get$(U,e) ),a||o)for(m=0;m<120;++m)m&136&&(m+=8), __get$(H,m+8) &O&& __get$(H,m) ?i.push(xe(m)): __get$(H,m+8) &k&&n.push(xe(m));for(W=t,He=f,bt(),m=u;m--;){if(h= __get$(c,m) ,v=h>>j&N,y=h>>A&N,h&z.DROP_OR_PROMOTE){if(b=h>>M,_= __get$(pe,b) |t,h&z.PROMOTION&&b%3!=1)continue}else _= __get$(H,y) ,b=0;if(xt(_,y,v,h)&&($e(h,y,v,b),l=m,(Be&&Lt()||bt()===m)&&r.push((h&z.DROP? __get$(re,_) .toLowerCase()+`@`:xe(y))+xe(v)),Pt(Ke.pop()),h&z.CAPTURE)){for(g=0,m=u;m>l;)if(( __get$(c,--m) >>j&N)===v){g=1,m=l;break}if(!g){s.push(xe(y)+xe(v));continue}}h&z.CAPTURE&&b!==1&&(g= __get$(H,v) &124)&&(St(e,v)?(_= __get$(H,y) &S,g>_&&g-_!==8&&d.push(xe(y)+xe(v))):s.push(xe(y)+xe(v)))}return l=0,W=e,He=p,{pins:n,checkers:i,mates:r,undefended:s,underdefended:d}},tokenizePgn:Re,fixMove:function(e){var t,n,i;if(typeof e==`string`){if(/0|[?!+#]$|[18][QNRB]$|^P/i.test(e))return  __call$(__call$(__call$(__call$(e,"replace",[/[?!+#]+$/,``]),"replace",[/0/g,`O`]),"replace",[/([18])([QNRB])$/i,`$1=$2`]),"replace",[/^P+/i,``]) ;if(n=e.indexOf(`=`)>0?-4:-2,t= __get$(r,e.substr(n,2)) ,typeof t==`number`){if( __get$(H,t) &Se(W)||/^[a-h]x?[a-h][36]$/.test(e)){if(e.indexOf(`x`)===-1)return e.slice(0,n)+`x`+e.substr(n)}else if(e.indexOf(`x`)>-1)return  __call$(e,"replace",[/x/g,``]) ;if(i=e.match(/^([KQNRB]?)([a-h][1-8]?|[1-8])x?([a-h][1-8])=?(.?)$/)){if( __get$(H,__get$(r,i[2])) )return{from:i[2],to:i[3],promotion:i[4].toLowerCase()};if(/^\d$/.test(i[2])){for(e=0,bt( __get$(I,i[1]) ,!0),n=0;n<u;++n)if( __get$(c,n) >>j===t&&ye( __get$(c,n) >>A&N)===8-i[2]){if(e)return;e= __get$(c,n) }if(e)return et(e,!0)}return i[1]+i[3]+i[4]}}}else if( __get$(H,__get$(r,e.from)) ===(b|W)&&e.to&&e.from[1]===e.to[1]){if(e.from<e.to)return`O-O`;if(e.from>e.to)return`O-O-O`}},_hand:[],_history:function(e){return e&&(Ke=e,Je=Ke.id),Ke},_lines:function(){return qe},_hashPosition:tt,_board:function(){return H}},ve&&ct(ve,Ce)||st(),V}return ze.variants=n,ze}(),r=function(e){var n=`rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1`,r=[`bench`,`d`,`eval`,`flip`,`isready`,`ponderhit`,`stop`,`uci`,`ucinewgame`],i=[{cmd:`position`,args:[`fen`,`startpos`,`moves`,`continuation`]},{cmd:`go`,args:[`binc`,`btime`,`confidence`,`depth`,`infinite`,`mate`,`mindepth`,`mintime`,`maxdepth`,`maxtime`,`movestogo`,`movetime`,`ponder`,`searchmoves`,`shallow`,`winc`,`wtime`]}],a=[`moves`,`searchmoves`],o=[`ponder`,`infinite`,`startpos`],s={depth:1,seldepth:1,time:1,nodes:1,multipv:1,cp:1,mate:1,currmovenumber:1,hashfull:1,nps:1,tbhits:1,sbhits:1,cpuload:1,bmc:1,score:2,lowerbound:2,upperbound:2,bestmove:3,ponder:3,baseTurn:3,bestmoveSan:3,ponderSan:3,pv:4,pvSan:4,string:4,refutation:4,currline:4},c=/(?:Total|Final) Evaluation[\s\S]+\n$/i;function l(e,t,n){var r=new Worker(e||`stockfish.js`),i={terminate:o,postMessage:a};function a(e){ __call$(r,"postMessage",[e]) }function o(){r.terminate()}function s(e){var t=e.concat();e.length=0,t.forEach(function(e){e.cmd?e.cmd.substr(0,2)!==`go`&&n.send(e.cmd,e.cb,e.stream):(clearTimeout(e.timer),n.getBestMove(e.args,e.cb,e.stream))})}return r.onmessage=function(e){typeof e.data==`string`&&i.onmessage(e.data)},r.onerror=function(a){if(n.fallbackPath&&n.fallbackPath!==e){try{a.preventDefault()}catch{}try{r.terminate()}catch{}return r=l(n.fallbackPath,t,n),r.onmessage=function(e){i.onmessage(e)},s(n._activeCommands()),s(n._bestMoveQueue()),!1}if(t.onError)return t.onError(a)},i}function u(t,n){n.fallbackPath=t.pathToNonWasmEngine,n.path=t.enginePath||t.pathToEngineWorker,n.wasmPath=t.pathToWasmEngine,t.engines&&(t.engines.multiThreaded&&e.supportsMultithreading()?(n.path=t.engines.multiThreaded.loader,n.wasmPath=t.engines.multiThreaded.engine):t.engines.singleThreaded&&(n.path=t.engines.singleThreaded.loader,n.wasmPath=t.engines.singleThreaded.engine),n.fallbackPath=t.engines.asm||n.fallbackPath)}function d(e,t){var n;return u(e,t),n=t.path,(t.fallbackPath&&typeof WebAssembly>`u`||!n)&&(n=t.fallbackPath),t.wasmPath&&(n+=`#`+t.wasmPath),l(n,e,t)}function f(e){for(var t=e.split(` `),n=t.length,r=t[0]===`info`?1:0,i={mtype:t[0]},a,o;r<n;++r)if(o= __get$(t,r) ,o)if(a= __get$(s,o) ,a===1){for(;! __get$(t,++r) &&r<n;); __set$(i,o,Number(__get$(t,r))) }else if(a===2) __set$(i,o,!0) ;else if(a===3){for(;! __get$(t,++r) &&r<n;); __set$(i,o,__get$(t,r)) }else for( __set$(i,o,[]) ,++r;r<n;++r)if(! __get$(s,__get$(t,r)) ) __get$(t,r) && __get$(i,o) .push( __get$(t,r) );else{--r;break}return(i.bestmove===`(none)`||i.bestmove===`0000`)&&(i.bestmove=void 0,i.bestmoveSan=void 0),(i.ponder===`(none)`||i.ponder===`0000`)&&(i.ponder=void 0,i.ponderSan=void 0),i}function p(e){var t=e.indexOf(` `);return t===-1?e:e.substr(0,t)}function m(e){return __call$(__call$(e+``,"replace",[/^([^/]+)((?:\/[^/]+){7})\/([qrbnp]*)/i,`$1$2[$3]`]),"replace",[/( \d+ \d+) \+([0-3])\+([0-3])/,function(e,t,n,r){return` `+(3-n)+`+`+(3-r)+t;}]) }function h(e){return __call$(__call$(e+``,"replace",[/\[([qrbnp]*)\]/i,`/$1`]),"replace",[/([0-3])\+([0-3]) (\d+ \d+)/,function(e,t,n,r){return r+` +`+(3-t)+`+`+(3-n);}]) }function g(e,t){var n,r=p(e),i,a,o;for(n=r===`uciok`||r===`option`?`uci`:r===`readyok`||r===`ready`?`isready`:r===`json`||e.indexOf(`info string CEEError`)>=0?`fetch`:r===`bestmove`||r===`info`?`go`:`other`,o=t.length,a=0;a<o;a+=1)if(i=p( __get$(t,a) .cmd),i===n||n===`other`&&(i===`d`||i===`eval`))return a;return 0}function _(e){var t=e.match(/id name ((\S+) ([\d.a-z]+).*)/i);if(t)return{all:t[1].trim(),short:t[2],version:t[3],full:t[2]+` `+t[3],wasm:/ wasm/i.test(e),multithreaded:/ multithreaded/i.test(e)}}function v(s,l){var u={},b,x=[],S,C=[],w,T=null;function E(t){var n,r=0,i,a,o;if(t.indexOf(`
`)>-1){for(a=t.split(`
`),o=0;o<a.length;o+=1)E( __get$(a,o) );return}if(e.log&&console.log(`debug (onmessage): `+t),u.stream&&u.stream(t),!x.length||t.indexOf(`No such option`)===0||t.indexOf(`Stockfish`)===0||t.indexOf(`Komodo`)===0||t.indexOf(`Explanation Engine`)===0||t.indexOf(`info string variant`)===0){if(s.ceeMode&&t.indexOf(`Explanation Engine`)===0){var l=t.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)\s*\(C\)/);l?T={date:l[1],increment:l[2]}:(l=t.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)\.([0-9]+)/),T={major:l[1],minor:l[2],patch:l[3]})}return}if(r=g(t,x),i= __get$(x,r) ,i.stream&&!i.discard&&i.stream(t),i.message===void 0?i.message=``:i.message!==``&&(i.message+=`
`),i.message+=t,t.indexOf(`uciok`)===0)u.name=_(i.message),n=!0;else if(t.indexOf(`ready`)===0)n=!0;else if((t.indexOf(`bestmove`)===0||p(t)===`bestmove`)&&i.cmd!==`bench`)n=!0,i.message=t;else if(i.cmd===`d`)(t.indexOf(`Legal uci moves`)===0||t.indexOf(`Key is`)===0)&&(i.done=!0,n=!0);else if(i.cmd.indexOf(`fetch`)===0)try{var d=i.message.split(`
`).filter(function(e){return e.includes(`json`)}).join(`
`);d&&(i.message=JSON.parse( __call$(__call$(d,"replace",[/^json /gm,``]),"replace",[/\n/g,``]) ),n=!0)}catch{}else i.cmd===`eval`?c.test(i.message)&&(n=!0):(t.indexOf(`pawn key`)===0||t.indexOf(`Nodes/second`)===0||t.indexOf(`Unknown command`)===0)&&(n=!0);n&&(x.splice(r,1),i.cb&&!i.discard?i.cb(i.message):i.ondiscard&&i.ondiscard())}function D(e){return e!==`ucinewgame`&&e!==`flip`&&e!==`stop`&&e!==`ponderhit`&&e.indexOf(`position`)!==0&&e.indexOf(`setoption`)!==0&&e.indexOf(`variation`)!==0&&e.indexOf(`threat-variation`)!==0&&e.indexOf(`push`)!==0&&e.indexOf(`pop`)!==0&&e.indexOf(`serve`)!==0&&e.indexOf(`speech`)!==0}u.send=function(t,n,r){var i;t=String(t).trim(),D(t)? __set$(x,x.length,{cmd:t,cb:n,stream:r}) :i=!0,b&&(e.log&&console.log(`stdin: `+t), __call$(b,"postMessage",[t]) ,i&&n&&setTimeout(n,0))},u._activeCommands=function(){return x},u._bestMoveQueue=function(){return C},u.quit=function(){if(b&&b.terminate){try{u.send(`quit`)}catch{}b.terminate(),b=null,u.ready=void 0}clearTimeout(S)},r.forEach(function(e){ __set$(u,e,function(t,n){u.send(e,t,n);}) }),i.forEach(function(e){ __set$(u,e.cmd,function(t,n,r){var i=[e.cmd];(w&&t.fen)&&(t.fen=m(t.fen)),e.args.forEach(function(e){if(__get$(t,e)||__get$(t,e)===0){if(a.indexOf(e)>-1){if(!__get$(t,e)||!__get$(t,e).length)return;Array.isArray(__get$(t,e))&&__set$(t,e,__get$(t,e).join(` `));}i.push(e),o.indexOf(e)===-1&&i.push(__get$(t,e));}}),u.send(i.join(` `),n,r);}) }),u.setoption=function(e,t){u.send(`setoption name `+e+` value `+t)},u.setVariant=function(e){var t;e!==w&&(t= __call$(String(e).toLowerCase(),"replace",[/ |-/g,``]) ,!e||t===`chess`?(t=void 0,u.setoption(`UCI_Variant`,`chess`),u.setoption(`UCI_Chess960`,`false`)):t===`chess960`?(u.setoption(`UCI_Variant`,`chess`),u.setoption(`UCI_Chess960`,`true`)):(t===`threecheck`&&(t=`3check`),u.setoption(`UCI_Variant`,t),u.setoption(`UCI_Chess960`,`false`)),w=t)},u.loadBook=function(e,n){u.pathToBook=e,t.loadBook(e,function(e,t){u.book=t,u.bookLoaded=!0,e&&(console.error(`Error loading opening book.`),console.error(e),u.pathToBook=null,u.bookLoaded=!1),n()})},u.getBookMove=function(t){var n=e.createGame(t),r=u.book.pick({fen:n.fen(),type:t.bookPick===void 0?`random`:t.bookPick,chess960:n.header().Variant===`Chess960`}),i=r&&n.move(r);if(i)return{moveSan:i.san,moveLan:r,move:{from:i.from,to:i.to,promotion:i.promotion||null},baseTurn:n.turn()===1?`b`:`w`,pv:[{moveSan:i.san,moveLan:r}],depth:null,score:null,mateIn:null,isBookMove:!0}};function O(){var t=1,r=[],i=[],a,o,s=null,c=C[0].args,l=C[0].cb,d=C[0].stream,p,m=1,g,_=[],y=14,b=v._previousCP;C[0].started=!0,v._previousCP=null;function x(e){var t=[],n= __get$(i,e) ||A( __get$(r,e) );return  __get$(r,e) .forEach(function(e,r){t.push({moveSan: __get$(n,r) ,moveLan:e})}),t}function w(e,t,n,i){var a;for(a=r.length-1;a>=0;--a)if( __get$(r,a) [0]===e)return x(a);return n?[{moveSan:t,moveLan:e},{moveSan:i,moveLan:n}]:t?[{moveSan:t,moveLan:e}]:[]}function T(e){var t=.03*32**(e.depth/y);e.cp=b+(e.cp-b)*t}function E(e){e.mate===0?(e.mateIn=0,e.cp=-31800*m):(e.mateIn=Number(e.mate*m)||null,typeof e.mateIn==`number`&&!isNaN(e.mateIn)&&typeof e.cp!=`number`?e.cp=31800*m*(e.mate/Math.abs(e.mate)):(e.cp*=m,Math.abs(e.cp)===9&&(e.cp=0),c.normalize&&e.depth<=y&&typeof b==`number`&&e.multipv===1&&T(e))),e.score=e.cp/100}function D(e){var n=f(e);if(ee(n),t>y&&a<5e3&&a>-5e3&&(v._previousCP=a),n.pv=w(n.moveLan,n.moveSan),n.pv.length===1&&n.ponder&&(n.pv=w(n.moveLan,n.moveSan,n.ponder,n.ponderSan)),_.length>1)_.splice(_.indexOf(n.moveLan),1),c.searchmoves=_,c.getNextBest=0,k(c,function(){l(n)},function(e){d&&(e.multipv=2,d(e))});else if(l)try{l(n)}catch(e){console.error(e)}C.shift(),clearTimeout(S),C.length>0&&O()}function ee(n){var r;n.baseTurn=p,n.cp=a,n.score=a/100,n.mate=o,n.mateIn=s,n.depth=t,n.moveLan=n.bestmove,n.moveLan&&(n.move=e.uciToObj(n.moveLan)[0],r=g.move(n.move),r&&(n.moveSan=n.bestmoveSan=r.san,n.ponder&&(r=g.move(e.uciToObj(n.ponder)[0]),r&&(n.ponderSan=r.san,g.undo(!0))),g.undo(!0)))}function A(t){var n,r=t.length,i=[],a;for(n=0;n<r&&(a=g.move(e.uciToObj( __get$(t,n) )[0]),a);++n)i.push(a.san);for(;n>0;--n)g.undo(!0);return i}function j(e){var n=f(e);n.score&&(n.baseTurn=p,E(n),!n.multipv&&n.depth&&(n.multipv=1),(n.multipv===1||n.depth===0)&&(a=n.cp,o=n.mate,s=n.mateIn)),n.pv&&d&&(n.pvSan=A(n.pv)),n.pv&&!(n.lowerbound||n.upperbound)&&(r.push(n.pv),d&&i.push(n.pvSan)),n.depth>t?t=n.depth:n.mtype===`bestmove`&&ee(n),d&&!(n.mateIn===0&&n.pv)&&d(n),M()}function M(){c.timeout&&(clearTimeout(S),C[0].timer=S=setTimeout(function(){u.stop(),l&&=(l(),void 0)},c.timeout))}c.difficulty>=0&&c.difficulty<20?(u.setoption(`Skill Level`,c.difficulty),c.maximumError>=0&&c.maximumError<=4999&&u.setoption(`Skill Level Maximum Error`,c.maximumError),c.errorProbability>=1&&c.errorProbability<=128&&u.setoption(`Skill Level Probability`,c.errorProbability)):u.setoption(`Skill Level`,20),c.contempt===void 0?u.setoption(`Contempt`,`0`):u.setoption(`Contempt`,c.contempt),c.multiPv>1?u.setoption(`MultiPV`,c.multiPv):u.setoption(`MultiPV`,1),!c.movetime&&(!c.wtime||!c.btime)&&!c.depth&&(c.btime=c.btime||72e3,c.wtime=c.wtime||72e3),(c.startpos||!c.fen)&&!c.moves&&!c.variant?(p=`w`,g=e.createGame({disableHashing:!0})):(g=e.createGame({fen:c.fen?h(c.fen):n,moves:c.moves,variant:c.variant,disableHashing:!0}),g.turn()===g.WHITE?p=`w`:(p=`b`,m=-1)),u.setVariant(c.variant),u.position(c),u.go(c,D,j),c.getNextBest&&l&&g.moves({verbose:!0}).forEach(function(t){t=e.normalizeMoveObj(t),_.push(t.from+t.to+(t.promotion||``))}),M()}function k(e,t,n){C.push({args:e,cb:t,stream:n}),C.length===1&&O()}u.getBestMove=function(e,t,n){var r;if(e||={},e.fen=e.fen||e.baseFen,e.is960&&(e.variant=`Chess960`),u.bookLoaded&&e.useBook&&(r=u.getBookMove(e),r))return setTimeout(function(){r.mtype=`bestmove`,t(r)},0);k(e,t,n)},u.stopAll=function(t){var n,r=x.length,i=0;function a(){--i,i===0&&t()}for(C=[],n=0;n<r;n+=1)e.log&&console.log(`debug (stop_moves): `+n,p( __get$(x,n) .cmd)),p( __get$(x,n) .cmd)===`go`&&! __get$(x,n) .discard&&(u.stop(), __get$(x,n) .discard=!0,t&&(i+=1, __get$(x,n) .ondiscard=a));t&&!i&&u.isready(t)},u.restartEngine=function(e){return u.stopAll(),u.quit(),x=[],C=[],u.bookLoaded&&!s.book&&(s=JSON.parse(JSON.stringify(s)),s.book=u.book),v(s,e)},u.stopFast=function(e,t){var n;u.stopAll(function(){clearTimeout(n),e(u)}),n=setTimeout(function(){u.restartEngine(e)},t||5e3)};function ee(){u.uci(function(){s.settings&&Object.keys(s.settings).forEach(function(e){u.setoption(e, __get$(s.settings,e) )}),u.ready=!0,A()})}function A(){u.ready&&(u.bookLoaded||!u.pathToBook)&&l&&l(u)}return typeof Worker>`u`?!1:(s.ceeMode&&(y(u,s),u.ceeVersion=function(){return JSON.parse(JSON.stringify(T))}),b=d(s,u),b.onmessage=E,s.book&&(u.book=s.book,u.bookLoaded=!0,u.pathToBook=s.pathToBook),u.getFenFromMoves=e.getFenFromMoves,u.getLegalMoves=e.getLegalMoves,u.getPositionInfo=e.getPositionInfo,u.isFenValid=e.isFenValid,u.ready=!1,ee(),!u.book&&s.pathToBook&&u.loadBook(s.pathToBook,A),u)}function y(t,n){var r=1e3,i=0,a,o;function s(e){function t(e){var n=t.callbacks;for(var r in t.callbacks={},t.original&&t.original(e),n) __call$(n,r,[e]) }return t.callbacks={},t.original=e,t}n.onError=a=s(n.onError),n.onSignal=o=s(n.onSignal);function c(n,s,c,l){var u,d=Date.now(),f=!1,p=++i;function m(){clearTimeout(u),delete a.callbacks[p],delete o.callbacks[p],f=!0}function h(e){f||(m(),l({data:e,action:s,uci:n},n))}function g(t){h({msg:`CEE process crashed unexpectedly`,code:e.ERROR_CODES.CRASH,exitCode:t,err:Error(`CEE process exited with `+t)})} __set$(a.callbacks,p,g) , __set$(o.callbacks,p,g) ,u=setTimeout(function(){h({msg:`CEE timed out`,code:e.ERROR_CODES.TIMEOUT,timeout:r,duration:Date.now()-d,err:Error(`CEE timed out`)})},r);for(var _=0;_<n.length;++_)t.send( __get$(n,_) );t.send(`fetch `+s,function(e){f||(m(),c(e,n))},function(n){n.indexOf(`info string CEEError`)>=0?h({msg:`CEE crashed with error code`,code:e.ERROR_CODES.ERROR,log:n.match(/info string CEEError\s*(.*)/)[1],err:Error(n.match(/info string CEEError\s*(.*)/)[1])}):t.ceeDebug&&n.indexOf(`not recognized`)>=0&&h({msg:`CEE received unknown UCI option (engine.ceeDebug mode on)`,option:n,code:e.ERROR_CODES.NONFATAL_ERROR,err:Error(n)})})}t.fetch=function(t,n,r){var i,a;t||=[],i=t.action||`analysis`,Array.isArray(t)?a=t:(a=t.uciCommands?t.uciCommands.map(function(e){return e}):[],t.startFen&&(t.options=t.options||{},t.options.ScoreWhiteToMove===void 0&&(t.options.ScoreWhiteToMove=!0),t.options.SerializeLikeCEAC===void 0&&(t.options.SerializeLikeCEAC=!0),e.CEE_LIB.addOptions(a,t.options),e.CEE_LIB.addVariant(a,t.variant),e.CEE_LIB.addPosition(a,t.startFen)),e.CEE_LIB.addVariations(a,t.evals&&t.evals[0]),e.CEE_LIB.addVariations(a,t.threats&&t.threats[0],`threat-variation`),(t.moves||[]).forEach(function(n,r){var i=r+1;e.CEE_LIB.addPush(a,n),e.CEE_LIB.addVariations(a,t.evals&& __get$(t.evals,i) ),e.CEE_LIB.addVariations(a,t.threats&& __get$(t.threats,i) ,`threat-variation`)})),c(a,i,n,r)},t.fetch.setTimeout=function(e){r=e},e.ERROR_CODES={TIMEOUT:1,CRASH:2,ERROR:3,NONFATAL_ERROR:4}}return v},i=function(){var e=n(),i,a=`rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1`,o=252,s=255,c={4:`p`,5:`P`,6:`p`,8:`n`,9:`N`,10:`n`,16:`b`,17:`B`,18:`b`,32:`r`,33:`R`,34:`r`,64:`q`,65:`Q`,66:`q`,128:`k`,129:`K`,130:`k`},l=`pnbrq`,u=512,d=`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?{~}(^)[_]@#$,./&-*++=`,f=`qnrbkp`;function p(e){var t,n=e.length,r=[],i,a,o;for(t=0;t<n;t+=2)o={},i=d.indexOf( __get$(e,t) ),a=d.indexOf( __get$(e,t+1) ),a>63&&(o.promotion= __get$(f,Math.floor((a-64)/3)) ,a=i+(i<16?-8:8)+(a-1)%3-1),i>75?o.drop= __get$(f,i-79) :o.from= __get$(d,i%8) +(Math.floor(i/8)+1),o.to= __get$(d,a%8) +(Math.floor(a/8)+1),r.push(o);return r}function m(e){var t,n,r=``,i,a;for(Array.isArray(e)||(e=[e]),n=e.length,t=0;t<n;t+=1)i= __get$(e,t) .drop?79+f.indexOf( __get$(e,t) .drop):d.indexOf( __get$(e,t) .from[0])+( __get$(e,t) .from[1]-1)*8,a=d.indexOf( __get$(e,t) .to[0])+( __get$(e,t) .to[1]-1)*8, __get$(e,t) .promotion&&(a=f.indexOf( __get$(e,t) .promotion)*3+64+(a<i?9+a-i:a-i-7)),r+= __get$(d,i) + __get$(d,a) ;return r}function h(e){var t=e.split(` `),n,r=t.length,i=[],a;if(e)for(n=0;n<r;++n)a= __get$(t,n) ,a.length===4?a[1]===`@`?i.push({drop:a[0].toLowerCase(),to:a.substr(2,2)}):i.push({from:a.substr(0,2),to:a.substr(2,2)}):i.push({from:a.substr(0,2),to:a.substr(2,2),promotion:a[4]});return i}function g(e,t){return e.san===t.san||e.to===t.to&&(e.from===t.from||!e.from&&!t.from)&&(e.promotion===t.promotion||!e.promotion&&!t.promotion)&&(e.drop===t.drop||!e.drop&&!t.drop)}function _(e,t,r){var i=[],a,o,s,c,l,u,d,f,p,m,h=1,g=8,_=1,v=8,y={verbose:!0};for(m=e.turn(),p=3-m,c=n(`/`,t),c.turn(p),r&&(h=g=+r[1],_=v=r.charCodeAt(0)-96),a=h;a<=g;++a)for(o=_;o<=v;++o)l=String.fromCharCode(o+96)+a,s=e.get(l),s&&s.color===p&&(c.put(s,l,!0),s.type===`p`?(u=String.fromCharCode(o-1+96)+(a+(p===1?1:-1)),d=String.fromCharCode(o+1+96)+(a+(p===1?1:-1)),c.put({type:`n`,color:m},u,!0),c.put({type:`n`,color:m},d,!0)):s.type===`k`&&(f=e.fen().split(` `)[2],f!==`-`&&c.load( __call$(c.fen(),"replace",[/^(\S+\s\S\s)(\S+)/,`$1`+f]) ,t,!0,!0)),i=i.concat(c.moves(y)),c.remove(l,!0),s.type===`p`&&(c.remove(u,!0),c.remove(d,!0)));return t&&e.hand()&&( __set$(c._hand,p,18721) ,i=i.concat(c.moves({verbose:!0}).filter(function(e){return!r||e.to===r}))),i.forEach(function(e){k(e)}),i}function v(t,n){var r=t.header().Variant,i=_(t,r,n.from),a,o,s,c,l,u=3-t.turn();for(a=i.length-1;a>=0;--a)if(o= __get$(i,a) ,g(o,n)){s=!0;break}if(s)return o.drop?t.put({type:o.drop,color:u},o.to):(c=t.remove(o.from,!0),o.flags===e.FLAGS.KSIDE_CASTLE?(l=t.remove(r===`Chess960`?o.to:`h`+o.from[1],!0),t.put(c,`g`+o.from[1],!0),t.put(l,`f`+o.from[1])):o.flags===e.FLAGS.QSIDE_CASTLE?(l=t.remove(r===`Chess960`?o.to:`a`+o.from[1],!0),t.put(c,`c`+o.from[1],!0),t.put(l,`d`+o.from[1])):(o.promotion&&(c.type=o.promotion,c.promoted=!0),l=t.get(o.to),t.put(c,o.to,c.type!==`k`&&c.type!==`r`&&(!l||l.color!==u||l.type!==`r`)))),o;if(n.from&&(t.turn(u),n=t.fixMove(n),t.turn(3-u),n))return v(t,{san:n,from:n.from})}function y(e,t){var n=t?{}:[],r=e._board(),i,a,s;if(t)for(i=112;i>=0;++i)i&136&&(i-=24),(a= __get$(r,i) )&&(s= __get$(d,i&7) +(8-(i>>4)), __set$(n,s,{type:__get$(c,a&o),color:a&3,promoted:(a&u)!==0,square:s}) );else for(i=112;i>=0;++i)i&136&&(i-=24),(a= __get$(r,i) )&&n.push({type: __get$(c,a&o) ,color:a&3,promoted:(a&u)!==0,rank:8-(i>>4),file:(i&7)+1});return n}function b(e,t){var n=Math.min(Math.max(.20773843*Math.atan(2.49085889*e/100-2.47841945*t/100)+.02262979*e/100-.02256839*t/100+.52239679,0),1),r=Math.min(Math.max(-.20720905*Math.atan(2.49626837*e/100-2.48220286*t/100)+-.02352551*e/100+.02172627*t/100+.49443923,0),1),i=Math.min(Math.max(Math.exp(.037043456*e/100+.178106427*t/100+-8.069742932)+.004823544*Math.exp(-1.364136591*(e/100-t/100)**2)+-.001625539,0),1),a=n+r+i;return{w:n/a,b:r/a,d:i/a}}function x(e,t){var n,r,i,a;if(e||={},e.disableHashing=!0,n=E(e),!n)return null;if(t){if(i=n.move(t),!i)return null;n.extended||k(i)}return a=n.fen(),!e.skipValidation&&!n.isPositionValid(e)?null:(r=a.split(` `),{fen:a,pieces:y(n),sideToMove:n.turn(),castling:r[2],epSquare:r[3]===`-`?null:r[3],halfMoves:+r[4],moveNumber:+r[5],move:i,hand:n.hand(),checks:n.checks()})}function S(e){var n=E(e),r,i,o,s,c,l,u=[``],d=[],f,p,m;if(!n)return!1;for(p=n.header(),m=p.Variant||``,l=n.hashes(),r=typeof n.origHistory==`function`?n.origHistory(!0):n.history(!0),c=l.length,i=[l[0][0],l[0][1]],d.push(t.to64BitHex(i)+m),l[0]=t.to64BitHex(l[0]),o=1;o<c;++o)i[0]=(i[0]^ __get$(l,o) [0]*(o+58465))>>>0,i[1]=(i[1]^ __get$(l,o) [1]*(o+984))>>>0, __set$(l,o,t.to64BitHex(__get$(l,o))) ,d.push(t.to64BitHex(i)+m),s=o-1,k( __get$(r,s) ),f=( __get$(r,s) .from? __get$(r,s) .from: __get$(r,s) .drop.toUpperCase()+`@`)+ __get$(r,s) .to+( __get$(r,s) .promotion||``),s&&(f= __get$(u,s) +` `+f),u.push(f);return{startingFen:p.FEN||a,hashes:l,fingerprints:d,moves:u,variant:p.Variant}}function C(e,t,n,r){var i,a,o,s,c,l,u,d,f,p,m;for(n||={},typeof t==`string`&&(t=t.trim().split(` `)),o=t.length,i=0;i<o;i+=1){if(c= __get$(t,i) .board===`b`|| __get$(t,i) .board===`B`?e.siblingGame:e,l=typeof  __get$(t,i) .moveLan==`string`?h( __get$(t,i) .moveLan)[0]:typeof  __get$(t,i) ==`string`?h( __get$(t,i) )[0]: __get$(t,i) .san? __get$(t,i) .san: __get$(t,i) ,!c.move(l))if(n.autoPromote){if(n.autoPromote===!0?l.promotion=`q`:l.promotion=n.autoPromote,!c.move(l)){if(n.skipBadLines)break;return!1}}else{if(n.skipBadLines)break;return!1}if(u=c._history(),d= __get$(u,u.length-1) ,r&&(f=parseInt( __get$(r,i) ,10)),(typeof f!=`number`||isNaN(f))&&(f=parseInt( __get$(t,i) .time,10)),typeof f==`number`&&!isNaN(f)&&(d.time=f,f=void 0), __get$(t,i) .firstComment&&(u.initComment= __get$(t,i) .firstComment), __get$(t,i) .comment&&(d.comment= __get$(t,i) .comment), __get$(t,i) .annotation&&(d.annotation= __get$(t,i) .annotation), __get$(t,i) .additionalAnnotation&&(d.additionalAnnotation= __get$(t,i) .additionalAnnotation), __get$(t,i) .commands&&(d.commands= __get$(t,i) .commands), __get$(t,i) .lines)for(s= __get$(t,i) .lines.length,a=0;a<s;++a){if(p=e._history().id,e.createVariation(),m=C(e, __get$(__get$(t,i).lines,a) ,n),!m&&!n.skipBadLines)return!1;e.selectLine(p)}}return!0}function w(e,t,n){var r=[p(t[0]),p(t[1])],i=[0,0],a=[0,0],o=r[0].length+r[1].length,s=Math.max(n[0][0]|0,n[0][1]|0,n[1][0]|0,n[1][1]|0),c,l=[0,0],u=[0,0],d,f;for(s+=600-s%600,c=[[s,s],[s,s]];o--;){if(u[0]=l[0]+ __get$(c[0],a[0]) - __get$(n[0],i[0]) ||0,u[1]=l[1]+ __get$(c[1],a[1]) - __get$(n[1],i[1]) ||0,d=u[0]<=u[1]?0:1, __get$(__get$(r,d),__get$(i,d)) ||(d^=1),f=d?e.siblingGame:e,(!f.move( __get$(__get$(r,d),__get$(i,d)) )||o&&f.inCheckmate()&&f.undo(!0))&&(d^=1,f=d?e.siblingGame:e,!f.move( __get$(__get$(r,d),__get$(i,d)) )))return!1; __get$(f._history(),__get$(i,d)) .time= __get$(__get$(n,d),__get$(i,d)) , __set$(__get$(c,d),__get$(a,d),__get$(__get$(n,d),__get$(i,d))) , __set$(l,d,__get$(u,d)) ,a[d]^=1,++i[d]}return!0}function T(t){var r,i=-1,o=0,s;function c(e,t,n){for(var r= __get$(e,t) ,i;typeof(i=r.parentId)==`number`;){if(i===n)return r.atMoveNode;r= __get$(e,i) }return!1}function l(e,t){var n={moveTime:e.moveTime,firstComment:e.firstComment,comment:e.comment,annotation:e.annotation,additionalAnnotation:e.additionalAnnotation,commands:e.commands};Object.keys(n).forEach(function(r){ __set$(e,r,__get$(t,r)) , __set$(t,r,__get$(n,r)) })}t.extended||(t.extended=!0,r={header:t.header,load:t.load,loadPgn:t.loadPgn,createVariation:t.createVariation,undo:t.undo,pgn:t.pgn},t._move=t.move,t.undo=function(){return t.siblingGame?t.deleteBughouseMove(t.curBughouseMove()):t.deletePosition(i,o)},t.getMove=function(e){return e&&(typeof e==`string`||e.to&&(e.from||e.drop))&&t._move(e)&&k(r.undo())||null},t.premove=function(){var e,r=[];return{queue:r,move:function(a){var s;return e||=n(t.fen(),t.header().Variant),s=v(e,a),!s||o||i!==t._history().length-1?(r.length||(e=void 0),null):(r.push(s),s)},consume:function(){var i=r.shift(),a,o,s;if(i){if(a=t.move(i),a){if(e=void 0,o=r.length,o)for(e=n(t.fen(),t.header().Variant),s=0;s<o;++s)v(e, __get$(r,s) );return a}t.premove.cancel()}},moves:function(n){return!o&&i===t._history().length-1&&_(e||t,t.header().Variant,n)},getPieces:function(n){return y(e||t,n)},fen:function(){return(e||t).fen()},cancel:function(){r.length=0,e=void 0}}}(),t.getPieces=function(e){return y(t,e)},t.material=function(){var e=t.getPieces(),n={imbalance:0,white:{p:8,n:2,b:2,r:2,q:1,count:0},black:{p:8,n:2,b:2,r:2,q:1,count:0}},r,i={p:1,n:3,b:3,r:5,q:9,k:0},a,o;for(r=e.length-1;r>=0;--r) __get$(e,r) .color===1?(a=n.white,o=n.black):(a=n.black,o=n.white), __get$(o,__get$(e,r).type) &&--o[ __get$(e,r) .type],a.count+= __get$(i,__get$(e,r).type) ;return n.imbalance=n.white.count-n.black.count,n},t.origHistory=t.history,t.history=function(e,n){var r=[],i,a=t._history(),o=a.length,s=t._lines(),c,l;for(typeof e==`boolean`&&(e={verbose:e}),e||={},n&&(e.noParentLines=n),e.toCurrent&&(o=t.ids().move+1);;){if(--o===-1)if(a.id&&!e.noParentLines){o=a.atMoveNode,a= __get$(s,a.parentId) ;continue}else break;if(e.verbose){for(c in i={}, __get$(a,o) )if( __get$(__get$(a,o),c) &&typeof  __get$(__get$(a,o),c) ==`object`)for(l in  __set$(i,c,__get$(__get$(a,o),c).constructor===Array?[]:{}) , __get$(__get$(a,o),c) ) __set$(__get$(i,c),l,__get$(__get$(__get$(a,o),c),l)) ;else  __set$(i,c,__get$(__get$(a,o),c)) ;r.unshift(i)}else r.unshift( __get$(a,o) .san)}return r},t._getPos=function(e,n){var s,c,l;return typeof e!=`number`&&(e=i),typeof n!=`number`&&(n=o),c=t._lines(),s= __get$(c,n) ,e>=0? __get$(s,e) :s.id?s.atMoveNode? __get$(__get$(c,s.parentId),s.atMoveNode-1) :t._getPos(s.atMoveNode-1,s.parentId):(l={fen:r.header().FEN||a,hash:s.hash,initial:!0,ids:{move:-1,line:0}},t.siblingGame&&(l.bughouseOrder=-1),l)},t.move=function(e,n){var r,a=t._history(),s,c,l;if(e&&(typeof e==`string`||e.to&&(e.from||e.drop))){if(o===a.id&&i<a.length-1||n){if(t.moveForward(n,e))return!0;i<a.length-1&&(t.selectPosition(i+1),t.createVariation(),a=t._history())}t.siblingGame&&(c=t.isDependent?t.siblingGame.fen():t.fen()),r=t._move(e),r&&(k(r),o=a.id,i=a.length-1,s= __get$(a,i) ,l=t._getPos(i-1),t.siblingGame?(s.fen=t.isDependent?t.siblingGame.fen():t.fen(),s.beforeFen=c,s.siblingIds=t.siblingGame.ids()):(s.fen=t.fen(),s.beforeFen=l.fen),l.initial?(s.moveNumber=0,s.previous=null):(s.moveNumber=l.moveNumber+1,s.previous=l.ids),o&&i===0&& __get$(__get$(t._lines(),a.parentId),a.atMoveNode) .move===s.move&&(s.isContinuation=!0),s.flags=r.flags,s.to=r.to,s.from=r.from,s.drop=r.drop,s.capturedStr=r.captured,s.promotion=r.promotion,s.piece=r.piece,r.promoted&&(s.promoted=!0),r.capturedPromotedPawn&&(s.capturedPromotedPawn=!0),s.ids={move:i,line:o})}return r},t.moveDetails=function(n){return n||= __get$(t._history(),i) ,n&&(n.lines=n.lines||null,n.flags===e.FLAGS.KSIDE_CASTLE?(n.rookFrom=t.header().Variant===`Chess960`?n.to:`h`+n.to[1],n.rookTo=`f`+n.to[1],n.kingTo=`g`+n.to[1]):n.flags===e.FLAGS.QSIDE_CASTLE?(n.rookFrom=t.header().Variant===`Chess960`?n.to:`a`+n.to[1],n.rookTo=`d`+n.to[1],n.kingTo=`c`+n.to[1]):n.flags===e.FLAGS.EP_CAPTURE&&(n.epCapture=n.to[0]+n.from[1])),n},t.header=t.headers=function(e){var n=r.header(e);return t.siblingGame&&T(t.siblingGame),n},t.load=function(e,n,a,s){var c=r.load(e,n,a,s);return t.siblingGame&&T(t.siblingGame),c&&!a&&(i=-1,o=0),c},t.removeEmptyLines=function(){var e=t._lines(),n,r;for(n=e.length-1;n>0;--n) __get$(e,n) .length||( __set$(e,n,void 0) ,r=!0);r&&t.reorderLines()},t.loadPgn=function(e,n,a){var s=r.loadPgn(e,n,a),c=t._history();return t.removeEmptyLines(),i=c.length-1,o=c.id,o&&t.selectLine(0),s},t.ids=function(){return{move:i,line:o}},t.selectLine=function(e){t.selectPosition(null,e)},t.curBughouseMove=function(){return Math.max(t._getPos().bughouseOrder,t.siblingGame._getPos().bughouseOrder)},t.deleteBughouseMove=function(e){var n=t.curBughouseMove(),r=!1,i=t,a,o,s;if(e>=0)for(n>=e&&t.selectBughouseMove(e-1);;){for(a=i._history(),o=a.length,s=0;s<o;++s)if( __get$(a,s) .bughouseOrder>=e){a.length=s,r=!0;break}if(i===t.siblingGame)break;i=t.siblingGame}return r},t.selectBughouseMove=function(e){var n=t.isDependent?t.siblingGame:t,r=n,i,a;if(e===-1)return r.selectPosition(-1,0,!0),r.siblingGame.selectPosition(-1,0,!0),n.load(n.header().FEN,`Bughouse`,!0,!0);for(;;){for(i=r._history(),a=i.length-1;a>=0;--a)if( __get$(i,a) .bughouseOrder===e)return r.selectPosition( __get$(i,a) .ids.move,0,!0),r.siblingGame.selectPosition( __get$(i,a) .siblingIds.move,0,!0),n.load( __get$(i,a) .fen,`Bughouse`,!0,!0);if(r===n.siblingGame)return!1;r=n.siblingGame}},t.moveBackward=function(e){var n;if(t.siblingGame)return t.selectBughouseMove(t.curBughouseMove()-1);if(i<=1)if(o===0){if(i===-1)return!1;t.selectPosition(i-1)}else n=t._getPos(i-1,o),n.isContinuation&&!e&&(n=t._getPos(n.ids.move-1,n.ids.line),n=t._getPos(n.ids.move+1,n.ids.line)),t.selectPosition(n.ids.move,n.ids.line);else t.selectPosition(i-1);return!0},t.moveForward=function(e,n){var r=t._lines(),a,s,c,l,u,d;if(t.siblingGame)return t.selectBughouseMove(t.curBughouseMove()+1);if(a= __get$(__get$(r,o),i+1) ,typeof n==`string`&&(n={san:n}),!a||n&&!g(n,a)){if(n&&a&&a.lines){for(u=a.lines.length,l=0;l<u;++l)if(c= __get$(r,__get$(a.lines,l)) [0],c&&g(n,c)){a=c,d=!0;break}}if(!d&&e&&(s= __get$(__get$(r,o),i) ,s&&s.lines)){for(u=s.lines.length,l=0;l<u;++l)if(c= __get$(r,__get$(s.lines,l)) [0],c&&c.isContinuation&&(c= __get$(r,__get$(s.lines,l)) [1],c&&(!n||g(n,c)))){a=c,d=!0;break}}if(!d){try{if(n&&n.san&&(n=t.fixMove(n.san))||n&&n.to&&n.from&&Math.abs(n.to.charCodeAt(0)-n.from.charCodeAt(0))>1&&(n=t.fixMove(n)))return t.moveForward(e,n)}catch{}return!1}}return t.selectPosition(a.ids.move,a.ids.line)},t.moveVariation=function(e,n){var r=t._lines(),i= __get$(r,e) ,a,o,s;if(i&&i.id){for(a= __get$(__get$(r,i.parentId),i.atMoveNode) .lines,o=a.length-1;o>=0;--o)if( __get$(a,o) ===e&&(s=o-(n?1:-1), __get$(a,s) ))return  __set$(a,o,__get$(a,s)) , __set$(a,s,e) ,t.reorderLines(),!0}return!1},t.promoteVariation=function(e,n){for(var r=t._lines(),a= __get$(r,e) ,s,c,l,u,d,f;a&&a[0]&&a.id&&(n!==-1||a.parentId);){for(l=a.parentId,s= __get$(r,l) ,u=a.atMoveNode,a[0].lines= __get$(s,u) .lines.concat(a[0].lines||[]), __get$(s,u) .lines=void 0,f=s.length-u,c=s.splice(u,f),d=0;d<f;++d) __get$(c,d) .ids.line=e, __get$(c,d) .ids.move=d;for(c.id=e,c.parentId=l,c.atMoveNode=u,c.hash=a.hash,u===0?(c.initComment=s.initComment,s.initComment=a.initComment):a.initComment&&( __get$(s,u-1) .comment=(( __get$(s,u-1) .comment||``)+` `+a.initComment).trim()), __set$(r,e,c) ,f=a.length,d=0;d<f;++d) __get$(a,d) .ids.line=l, __get$(a,d) .ids.move=d+u,s.push( __get$(a,d) );for(c[0].isContinuation=!!a[0].isContinuation, __get$(s,u) .isContinuation=!u&&typeof s.parentId==`number`&& __get$(__get$(r,s.parentId),s.atMoveNode) .move===s[0].move,f= __get$(s,u) .lines.length,d=0;d<f;++d) __get$(r,__get$(__get$(s,u).lines,d)) .atMoveNode=u, __get$(r,__get$(__get$(s,u).lines,d)) [0]&&( __get$(r,__get$(__get$(s,u).lines,d)) [0].isContinuation= __get$(r,__get$(__get$(s,u).lines,d)) [0].move=== __get$(s,u) .move);if(o===e?(o=l,i+=u):o===l&&i>=u&&(o=e,i-=u),n===1)break;e=l,a= __get$(r,e) }return s===void 0?!1:(t._history( __get$(r,o) ),t.reorderLines(),!i&& __get$(r,o) [0].isContinuation&&t.selectPosition( __get$(r,o) .atMoveNode, __get$(r,o) .parentId),!0)},t.reorderLines=function(e,n){var r=t._lines(),i,a,c,l,u,d,f,p,m,h,g=!1;for(e?m=n.length-1:(e=0,n=[r[0]],m=0,s=!1),i= __get$(r,e) ,c=i.length,a=0;a<c;++a)if(l= __get$(i,a) ,l.ids.line!==m&&(g=!0,l.ids.line=m),l.lines)for(u=l.lines.length,d=0;d<u;++d)f= __get$(l.lines,d) ,p= __get$(r,f) ,p?(p.atMoveNode=a,h=n.length, __set$(l.lines,d,h) ,p.parentId=m,!s&&f===o&&(s=!0,o=h),n.push(p),g=t.reorderLines(f,n)||g):(l.lines.length===1?delete l.lines:l.lines.splice(d,1),--d,--u);return e||t.saveLines(n,!0),g},t.createVariation=function(){var e=t._history(),n=t._lines(),a,s,c;return i===e.length-1?(a=r.createVariation(),e=t._history(),i=e.length-1,o=e.id,a):i===-1?!1:(s=[],c= __get$(e,i) ,s.parentId=e.id,s.id=n.length,c.lines||=[],c.lines.push(s.id),s.hash=t._getPos(i-1).hash,s.atMoveNode=i,n.push(s),t.selectPosition(-1,s.id))},t.selectLineEnd=function(e){return t.siblingGame?t.selectBughouseMove(t._history().length+t.siblingGame._history().length-1):(typeof e!=`number`&&(e=o),e!==o||i<t._history().length-1?t.selectPosition(null,e,!0):!1)},t.selectLineStart=function(){var e,n;return t.siblingGame?t.selectBughouseMove(-1):o?(i>1||i===1&&!t._getPos(0).isContinuation?e=t._history():(n=t._getPos(-1),e= __get$(t._lines(),n.ids.line) ),t.selectPosition(e.id?e[1]&&e[0].isContinuation?1:0:-1,e.id)):i===-1?!1:t.selectPosition(-1,0)},t.selectPosition=function(e,n,a){var s=t._lines(),c=t._history();if(typeof n==`number`&&(n!==o||a)){if(n<0||n>=s.length)return!1;if(c= __get$(s,n) ,typeof e!=`number`)e=c.length-1;else if(e<-1||e>=c.length)return!1;o=n,t._history(c),a=!0}if(typeof e==`number`&&(e!==i||a)){if(e<-1||e>=c.length)return!1;r.load(t._getPos(e).fen,r.header().Variant,!0,!0),i=e}return!0},t.resetToMainLine=function(){var e=t._lines();t.selectLineEnd(0),e.length>1&&(e.length=1,t.reorderLines())},t.updateNode=function(e,n,r){var a=t._lines(),s,c;for(c in r=typeof r==`number`?r:o,n=typeof n==`number`?n:i,s= __get$(__get$(a,r),n) || __get$(a,r) ,e) __set$(s,c,__get$(e,c)) },t.updateLineComment=function(e,n){t.updateNode({initComment:e},-1,n)},t.saveLines=function(e,n){var r=t._lines(),i,a=e.length,o,s;for(e!==r&&(r.length=0),o=0;o<a;++o){if(i= __get$(e,o) ,o&&typeof i.parentId!=`number`)return!1;e!==r&&r.push(i),i.id=o}return t._history(t._history()),n||(s=t.ids(),t.selectPosition(-1,0,!0),t.selectPosition(s.move,s.line)),!0},t.deletePosition=function(e,n){var r=t._lines(),a,s;return! __get$(r,n) ||! __get$(__get$(r,n),e) &&(e!==-1||n===0)?!1:(n&&(e===0||e===1&& __get$(r,n) [0].isContinuation)&&(e=-1),o>0&&n!==o?(a=c(r,o,n),s=a!==!1&&a>=e):s=n===o&&e<=i,s&&(e>1?t.selectPosition(e-1,n):(t.selectPosition(( __get$(r,n) [0].isContinuation||e===1)&& __get$(r,n) [1]?1:0,n),t.moveBackward())),e>0? __get$(r,n) .length=e:n? __set$(r,n,null) :r[0].length=0,t.reorderLines(),t.ids())},t.mark=function(e,n){var r=i<0? __get$(t._lines(),o) : __get$(__get$(t._lines(),o),i) ,a=e.type,s=1;e.color&&(a===`arrow`?t.mark({key:e.color+e.key,type:`cal`},n):a===`square`&&t.mark({key:e.color+e.key,type:`csl`},n)),a!==`cal`&&a!==`csl`&&(a=`c_`+a,s=0),r.commands&& __get$(r.commands,a) &&( __set$(r.commands,a,__get$(r.commands,a).split(`,`).filter(function(t){return t.slice(s).split(`;`)[0]!==e.key.slice(s);}).join(`,`)) , __get$(r.commands,a) ||delete r.commands[a]),n||(r.commands||={}, __set$(r.commands,a,(__get$(r.commands,a)?__get$(r.commands,a)+`,`:``)+e.key+(e.data?`;`+e.data.join(`;`):``)) )},t.markings=function(){var e={},n=i<0? __get$(t._lines(),o) : __get$(__get$(t._lines(),o),i) ,r,a,s,c={cal:`arrow`,csl:`square`},l,u,d,f,p;for(a in n.commands){if(s= __get$(n.commands,a) , __get$(c,a) )a= __get$(c,a) ,l=0;else if(a.substr(0,2)===`c_`)a=a.slice(2),l=1;else continue;for( __set$(e,a,__get$(e,a)||{}) ,u=s.split(`,`),d=u.length,r=0;r<d;++r)l?(f= __get$(u,r) .split(`;`),p=f.shift(), __set$(__get$(e,a),p,__get$(__get$(e,a),p)||{type:a,key:p}) , __get$(__get$(e,a),p) .data=f):(p= __get$(u,r) .slice(1), __set$(__get$(e,a),p,__get$(__get$(e,a),p)||{type:a,key:p}) , __get$(__get$(e,a),p) .color= __get$(u,r) [0])}return e},t.clearMarkings=function(){var e=i<0? __get$(t._lines(),o) : __get$(__get$(t._lines(),o),i) ,n;for(n in e.commands)/^c[sa]l$|^c_/.test(n)&&delete e.commands[n]},t.pgn=function(e){var n=t.ids(),i;return t.selectLineEnd(0),i=r.pgn(e),t.selectPosition(n.move,n.line),i},t.loadMoves=function(e,n){var r,a,s,c,u;if(n||={},typeof e==`string`&&(e=p(e)),e){for(n.atCurrent||t.selectPosition(-1,0),s=o,a=e.length,r=0;r<a;++r){if(c=t.move( __get$(e,r) ,!0),!c&&( __get$(e,r) .promotion=n.autoPromote===!0?`q`:n.autoPromote,c=t.move( __get$(e,r) ,!0),!c))return!1;o!==s&&n.method!==`merge`&&(t.promoteVariation(o,1),n.method!==`promote`&&( __get$(t._history(),i) .lines=void 0,t.reorderLines()),s=o)}if(n.method===`promote`){if(a){for( __get$(t._history(),i+1) &&(c= __get$(t._history(),i) ,t.createVariation(),t.move(c),l(t._history()[0],c),t.promoteVariation(o,1)),u=t._lines(),r=u.length-1;r>=0;--r) __get$(u,r) .length===1&& __get$(u,r) [0].isContinuation&&(l( __get$(u,r) [0], __get$(__get$(u,__get$(u,r).parentId),__get$(u,r).atMoveNode) ), __get$(u,r) .length=0);t.removeEmptyLines()}}else n.method!==`merge`&&t.deletePosition(i+1,o)}return!0})}function E(e){var t,r;if(e||={},e.game)return e.game;if(t=n(),e.analysis&&T(t),e.disableHashing&&t.hashing(!1),e.pgn){if(!t.loadPgn(e.pgn,e.index,e.options)&&(e.variant!==`detect`||!n.variants.some(function(n){return e.options=e.options||{},e.options.variant=n,t.loadPgn(e.pgn,e.index,e.options)})))return!1}else{if(e.headers&&(e.variant=e.headers.Variant||e.variant,e.fen||=e.headers.FEN),e.variant===`detect`&&e.fen&&(e.fen.indexOf(`|`)>-1?e.variant=`Bughouse`:e.fen.split(`/`).length===9?e.variant=`Crazyhouse`:e.fen.indexOf(`+`)>-1?e.variant=`3-check`:e.variant=void 0),(e.fen||e.variant)&&!t.load(e.fen||a,e.variant))return!1;e.headers&&typeof e.headers==`object`&&!Array.isArray(e.headers)&&t.header(e.headers)}if(e.tcn)if(typeof e.tcn==`object`){if(!w(t,e.tcn,e.timestamps||[[],[]]))return!1}else r=p(e.tcn);else r=e.moves;return r&&!C(t,r,e,e.timestamps)?!1:t}function D(e){var t;return e||={},e.disableHashing=!0,t=E(e),t?t.pgn(e):!1}function O(t,n){var r,i=[],a;if(e.reset(),!e.loadPgn(t))return!1;if(r=e.moveCount(),typeof n==`number`){for(n<0&&(n=r+n+1),a=r-1;a>=n&&a>=0;--a)e.undo();return e.fen()}for(a=0;a<=r;a+=1)i.unshift(e.fen()),e.undo();return i}function k(e){return e&&(e.piece&u&&(e.promoted=!0),e.piece= __get$(c,e.piece&o) ,e.captured&&=(e.captured&u&&(e.capturedPromotedPawn=!0), __get$(c,e.captured&s) ),e.promotion&&= __get$(c,e.promotion&o) ,e.drop!==void 0&&(e.drop= __get$(l,e.drop) )),e}function ee(e){var t=e.history(!0,!0),n,r,i,a,o,s,c;if(e.siblingGame){for(n=e.siblingGame.history(!0,!0),i=t.length+n.length,r=[],a=0;a<i;++a)!t.length||n.length&&n[0].bughouseOrder<t[0].bughouseOrder?(o=n.shift(),o.board=`b`):(o=t.shift(),o.board=`a`),r.push(o);t=r}for(i=t.length,a=0;a<i;++a)if(s= __get$(t,a) ,s.fen||k(s),s.lines)for(c=s.lines.length-1;c>=0;--c)e.selectLine( __get$(s.lines,c) ), __set$(s.lines,c,ee(e).moves) ;return{moves:t}}function A(t,n,r){var i=[],a,o=e;return typeof n!=`number`&&(r=n,n=void 0),a=o.tokenizePgn(t,r),n<0&&(n=a.length+n),a?(r&&r.includeFen&&(o=E({analysis:!0})),a.forEach(function(e,t){var a,s;t===n||n===void 0?o.loadPgn([e],0,r)?(s=ee(o),a=o.header(),i.push({headers:a,moves:s.moves})):i.push(!1):i.push(void 0)}),typeof n==`number`? __get$(i,n) :i):!1}function j(t,n,r){return e.reset(),e.load(n,r)?k(e.move(t)):!1}function M(t,n){return e.completeFen(t).split(` `).slice(0,n||4).join(` `)}function N(t,n,r){return e.reset(),e.load(t,r),n&&!C(e,n)?!1:e.fen()}function P(t,n){var r,i,a,o;if(typeof t==`string`){if(i=e,i.reset(),!i.load(t,n))return null}else i=E(t);for(r=i.moves({verbose:!0}),o=r.length,a=0;a<o;++a)k( __get$(r,a) );return r}function te(t,n,r){var i,a={gameOver:!1,check:!1,checkmate:!1,draw:!1,stalemate:!1,threefold:!1,insufficient:!1},o;if(Array.isArray(n)||(r=n,n=null),typeof r==`boolean`?(i=r,r={}):(r||={},i=r.variant),typeof t==`string`){if(o=e,o.reset(),o.validateFen(t,i)!==0||!o.load(t,i))return!1}else o=E(t);return n&&!C(o,n)?!1:(r.getLegalMoves&&(a.legalMoves=P({game:o})),o.inCheck()?(a.check=!0,a.checkmate=o.inCheckmate()):a.stalemate=o.inStalemate(),a.threefold=o.inThreefoldRepetition(),a.insufficient=o.insufficientMaterial(r.color),a.fiftyMoveRule=o.in50MoveRule(),a.draw=a.stalemate||a.threefold||a.insufficient||a.fiftyMoveRule||o.inDraw(),r.skipValidation||(a.isValid=o.isPositionValid(r)),i&&(a.variantWin=o.isVariantWin(),a.variantWin===void 0&&(a.variantWin=o.isBughouseWin())),a.gameOver=a.checkmate||a.draw||!!a.variantWin,a)}function F(t,n){return e.validateFen(t,n)===0}function ne(e,n){t.loadBook(e,function(e,r){if(!r||!r.json)return n(e||Error(`Invalid book`));n(e,function(e){var n,i,a,o,s,c,l,u,d;if(e.hash)i=typeof e.hash==`string`?[t.hex64ToDec(e.hash)]:[e.hash],o=1;else{if(n=E(e),!n)return!1;i=n.hashes(),o=i.length}for(a=0;a<o;++a)if(s= __get$(r.json,t.to64BitHex(__get$(i,a))) ,s){if(s.constructor===Array)if(c&&s[0].m.indexOf(c.m)===-1){for(u=s.length-1;u>=0;--u)if(!u|| __get$(s,u) .m.indexOf(c.m)!==-1){d= __get$(s,u) ,d.e=s[0].e,d.s=s[0].s,d.mate=s[0].mate,d.v=s[0].v,d.h=s[0].h,d.n=d.n||s[0].n,d.u=d.u||s[0].u,d.c=d.c||s[0].c;break}}else d=s[0];else d=s;(d.n||e.allowNameless)&&(c=d)}else e.mustEndInBook&&(c=void 0);if(c)return l={name:c.n},c.m&&(l.moves=c.m),c.d!==void 0&&(l.sdiff=c.d/100),c.c&&(l.code=c.c,l.url=c.u|| __call$(__call$(__call$(__call$(__call$(__call$(__call$(__call$(c.n,"replace",[/[\u00e1-\u00e5]/g,`a`]),"replace",[/[\u0107\u010d]/g,`c`]),"replace",[/[\u00e9\u00e8\u0117\u0113]/g,`e`]),"replace",[/[\u00f3\u00f6\u00f8]/g,`o`]),"replace",[/[\u016f\u00fc]/g,`u`]),"replace",[/['+,]/g,``]),"replace",[/[^a-z0-9.]+/gi,`-`]),"replace",[/(with-\d|St)\.+-?/,`$1-`]) ),c.e?(l.eval=c.e,l.depth=c.h,l.score=c.e[0].cp/100,c.e[0].mate!==void 0&&(l.mate=c.e[0].mate)):(l.score=c.s/100,c.mate!==void 0&&(l.mate=c.mate)),c.v&&(l.bad=!0),l},r.json)})}function I(e,t){return i||=r(I),i(e,t)}return I.supportsMultithreading=function(){var e,t=!!I._hasThreads;if(typeof I._hasThreads!=`boolean`){try{e=new Worker(`data:application/javascript,`), __call$(e,"postMessage",[new SharedArrayBuffer(1)]) ,t=!0}catch{}try{e.terminate()}catch{}I._hasThreads=t}return t},I.gameFingerprints=S,I.getFenFromMoves=N,I.getLegalMoves=P,I.getPositionInfo=te,I.isFenValid=F,I.encodeTCN=m,I.decodeTCN=p,I.uciToObj=h,I.generatePgn=D,I.pgnToFen=O,I.pgnToJson=A,I.sanToObj=j,I.completeFen=e.completeFen,I.shortenFen=M,I.createGame=E,I.getPositionDetails=x,I.predict=b,I.normalizeMoveObj=k,I.FLAGS=e.FLAGS,I.loadECO=ne,I.CEE_LIB=function(){var e={};return e.addOptions=function(e,t){for(var n in t) __get$(t,n) !==void 0&&e.push(`setoption name `+n+` value `+ __get$(t,n) );return e},e.addVariations=function(e,t,n){var r,i;t||=[],n||=`variation`;for(var a=0;a<t.length;++a)r= __get$(t,a) ,r.pv=Array.isArray(r.pv)&&r.pv.join(` `)||r.pv||``,i=n+` `+r.pv,typeof r.mateIn==`number`?i+=` mate `+r.mateIn:typeof r.mate==`number`?i+=` mate `+r.mate:i+=` cp `+Math.round(r.cp),typeof r.depth==`number`&&(i+=` depth `+r.depth),e.push(i);return e},e.addPush=function(e,t){var n;return typeof t==`string`&&(t={moveLan:t}),n=`push `+t.moveLan,t.isBook&&(n+=` isBook`),t.isRetry&&(n+=` isRetry`),e.push(n),e},e.addPosition=function(e,t){return e.push(`position fen `+t),e},e.addVariant=function(e,t){return  __call$(String(t).toLowerCase(),"replace",[/ |-/g,``]) ===`chess960`?(e.push(`setoption name UCI_Variant value chess`),e.push(`setoption name UCI_Chess960 value true`)):(e.push(`setoption name UCI_Variant value chess`),e.push(`setoption name UCI_Chess960 value false`)),e},e}(),I}();return e.exports=i,i})()})({get exports(){return Be},set exports(e){Be=e}}),Ve=Be,U=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t==`object`&&typeof n==`object`){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e( __get$(t,i) , __get$(n,i) ))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n, __get$(a,i) ))return!1;for(i=r;i--!==0;){var o= __get$(a,i) ;if(!e( __get$(t,o) , __get$(n,o) ))return!1}return!0}return t!==t&&n!==n},(function(e){(function(e){(function(e){e.NoTransition=`NoTransition`,e.OnEnter=`Enter`,e.OnExit=`Exit`,e.OnReEnter=`ReEnter`})(e.Types||={})})(e.Event||={})})(W||={}),G=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},He=l(function(e,t){(function(){var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent=`canplaythrough`,e._navigator=typeof window<`u`&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||u(),e!==void 0&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var r=0;r<t._howls.length;r++)if(! __get$(t._howls,r) ._webAudio)for(var i= __get$(t._howls,r) ._getSoundIds(),a=0;a<i.length;a++){var o= __get$(t._howls,r) ._soundById( __get$(i,a) );o&&o._node&&(o._node.volume=o._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||u(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,n.ctx.currentTime);for(var r=0;r<t._howls.length;r++)if(! __get$(t._howls,r) ._webAudio)for(var i= __get$(t._howls,r) ._getSoundIds(),a=0;a<i.length;a++){var o= __get$(t._howls,r) ._soundById( __get$(i,a) );o&&o._node&&(o._node.muted=e?!0:o._muted)}return t},stop:function(){for(var e=this||n,t=0;t<e._howls.length;t++) __get$(e._howls,t) .stop();return e},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--) __get$(e._howls,t) .unload();return e.usingWebAudio&&e.ctx&&e.ctx.close!==void 0&&(e.ctx.close(),e.ctx=null,u()),e},codecs:function(e){return __get$((this||n)._codecs,__call$(e,"replace",[/^x-/,``])) },_setup:function(){var e=this||n;if(e.state=e.ctx&&e.ctx.state||`suspended`,e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<`u`)try{var t=new Audio;t.oncanplaythrough===void 0&&(e._canPlayEvent=`canplay`)}catch{e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t=typeof Audio<`u`?new Audio:null}catch{return e}if(!t||typeof t.canPlayType!=`function`)return e;var r= __call$(t.canPlayType(`audio/mpeg;`),"replace",[/^no$/,``]) ,i=e._navigator?e._navigator.userAgent:``,a=i.match(/OPR\/([0-6].)/g),o=a&&parseInt(a[0].split(`/`)[1],10)<33,s=i.indexOf(`Safari`)!==-1&&i.indexOf(`Chrome`)===-1,c=i.match(/Version\/(.*?) /),l=s&&c&&parseInt(c[1],10)<15;return e._codecs={mp3:!!(!o&&(r|| __call$(t.canPlayType(`audio/mp3;`),"replace",[/^no$/,``]) )),mpeg:!!r,opus:!! __call$(t.canPlayType(`audio/ogg; codecs="opus"`),"replace",[/^no$/,``]) ,ogg:!! __call$(t.canPlayType(`audio/ogg; codecs="vorbis"`),"replace",[/^no$/,``]) ,oga:!! __call$(t.canPlayType(`audio/ogg; codecs="vorbis"`),"replace",[/^no$/,``]) ,wav:!! __call$(t.canPlayType(`audio/wav; codecs="1"`)||t.canPlayType(`audio/wav`),"replace",[/^no$/,``]) ,aac:!! __call$(t.canPlayType(`audio/aac;`),"replace",[/^no$/,``]) ,caf:!! __call$(t.canPlayType(`audio/x-caf;`),"replace",[/^no$/,``]) ,m4a:!! __call$(t.canPlayType(`audio/x-m4a;`)||t.canPlayType(`audio/m4a;`)||t.canPlayType(`audio/aac;`),"replace",[/^no$/,``]) ,m4b:!! __call$(t.canPlayType(`audio/x-m4b;`)||t.canPlayType(`audio/m4b;`)||t.canPlayType(`audio/aac;`),"replace",[/^no$/,``]) ,mp4:!! __call$(t.canPlayType(`audio/x-mp4;`)||t.canPlayType(`audio/mp4;`)||t.canPlayType(`audio/aac;`),"replace",[/^no$/,``]) ,weba:!!(!l&& __call$(t.canPlayType(`audio/webm; codecs="vorbis"`),"replace",[/^no$/,``]) ),webm:!!(!l&& __call$(t.canPlayType(`audio/webm; codecs="vorbis"`),"replace",[/^no$/,``]) ),dolby:!! __call$(t.canPlayType(`audio/mp4; codecs="ec-3"`),"replace",[/^no$/,``]) ,flac:!! __call$(t.canPlayType(`audio/x-flac;`)||t.canPlayType(`audio/flac;`),"replace",[/^no$/,``]) },e},_unlockAudio:function(){var e=this||n;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,e._releaseHtml5Audio(r)}catch{e.noAudio=!0;break}for(var i=0;i<e._howls.length;i++)if(! __get$(e._howls,i) ._webAudio)for(var a= __get$(e._howls,i) ._getSoundIds(),o=0;o<a.length;o++){var s= __get$(e._howls,i) ._soundById( __get$(a,o) );s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}e._autoResume();var c=e.ctx.createBufferSource();c.buffer=e._scratchBuffer,c.connect(e.ctx.destination),c.start===void 0?c.noteOn(0):c.start(0),typeof e.ctx.resume==`function`&&e.ctx.resume(),c.onended=function(){c.disconnect(0),e._audioUnlocked=!0,document.removeEventListener(`touchstart`,t,!0),document.removeEventListener(`touchend`,t,!0),document.removeEventListener(`click`,t,!0),document.removeEventListener(`keydown`,t,!0);for(var n=0;n<e._howls.length;n++) __get$(e._howls,n) ._emit(`unlock`)}};return document.addEventListener(`touchstart`,t,!0),document.addEventListener(`touchend`,t,!0),document.addEventListener(`click`,t,!0),document.addEventListener(`keydown`,t,!0),e}},_obtainHtml5Audio:function(){var e=this||n;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=new Audio().play();return t&&typeof Promise<`u`&&(t instanceof Promise||typeof t.then==`function`)&&t.catch(function(){console.warn(`HTML5 Audio pool exhausted, returning potentially locked audio object.`)}),new Audio},_releaseHtml5Audio:function(e){var t=this||n;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||e.ctx.suspend===void 0||!n.usingWebAudio)){for(var t=0;t<e._howls.length;t++)if( __get$(e._howls,t) ._webAudio){for(var r=0;r< __get$(e._howls,t) ._sounds.length;r++)if(! __get$(__get$(e._howls,t)._sounds,r) ._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state=`suspending`;var t=function(){e.state=`suspended`,e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||e.ctx.resume===void 0||!n.usingWebAudio))return e.state===`running`&&e.ctx.state!==`interrupted`&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state===`suspended`||e.state===`running`&&e.ctx.state===`interrupted`?(e.ctx.resume().then(function(){e.state=`running`;for(var t=0;t<e._howls.length;t++) __get$(e._howls,t) ._emit(`resume`)}),e._suspendTimer&&=(clearTimeout(e._suspendTimer),null)):e.state===`suspending`&&(e._resumeAfterSuspend=!0),e}};var n=new e,r=function(e){var t=this;if(!e.src||e.src.length===0){console.error(`An array of source files must be passed with any new Howl.`);return}t.init(e)};r.prototype={init:function(e){var t=this;return n.ctx||u(),t._autoplay=e.autoplay||!1,t._format=typeof e.format==`string`?[e.format]:e.format,t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload=typeof e.preload==`boolean`||e.preload===`metadata`?e.preload:!0,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src=typeof e.src==`string`?[e.src]:e.src,t._volume=e.volume===void 0?1:e.volume,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:`GET`,headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},t._duration=0,t._state=`unloaded`,t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,n.ctx!==void 0&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:`play`,action:function(){t.play()}}),t._preload&&t._preload!==`none`&&t.load(),t},load:function(){var e=this,t=null;if(n.noAudio){e._emit(`loaderror`,null,`No audio support.`);return}typeof e._src==`string`&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var a,s;if(e._format&& __get$(e._format,r) )a= __get$(e._format,r) ;else{if(s= __get$(e._src,r) ,typeof s!=`string`){e._emit(`loaderror`,null,`Non-string found in selected audio sources - ignoring.`);continue}a=/^data:audio\/([^;,]+);/i.exec(s),a||=/\.([^.]+)$/.exec(s.split(`?`,1)[0]),a&&=a[1].toLowerCase()}if(a||console.warn(`No file extension was found. Consider using the "format" property or specify an extension.`),a&&n.codecs(a)){t= __get$(e._src,r) ;break}}if(!t){e._emit(`loaderror`,null,`No codec support for selected audio sources.`);return}return e._src=t,e._state=`loading`, __get$(window,"location") .protocol===`https:`&&t.slice(0,5)===`http:`&&(e._html5=!0,e._webAudio=!1),new i(e),e._webAudio&&o(e),e},play:function(e,t){var r=this,i=null;if(typeof e==`number`)i=e,e=null;else if(typeof e==`string`&&r._state===`loaded`&&! __get$(r._sprite,e) )return null;else if(e===void 0&&(e=`__default`,!r._playLock)){for(var a=0,o=0;o<r._sounds.length;o++) __get$(r._sounds,o) ._paused&&! __get$(r._sounds,o) ._ended&&(a++,i= __get$(r._sounds,o) ._id);a===1?e=null:i=null}var s=i?r._soundById(i):r._inactiveSound();if(!s)return null;if(i&&!e&&(e=s._sprite||`__default`),r._state!==`loaded`){s._sprite=e,s._ended=!1;var c=s._id;return r._queue.push({event:`play`,action:function(){r.play(c)}}),c}if(i&&!s._paused)return t||r._loadQueue(`play`),s._id;r._webAudio&&n._autoResume();var l=Math.max(0,s._seek>0?s._seek: __get$(r._sprite,e) [0]/1e3),u=Math.max(0,( __get$(r._sprite,e) [0]+ __get$(r._sprite,e) [1])/1e3-l),d=u*1e3/Math.abs(s._rate),f= __get$(r._sprite,e) [0]/1e3,p=( __get$(r._sprite,e) [0]+ __get$(r._sprite,e) [1])/1e3;s._sprite=e,s._ended=!1;var m=function(){s._paused=!1,s._seek=l,s._start=f,s._stop=p,s._loop=!!(s._loop|| __get$(r._sprite,e) [2])};if(l>=p){r._ended(s);return}var h=s._node;if(r._webAudio){var g=function(){r._playLock=!1,m(),r._refreshBuffer(s);var e=s._muted||r._muted?0:s._volume;h.gain.setValueAtTime(e,n.ctx.currentTime),s._playStart=n.ctx.currentTime,h.bufferSource.start===void 0?s._loop?h.bufferSource.noteGrainOn(0,l,86400):h.bufferSource.noteGrainOn(0,l,u):s._loop?h.bufferSource.start(0,l,86400):h.bufferSource.start(0,l,u),d!==1/0&&( __set$(r._endTimers,s._id,setTimeout(r._ended.bind(r,s),d)) ),t||setTimeout(function(){r._emit(`play`,s._id),r._loadQueue()},0)};n.state===`running`&&n.ctx.state!==`interrupted`?g():(r._playLock=!0,r.once(`resume`,g),r._clearTimer(s._id))}else{var _=function(){h.currentTime=l,h.muted=s._muted||r._muted||n._muted||h.muted,h.volume=s._volume*n.volume(),h.playbackRate=s._rate;try{var i=h.play();if(i&&typeof Promise<`u`&&(i instanceof Promise||typeof i.then==`function`)?(r._playLock=!0,m(),i.then(function(){r._playLock=!1,h._unlocked=!0,t?r._loadQueue():r._emit(`play`,s._id)}).catch(function(){r._playLock=!1,r._emit(`playerror`,s._id,`Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.`),s._ended=!0,s._paused=!0})):t||(r._playLock=!1,m(),r._emit(`play`,s._id)),h.playbackRate=s._rate,h.paused){r._emit(`playerror`,s._id,`Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.`);return}e!==`__default`||s._loop? __set$(r._endTimers,s._id,setTimeout(r._ended.bind(r,s),d)) :( __set$(r._endTimers,s._id,function(){r._ended(s),h.removeEventListener(`ended`,__get$(r._endTimers,s._id),!1);}) ,h.addEventListener(`ended`, __get$(r._endTimers,s._id) ,!1))}catch(e){r._emit(`playerror`,s._id,e)}};h.src===`data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA`&&(h.src=r._src,h.load());var v=window&&window.ejecta||!h.readyState&&n._navigator.isCocoonJS;if(h.readyState>=3||v)_();else{r._playLock=!0,r._state=`loading`;var y=function(){r._state=`loaded`,_(),h.removeEventListener(n._canPlayEvent,y,!1)};h.addEventListener(n._canPlayEvent,y,!1),r._clearTimer(s._id)}}return s._id},pause:function(e){var t=this;if(t._state!==`loaded`||t._playLock)return t._queue.push({event:`pause`,action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),r=0;r<n.length;r++){t._clearTimer( __get$(n,r) );var i=t._soundById( __get$(n,r) );if(i&&!i._paused&&(i._seek=t.seek( __get$(n,r) ),i._rateSeek=0,i._paused=!0,t._stopFade( __get$(n,r) ),i._node))if(t._webAudio){if(!i._node.bufferSource)continue;i._node.bufferSource.stop===void 0?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),t._cleanBuffer(i._node)}else (!isNaN(i._node.duration)||i._node.duration===1/0)&&i._node.pause();arguments[1]||t._emit(`pause`,i?i._id:null)}return t},stop:function(e,t){var n=this;if(n._state!==`loaded`||n._playLock)return n._queue.push({event:`stop`,action:function(){n.stop(e)}}),n;for(var r=n._getSoundIds(e),i=0;i<r.length;i++){n._clearTimer( __get$(r,i) );var a=n._soundById( __get$(r,i) );a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,n._stopFade( __get$(r,i) ),a._node&&(n._webAudio?a._node.bufferSource&&(a._node.bufferSource.stop===void 0?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),n._cleanBuffer(a._node)):(!isNaN(a._node.duration)||a._node.duration===1/0)&&(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&n._clearSound(a._node))),t||n._emit(`stop`,a._id))}return n},mute:function(e,t){var r=this;if(r._state!==`loaded`||r._playLock)return r._queue.push({event:`mute`,action:function(){r.mute(e,t)}}),r;if(t===void 0)if(typeof e==`boolean`)r._muted=e;else return r._muted;for(var i=r._getSoundIds(t),a=0;a<i.length;a++){var o=r._soundById( __get$(i,a) );o&&(o._muted=e,o._interval&&r._stopFade(o._id),r._webAudio&&o._node?o._node.gain.setValueAtTime(e?0:o._volume,n.ctx.currentTime):o._node&&(o._node.muted=n._muted?!0:e),r._emit(`mute`,o._id))}return r},volume:function(){var e=this,t=arguments,r,i;if(t.length===0)return e._volume;t.length===1||t.length===2&&t[1]===void 0?e._getSoundIds().indexOf(t[0])>=0?i=parseInt(t[0],10):r=parseFloat(t[0]):t.length>=2&&(r=parseFloat(t[0]),i=parseInt(t[1],10));var a;if(r!==void 0&&r>=0&&r<=1){if(e._state!==`loaded`||e._playLock)return e._queue.push({event:`volume`,action:function(){e.volume.apply(e,t)}}),e;i===void 0&&(e._volume=r),i=e._getSoundIds(i);for(var o=0;o<i.length;o++)a=e._soundById( __get$(i,o) ),a&&(a._volume=r,t[2]||e._stopFade( __get$(i,o) ),e._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(r,n.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=r*n.volume()),e._emit(`volume`,a._id))}else return a=i?e._soundById(i):e._sounds[0],a?a._volume:0;return e},fade:function(e,t,r,i){var a=this;if(a._state!==`loaded`||a._playLock)return a._queue.push({event:`fade`,action:function(){a.fade(e,t,r,i)}}),a;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),r=parseFloat(r),a.volume(e,i);for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var c=a._soundById( __get$(o,s) );if(c){if(i||a._stopFade( __get$(o,s) ),a._webAudio&&!c._muted){var l=n.ctx.currentTime,u=l+r/1e3;c._volume=e,c._node.gain.setValueAtTime(e,l),c._node.gain.linearRampToValueAtTime(t,u)}a._startFadeInterval(c,e,t,r, __get$(o,s) ,i===void 0)}}return a},_startFadeInterval:function(e,t,n,r,i,a){var o=this,s=t,c=n-t,l=Math.abs(c/.01),u=Math.max(4,l>0?r/l:r),d=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var i=(Date.now()-d)/r;d=Date.now(),s+=c*i,s=Math.round(s*100)/100,s=c<0?Math.max(n,s):Math.min(n,s),o._webAudio?e._volume=s:o.volume(s,e._id,!0),a&&(o._volume=s),(n<t&&s<=n||n>t&&s>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,o.volume(n,e._id),o._emit(`fade`,e._id))},u)},_stopFade:function(e){var t=this,r=t._soundById(e);return r&&r._interval&&(t._webAudio&&r._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(r._interval),r._interval=null,t.volume(r._fadeTo,e),r._fadeTo=null,t._emit(`fade`,e)),t},loop:function(){var e=this,t=arguments,n,r,i;if(t.length===0)return e._loop;if(t.length===1)if(typeof t[0]==`boolean`)n=t[0],e._loop=n;else return i=e._soundById(parseInt(t[0],10)),i?i._loop:!1;else t.length===2&&(n=t[0],r=parseInt(t[1],10));for(var a=e._getSoundIds(r),o=0;o<a.length;o++)i=e._soundById( __get$(a,o) ),i&&(i._loop=n,e._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=n,n&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop,e.playing( __get$(a,o) )&&(e.pause( __get$(a,o) ,!0),e.play( __get$(a,o) ,!0)))));return e},rate:function(){var e=this,t=arguments,r,i;t.length===0?i=e._sounds[0]._id:t.length===1?e._getSoundIds().indexOf(t[0])>=0?i=parseInt(t[0],10):r=parseFloat(t[0]):t.length===2&&(r=parseFloat(t[0]),i=parseInt(t[1],10));var a;if(typeof r==`number`){if(e._state!==`loaded`||e._playLock)return e._queue.push({event:`rate`,action:function(){e.rate.apply(e,t)}}),e;i===void 0&&(e._rate=r),i=e._getSoundIds(i);for(var o=0;o<i.length;o++)if(a=e._soundById( __get$(i,o) ),a){e.playing( __get$(i,o) )&&(a._rateSeek=e.seek( __get$(i,o) ),a._playStart=e._webAudio?n.ctx.currentTime:a._playStart),a._rate=r,e._webAudio&&a._node&&a._node.bufferSource?a._node.bufferSource.playbackRate.setValueAtTime(r,n.ctx.currentTime):a._node&&(a._node.playbackRate=r);var s=e.seek( __get$(i,o) ),c=(( __get$(e._sprite,a._sprite) [0]+ __get$(e._sprite,a._sprite) [1])/1e3-s)*1e3/Math.abs(a._rate);( __get$(e._endTimers,__get$(i,o)) ||!a._paused)&&(e._clearTimer( __get$(i,o) ), __set$(e._endTimers,__get$(i,o),setTimeout(e._ended.bind(e,a),c)) ),e._emit(`rate`,a._id)}}else return a=e._soundById(i),a?a._rate:e._rate;return e},seek:function(){var e=this,t=arguments,r,i;if(t.length===0?e._sounds.length&&(i=e._sounds[0]._id):t.length===1?e._getSoundIds().indexOf(t[0])>=0?i=parseInt(t[0],10):e._sounds.length&&(i=e._sounds[0]._id,r=parseFloat(t[0])):t.length===2&&(r=parseFloat(t[0]),i=parseInt(t[1],10)),i===void 0)return 0;if(typeof r==`number`&&(e._state!==`loaded`||e._playLock))return e._queue.push({event:`seek`,action:function(){e.seek.apply(e,t)}}),e;var a=e._soundById(i);if(a)if(typeof r==`number`&&r>=0){var o=e.playing(i);o&&e.pause(i,!0),a._seek=r,a._ended=!1,e._clearTimer(i),!e._webAudio&&a._node&&!isNaN(a._node.duration)&&(a._node.currentTime=r);var s=function(){o&&e.play(i,!0),e._emit(`seek`,i)};if(o&&!e._webAudio){var c=function(){e._playLock?setTimeout(c,0):s()};setTimeout(c,0)}else s()}else if(e._webAudio){var l=e.playing(i)?n.ctx.currentTime-a._playStart:0,u=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(u+l*Math.abs(a._rate))}else return a._node.currentTime;return e},playing:function(e){var t=this;if(typeof e==`number`){var n=t._soundById(e);return n?!n._paused:!1}for(var r=0;r<t._sounds.length;r++)if(! __get$(t._sounds,r) ._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,r=t._soundById(e);return r&&(n= __get$(t._sprite,r._sprite) [1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,r=0;r<t.length;r++) __get$(t,r) ._paused||e.stop( __get$(t,r) ._id),e._webAudio||(e._clearSound( __get$(t,r) ._node), __get$(t,r) ._node.removeEventListener(`error`, __get$(t,r) ._errorFn,!1), __get$(t,r) ._node.removeEventListener(n._canPlayEvent, __get$(t,r) ._loadFn,!1), __get$(t,r) ._node.removeEventListener(`ended`, __get$(t,r) ._endFn,!1),n._releaseHtml5Audio( __get$(t,r) ._node)),delete  __get$(t,r) ._node,e._clearTimer( __get$(t,r) ._id);var i=n._howls.indexOf(e);i>=0&&n._howls.splice(i,1);var o=!0;for(r=0;r<n._howls.length;r++)if( __get$(n._howls,r) ._src===e._src||e._src.indexOf( __get$(n._howls,r) ._src)>=0){o=!1;break}return a&&o&&delete a[e._src],n.noAudio=!1,e._state=`unloaded`,e._sounds=[],e=null,null},on:function(e,t,n,r){var i=this,a= __get$(i,`_on`+e) ;return typeof t==`function`&&a.push(r?{id:n,fn:t,once:r}:{id:n,fn:t}),i},off:function(e,t,n){var r=this,i= __get$(r,`_on`+e) ,a=0;if(typeof t==`number`&&(n=t,t=null),t||n)for(a=0;a<i.length;a++){var o=n=== __get$(i,a) .id;if(t=== __get$(i,a) .fn&&o||!t&&o){i.splice(a,1);break}}else if(e) __set$(r,`_on`+e,[]) ;else{var s=Object.keys(r);for(a=0;a<s.length;a++) __get$(s,a) .indexOf(`_on`)===0&&Array.isArray( __get$(r,__get$(s,a)) )&&( __set$(r,__get$(s,a),[]) )}return r},once:function(e,t,n){var r=this;return r.on(e,t,n,1),r},_emit:function(e,t,n){for(var r=this,i= __get$(r,`_on`+e) ,a=i.length-1;a>=0;a--)(! __get$(i,a) .id|| __get$(i,a) .id===t||e===`load`)&&(setTimeout(function(e){e.call(this,t,n)}.bind(r, __get$(i,a) .fn),0), __get$(i,a) .once&&r.off(e, __get$(i,a) .fn, __get$(i,a) .id));return r._loadQueue(e),r},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var t=this,r=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var i=!!(e._loop|| __get$(t._sprite,r) [2]);if(t._emit(`end`,e._id),!t._webAudio&&i&&t.stop(e._id,!0).play(e._id),t._webAudio&&i){t._emit(`play`,e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var a=(e._stop-e._start)*1e3/Math.abs(e._rate); __set$(t._endTimers,e._id,setTimeout(t._ended.bind(t,e),a)) }return t._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),n._autoSuspend()),!t._webAudio&&!i&&t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if( __get$(t._endTimers,e) ){if(typeof  __get$(t._endTimers,e) !=`function`)clearTimeout( __get$(t._endTimers,e) );else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener(`ended`, __get$(t._endTimers,e) ,!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e=== __get$(t._sounds,n) ._id)return  __get$(t._sounds,n) ;return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if( __get$(e._sounds,t) ._ended)return  __get$(e._sounds,t) .reset();return new i(e)},_drain:function(){var e=this,t=e._pool,n=0,r=0;if(!(e._sounds.length<t)){for(r=0;r<e._sounds.length;r++) __get$(e._sounds,r) ._ended&&n++;for(r=e._sounds.length-1;r>=0;r--){if(n<=t)return; __get$(e._sounds,r) ._ended&&(e._webAudio&& __get$(e._sounds,r) ._node&& __get$(e._sounds,r) ._node.disconnect(0),e._sounds.splice(r,1),n--)}}},_getSoundIds:function(e){var t=this;if(e===void 0){for(var n=[],r=0;r<t._sounds.length;r++)n.push( __get$(t._sounds,r) ._id);return n}else return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer= __get$(a,t._src) ,e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),t},_cleanBuffer:function(e){var t=this,r=n._navigator&&n._navigator.vendor.indexOf(`Apple`)>=0;if(n._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),r))try{e.bufferSource.buffer=n._scratchBuffer}catch{}return e.bufferSource=null,t},_clearSound:function(e){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(e.src=`data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA`)}};var i=function(e){this._parent=e,this.init()};i.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite=`__default`,e._id=++n._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,r=n._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=n.ctx.createGain===void 0?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(r,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):n.noAudio||(e._node=n._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener(`error`,e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener(`ended`,e._endFn,!1),e._node.src=t._src,e._node.preload=t._preload===!0?`auto`:t._preload,e._node.volume=r*n.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite=`__default`,e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit(`loaderror`,e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener(`error`,e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(e._node.duration*10)/10,Object.keys(t._sprite).length===0&&(t._sprite={__default:[0,t._duration*1e3]}),t._state!==`loaded`&&(t._state=`loaded`,t._emit(`load`),t._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(e._node.duration*10)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=t._duration*1e3),t._ended(e)),e._node.removeEventListener(`ended`,e._endFn,!1)}};var a={},o=function(e){var t=e._src;if( __get$(a,t) ){e._duration= __get$(a,t) .duration,l(e);return}if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(`,`)[1]),r=new Uint8Array(n.length),i=0;i<n.length;++i) __set$(r,i,n.charCodeAt(i)) ;c(r.buffer,e)}else{var o=new XMLHttpRequest;o.open(e._xhr.method,t,!0),o.withCredentials=e._xhr.withCredentials,o.responseType=`arraybuffer`,e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(t){o.setRequestHeader(t, __get$(e._xhr.headers,t) )}),o.onload=function(){var t=(o.status+``)[0];if(t!==`0`&&t!==`2`&&t!==`3`){e._emit(`loaderror`,null,`Failed loading audio file with status: `+o.status+`.`);return}c(o.response,e)},o.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete a[t],e.load())},s(o)}},s=function(e){try{e.send()}catch{e.onerror()}},c=function(e,t){var r=function(){t._emit(`loaderror`,null,`Decoding audio data failed.`)},i=function(e){e&&t._sounds.length>0?( __set$(a,t._src,e) ,l(t,e)):r()};typeof Promise<`u`&&n.ctx.decodeAudioData.length===1?n.ctx.decodeAudioData(e).then(i).catch(r):n.ctx.decodeAudioData(e,i,r)},l=function(e,t){t&&!e._duration&&(e._duration=t.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!==`loaded`&&(e._state=`loaded`,e._emit(`load`),e._loadQueue())},u=function(){if(n.usingWebAudio){try{typeof AudioContext<`u`?n.ctx=new AudioContext:typeof webkitAudioContext<`u`?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch{n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),r=t?parseInt(t[1],10):null;if(e&&r&&r<9){var i=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!i&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=n.ctx.createGain===void 0?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};t.Howler=n,t.Howl=r,G===void 0?typeof window<`u`&&(window.HowlerGlobal=e,window.Howler=n,window.Howl=r,window.Sound=i):(G.HowlerGlobal=e,G.Howler=n,G.Howl=r,G.Sound=i)})(),(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--) __get$(t._howls,n) .stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var r=this;if(!r.ctx||!r.ctx.listener)return r;if(t=typeof t==`number`?t:r._pos[1],n=typeof n==`number`?n:r._pos[2],typeof e==`number`)r._pos=[e,t,n],r.ctx.listener.positionX===void 0?r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]):(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1));else return r._pos;return r},HowlerGlobal.prototype.orientation=function(e,t,n,r,i,a){var o=this;if(!o.ctx||!o.ctx.listener)return o;var s=o._orientation;if(t=typeof t==`number`?t:s[1],n=typeof n==`number`?n:s[2],r=typeof r==`number`?r:s[3],i=typeof i==`number`?i:s[4],a=typeof a==`number`?a:s[5],typeof e==`number`)o._orientation=[e,t,n,r,i,a],o.ctx.listener.forwardX===void 0?o.ctx.listener.setOrientation(e,t,n,r,i,a):(o.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1));else return s;return o},Howl.prototype.init=function(e){return function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:t.coneInnerAngle===void 0?360:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle===void 0?360:t.coneOuterAngle,coneOuterGain:t.coneOuterGain===void 0?0:t.coneOuterGain,distanceModel:t.distanceModel===void 0?`inverse`:t.distanceModel,maxDistance:t.maxDistance===void 0?1e4:t.maxDistance,panningModel:t.panningModel===void 0?`HRTF`:t.panningModel,refDistance:t.refDistance===void 0?1:t.refDistance,rolloffFactor:t.rolloffFactor===void 0?1:t.rolloffFactor},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if(r._state!==`loaded`)return r._queue.push({event:`stereo`,action:function(){r.stereo(t,n)}}),r;var i=Howler.ctx.createStereoPanner===void 0?`spatial`:`stereo`;if(n===void 0)if(typeof t==`number`)r._stereo=t,r._pos=[t,0,0];else return r._stereo;for(var a=r._getSoundIds(n),o=0;o<a.length;o++){var s=r._soundById( __get$(a,o) );if(s)if(typeof t==`number`)s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel=`equalpower`,(!s._panner||!s._panner.pan)&&e(s,i),i===`spatial`?s._panner.positionX===void 0?s._panner.setPosition(t,0,0):(s._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit(`stereo`,s._id);else return s._stereo}return r},Howl.prototype.pos=function(t,n,r,i){var a=this;if(!a._webAudio)return a;if(a._state!==`loaded`)return a._queue.push({event:`pos`,action:function(){a.pos(t,n,r,i)}}),a;if(n=typeof n==`number`?n:0,r=typeof r==`number`?r:-.5,i===void 0)if(typeof t==`number`)a._pos=[t,n,r];else return a._pos;for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var c=a._soundById( __get$(o,s) );if(c)if(typeof t==`number`)c._pos=[t,n,r],c._node&&((!c._panner||c._panner.pan)&&e(c,`spatial`),c._panner.positionX===void 0?c._panner.setPosition(t,n,r):(c._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime))),a._emit(`pos`,c._id);else return c._pos}return a},Howl.prototype.orientation=function(t,n,r,i){var a=this;if(!a._webAudio)return a;if(a._state!==`loaded`)return a._queue.push({event:`orientation`,action:function(){a.orientation(t,n,r,i)}}),a;if(n=typeof n==`number`?n:a._orientation[1],r=typeof r==`number`?r:a._orientation[2],i===void 0)if(typeof t==`number`)a._orientation=[t,n,r];else return a._orientation;for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var c=a._soundById( __get$(o,s) );if(c)if(typeof t==`number`)c._orientation=[t,n,r],c._node&&(c._panner||(c._pos||=a._pos||[0,0,-.5],e(c,`spatial`)),c._panner.orientationX===void 0?c._panner.setOrientation(t,n,r):(c._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime))),a._emit(`orientation`,c._id);else return c._orientation}return a},Howl.prototype.pannerAttr=function(){var t=this,n=arguments,r,i,a;if(!t._webAudio)return t;if(n.length===0)return t._pannerAttr;if(n.length===1)if(typeof n[0]==`object`)r=n[0],i===void 0&&(r.pannerAttr||={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel},t._pannerAttr={coneInnerAngle:r.pannerAttr.coneInnerAngle===void 0?t._coneInnerAngle:r.pannerAttr.coneInnerAngle,coneOuterAngle:r.pannerAttr.coneOuterAngle===void 0?t._coneOuterAngle:r.pannerAttr.coneOuterAngle,coneOuterGain:r.pannerAttr.coneOuterGain===void 0?t._coneOuterGain:r.pannerAttr.coneOuterGain,distanceModel:r.pannerAttr.distanceModel===void 0?t._distanceModel:r.pannerAttr.distanceModel,maxDistance:r.pannerAttr.maxDistance===void 0?t._maxDistance:r.pannerAttr.maxDistance,refDistance:r.pannerAttr.refDistance===void 0?t._refDistance:r.pannerAttr.refDistance,rolloffFactor:r.pannerAttr.rolloffFactor===void 0?t._rolloffFactor:r.pannerAttr.rolloffFactor,panningModel:r.pannerAttr.panningModel===void 0?t._panningModel:r.pannerAttr.panningModel});else return a=t._soundById(parseInt(n[0],10)),a?a._pannerAttr:t._pannerAttr;else n.length===2&&(r=n[0],i=parseInt(n[1],10));for(var o=t._getSoundIds(i),s=0;s<o.length;s++)if(a=t._soundById( __get$(o,s) ),a){var c=a._pannerAttr;c={coneInnerAngle:r.coneInnerAngle===void 0?c.coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle===void 0?c.coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain===void 0?c.coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel===void 0?c.distanceModel:r.distanceModel,maxDistance:r.maxDistance===void 0?c.maxDistance:r.maxDistance,refDistance:r.refDistance===void 0?c.refDistance:r.refDistance,rolloffFactor:r.rolloffFactor===void 0?c.rolloffFactor:r.rolloffFactor,panningModel:r.panningModel===void 0?c.panningModel:r.panningModel};var l=a._panner;l?(l.coneInnerAngle=c.coneInnerAngle,l.coneOuterAngle=c.coneOuterAngle,l.coneOuterGain=c.coneOuterGain,l.distanceModel=c.distanceModel,l.maxDistance=c.maxDistance,l.refDistance=c.refDistance,l.rolloffFactor=c.rolloffFactor,l.panningModel=c.panningModel):(a._pos||=t._pos||[0,0,-.5],e(a,`spatial`))}return t},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var e=function(e,t){t||=`spatial`,t===`spatial`?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.positionX===void 0?e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]):(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)),e._panner.orientationX===void 0?e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2]):(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime))):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()}),Ue=class{constructor(e,t=!1){this.howler=null,this.useAudioElement=!1,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?this.assets=e.filter(e=>e.endsWith(`mp3`)).concat(e.filter(e=>!e.endsWith(`mp3`))):this.assets=e,this.useAudioElement=t}load(){this.unload(),this.howler||=new He.Howl({html5:this.useAudioElement,src:this.assets,onloaderror:()=>{console.warn(`Howler: sounds failed to load, falling back to html5 audio`),this.howler=new He.Howl({html5:!0,src:this.assets,onloaderror:()=>{console.error(`Howler: html5 audio fallback failed to load`)}})}})}unload(){var e;(e=this.howler)==null||e.unload()}play(){var e;this.howler||this.load(),(e=this.howler)==null||e.play(),window.Cypress&&(window.Cypress.howlerHistory||(window.Cypress.howlerHistory=[]),window.Cypress.howlerHistory.push({time:Date.now(),src:this.assets.slice(0)}))}},(function(e){e.Suspended=`web-ui-sound-suspended`,e.Enabled=`web-ui-sound-enabled`})(We||={}),Ge=[`mousedown`,`keydown`,`touchstart`,`touchend`],Ke=!1,qe=window.chesscom||{},Je=window.AudioContext||window.webkitAudioContext,Ye=!!Je,Xe=3,Ze=0,Qe=!1,$e=class{constructor(e=`keyval-store`,t=`keyval`){this.storeName=t,this._dbp=new Promise((n,r)=>{let i=indexedDB.open(e,1);i.onerror=()=>r(i.error),i.onsuccess=()=>n(i.result),i.onupgradeneeded=()=>{i.result.createObjectStore(t)}})}_withIDBStore(e,t){return this._dbp.then(n=>new Promise((r,i)=>{let a=n.transaction(this.storeName,e);a.oncomplete=()=>r(),a.onabort=a.onerror=()=>i(a.error),t(a.objectStore(this.storeName))}))}},tt=[``,!0,1,`true`,`contenteditable`],rt=class{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){this.e||(this.is_svg?this.e=ne(t.nodeName):this.e=F(t.nodeType===11?`TEMPLATE`:t.nodeName),this.t=t.tagName===`TEMPLATE`?t.content:t,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName===`TEMPLATE`?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)N(this.t, __get$(this.n,t) ,e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(P)}},at=[],ot=[],st=[],ct=[],lt=Promise.resolve(),ut=!1,dt=new Set,ft=0,pt=new Set,ht=class{$destroy(){Me(this,1),this.$destroy=S}$on(e,t){if(!D(t))return S;let n= __get$(this.$$.callbacks,e) ||( __set$(this.$$.callbacks,e,[]) );return n.push(t),()=>{let e=n.indexOf(t);e!==-1&&n.splice(e,1)}}$set(e){this.$$set&&!k(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}},gt=[],(function(e){(function(e){e.Hidden=`hidden`,e.Invisible=`invisible`})(e.Classes||={})})(_t||={}),(function(e){(function(e){ __set$(e,e.Backspace=8,`Backspace`) , __set$(e,e.Delete=46,`Delete`) , __set$(e,e.DownArrow=40,`DownArrow`) , __set$(e,e.Enter=13,`Enter`) , __set$(e,e.Escape=27,`Escape`) , __set$(e,e.LeftArrow=37,`LeftArrow`) , __set$(e,e.RightArrow=39,`RightArrow`) , __set$(e,e.Spacebar=32,`Spacebar`) , __set$(e,e.Stop=137,`Stop`) , __set$(e,e.Tab=9,`Tab`) , __set$(e,e.UpArrow=38,`UpArrow`) })(e.KeyCodes||={})})(vt||={}),yt=(e,t)=>{let n= __get$(e,t) ;return n?typeof n==`function`?n():Promise.resolve(n):new Promise((e,n)=>{(typeof queueMicrotask==`function`?queueMicrotask:setTimeout)(n.bind(null,Error(`Unknown variable dynamic import: `+t)))})}}));function xt(e){return function(t){return e===t.type}}function St(e=Zy.DefaultRightClickModifierKey){return{beforeState:[{condition:xt(K.UserEvents.PointerdownLeft),handler:t}],name:Zy.Plugin.Name,requires:[`keys`]};function t(t,n){ let _hh$temp4=n,r=_hh$temp4.api,i=_hh$temp4.queue,a=_hh$temp4.run; return r.keys.isPressed(e)?(i.add(a,{...t,type:K.UserEvents.PointerdownRight}),!1):!0}}function Ct(e){let t=new Set(Array.isArray(e)?e:Object.values(e));return function(e){return t.has(e.type)}}function wt(){let e;return{destroy:t,match:[{condition:Ct([K.APIEvents.Load,K.OptionsEvents.Update,K.InstanceEvents.ModeChanged,K.InstanceEvents.RendererSet]),handler:n}],name:Qy.Plugin.Name};function t(){e?.removeAnalysisOverlay()}function n(t,n){ let _hh$temp5=n,r=_hh$temp5.options,i=_hh$temp5.renderer; !e&&i&&(e=i),r.overlayInAnalysisMode?e?.addAnalysisOverlay():e?.removeAnalysisOverlay()}}function Tt(e){let t,n={[rb.Arrow.Up]:`selectLineStart`,[rb.Arrow.NumUp]:`selectLineStart`,[rb.Arrow.Down]:`selectLineEnd`,[rb.Arrow.NumDown]:`selectLineEnd`,[rb.Arrow.Left]:`moveBackward`,[rb.Arrow.NumLeft]:`moveBackward`,[rb.Arrow.Right]:`moveForward`,[rb.Arrow.NumRight]:`moveForward`};return{api:()=>({setKeys:i,resetKeys:a}),create:r,destroy:s,name:rb.Plugin.Name};function r(n){t=n,i(e)}function i(e){let n=o(e);t.api.keys.setOverrides(n)}function a(){let e=o();t.api.keys.setOverrides(e)}function o(e={}){return Object.entries(n).map( _hh$temp6=>{var _hh$temp7=__arrayFrom$(_hh$temp6),t=_hh$temp7[0],n=_hh$temp7[1];return{key:t,callback:r=>__get$(e,t)??__get$(r,n)};} )}function s(){t.api.keys.removeOverrides(Object.keys(n).map(e=>({key:e})))}}function Et( _hh$temp8 ){ var e=_hh$temp8.options,t=_hh$temp8.rawArrow;  let _hh$temp9=t,_hh$temp9$data=_hh$temp9.data,n=_hh$temp9$data.color,r=_hh$temp9$data.keyPressed,i=_hh$temp9$data.from,a=_hh$temp9$data.opacity,o=_hh$temp9$data.to,s=_hh$temp9.key,c=_hh$temp9.type; return{data:{color:Dt(r,e)??n??e.arrowColors.default,from:i,opacity:a??e.analysisHighlightOpacity,to:o},key:s,type:c}}function Dt(e,t){ let _hh$temp10=t,n=_hh$temp10.arrowColors; switch(e){case Ub.Alt:return n.alt;case Ub.Ctrl:return n.ctrl;case Ub.Shift:return n.shift;case Ub.None:return n.default;default:return}}function Ot(e){return function(t){var n;return xt(K.APIEvents.Mark)(t)&&(n=t.data).find?.call(n,t=>t.type===e)}}function kt(e){return function(t){return t.type===e}}function At(e){return function(t){var n;return xt(K.APIEvents.Unmark)(t)&&(n=t.data).find?.call(n,t=>t.type===e)}}function jt(e){ let _hh$temp11=e,t=_hh$temp11.api,n=_hh$temp11.options,r=_hh$temp11.renderer; if(!t.markings)return;let i=t.markings,a=(n.allowMarkings?i.getAllWhere({types:[ab]}):[]).map(e=>Et({rawArrow:e,options:n}));r?.addArrows(a,e)}function Mt(){return[{condition:Ot(ab),handler:t},{condition:At(ab),handler:n},{condition:xt(K.InstanceEvents.RendererSet),handler:e}];function e(e,t){jt(t)}function t(e,t){ let _hh$temp12=t,n=_hh$temp12.options,r=_hh$temp12.renderer,_hh$temp13=e,i=_hh$temp13.data,a=i.filter(kt(ab)).map(e=>Et({rawArrow:e,options:n})); r?.addArrows(a,t)}function n(e,t){ let _hh$temp14=t,n=_hh$temp14.options,r=_hh$temp14.renderer,_hh$temp15=e,i=_hh$temp15.data,a=i.filter(kt(ab)).map(e=>Et({rawArrow:e,options:n})); r?.removeArrows(a,t)}}function Nt(){return{match:Mt(),name:ib.Plugin.Name,create:jt,destroy:e};function e(e){ let _hh$temp16=e,t=_hh$temp16.api,n=_hh$temp16.renderer,r=_hh$temp16.options; if(!t.markings)return;let i=t.markings.getAllWhere({types:[ab]}).map(e=>Et({rawArrow:e,options:r}));n?.removeArrows(i,e)}}function Pt(e){let t= __get$(Xb,e) ;if(!t)return null; let _hh$temp17=__arrayFrom$(t),n=_hh$temp17[0],r=_hh$temp17[1],i=_hh$temp17[2],a=_hh$temp17[3],o=_hh$temp17[4]; return{darkSquareColor:n,lightSquareColor:r,path:i,extension:a,highlightColor:o}}function Ft(e){return e?.assetPaths?.basePath||`https://www.chess.com`}function It(e,t=150,n){return`${Ft(n)}/chess-themes/pieces/${e}/${t}`}function Lt(e){return{...e,board:{assets:{background:Gb.board},config:{lightSquareCoordinateHex:Kb.Board.DefaultDarkSquareColor,darkSquareCoordinateHex:Kb.Board.DefaultLightSquareColor,...e.board.config}},pieces:{assets:Wb},config:{perspective:qb.Perspective.TOP_DOWN}}}function Rt(e){e.options.themeAssets&&e.api.setOptions({themeAssets:Lt(e.options.themeAssets)})}function zt(){return[0,0,0,0,0,0,0,0,0,0].reduce(e=>e+`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`.charAt(Math.floor(Math.random()*62)),``)}function Bt(){return{allowMarkings:!0,disableUserMarkings:!1,analysisHighlightColors:{alt:Qb.HighlightColors.Blue,ctrl:Qb.HighlightColors.Orange,default:Qb.HighlightColors.Red,shift:Qb.HighlightColors.Green},analysisHighlightOpacity:.8,animationType:Qb.Animation.Types.Default,arrowColors:{alt:Qb.HighlightedArrowColors.Blue,ctrl:Qb.HighlightedArrowColors.Red,default:Qb.HighlightedArrowColors.Orange,shift:Qb.HighlightedArrowColors.Green},aspectRatio:1,autoClaimDraw:!0,autoPromote:!1,autoResize:!0,boardStyle:`green`,captureKeyStrokes:!0,checkBlinkingSquareColor:`#ff0000`,coordinates:Qb.CoordinatesPositions.Inside,darkMode:!1,diagramStyle:!0,enabled:!0,fadeSetup:0,flipped:!1,highlightColor:void 0,highlightLegalMoves:!0,highlightMoves:!0,highlightOpacity:.5,hoverSquareOutline:!0,id:zt(),moveListContextMenuEnabled:!0,moveListDisplayType:Qb.MoveListDisplayTypes.Text,moveMethod:Qb.MoveMethods.Drag,overlayInAnalysisMode:!1,pieceStyle:`neo`,playSounds:!0,premoveDelay:200,premoveHighlightColor:`#f42a32`,premoveHighlightOpacity:.5,rounded:!0,soundTheme:`default`,syncEffects:!0,threatSquareColor:`#ff0000`,threatSquareOpacity:.8,useSharedStyleTag:!1,disableRookCastling:!1,assetPaths:{basePath:`https://www.chess.com`,enPassant:`https://www.chess.com/article/view/how-to-capture-en-passant`,soundsTheme:`https://images.chesscomfiles.com/chess-themes/sounds/`}}}function Vt(e){var t;if(e.options.themeAssets){e.api.setOptions({themeAssets:Lt(e.options.themeAssets)});return}e.options.pieceStyle=Bt().pieceStyle,(t=e.renderer)==null||t.updatePieceBaseImage(e,!0)}function Ht(e){return Wt(e.themeAssets),e}function Ut(e){return Gt(e.themeAssets),e}function Wt(e){if(!e||e.config.perspective!==qb.Perspective.REAL_3D)return e;throw Error(`ThemeAssets: Expected 2D assets, received 3D assets`)}function Gt(e){if(!e||e.config.perspective===qb.Perspective.REAL_3D)return e;throw Error(`ThemeAssets: Expected 3D assets, received 2D assets`)}function Kt(e){return new Promise(function(t,n){let r=new Image;r.addEventListener(`load`,()=>t(e)),r.addEventListener(`error`,()=>n(Error(`Failed to load image: ${e}`))),e||n(Error(`Unknown url: ${e}`)),r.src=e})}function qt(e){return new Promise((t,n)=>{try{Wt(e)}catch{return t(!0)}Kt(e.board.assets.background).then(()=>t(!0)).catch(e=>{n(new Qb.StylesSetFailed(e.message))})})}function Jt(e,t){return e.themeAssets?Yt(e.themeAssets):Xt(t,e)}function Yt(e){return  new Promise((t,n)=>{try{Wt(e);}catch{return t(!0);}let r=[];if(Object.keys(e.pieces.assets).forEach(t=>{__get$(e.pieces.assets,t)!==__get$(Wb,t)&&r.push(__get$(e.pieces.assets,t));}),r.length===0)return t(!0);let i=r.map(e=>Kt(e));Promise.all(i).then(()=>t(!0)).catch(e=>{n(new Qb.StylesSetFailed(e.message));});}) }function Xt(e,t){return new Promise(function(n,r){if(!e){r(new Qb.StylesSetFailed(`Piece style not found`));return}let i=It(e.path,void 0,t),a=Yb.map(t=>`${i}/${t}.${e.format}`).map(e=>Kt(e));Promise.all(a).then(()=>n(!0)).catch(e=>{r(new Qb.StylesSetFailed(e.message))})})}function Zt(e,t){return{data:t||{},type:e}}function Qt(){let e,t,n;return{match:[{condition:Ct([K.InstanceEvents.RendererSet,K.OptionsEvents.Update,K.InstanceEvents.WebGLAssetsInitialized]),handler:r}],create:( _hh$temp18 )=>{ var r=_hh$temp18.options; e=r.boardStyle,t=r.pieceStyle,n=r.themeAssets},name:ob.Plugin.Name};function r(r,i){ let _hh$temp19=i,a=_hh$temp19.options,o=_hh$temp19.renderer; if(!o||!o.areAssetsLoaded())return;let s=a.pieceStyle!==t||!U(n?.pieces,a.themeAssets?.pieces),c=a.boardStyle!==e||!U(n?.board,a.themeAssets?.board),l=()=>{c&&o.updateBoardImage(i)};i.options.themeAssets?qt(i.options.themeAssets).then(l).catch(e=>{e instanceof Qb.StylesSetFailed?($t(i,e),Rt(i)):c&&l()}):l();let u=()=>{s&&o.updatePieceBaseImage(i)};if(o.name===`webgl-3d`||!o.getPieceStyles)u();else{let e=o.getPieceStyles();Jt(i.options, __get$(e,i.options.pieceStyle) ).then(u).catch(e=>{e instanceof Qb.StylesSetFailed?($t(i,e),Vt(i)):s&&u()})}e=a.boardStyle,t=a.pieceStyle,n=a.themeAssets}}function $t(e,t){e.api.emit(K.InstanceEvents.StylesSetFailed,Zt(K.InstanceEvents.StylesSetFailed,{message:`Problem updating styles. Will fallback to default.`,error:t}))}function en(){return{match:[{condition:xt(K.APIEvents.BlinkHighlight),handler:e}],name:sb.Plugin.Name};function e(e,t){ let _hh$temp20=t,n=_hh$temp20.renderer; n?.blinkHighlights(e.data,t)}}function tn(){return{create:e,match:[{condition:xt(K.OptionsEvents.Update),handler:t}],name:$b.Plugin.Name};function e(e){e.el.classList.toggle(ex.Disabled,!e.options.enabled)}function t(e,t){ let _hh$temp21=e,n=_hh$temp21.data,_hh$temp22=t,r=_hh$temp22.el,i=_hh$temp22.renderer; `enabled`in n&&(r.classList.toggle(ex.Disabled,!n.enabled),i?.setBoardEnabled(n.enabled))}}function nn(){return{match:[{condition:Ct([K.UIEvents.Resize,K.InstanceEvents.RendererSet]),handler:e}],name:lb.Plugin.Name};function e(e,t){ let _hh$temp23=t,n=_hh$temp23.renderer; n?.resize(t)}}function rn(){return{chosenPiece:``,didChangePieces:!1,mouseCoords:[],moveHoldTimes:[],tentativeMouseCoords:{x:0,y:0}}}function an(){return{data:rn(),nextState:`idle`}}function on(e){let t={},n=e.mouseCoords.length/2;return e.mouseCoords.some(e=>{if(!e)return!1;let r=`${e.x}-${e.y}`;return  __get$(t,r) ===void 0? __set$(t,r,0) : __set$(t,r,__get$(t,r)+1) , __get$(t,r) >=n},{})}function sn( _hh$temp24 ){ var e=_hh$temp24.machine; return{get:t};function t(){let t=e.getData();return{didChangePieces:t.didChangePieces,didUseCheatMouse:on(t),moveHoldTimes:t.moveHoldTimes}}}function cn(){return{api:()=>sn({machine:rx}),match:[{condition:Ct([K.UserEvents.PointerdownLeft,K.UserEvents.Pointerup]),handler:e},{condition:xt(K.APIEvents.Load),handler:t},{condition:xt(K.APIEvents.Move),handler:n}],name:$y.Plugin.Name};function e(e,t){ let _hh$temp25=t,n=_hh$temp25.mode,r=_hh$temp25.state; if(r.get(K.State.MachineState)===ix.States.PromotionAreaShowing||!e.data||!n.isAllowedToMove())return;let i=r.get(K.State.SelectedPiece)||r.get(K.State.DraggingPiece);if(i&&i!==rx.getData().chosenPiece){if(!e.data.coordsInsideSquare){t.run({type:$y.Events.CheatDetectionError,data:{corePiece:i,cheatDetectionPiece:rx.getData().chosenPiece,eventData:e.data,variant:t.api.getVariant()}});return}rx.transition(`choosePiece`,{chosenPiece:i,moveHoldTimeStart:Date.now(),tentativeMouseCoords:e.data.coordsInsideSquare})}}function t(){rx.transition(`load`)}function n(){rx.transition(`move`)}}function ln(){let e,t=!1;return{match:[{condition:Ct([K.InstanceEvents.RendererSet,K.OptionsEvents.Update]),handler:n}],name:mb.Plugin.Name};function n(n,r){ let _hh$temp26=r,i=_hh$temp26.options,a=_hh$temp26.renderer; a&&((i.coordinates!==e||i.flipped!==t||n.type===K.InstanceEvents.RendererSet)&&a.setCoordinates({flipped:i.flipped,position:i.coordinates},r),e=i.coordinates,t=i.flipped)}}function un(e){return{getDefaultStarColor:t};function t(){return e}}function dn(e){return function(){return un(e)}}function fn(e,t,n){let r={...e};return  __set$(r.data,t,n) ,r}function pn(e){return e}function mn(e){return e*(2-e)}function hn(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}function gn(e){return--e*e*e+1}function _n(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}function vn(e){return Math.sin(e*Math.PI/2)}function yn(e){return Math.sqrt(1- --e*e)}function bn(e){return e===0?0:e===1?1:2**(-10*e)*Math.sin((e-.1)*5*Math.PI)+1}function xn(e){ let _hh$temp27=e,t=_hh$temp27.animatedProps,n=_hh$temp27.animatedPropsKeyframes,r=_hh$temp27.frameInfo,i=_hh$temp27.isTargetHTMLElement,a=_hh$temp27.params,_hh$temp28=a,o=_hh$temp28.keyframes,s=_hh$temp28.target,_hh$temp29=r,c=_hh$temp29.elapsedPercentage,l=a.easing||pn; if(!o)return;let u,d,f,p,m;Object.keys(t).forEach(e=>{for(let t=1;t< __get$(n,e) .length;t++)if(f= __get$(__get$(n,e),t-1) ,p= __get$(__get$(n,e),t) ,c>=f&&c<=p){u= __get$(__get$(o,f),e) ,d= __get$(__get$(o,p),e) ;break}m=(c-f)/(p-f),m=l(m), __set$(t,e,u+(d-u)*m) ,s&&!i&&( __set$(s,e,__get$(t,e)) )})}function Sn(e){ let _hh$temp30=e,t=_hh$temp30.data,n=_hh$temp30.keyframes,r=_hh$temp30.repeat,i=_hh$temp30.target,a=_hh$temp30.onEnd,o=Cn(n),s={animatedProps:o,animatedPropsKeyframes:wn(o,n),data:{...t},endCallbacks:[],ended:!1,endTime:0,forcedEnd:!1,frameInfo:{deltaTime:0,elapsedInterval:0,elapsedPercentage:0},isTargetHTMLElement:i instanceof HTMLElement,onEnd:e=>s.endCallbacks.push(e),params:e,repeatCount:r||1,started:!1,startTime:0,keptAlive:!1}; return a&&s.endCallbacks.push(a),s}function Cn(e){if(!e)return{};if(!e[0])throw Error("The animation keyframes must contain values at `0` percentage.");return{...e[0]}}function wn(e,t){if(!t)return{};let n=Object.keys(e),r={};return n.forEach(e=> __set$(r,e,[]) ),Object.keys(t).sort((e,t)=>parseInt(e,10)-parseInt(t,10)).forEach(e=>{n.forEach(n=>{ __get$(__get$(t,e),n) !==void 0&& __get$(r,n) .push(parseInt(e,10))})}),r}function Tn(e=!1){let t=[],n=0,r=0;return{end:a,endAll:o,play:u,playingAnimationsCount:()=>t.length,update:m};function i(a){let o=(a-r)*.001;t.forEach(e=>{if(e.startTime>a)return;let t=e.frameInfo;t.deltaTime=o,!(!e.started&&!c(e,a))&&(e.endTime&&(t.elapsedInterval=(a-e.startTime)/(e.endTime-e.startTime),t.elapsedInterval>1&&(t.elapsedInterval=1),t.elapsedPercentage=Math.round(t.elapsedInterval*100)),l(e),e.endTime&&e.endTime<=a&&s(e))}),r=a,t.length&&!e&&(n=requestAnimationFrame(i))}function a(e){e.ended||t.indexOf(e)<0||(e.frameInfo.elapsedInterval=1,e.frameInfo.elapsedPercentage=100,l(e),s(e,!0))}function o(){[...t].forEach(a)}function s(e,t=!1){ let _hh$temp31=e.params,n=_hh$temp31.duration,r=_hh$temp31.keepAlive,i=_hh$temp31.repeatDelay; if(e.repeatCount--,e.forcedEnd=t,!t&&e.repeatCount>0&&n&&n!==1/0){e.startTime=e.endTime+(i||0),e.endTime=e.startTime+n;return}if(!t&&r){e.keptAlive=!0;return}e.ended=!0,e.endCallbacks.forEach(t=>t(e)),d(e)}function c(e,t){ let _hh$temp32=e.params,n=_hh$temp32.duration,r=_hh$temp32.delay,i=_hh$temp32.onStart; return e.startTime||(e.startTime=t+(r||0),n&&n!==1/0&&(e.endTime=e.startTime+n)),e.startTime>t?!1:(e.started=!0,i?.(e),!0)}function l(e){ let _hh$temp33=e.params,t=_hh$temp33.onUpdate; xn(e),t?.(e)}function u(r){let i=Sn(r);return t.push(i),!n&&!e&&f(),i}function d(n){let r=t.indexOf(n);r>=0&&t.splice(r,1),!t.length&&!e&&p()}function f(){r=performance.now(),n=requestAnimationFrame(i)}function p(){n&&cancelAnimationFrame(n),n=0}function m(e){i(e)}}function En(e={}){let t=e;function n(e){if( __get$(t,e) ===void 0)throw Error(`Requested object at key ${e} is undefined.`);return  __get$(t,e) }function r(){return t}function i(e,n){ __set$(t,e,n) }function a(){return Object.keys(t)}function o(e){return  __get$(t,e) !==void 0}function s(e){delete t[e]}return{deleteItem:s,get:n,getCollection:r,isDefined:o,keys:a,set:i}}function Dn(e,t){return e.split(` `).filter(e=>!e.startsWith(t)).join(` `).trim()}function On(e){return{file:e.toLowerCase().charCodeAt(0)-96,rank:Number(e.charAt(1))}}function kn( _hh$temp34 ){ var e=_hh$temp34.square,t=_hh$temp34.el; let n=On(e);n&&(t.className=Dn(t.className,`square-`),t.classList.add(`square-${n.file}${n.rank}`),t.style.transform=``)}function An(e,t){return e?(Object.entries(t).forEach(( _hh$temp35 )=>{ var _hh$temp36=__arrayFrom$(_hh$temp35),t=_hh$temp36[0],n=_hh$temp36[1]; let r=`${t.charAt(0).toUpperCase()}${t.slice(1)}`;n===void 0?delete e.dataset[`test${r}`]: __set$(e.dataset,`test${r}`,n) }),!0):!1}function jn(e){if(!e)return null;let t=e.position===_b.Positions.Below;return e.target===_b.Targets.Arrows?{insertBefore:t,type:ox.Arrows}:e.target===_b.Targets.Effects?{insertBefore:t,type:ox.Effects}:e.target===_b.Targets.Pieces?{insertBefore:!t,type:t?ox.Effects:ox.Pieces}:null}function Mn( _hh$temp37 ){ var e=_hh$temp37.board,t=_hh$temp37.el,n=_hh$temp37.options; let r=En(),i=En(),a=Tn(),o=En(),s=document.createComment(`/Custom Items`);return e.addToDom({el:s,insertAfter:!0,type:ox.Pieces}),{addCustomItems:c,removeCustomItems:d};function c(c){c.forEach(c=>{ let _hh$temp38=c,_hh$temp38$data=_hh$temp38.data,d=_hh$temp38$data.color,f=_hh$temp38$data.image,p=_hh$temp38$data.opacity,m=_hh$temp38$data.text,h=_hh$temp38$data.type,g=_hh$temp38$data.visualOrder,_=_hh$temp38$data.frame,v=_hh$temp38$data.removalClass,y=_hh$temp38$data.square; i.isDefined(y)&&u(y,v),o.isDefined(y)&&a.end(o.get(y));let b=document.createElement(`div`);if(b.classList.add(hb.Classes.Root),_){b.classList.add(`custom-item__frame`),_.imageAnimated&&b.classList.add(`custom-item__frame--animated`);let e=l(_);e&&b.appendChild(e)}else b.innerHTML= __get$(lx,h) ,S();kn({el:b,square:y}),n.test&&An(b,{[sx.Color]:d,[sx.Element]:cx.CustomItem,[sx.Opacity]:p,[sx.Square]:y,[sx.Type]:h});let x=jn(g);x?e.addToDom({el:b,...x}):t.insertBefore(b,s),r.set(y,b);function S(){let e=b.querySelector(`svg`);if(e){if(d&&(e.style.fill=d),p&&(e.style.opacity=String(p)),f){let t=e.querySelector(`image`);if(!t)return;if(t.setAttribute(`href`,f.url),f.percentOfSquare){ let _hh$temp39=e.viewBox.baseVal,n=_hh$temp39.width,r=n*f.percentOfSquare*.01,i=(n-r)/2;  __call$(Object,"assign",[t.style,{height:`${r}px`,width:`${r}px`,x:`${i}px`,y:`${i}px`}]) }}if(m){let t=e.querySelector(`text`);if(!t)return;t.innerHTML=m.value,m.color&&(t.style.fill=m.color)}}}})}function l(e){if(!e)return; let t=document.createElement(`div`),_hh$temp40=e,n=_hh$temp40.imageURL,r=_hh$temp40.imageAnimated,i=_hh$temp40.positionRatioX,a=_hh$temp40.positionRatioY,o=_hh$temp40.widthRatio,s=_hh$temp40.heightRatio,c=i/o,l=a/s,u=1/o,d=1/s,f=c/(u-1)*100,p=l/(d-1)*100,m=r?`auto 100%`:`${1/o*100}% ${1/s*100}%`; return t.style.backgroundImage=`url(${n})`,t.style.backgroundSize=m,t.style.backgroundPositionX=`${f}%`,t.style.backgroundPositionY=`${p}%`,t}function u(e,t=`captured`){let n=r.get(e);n&&n.classList.contains(t)&&(f(n,e),clearTimeout(i.get(e)),i.deleteItem(e))}function d(e){e.forEach(e=>{ let _hh$temp41=e,t=_hh$temp41.data,_hh$temp42=t,n=_hh$temp42.frame,_hh$temp42$removalClass=_hh$temp42.removalClass,a=_hh$temp42$removalClass===void 0?`captured`:_hh$temp42$removalClass,_hh$temp42$removalTimeout=_hh$temp42.removalTimeout,s=_hh$temp42$removalTimeout===void 0?250:_hh$temp42$removalTimeout,c=_hh$temp42.square,l=r.get(c); l&&(n?.imageAnimated?p({customItemElement:l,imageURL:n.imageURL,square:c,onAnimationEnd:()=>{o.isDefined(c)&&o.deleteItem(c),f(l,c)}}):(l.classList.add(a),i.set(c,window.setTimeout(()=>{i.isDefined(c)&&i.deleteItem(c),l&&f(l,c)},s))))})}function f(e,n){t.removeChild(e),r.deleteItem(n)}function p( _hh$temp43 ){ var e=_hh$temp43.customItemElement,t=_hh$temp43.imageURL,n=_hh$temp43.square,r=_hh$temp43.onAnimationEnd; let i=e.querySelector(`div`);if(!i){r();return}let s=new Image;s.src=t,s.onload=()=>{let t=e.clientHeight,c=Math.ceil(s.naturalWidth/s.naturalHeight),l=1/c,u=a.play({duration:c/24*1e3,data:{currentFrame:1},onUpdate:()=>{ let _hh$temp44=u,e=_hh$temp44.data,n=_hh$temp44.frameInfo; l*e.currentFrame<n.elapsedInterval&&(i.style.backgroundPositionX=`-${t*e.currentFrame}px`,e.currentFrame++)},onEnd:r});o.set(n,u)}}}function Nn(e){ let _hh$temp45=e,t=_hh$temp45.api,n=_hh$temp45.options,r=_hh$temp45.renderer,i=t.markings; r?.extendRenderer(Mn);let a=n.allowMarkings?i.getAllWhere({types:[gb]}):[];r?.addCustomItems(a,e)}function Pn(){return[{condition:Ot(gb),handler:e},{condition:At(gb),handler:t},{condition:xt(K.InstanceEvents.RendererSet),handler:(e,t)=>Nn(t)}];function e(e,t){ let _hh$temp46=t,n=_hh$temp46.api,r=_hh$temp46.renderer,i=__get$(n,`custom-items`),a=e.data.filter(kt(gb)).map(e=>e.data.color?e:fn(e,`color`,i.getDefaultStarColor())); r?.addCustomItems(a,t)}function t(e,t){ let _hh$temp47=t,n=_hh$temp47.api,r=_hh$temp47.queue,i=_hh$temp47.renderer,a=e.data.filter(kt(gb)); a.forEach(e=>{let t=e.data.removalSound;t&&r.add(n.playSound,t)}),i?.removeCustomItems(a,t)}}function Fn( _hh$temp48 ={}){ var _hh$temp48$defaultStarColor=_hh$temp48.defaultStarColor,e=_hh$temp48$defaultStarColor===void 0?ux.DefaultSquareColor:_hh$temp48$defaultStarColor; return{create:Nn,api:dn(e),match:Pn(),name:hb.Plugin.Name}}function In(){let e,t;return{create:n,name:yb.Plugin.Name};function n(e){ let _hh$temp49=e,_hh$temp49$api=_hh$temp49.api,t=_hh$temp49$api.logger; t.on(dx.Events.EntryAdded,r)}function r(n){n.code===void 0||n.code===K.LogCodes.State&&JSON.stringify(n.data)===e||n.code===K.LogCodes.Event&&n.data.type===K.UserEvents.Pointermove&&t===K.UserEvents.Pointermove||n.code===K.LogCodes.Event&&n.data.type===K.UIEvents.Resize&&t===K.UIEvents.Resize||(n.code===K.LogCodes.State&&(e=JSON.stringify(n.data)),n.code===K.LogCodes.Event&&(t=n.data.type),console.group(n.code),n.level===dx.Levels.Error?console.error(n.data):console.log(n.data),console.groupEnd())}}function Ln( _hh$temp50 ){ var _hh$temp50$className=_hh$temp50.className,e=_hh$temp50$className===void 0?``:_hh$temp50$className,_hh$temp50$path=_hh$temp50.path,t=_hh$temp50$path===void 0?``:_hh$temp50$path,_hh$temp50$size=_hh$temp50.size,n=_hh$temp50$size===void 0?`24`:_hh$temp50$size,_hh$temp50$viewBox=_hh$temp50.viewBox,r=_hh$temp50$viewBox===void 0?`0 0 18 19`:_hh$temp50$viewBox; return`
    <svg xmlns="http://www.w3.org/2000/svg" class="${e}" width="${n}" height="${n}" viewBox="${r}">
      ${t}
    </svg>
  `}function Rn(e){if(!e)return!1;let t=[`a`,`h`,`1`,`8`],n=!1;return t.forEach(t=>{e.includes(t)&&(n=!0)}),n}function zn( _hh$temp51 ){ var e=_hh$temp51.square,t=_hh$temp51.isFlipped,n=_hh$temp51.effectEl; let r=Bn(e,t);r.top&&n.classList.add(`tuck-top`),r.right&&n.classList.add(`tuck-right`)}function Bn(e,t){let n={top:t?`1`:`8`,right:t?`a`:`h`};return{top:e.includes(n.top),right:e.includes(n.right)}}function Vn(e,t,n){ let _hh$temp52=e,_hh$temp52$data=_hh$temp52.data,r=_hh$temp52$data.square,i=_hh$temp52$data.type,a=_hh$temp52$data.path,o=_hh$temp52$data.size,s=document.createElement(`div`); return s.classList.add(`effect`),s.innerHTML=Ln({path:a&&i===`Custom`?a: __get$(Yx,i) ,size:o??`100%`}),kn({el:s,square:r}),n.test&&An(s,{[sx.Element]:cx.Effect,[sx.Square]:r,[sx.Type]:i}),Rn(r)&&zn({square:r,isFlipped:t.el.classList.contains(`flipped`),effectEl:s}),s}function Hn(e,t,n){ let _hh$temp53=e,_hh$temp53$data=_hh$temp53.data,r=_hh$temp53$data.square,i=_hh$temp53$data.type,a=_hh$temp53$data.path,o=On(r),s=document.createElement(`div`); s.classList.add(`animated-effect`,i.toLocaleLowerCase()),s.classList.add(`square-${o.file}${o.rank}`);let c=document.createElement(`div`);c.classList.add(`square`,i.toLocaleLowerCase());let l=document.createElement(`div`);l.innerText= __get$(nS,i) ,l.classList.add(`text`);let u=document.createElement(`div`);u.innerHTML=Ln({className:`icon slide`,path:a&&i===`Custom`?a: __get$(tS,i) ,size:`70%`});let d=document.createElement(`div`);return d.classList.add(`icon-background`,i.toLocaleLowerCase()),s.appendChild(c),s.appendChild(l),s.appendChild(u),s.appendChild(d),n.test&&An(s,{[sx.Element]:cx.Effect,[sx.Square]:r,[sx.Type]:i,[sx.Animated]:!0}),s}function Un( _hh$temp54 ){ var e=_hh$temp54.board,t=_hh$temp54.el,n=_hh$temp54.options; let r=document.createComment(`/Effects`);e.addToDom({el:r,insertAfter:!0,type:ox.HoverSquare});let i=new Map;return{addEffects:a,getEffectElements:s,removeEffects:o};function a(a){a.forEach(a=>{let o=i.get(a.key);o&&e.el.removeChild(o);let s=(a.data.animated?Hn:Vn)(a,e,n);t.insertBefore(s,r),i.set(a.key,s)})}function o(t){t.forEach(t=>{ let _hh$temp55=t,n=_hh$temp55.key,r=i.get(n); r&&(e.el.removeChild(r),i.delete(n))})}function s(){return i}}function Wn(e){ let _hh$temp56=e,t=_hh$temp56.api,n=_hh$temp56.options,r=_hh$temp56.renderer; if(r?.extendRenderer(Un),!t.markings)return;let i=t.markings,a=n.allowMarkings?i.getAllWhere({types:[Sb]}):[];r?.addEffects(a,e)}function Gn(){return[{condition:Ot(Sb),handler:t},{condition:At(Sb),handler:n},{condition:xt(K.InstanceEvents.RendererSet),handler:e}];function e(e,t){Wn(t)}function t(e,t){ let _hh$temp57=t,n=_hh$temp57.renderer,r=e.data.filter(kt(Sb)); n?.addEffects(r,t)}function n(e,t){ let _hh$temp58=t,n=_hh$temp58.renderer,r=e.data.filter(kt(Sb)); n?.removeEffects(r,t)}}function Kn(){return{create:Wn,match:Gn(),name:xb.Plugin.Name,destroy:e};function e(e){ let _hh$temp59=e,t=_hh$temp59.api,n=_hh$temp59.renderer; if(!t.markings)return;let r=t.markings.getAllWhere({types:[Sb]});n?.removeEffects(r,e)}}function qn(){return{match:[{condition:Ct([K.InstanceEvents.RendererSet,K.APIEvents.Load]),handler:e}],name:wb.Plugin.Name};function e(e,t){var n;(n=t?.renderer)==null||n.fadeSetup(t)}}function Jn(e=rS.FlipBoardModifierKey){let t;return{match:[{condition:Ct([K.InstanceEvents.Create,K.InstanceEvents.RendererSet,K.OptionsEvents.Update]),handler:r},{condition:xt(iS.Events.Keydown),handler:n}],name:rS.Plugin.Name};function n(t,n){ let _hh$temp60=n,r=_hh$temp60.api,i=_hh$temp60.options,a=_hh$temp60.queue; t.data!==e||i.isSiblingBoard||a.add(r.setOptions,{flipped:!i.flipped})}function r(e,n){ let _hh$temp61=n,r=_hh$temp61.options,i=_hh$temp61.renderer,a=_hh$temp61.state; if(i){if(r.flipped!==t){i.flipBoard(r.flipped,n);let e=a.get(K.State.PromotionMove);e&&i.openPromotionWindow(e,n)}t=r.flipped}}}function Yn(e){return Object.prototype.toString.call(e)===`[object Object]`}function Xn(e,t, _hh$temp62 ={}){ var n=_hh$temp62.isDuplicateWhen; let r=new Set(e);return t.forEach(t=>{if(Yn(t)&&n){let i=e.find(e=>n(e,t));i&&r.delete(i);return}r.delete(t)}),[...r]}function Zn(e,t){return e.key===t.key&&e.data.color===t.data.color}function Qn(e){let t=new Set(e),n=new Map;return{...t,addModule:i,getModules:o,removeModule:s,getAll:a,update:c,clearState:r};function r(){n.clear()}function i(e){return t.add(e)}function a(){return Array.from(n.values())}function o(){return Array.from(t)}function s(e){return t.delete(e)}function c(...e){let t=a();r();let i=Array.from(o().reduce((t,n)=>(n(...e).forEach(e=>{t.set(e.data.square,e)}),t),new Map).values());return i.forEach(e=>n.set(e.data.square,e)),{toAdd:Xn(i,t,{isDuplicateWhen:Zn}),toRemove:Xn(t,i,{isDuplicateWhen:Zn})}}}function $n(e){return function(){return Qn(e)}}function er(e){ let _hh$temp63=e,t=_hh$temp63.api,n=_hh$temp63.renderer; if(!t.markings||!t.highlights)return;let r=t.highlights;r.clearState(); let _hh$temp64=r.update({data:{},type:`DummyHighlightInitEventName`},e),i=_hh$temp64.toAdd; n?.addHighlights(i,e)}function tr(e){let t=new Set(Array.isArray(e)?e:Object.values(e));return function(e){return!t.has(e.type)}}function nr(){return[{condition:tr([K.UserEvents.Pointermove,K.InstanceEvents.RendererSet,K.APIEvents.NodeUpdated]),handler:t},{condition:xt(K.InstanceEvents.RendererSet),handler:e}];function e(e,t){er(t)}function t(e,t){ let _hh$temp65=t,n=_hh$temp65.api,r=_hh$temp65.renderer; if(!r)return; let _hh$temp66=n.highlights.update(e,t),i=_hh$temp66.toAdd,a=_hh$temp66.toRemove; r.removeHighlights(a,t),r.addHighlights(i,t)}}function rr(e){return{api:$n(e),destroy:t,create:er,match:nr(),name:tb.Plugin.Name};function t(e){ let _hh$temp67=e,t=_hh$temp67.api,n=_hh$temp67.renderer,r=t.highlights; n?.removeHighlights(r.getAll(),e)}}function ir(...e){return function(t,n){return e.every(e=>e(t,n))}}function ar(e){return function(t,n){var r;return!! __get$((r=n.api)?.getOptions?.call(r),e) }}function or(){let e=c({data:{square:void 0},initialState:`hidden`,states:{hidden:{dragPiece:e=>({data:{square:e},nextState:`showing`})},showing:{dragPiece:e=>({data:{square:e},nextState:`showing`}),dropPiece:()=>({nextState:`hidden`}),setOptionToFalse:()=>({nextState:`hidden`})}}});return{match:[{condition:ir(ar(Qb.BooleanOptions.HoverSquareOutline),tr([K.APIEvents.ClearMarkings,zb.Events.Tick])),handler:t}],name:Db.Plugin.Name};function t(t,n){ let _hh$temp68=n,r=_hh$temp68.options,i=_hh$temp68.renderer,a=_hh$temp68.state,o=(a.get(K.State.HideHoverSquare)!==!0&&a.get(K.State.MachineState)!==ix.States.PromotionAreaShowing)&&a.get(K.State.DraggingPiece),s=t.data&&(t.data.square||t.data.squareInsideBoard||e.getData().square||o),c=!1; c=r.highlightMoves?o?e.transition(`dragPiece`,s):e.transition(`dropPiece`):e.transition(`setOptionToFalse`),!(!c||!i)&&(e.getCurrentState()===`hidden`?i.hideHoverSquare(n):i.showHoverSquare(e.getData().square,n))}}function sr(e){return Array.isArray(e)?e:[e]}function cr(e){return e.reduce((e,t,n,r)=>{if(n%2==0)return e;let i= __get$(r,n-1) ;return  __set$(e,i,t) ,e},{})}function lr(e){ let _hh$temp69=e,t=_hh$temp69.color,_hh$temp69$data=_hh$temp69.data,n=_hh$temp69$data===void 0?[]:_hh$temp69$data,r=_hh$temp69.type,i=cr(n); Object.keys(i).forEach(e=>{ __set$(i,e,decodeURIComponent(__get$(i,e))) }); let _hh$temp70=i,a=_hh$temp70.persistent,o=__rest$Object(_hh$temp70,["persistent"]),s={key:eee(e.key,e.type),node:!0,data:{...o,keyPressed:o.keyPressed??ur(t)},type:r}; return a!==void 0&&(s.persistent=a===`true`),s}function eee(e,t){return`${t}|${e}`}function ur(e){switch(e){case`a`:return Ub.Alt;case`d`:return Ub.None;case`s`:return Ub.Shift;case`l`:return Ub.Ctrl;default:return}}function dr(e,t){let n=[],r=t??e.markings();return Object.values(r).forEach(e=>{Object.values(e).forEach(e=>{n.push(lr(e))})}),n}function fr(e,t,n){ let _hh$temp71=t,r=_hh$temp71.key,i=e.ids(),a=t.node&&typeof t.node==`object`,_hh$temp72=t.node,o=_hh$temp72.move,s=_hh$temp72.line; a&&e.selectPosition(o,s);let c=dr(e,n);return a&&e.selectPosition(i.move,i.line),!!c.find(e=>e.key===r)}function pr(e,...t){let n={...e};return t.forEach(e=>{delete n[e]}),n}function mr(e){return Object.entries(e).reduce( (e,_hh$temp73)=>{var _hh$temp74=__arrayFrom$(_hh$temp73),t=_hh$temp74[0],n=_hh$temp74[1];return n===void 0||e.push(t,n.toString()),e;} ,[])}function hr(e){ let _hh$temp75=e,t=_hh$temp75.data,n=_hh$temp75.persistent,r=n===void 0?t:{...t,persistent:n},i=_r(t.keyPressed),a=i===aS.Custom?r:pr(r,`color`); return Object.keys(a).forEach(e=>{ __set$(a,e,encodeURIComponent(__get$(a,e))) }),{color:i===aS.Custom?void 0:i,data:mr(a),key:gr(e),type:e.type}}function gr(e){ let _hh$temp76=e,_hh$temp76$data=_hh$temp76.data,t=_hh$temp76$data.from,n=_hh$temp76$data.square,r=_hh$temp76$data.to,i=_hh$temp76.key; return n||(t&&r?`${t}${r}`:i)}function _r(e){switch(e){case Ub.Alt:return aS.Alt;case Ub.None:return aS.Default;case Ub.Shift:return aS.Shift;case Ub.Ctrl:return aS.Ctrl;default:return aS.Custom}}function vr(e,t,n){let r=hr(t),i=e.ids(),a=t.node&&typeof t.node==`object`;if(a){ let _hh$temp77=t.node,n=_hh$temp77.move,r=_hh$temp77.line; e.selectPosition(n,r)}e.mark(r,!0), __get$(oS.Effects,t.data.type) &&n.updateNode(a?t.node:i,{annotation:``,isSync:!0}),a&&e.selectPosition(i.move,i.line)}function yr(e){return e.kingTo??e.to}function br(e,t,n){let r=hr(t),i=e.ids(),a=t.node&&typeof t.node==`object`;if(a){ let _hh$temp78=t.node,n=_hh$temp78.move,r=_hh$temp78.line; e.selectPosition(n,r)}e.mark(r);let o= __get$(oS.Effects,t.data.type) ,s=n.getSelectedNode(),c=s&&yr(s)===t.data.square,l=s?.annotation===o;o&&c&&!l&&n.updateNode(a?t.node:i,{annotation:o,isSync:!0}),a&&e.selectPosition(i.move,i.line)}function xr(...e){if(e.length===1)return e[0];let t=new Set;for(let n of e)for(let r of n)e.every(e=>e.has(r))&&t.add(r);return t}function Sr(...e){let t=new Set;for(let n of e)for(let e of n)t.add(e);return t}function Cr( _hh$temp79 ={primaryKey:`id`}){ var _hh$temp79$batchCallbacks=_hh$temp79.batchCallbacks,e=_hh$temp79$batchCallbacks===void 0?!0:_hh$temp79$batchCallbacks,t=_hh$temp79.onEntryAdded,n=_hh$temp79.onEntryRemoved,_hh$temp79$primaryKey=_hh$temp79.primaryKey,r=_hh$temp79$primaryKey===void 0?`id`:_hh$temp79$primaryKey;  let i=new Map(),a=new Map(),_hh$temp80=h({added:t,removed:n}),o=_hh$temp80.flush,s=_hh$temp80.isBatching,c=_hh$temp80.stack,l=_hh$temp80.startBatching; function u(n){return e&&s()?c(`added`)(n):t?.(n)}function d(t){return e&&s()?c(`removed`)(t):n?.(t)}return{addOne:m,addMany:f(p),batch:f,getAll:g,getManyByTags:b,getMatchingKeys:x,getMap:v,getMany:_,getOne:y,removeAll:f(S),removeMany:f(C),removeManyByTags:f(w),removeOne:T};function f(e){return(...t)=>{l();let n=e(...t);return o(),n}}function p(e,t){return e.map((e,n)=>m(e, __get$(t,n,true) ))}function m(e,t){let n= __get$(e,r) ,o=i.get(n);return o&&(i.delete(n),d?.(o)),t?.forEach(e=>{var t;a.get(e)||a.set(e,new Set),(t=a.get(e))==null||t.add(n)}),i.set(n,e),u?.(e),n}function h(e){let t=!1,n=new Map;return Object.entries(e).forEach(( _hh$temp81 )=>{ var _hh$temp82=__arrayFrom$(_hh$temp81),e=_hh$temp82[0],t=_hh$temp82[1]; t&&n.set(e,{callback:t,entries:new Set})}),{flush:a,isBatching(){return t},stack:r,startBatching:i};function r(e){return function(t){var r;(r=n.get(e))==null||r.entries.add(t)}}function i(){t=!0}function a(){n.forEach(e=>{var n;let r=Array.from(e.entries.values());r.length&&((n=e.callback)==null||n.call(e,r),e.entries.clear()),t=!1})}}function g(){return Array.from(i.values())}function _(e){return e.map(e=>i.get(e)).filter(e=>e!==void 0)}function v(){return i}function y(e){return i.get(e)}function b(e,t={}){return x(e,t).map(e=>i.get(e)).filter(e=>e!==void 0)}function x(e,t={}){ let _hh$temp83=t,n=_hh$temp83.matchAll,r=e.map(e=>a.get(e)).filter(e=>e!==void 0),i; return i=n?Array.from(xr(...r)):Array.from(Sr(...r)),i}function S(){for(let _hh$temp84 of i.entries()) {let _hh$temp85=__arrayFrom$(_hh$temp84),e=_hh$temp85[0],t=_hh$temp85[1];(d?.(t));} return i.clear(),a.clear(),!0}function C(e){return e.every(T)}function w(e,t={}){return x(e,t).every(e=>T(e))}function T(e){let t=i.get(e);t&&(i.delete(e),d?.(t));let n=a.entries();for(let _hh$temp86 of n) {let _hh$temp87=__arrayFrom$(_hh$temp86),t=_hh$temp87[0],r=_hh$temp87[1];r.has(e)&&r.delete(e),a.get(t)?.size===0&&a.delete(t);} return!0}}function wr(e){ let _hh$temp88=e,t=_hh$temp88.node,n=_hh$temp88.persistent,_hh$temp88$tags=_hh$temp88.tags,r=_hh$temp88$tags===void 0?[]:_hh$temp88$tags,i=_hh$temp88.type; return[t?`node`:`board`,n?`persistent`:`temporary`,...r,i]}function Tr(e){ let _hh$temp89=e.data,t=_hh$temp89.from,n=_hh$temp89.square,r=_hh$temp89.to,i=n?[n]:[t,r]; for(let e of i)if(!Er(e))return!1;return!0}function Er(e){return/^([a-h][1-8])$/.test(e)}function Dr(e,t){let n={a:Object.getOwnPropertyNames(e),b:Object.getOwnPropertyNames(t)};return n.a.length===n.b.length?n.a.every(n=> __get$(e,n) === __get$(t,n) ):!1}function Or( _hh$temp90 ={}){ var _hh$temp90$generateKey=_hh$temp90.generateKey,e=_hh$temp90$generateKey===void 0?kr:_hh$temp90$generateKey,t=_hh$temp90.context,n=_hh$temp90.onMarkingAdded,r=_hh$temp90.onMarkingRemoved; let i=Cr({batchCallbacks:!0,onEntryAdded:n,onEntryRemoved:r,primaryKey:`key`}),a=Cr({batchCallbacks:!0,onEntryAdded:n,onEntryRemoved:r,primaryKey:`id`});return{addOne:c,addMany:o,getMany:i.getMany,getAll:i.getAll,getAllWhere:d,getOne:i.getOne,removeAll:i.removeAll,removeAllWhere:p,removeOne:u,removeMany:l,toggleMany:m,toggleOne:h,factory:{buildStandardAnalysisHighlight:_,buildStandardArrow:v}};function o(e){return s(e)}function s(e){return e.map(c)}function c(e){if(!Tr(e))return null;let n=wr(e);if(e.node&&typeof e.node==`object`){ let r=(t?.api?.getSelectedNode()),i=r?.ids?.move===e.node.move&&r?.ids?.line===e.node.line,o=g(e),_hh$temp91=o.node,s=_hh$temp91.move,c=_hh$temp91.line; if(o.id=`${o.key}-${s}|${c}`,a.addOne(o,n),i)e.node=!0;else return o.key}return i.addOne(g(e),n)}function l(e){return e.every(u)}function u(e,t){if(typeof e!=`string`&&e.node&&typeof e.node==`object`)return u(e.key,e.node),!1;if(t&&typeof t==`object`){ let _hh$temp92=t,n=_hh$temp92.move,r=_hh$temp92.line; a.removeOne(`${e}-${n}|${r}`)}return typeof e==`string`?i.removeOne(e):!1}function d(e={}){return f(e).map(e=>i.getMap().get(e)).filter(Boolean)}function f(e={}){ let _hh$temp93=e,t=_hh$temp93.node,n=_hh$temp93.persistent,r=_hh$temp93.tags,a=_hh$temp93.types,o; t!==void 0&&(o=t?`node`:`board`);let s;n!==void 0&&(s=n?`persistent`:`temporary`);let c=[o,s,r,a].filter(e=>e!==void 0);if(!c.length)return Array.from(i.getMap().keys());let l=c.map(sr).map(e=>new Set(i.getMatchingKeys(e)));return Array.from(xr(...l))}function p(e={}){return e.types?.length===0&&(e.types=void 0),i.removeMany(f(e))}function m(e){return e.map(h)}function h(e){let t=g(e),n=i.getOne(t.key);return n&&Dr(n.data,t.data)?i.removeOne(t.key):c(t)}function g(t){return{...t,key:t.key||e(t)}}function _(e,n=Ub.None){return{data:{keyPressed:n,opacity:(t?.api.getOptions?t?.api.getOptions():Bt()).analysisHighlightOpacity,square:e},node:!0,persistent:!1,type:nb}}function v(e,n,r=Ub.None){return{data:{keyPressed:r,from:e,opacity:(t?.api.getOptions?t?.api.getOptions():Bt()).analysisHighlightOpacity,to:n},node:!0,persistent:!1,type:ab}}}function kr(e){ let _hh$temp94=e,_hh$temp94$data=_hh$temp94.data,t=_hh$temp94$data.from,n=_hh$temp94$data.square,r=_hh$temp94$data.to,i=_hh$temp94.type; if(!n&&!(t&&r))throw Error(`Markings that do not have a "square" property must provide a "from" and "to"`);return`${i}|${n||`${t}${r}`}`}function Ar(e){if(!e)return;let t=new Map;return Object.keys(oS.Effects).forEach(e=>{t.set( __get$(oS.Effects,e) ,e)}),t.get(e)}function jr(e,t){ let _hh$temp95=e,n=_hh$temp95.data,_hh$temp96=t.api.getContext(),r=_hh$temp96.game; (Array.isArray(n)?n:[n]).forEach(e=>{e.node&&!fr(r,e)&&br(r,e,t.api)})}function Mr(e,t){ let _hh$temp97=e,n=_hh$temp97.data,_hh$temp98=t.api.getContext(),r=_hh$temp98.game; (Array.isArray(n)?n:[n]).forEach(e=>{e.node&&fr(r,e)&&vr(r,e,t.api)})}function Nr(e,t){ let _hh$temp99=t,n=_hh$temp99.api,r=_hh$temp99.queue; e.data.plyDiff===0&&e.data.lineDiff===0||r.add(()=>Ir(n))}function Pr(e,t){ let _hh$temp100=t,n=_hh$temp100.api,r=n.getRawLines(),i=[]; Ir(n),r.forEach(e=>{e.forEach(e=>{let t=Ar(e.annotation);t&&i.push({data:{square:yr(e),type:t},type:Sb,node:e.ids,persistent:!0})})}),n.markings.addMany(i)}function Fr(e,t){ let _hh$temp101=t,n=_hh$temp101.api,_hh$temp102=e.data,r=_hh$temp102.ids,i=_hh$temp102.changes; if(!(`annotation`in i)||i.isSync)return;let a=n.getPosition(r.move,r.line);if(!(`to`in a))return;let o=Ar(i.annotation),s=n.getNodeByIds(r);if(!o&&s?.commands){let e=((s.commands.c_effect?.split(`,`))?.find(e=>e.includes(yr(s))))?.split(`;`)||[],t= __get$(e,e.length-1) ; __get$(oS.Effects,t) &&n.markings.addOne({data:e,key:yr(s),type:Sb,persistent:!0})}if(!o){let e=kr({data:{square:a.to},type:Sb});n.markings.removeOne(e,r);return}n.markings.addOne({data:{square:yr(a),type:o},type:Sb,node:r,persistent:!0})}function Ir(e){ let _hh$temp103=e.getContext(),t=_hh$temp103.game,n=dr(t); e.markings.removeAllWhere({node:!0}),n.length&&e.markings.addMany(n)}function Lr(e,t){return e.reduce((e,n)=>( __get$(e,+!t(n)) .push(n),e),[[],[]])}function Rr(e){ let _hh$temp104=e,t=_hh$temp104.respond; return Or({onMarkingAdded:e=>n(`Mark`,e),onMarkingRemoved:e=>n(`Unmark`,e),context:e});function n(n,r){ let i=__get$({Mark:jr,Unmark:Mr},n),a=e.api.getContext().game.ids(),_hh$temp105=__arrayFrom$(Lr(sr(r),e=>Yn(e.node)&&a!==e.node)),o=_hh$temp105[0],s=_hh$temp105[1]; o.length&&i({data:o},e),s.length&&t( __get$(K.APIEvents,n) ,s)}}function zr(){return{api:Rr,match:lS,name:uS.Plugin.Name}}function Br(e){return[...new Set(e)]}function Vr( _hh$temp106 ){ var e=_hh$temp106.addMoveHints,t=_hh$temp106.addCaptureHints,n=_hh$temp106.context,r=_hh$temp106.currentHints,i=_hh$temp106.getNextHints,a=_hh$temp106.removeHints;  let o=r,_hh$temp107=n,s=_hh$temp107.api,c=_hh$temp107.mode,l=_hh$temp107.options,u=_hh$temp107.state; if(!l||!l.highlightLegalMoves||!c.isAllowedToMove())return a([...r],n),o.length=0,o;let d=u.get(K.State.SelectedPiece)||u.get(K.State.DraggingPiece);if(!d)return o.length&&(a(o,n),o=[]),o;let f=u.get(K.State.MachineState)===ix.States.PromotionAreaShowing?[]:s.getLegalMoves().filter(e=>e.from===d),p=Br(f.map(e=>e.to));l.disableRookCastling||p.push(...y(f));let m=o.filter(e=>!p.includes(e));a(m,n);let h=i(p),g=[],_=[],v=s.getPieces().keys();return h.forEach(e=>{t&&v.includes(e)?_.push(e):g.push(e)}),g.length&&e(g,n),_.length&&t?.(_,n),o.filter(e=>!m.includes(e)).concat(h);function y(e){if(s.getVariant()===J.Variants.Chess960||e.length===0||e[0].from===void 0)return[];let t=s.getPieces().getCollection(),n= __get$(t,e[0].from) ;return n?.type===`k`?e.reduce((e,r)=>{let i;if(r.san===`O-O-O`)i=r.color===J.ColorsAsNumbers.White?`a1`:`a8`;else if(r.san===`O-O`)i=r.color===J.ColorsAsNumbers.White?`h1`:`h8`;else return e;let a= __get$(t,i) ;return a?.type.toLowerCase()===`r`&&a?.color===n.color&&!a?.promoted&&r.to!==i&&e.push(i),e},[]):[]}}function Hr(){let e=[];return{match:[{condition:tr([K.UserEvents.Pointermove,zb.Events.Tick]),handler:n},{condition:xt(K.InstanceEvents.RendererSet),handler:t}],name:Ob.Plugin.Name};function t(t,r){e=[],n(t,r)}function n(t,n){ let _hh$temp108=n,r=_hh$temp108.renderer; r&&(e=Vr({addMoveHints:r.addMoveHints,addCaptureHints:r.addCaptureHints,context:n,currentHints:e,getNextHints:t=>t.filter(t=>!e.includes(t)),removeHints:r.removeHints}))}}function Ur(){return{match:[{condition:Ct(K.APIEvents),handler:t},{condition:xt(K.InstanceEvents.RendererSet),handler:e}],name:jb.Plugin.Name};function e(e,t){ let _hh$temp109=t,n=_hh$temp109.api,r=_hh$temp109.renderer; r?.loadPieces({pieces:n.getPieces()},t)}function t(e,t){ let _hh$temp110=t,n=_hh$temp110.renderer; if(!n)return;if(e.type===K.APIEvents.IllegalMove){n.illegalMove(!1,t);return} let _hh$temp111=e.data,r=_hh$temp111.plyDiff,i=_hh$temp111.move,a=_hh$temp111.pieces; if(a){n.loadPieces({pieces:a},t);return}if(i&&r===-1){i.san!==`--`&&n.undoMove(i,t);return}i&&n.makeMove(i,t)}}function Wr( _hh$temp112 ){ var e=_hh$temp112.context,t=_hh$temp112.method; return function(...n){try{return t(...n)}catch(t){ let _hh$temp113=e,n=_hh$temp113.api,r=_hh$temp113.renderer; console.error(`Board position reloaded due to game and renderer state desynchronisation:
`,t),n.logger.log({code:dS.ErrorCodes.StateDesynchronisation,data:t,level:dx.Levels.Error}),r?.loadPieces({pieces:n.getPieces(),reloadAll:!0},e)}}}function Gr(){let e={};return{create:t,destroy:n,match:[{condition:xt(K.InstanceEvents.RendererSet),handler:(e,n)=>t(n)}],name:dS.Plugin.Name};function t(t){ let _hh$temp114=t,n=_hh$temp114.options,r=_hh$temp114.renderer; !r||fS()||n.test||[`dragPiece`,`dropPiece`,`makeMove`,`removePiece`,`undoMove`].forEach(n=>{let i=Wr({context:t,method: __get$(r,n) }); __set$(e,n,__get$(r,n)) , __set$(r,n,i) })}function n(t){ let _hh$temp115=t,n=_hh$temp115.renderer; n&&(Object.keys(e).forEach(t=>{ __set$(n,t,__get$(e,t)) }),e={})}}function Kr( _hh$temp116 ){ var _hh$temp116$theme=_hh$temp116.theme,e=_hh$temp116$theme===void 0?`default`:_hh$temp116$theme,t=_hh$temp116.type,n=_hh$temp116.format,r=_hh$temp116.themePath; return`${r||Bt()?.assetPaths?.soundsTheme}_${n.toUpperCase()}_/${e}/${t}.${n}`}function qr(e,t,n){return[`webm`,`ogg`,`mp3`,`wav`].map(r=>Kr({format:r,theme:e,type:t,themePath:n}))}function Jr(e,t){return[`webm`,`ogg`,`mp3`,`wav`].map(n=>`${e}/${n}/${t}.${n}`)}function Yr(e){return[`webm`,`ogg`,`mp3`,`wav`].reduce((t,n)=>( __get$(e,n) &&t.push( __get$(e,n) ),t),[])}function Xr(e){return{[Ib.BoardSounds.GameStart]:_(Yr(e.gameStart)),[Ib.BoardSounds.GameEnd]:_(Yr(e.gameEnd)),[Ib.BoardSounds.Capture]:_(Yr(e.capture)),[Ib.BoardSounds.Castle]:_(Yr(e.castle)),[Ib.BoardSounds.Premove]:_(Yr(e.premove)),[Ib.BoardSounds.MoveSelf]:_(Yr(e.moveSelf)),[Ib.BoardSounds.MoveCheck]:_(Yr(e.moveCheck)),[Ib.BoardSounds.MoveOpponent]:_(Yr(e.moveOpponent)),[Ib.BoardSounds.Promote]:_(Yr(e.promote)),[Ib.BoardSounds.Notify]:_(Yr(e.notify)),[Ib.BoardSounds.TenSeconds]:_(Yr(e.tenSeconds)),[Ib.BoardSounds.Illegal]:_(Yr(e.illegal))}}function Zr(e){let t=e.options,n=pS,r=t?.soundTheme||`default`;e&&(n=e.codes);let i,a=r;return l({codes:n,theme:r,soundAssets:e?.soundAssets}),{destroy:o,getSounds:s,getTheme:c,load:l,loadExtra:u,play:d};function o(){Object.keys(i).forEach(e=>{ __get$(i,e) .unload()})}function s(){return i}function c(){return a}function l(e){a=e.theme,i=e.soundAssets?Xr(e.soundAssets):(e.codes||pS).reduce((e,n)=>( __set$(e,n,_(qr(a,n,t.assetPaths?.soundsTheme))) ,e),{}),g()}function u(e){let t=e.codes.reduce((t,n)=>( __set$(t,n,_(Jr(e.baseURL,n))) ,t),{});Object.keys(t).forEach(e=>{var n;(n= __get$(i,e) )==null||n.unload(), __set$(i,e,__get$(t,e)) }),g()}function d(e){let t= __get$(i,e) ,n=c();if(!t)return n;try{return v(t),n}catch{return n}}}function Qr(e){return e.flags===void 0?!1:(e.flags&1)==1||e.flags===J.Move.Flags.EPCapture}function $r(e){return e.flags===J.Move.Flags.AnyCastle||e.flags===J.Move.Flags.KingsideCastle||e.flags===J.Move.Flags.QueensideCastle}function ei(e){return!e||!e.san?!1:[`+`,`#`].includes(e.san.slice(-1))}function ti(e){return e.flags===J.Move.Flags.Promotion||e.flags===J.Move.Flags.CapturePromotion}function ni(e,t){if(!e||!e.san)return null;let n;return n=ei(e)?Ib.BoardSounds.MoveCheck:e.isPremove?Ib.BoardSounds.Premove:ti(e)?Ib.BoardSounds.Promote:Qr(e)?Ib.BoardSounds.Capture:$r(e)?Ib.BoardSounds.Castle:t?Ib.BoardSounds.MoveOpponent:Ib.BoardSounds.MoveSelf,n}function ri(e){return function(t){return e!==t.type}}function ii(e){let t=e,n;return{api:()=>({getSoundsInstance:()=>t}),match:[{condition:ri(K.UserEvents.Pointermove),handler:i}],name:Ib.Plugin.Name,create:r};function r(e){n=e.options.themeAssets?.sound.assets,t||=Zr({options:e.options,soundAssets:n})}function i(e,r){if(!t)return; let _hh$temp117=r,i=_hh$temp117.api,a=_hh$temp117.options,o=_hh$temp117.state,s=a.soundTheme!==t.getTheme()||!U(n,r.options.themeAssets?.sound?.assets); if(n=r.options.themeAssets?.sound.assets,e.type===K.OptionsEvents.Update&&s){t.destroy(),t.load({theme:a.soundTheme,soundAssets:n});return}if(e.type===K.SoundEvents.Play){t.play(e.data.sound),o.set({soundPlayed:e.data.sound});return}if(!a.playSounds||!e.data?.plyDiff)return;let c=i.getSelectedNode();if(e.type===K.APIEvents.MoveBackward&&(c=e.data.move),!c)return;let l=i.getPlayingAs(),u=!!(l&&l!==c.color),d=ni(c,u);d&&(t.play(d),o.set({soundPlayed:d}))}}function ai(e){return{create:t,name:Rb.Plugin.Name};function t(t){ let _hh$temp118=t,n=_hh$temp118.api; e&&n.timeControl.set(e)}}function oi(e){return!!(!e||e.isContentEditable||[`INPUT`,`TEXTAREA`].includes(e.tagName))}function si(e){let t;if(e)return e.includes(`Digit`)?t= __call$(e,"replace",[`Digit`,``]) :e.includes(`Key`)?t= __call$(e,"replace",[`Key`,``]) :e.includes(mS.Modifiers.Control)?t=mS.Modifiers.Control:e.includes(mS.Modifiers.Shift)?t=mS.Modifiers.Shift:e.includes(mS.Modifiers.Alt)?t=mS.Modifiers.Alt:e.includes(mS.Modifiers.Meta)?t=mS.Modifiers.Meta:hS.includes(e)&&(t=e),t?.toLowerCase()}function ci( _hh$temp119 ={}){ var e=_hh$temp119.onKeydown,t=_hh$temp119.onKeyup; let n=!0,r=new Set;return document.addEventListener(`keydown`,o),document.addEventListener(`keyup`,s),window.addEventListener(`blur`,c),window.addEventListener(`contextmenu`,c),{isPressed:i,getPressedKeys:a,disable:l,enable:u,destroy:d};function i(e){return r.has(e.toLowerCase())}function a(){return[...r].sort()}function o(t){let i=document.activeElement;if(!n||oi(i))return;let a=si(t.code);a&&(r.add(a),e?.(a))}function s(e){let n=si(e.code);n&&(gS.includes(n)&&r.clear(),r.delete(n),t?.(n))}function c(){r.clear()}function l(){n=!1,r.clear()}function u(){n=!0}function d(){document.removeEventListener(`keydown`,o),document.removeEventListener(`keyup`,s),window.removeEventListener(`blur`,c),window.removeEventListener(`contextmenu`,c),r.clear()}}function li(){let e,t=ci({onKeydown:o(iS.Events.Keydown),onKeyup:o(iS.Events.Keyup)}),n={[iS.Events.Keydown]:{},[iS.Events.Keyup]:{}},r={isPressed:t.isPressed,getPressedKeys:t.getPressedKeys,setOverrides:c,removeOverrides:l};return{api:()=>r,create:i,destroy:a,match:[{condition:xt(K.OptionsEvents.Update),handler:u},{condition:xt(iS.Events.Keydown),handler:s},{condition:xt(iS.Events.Keyup),handler:s}],name:iS.Plugin.Name};function i( _hh$temp120 ){ var t=_hh$temp120.run,n=_hh$temp120.options; e=t,d(n.enabled)}function a(){t.destroy()}function o(t){return function(n){e?.(Zt(t,n))}}function s(e,t){ let _hh$temp121=e,r=_hh$temp121.type,i=_hh$temp121.data,a=__get$(__get$(n,r),i); a&&t.queue.add(a(t.api))}function c(e){e.forEach(( _hh$temp122 )=>{ var e=_hh$temp122.key,t=_hh$temp122.callback,_hh$temp122$trigger=_hh$temp122.trigger,r=_hh$temp122$trigger===void 0?iS.Events.Keydown:_hh$temp122$trigger;  __set$(__get$(n,r),e,t) })}function l(e){e.forEach(( _hh$temp123 )=>{ var _hh$temp123$trigger=_hh$temp123.trigger,e=_hh$temp123$trigger===void 0?iS.Events.Keydown:_hh$temp123$trigger,t=_hh$temp123.key; delete  __get$(n,e) [t]})}function u(e,t){ let _hh$temp124=t,n=_hh$temp124.options; d(n.captureKeyStrokes&&n.enabled)}function d(e){e?t.enable():t.disable()}}function ui(e=_S.DefaultAcceptableFrequency){let t,n=0,r=!1,i=!1;return{api:()=>({activateBoard:s}),destroy:f,match:[{condition:xt(K.InstanceEvents.RendererSet),handler:a}],name:_S.Plugin.Name};function a(e,n){t=n; let _hh$temp125=t,r=_hh$temp125.renderer,i=r?.name===nx.Types.WebGL2D||r?.name===nx.Types.WebGL3D; !r||!i||!r.getWebGLCanvas||c(r.getWebGLCanvas())}function o(){if(!t)return;i=!0;let a=n&&Date.now()-n<e;if(n=Date.now(),a){d();return}r&&u()}function s(e=!0){r=e,r&&i&&u()}function c(e){e.removeEventListener(`webglcontextlost`,o),e.addEventListener(`webglcontextlost`,o)}function l(e){e.removeEventListener(`webglcontextlost`,o)}function u(){var e;if(!t||!t.renderer)return; let _hh$temp126=t,n=_hh$temp126.renderer; (e=n.handleWebGLContextLost)==null||e.call(n),i=!1,n.getWebGLCanvas&&c(n.getWebGLCanvas())}function d(){if(!t)return; let _hh$temp127=t,e=_hh$temp127.api,n=_hh$temp127.renderer,r=e.getOptions(),i={animationType:Qb.Animation.Types.Default}; n?.name===nx.Types.WebGL3D&&(i.pieceStyle=`neo`,r.themeAssets&&(i.themeAssets=Lt(r.themeAssets))),e.setOptions(i)}function f(){!t||!t.renderer||!t.renderer.getWebGLCanvas||l(t.renderer.getWebGLCanvas())}}function di(e,t){ let _hh$temp128=e,n=_hh$temp128.api; return{record:a,play:l,step:u,forward:d,stop:o,init:c,clear:s,get:()=>t,getJSON:r,load:i};function r(){return t.recording?JSON.stringify(t.recording):``}function i(e){let n=JSON.parse(e);return s(),t.recording=n,c()}function a(e=!0){s(),t.recording={modeName:n.getMode().name,variant:n.getVariant(),modeOptions:n.getMode().getOptions(),boardOptions:n.getOptions(),pgn:n.getPGN(),plugins:n.plugins.get().map(e=>e.name),timestamp:new Date().toISOString(),events:[]},t.mode=vS.Mode.Recording,t.recordEvents=e}function o(){return t.mode=vS.Mode.Idle,t.recording.events.length}function s(){t.mode=vS.Mode.Idle,t.lastRecordedEventTime=0,t.recording={events:[],pgn:``,modeName:``,variant:``,modeOptions:{},boardOptions:{},plugins:[],timestamp:``},t.playState={playCounter:0,initDirty:!1,playedEvents:[]}}function c(){if(o(),!t.recording)return 0;t.playState={playCounter:0,playedEvents:[],initDirty:!1}; let _hh$temp129=t.recording,n=_hh$temp129.pgn,r=_hh$temp129.events; return e.api.load({pgn:n}),e.api.markings.removeAll(), __get$(window,"location") .hostname===`localhost`&&e.api.boardImages&&!e.api.boardImages.isInitialized()&&e.api.boardImages.initDefault(),t.playState.initDirty=!1,r.length}function l( _hh$temp130 ={}){ var e=_hh$temp130.fixedDelay,_hh$temp130$skipEvents=_hh$temp130.skipEvents,n=_hh$temp130$skipEvents===void 0?!1:_hh$temp130$skipEvents,_hh$temp130$verbose=_hh$temp130.verbose,r=_hh$temp130$verbose===void 0?!0:_hh$temp130$verbose; o(),t.playState.initDirty&&c(),t.mode=vS.Mode.Playing,t.verbose=r,t.verbose&&console.log(`Playing`,t.recording.events.length-1),f({fixedDelay:e,skipEvents:n,autoContinue:!0})}function u( _hh$temp131 ={}){ var _hh$temp131$fastForwardEvents=_hh$temp131.fastForwardEvents,e=_hh$temp131$fastForwardEvents===void 0?!1:_hh$temp131$fastForwardEvents,_hh$temp131$skipEvents=_hh$temp131.skipEvents,n=_hh$temp131$skipEvents===void 0?!1:_hh$temp131$skipEvents,_hh$temp131$verbose=_hh$temp131.verbose,r=_hh$temp131$verbose===void 0?!0:_hh$temp131$verbose; o(),t.mode=vS.Mode.Playing,t.verbose=r,f({fixedDelay:0,skipEvents:n,fastForwardEvents:e,autoContinue:!1})}function d( _hh$temp132 ){ var e=_hh$temp132.eventNumber,_hh$temp132$skipEvents=_hh$temp132.skipEvents,n=_hh$temp132$skipEvents===void 0?!1:_hh$temp132$skipEvents,_hh$temp132$verbose=_hh$temp132.verbose,r=_hh$temp132$verbose===void 0?!0:_hh$temp132$verbose; o(),(!t.playState.playCounter||t.playState.playCounter>=e||t.playState.playCounter===t.recording.events.length)&&c(),t.mode=vS.Mode.Playing,t.verbose=r,f({fixedDelay:0,maxEventNumber:e,skipEvents:n,autoContinue:!0})}function f( _hh$temp133 ){ var e=_hh$temp133.maxEventNumber,r=_hh$temp133.fixedDelay,i=_hh$temp133.skipEvents,a=_hh$temp133.fastForwardEvents,o=_hh$temp133.autoContinue; let s= __get$(t.recording.events,t.playState.playCounter) ;if(!s){t.mode=vS.Mode.Idle;return} let _hh$temp134=s,c=_hh$temp134.name,l=_hh$temp134.args,u=_hh$temp134.namespace; u? __call$(__get$(n,u),c,[...l]) :c===`event`?i?(t.playState.playCounter+=1,t.playState.playedEvents.push(`skipped: ${l[0].type}`)):n.emit(l[0].type,l[0]): __call$(n,c,[...l]) ;let d= __get$(t.recording.events,t.playState.playCounter) ;if(t.mode!==vS.Mode.Playing||!d||!o&&(!i||!a)||e&&t.playState.playCounter>=e){t.mode=vS.Mode.Idle,!d&&t.verbose&&console.log(`Finished playing`);return}let p=r??d.time;i&&d.name===`event`&&(p=0),(o||(i||a)&&d.name===`event`)&&setTimeout(()=>{f({maxEventNumber:e,fixedDelay:r,skipEvents:i,fastForwardEvents:a,autoContinue:o})},p)}}function fi(){return{api:e=>di(e,bS),create:t=>setTimeout(()=>e(t)),match:[{condition:()=>bS.mode===vS.Mode.Recording&&bS.recordEvents,handler:e=>{bS.recording.events.push({name:`event`,args:[e],time:hi()})}},{condition:()=>bS.mode===vS.Mode.Playing,handler:e=>{bS.verbose&&console.log(`${bS.playState.playCounter} / ${bS.recording.events.length-1}`,e),bS.playState.playCounter+=1,bS.playState.playedEvents.push(e)}}],name:vS.Plugin.Name};function e(e){ let _hh$temp135=e,t=_hh$temp135.api; pi(t);let n=(e,n,r)=>{let i=(Array.isArray(r[0])?r[0]:r).map(e=>e.name),a=e(...r);return i.forEach(e=>{pi(t,e)}),a};e.api.plugins.add=new Proxy(e.api.plugins.add,{apply:n}),e.api.plugins.addMany=new Proxy(e.api.plugins.addMany,{apply:n})}}function pi(e,t){(t?yS.filter(e=>e.namespace===t):yS).forEach(( _hh$temp136 )=>{ var t=_hh$temp136.namespace,n=_hh$temp136.name; if(!t&&! __get$(e,n) ||t&&! __get$(e,t) ||t&& __get$(e,t) &&! __get$(__get$(e,t),n) )return;let r=mi(n,t);t? __set$(__get$(e,t),n,new Proxy(__get$(__get$(e,t),n),{apply:r})) : __set$(e,n,new Proxy(__get$(e,n),{apply:r})) })}function mi(e,t){return function(n,r,i){if(bS.playState.initDirty=!0,bS.mode===vS.Mode.Recording){let n=hi(),r=t?{namespace:t}:{};bS.recording.events.push({name:e,args:i,time:n,...r})}if(bS.mode===vS.Mode.Playing){let n= __get$(bS.recording.events,bS.playState.playCounter) ;if(n&&n.name===e&&(!n.namespace||n.namespace===t)&&JSON.stringify(n.args).substring(0,50)===JSON.stringify(i).substring(0,50)){if(bS.verbose){let e=n.namespace?`${n.namespace}.${n.name}`:n.name;console.log(`${bS.playState.playCounter} / ${bS.recording.events.length-1}`,`${e}`,...n.args)}bS.playState.playCounter+=1}let r=t?{namespace:t}:{};bS.playState.playedEvents.push({name:e,args:i,...r})}return n(...i)}}function hi(){let e=Date.now(),t=bS.lastRecordedEventTime===0?0:e-bS.lastRecordedEventTime;return bS.lastRecordedEventTime=e,t}function gi( _hh$temp137 ){ var e=_hh$temp137.color,t=_hh$temp137.type,n=_hh$temp137.opacity,r=_hh$temp137.square,i=_hh$temp137.turn; return{data:{color:e,opacity:n,square:r,turn:i,type:t},key:`${t}|${r}`,type:`highlight`}}function _i(e,t){switch(e){case Ub.Alt:return t.analysisHighlightColors.alt;case Ub.Ctrl:return t.analysisHighlightColors.ctrl;case Ub.Shift:return t.analysisHighlightColors.shift;case Ub.None:return t.analysisHighlightColors.default;default:return}}function vi(e,t){ let _hh$temp138=t,n=_hh$temp138.api,r=_hh$temp138.options; return!r||!r.allowMarkings?[]:n.markings.getAllWhere({types:[nb]}).map( _hh$temp139=>{var _hh$temp139$data=_hh$temp139.data,e=_hh$temp139$data.color,t=_hh$temp139$data.keyPressed,n=_hh$temp139$data.opacity,i=_hh$temp139$data.square;return gi({color:_i(t,r)??e??r.analysisHighlightColors.default,opacity:n??r.analysisHighlightOpacity,square:i,type:`analysis`});} )}function yi(e,t){ let _hh$temp140=t,n=_hh$temp140.api,r=_hh$temp140.options,i=[]; if(!r||!r.highlightMoves)return i;let a=n.getSelectedNode();return a&&[a.from,yr(a)].forEach(e=>{if(!e)return;let t=gi({color:r.themeAssets?.board.config.highlightSquareHex??r.highlightColor??Pt(r.boardStyle)?.highlightColor??Qb.HighlightColors.Selected,opacity:r.highlightOpacity,square:e,turn:a.color,type:xS});i.push(t)}),i}function bi(e,t){ let _hh$temp141=t,n=_hh$temp141.options,r=_hh$temp141.state; if(!n||!n.highlightMoves)return[];let i=r.get(K.State.SelectedPiece)||r.get(K.State.DraggingPiece);return i?[gi({color:n.themeAssets?.board.config.highlightSquareHex??Pt(n.boardStyle)?.highlightColor??Qb.HighlightColors.Selected,opacity:n.highlightOpacity,square:i,type:`SelectionHiglight`})]:[]}function xi(e,t){return t._withIDBStore(`readwrite`,t=>{e.forEach(e=>{t.put(e,e.f)})})}function Si( _hh$temp142 ){ var e=_hh$temp142.name,t=_hh$temp142.table; CS=new $e(e,t)}function Ci(){return CS}async function wi( _hh$temp143 ){ var e=_hh$temp143.ecoPath,t=_hh$temp143.http; let n=SS,r=await Oi(),i=await Di();if(!r||!i&&n||i!==n)return Ei(n),ki({ecoPath:e,http:t}).then(Ti)}function Ti(){return x(wS,!0,CS)}function Ei(e){return x(TS,e,CS)}async function Di(){return b(TS,CS).then(String)}async function Oi(){return b(wS,CS).then(Boolean)}async function ki( _hh$temp144 ){ var e=_hh$temp144.ecoPath,t=_hh$temp144.http; return t.get(e).then(e=>{xi((e?.data?.positions?e.data.positions:e.data)??e,CS)})}function Ai(e){return e.reverse().map(e=>e.split(` `).slice(0,3).join(` `))}async function ji( _hh$temp145 ){ var e=_hh$temp145.ecoPath,t=_hh$temp145.fens,n=_hh$temp145.http; let r=Ai(t);return await wi({ecoPath:e,http:n}),(await Mi(r)).find(Boolean)}function Mi(e){return Promise.all(e.map(e=>b(e,Ci())))}function Ni(e,t){let n;return{get:()=>n,update:r};async function r(){ let _hh$temp146=e,r=_hh$temp146.api,i=_hh$temp146.respond; n=await ji({...t,fens:r.getHistoryFENs()}),i(bb.Events.Update,n)}}function Pi( _hh$temp147 ={}){ var _hh$temp147$ecoPath=_hh$temp147.ecoPath,e=_hh$temp147$ecoPath===void 0?``:_hh$temp147$ecoPath,_hh$temp147$http=_hh$temp147.http,t=_hh$temp147$http===void 0?OS:_hh$temp147$http,_hh$temp147$storeData=_hh$temp147.storeData,n=_hh$temp147$storeData===void 0?{name:ES.ECO,table:DS.ECO}:_hh$temp147$storeData; if(!(`indexedDB`in window))return{name:bb.Name};function r(e){Ci()||Si({...n}),i(null,e)}return{api:n=>Ni(n,{ecoPath:e,http:t}),create:r,match:[{condition:Ct(sS),handler:i}],name:bb.Name};function i(e,t){t.api.eco.update()}}function Fi(){let e,t=!1;return{create:i,destroy:a,match:[{condition:xt(K.APIEvents.SetPlayingAs),handler:(e,t)=>r(t.api)}],name:Mb.Plugin.Name,requires:[`premoves`]};function n(e){ let _hh$temp148=e,n=_hh$temp148.api; return{get:i,set:a};function i(){return t}function a(e){if(t=e,r(n),e===!1){let e=n.getPositionDetails()?.sideToMove??J.ColorsAsNumbers.White;if(n.setTurn(e),n.premoves?.getQueue()[0]?.color===e){let e=n.premoves?.consumeNext(),t=e===null?K.APIEvents.IllegalMove:K.APIEvents.Move;n.getContext().respond(t,e)}}}}function r(e){t&&e.setTurn(e.getPlayingAs()===J.ColorsAsNumbers.White?J.ColorsAsNumbers.Black:J.ColorsAsNumbers.White)}function i(t){ let _hh$temp149=t,r=_hh$temp149.api; if(!r.premoves)return`The premoves plugin must be registered in order to use the pregame plugin.`;e=r.extendAPI(Mb.Plugin.Name,{pregame:()=>n(t)})}function a(){e()}}function Ii( _hh$temp150 ){ var e=_hh$temp150.api; return e.premoves.cancel}function Li( _hh$temp151 ){ var e=_hh$temp151.api; return e.premoves.getLegalMovesForSquare}function Ri( _hh$temp152 ){ var e=_hh$temp152.api; return e.premoves.getLegalMoves}function zi( _hh$temp153 ){ var e=_hh$temp153.api; return e.premoves.getMove}function Bi( _hh$temp154 ){ var e=_hh$temp154.api; return e.premoves.getPieces}function Vi( _hh$temp155 ){ var e=_hh$temp155.api; return function(...t){let n=t[0]?.premoves,r=e.getContext().game;n?.forEach(e=>{r.premove.move(e)}),e.premoves.loadQueue(n),t[0].pieces=e.premoves.getPieces()}}function Hi( _hh$temp156 ){ var e=_hh$temp156.api; return e.premoves.reload}function Ui( _hh$temp157 ){ var e=_hh$temp157.api; return e.premoves.move}function Wi( _hh$temp158 ){ var e=_hh$temp158.api; return function(t){return e.getContext().respond(K.APIEvents.SetBoardPosition,{pieces:e.premoves.getPieces(),holdSelectedPiece:!0}),t}}function Gi(e){return e.api.getPlayingAs()!==e.api.getTurn()}function Ki(e,t){return!t.userGenerated}function qi(e,t){return!!t.userGenerated}function Ji(e){return e.api.premoves.getQueue().length}function Yi(e){return e.api.premoves.getQueue().length>0}function Xi(e,t){return!!t?.premoves}function Zi(){return{moveBackward:{handler:Ii,run:`before`},moveForward:{handler:Ii,run:`before`},outOfTime:{handler:Ii,run:`before`},resign:{handler:Ii,run:`before`},selectLineEnd:{handler:Ii,run:`before`},selectLineStart:{handler:Ii,run:`before`},selectNode:{handler:Ii,run:`before`},undo:{handler:Ii,run:`before`},agreeDraw:{handler:Ii,run:`before`},deletePosition:{handler:Ii,run:`before`},getLegalMovesForSquare:{conditions:Gi,handler:Li,run:`instead`},getLegalMoves:{conditions:Gi,handler:Ri,run:`instead`},getMove:{conditions:Gi,handler:zi,run:`instead`},getPieces:{conditions:Ji,handler:Bi,run:`instead`},load:[{handler:Ii,run:`before`},{conditions:Xi,handler:Vi,run:`before`}],move:[{conditions:[Gi,Yi],handler:Hi,run:`before`},{conditions:[Gi,qi],handler:Ui,run:`instead`},{conditions:[Gi,Ki,Yi],handler:Wi,run:`after`}]}}function Qi( _hh$temp159 ){ var e=_hh$temp159.api,t=_hh$temp159.canMoveWhenNotPlayerTurn,n=_hh$temp159.modeOptions;  let _hh$temp160=n,r=_hh$temp160.canAddMovesToMainLine,i=_hh$temp160.canMoveWhenGameIsOver,a=_hh$temp160.canModifyExistingMovesOnMainLine; return!!((i||!e.isGameOver())&&(r&&e.isAtEndOfLine()||a)&&(t||e.getPlayingAs()===e.getTurn()))}function tee(e,t){return function(){return Qi({api:t,canMoveWhenNotPlayerTurn:!0,modeOptions:e.getOptions()})}}function nee(){return{isAllowedToMove:tee}}function $i(e){return function(){ let _hh$temp161=e,t=_hh$temp161.api,n=_hh$temp161.game; return t.premoves.getQueue().length?(n.premove.cancel(),t.reload()):null}}function ea( _hh$temp162 ){ var e=_hh$temp162.api,t=_hh$temp162.node,n=_hh$temp162.timestamp;  let _hh$temp163=e.getContext(),r=_hh$temp163.game,i=_hh$temp163.respond,_hh$temp164=t.ids,a=_hh$temp164.line,o=_hh$temp164.move; if(n===null)return t.commands?.timestamp&&delete t.commands.timestamp,i(K.APIEvents.NodeUpdated,{changes:{timestamp:n,node:t}});t.commands||={},r.updateNode({commands: __call$(Object,"assign",[t.commands,{timestamp:`${n}`}]) },o,a)}function ta(e){return Math.round(e/100)}function na( _hh$temp165 ){ var e=_hh$temp165.api,t=_hh$temp165.node; return e.getNodeByIds({move:t.ids.move-2,line:t.ids.line})}function ra( _hh$temp166 ){ var e=_hh$temp166.api,t=_hh$temp166.timeControl; let n=e.getLine(0);if(!n)return null; let r=__get$(n,n.length-1),i=na({api:e,node:r}),_hh$temp167=t,a=_hh$temp167.baseTime,o=_hh$temp167.increment,s=ia({baseTime:ta(a),increment:ta(o),lastNodeTime:i?.time}); return s&&r&&(r.time=s),s}function ia( _hh$temp168 ){ var e=_hh$temp168.baseTime,t=_hh$temp168.increment,n=_hh$temp168.lastNodeTime; return r()-kS;function r(){return n?n+t:e}}function aa(e){return function(){ let _hh$temp169=e,t=_hh$temp169.api,n=_hh$temp169.game,r=_hh$temp169.mutateGame; if(!t.premoves.getQueue().length)return null;if(t.isGameOver())return t.premoves.cancel();t.premoves.reload();let i=r(function(){n.premove.consume()});if(!i||i.plyDiff===0)return null;if(i.consumedPremove=!0,t.premoves.getQueue().length&&(i.pieces=t.premoves.getPieces()),i.move){let e=t.timeControl.get();e&&(ra({api:t,timeControl:e}),ea({api:t,node:i.move,timestamp:kS})), __call$(Object,"assign",[i.move,{animate:!1,userGenerated:!0}]) }return i.result&&t.setResult(i.result),i}}function oa(e){return function(t){ let _hh$temp170=e,n=_hh$temp170.game,r=n.premove.moves(t); return r?Br(r.filter(e=>t===void 0||e.from===t).map(e=>e.to)):[]}}function sa(e){return function(){ let _hh$temp171=e,t=_hh$temp171.game; return t.premove.moves()||[]}}function ca(e){return function(n){ let _hh$temp172=e,r=_hh$temp172.game,i=`from`in n,a=`drop`in n,o=r.premove.moves(i?n.from:void 0),s=o?o.find(e=>e.to===n.to&&(!a||e.drop===n.drop)):null; if(!s&&i&&t(n)){let e=[...r.premove.queue];s=r.premove.move(n),s&&(r.premove.cancel(),e.forEach(r.premove.move))}return s?r.moveDetails({...s}):null};function t(t){ let _hh$temp173=e,n=_hh$temp173.game; return!!(t.from&& __get$(n.premove.getPieces(!0),t.from) ?.type.toLowerCase()===`k`)}}function la(e){return function(){ let _hh$temp174=e,t=_hh$temp174.game; return En(t.premove.getPieces(!0))}}function ua(e){return function(){ let _hh$temp175=e,t=_hh$temp175.game; return t.premove.queue}}function da(e){return function(t){ let _hh$temp176=e,n=_hh$temp176.game; return n.premove.move(t)?(n.undo(),!0):!1}}function fa(e){return function(t){ let _hh$temp177=e,n=_hh$temp177.game; n.premove.queue.length=0,n.premove.queue.push(...t)}}function pa(e){return function(t){ let _hh$temp178=e,n=_hh$temp178.api,r=_hh$temp178.game,i=_hh$temp178.respond; return`tcn`in t||!r.premove.move(t)?null:(n.getOptions().playSounds&&i(K.SoundEvents.Play,{sound:Ib.BoardSounds.Premove}),i(K.APIEvents.SetBoardPosition,{pieces:n.premoves.getPieces()}))}}function ma(e){return function(){ let _hh$temp179=e,t=_hh$temp179.api; if(t.premoves.getQueue().length){let e=[...t.premoves.getQueue()];t.reload(),t.premoves.loadQueue(e)}else t.reload()}}function ha(){return function(e){return{cancel:$i(e),consumeNext:aa(e),getLegalMovesForSquare:oa(e),getLegalMoves:sa(e),getMove:ca(e),getPieces:la(e),getQueue:ua(e),isLegalMove:da(e),loadQueue:fa(e),move:pa(e),reload:ma(e)}}}function ga(e){return e.type===K.APIEvents.Move&&!e.data.consumedPremove}function _a(e,t){ let _hh$temp180=t,n=_hh$temp180.api,r=_hh$temp180.options,i=(n.premoves?.getQueue()); if(!r||!r.allowMarkings||!i.length)return[];let a=[];return i.forEach(e=>{if(e.from){let t=gi({color:r.premoveHighlightColor,opacity:r.premoveHighlightOpacity,square:e.from,type:AS});a.push(t)}let t=gi({color:r.premoveHighlightColor,opacity:r.premoveHighlightOpacity,square:yr(e),type:AS});a.push(t)}),a}function va(){return{api:ha(),apiOverrides:Zi(),beforeState:[{condition:xt(K.UserEvents.PointerdownRight),handler:n},{condition:xt(K.APIEvents.Move),handler:r}],create:e,destroy:t,modeOverrides:nee(),name:Nb.Plugin.Name};function e(e){ let _hh$temp181=e,t=_hh$temp181.api; t.highlights&&t.highlights.addModule(_a)}function t(e){var t,n; let _hh$temp182=e,r=_hh$temp182.api; (t=r.premoves)==null||t.cancel(),(n=r.highlights)==null||n.removeModule(_a)}function n(e,t){ let _hh$temp183=t,n=_hh$temp183.api,r=_hh$temp183.queue; return n.premoves.getQueue().length>0?(r.add(n.premoves.cancel),!1):!0}function r(e,t){ let _hh$temp184=t,n=_hh$temp184.api,r=_hh$temp184.queue; return n.premoves.getQueue().length&&ga(e)?(r.add(function(){if(n.isGameOver()){n.premoves.cancel();return}let e=n.premoves.consumeNext(),t=e===null?K.APIEvents.IllegalMove:K.APIEvents.Move;n.once(K.APIEvents.Move,()=>{n.getContext().respond(t,{...e,holdSelectedPiece:!0})})}),!1):!0}}function ya(e,t){ let _hh$temp185=window,n=_hh$temp185.requestIdleCallback; if(n){n(e,t);return}r(e);function r(e){let t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))})},1)}}function ba( _hh$temp186 ){ var e=_hh$temp186.onAll,t=_hh$temp186.onDebug,n=_hh$temp186.onError; return{create:r,name:Pb.Plugin.Name};function r(r){if(!e&&!t&&!n)return; let _hh$temp187=r,_hh$temp187$api=_hh$temp187.api,a=_hh$temp187$api.logger; a.on(dx.Events.EntryAdded,e=>i(e,a))}function i(r,i){let o=i.get();e&&a({callback:e,entry:r,previousLogs:o}),t&&r.level===dx.Levels.Debug&&a({callback:t,entry:r,previousLogs:o}),n&&r.level===dx.Levels.Error&&a({callback:n,entry:r,previousLogs:o})}function a( _hh$temp188 ){ var e=_hh$temp188.callback,t=_hh$temp188.entry,n=_hh$temp188.previousLogs; ya(()=>e(t,n))}}function xa(e,t){return e===t}function Sa(e){return e===0}function Ca(e){return e>1}function wa(e){return Object.entries(e).reduce( (e,_hh$temp189)=>{var _hh$temp190=__arrayFrom$(_hh$temp189),t=_hh$temp190[0],n=_hh$temp190[1];return n&&e.push(t),e;} ,[]).join(` `)}function Ta( _hh$temp191 ){ var _hh$temp191$showFigurine=_hh$temp191.showFigurine,e=_hh$temp191$showFigurine===void 0?!1:_hh$temp191$showFigurine,_hh$temp191$san=_hh$temp191.san,t=_hh$temp191$san===void 0?``:_hh$temp191$san,_hh$temp191$annotation=_hh$temp191.annotation,n=_hh$temp191$annotation===void 0?``:_hh$temp191$annotation,r=_hh$temp191.translations; return`${t.split(``).map(t=>{if(!(`NBRQK`.includes(t)&&e))return!`NBRQK`.includes(t)||!r?t: __call$(r,t,[]) }).join(``)}${n}`}function Ea(e){let t=e[0].toLowerCase();return t===e[0]?null: __get$(J.Piece.Names,t) ??null}function Da(e){let t=Ta({san:e[1],translations:e[6],annotation:e[3]})+``,n;return{c(){n=I(t)},m(e,t){N(e,n,t)},p(e,r){r&74&&t!==(t=Ta({san:e[1],translations:e[6],annotation:e[3]})+``)&&oe(n,t)},d(e){e&&P(n)}}}function Oa(e){let t,n,r,i,a=Ta({san:e[1],translations:e[6],showFigurine:!0,annotation:e[3]})+``,o;return{c(){t=F(`span`),i=re(),o=I(a),R(t,`class`,n=`${MS.Classes.IconFont} ${e[4]}-${e[0]}`),R(t,`data-figurine`,r=e[1][0])},m(e,n){N(e,t,n),N(e,i,n),N(e,o,n)},p(e,i){i&17&&n!==(n=`${MS.Classes.IconFont} ${e[4]}-${e[0]}`)&&R(t,`class`,n),i&2&&r!==(r=e[1][0])&&R(t,`data-figurine`,r),i&74&&a!==(a=Ta({san:e[1],translations:e[6],showFigurine:!0,annotation:e[3]})+``)&&oe(o,a)},d(e){e&&P(t),e&&P(i),e&&P(o)}}}function ka(e){let t,n;function r(e,n){return n&48&&(t=null),t??=!!(e[8](e[5])&&e[4]),t?Oa:Da}let i=r(e,-1),a=i(e);return{c(){a.c(),n=ie()},m(e,t){a.m(e,t),N(e,n,t)},p(e, _hh$temp192 ){ var _hh$temp193=__arrayFrom$(_hh$temp192),t=_hh$temp193[0]; i===(i=r(e,t))&&a?a.p(e,t):(a.d(1),a=i(e),a&&(a.c(),a.m(n.parentNode,n)))},i:S,o:S,d(e){a.d(e),e&&P(n)}}}function Aa(e,t,n){let r,i,a=S,o=()=>(a(),a=ee(u,e=>n(5,i=e)),u),s;e.$$.on_destroy.push(()=>a()); let _hh$temp194=t,c=_hh$temp194.color,_hh$temp195=t,l=_hh$temp195.san,_hh$temp196=t,u=_hh$temp196.textType; o(); let _hh$temp197=t,_hh$temp197$annotation=_hh$temp197.annotation,d=_hh$temp197$annotation===void 0?``:_hh$temp197$annotation,_hh$temp198=ve(kb.Name),f=_hh$temp198.store,_hh$temp199=f,p=_hh$temp199.translations; A(e,p,e=>n(6,s=e));let m=e=>e===`figurine`;return e.$$set=e=>{`color`in e&&n(0,c=e.color),`san`in e&&n(1,l=e.san),`textType`in e&&o(n(2,u=e.textType)),`annotation`in e&&n(3,d=e.annotation)},e.$$.update=()=>{e.$$.dirty&2&&n(4,r=Ea(l))},[c,l,u,d,r,i,s,p,m]}function ja(e){return e===J.ColorsAsNumbers.Black?J.ColorsAsWords.Black:J.ColorsAsWords.White}function Ma(e,t){if(!t)return 0;let n=t.y+t.height,r=t.y-e.height,i=n<=window.innerHeight-e.height;return!i&&!(r>=0)?0:i?n:r}function Na(e,t){if(!t)return 0;let n=t.x,r=t.x+t.width-e.width,i=n<=window.innerWidth-e.width;return!i&&!(r>=0)?0:i?n:r}function Pa(e,t,n){let r=e.slice();return r[15]= __get$(t,n) ,r}function Fa(e){let t,n,r=e[4].moves,i=[];for(let t=0;t<r.length;t+=1) __set$(i,t,Ra(Pa(e,r,t))) ;let a=e=>Te( __get$(i,e) ,1,1,()=>{ __set$(i,e,null) });return{c(){for(let e=0;e<i.length;e+=1) __get$(i,e) .c();t=ie()},m(e,r){for(let t=0;t<i.length;t+=1) __get$(i,t) && __get$(i,t) .m(e,r);N(e,t,r),n=!0},p(e,n){if(n&281){r=e[4].moves;let o;for(o=0;o<r.length;o+=1){let a=Pa(e,r,o); __get$(i,o) ?( __get$(i,o) .p(a,n),V( __get$(i,o) ,1)):( __set$(i,o,Ra(a)) , __get$(i,o) .c(),V( __get$(i,o) ,1), __get$(i,o) .m(t.parentNode,t))}for(Ce(),o=r.length;o<i.length;o+=1)a(o);we()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)V( __get$(i,e) );n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)Te( __get$(i,e) );n=!1},d(e){te(i,e),e&&P(t)}}}function Ia(e){let t;return{c(){t=F(`div`),R(t,`class`,`icon-font-chess move-arrow-right icon svelte-ypv1hw`)},m(e,n){N(e,t,n)},d(e){e&&P(t)}}}function La(e){let t,n;return t=new NS({props:{san:e[15].san,color:ja(e[15].color),textType:e[3]}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n&16&&(r.san=e[15].san),n&16&&(r.color=ja(e[15].color)),n&8&&(r.textType=e[3]),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function Ra(e){let t,n,r=xa(e[15],e[4].selectedMove),i,a,o,s,c,l,u=r&&Ia(),d=e[15]&&La(e);function f(){return e[10](e[15])}function p(){return e[11](e[15])}return{c(){t=F(`div`),n=F(`span`),u&&u.c(),i=re(),d&&d.c(),a=re(),R(n,`class`,`icon-wrap svelte-ypv1hw`),R(t,`class`,o=j(`row ${xa(e[15],e[4].selectedMove)?`selected`:``}`)+` svelte-ypv1hw`)},m(e,r){N(e,t,r),M(t,n),u&&u.m(n,null),M(t,i),d&&d.m(t,null),M(t,a),s=!0,c||=(l=[L(t,`mouseenter`,f),L(t,`click`,p),L(t,`keydown`,PS)],!0)},p(i,c){e=i,c&16&&(r=xa(e[15],e[4].selectedMove)),r?u||(u=Ia(),u.c(),u.m(n,null)):u&&=(u.d(1),null),e[15]?d?(d.p(e,c),c&16&&V(d,1)):(d=La(e),d.c(),V(d,1),d.m(t,a)):d&&(Ce(),Te(d,1,1,()=>{d=null}),we()),(!s||c&16&&o!==(o=j(`row ${xa(e[15],e[4].selectedMove)?`selected`:``}`)+` svelte-ypv1hw`))&&R(t,`class`,o)},i(e){s||=(V(d),!0)},o(e){Te(d),s=!1},d(e){e&&P(t),u&&u.d(),d&&d.d(),c=!1,E(l)}}}function za(e){let t,n,r,i,a,o,s=e[4].moves&&e[4].moves.length&&Fa(e);return{c(){t=F(`div`),s&&s.c(),R(t,`tabindex`,`-1`),R(t,`class`,`variations-popover svelte-ypv1hw`),R(t,`style`,n=`
    top: ${Ma(e[6],e[2])}px; 
    left: ${Na(e[6],e[2])}px;`),be(()=>e[13].call(t))},m(n,c){N(n,t,c),s&&s.m(t,null),e[12](t),r=ue(t,e[13].bind(t)),i=!0,a||=(o=L(t,`keydown`,e[7]),!0)},p(e, _hh$temp200 ){ var _hh$temp201=__arrayFrom$(_hh$temp200),r=_hh$temp201[0]; e[4].moves&&e[4].moves.length?s?(s.p(e,r),r&16&&V(s,1)):(s=Fa(e),s.c(),V(s,1),s.m(t,null)):s&&(Ce(),Te(s,1,1,()=>{s=null}),we()),(!i||r&68&&n!==(n=`
    top: ${Ma(e[6],e[2])}px; 
    left: ${Na(e[6],e[2])}px;`))&&R(t,`style`,n)},i(e){i||=(V(s),!0)},o(e){Te(s),i=!1},d(n){n&&P(t),s&&s.d(),e[12](null),r(),a=!1,o()}}}function Ba(e,t,n){let r,i,a=S,o=()=>(a(),a=ee(c,e=>n(4,i=e)),c);e.$$.on_destroy.push(()=>a()); let _hh$temp202=t,s=_hh$temp202.eventHandlers,_hh$temp203=t,c=_hh$temp203.variationPopover; o(); let _hh$temp204=t,l=_hh$temp204.selectedNodeRect,_hh$temp205=t,u=_hh$temp205.textType,d=null,f={width:0,height:0}; z(()=>(document.addEventListener(`click`,m),()=>{window.removeEventListener(`click`,m),document.removeEventListener(`keydown`,p,{capture:!0})}));function p(e){e.preventDefault();let t={DOWN:40,ENTER:13,RIGHT:39,UP:38};if(!i.isOpen||Object.values(t).indexOf(e.keyCode)===-1)return;e.stopImmediatePropagation();let n=i.moves?.findIndex(e=>e===i.selectedMove)||0;switch(e.keyCode){case t.UP:{let e= __get$(i.moves,n-1,true) ;e&&s.selectPopoverMove(e);break}case t.DOWN:{let e= __get$(i.moves,n+1,true) ;e&&s.selectPopoverMove(e);break}case t.ENTER:case t.RIGHT:{let e=c.get().selectedMove?.ids;e&&s.selectNode(e);break}}}function m(e){d===null||d.contains(e.target)||s.closeVariationsPopover()}function h(e){s.selectNode(e.ids)}let g=e=>s.selectPopoverMove(e),_=e=>h(e);function v(e){ __call$(ot,e?`unshift`:`push`,[()=>{d=e,n(5,d);}]) }function y(){f.width=this.clientWidth,f.height=this.clientHeight,n(6,f)}return e.$$set=e=>{`eventHandlers`in e&&n(0,s=e.eventHandlers),`variationPopover`in e&&o(n(1,c=e.variationPopover)),`selectedNodeRect`in e&&n(2,l=e.selectedNodeRect),`textType`in e&&n(3,u=e.textType)},e.$$.update=()=>{e.$$.dirty&16&&n(9,r=i.isOpen),e.$$.dirty&512&&(r?document.addEventListener(`keydown`,p,{capture:!0}):document.removeEventListener(`keydown`,p,{capture:!0}))},[s,c,l,u,i,d,f,p,h,r,g,_,v,y]}function Va(e){return e===J.Move.Flags.EPCapture}function Ha( _hh$temp206 ){ var e=_hh$temp206.node,t=_hh$temp206.translations,n=_hh$temp206.gameMetadata,r=_hh$temp206.game; return e?e.ply&&(n?.threefoldIndexes)?.includes(e.ply-1)?{tooltipMessage: __call$(t,Y.Translation.Tooltips.ThreeFoldRepetition,[]) ,iconClassName:MS.Classes.ThreeFoldIcon}:e.flags&&Va(e.flags)?{tooltipMessage: __call$(t,Y.Translation.Tooltips.EnPassant,[]) ,handleClick:e=>{let t=r?.getOptions().assetPaths?.enPassant;t&&(e.stopPropagation(),window.open(t,`_blank`))},iconClassName:MS.Classes.CircleInfo}:null:null}function Ua( _hh$temp207 ){ var e=_hh$temp207.translations,t=_hh$temp207.gameMetadata; let n=t?.resultPositionInfo;return n?n.fiftyMoveRule?{tooltipMessage: __call$(e,Y.Translation.Tooltips.FiftyMove,[]) ,iconClassName:MS.Classes.CircleInfo}:n.insufficient?{tooltipMessage: __call$(e,Y.Translation.Tooltips.InsufficientMaterial,[]) ,iconClassName:MS.Classes.CircleInfo}:n.timeoutVsInsufficientMaterial&&n.lastMoveColor?{tooltipMessage:n.lastMoveColor===J.ColorsAsNumbers.White? __call$(e,Y.Translation.Tooltips.BlackTimeoutVsInsufficientMaterial,[]) : __call$(e,Y.Translation.Tooltips.WhiteTimeoutVsInsufficientMaterial,[]) ,iconClassName:MS.Classes.CircleInfo}:n.drawByAgreement?{tooltipMessage: __call$(e,Y.Translation.Tooltips.DrawByAgreement,[]) ,iconClassName:MS.Classes.CircleInfo}:n.stalemate?{tooltipMessage: __call$(e,Y.Translation.Tooltips.Stalemate,[]) ,iconClassName:MS.Classes.CircleInfo}:null:null}function Wa(e){return`comment`in e}function Ga(e){return Array.isArray(e)&&(e[0]?.node!==void 0||e.length===0)}function Ka(e){return Wa(e.content)}function qa(e){return Ga(e.content)}function Ja(e,t,n){let r=e.slice();return r[18]= __get$(t,n) ,r}function Ya(e,t,n){let r=e.slice();return r[21]= __get$(t,n) ,r}function Xa(e){let t,n=Object.values(e[4].actions),r=[];for(let t=0;t<n.length;t+=1) __set$(r,t,Qa(Ya(e,n,t))) ;return{c(){for(let e=0;e<r.length;e+=1) __get$(r,e) .c();t=ie()},m(e,n){for(let t=0;t<r.length;t+=1) __get$(r,t) && __get$(r,t) .m(e,n);N(e,t,n)},p(e,i){if(i&816){n=Object.values(e[4].actions);let a;for(a=0;a<n.length;a+=1){let o=Ya(e,n,a); __get$(r,a) ? __get$(r,a) .p(o,i):( __set$(r,a,Qa(o)) , __get$(r,a) .c(), __get$(r,a) .m(t.parentNode,t))}for(;a<r.length;a+=1) __get$(r,a) .d(1);r.length=n.length}},d(e){te(r,e),e&&P(t)}}}function Za(e){let t,n=e[9](e[21].action)+``,r,i,a,o;function s(){return e[12](e[21])}return{c(){t=F(`span`),r=I(n),i=re(),R(t,`class`,j(KS.Classes.ActionName)+` svelte-wppjjr`)},m(e,n){N(e,t,n),M(t,r),M(t,i),a||=(o=L(t,`click`,s),!0)},p(t,i){e=t,i&16&&n!==(n=e[9](e[21].action)+``)&&oe(r,n)},d(e){e&&P(t),a=!1,o()}}}function Qa(e){let t=e[8](e[21].action),n,r=t&&Za(e);return{c(){r&&r.c(),n=ie()},m(e,t){r&&r.m(e,t),N(e,n,t)},p(e,i){i&16&&(t=e[8](e[21].action)),t?r?r.p(e,i):(r=Za(e),r.c(),r.m(n.parentNode,n)):r&&=(r.d(1),null)},d(e){r&&r.d(e),e&&P(n)}}}function $a(e){let t,n=e[18].display+``,r,i,a,o;function s(){return e[13](e[18])}return{c(){t=F(`span`),r=I(n),i=re(),R(t,`class`,j(`${KS.Classes.Annotation} ${wa({blank:e[18].action===void 0})}`)+` svelte-wppjjr`),R(t,`title`,e[18].meaning)},m(e,n){N(e,t,n),M(t,r),M(t,i),a||=(o=L(t,`click`,s),!0)},p(t,n){e=t},d(e){e&&P(t),a=!1,o()}}}function eo(e){let t,n,r,i,a,o,s,c,l,u=e[4].actions&&Xa(e),d=WS,f=[];for(let t=0;t<d.length;t+=1) __set$(f,t,$a(Ja(e,d,t))) ;return{c(){t=F(`div`),n=F(`div`),u&&u.c(),r=re(),i=F(`div`);for(let e=0;e<f.length;e+=1) __get$(f,e) .c();s=re(),R(n,`class`,j(KS.Classes.ActionsContainer)+` svelte-wppjjr`),R(i,`class`,j(KS.Classes.AnnotationsContainer)+` svelte-wppjjr`),R(t,`class`,j(KS.Classes.Component)+` svelte-wppjjr`),R(t,`style`,a=`
    left: ${Na(e[2],e[0])}px; 
    top: ${Ma(e[2],e[0])}px;
  `),be(()=>e[15].call(t))},m(a,d){N(a,t,d),M(t,n),u&&u.m(n,null),M(t,r),M(t,i);for(let e=0;e<f.length;e+=1) __get$(f,e) && __get$(f,e) .m(i,null);e[14](t),o=ue(t,e[15].bind(t)),N(a,s,d),c||=(l=L(document.body,`click`,e[7]),!0)},p(e, _hh$temp208 ){ var _hh$temp209=__arrayFrom$(_hh$temp208),r=_hh$temp209[0]; if(e[4].actions?u?u.p(e,r):(u=Xa(e),u.c(),u.m(n,null)):u&&=(u.d(1),null),r&32){d=WS;let t;for(t=0;t<d.length;t+=1){let n=Ja(e,d,t); __get$(f,t) ? __get$(f,t) .p(n,r):( __set$(f,t,$a(n)) , __get$(f,t) .c(), __get$(f,t) .m(i,null))}for(;t<f.length;t+=1) __get$(f,t) .d(1);f.length=d.length}r&5&&a!==(a=`
    left: ${Na(e[2],e[0])}px; 
    top: ${Ma(e[2],e[0])}px;
  `)&&R(t,`style`,a)},i:S,o:S,d(n){n&&P(t),u&&u.d(),te(f,n),e[14](null),o(),n&&P(s),c=!1,l()}}}function to(e,t,n){let r,i,a=S,o=()=>(a(),a=ee(l,e=>n(4,i=e)),l);e.$$.on_destroy.push(()=>a()); let _hh$temp210=t,s=_hh$temp210.selectedNodeKeys,_hh$temp211=t,c=_hh$temp211.selectedNodeRect,_hh$temp212=t,l=_hh$temp212.menuProps; o(); let _hh$temp213=t,u=_hh$temp213.game,_hh$temp214=ve(kb.Name),d=_hh$temp214.store,f=_hh$temp214.eventHandlers,_hh$temp215=d,p=_hh$temp215.translations; A(e,p,e=>n(16,r=e));let m={width:0,height:0},h=null;function g(e){h===null||h.contains(e.target)||f.closeContextMenu()}function _(e){let t=l.get().actions,n=s.get(),r= __get$(t,e,true) ?.isVisible;if(!n||!r)return!1;let i=u.getNodeByIds(n.ids);return i?r({node:i,game:u}):!1}function v(e){let t=l.get().actions,n=s.get(),i= __get$(t,e,true) ?.getDisplayName;if(!n||!i)return``;let a=u.getNodeByIds(n.ids);if(!a)return``;let o=i({node:a,game:u});return  __get$(r,o) ? __call$(r,o,[]) :o}let y=e=>f.handleContextMenuAction(e.action),b=e=>e.action!==void 0&&f.handleContextMenuAction(e.action,{data:{annotation:e.display}});function x(e){ __call$(ot,e?`unshift`:`push`,[()=>{h=e,n(3,h);}]) }function C(){m.width=this.clientWidth,m.height=this.clientHeight,n(2,m)}return e.$$set=e=>{`selectedNodeKeys`in e&&n(10,s=e.selectedNodeKeys),`selectedNodeRect`in e&&n(0,c=e.selectedNodeRect),`menuProps`in e&&o(n(1,l=e.menuProps)),`game`in e&&n(11,u=e.game)},[c,l,m,h,i,f,p,g,_,v,s,u,y,b,x,C]}function no(e){let t,n,r,i,a,o,s;return{c(){t=F(`div`),n=F(`span`),R(n,`class`,r=`${MS.Classes.IconFont} ${e[2]}`),R(t,`class`,MS.Classes.MoveInfoIcon),R(t,`data-tooltip`,e[0]),R(t,`data-tooltip-position`,i=e[4]&&e[6]()),R(t,`style`,a=`--tooltip-top:${e[4]&&e[4].y||1}px`)},m(r,i){N(r,t,i),M(t,n),e[7](t),o||=(s=[L(t,`click`,function(){D(e[1])&&e[1].apply(this,arguments)}),L(t,`mouseover`,e[5])],!0)},p(o, _hh$temp216 ){ var _hh$temp217=__arrayFrom$(_hh$temp216),s=_hh$temp217[0]; e=o,s&4&&r!==(r=`${MS.Classes.IconFont} ${e[2]}`)&&R(n,`class`,r),s&1&&R(t,`data-tooltip`,e[0]),s&16&&i!==(i=e[4]&&e[6]())&&R(t,`data-tooltip-position`,i),s&16&&a!==(a=`--tooltip-top:${e[4]&&e[4].y||1}px`)&&R(t,`style`,a)},i:S,o:S,d(n){n&&P(t),e[7](null),o=!1,E(s)}}}function ro(e,t,n){ let _hh$temp218=t,r=_hh$temp218.tooltipMessage,_hh$temp219=t,_hh$temp219$handleClick=_hh$temp219.handleClick,i=_hh$temp219$handleClick===void 0?()=>{}:_hh$temp219$handleClick,_hh$temp220=t,a=_hh$temp220.iconClassName,o,s; function c(){n(4,s=o.getBoundingClientRect())}function l(){if(s.y>window.innerHeight/2)return`top`}function u(e){ __call$(ot,e?`unshift`:`push`,[()=>{o=e,n(3,o);}]) }return e.$$set=e=>{`tooltipMessage`in e&&n(0,r=e.tooltipMessage),`handleClick`in e&&n(1,i=e.handleClick),`iconClassName`in e&&n(2,a=e.iconClassName)},[r,i,a,o,s,c,l,u]}function io(e){let t,n;return{c(){t=F(`span`),n=I(e[2]),R(t,`class`,`comment svelte-1ulf8x6`),R(t,`contenteditable`,`false`),R(t,`data-comment-node`,e[5]?`${e[5].ids.line}-${e[5].ids.move}`:void 0)},m(e,r){N(e,t,r),M(t,n)},p(e,t){t&4&&ce(n,e[2],`false`)},d(e){e&&P(t)}}}function ao(e){let t,n,r,i;return{c(){t=F(`span`),R(t,`class`,`comment svelte-1ulf8x6`),R(t,`placeholder`,n= __call$(e[4],Y.Translation.Prompt.AddComment,[]) ),R(t,`data-comment-node`,e[5]?`${e[5].ids.line}-${e[5].ids.move}`:void 0),R(t,`contenteditable`,`true`),e[2]===void 0&&be(()=>e[16].call(t))},m(n,a){N(n,t,a),e[15](t),e[2]!==void 0&&(t.innerText=e[2]),r||=(i=[L(t,`keydown`,e[10]),L(t,`focusout`,e[12]),L(t,`input`,e[16])],!0)},p(e,r){r&16&&n!==(n= __call$(e[4],Y.Translation.Prompt.AddComment,[]) )&&R(t,`placeholder`,n),r&4&&e[2]!==t.innerText&&(t.innerText=e[2])},d(n){n&&P(t),e[15](null),r=!1,E(i)}}}function oo(e){let t,n,r,i;function a(e,t){return e[3]?ao:io}let o=a(e),s=o(e);return{c(){t=F(`span`),s.c(),R(t,`class`,n=j(`${e[0]} ${e[8]}-comment`)+` svelte-1ulf8x6`)},m(n,a){N(n,t,a),s.m(t,null),r||=(i=[L(t,`click`,e[9]),L(t,`contextmenu`,e[11])],!0)},p(e, _hh$temp221 ){ var _hh$temp222=__arrayFrom$(_hh$temp221),r=_hh$temp222[0]; o===(o=a(e))&&s?s.p(e,r):(s.d(1),s=o(e),s&&(s.c(),s.m(t,null))),r&1&&n!==(n=j(`${e[0]} ${e[8]}-comment`)+` svelte-1ulf8x6`)&&R(t,`class`,n)},i:S,o:S,d(e){e&&P(t),s.d(),r=!1,E(i)}}}function so(e,t,n){ let r,i,_hh$temp223=t,a=_hh$temp223.comment,o=a.node,_hh$temp224=t,_hh$temp224$className=_hh$temp224.className,s=_hh$temp224$className===void 0?``:_hh$temp224$className,_hh$temp225=ve(kb.Name),c=_hh$temp225.store,l=_hh$temp225.eventHandlers,_hh$temp226=c,u=_hh$temp226.isActive,d=_hh$temp226.translations; A(e,u,e=>n(3,r=e)),A(e,d,e=>n(4,i=e));let f=a.isBeforeComment?`before`:`after`,p,m,h=a.comment??``,g=h;z(()=>(g===``&&p.focus(),()=>{clearTimeout(m)}));function _(){o&&l.clickComment(o.ids),p.focus()}function v(e){if(e.code===`Enter`){p.blur(),e.preventDefault();return}clearTimeout(m),m=window.setTimeout(()=>{l.updateComment(a,p.innerText)},LS.Constants.CommentUpdateDelay)}function y(e){o&&l.openContextMenu(o,e)}function b(e){g===``&&l.updateComment(a,void 0)}function x(e){ __call$(ot,e?`unshift`:`push`,[()=>{p=e,n(1,p);}]) }function S(){g=this.innerText,n(2,g),n(13,a),n(14,h)}return e.$$set=e=>{`comment`in e&&n(13,a=e.comment),`className`in e&&n(0,s=e.className)},e.$$.update=()=>{e.$$.dirty&24576&&a.comment!==h&&(n(14,h=a.comment),n(2,g=h))},[s,p,g,r,i,o,u,d,f,_,v,y,b,a,h,x,S]}function co(e){let t,n;return t=new YS({props:{comment:e[0].content,className:`move-list-row comment-row ${e[1]}`}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e, _hh$temp227 ){ var _hh$temp228=__arrayFrom$(_hh$temp227),n=_hh$temp228[0]; let r={};n&1&&(r.comment=e[0].content),n&2&&(r.className=`move-list-row comment-row ${e[1]}`),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function lo(e,t,n){let r;var i; let _hh$temp229=t,a=_hh$temp229.moveListRow; return e.$$set=e=>{`moveListRow`in e&&n(0,a=e.moveListRow)},e.$$.update=()=>{e.$$.dirty&5&&n(1,r=n(2,i=a.rowBgColor)!==null&&i!==void 0?i:`light-row`)},[a,r,i]}function uo( _hh$temp230 ){ var e=_hh$temp230.containerEl,t=_hh$temp230.moveListEl,n=_hh$temp230.nodeEl,_hh$temp230$position=_hh$temp230.position,r=_hh$temp230$position===void 0?`center`:_hh$temp230$position,_hh$temp230$onlyIfOutside=_hh$temp230.onlyIfOutside,i=_hh$temp230$onlyIfOutside===void 0?!1:_hh$temp230$onlyIfOutside; if(!t||!n)return;let a=e||t,o=a.getBoundingClientRect(),s=n.getBoundingClientRect();if(i&&o.top<=s.top&&o.bottom>=s.bottom)return;switch(r){case`nearest-edge`:l();break;case`top`:u();break;case`bottom`:d();break;case`center`:default:c()}function c(){let e=(o.bottom-o.top)/2,t=o.top-s.top+e;a.scrollTop-=t}function l(){s.top-o.top<o.bottom-s.bottom?u():d()}function u(){a.scrollTop-=o.top-s.top}function d(){a.scrollTop+=s.bottom-o.bottom}}function fo(e,t){if(!e||!t)return!1; let _hh$temp231=t,n=_hh$temp231.ids,r=_hh$temp231.hash; return e.ids.line===n.line&&e.ids.move===n.move&&e.hash[0]===r[0]&&e.hash[1]===r[1]}function po(e,t){let n=e?.annotation??``,r=e?.additionalAnnotation?.[0]??``;if(!((n||r)??``))return{inlineText:``};let i= __get$(ZS,n) ,a= __get$(ZS,r) ,o=i||a,s=``;return t?s=n?n+(r?` ${r}`:``):r:(!o||o!==a)&&(s=r),{...o,inlineText:s}}function mo(e){let t,n,r,i,a,o,s,c,l,u,d,f,p=!e[1]&&ho(e);a=new NS({props:{san:e[0].san,color:e[7],textType:e[13],annotation:e[3].inlineText}});let m=e[6]&&go(e);return{c(){t=F(`div`),p&&p.c(),n=re(),r=F(`span`),i=F(`span`),Ae(a.$$.fragment),s=re(),m&&m.c(),R(i,`class`,`move-node-text`),R(i,`style`,o=e[5]?`color: ${e[5]}`:null),R(r,`class`,`node-highlight-content`),de(r,`selected`,fo(e[0],e[4])),de(r,`limit-begin`,e[9](e[0].ids,e[8].begin)),de(r,`limit-focus`,e[9](e[0].ids,e[8].focus)),de(r,`limit-end`,e[9](e[0].ids,e[8].end)),R(t,`data-node`,c=`${e[0].ids.line}-${e[0].ids.move}`),R(t,`class`,l=`node ${e[7]}-move`)},m(o,c){N(o,t,c),p&&p.m(t,null),M(t,n),M(t,r),M(r,i),je(a,i,null),M(r,s),m&&m.m(r,null),e[32](r),u=!0,d||=(f=[L(t,`click`,e[20]),L(t,`contextmenu`,e[21]),L(t,`touchstart`,e[22]),L(t,`touchend`,e[23],{passive:!0})],!0)},p(e,s){e[1]?p&&=(p.d(1),null):p?p.p(e,s):(p=ho(e),p.c(),p.m(t,n));let d={};s[0]&1&&(d.san=e[0].san),s[0]&128&&(d.color=e[7]),s[0]&8&&(d.annotation=e[3].inlineText),a.$set(d),(!u||s[0]&32&&o!==(o=e[5]?`color: ${e[5]}`:null))&&R(i,`style`,o),e[6]?m?(m.p(e,s),s[0]&64&&V(m,1)):(m=go(e),m.c(),V(m,1),m.m(r,null)):m&&(Ce(),Te(m,1,1,()=>{m=null}),we()),(!u||s[0]&17)&&de(r,`selected`,fo(e[0],e[4])),(!u||s[0]&769)&&de(r,`limit-begin`,e[9](e[0].ids,e[8].begin)),(!u||s[0]&769)&&de(r,`limit-focus`,e[9](e[0].ids,e[8].focus)),(!u||s[0]&769)&&de(r,`limit-end`,e[9](e[0].ids,e[8].end)),(!u||s[0]&1&&c!==(c=`${e[0].ids.line}-${e[0].ids.move}`))&&R(t,`data-node`,c),(!u||s[0]&128&&l!==(l=`node ${e[7]}-move`))&&R(t,`class`,l)},i(e){u||=(V(a.$$.fragment,e),V(m),!0)},o(e){Te(a.$$.fragment,e),Te(m),u=!1},d(n){n&&P(t),p&&p.d(),Me(a),m&&m.d(),e[32](null),d=!1,E(f)}}}function ho(e){let t,n=Ln({path:e[3].icon,size:`18`})+``;return{c(){t=F(`span`),R(t,`class`,`node-annotation-icon`)},m(e,r){N(e,t,r),t.innerHTML=n},p(e,r){r[0]&8&&n!==(n=Ln({path:e[3].icon,size:`18`})+``)&&(t.innerHTML=n)},d(e){e&&P(t)}}}function go(e){let t,n,r=[e[6]],i={};for(let e=0;e<r.length;e+=1)i=C(i, __get$(r,e) );return t=new JS({props:i}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let i=n[0]&64?Oe(r,[ke(e[6])]):{};t.$set(i)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function _o(e){let t,n,r=e[0]&&mo(e);return{c(){r&&r.c(),t=ie()},m(e,i){r&&r.m(e,i),N(e,t,i),n=!0},p(e,n){e[0]?r?(r.p(e,n),n[0]&1&&V(r,1)):(r=mo(e),r.c(),V(r,1),r.m(t.parentNode,t)):r&&(Ce(),Te(r,1,1,()=>{r=null}),we())},i(e){n||=(V(r),!0)},o(e){Te(r),n=!1},d(e){r&&r.d(e),e&&P(t)}}}function vo(e,t,n){let r,i,a,o,s,c,l,u,d,f,p,m,h;var g; let _hh$temp232=t,_=_hh$temp232.node,_hh$temp233=t,_hh$temp233$isVariationPly=_hh$temp233.isVariationPly,v=_hh$temp233$isVariationPly===void 0?!1:_hh$temp233$isVariationPly,_hh$temp234=ve(kb.Name),y=_hh$temp234.game,b=(e,t)=>xa(e?.line,t?.line)&&xa(e?.move,t?.move),_hh$temp235=ve(kb.Name),x=_hh$temp235.store,S=_hh$temp235.eventHandlers,_hh$temp236=x,C=_hh$temp236.selectedNodeKeys,w=_hh$temp236.annotationsHidden,T=_hh$temp236.gameMetadata,E=_hh$temp236.textType,D=_hh$temp236.moveListEl,O=_hh$temp236.scrollContainer,k=_hh$temp236.translations,ee=_hh$temp236.nodeLimits,j=_hh$temp236.customColorsEnabled,M=_hh$temp236.finishedInitialLoad; A(e,C,e=>n(4,s=e)),A(e,w,e=>n(29,f=e)),A(e,T,e=>n(30,p=e)),A(e,D,e=>n(27,u=e)),A(e,O,e=>n(26,l=e)),A(e,k,e=>n(31,m=e)),A(e,ee,e=>n(8,h=e)),A(e,j,e=>n(28,d=e)),A(e,M,e=>n(25,c=e));let N,P=null;z(()=>{N&&fo(_,s)&&S.setSelectedNodeEl(N)});function te(e){!_?.ids||fo(_,s)||S.selectNode(_.ids,e)}function F(e){S.openContextMenu(_,e)}function ne(e){te(e),P=setTimeout(()=>{P=null,F(e)},500)}function I(){P&&clearTimeout(P)}function re(e){ __call$(ot,e?`unshift`:`push`,[()=>{N=e,n(2,N);}]) }return e.$$set=e=>{`node`in e&&n(0,_=e.node),`isVariationPly`in e&&n(1,v=e.isVariationPly)},e.$$.update=()=>{e.$$.dirty[0]&16777217&&n(7,r=ja(n(24,g=_?.color)!==null&&g!==void 0?g:1)),e.$$.dirty[0]&1073741827|e.$$.dirty[1]&1&&n(6,i=v?null:Ha({node:_,translations:m,gameMetadata:p,game:y})),e.$$.dirty[0]&536870915&&n(3,a=f?{inlineText:``}:po(_,v)),e.$$.dirty[0]&268435465&&n(5,o=d&&_?.customColor||a?.color),e.$$.dirty[0]&234881045&&N&&fo(_,s)&&(uo({nodeEl:N,moveListEl:u,containerEl:l,position:c?`nearest-edge`:`top`,onlyIfOutside:c}),c||M.set(!0),S.setSelectedNodeEl(N))},[_,v,N,a,s,o,i,r,h,b,C,w,T,E,D,O,k,ee,j,M,te,F,ne,I,g,c,l,u,d,f,p,m,re]}function yo(e){return e.commands?.timestamp?parseInt(e.commands.timestamp,10):null}function bo(e){let t=Math.ceil(e/10),n=Math.floor(t/(3600*24)),r=Math.floor(t%(3600*24)/3600),i=Math.ceil(t%3600/60);return i===60&&(i=0,r+=1),r===24&&(r=0,n+=1),{days:n,hours:r,minutes:i}}function xo(e,t){ let _hh$temp237=bo(e),n=_hh$temp237.days,r=_hh$temp237.hours,i=_hh$temp237.minutes,a={days:r>0||i>0?`, `:``,hours:i>0?`, `:``}; return`${n>0?`${ __call$(t,Y.Translation.Plural.NumberOfDays,[n]) }${a.days}`:``}${r>0?`${ __call$(t,Y.Translation.Plural.NumberOfHours,[r]) }${a.hours}`:``}${i>0?`${ __call$(t,Y.Translation.Plural.NumberOfMinutes,[i]) }`:``}`}function So(e,t){ let _hh$temp238=bo(e),n=_hh$temp238.days,r=_hh$temp238.hours,i=_hh$temp238.minutes; return n?n>0?`${ __call$(t,Y.Translation.Plural.NumberOfDays,[n]) }`:``:r?r>0?`${ __call$(t,Y.Translation.Plural.NumberOfHours,[r]) }`:``:i>0?`${ __call$(t,Y.Translation.Plural.NumberOfMinutes,[i]) }`:``}function Co(e){let t=Math.floor(e/600),n=((e-t*600)/10).toFixed(1);return t===0?n:`${t}:${`0${n}`.substr(-4)}`}function wo(e){let t=[...e].reduce((e,t)=>{if(!t)return e;let n=yo(t);return n&&e.push(n),e},[]);if(t.length!==0)return Math.max(...t)}function To( _hh$temp239 ){ var e=_hh$temp239.displayTimeInClockFormat,t=_hh$temp239.timestamp,n=_hh$temp239.translations; let r={title:e?void 0:xo(t,n),value:e?Co(t):So(t,n)};return{timestamp:t,width:r.value.length*IS,value:r.value}}function Eo(e,t){let n=e/(ta(t)/40);return $S*2/Math.PI*Math.atan(n/3)}function Do(e){let t,n=e[3].value+``,r,i,a,o;return{c(){t=F(`div`),r=I(n),R(t,`data-move-list-el`,`timestamp`),R(t,`data-ply`,e[2]),R(t,`data-time`,i=e[3].timestamp),R(t,`class`,a=`time-${e[1]}`),R(t,`style`,o=`
    ${LS.CSSVariables.TimeValue}: ${e[3].timestamp}; 
    ${e[4]?`${LS.CSSVariables.TimeBarWidth}: ${Eo(Number(e[0]),e[4])}px;`:`${LS.CSSVariables.TimeBarWidth}: ${e[3].width}px;`}
  `)},m(e,n){N(e,t,n),M(t,r)},p(e, _hh$temp240 ){ var _hh$temp241=__arrayFrom$(_hh$temp240),s=_hh$temp241[0]; s&8&&n!==(n=e[3].value+``)&&oe(r,n),s&4&&R(t,`data-ply`,e[2]),s&8&&i!==(i=e[3].timestamp)&&R(t,`data-time`,i),s&2&&a!==(a=`time-${e[1]}`)&&R(t,`class`,a),s&25&&o!==(o=`
    ${LS.CSSVariables.TimeValue}: ${e[3].timestamp}; 
    ${e[4]?`${LS.CSSVariables.TimeBarWidth}: ${Eo(Number(e[0]),e[4])}px;`:`${LS.CSSVariables.TimeBarWidth}: ${e[3].width}px;`}
  `)&&R(t,`style`,o)},i:S,o:S,d(e){e&&P(t)}}}function Oo(e,t,n){ let r,i,a,_hh$temp242=t,o=_hh$temp242.timestamp,_hh$temp243=t,s=_hh$temp243.color,_hh$temp244=t,c=_hh$temp244.ply,_hh$temp245=t,l=_hh$temp245.displayTimeInClockFormat,_hh$temp246=ve(kb.Name),u=_hh$temp246.store,_hh$temp247=u,d=_hh$temp247.baseTime,f=_hh$temp247.translations; return A(e,d,e=>n(4,a=e)),A(e,f,e=>n(8,i=e)),e.$$set=e=>{`timestamp`in e&&n(0,o=e.timestamp),`color`in e&&n(1,s=e.color),`ply`in e&&n(2,c=e.ply),`displayTimeInClockFormat`in e&&n(7,l=e.displayTimeInClockFormat)},e.$$.update=()=>{e.$$.dirty&385&&n(3,r=To({displayTimeInClockFormat:l,timestamp:Number(o),translations:i}))},[o,s,c,r,a,d,f,l,i]}function ko(e,t=1){let n=e?.moveNumber??0,r=e?.color,i=n%2==0&&r===J.ColorsAsNumbers.Black||n%2!=0&&r===J.ColorsAsNumbers.White;return t+Math.floor(n/2)+(i&&r===J.ColorsAsNumbers.White?1:0)}function Ao(e){let t,n,r;return{c(){t=F(`span`),n=I(`--`),R(t,`class`,r=`main-line-ply ${e[0]} empty`)},m(e,r){N(e,t,r),M(t,n)},p(e, _hh$temp248 ){ var _hh$temp249=__arrayFrom$(_hh$temp248),n=_hh$temp249[0]; n&1&&r!==(r=`main-line-ply ${e[0]} empty`)&&R(t,`class`,r)},i:S,o:S,d(e){e&&P(t)}}}function jo(e,t,n){ let _hh$temp250=t,r=_hh$temp250.color; return e.$$set=e=>{`color`in e&&n(0,r=e.color)},[r]}function Mo(e,t,n){let r=e.slice();return r[10]= __get$(t,n) ,r}function No(e,t,n){let r=e.slice();return r[10]= __get$(t,n) ,r}function Po(e){let t,n;return t=new tC({props:{color:`white`}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function Fo(e){let t,n;return t=new tC({props:{color:`black`}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function Io(e){let t=e[4]&&xa(e[10].node.color,2),n,r,i,a,o,s=e[4]&&e[5](e[10])&&xa(e[10].node.color,1),c,l,u=t&&Po();i=new QS({props:{node:e[10].node}});let d=s&&Fo();return{c(){u&&u.c(),n=re(),r=F(`span`),Ae(i.$$.fragment),o=re(),d&&d.c(),c=ie(),R(r,`class`,a=`main-line-ply ${ja(e[10].node.color)}`)},m(e,t){u&&u.m(e,t),N(e,n,t),N(e,r,t),je(i,r,null),N(e,o,t),d&&d.m(e,t),N(e,c,t),l=!0},p(e,o){o&17&&(t=e[4]&&xa(e[10].node.color,2)),t?u?o&17&&V(u,1):(u=Po(),u.c(),V(u,1),u.m(n.parentNode,n)):u&&(Ce(),Te(u,1,1,()=>{u=null}),we());let f={};o&1&&(f.node=e[10].node),i.$set(f),(!l||o&1&&a!==(a=`main-line-ply ${ja(e[10].node.color)}`))&&R(r,`class`,a),o&17&&(s=e[4]&&e[5](e[10])&&xa(e[10].node.color,1)),s?d?o&17&&V(d,1):(d=Fo(),d.c(),V(d,1),d.m(c.parentNode,c)):d&&(Ce(),Te(d,1,1,()=>{d=null}),we())},i(e){l||=(V(u),V(i.$$.fragment,e),V(d),!0)},o(e){Te(u),Te(i.$$.fragment,e),Te(d),l=!1},d(e){u&&u.d(e),e&&P(n),e&&P(r),Me(i),e&&P(o),d&&d.d(e),e&&P(c)}}}function Lo(e){let t,n;return t=new eC({props:{timestamp:yo(e[10].node),color:ja(e[10].node.color),ply:e[10].node.ply,displayTimeInClockFormat:e[1]}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n&1&&(r.timestamp=yo(e[10].node)),n&1&&(r.color=ja(e[10].node.color)),n&1&&(r.ply=e[10].node.ply),n&2&&(r.displayTimeInClockFormat=e[1]),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function Ro(e){let t=e[6](e[10]),n,r,i=t&&Lo(e);return{c(){i&&i.c(),n=ie()},m(e,t){i&&i.m(e,t),N(e,n,t),r=!0},p(e,r){r&1&&(t=e[6](e[10])),t?i?(i.p(e,r),r&1&&V(i,1)):(i=Lo(e),i.c(),V(i,1),i.m(n.parentNode,n)):i&&(Ce(),Te(i,1,1,()=>{i=null}),we())},i(e){r||=(V(i),!0)},o(e){Te(i),r=!1},d(e){i&&i.d(e),e&&P(n)}}}function zo(e){let t,n,r,i,a,o,s,c,l=e[0].content,u=[];for(let t=0;t<l.length;t+=1) __set$(u,t,Io(No(e,l,t))) ;let d=e=>Te( __get$(u,e) ,1,1,()=>{ __set$(u,e,null) }),f=e[0].content,p=[];for(let t=0;t<f.length;t+=1) __set$(p,t,Ro(Mo(e,f,t))) ;let m=e=>Te( __get$(p,e) ,1,1,()=>{ __set$(p,e,null) });return{c(){t=F(`div`),n=F(`span`),r=I(e[3]),i=I(`.`),a=re();for(let e=0;e<u.length;e+=1) __get$(u,e) .c();o=re();for(let e=0;e<p.length;e+=1) __get$(p,e) .c();R(n,`class`,`move-number`),R(t,`class`,s=`main-line-row move-list-row ${e[2]}`),R(t,`data-whole-move-number`,e[3])},m(e,s){N(e,t,s),M(t,n),M(n,r),M(n,i),M(t,a);for(let e=0;e<u.length;e+=1) __get$(u,e) && __get$(u,e) .m(t,null);M(t,o);for(let e=0;e<p.length;e+=1) __get$(p,e) && __get$(p,e) .m(t,null);c=!0},p(e, _hh$temp251 ){ var _hh$temp252=__arrayFrom$(_hh$temp251),n=_hh$temp252[0]; if((!c||n&8)&&oe(r,e[3]),n&49){l=e[0].content;let r;for(r=0;r<l.length;r+=1){let i=No(e,l,r); __get$(u,r) ?( __get$(u,r) .p(i,n),V( __get$(u,r) ,1)):( __set$(u,r,Io(i)) , __get$(u,r) .c(),V( __get$(u,r) ,1), __get$(u,r) .m(t,o))}for(Ce(),r=l.length;r<u.length;r+=1)d(r);we()}if(n&67){f=e[0].content;let r;for(r=0;r<f.length;r+=1){let i=Mo(e,f,r); __get$(p,r) ?( __get$(p,r) .p(i,n),V( __get$(p,r) ,1)):( __set$(p,r,Ro(i)) , __get$(p,r) .c(),V( __get$(p,r) ,1), __get$(p,r) .m(t,null))}for(Ce(),r=f.length;r<p.length;r+=1)m(r);we()}(!c||n&4&&s!==(s=`main-line-row move-list-row ${e[2]}`))&&R(t,`class`,s),(!c||n&8)&&R(t,`data-whole-move-number`,e[3])},i(e){if(!c){for(let e=0;e<l.length;e+=1)V( __get$(u,e) );for(let e=0;e<f.length;e+=1)V( __get$(p,e) );c=!0}},o(e){u=u.filter(Boolean);for(let e=0;e<u.length;e+=1)Te( __get$(u,e) );p=p.filter(Boolean);for(let e=0;e<p.length;e+=1)Te( __get$(p,e) );c=!1},d(e){e&&P(t),te(u,e),te(p,e)}}}function Bo(e,t,n){let r,i,a;var o; let _hh$temp253=t,s=_hh$temp253.moveListRow,_hh$temp254=t,c=_hh$temp254.displayTimeInClockFormat,_hh$temp255=t,l=_hh$temp255.showTimestamps,_hh$temp256=ve(kb.Name),u=_hh$temp256.game; function d(e){let t=u.getRawLines()[0];return!e?.node||!t?!1:t.length>e.node.ids.move+1}function f(e){return l&&e?.node?.commands?.timestamp!==void 0}return e.$$set=e=>{`moveListRow`in e&&n(0,s=e.moveListRow),`displayTimeInClockFormat`in e&&n(1,c=e.displayTimeInClockFormat),`showTimestamps`in e&&n(7,l=e.showTimestamps)},e.$$.update=()=>{e.$$.dirty&1&&n(4,r=s.content.length===1),e.$$.dirty&1&&n(3,i=ko(s.content[0].node,u.getStartingMoveNumber())),e.$$.dirty&257&&n(2,a=n(8,o=s.rowBgColor)!==null&&o!==void 0?o:`light-row`)},[s,c,a,i,r,d,f,l,o]}function Vo(e,t,n){let r=e.slice();return r[6]= __get$(t,n) ,r[8]=n,r}function Ho(e,t,n){let r=e.slice();return r[9]= __get$(t,n) ,r}function Uo(e){let t,n;return t=new YS({props:{comment:{node:e[6].node,comment:e[6].beforeComment,isBeforeComment:!0}}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n&1&&(r.comment={node:e[6].node,comment:e[6].beforeComment,isBeforeComment:!0}),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function Wo(e){let t,n=ko(e[6].node,e[2].getStartingMoveNumber())+``,r,i=e[4](e[6])?`.`:`...`,a;return{c(){t=F(`span`),r=I(n),a=I(i),R(t,`class`,`move-number ${e[8]===0&&`start`}`)},m(e,n){N(e,t,n),M(t,r),M(t,a)},p(e,t){t&1&&n!==(n=ko(e[6].node,e[2].getStartingMoveNumber())+``)&&oe(r,n),t&1&&i!==(i=e[4](e[6])?`.`:`...`)&&oe(a,i)},d(e){e&&P(t)}}}function Go(e){let t,n;return t=new YS({props:{comment:{node:e[6].node,comment:e[6].afterComment}}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n&1&&(r.comment={node:e[6].node,comment:e[6].afterComment}),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function Ko(e){let t,n,r=e[6].inlineVariations,i=[];for(let t=0;t<r.length;t+=1) __set$(i,t,qo(Ho(e,r,t))) ;let a=e=>Te( __get$(i,e) ,1,1,()=>{ __set$(i,e,null) });return{c(){for(let e=0;e<i.length;e+=1) __get$(i,e) .c();t=ie()},m(e,r){for(let t=0;t<i.length;t+=1) __get$(i,t) && __get$(i,t) .m(e,r);N(e,t,r),n=!0},p(e,n){if(n&1){r=e[6].inlineVariations;let o;for(o=0;o<r.length;o+=1){let a=Ho(e,r,o); __get$(i,o) ?( __get$(i,o) .p(a,n),V( __get$(i,o) ,1)):( __set$(i,o,qo(a)) , __get$(i,o) .c(),V( __get$(i,o) ,1), __get$(i,o) .m(t.parentNode,t))}for(Ce(),o=r.length;o<i.length;o+=1)a(o);we()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)V( __get$(i,e) );n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)Te( __get$(i,e) );n=!1},d(e){te(i,e),e&&P(t)}}}function qo(e){let t,n,r,i,a;return r=new rC({props:{moveListNodes:e[9]}}),{c(){t=F(`i`),n=I(`(`),Ae(r.$$.fragment),i=I(`)`)},m(e,o){N(e,t,o),M(t,n),je(r,t,null),M(t,i),a=!0},p(e,t){let n={};t&1&&(n.moveListNodes=e[9]),r.$set(n)},i(e){a||=(V(r.$$.fragment,e),!0)},o(e){Te(r.$$.fragment,e),a=!1},d(e){e&&P(t),Me(r)}}}function Jo(e){let t,n,r=e[8]===0||e[4](e[6]),i,a,o,s,c,l,u=e[6].beforeComment!==void 0&&!e[1]&&Uo(e),d=r&&Wo(e);a=new QS({props:{node:e[6].node,isVariationPly:!0}});let f=e[6].afterComment!==void 0&&!e[1]&&Go(e),p=e[6].inlineVariations&&Ko(e);return{c(){u&&u.c(),t=re(),n=F(`span`),d&&d.c(),i=re(),Ae(a.$$.fragment),o=re(),f&&f.c(),s=re(),p&&p.c(),c=ie(),R(n,`class`,`inline-move`)},m(e,r){u&&u.m(e,r),N(e,t,r),N(e,n,r),d&&d.m(n,null),M(n,i),je(a,n,null),N(e,o,r),f&&f.m(e,r),N(e,s,r),p&&p.m(e,r),N(e,c,r),l=!0},p(e,o){e[6].beforeComment!==void 0&&!e[1]?u?(u.p(e,o),o&3&&V(u,1)):(u=Uo(e),u.c(),V(u,1),u.m(t.parentNode,t)):u&&(Ce(),Te(u,1,1,()=>{u=null}),we()),o&1&&(r=e[8]===0||e[4](e[6])),r?d?d.p(e,o):(d=Wo(e),d.c(),d.m(n,i)):d&&=(d.d(1),null);let l={};o&1&&(l.node=e[6].node),a.$set(l),e[6].afterComment!==void 0&&!e[1]?f?(f.p(e,o),o&3&&V(f,1)):(f=Go(e),f.c(),V(f,1),f.m(s.parentNode,s)):f&&(Ce(),Te(f,1,1,()=>{f=null}),we()),e[6].inlineVariations?p?(p.p(e,o),o&1&&V(p,1)):(p=Ko(e),p.c(),V(p,1),p.m(c.parentNode,c)):p&&(Ce(),Te(p,1,1,()=>{p=null}),we())},i(e){l||=(V(u),V(a.$$.fragment,e),V(f),V(p),!0)},o(e){Te(u),Te(a.$$.fragment,e),Te(f),Te(p),l=!1},d(e){u&&u.d(e),e&&P(t),e&&P(n),d&&d.d(),Me(a),e&&P(o),f&&f.d(e),e&&P(s),p&&p.d(e),e&&P(c)}}}function Yo(e){let t,n,r=e[0],i=[];for(let t=0;t<r.length;t+=1) __set$(i,t,Jo(Vo(e,r,t))) ;let a=e=>Te( __get$(i,e) ,1,1,()=>{ __set$(i,e,null) });return{c(){t=F(`span`);for(let e=0;e<i.length;e+=1) __get$(i,e) .c();R(t,`class`,`variation-line`)},m(e,r){N(e,t,r);for(let e=0;e<i.length;e+=1) __get$(i,e) && __get$(i,e) .m(t,null);n=!0},p(e, _hh$temp257 ){ var _hh$temp258=__arrayFrom$(_hh$temp257),n=_hh$temp258[0]; if(n&23){r=e[0];let o;for(o=0;o<r.length;o+=1){let a=Vo(e,r,o); __get$(i,o) ?( __get$(i,o) .p(a,n),V( __get$(i,o) ,1)):( __set$(i,o,Jo(a)) , __get$(i,o) .c(),V( __get$(i,o) ,1), __get$(i,o) .m(t,null))}for(Ce(),o=r.length;o<i.length;o+=1)a(o);we()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)V( __get$(i,e) );n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)Te( __get$(i,e) );n=!1},d(e){e&&P(t),te(i,e)}}}function Xo(e,t,n){ let r,_hh$temp259=t,i=_hh$temp259.moveListNodes,_hh$temp260=ve(kb.Name),a=_hh$temp260.store,o=_hh$temp260.game,_hh$temp261=a,s=_hh$temp261.commentsHidden; A(e,s,e=>n(1,r=e));function c(e){return e.node.color===J.ColorsAsNumbers.White}return e.$$set=e=>{`moveListNodes`in e&&n(0,i=e.moveListNodes)},[i,r,o,s,c]}function Zo(e,t,n){let r=e.slice();return r[9]= __get$(t,n) ,r[11]=n,r}function Qo(e){let t;return{c(){t=F(`div`),R(t,`class`,`vertical-line`),de(t,`trim-top`,es(e[11]+1,e[0].depth)),de(t,`trim-bottom`,ts(e[11]+1,e[0].depth,e[3]))},m(e,n){N(e,t,n)},p(e,n){n&1&&de(t,`trim-top`,es(e[11]+1,e[0].depth)),n&9&&de(t,`trim-bottom`,ts(e[11]+1,e[0].depth,e[3]))},d(e){e&&P(t)}}}function $o(e){let t,n,r,i,a,o,s,c=Array(e[0].depth),l=[];for(let t=0;t<c.length;t+=1) __set$(l,t,Qo(Zo(e,c,t))) ;return a=new rC({props:{moveListNodes:e[0].content}}),{c(){t=F(`div`),n=F(`div`);for(let e=0;e<l.length;e+=1) __get$(l,e) .c();r=re(),i=F(`div`),Ae(a.$$.fragment),R(n,`class`,`variation-row-indent`),R(i,`class`,`variation-content`),R(t,`class`,o=`variation-row move-list-row ${e[2]}`)},m(e,o){N(e,t,o),M(t,n);for(let e=0;e<l.length;e+=1) __get$(l,e) && __get$(l,e) .m(n,null);M(t,r),M(t,i),je(a,i,null),s=!0},p(e, _hh$temp262 ){ var _hh$temp263=__arrayFrom$(_hh$temp262),r=_hh$temp263[0]; if(r&9){c=Array(e[0].depth);let t;for(t=0;t<c.length;t+=1){let i=Zo(e,c,t); __get$(l,t) ? __get$(l,t) .p(i,r):( __set$(l,t,Qo(i)) , __get$(l,t) .c(), __get$(l,t) .m(n,null))}for(;t<l.length;t+=1) __get$(l,t) .d(1);l.length=c.length}let i={};r&1&&(i.moveListNodes=e[0].content),a.$set(i),(!s||r&4&&o!==(o=`variation-row move-list-row ${e[2]}`))&&R(t,`class`,o)},i(e){s||=(V(a.$$.fragment,e),!0)},o(e){Te(a.$$.fragment,e),s=!1},d(e){e&&P(t),te(l,e),Me(a)}}}function es(e,t){return e===t}function ts(e,t,n){return n<=t&&e>=n}function ns(e,t,n){let r,i,a,o=S,s=()=>(o(),o=ee(p,e=>n(8,a=e)),p);e.$$.on_destroy.push(()=>o());var c,l,u; let _hh$temp264=t,d=_hh$temp264.moveListRow,_hh$temp265=t,f=_hh$temp265.rowIndex,_hh$temp266=t,p=_hh$temp266.moveListRows; return s(),e.$$set=e=>{`moveListRow`in e&&n(0,d=e.moveListRow),`rowIndex`in e&&n(4,f=e.rowIndex),`moveListRows`in e&&s(n(1,p=e.moveListRows))},e.$$.update=()=>{e.$$.dirty&368&&n(3,r=n(6,l=n(5,c= __get$(a,f+1) )===null||c===void 0?void 0:c.depth)!==null&&l!==void 0?l:0),e.$$.dirty&129&&n(2,i=n(7,u=d.rowBgColor)!==null&&u!==void 0?u:`light-row`)},[d,p,i,r,f,c,l,u,a]}function rs(e,t,n){let r=e.slice();return r[41]= __get$(t,n) ,r[43]=n,r}function is(e){let t,n,r,i,a=[ss,os],o=[];function s(e,t){return e[41].depth===0?0:e[12]?-1:1}return~(t=s(e))&&(n= __set$(o,t,__call$(a,t,[e])) ),{c(){n&&n.c(),r=ie()},m(e,n){~t&& __get$(o,t) .m(e,n),N(e,r,n),i=!0},p(e,i){let c=t;t=s(e),t===c?~t&& __get$(o,t) .p(e,i):(n&&(Ce(),Te( __get$(o,c) ,1,1,()=>{ __set$(o,c,null) }),we()),~t?(n= __get$(o,t) ,n?n.p(e,i):(n= __set$(o,t,__call$(a,t,[e])) ,n.c()),V(n,1),n.m(r.parentNode,r)):n=null)},i(e){i||=(V(n),!0)},o(e){Te(n),i=!1},d(e){~t&& __get$(o,t) .d(e),e&&P(r)}}}function as(e){let t,n,r=!e[11]&&cs(e);return{c(){r&&r.c(),t=ie()},m(e,i){r&&r.m(e,i),N(e,t,i),n=!0},p(e,n){e[11]?r&&(Ce(),Te(r,1,1,()=>{r=null}),we()):r?(r.p(e,n),n[0]&2048&&V(r,1)):(r=cs(e),r.c(),V(r,1),r.m(t.parentNode,t))},i(e){n||=(V(r),!0)},o(e){Te(r),n=!1},d(e){r&&r.d(e),e&&P(t)}}}function os(e){let t,n;return t=new iC({props:{moveListRow:e[41],rowIndex:e[43],moveListRows:e[16]}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n[0]&1024&&(r.moveListRow=e[41]),n[0]&1024&&(r.rowIndex=e[43]),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function ss(e){let t,n;return t=new nC({props:{moveListRow:e[41],showTimestamps:e[3],displayTimeInClockFormat:e[2]}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n[0]&1024&&(r.moveListRow=e[41]),n[0]&8&&(r.showTimestamps=e[3]),n[0]&4&&(r.displayTimeInClockFormat=e[2]),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function cs(e){let t,n;return t=new XS({props:{moveListRow:e[41]}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n[0]&1024&&(r.moveListRow=e[41]),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function ls(e,t){let n,r,i,a,o,s,c,l=[as,is],u=[];function d(e,t){return t[0]&1024&&(r=null),t[0]&1024&&(i=null),r??=!!Ka(e[41]),r?0:(i??=!!qa(e[41]),i?1:-1)}return~(a=d(t,[-1,-1]))&&(o= __set$(u,a,__call$(l,a,[t])) ),{key:e,first:null,c(){n=ie(),o&&o.c(),s=ie(),this.first=n},m(e,t){N(e,n,t),~a&& __get$(u,a) .m(e,t),N(e,s,t),c=!0},p(e,n){t=e;let r=a;a=d(t,n),a===r?~a&& __get$(u,a) .p(t,n):(o&&(Ce(),Te( __get$(u,r) ,1,1,()=>{ __set$(u,r,null) }),we()),~a?(o= __get$(u,a) ,o?o.p(t,n):(o= __set$(u,a,__call$(l,a,[t])) ,o.c()),V(o,1),o.m(s.parentNode,s)):o=null)},i(e){c||=(V(o),!0)},o(e){Te(o),c=!1},d(e){e&&P(n),~a&& __get$(u,a) .d(e),e&&P(s)}}}function us(e){let t,n,r,i,a,o=e[6]&&ds(e);return{c(){t=F(`div`),n=F(`span`),r=I(e[13]),i=re(),o&&o.c(),R(n,`class`,`game-result`),R(t,`class`,`main-line-row move-list-row result-row`)},m(e,s){N(e,t,s),M(t,n),M(n,r),M(n,i),o&&o.m(n,null),a=!0},p(e,t){(!a||t[0]&8192)&&oe(r,e[13]),e[6]?o?(o.p(e,t),t[0]&64&&V(o,1)):(o=ds(e),o.c(),V(o,1),o.m(n,null)):o&&(Ce(),Te(o,1,1,()=>{o=null}),we())},i(e){a||=(V(o),!0)},o(e){Te(o),a=!1},d(e){e&&P(t),o&&o.d()}}}function ds(e){let t,n,r=[e[6]],i={};for(let e=0;e<r.length;e+=1)i=C(i, __get$(r,e) );return t=new JS({props:i}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let i=n[0]&64?Oe(r,[ke(e[6])]):{};t.$set(i)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function fs(e){let t,n;return t=new qS({props:{menuProps:e[24],selectedNodeKeys:e[17],selectedNodeRect:e[5],game:e[4]}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n[0]&32&&(r.selectedNodeRect=e[5]),n[0]&16&&(r.game=e[4]),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function ps(e){let t,n;return t=new FS({props:{variationPopover:e[25],selectedNodeRect:e[5],eventHandlers:e[0],textType:e[19]}}),{c(){Ae(t.$$.fragment)},m(e,r){je(t,e,r),n=!0},p(e,n){let r={};n[0]&32&&(r.selectedNodeRect=e[5]),n[0]&1&&(r.eventHandlers=e[0]),t.$set(r)},i(e){n||=(V(t.$$.fragment,e),!0)},o(e){Te(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function ms(e){let t,n=[],r=new Map,i,a,o,s,c,l,u=e[10],d=e=>e[41].renderKey;for(let t=0;t<u.length;t+=1){let i=rs(e,u,t),a=d(i);r.set(a, __set$(n,t,ls(a,i)) )}let f=e[13]&&us(e),p=e[14].isOpen&&e[14].enabled&&e[5]&&fs(e),m=e[15].isOpen&&e[5]&&ps(e);return{c(){t=F(`div`);for(let e=0;e<n.length;e+=1) __get$(n,e) .c();i=re(),f&&f.c(),o=re(),p&&p.c(),s=re(),m&&m.c(),c=ie(),R(t,`style`,a=`
    ${LS.CSSVariables.MaxMoveTimeTaken}: ${e[8]}; 
    ${LS.CSSVariables.TimestampWidth}: ${e[9]}px`),de(t,`timestamps-with-base-time`,e[7]!==void 0),de(t,`toggle-timestamps`,e[1])},m(e,r){N(e,t,r);for(let e=0;e<n.length;e+=1) __get$(n,e) && __get$(n,e) .m(t,null);M(t,i),f&&f.m(t,null),N(e,o,r),p&&p.m(e,r),N(e,s,r),m&&m.m(e,r),N(e,c,r),l=!0},p(e,o){o[0]&72716&&(u=e[10],Ce(),n=De(n,o,d,1,e,u,r,t,Ee,ls,i,rs),we()),e[13]?f?(f.p(e,o),o[0]&8192&&V(f,1)):(f=us(e),f.c(),V(f,1),f.m(t,null)):f&&(Ce(),Te(f,1,1,()=>{f=null}),we()),(!l||o[0]&768&&a!==(a=`
    ${LS.CSSVariables.MaxMoveTimeTaken}: ${e[8]}; 
    ${LS.CSSVariables.TimestampWidth}: ${e[9]}px`))&&R(t,`style`,a),(!l||o[0]&128)&&de(t,`timestamps-with-base-time`,e[7]!==void 0),(!l||o[0]&2)&&de(t,`toggle-timestamps`,e[1]),e[14].isOpen&&e[14].enabled&&e[5]?p?(p.p(e,o),o[0]&16416&&V(p,1)):(p=fs(e),p.c(),V(p,1),p.m(s.parentNode,s)):p&&(Ce(),Te(p,1,1,()=>{p=null}),we()),e[15].isOpen&&e[5]?m?(m.p(e,o),o[0]&32800&&V(m,1)):(m=ps(e),m.c(),V(m,1),m.m(c.parentNode,c)):m&&(Ce(),Te(m,1,1,()=>{m=null}),we())},i(e){if(!l){for(let e=0;e<u.length;e+=1)V( __get$(n,e) );V(f),V(p),V(m),l=!0}},o(e){for(let e=0;e<n.length;e+=1)Te( __get$(n,e) );Te(f),Te(p),Te(m),l=!1},d(e){e&&P(t);for(let e=0;e<n.length;e+=1) __get$(n,e) .d();f&&f.d(),e&&P(o),p&&p.d(e),e&&P(s),m&&m.d(e),e&&P(c)}}}function hs(e,t,n){ let r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,_hh$temp267=t,b=_hh$temp267.data,_hh$temp268=t,x=_hh$temp268.eventHandlers,_hh$temp269=t,S=_hh$temp269.hideTimestampText,_hh$temp270=t,C=_hh$temp270.displayTimeInClockFormat,_hh$temp271=t,w=_hh$temp271.showTimestamps,_hh$temp272=t,T=_hh$temp272.game,_hh$temp273=b,E=_hh$temp273.moveListRows,D=_hh$temp273.selectedNodeKeys,O=_hh$temp273.selectedNodeEl,k=_hh$temp273.textType,ee=_hh$temp273.result,j=_hh$temp273.maxTimestampWidth,M=_hh$temp273.largestTimestamp,N=_hh$temp273.baseTime,P=_hh$temp273.contextMenu,te=_hh$temp273.variationPopover,F=_hh$temp273.gameMetadata,ne=_hh$temp273.commentsHidden,I=_hh$temp273.variationsHidden,re=_hh$temp273.translations,ie=_hh$temp273.scrollContainer,L=_hh$temp273.moveListEl; A(e,E,e=>n(10,m=e)),A(e,O,e=>n(33,o=e)),A(e,ee,e=>n(13,_=e)),A(e,j,e=>n(9,p=e)),A(e,M,e=>n(8,f=e)),A(e,N,e=>n(7,d=e)),A(e,P,e=>n(14,v=e)),A(e,te,e=>n(15,y=e)),A(e,F,e=>n(36,l=e)),A(e,ne,e=>n(11,h=e)),A(e,I,e=>n(12,g=e)),A(e,re,e=>n(37,u=e)),A(e,ie,e=>n(35,c=e)),A(e,L,e=>n(34,s=e)),_e(kb.Name,{store:b,eventHandlers:x,game:T});let R=new ResizeObserver(ae);z(()=>(R.observe(a),a.addEventListener(`scroll`,ae),window.addEventListener(`scroll`,ae),()=>{R.disconnect(),a.removeEventListener(`scroll`,ae),window.removeEventListener(`scroll`,ae)}));function ae(){n(5,i=o?.getBoundingClientRect())}return e.$$set=e=>{`data`in e&&n(32,b=e.data),`eventHandlers`in e&&n(0,x=e.eventHandlers),`hideTimestampText`in e&&n(1,S=e.hideTimestampText),`displayTimeInClockFormat`in e&&n(2,C=e.displayTimeInClockFormat),`showTimestamps`in e&&n(3,w=e.showTimestamps),`game`in e&&n(4,T=e.game)},e.$$.update=()=>{e.$$.dirty[1]&96&&n(6,r=Ua({translations:u,gameMetadata:l})),e.$$.dirty[1]&4&&n(5,i=o?.getBoundingClientRect()),e.$$.dirty[1]&24&&(a=c??s)},[x,S,C,w,T,i,r,d,f,p,m,h,g,_,v,y,E,D,O,k,ee,j,M,N,P,te,F,ne,I,re,ie,L,b,o,s,c,l,u]}function gs(e){let t=c(e);return  __call$(Object,"assign",[{},t,{send:(e,n)=>{t.transition(e,n),t.emit(`action`,{type:e,value:n,nextState:t.getCurrentState()});},onTransition:e=>t.on(`action`,e)}]) }function _s(e){let t=gs(ys(e));return t.onTransition(t=>[vs].forEach(n=>n(t,e))),t}function vs( _hh$temp274 ,r){ var e=_hh$temp274.type,t=_hh$temp274.value,n=_hh$temp274.nextState; var i; let a=r.data.currentState.get(),_hh$temp275=r.actions,o=_hh$temp275.setMoveListRows,s=_hh$temp275.selectNode,c=_hh$temp275.deselectNode,l=_hh$temp275.setResult,u=_hh$temp275.setState,d=_hh$temp275.setGameMetadataFromGameInfo,f=_hh$temp275.setContextMenu,p=_hh$temp275.setVariationPopover; a!==n&&u(n);let m={[sC.LOAD_LINE]:( _hh$temp276 )=>{ var e=_hh$temp276.lines,t=_hh$temp276.result,n=_hh$temp276.node; o(e),s(n),l(t),d(r.game),f({isOpen:!1}),p({isOpen:!1})},[sC.SELECT_NODE]:( _hh$temp277 )=>{ var e=_hh$temp277.node; s(e),f({isOpen:!1}),p({isOpen:!1})},[sC.DESELECT_NODE]:c};(i= __get$(m,e) )==null||i.call(m,t,n)}function ys( _hh$temp278 ){ var e=_hh$temp278.game,t=_hh$temp278.data; return{initialState:oC.NoNodeSelected,states:{[oC.NoNodeSelected]:{SELECT_NODE:()=>oC.NodeSelected,LOAD_LINE:()=>oC.NodeSelected},[oC.NodeSelected]:{SELECT_NODE:()=>oC.NodeSelected,DESELECT_NODE:()=>oC.NoNodeSelected,LOAD_LINE:()=>oC.NodeSelected}}}}function bs(e){let t=e,n=Le(t);function r(e){return n.set(t=e)}function i(e){n.update(n=>t=e(n))}function a(){return t}return{set:r,update:i,subscribe:n.subscribe,get:a}}function xs(e){if(!e)return null;let t=Ss(e.map( _hh$temp279=>{var e=_hh$temp279.fen;return Ve.shortenFen(e,3);} ));return t.length===3?t:null}function Ss(e){let t=[];for(let n=e.length-1;n>=0;n--)if( __get$(e,n) === __get$(e,e.length-1) &&t.push(n),t.length===3)return t;return t}function Cs(e,t,n){if(n)return{};let r={};return e.ids.move===0&&t!==void 0&&(r.beforeComment=t),e.comment!==void 0&&(r.afterComment=e.comment),r}function ws(e,t){return!e.lines||e.lines.length===0?!1:e.lines.length>=2||Ts( __get$(t,e.lines[0]) )}function Ts(e){return e.some(e=>e.lines&&e.lines.length>0)}function Es(e){return!!(e&&e.ids.move===0&&e.lines&&e.lines.length>0)}function Ds(e,t){return Es(e)||ws(e,t)}function Os(e,t,n={}){let r=[];return e.forEach((e,i)=>{ let _hh$temp280=Cs(e,n.initComment,n.ignoreComments),a=_hh$temp280.beforeComment,o=_hh$temp280.afterComment,s={node:e,beforeComment:a,afterComment:o},c=i===0&&n.ignoreFirstNodeVariations; e.lines&&!c&&(s.inlineVariations=[],e.lines.forEach(e=>{var r;let i=Os( __get$(t,e) ,t,{initComment: __get$(t,e) .initComment,ignoreComments:n.ignoreComments});(r=s.inlineVariations)==null||r.push(i)})),r.push(s)}),r}function ks( _hh$temp281 ,n={}){ var e=_hh$temp281.content,t=_hh$temp281.depth; let r;if(Ga(e))r=`moves-${t}-${As(e[0].node)}`;else if(Wa(e)){ let _hh$temp282=e,n=_hh$temp282.node,i=_hh$temp282.isBeforeComment; r=`${i?`before`:`after`}Comment-${t}-${n?As(n):`(line-${e.lineNumber??`UNKNOWN`})`}`}else r=`unknownContent-${JSON.stringify(e)}`;return js(r,n)}function As( _hh$temp283 ){ var e=_hh$temp283.hash,t=_hh$temp283.san,n=_hh$temp283.moveNumber; return`(node-${n}-${t}-[${e.toString()}])`}function js(e,t){return  __set$(t,e,(__get$(t,e)??0)+1) ,( __get$(t,e) ??0)>1?`${ __get$(t,e) }-${e}`:e}function Ms(e, _hh$temp284 ={}){ var t=_hh$temp284.ignoreComments,n=_hh$temp284.ignoreVariations; let r=[],i={},a=e=>{r.push({...e,renderKey:ks(e,i)})},o=e[0],s=[];return o.initComment!==void 0&&!t&&a({content:{comment:o.initComment,node:o[0]??null,lineNumber:0,isBeforeComment:!0},depth:0}),o.forEach(r=>{s.push({node:r}),r.comment!==void 0&&!t?(a({content:s,depth:0}),a({content:{comment:r.comment,node:r},depth:0}),s=[]):r.color===J.ColorsAsNumbers.Black&&(a({content:s,depth:0}),s=[]),!(!r.lines||n)&&(s.length>0&&(a({content:s,depth:0}),s=[]),r.lines.forEach(n=>{Fs( __get$(e,n) ,1,a,e,{initComment: __get$(e,n) .initComment,ignoreComments:t})}))}),s.length>0&&a({content:s,depth:0}),Ns(r)}function Ns(e){let t;return e.map(e=>(Ps(e)&&(t=t===`light-row`?`dark-row`:`light-row`),{...e,rowBgColor:t??`light-row`}))}function Ps(e){return e.depth===0&&qa(e)}function Fs(e,t,n,r,i={}){if(t>=cC){n({content:Os(e,r,i),depth:t});return}if(Es(e[0])&&!i.ignoreFirstNodeVariations){Is(e,t,n,r,{ignoreComments:i.ignoreComments});return}let a=[];for(let o=0;o<e.length;o++){let s= __get$(e,o) ;if(o===0||!s.lines){ let _hh$temp285=Cs(s,i.initComment,i.ignoreComments),e=_hh$temp285.beforeComment,t=_hh$temp285.afterComment; a.push({node:s,beforeComment:e,afterComment:t})}else if(s.lines){if(ws(s,r)){a.length>0&&(n({content:a,depth:t}),a=[]),Is(e.slice(o),t+1,n,r,{ignoreComments:i.ignoreComments});break} let c=__get$(r,s.lines[0]),l=Os(c,r,{ignoreComments:i.ignoreComments,initComment:c.initComment}),_hh$temp286=Cs(s,i.initComment,i.ignoreComments),u=_hh$temp286.beforeComment,d=_hh$temp286.afterComment; a.push({node:s,inlineVariations:[l],beforeComment:u,afterComment:d})}}a.length>0&&n({content:a,depth:t})}function Is(e,t,n,r, _hh$temp287 ={}){ var i=_hh$temp287.ignoreComments; var a;Fs(e,t,n,r,{ignoreFirstNodeVariations:!0,ignoreComments:i}),(a=e[0]?.lines)==null||a.forEach(e=>{Fs( __get$(r,e) ,t,n,r,{initComment: __get$(r,e) .initComment,ignoreComments:i})})}function Ls(e, _hh$temp288 ){ var t=_hh$temp288.textType,n=_hh$temp288.baseTime,r=_hh$temp288.menuEnabled,i=_hh$temp288.moveListEl,a=_hh$temp288.scrollContainer,o=_hh$temp288.translations,s=_hh$temp288.customColorsEnabled; let c={moveListRows:bs([]),currentState:bs(oC.NoNodeSelected),selectedNodeKeys:bs(null),selectedNodeEl:bs(null),textType:bs(t),result:bs(null),baseTime:bs(n),maxTimestampWidth:bs(0),largestTimestamp:bs(0),annotationsHidden:bs(!1),variationsHidden:bs(!1),commentsHidden:bs(!1),nodeLimits:bs({enabled:!1,begin:null,focus:null,end:null}),contextMenu:bs({enabled:r,isOpen:!1,actions:{}}),variationPopover:bs({isOpen:!1,moves:[],selectedMove:null}),gameMetadata:bs({threefoldIndexes:null,resultPositionInfo:null}),isActive:bs(!0),moveListEl:bs(i),scrollContainer:bs(a),translations:bs(o),customColorsEnabled:bs(s),finishedInitialLoad:bs(!1)};return{data:c,actions:Rs(e,c)}}function Rs(e, _hh$temp289 ){ var t=_hh$temp289.moveListRows,n=_hh$temp289.currentState,r=_hh$temp289.selectedNodeKeys,i=_hh$temp289.selectedNodeEl,a=_hh$temp289.textType,o=_hh$temp289.baseTime,s=_hh$temp289.result,c=_hh$temp289.contextMenu,l=_hh$temp289.variationPopover,u=_hh$temp289.annotationsHidden,d=_hh$temp289.commentsHidden,f=_hh$temp289.variationsHidden,p=_hh$temp289.maxTimestampWidth,m=_hh$temp289.largestTimestamp,h=_hh$temp289.gameMetadata,g=_hh$temp289.isActive,_=_hh$temp289.translations,v=_hh$temp289.nodeLimits,y=_hh$temp289.customColorsEnabled; function b(e){n.set(e)}function x(e){s.set(e===`*`?null:e)}function S(e){o.set(e)}function C(e){t.set(Ms(e,{ignoreComments:d.get(),ignoreVariations:f.get()}));let n=wo(e[0])??0;w(n),T(n)}function w(e){m.set(e)}function T(e){let t=Co(e).length*IS;p.set(t)}function E(e){v.set({...v.get(),...e})}function D(){v.set({...v.get(),enabled:!0})}function O(e){if(!e){r.set(null);return} let _hh$temp290=e,t=_hh$temp290.ids,n=_hh$temp290.hash; r.set({ids:t,hash:n})}function k(e){i.set(e)}function ee(){r.set(null)}function A(e){a.set(e)}function j(e){u.set(e)}function M(e){d.set(e)}function N(e){f.set(e)}function P(t){let n=l.get(),r=e.getSelectedNode(),i=e.getRawLines();if(t.isOpen&&r){ let _hh$temp291=r?.ids||{},e=_hh$temp291.line,t=_hh$temp291.move,a=__get$(__get$(i,e),t+1); n.moves=[a,...(a?.lines)?.map(e=> __get$(i,e) [0])||[]],n.selectedMove=n.moves[0]}l.set({...n,...t})}function te(e){let t=l.get();l.set({...t,selectedMove:e})}function F(e){c.set({...c.get(),...e})}function ne(e){let t=(Array.isArray(e)?e:[e]).reduce((e,t)=>({...e,[t.action]:t}),{}),n=c.get();c.set({...n,actions:{...n.actions,...t}})}function I(e){let t=Array.isArray(e)?e:[e],n=c.get(),r=n.actions??{},i=Object.keys(r).filter(e=>!t.includes(e)).reduce((e,t)=>( __set$(e,t,__get$(r,t)) ,e),{});c.set({...n,actions:{...i}})}function re(e){h.set(e)}function ie(e){ let t={threefoldIndexes:null,resultPositionInfo:null},_hh$temp292=Y.Translation.GameTerminationMessages,n=_hh$temp292.TimeoutVsInsufficientMaterial,r=_hh$temp292.DrawByAgreement,i=_.get(); s.get()&&(t.threefoldIndexes=xs(e.getLine(0)),t.resultPositionInfo=e.getFinalPositionInfo({timeoutVsInsufficientMaterial: __get$(i,n) ?.call(i),drawByAgreement: __get$(i,r) ?.call(i)})||null),h.set(t)}function L(e){h.update(t=>({...t,threefoldIndexes:e}))}function R(e){h.update(t=>({...t,resultPositionInfo:e}))}function ae(e){g.set(e)}function oe(e){y.set(e)}return{setTextType:A,setState:b,setMoveListRows:C,selectNode:O,setSelectedNodeEl:k,deselectNode:ee,setResult:x,setContextMenu:F,setVariationPopover:P,selectPopoverMove:te,setBaseTime:S,setAnnotationsHidden:j,setCommentsHidden:M,setVariationsHidden:N,addContextMenuActions:ne,removeContextMenuActions:I,setGameMetadata:re,setGameMetadataFromGameInfo:ie,setResultPositionInfo:R,setThreefoldIndexes:L,setActiveStatus:ae,setNodeLimits:E,enableNodeLimits:D,setCustomColorsEnabled:oe}}function zs(e){let t=document.createElement(`textarea`);return t.innerHTML= __call$(e,"replace",[/&nbsp;/g,` `]) ,t.value}function Bs(e,t){if(t){let t=[`br`],n=t.map(e=>`\\/${e}`),r=t.concat(n).join(`|`),i=RegExp(`<(?!${r}s*/?)[^>]+>`,`g`);return  __call$(e,"replace",[i,``]) }return  __call$(e,"replace",[/<\/?[^>]+(>|$)/g,``]) }function Vs(e){if(e===void 0)return;let t;return t=zs(Bs(e)),t===` `&&(t=``),t}function Hs(e, _hh$temp293 ){ var t=_hh$temp293.game,n=_hh$temp293.data,r=_hh$temp293.actions; return{selectNode(e,t){t&&t.stopPropagation(),n.isActive.get()!==!1&&i(e)},setSelectedNodeEl(e){r.setSelectedNodeEl(e)},openVariationsPopover(){r.setVariationPopover({isOpen:!0})},selectPopoverMove(e){r.selectPopoverMove(e)},closeVariationsPopover(){r.setVariationPopover({isOpen:!1})},openContextMenu(e,t){n.isActive.get()!==!1&&n.contextMenu.get().enabled&&(e&&i(e.ids),t?.preventDefault(),r.setContextMenu({isOpen:!0}))},closeContextMenu(){r.setContextMenu({isOpen:!1})},handleContextMenuAction(e,r){let i=n.contextMenu.get(),a=n.selectedNodeKeys.get(),o= __get$(i.actions,e,true) ?.handler;if(!a||!o)return;let s=t.getNodeByIds(a.ids);s&&(o({node:s,game:t},r),this.closeContextMenu())},updateComment(e,n){let r=Vs(n),i=e.node?.ids.line??e.lineNumber;e.isBeforeComment&&i!==void 0?t.updateLineComment(r,i):e.node&&t.updateNode(e.node.ids,{comment:r})},clickComment(e){t.selectNode(e.line,e.move)}};function i(r){let i=n.selectedNodeKeys.get(),a=t.getSelectedNode(),o=a?.ids.line===r.line&&a?.ids.move===r.move;i===null&&o?e(sC.SELECT_NODE,{node:a}):t.selectNode(r.line,r.move)}}function Us(e,t){let n=document.createDocumentFragment(),r= new e(__call$(Object,"assign",[{},t,{target:n}])) ;return t.target.replaceWith(n),r}function Ws( _hh$temp294 ){ var e=_hh$temp294.ComponentType,t=_hh$temp294.methods,n=_hh$temp294.options,_hh$temp294$replaceContainer=_hh$temp294.replaceContainer,r=_hh$temp294$replaceContainer===void 0?!0:_hh$temp294$replaceContainer; let i=r?Us(e,n):new e(n),a={destroy:o,el:n.target,get:s,instance:i,on:c,set:l};return t&&t.length&&t.forEach(e=>{ __set$(a,e,__get$(i,e)) }),a;function o(){i.$destroy()}function s(e){return typeof e==`string`? __get$(i.$$.ctx,e) :Ie(i.$$.ctx,e)}function c(e,t){i.$on(e,t)}function l(e){i.$set(e)}}function Gs(e,t){return{getDisplayName: _hh$temp295=>{var e=_hh$temp295.node;return e.ids.move>0?Y.Translation.Actions.InsertComment:Y.Translation.Actions.InsertCommentAfter;} ,action:BS.AddComment,isVisible:n,handler:r};function n( _hh$temp296 ){ var e=_hh$temp296.node; return e.comment===void 0}function r( _hh$temp297 ){ var e=_hh$temp297.node,t=_hh$temp297.game; t.updateNode(e.ids,{comment:``})}}function Ks(e,t){return{getDisplayName:()=>Y.Translation.Actions.InsertCommentBefore,action:BS.AddCommentBefore,isVisible:n,handler:r};function n( _hh$temp298 ){ var e=_hh$temp298.node,t=_hh$temp298.game; let n= __get$(t.getRawLines(),e.ids.line) ,r=e.ids.move===0,i=n.initComment!==void 0;return r&&!i}function r( _hh$temp299 ){ var e=_hh$temp299.node,t=_hh$temp299.game; t.updateLineComment(``,e.ids.line)}}function qs(e){return!!(e&&e.charAt(0)===`$`)}function Js(e){return!e||!Object.prototype.hasOwnProperty.call(VS,e)&&!Object.prototype.hasOwnProperty.call(HS,e)?e||``:qs(e)? __get$(VS,e) :Js( __get$(HS,e) )}function Ys(e,t){return{getDisplayName:()=>``,action:BS.AddAnnotation,isVisible:n,handler:r};function n(){return!1}function r( _hh$temp300 ,n){ var e=_hh$temp300.node,t=_hh$temp300.game; if(!n?.data?.annotation)return;let r=Js(e.annotation),i=n.data.annotation===r?``:n.data.annotation;t.updateNode(e.ids,{annotation:i})}}function Xs(e,t){return{getDisplayName:()=>``,action:BS.AddAdditionalAnnotation,isVisible:n,handler:r};function n(){return!1}function r( _hh$temp301 ,n){ var e=_hh$temp301.node,t=_hh$temp301.game; if(!n?.data?.annotation)return;let r=Js(e.additionalAnnotation?.[0]),i=n.data.annotation===r?[]:[n.data.annotation];t.updateNode(e.ids,{additionalAnnotation:i})}}function Zs(e,t){return{getDisplayName:()=>Y.Translation.Actions.HideAllAnnotations,action:BS.HideAllAnnotations,isVisible:n,handler:r};function n(){return!e.annotationsHidden.get()}function r(){t.setAnnotationsHidden(!0)}}function Qs(e,t){return{getDisplayName:()=>Y.Translation.Actions.ShowAllAnnotations,action:BS.ShowAllAnnotations,isVisible:n,handler:r};function n(){return e.annotationsHidden.get()}function r(){t.setAnnotationsHidden(!1)}}function $s(e,t){return{getDisplayName:()=>Y.Translation.Actions.RemoveAnnotation,action:BS.RemoveAnnotation,isVisible:n,handler:r};function n( _hh$temp302 ){ var e=_hh$temp302.node; let t=!!e.annotation,n=!!e.additionalAnnotation;return t||n}function r( _hh$temp303 ){ var e=_hh$temp303.node,t=_hh$temp303.game; t.updateNode(e.ids,{annotation:void 0,additionalAnnotation:void 0})}}function ec(e,t){return{getDisplayName:()=>Y.Translation.Actions.Promote,action:BS.PromoteVariation,isVisible:n,handler:r};function n( _hh$temp304 ){ var e=_hh$temp304.game,t=_hh$temp304.node; let n=t.ids.line;if(n===0)return!1;let r=e.getLine(n);if(!r)return!1;if(r.parentId===0){ let _hh$temp305=e.getMode().getOptions(),t=_hh$temp305.canAddMovesToMainLine,n=_hh$temp305.canModifyExistingMovesOnMainLine; return t&&n}return!0}function r( _hh$temp306 ){ var e=_hh$temp306.node,t=_hh$temp306.game; t.promoteVariation(e.ids.line,lC.Parent)}}function tc(e,t){return{getDisplayName:()=>Y.Translation.Actions.DeleteMove,action:BS.DeleteMove,isVisible:n,handler:r};function n(){return!0}function r( _hh$temp307 ){ var e=_hh$temp307.node,t=_hh$temp307.game; let n=t.getRawLines();if(e.ids.line!==0&&e.lines&&Ds(e,n)){t.promoteVariation(e.lines[0],1,{replace:!0});return}t.deletePosition(e.ids.move,e.ids.line)}}function nc(e,t){return{getDisplayName: _hh$temp308=>{var e=_hh$temp308.node;return e.ids.move>0?Y.Translation.Actions.DeleteComment:Y.Translation.Actions.DeleteCommentAfter;} ,action:BS.DeleteCommentAfter,isVisible:n,handler:r};function n( _hh$temp309 ){ var e=_hh$temp309.node; return e.comment!==void 0}function r( _hh$temp310 ){ var e=_hh$temp310.node,t=_hh$temp310.game; t.updateNode(e.ids,{comment:void 0})}}function rc(e,t){return{getDisplayName:()=>Y.Translation.Actions.DeleteCommentBefore,action:BS.DeleteCommentBefore,isVisible:n,handler:r};function n( _hh$temp311 ){ var e=_hh$temp311.node,t=_hh$temp311.game; let n= __get$(t.getRawLines(),e.ids.line) .initComment!==void 0,r=e.ids.move===0;return n&&r}function r( _hh$temp312 ){ var e=_hh$temp312.node,t=_hh$temp312.game; t.updateLineComment(void 0,e.ids.line)}}function ic(e){let t=new Map,n=e;return{cancelConfirmation:r,cancelAllConfirmations:i,confirmAction:a,registerConfirmationCallback:o,requestConfirmation:s};function r(e){t.delete(e)}function i(){t.clear()}function a(e){var n;(n=t.get(e))==null||n(),t.delete(e)}function o(e){n=e}async function s(e){ let _hh$temp313=e,i=_hh$temp313.action,o=_hh$temp313.data,s=_hh$temp313.text,c=_hh$temp313.type; if(t.set(c,i),n)return await n({data:o,text:s,type:c})?a(c):r(c);if(window.confirm(s))return a(c);r(c)}}function ac(e,t){let n=ic();return{getDisplayName:()=>Y.Translation.Actions.ClearAllAnalysis,action:BS.ClearAnalysis,handler:r,isVisible(){return!0}};function r( _hh$temp314 ){ var e=_hh$temp314.node,t=_hh$temp314.game; n.requestConfirmation({action:r,data:void 0,text:`Are you sure you want to clear all analysis?`,type:`ClearAnalysis`});function r(){let n=t.getLine(0);n&&(t.resetToMainLine(),n.forEach(n=>{var r,i;t.updateNode(n.ids,{additionalAnnotation:void 0,annotation:``,comment:void 0}),(r=e.commands)==null||delete r.href,(i=e.commands)==null||delete i.text}),n.initComment&&t.updateLineComment(void 0,n.id))}}}function oc(e,t){return{getDisplayName:()=>Y.Translation.Actions.InsertContinuation,action:BS.InsertContinuation,isVisible:n,handler:r};function n( _hh$temp315 ){ var e=_hh$temp315.game,t=_hh$temp315.node; let n=e.getRawLines();return t.ids.move=== __get$(n,t.ids.line) .length-1}function r( _hh$temp316 ){ var e=_hh$temp316.game; e.createContinuation()}}function sc(e,t){return t.lines?e.ids.line===t.lines[0]:!1}function cc(e,t){return{action:BS.MoveVariationUp,handler:r,isVisible:n,getDisplayName:()=>Y.Translation.Actions.MoveVariationUp};function n( _hh$temp317 ){ var e=_hh$temp317.game,t=_hh$temp317.node; if(t.ids.line===0)return!1;let n=e.getLine(t.ids.line);if(!n)return!1;let r=e.getNodeByIds({line:n.parentId,move:n.atMoveNode});return r&&r.lines&&r.lines.length>1?!sc(t,r):!1}function r( _hh$temp318 ){ var e=_hh$temp318.node,t=_hh$temp318.game; t.moveVariation(e.ids.line,!0)}}function lc(e,t){return t.lines?e.ids.line=== __get$(t.lines,t.lines.length-1) :!1}function uc(e,t){return{action:BS.MoveVariationDown,handler:r,isVisible:n,getDisplayName:()=>Y.Translation.Actions.MoveVariationDown};function n( _hh$temp319 ){ var e=_hh$temp319.game,t=_hh$temp319.node; if(t.ids.line===0)return!1;let n=e.getLine(t.ids.line);if(!n)return!1;let r=e.getNodeByIds({line:n.parentId,move:n.atMoveNode});return r&&r.lines&&r.lines.length>1?!lc(t,r):!1}function r( _hh$temp320 ){ var e=_hh$temp320.node,t=_hh$temp320.game; t.moveVariation(e.ids.line,!1)}}function dc(e,t){return{getDisplayName:()=>Y.Translation.Actions.SetFocus,action:BS.SetFocus,isVisible:n,handler:r};function n( _hh$temp321 ){ var t=_hh$temp321.node;  let _hh$temp322=e.nodeLimits.get(),n=_hh$temp322.enabled,r=_hh$temp322.focus; return n&&r!==t.ids}function r( _hh$temp323 ){ var e=_hh$temp323.node,n=_hh$temp323.game; let r={focus:e.ids},i=Zt(K.APIEvents.NodeLimitsUpdated,r);n.emit(K.APIEvents.NodeLimitsUpdated,i),t.setNodeLimits(r)}}function fc(e,t){return{getDisplayName:()=>Y.Translation.Actions.SetBegin,action:BS.SetBegin,isVisible:n,handler:r};function n( _hh$temp324 ){ var t=_hh$temp324.node;  let _hh$temp325=e.nodeLimits.get(),n=_hh$temp325.enabled,r=_hh$temp325.begin; return n&&r!==t.ids}function r( _hh$temp326 ){ var e=_hh$temp326.node,n=_hh$temp326.game; let r={begin:e.ids},i=Zt(K.APIEvents.NodeLimitsUpdated,r);n.emit(K.APIEvents.NodeLimitsUpdated,i),t.setNodeLimits(r)}}function pc(e,t){return{getDisplayName:()=>Y.Translation.Actions.SetEnd,action:BS.SetEnd,isVisible:n,handler:r};function n( _hh$temp327 ){ var t=_hh$temp327.node;  let _hh$temp328=e.nodeLimits.get(),n=_hh$temp328.enabled,r=_hh$temp328.end; return n&&r!==t.ids}function r( _hh$temp329 ){ var e=_hh$temp329.node,n=_hh$temp329.game; let r={end:e.ids},i=Zt(K.APIEvents.NodeLimitsUpdated,r);n.emit(K.APIEvents.NodeLimitsUpdated,i),t.setNodeLimits(r)}}function mc(e,t){return{getDisplayName:()=>Y.Translation.Actions.RemoveBegin,action:BS.RemoveBegin,isVisible:n,handler:r};function n( _hh$temp330 ){ var t=_hh$temp330.node; return e.nodeLimits.get().begin===t.ids}function r( _hh$temp331 ){ var e=_hh$temp331.game; let n={begin:null},r=Zt(K.APIEvents.NodeLimitsUpdated,n);e.emit(K.APIEvents.NodeLimitsUpdated,r),t.setNodeLimits(n)}}function hc(e,t){return{getDisplayName:()=>Y.Translation.Actions.RemoveFocus,action:BS.RemoveFocus,isVisible:n,handler:r};function n( _hh$temp332 ){ var t=_hh$temp332.node; return e.nodeLimits.get().focus===t.ids}function r( _hh$temp333 ){ var e=_hh$temp333.game; let n={focus:null},r=Zt(K.APIEvents.NodeLimitsUpdated,n);e.emit(K.APIEvents.NodeLimitsUpdated,r),t.setNodeLimits(n)}}function gc(e,t){return{getDisplayName:()=>Y.Translation.Actions.RemoveEnd,action:BS.RemoveEnd,isVisible:n,handler:r};function n( _hh$temp334 ){ var t=_hh$temp334.node; return e.nodeLimits.get().end===t.ids}function r( _hh$temp335 ){ var e=_hh$temp335.game; let n={end:null},r=Zt(K.APIEvents.NodeLimitsUpdated,n);e.emit(K.APIEvents.NodeLimitsUpdated,r),t.setNodeLimits(n)}}function _c(e,t){return{[BS.AddAnnotation]:Ys(),[BS.AddAdditionalAnnotation]:Xs(),[BS.AddCommentBefore]:Ks(),[BS.AddComment]:Gs(),[BS.DeleteCommentBefore]:rc(),[BS.DeleteCommentAfter]:nc(),[BS.RemoveAnnotation]:$s(),[BS.DeleteMove]:tc(),[BS.PromoteVariation]:ec(),[BS.MoveVariationDown]:uc(),[BS.MoveVariationUp]:cc(),[BS.InsertContinuation]:oc(),[BS.ShowAllAnnotations]:Qs(e,t),[BS.HideAllAnnotations]:Zs(e,t),[BS.ClearAnalysis]:ac(),[BS.SetBegin]:fc(e,t),[BS.SetFocus]:dc(e,t),[BS.SetEnd]:pc(e,t),[BS.RemoveBegin]:mc(e,t),[BS.RemoveFocus]:hc(e,t),[BS.RemoveEnd]:gc(e,t)}}function vc( _hh$temp336 ){ var e=_hh$temp336.target,_hh$temp336$translations=_hh$temp336.translations,t=_hh$temp336$translations===void 0?jS:_hh$temp336$translations,n=_hh$temp336.game,r=_hh$temp336.hideTimestampText,_hh$temp336$displayTimeInClockFormat=_hh$temp336.displayTimeInClockFormat,i=_hh$temp336$displayTimeInClockFormat===void 0?!0:_hh$temp336$displayTimeInClockFormat,a=_hh$temp336.showTimestamps,o=_hh$temp336.scrollContainer,_hh$temp336$customColorsEnabled=_hh$temp336.customColorsEnabled,s=_hh$temp336$customColorsEnabled===void 0?!1:_hh$temp336$customColorsEnabled;  let _hh$temp337=Ls(n,{baseTime:n.timeControl.get()?.baseTime,textType:n.getOptions().moveListDisplayType,menuEnabled:n.getOptions().moveListContextMenuEnabled,moveListEl:e,scrollContainer:o,translations:t,customColorsEnabled:s}),c=_hh$temp337.data,l=_hh$temp337.actions,u=_c(c,l); l.addContextMenuActions(Object.values(u));let d=_s({data:c,actions:l,game:n}),f=Hs(d.send,{data:c,game:n,actions:l}),p=Ws({ComponentType:aC,options:{props:{data:c,eventHandlers:f,hideTimestampText:r,displayTimeInClockFormat:i,showTimestamps:a,translations:t,game:n},target:e},replaceContainer:!1});return e.classList.contains(`move-list`)||e.classList.add(`move-list`),e.classList.contains(`chessboard-pkg-move-list-component`)||e.classList.add(`chessboard-pkg-move-list-component`),{destroy:p.destroy,setTextType:l.setTextType,setContextMenuEnabled:e=>l.setContextMenu({enabled:e}),setBaseTime:e=>{c.isActive.get()&&l.setBaseTime(e)},setResult:e=>{c.isActive.get()&&(l.setResult(e),l.setGameMetadataFromGameInfo(n))},setActiveStatus:e=>{l.setActiveStatus(e)},isActive:()=>c.isActive.get(),selectNode:e=>d.send(sC.SELECT_NODE,{node:e}),loadLine:(e,t,n)=>{c.isActive.get()&&d.send(sC.LOAD_LINE,{lines:e,result:t,node:n})},deselectNode:()=>d.send(sC.DESELECT_NODE),addContextMenuActions:l.addContextMenuActions,removeContextMenuActions:l.removeContextMenuActions,setAnalysisHidden:e=>{m({hideAnnotations:e,hideComments:e,hideVariations:e})},setAnnotationsHidden:e=>{m({hideAnnotations:e})},setCommentsHidden:e=>{m({hideComments:e})},setVariationsHidden(e){m({hideVariations:e})},getMoveNodeEl:(t,n)=>{if(e)return Array.from(e.querySelectorAll(`.node`)).find(e=>e.getAttribute(`data-node`)===`${t}-${n}`)},openVariationsPopover:f.openVariationsPopover,closeVariationsPopover:f.closeVariationsPopover,enableNodeLimits:l.enableNodeLimits,updateNodeLimits:l.setNodeLimits,getNodeLimits:()=>{let e=e=> __get$(n.getLine(e?.line),e?.move,true) ||null;return{begin:e(c.nodeLimits.get().begin),focus:e(c.nodeLimits.get().focus),end:e(c.nodeLimits.get().end)}},setCustomColorsEnabled:l.setCustomColorsEnabled,reinitialize:()=>{c.finishedInitialLoad.set(!1)}};function m(e){if(!c.isActive.get())return; let _hh$temp338=e,t=_hh$temp338.hideComments,r=_hh$temp338.hideVariations,i=_hh$temp338.hideAnnotations; t!==void 0&&l.setCommentsHidden(t),r!==void 0&&l.setVariationsHidden(r),i!==void 0&&l.setAnnotationsHidden(i),(t!==void 0||r!==void 0)&&d.send(sC.LOAD_LINE,{lines:n.getRawLines(),result:c.result.get(),node:n.getSelectedNode()})}}function yc(...e){return function(t,n){return!!e.find(e=>e(t,n))}}function bc(e){let t=e.getSelectedNode();return t?( __get$(__get$(e.getRawLines(),t.ids.line),t.ids.move+1) ?.lines?.length??0)>0:!1}function xc( _hh$temp339 ){ var e=_hh$temp339.target,t=_hh$temp339.scrollContainer,_hh$temp339$hideTimestampText=_hh$temp339.hideTimestampText,n=_hh$temp339$hideTimestampText===void 0?!0:_hh$temp339$hideTimestampText,_hh$temp339$displayTimeInClockFormat=_hh$temp339.displayTimeInClockFormat,r=_hh$temp339$displayTimeInClockFormat===void 0?!0:_hh$temp339$displayTimeInClockFormat,_hh$temp339$showTimestamps=_hh$temp339.showTimestamps,i=_hh$temp339$showTimestamps===void 0?!0:_hh$temp339$showTimestamps,_hh$temp339$translations=_hh$temp339.translations,a=_hh$temp339$translations===void 0?jS:_hh$temp339$translations,_hh$temp339$loadLineOnCreate=_hh$temp339.loadLineOnCreate,o=_hh$temp339$loadLineOnCreate===void 0?!0:_hh$temp339$loadLineOnCreate,_hh$temp339$customColorsEnabled=_hh$temp339.customColorsEnabled,s=_hh$temp339$customColorsEnabled===void 0?!1:_hh$temp339$customColorsEnabled; let c,l;return{api:u,create:h,destroy:_,match:[{condition:Ct([...dC]),handler:m},{condition:Ct([...uC]),handler:d},{condition:xt(K.OptionsEvents.Update),handler:f},{condition:xt(K.APIEvents.UpdatePGNHeaders),handler:g},{condition:xt(K.APIEvents.NodeUpdated),handler:p},{condition:xt(K.APIEvents.LineCommentUpdated),handler:m},{condition:xt(K.APIEvents.LineUpdated),handler:m},{condition:xt(K.APIEvents.AddMove),handler:m},{condition:Ct([K.InstanceEvents.Create,K.InstanceEvents.ModeChanged]),handler:m}],name:kb.Name};function u(e){return{enableNodeLimits:()=>{c.enableNodeLimits(),l=e.api.extendAPI(kb.Name,{getDiagramNodeLimits:()=>c.getNodeLimits})},updateNodeLimits:e=>c.updateNodeLimits(e),getMoveList:()=>c,activate:()=>{c.setActiveStatus(!0),Sc(e.api,c)},deactivate:()=>c.setActiveStatus(!1)}}function d(e,t){ let _hh$temp340=t,n=_hh$temp340.api; c.selectNode(n.getSelectedNode())}function f(e){`enabled`in e.data&&c.setActiveStatus(e.data.enabled),`moveListDisplayType`in e.data&&c.setTextType(e.data.moveListDisplayType),`moveListContextMenuEnabled`in e.data&&c.setContextMenuEnabled(e.data.moveListContextMenuEnabled)}function p(e,t){ let _hh$temp341=t,n=_hh$temp341.api; if(!e.data.changes)return;let r=`timestamp`in e.data.changes,i=`annotation`in e.data.changes||`additionalAnnotation`in e.data.changes,a=`comment`in e.data.changes,o=`customColor`in e.data.changes;(r||i||a||o)&&Sc(n,c)}function m(e,t){ let _hh$temp342=t,n=_hh$temp342.api; Sc(n,c)}function h(l){var u; let _hh$temp343=l,d=_hh$temp343.api; c=vc({target:e,scrollContainer:t,game:d,hideTimestampText:n,displayTimeInClockFormat:r,showTimestamps:i,translations:a,customColorsEnabled:s}),o&&Sc(d,c),c.setActiveStatus(l.api.getOptions().enabled??!0),(u= __get$(d,rb.Plugin.Name) )==null||u.setKeys({[rb.Arrow.Right]:()=>{if(c&&bc(d)){c.openVariationsPopover();return}d.moveForward()}})}function g(e,t){ let _hh$temp344=t,n=_hh$temp344.api,r=n.getResult(); c.setResult(r),`TimeControl`in e.data&&c.setBaseTime(n.timeControl.get()?.baseTime)}function _(e){var t;c&&c.destroy(),l?.(),(t= __get$(e?.api,rb.Plugin.Name,true) )==null||t.resetKeys()}}function Sc(e,t){let n=e.getRawLines(),r=e.getResult(),i=e.getSelectedNode();t.loadLine(n,r,i)}function Cc(e=!0){let t=[],n=!1;return{add:r,clear:i,flush:a,getEntries:o};function r(r,...i){let o=fC,s=fC,c=new Promise((e,t)=>{s=e,o=t});return t.push({fn:r,params:i,reject:o,resolve:s}),e&&n===!1&&a(),c}function i(){n=!1,t.length=0}async function a(){let e=t.shift();if(!e){n=!1;return}n=!0;try{let t=await e.fn(...e.params);return e.resolve(t),a()}catch(t){e.reject(t)}}function o(){return t}}function wc(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),reject:t,resolve:e}}function Tc(){let e=!1,t=wc();return{isReady:()=>e,ready:n,waitForReady:()=>t.promise};function n(n){var r;e=!0,(r=t.resolve)==null||r.call(t,n)}}function Ec(e){return function( _hh$temp345 ){ var t=_hh$temp345.context,n=_hh$temp345.event,r=_hh$temp345.line,i=_hh$temp345.selectedNode,a=_hh$temp345.queue;  let _hh$temp346=n,o=_hh$temp346.data,s=_hh$temp346.type,c=i?.ply; return s===K.APIEvents.AddMove&&o.listMove?e.addNode(o.listMove):o&&o.plyDiff===1&&i?(e.addNode(i),e.selectNode(c)):s===K.APIEvents.CreateGame||s===K.APIEvents.Load||s===K.APIEvents.DeletePosition?e.loadNodes(r):s===K.APIEvents.LineUpdated?(e.loadNodes(r),e.selectNode(c)):o.moveListDisplayType?(e.setMoveListDisplayType(o.moveListDisplayType),e.loadNodes(r,c)):s===K.APIEvents.NodeUpdated&&o.changes&&Object.prototype.hasOwnProperty.call(o.changes,`timestamp`)?e.updateTimestamp(o.changes.node):s===K.APIEvents.UpdatePGNHeaders&&o.Result?(e.setResult(o.Result),t.game.inThreefoldRepetition()&&a.add(e.addThreeFoldIcons,r)):c===0?e.deselectNode():s!==K.OptionsEvents.Update&&e.selectNode(c),o.changes&&Object.prototype.hasOwnProperty.call(o.changes,`customColor`)&&e.updateNodeColor(o.ids.move+1,o.changes.customColor),c}}function Dc( _hh$temp347 ){ var e=_hh$temp347.el,t=_hh$temp347.value,n=_hh$temp347.variable; if(t!==void 0)return e.style.setProperty(n,t);e.style.removeProperty(n)}function Oc(e,t){Object.values(MS.CssVariables).forEach(n);function n(n){Dc({el:e,value:t,variable:n})}}function kc(){let e=`onpointerdown`in window,t=`ontouchstart`in window,n,r,i;return e?(n=`pointerdown`,r=`pointermove`,i=`pointerup`):t?(n=`touchstart`,r=`touchmove`,i=`touchend`):(n=`mousedown`,r=`mousemove`,i=`mouseup`),{Pointerdown:n,Pointermove:r,Pointerup:i}}function Ac(e,t){let n=document.createElement(`div`),r=document.createElement(MS.Tags.EnPassantIcon);return n.appendChild(r),n.classList.add(MS.Classes.MoveInfoIcon),r.classList.add(MS.Classes.IconFont,MS.Classes.CircleInfo),n.addEventListener(mC,a),n.addEventListener(`mouseover`,i),n.dataset.tooltip= __call$(t,Y.Translation.Tooltips.EnPassant,[]) ,{el:n,listener:{el:n,eventName:mC,handler:a}};function i(){let e=n.getBoundingClientRect().y;n.style.setProperty(`--tooltip-top`,`${e}px`)}function a(t){t.stopPropagation(),window.open(e,`_blank`)}}function jc(e={}){let t={...e};return{get:n,set:r};function n(){return t}function r(e){ __call$(Object,"assign",[t,e]) }}function Mc(e){return  __get$(J.Piece.Names,e.toLowerCase()) }function Nc(e,t){return e.toUpperCase()===e?Pc(e,t):e}function Pc(e,t){return`<span class="icon-font-chess ${Mc(e)}-${t}" data-figurine="${e}"></span>`}function Fc( _hh$temp348 ){ var e=_hh$temp348.color,t=_hh$temp348.moveListDisplayType,n=_hh$temp348.san,r=_hh$temp348.translations; return n.split(``).map(n=>`NBRQK`.includes(n)?t===Qb.MoveListDisplayTypes.Figurine?Nc(n,e): __call$(r,n,[]) :n).join(``)}function Ic(e,t){let n=e/(t/40);return _C*2/Math.PI*Math.atan(n/3)}function Lc(e,t){let n=xs(e);if(n)return n.map(e=> __get$(t,e) )}function Rc(e){return`time-${e}`}function zc(e){return`.${e}`}function Bc(e){ let _hh$temp349=e,t=_hh$temp349.el,n=_hh$temp349.toggleTimestamps,r=[],i=jc(e); return{addMove:a,addNode:o,addTimestamp:s,clearList:c,createList:l,deselectNode:m,destroyList:g,enableColors:_,getLastPly:v,getParams:i.get,getResult:E,getResultNodeElement:D,getTimestamp:O,hasResultNode:j,addThreeFoldMoveIcons:I,removeTimestamp:M,scrollToSelectedNode:N,selectNode:te,selectNodeElement:P,setResultNode:ne,setTimestampValue:L,setParams:i.set,updateNodeColor:ae};function a(e){let n=document.createElement(`div`);return n.classList.add(yC.DOM.ClassNames.Move),e&&(n.setAttribute(yC.DOM.Attributes.WholeMoveNumber,`${e}`),n.innerHTML=`${e}.`),t.appendChild(n),n}function o(e){ let _hh$temp350=e,t=_hh$temp350.color,n=_hh$temp350.flags,r=_hh$temp350.ids,i=_hh$temp350.ply,o=_hh$temp350.san,s=_hh$temp350.wholeMoveNumber; if(!t||!i||!o||!s||w(i))return;let c=b(s);c||=a(s);let l=u({color:ja(t),moveId:r.move,isEPCapture:n?Va(n):!1,ply:i,san:o});if(l)return e.ply&&Object.prototype.hasOwnProperty.call(e,`customColor`)&&Oc(l,e.customColor),c.appendChild(l)}function s( _hh$temp351 ){ var e=_hh$temp351.baseTime,t=_hh$temp351.node,n=_hh$temp351.timestamp,r=_hh$temp351.title,i=_hh$temp351.value;  let _hh$temp352=t,a=_hh$temp352.color,o=_hh$temp352.ply,s=_hh$temp352.wholeMoveNumber; if(!a||!o||!s)return;let c=b(s);if(!c)return;let l=k(o);l&&c.removeChild(l);let u=p(o);return r&&ie(r,u),re(a,u),L({baseTime:e,ply:o,timestamp:n,value:i},u),c.appendChild(u),u}function c(){g(),l()}function l(){g(),t.classList.add(yC.DOM.ClassNames.List),n&&t.classList.add(yC.DOM.ClassNames.ToggleTimestamps)}function u( _hh$temp353 ){ var e=_hh$temp353.color,n=_hh$temp353.isEPCapture,a=_hh$temp353.moveId,o=_hh$temp353.ply,s=_hh$temp353.san;  let _hh$temp354=i.get(),c=_hh$temp354.EPIconInfoPath,l=_hh$temp354.moveListDisplayType,u=_hh$temp354.translations,d=document.createElement(`div`); if(d.setAttribute(yC.DOM.Attributes.Ply,o.toString()),d.classList.add(e,yC.DOM.ClassNames.Node),d.innerHTML=Fc({color:e,moveListDisplayType:l,san:s,translations:u}),n){ let _hh$temp355=Ac(c,u),e=_hh$temp355.el,t=_hh$temp355.listener; d.appendChild(e),r.push({el:e,eventName:mC,handler:t.handler})}return d.addEventListener(mC,f),r.push({eventName:mC,handler:f}),d;function f(){t.dispatchEvent(new CustomEvent(yC.Events.SelectNode,{detail:{ids:{move:a,line:0},ply:o}}))}}function d(e,t){let n=document.createElement(`span`);return n.innerHTML=e,n.classList.add(t,yC.DOM.ClassNames.GameResult),n}function f(){ let _hh$temp356=i.get(),e=_hh$temp356.translations,t=document.createElement(`div`),n=document.createElement(`span`); return t.appendChild(n),t.classList.add(MS.Classes.MoveInfoIcon),n.classList.add(MS.Classes.IconFont,MS.Classes.ThreeFoldIcon),t.dataset.tooltip= __call$(e,Y.Translation.Tooltips.ThreeFoldRepetition,[]) ,t.addEventListener(`mouseover`,r),t;function r(){let e=t.getBoundingClientRect().y;t.style.setProperty(`--tooltip-top`,`${e}px`)}}function p(e){let t=document.createElement(`div`);return t.setAttribute(yC.DOM.Attributes.Ply,e.toString()),t.setAttribute(yC.DOM.Attributes.VMLElement,yC.DOM.ElementTypes.Timestamp),t}function m(e){let t=e?w(e):A();t&&h(t)}function h(e){e.classList.remove(yC.DOM.ClassNames.Selected)}function g(){r.forEach(e=>{t.removeEventListener(e.eventName,e.handler)}),t.classList.remove(yC.DOM.ClassNames.List),t.innerHTML=``}function _(e){ let _hh$temp357=i.get(),n=_hh$temp357.colorsEnabled; n!==e&&(i.set({colorsEnabled:e}), __call$(t.classList,e?`add`:`remove`,[yC.DOM.ClassNames.ColorsEnabled]) )}function v(){let e=T();if(!e.length)return;let t=C( __get$(e,e.length-1) );if(t)return t}function y(){let e=t.style.getPropertyValue(yC.DOM.CSSVariables.MaxMoveTimeTaken);return e.length?parseFloat(e):null}function b(e){return t.querySelector(`[${yC.DOM.Attributes.WholeMoveNumber}="${e}"]`)}function x(){return Array.from(t.querySelectorAll(`${zc(yC.DOM.ClassNames.Move)}`))}function S(e){return e.classList.contains(J.ColorsAsWords.Black)?J.ColorsAsNumbers.Black:J.ColorsAsNumbers.White}function C(e){let t=e.getAttribute(yC.DOM.Attributes.Ply);return t?parseInt(t,10):null}function w(e){return t.querySelector(`${zc(yC.DOM.ClassNames.Node)}[${yC.DOM.Attributes.Ply}="${e}"]`)}function T(){return Array.from(t.querySelectorAll(`${zc(yC.DOM.ClassNames.Node)}`))}function E(){let e=D();return e?e.innerText:J.Results.None}function D(){return t.querySelector(zc(yC.DOM.ClassNames.GameResult))}function O(e){let t=k(e);if(!t)return null;let n=t.getAttribute(yC.DOM.Attributes.Time);return n?.length===0?null:parseFloat(n)}function k(e){return t.querySelector(`[${yC.DOM.Attributes.VMLElement}="${yC.DOM.ElementTypes.Timestamp}"][${yC.DOM.Attributes.Ply}="${e}"]`)}function ee(){let e=t.style.getPropertyValue(yC.DOM.CSSVariables.TimestampWidth);return e.length?parseFloat(e):null}function A(){return t.querySelector(zc(yC.DOM.ClassNames.Selected))}function j(){return!!t.querySelector(zc(yC.DOM.ClassNames.GameResult))}function M(e){let t=k(e);t&&t.parentNode.removeChild(t)}function N(){ let _hh$temp358=i.get(),e=_hh$temp358.scrollContainer,n=A(),r=e||t; if(!n){r.scrollTop=0;return}uo({containerEl:r,moveListEl:t,nodeEl:n})}function P(e){let t=A();e!==t&&(t&&h(t),e.classList.add(yC.DOM.ClassNames.Selected))}function te(e){let t=w(e);t&&P(t)}function F(e){if(e===null){t.style.removeProperty(yC.DOM.CSSVariables.MaxMoveTimeTaken);return}t.style.setProperty(yC.DOM.CSSVariables.MaxMoveTimeTaken,e.toString())}function ne(e){let t=D();if(t!==null){let e=t.parentNode;if(!e)return;e.removeChild(t),e.childNodes.length===0&&e.parentNode.removeChild(e)}if(e===J.Results.None)return;let n=T().slice(-1)[0],r=!n||S(n)===J.ColorsAsNumbers.Black?J.ColorsAsWords.White:J.ColorsAsWords.Black,i=r===J.ColorsAsWords.White?a():x().slice(-1)[0],o=d(e,r);i.appendChild(o)}function I(e){let t=Lc(e,T());!t||t.length!==3||t.forEach(e=>{e.querySelector(zc(MS.Classes.MoveInfoIcon))||e.appendChild(f())})}function re(e,t){t.classList.add(Rc(ja(e)))}function ie(e,t){t.title=e}function L( _hh$temp359 ,a){ var e=_hh$temp359.baseTime,n=_hh$temp359.ply,r=_hh$temp359.value,i=_hh$temp359.timestamp; let o=a||k(n);if(!o)return;let s=ee(),c=y();if(o.setAttribute(yC.DOM.Attributes.Time,i.toString()),o.style.setProperty(yC.DOM.CSSVariables.TimeValue,i.toString()),o.innerHTML=r,(!s||r.length*vC>s)&&R(r.length),e){let n=Ic(i,ta(e));o.style.setProperty(yC.DOM.CSSVariables.TimeBarWidth,`${n}px`),t.classList.add(yC.DOM.ClassNames.WithBaseTime),c&&F(null);return}t.classList.remove(yC.DOM.ClassNames.WithBaseTime),(!c||i>c)&&F(i)}function R(e){let n=e*vC;t.style.setProperty(yC.DOM.CSSVariables.TimestampWidth,`${n}px`)}function ae(e,t){let n=w(e);n&&Oc(n,t)}}function Vc(e){let t=Math.ceil(e/10),n=Math.floor(t/(3600*24)),r=Math.floor(t%(3600*24)/3600),i=Math.ceil(t%3600/60);return i===60&&(i=0,r+=1),r===24&&(r=0,n+=1),{days:n,hours:r,minutes:i}}function Hc(e,t){ let _hh$temp360=Vc(e),n=_hh$temp360.days,r=_hh$temp360.hours,i=_hh$temp360.minutes,a={days:r>0||i>0?`, `:``,hours:i>0?`, `:``}; return`${n>0?`${ __call$(t,Y.Translation.Plural.NumberOfDays,[n]) }${a.days}`:``}${r>0?`${ __call$(t,Y.Translation.Plural.NumberOfHours,[r]) }${a.hours}`:``}${i>0?`${ __call$(t,Y.Translation.Plural.NumberOfMinutes,[i]) }`:``}`}function Uc(e,t){ let _hh$temp361=Vc(e),n=_hh$temp361.days,r=_hh$temp361.hours,i=_hh$temp361.minutes; return n?n>0?`${ __call$(t,Y.Translation.Plural.NumberOfDays,[n]) }`:``:r?r>0?`${ __call$(t,Y.Translation.Plural.NumberOfHours,[r]) }`:``:i>0?`${ __call$(t,Y.Translation.Plural.NumberOfMinutes,[i]) }`:``}function Wc(e){let t=Math.floor(e/600),n=((e-t*600)/10).toFixed(1);return t===0?n:`${t}:${`0${n}`.substr(-4)}`}function Gc( _hh$temp362 ){ var e=_hh$temp362.formatTimestampAsHumanReadable,t=_hh$temp362.timestamp,n=_hh$temp362.translations; return{title:e?Hc(t,n):void 0,value:e?Uc(t,n):Wc(t)}}function Kc( _hh$temp363 ){ var _hh$temp363$colorsEnabled=_hh$temp363.colorsEnabled,e=_hh$temp363$colorsEnabled===void 0?!1:_hh$temp363$colorsEnabled,t=_hh$temp363.el,_hh$temp363$epIconInfoPath=_hh$temp363.epIconInfoPath,n=_hh$temp363$epIconInfoPath===void 0?bC.enPassant:_hh$temp363$epIconInfoPath,r=_hh$temp363.getTimeControl,_hh$temp363$formatTimestampAsHumanReadable=_hh$temp363.formatTimestampAsHumanReadable,i=_hh$temp363$formatTimestampAsHumanReadable===void 0?!1:_hh$temp363$formatTimestampAsHumanReadable,_hh$temp363$moveListDisplayType=_hh$temp363.moveListDisplayType,a=_hh$temp363$moveListDisplayType===void 0?Qb.MoveListDisplayTypes.Text:_hh$temp363$moveListDisplayType,o=_hh$temp363.scrollContainer,_hh$temp363$showResultNode=_hh$temp363.showResultNode,s=_hh$temp363$showResultNode===void 0?!0:_hh$temp363$showResultNode,_hh$temp363$showTimestamps=_hh$temp363.showTimestamps,c=_hh$temp363$showTimestamps===void 0?!0:_hh$temp363$showTimestamps,_hh$temp363$toggleTimestamps=_hh$temp363.toggleTimestamps,l=_hh$temp363$toggleTimestamps===void 0?!1:_hh$temp363$toggleTimestamps,_hh$temp363$translations=_hh$temp363.translations,u=_hh$temp363$translations===void 0?jS:_hh$temp363$translations; let d=r,f=Bc({colorsEnabled:e,el:t,EPIconInfoPath:n,moveListDisplayType:a,scrollContainer:o,toggleTimestamps:l,translations:u});return f.createList(),{addNode:p,addThreeFoldIcons:b,create:f.createList,deselectNode:f.deselectNode,destroy:f.destroyList,enableColors:f.enableColors,loadNodes:g,selectNode:_,setMoveListDisplayType:v,setResult:y,setGetTimeControl:x,updateNodeColor:f.updateNodeColor,updateTimestamp:S};function p(e){let t=f.getResult();t!==J.Results.None&&f.setResultNode(J.Results.None),f.addNode(e),m(e),t!==J.Results.None&&f.setResultNode(t)}function m(e){let t=yo(e);if(!t||!c)return; let _hh$temp364=Gc({formatTimestampAsHumanReadable:i,timestamp:t,translations:u}),n=_hh$temp364.title,r=_hh$temp364.value; f.addTimestamp({baseTime:h(),node:e,timestamp:t,title:n,value:r})}function h(){return d?.()?.baseTime}function g(e,t){let n=f.getResult();f.clearList(),e.forEach(e=>{f.addNode(e),m(e)}),n!==J.Results.None&&f.setResultNode(n);let r=t??f.getLastPly();r!==void 0&&f.selectNode(r),f.scrollToSelectedNode()}function _(e){e===void 0?f.deselectNode():typeof e==`number`?f.selectNode(e):f.selectNodeElement(e),f.scrollToSelectedNode()}function v(e){f.setParams({moveListDisplayType:e})}function y(e){if(!s){f.getResult()!==J.Results.None&&f.setResultNode(J.Results.None);return}f.setResultNode(e)}function b(e){f.addThreeFoldMoveIcons(e)}function x(e){d=e}function S(e){ let _hh$temp365=e,t=_hh$temp365.ply,n=yo(e); if(!t)return;if(n===null)return f.removeTimestamp(t); let _hh$temp366=Gc({formatTimestampAsHumanReadable:i,timestamp:n,translations:u}),r=_hh$temp366.title,a=_hh$temp366.value,o=f.getTimestamp(t); o?o!==n&&f.setTimestampValue({baseTime:h(),ply:t,timestamp:n,value:a}):f.addTimestamp({baseTime:h(),node:e,timestamp:n,title:r,value:a})}}function qc(e){return e?.ids!==void 0}function Jc( _hh$temp367 ){ var _hh$temp367$colorsEnabled=_hh$temp367.colorsEnabled,e=_hh$temp367$colorsEnabled===void 0?!1:_hh$temp367$colorsEnabled,_hh$temp367$displayTimeInClockFormat=_hh$temp367.displayTimeInClockFormat,t=_hh$temp367$displayTimeInClockFormat===void 0?!0:_hh$temp367$displayTimeInClockFormat,n=_hh$temp367.el,_hh$temp367$emitter=_hh$temp367.emitter,r=_hh$temp367$emitter===void 0?s():_hh$temp367$emitter,_hh$temp367$formatTimestampAsHumanReadable=_hh$temp367.formatTimestampAsHumanReadable,i=_hh$temp367$formatTimestampAsHumanReadable===void 0?!t:_hh$temp367$formatTimestampAsHumanReadable,_hh$temp367$loadLineOnCreate=_hh$temp367.loadLineOnCreate,a=_hh$temp367$loadLineOnCreate===void 0?!0:_hh$temp367$loadLineOnCreate,_hh$temp367$namespace=_hh$temp367.namespace,o=_hh$temp367$namespace===void 0?Vb.Plugin.Name:_hh$temp367$namespace,c=_hh$temp367.scrollContainer,_hh$temp367$showResultNode=_hh$temp367.showResultNode,l=_hh$temp367$showResultNode===void 0?!0:_hh$temp367$showResultNode,_hh$temp367$showTimestamps=_hh$temp367.showTimestamps,u=_hh$temp367$showTimestamps===void 0?!0:_hh$temp367$showTimestamps,_hh$temp367$toggleTimestamps=_hh$temp367.toggleTimestamps,d=_hh$temp367$toggleTimestamps===void 0?!1:_hh$temp367$toggleTimestamps,_hh$temp367$translations=_hh$temp367.translations,f=_hh$temp367$translations===void 0?jS:_hh$temp367$translations; let p=!0,m,h=Tc(),g=Cc(!1),_=Kc({el:n,formatTimestampAsHumanReadable:i,getTimeControl:()=>null,scrollContainer:c||n,showResultNode:l,showTimestamps:u,toggleTimestamps:d,translations:f}),v=Ec(_);return{api:e=>({activate:()=>{C(!0),S(Zt(K.APIEvents.Load),e.api)},deactivate:()=>C(!1),...r,getMoveList:()=>_,isActive:()=>!!p,isReady:()=>h.isReady(),waitForVMLReady:h.waitForReady}),create:y,destroy:b,match:[{condition:w,handler:(e,t)=>S(e,t.api)},{condition:xt(K.OptionsEvents.Update),handler:e=>{`enabled`in e.data&&C(e.data.enabled)}}],name:o};function y(t){ let _hh$temp368=t,n=_hh$temp368.api; if(_.setGetTimeControl(n.timeControl.get),_.create(),m=x(n),e&&_.enableColors(e),a){let e=n.getLine(0),t=n.getSelectedNode()?.ply,r=n.getOptions().moveListDisplayType;r===Qb.MoveListDisplayTypes.Figurine&&_.setMoveListDisplayType(r),e?.length&&_.loadNodes(e,t),l&&(_.setResult(n.getResult()),n.getContext().game.inThreefoldRepetition()&&_.addThreeFoldIcons(e))}h.ready(_),r.emit(Vb.Events.Ready,_),p=n.getOptions().enabled}function b(){m?.(),_&&_.destroy()}function x(e){return n.addEventListener(yC.Events.SelectNode,t),function(){n.removeEventListener(yC.Events.SelectNode,t)};function t( _hh$temp369 ){ var t=_hh$temp369.detail; if(!p)return; let _hh$temp370=t,n=_hh$temp370.ids; e.selectNode(n.line,n.move)}}function S(e,t){let n=t.getRelativeNode();g.add(v,{context:t.getContext(),event:e,line:t.getLine?.call(t,0),selectedNode:qc(n)?n:void 0,queue:g}),requestAnimationFrame(()=>{requestAnimationFrame(function(){g.flush(),r.emit(Vb.Events.Updated,_)})})}function C(e){p=e}function w(e){return p&&Ct([...sS,xC.APIEvents.AddMove,K.APIEvents.LineUpdated,K.APIEvents.NodeUpdated,K.APIEvents.DeletePosition,K.APIEvents.UpdatePGNHeaders,K.InstanceEvents.Create,K.InstanceEvents.ModeChanged,K.OptionsEvents.Update])(e)}}function Yc(e){return e.id!==void 0}function Xc(e,t){return!e||Yc(e)?CC.StartingPosition:e.ids.move===Object.keys( __get$(t,e.ids.line) ).length-1?CC.EndOfLineSelected:CC.MiddleOfLineSelected}function Zc( _hh$temp371 ){ var e=_hh$temp371.node,t=_hh$temp371.lines; return Xc(e,t)}function Qc(){return{[K.APIEvents.SelectNode]:Zc,[K.APIEvents.Move]:function( _hh$temp372 ){ var e=_hh$temp372.component,t=_hh$temp372.event;  let _hh$temp373=e,n=_hh$temp373.api,r=_hh$temp373.dom; return n.getMoveNode({line:t.ids.line,move:t.ids.move})?(n.selectNode({line:t.ids.line,move:t.ids.move}),CC.MiddleOfLineSelected):t.ids.line===0?(r.insertNode({node:t}),CC.EndOfLineSelected):(r.insertVariation({node:t}),CC.EndOfLineSelected)}}}function $c(){return{[K.APIEvents.SelectNode]:Zc,[K.APIEvents.Move]:function( _hh$temp374 ){ var e=_hh$temp374.component,t=_hh$temp374.event;  let _hh$temp375=e,n=_hh$temp375.api,r=_hh$temp375.dom; return r.insertNode({node:t,nodeToInsertAfter:n.getSelectedNode()}),CC.EndOfLineSelected}}}function el(){return{[K.APIEvents.SelectNode]:Zc,[K.APIEvents.Move]:function( _hh$temp376 ){ var e=_hh$temp376.component,t=_hh$temp376.event;  let _hh$temp377=e,n=_hh$temp377.api,r=_hh$temp377.dom; return n.getMoveNode({line:t.ids.line,move:t.ids.move})?(n.selectNode({line:t.ids.line,move:t.ids.move}),CC.MiddleOfLineSelected):(r.insertVariation({node:t}),CC.EndOfLineSelected)}}}function tl(){return{initialState:CC.StartingPosition,states:{[CC.StartingPosition]:Qc(),[CC.EndOfLineSelected]:$c(),[CC.MiddleOfLineSelected]:el()}}}function nl(){return c(tl())}function rl(e,t){let n=e.find(e=>e[0](t));if(n)return n[1](t)}function il( _hh$temp378 ){ var e=_hh$temp378.event; return function(){return e.type===K.APIEvents.AddMove}}function al( _hh$temp379 ){ var e=_hh$temp379.context,t=_hh$temp379.event;  let _hh$temp380=e,n=_hh$temp380.moveList,_hh$temp381=t.data,r=_hh$temp381.listMove; if(!r?.ids)return;let i=n.api.getMoveNode({line:0,move:r.ids.move-1});n.dom.insertNode({node:r,nodeToInsertAfter:i})}function ol( _hh$temp382 ){ var e=_hh$temp382.event; return function(){return e.type===K.APIEvents.CreateContinuation}}function sl( _hh$temp383 ){ var e=_hh$temp383.context,t=_hh$temp383.event,n=_hh$temp383.selectedNode;  let _hh$temp384=e,r=_hh$temp384.moveList,_hh$temp384$methods=_hh$temp384.methods,i=_hh$temp384$methods.selectCurrentPosition; if(r.dom.insertVariation({node:t.data.node}),r.api.getMoveNode(t.data.node.ids)){r.api.selectNode(t.data.node.ids);return}i(n)}function cl( _hh$temp385 ){ var e=_hh$temp385.event; return function(){return K.APIEvents.UpdatePGNHeaders===e.type&&e.data.Result}}function ll( _hh$temp386 ){ var e=_hh$temp386.context,t=_hh$temp386.coreContext;  let _hh$temp387=e,n=_hh$temp387.moveList; n.dom.setResultNode(t.api.getResult())}function ul(e){return!!e.getElement().querySelector(Re(DC.Classes.Component))}function dl( _hh$temp388 ){ var e=_hh$temp388.event; return function(){return e.type===K.APIEvents.LineCommentUpdated}}function fl( _hh$temp389 ){ var e=_hh$temp389.context,t=_hh$temp389.event;  let _hh$temp390=e,n=_hh$temp390.moveList,_hh$temp391=t,r=_hh$temp391.data; ul(n.dom)||n.dom.updateLineComponent(r.lineId,{initComment:r.comment})}function pl( _hh$temp392 ){ var e=_hh$temp392.event; return function(){return[K.APIEvents.CreateGame,K.APIEvents.CreateContinuation,K.APIEvents.DeletePosition,K.APIEvents.Load,K.APIEvents.MoveVariation,K.APIEvents.PromoteVariation,K.APIEvents.ResetToMainLine].includes(e.type)||e.data.linesReordered}}function ml( _hh$temp393 ){ var e=_hh$temp393.context,t=_hh$temp393.coreContext,n=_hh$temp393.event,r=_hh$temp393.selectedNode;  let _hh$temp394=e,i=_hh$temp394.moveList,_hh$temp394$methods=_hh$temp394.methods,a=_hh$temp394$methods.destroyContextMenu,o=_hh$temp394$methods.selectCurrentPosition,s=_hh$temp394.queue,_hh$temp395=t,c=_hh$temp395.api; a(),s.flush(),i.dom.load(),i.dom.setResultNode(c.getResult()),n.type===K.APIEvents.DeletePosition&&o(r)}function hl( _hh$temp396 ){ var e=_hh$temp396.event; return function(){return e.type===K.APIEvents.Move}}function gl( _hh$temp397 ){ var e=_hh$temp397.context,t=_hh$temp397.event,n=_hh$temp397.selectedNode;  let _hh$temp398=e,r=_hh$temp398.moveList,i=_hh$temp398.stateMachine,_hh$temp398$methods=_hh$temp398.methods,a=_hh$temp398$methods.selectCurrentPosition; if(r.api.getMoveNode(t.data.move.ids)){r.api.selectNode(t.data.move.ids);return}i.transition(K.APIEvents.Move,{component:r,event:t.data.move,selectedNode:n}),a(n)}function _l( _hh$temp399 ){ var e=_hh$temp399.event; return function(){return e.type===K.APIEvents.NodeUpdated}}function vl( _hh$temp400 ){ var e=_hh$temp400.context,t=_hh$temp400.event;  let _hh$temp401=e,n=_hh$temp401.moveList,_hh$temp402=t,r=_hh$temp402.data; ul(n.dom)||r.ids&&n.dom.updateMoveNodeComponent(r.ids,r.changes)}function yl( _hh$temp403 ){ var e=_hh$temp403.event; return function(){return[K.APIEvents.ResetToMainLine].includes(e.type)}}function bl( _hh$temp404 ){ var e=_hh$temp404.context;  let _hh$temp405=e,t=_hh$temp405.moveList; t.dom.load()}function xl( _hh$temp406 ){ var e=_hh$temp406.event; return function(){return e.type===K.OptionsEvents.Update}}function Sl( _hh$temp407 ){ var e=_hh$temp407.coreContext,t=_hh$temp407.context,n=_hh$temp407.event;  let _hh$temp408=t,r=_hh$temp408.el,i=_hh$temp408.moveList,_hh$temp408$methods=_hh$temp408.methods,a=_hh$temp408$methods.destroyContextMenu,o=e.api.getOptions(); i.api.setOptions(n.data),o.test&&An(r,{[sx.Editable]:n.data.moveListContextMenuEnabled}),n.data.moveListContextMenuEnabled===!1&&a()}function Cl( _hh$temp409 ){ var e=_hh$temp409.event; return function(){return e.type===K.APIEvents.MoveForward||e.type===K.APIEvents.MoveBackward||e.type===K.APIEvents.SelectLineEnd||e.type===K.APIEvents.SelectLineStart||e.type===K.APIEvents.SelectNode||e.type===K.APIEvents.ResetToMainLine}}function wl( _hh$temp410 ){ var e=_hh$temp410.context,t=_hh$temp410.selectedNode;  let _hh$temp411=e,_hh$temp411$methods=_hh$temp411.methods,n=_hh$temp411$methods.selectCurrentPosition; n(t)}function Tl(){return{action:RS.Actions.ClearAnalysis,handler:e,isVisible(){return!0},name:Y.Translation.Actions.ClearAllAnalysis};function e(e, _hh$temp412 ){ var _hh$temp412$context=_hh$temp412.context,t=_hh$temp412$context.game,n=_hh$temp412.event,r=_hh$temp412.moveList; t.hml.contextMenu.requestConfirmation({action:i,data:{event:n},text:`Are you sure you want to clear all analysis?`,type:RS.Actions.ClearAnalysis});function i(){let n=Object.keys(r.api.getNodes()),i=t.getLine(0);if(!i)return;let a={};if(n.length>1)for(let e=n.length-1;e>0;e--){let n=t.getLine(e);if(!n)return;r.dom.removeLine(n),n.parentId===0&&( __set$(a,n.atMoveNode,!0) )}Object.keys(r.api.getComments()).forEach(e=>{ __get$(r.api.getComments(),e) .destroy()}),t.resetToMainLine(),i.forEach(n=>{var i,o;let s=[],c=!1;if( __get$(a,n.ids.move) &&s.push(FC.TouchableKeys.MoveNumber),(n.annotation||n.additionalAnnotation)&&s.push(FC.TouchableKeys.Annotation),n.comment&&n.color===J.ColorsAsNumbers.White&&(c=!0),t.updateNode(n.ids,{additionalAnnotation:void 0,annotation:``,comment:void 0}),(i=e.commands)==null||delete i.href,(o=e.commands)==null||delete o.text,Object.keys(s).length>0||c){let t=r.api.getMoveNode(n.ids);if(!t)throw new LC({code:RC.ElementNotFound,data:e,message:`No move node found.`});s.forEach(e=>{t.touch(e)}),t.touchNextNode()}}),i.initComment&&t.updateLineComment(void 0,i.id)}}}function El(){return{action:RS.Actions.DeleteComment,handler:t,isVisible:e,name:Y.Translation.Actions.DeleteCommentAfter};function e( _hh$temp413 ){ var e=_hh$temp413.node; return typeof e.comment==`string`}function t(e, _hh$temp414 ){ var _hh$temp414$context=_hh$temp414.context,t=_hh$temp414$context.game,n=_hh$temp414.moveList,r=_hh$temp414.moveNodeComponent; t.updateNode(e.ids,{comment:void 0}),n.dom.removeComment(e),r.touchNextNode()}}function Dl(){return{action:RS.Actions.DeleteCommentBefore,handler:t,isVisible:e,name:Y.Translation.Actions.DeleteCommentBefore};function e( _hh$temp415 ){ var e=_hh$temp415.api,t=_hh$temp415.node; if(t.ids.move===0){let n=e.getLine(t.ids.line);return!!(n&&n.initComment)}let n=e.getNodeByIds(t.previous);return qc(n)&&!!n.comment}function t(e, _hh$temp416 ){ var _hh$temp416$context=_hh$temp416.context,t=_hh$temp416$context.game,n=_hh$temp416.moveList,r=_hh$temp416.moveNodeComponent; let i=e,a=t.getLine(e.ids.line);a&&e.ids.move===0?(i=a,t.updateLineComment(void 0,a.id)):(i=t.getNodeByIds(e.previous),t.updateNode(i.ids,{comment:void 0}),r.touch(FC.TouchableKeys.MoveNumber)),n.dom.removeComment(i)}}function Ol(){return{action:RS.Actions.DeleteMove,handler:t,isVisible:e,name:Y.Translation.Actions.DeleteMove};function e( _hh$temp417 ){ var e=_hh$temp417.api,t=_hh$temp417.node; return t.ids.line===0?e.getMode().getOptions().canModifyExistingMovesOnMainLine:!0}function t(e, _hh$temp418 ){ var _hh$temp418$context=_hh$temp418.context,t=_hh$temp418$context.game; t.deletePosition(e.ids.move,e.ids.line)}}function kl(){return{action:RS.Actions.DeleteVariation,handler:t,isVisible:e,name:Y.Translation.Actions.DeleteLine};function e( _hh$temp419 ){ var e=_hh$temp419.node; return e.ids.line!==0}function t(e, _hh$temp420 ){ var _hh$temp420$context=_hh$temp420.context,t=_hh$temp420$context.game,n=_hh$temp420.moveList; t.deletePosition(-1,e.ids.line),n.dom.load()}}function Al(){return{action:RS.Actions.InsertComment,handler:t,isVisible:e,name:Y.Translation.Actions.InsertCommentAfter};function e( _hh$temp421 ){ var e=_hh$temp421.node; return e.comment===void 0}function t(e, _hh$temp422 ){ var t=_hh$temp422.moveList; t.dom.insertEditableComment(e)}}function jl(){return{action:RS.Actions.InsertCommentBefore,handler:t,isVisible:e,name:Y.Translation.Actions.InsertCommentBefore};function e( _hh$temp423 ){ var e=_hh$temp423.api,t=_hh$temp423.node; if(t.ids.move===0){let n=e.getLine(t.ids.line);return!n||!n.initComment}let n=e.getNodeByIds(t.previous);return qc(n)&&!n.comment}function t(e, _hh$temp424 ){ var t=_hh$temp424.moveList,n=_hh$temp424.context;  let _hh$temp425=n,r=_hh$temp425.game,i=e,a=r.getLine(e.ids.line); i=e.ids.move===0&&a?a:r.getNodeByIds(e.previous),t.dom.insertEditableComment(i)}}function Ml(){return{action:RS.Actions.InsertContinuation,handler:t,isVisible:e,name:Y.Translation.Actions.InsertContinuation};function e( _hh$temp426 ){ var e=_hh$temp426.api,t=_hh$temp426.node; let n=e.getRawLines();return t.ids.move=== __get$(n,t.ids.line) .length-1}function t(e, _hh$temp427 ){ var _hh$temp427$context=_hh$temp427.context,t=_hh$temp427$context.game; t.createContinuation()}}function Nl(){return{action:RS.Actions.MoveVariationUp,handler:t,isVisible:e,name:Y.Translation.Actions.MoveVariationUp};function e( _hh$temp428 ){ var e=_hh$temp428.api,t=_hh$temp428.node; if(t.ids.line===0)return!1;let n=e.getLine(t.ids.line);if(!n)return!1;let r=e.getNodeByIds({line:n.parentId,move:n.atMoveNode});return r&&r.lines&&r.lines.length>1?!sc(t,r):!1}function t(e, _hh$temp429 ){ var _hh$temp429$context=_hh$temp429.context,t=_hh$temp429$context.game; t.moveVariation(e.ids.line,!0)}}function Pl(){return{action:RS.Actions.MoveVariationDown,handler:t,isVisible:e,name:Y.Translation.Actions.MoveVariationDown};function e( _hh$temp430 ){ var e=_hh$temp430.api,t=_hh$temp430.node; if(t.ids.line===0)return!1;let n=e.getLine(t.ids.line);if(!n)return!1;let r=e.getNodeByIds({line:n.parentId,move:n.atMoveNode});return r&&r.lines&&r.lines.length>1?!lc(t,r):!1}function t(e, _hh$temp431 ){ var _hh$temp431$context=_hh$temp431.context,t=_hh$temp431$context.game; t.moveVariation(e.ids.line,!1)}}function Fl(){return{action:RS.Actions.PromoteVariation,handler:t,isVisible:e,name:Y.Translation.Actions.Promote};function e( _hh$temp432 ){ var e=_hh$temp432.api,t=_hh$temp432.node; let n=t.ids.line;if(n===0)return!1;let r=e.getLine(n);if(!r)return!1;if(r.parentId===0){ let _hh$temp433=e.getMode().getOptions(),t=_hh$temp433.canAddMovesToMainLine,n=_hh$temp433.canModifyExistingMovesOnMainLine; return t&&n}return!0}function t(e, _hh$temp434 ){ var _hh$temp434$context=_hh$temp434.context,t=_hh$temp434$context.game; t.promoteVariation(e.ids.line,lC.Parent)}}function Il(){return{action:RS.Actions.RemoveAnnotation,handler:t,isVisible:e,name:Y.Translation.Actions.RemoveAnnotation};function e( _hh$temp435 ){ var e=_hh$temp435.node; return!!e.annotation}function t(e, _hh$temp436 ){ var _hh$temp436$context=_hh$temp436.context,t=_hh$temp436$context.game,n=_hh$temp436.moveNodeComponent; t.updateNode(e.ids,{annotation:void 0}),n.touch(FC.TouchableKeys.Annotation)}}function Ll(){return{action:RS.Actions.RemoveAdditionalAnnotation,handler:t,isVisible:e,name:Y.Translation.Actions.RemoveEvaluationAnnotation};function e( _hh$temp437 ){ var e=_hh$temp437.node; return!!(e.additionalAnnotation&&e.additionalAnnotation.length>0)}function t(e, _hh$temp438 ){ var _hh$temp438$context=_hh$temp438.context,t=_hh$temp438$context.game,n=_hh$temp438.moveNodeComponent; t.updateNode(e.ids,{additionalAnnotation:void 0}),n.touch(FC.TouchableKeys.Annotation)}}function Rl(e){return function(t){Object.keys(t).forEach(n=>{ __set$(e.contextMenuActions,n,__get$(t,n)) })}}function zl(e){return ic(e)}function Bl(e){return{api:()=>zl(e),destroy:t,name:RS.Plugin.Name};function t(e){e&&e.game.hml.contextMenu.cancelAllConfirmations()}}function Vl(e){return function(t){ let _hh$temp439=e,n=_hh$temp439.contextMenuActions,r=_hh$temp439.game,i=r.getNodeByIds(t); if(!qc(i))throw new LC({code:RC.BadData,data:t,message:`No move node found`});let a=[];return Object.values(n).forEach(t=>{t&&t.isVisible({api:r,node:i,options:r.getOptions(),state:e.state})&&a.push(t)}),a}}function Hl(e){return function( _hh$temp440 ){ var t=_hh$temp440.line,n=_hh$temp440.move;  let _hh$temp441=e,r=_hh$temp441.state; return  __get$(r.nodes,t) && __get$(__get$(e.state.nodes,t),n) }}function Ul(e){return function(){ let _hh$temp442=e,t=_hh$temp442.state; t.selectedNode&&=(t.selectedNode.set({[FC.Keys.Selected]:!1}),void 0)}}function Wl(e){return function(t){ let _hh$temp443=e,n=_hh$temp443.api,r=_hh$temp443.stateMachine; n.resetSelectedNode(),r.transition(K.APIEvents.SelectNode,{lines:n.getNodes(),node:t}),e.scrollContainer.scrollTop=0}}function Gl( _hh$temp444 ){ var e=_hh$temp444.containerEl,t=_hh$temp444.moveNode,n=_hh$temp444.moveListEl; let r;try{r=t.getElement()}catch{}r&&uo({containerEl:e,moveListEl:n,nodeEl:r})}function Kl(e,t){return t.querySelector(`[${SC.ComponentIdentifier}="line-${e}"]`)}function ql(e,t=[]){requestAnimationFrame(()=>{requestAnimationFrame(()=>{e(...t)})})}function Jl(e){return function( _hh$temp445 ){ var t=_hh$temp445.line,n=_hh$temp445.move;  let _hh$temp446=e,r=_hh$temp446.api,i=_hh$temp446.el,a=_hh$temp446.scrollContainer,o=_hh$temp446.state,s=_hh$temp446.stateMachine; if(t===void 0||n===void 0)return;r.resetSelectedNode();let c=r.getMoveNode({line:t,move:n});c&&(c.set({[FC.Keys.Selected]:!0}),o.selectedNode=c,s.transition(K.APIEvents.SelectNode,{lines:r.getNodes(),node:o.selectedNode.getNodeData()}),ql(()=>{!i.classList.contains(SC.ClassNames.Component)||c.ids.line!==0&&!Kl(c.ids.line,i)||Gl({containerEl:a,moveListEl:i,moveNode:c})}))}}function Yl(e,t){Object.keys(e).forEach(n=>{(Object.keys( __get$(e,n) )||[]).forEach(r=>{t( __get$(__get$(e,n),r) )})})}function ree(e){Yl(e.api.getNodes(),function(e){e.touch(FC.TouchableKeys.San)})}function iee(e){let t=e.state.comments;Object.keys(t).forEach(n=>{ __call$(__get$(t,n),e.options.moveListContextMenuEnabled?`registerClickListeners`:`deregisterClickListeners`,[]) })}function aee(e){let t={moveListContextMenuEnabled:iee,moveListDisplayType:ree};return function(n){Object.keys(e.options).forEach(r=>{if(!(r in n))return;let i= __get$(e.options,r) !== __get$(n,r) ; __set$(e.options,r,__get$(n,r)) ,i&& __get$(t,r) && __call$(t,r,[e]) })}}function oee(e){return{getComments:()=>e.state.comments,getContext:()=>e,getContextMenuActions:Vl(e),getMoveNode:Hl(e),getNodes:()=>e.state.nodes,getOptions:()=>e.options,getSelectedNode:()=>e.state.selectedNode,resetSelectedNode:Ul(e),selectLineStart:Wl(e),selectNode:Jl(e),setOptions:aee(e)}}function Xl(e){let t,n;return{c(){t=F(`span`),n=I(e[2]),R(t,`class`,j(IC.Classes.MoveNumber)+` svelte-66vnx0`)},m(e,r){N(e,t,r),M(t,n)},p(e,t){t&4&&oe(n,e[2])},d(e){e&&P(t)}}}function see(e){let t,n,r,i,a,o,s=(e[4]||``)+``,c,l,u=e[2]&&Xl(e);return{c(){t=F(`span`),u&&u.c(),n=re(),r=F(`span`),i=new rt(!1),a=ie(),o=new rt(!1),i.a=a,o.a=null,R(r,`class`,j(IC.Classes.MoveText)+` svelte-66vnx0`),R(t,`data-id`,e[1]),R(t,`class`,j(IC.Classes.MoveNode)+` svelte-66vnx0`),de(t,`customColor`,e[0]),de(t,`selected`,e[5])},m(d,f){N(d,t,f),u&&u.m(t,null),M(t,n),M(t,r),i.m(e[3],r),M(r,a),o.m(s,r),c||=(l=[L(t,`click`,e[7]),L(t,`contextmenu`,e[6]),L(t,`touchstart`,e[8]),L(t,`touchend`,e[9],{passive:!0})],!0)},p(e, _hh$temp447 ){ var _hh$temp448=__arrayFrom$(_hh$temp447),r=_hh$temp448[0]; e[2]?u?u.p(e,r):(u=Xl(e),u.c(),u.m(t,n)):u&&=(u.d(1),null),r&8&&i.p(e[3]),r&16&&s!==(s=(e[4]||``)+``)&&o.p(s),r&2&&R(t,`data-id`,e[1]),r&1&&de(t,`customColor`,e[0]),r&32&&de(t,`selected`,e[5])},i:S,o:S,d(e){e&&P(t),u&&u.d(),c=!1,E(l)}}}function cee(e,t,n){ let r=ge(),i,_hh$temp449=t,a=_hh$temp449.customColor,_hh$temp450=t,o=_hh$temp450.id,_hh$temp451=t,s=_hh$temp451.moveListEl,_hh$temp452=t,c=_hh$temp452.moveNumber,_hh$temp453=t,l=_hh$temp453.san,_hh$temp454=t,u=_hh$temp454.annotation,_hh$temp455=t,d=_hh$temp455.selected; function f(e){e.preventDefault(),r(IC.Events.OpenContextMenu)}function p(e){r(IC.Events.Click)}function m(e){p(),i=setTimeout(()=>{f(e),i=null},IC.Constants.TouchDelay)}function h(){i&&clearTimeout(i)}function g(e){let t=s.querySelector(`[${SC.ComponentIdentifier}="${o}"]`);t&&Oc(t,e)}return e.$$set=e=>{`customColor`in e&&n(0,a=e.customColor),`id`in e&&n(1,o=e.id),`moveListEl`in e&&n(10,s=e.moveListEl),`moveNumber`in e&&n(2,c=e.moveNumber),`san`in e&&n(3,l=e.san),`annotation`in e&&n(4,u=e.annotation),`selected`in e&&n(5,d=e.selected)},e.$$.update=()=>{e.$$.dirty&1&&g(a)},[a,o,c,l,u,d,f,p,m,h,s]}function lee(e, _hh$temp456 ){ var t=_hh$temp456.anchor,n=_hh$temp456.props; return Ws({ComponentType:BC,options:{anchor:t,props:n,target:e},replaceContainer:!1})}function Zl(e){let t=``;return e.annotation&&(t=`${t}${Js(e.annotation)}`),e.additionalAnnotation&&e.additionalAnnotation[0]&&(t=`${t}&nbsp;${Js(e.additionalAnnotation[0])}`),t}function uee(e,t){return!!(e.color===J.ColorsAsNumbers.White||e.ids&&e.ids.move===0||t&&typeof t.comment==`string`||t&&t.lines&&t.lines.length)}function dee( _hh$temp457 ){ var e=_hh$temp457.color,t=_hh$temp457.ply,_hh$temp457$startingMoveNumber=_hh$temp457.startingMoveNumber,n=_hh$temp457$startingMoveNumber===void 0?1:_hh$temp457$startingMoveNumber; let r;return r=e===J.ColorsAsNumbers.White?Math.ceil(t/2+1):Math.floor(t/2+1),r+(n-1)}function fee(e,t){return!!(e.color===J.ColorsAsNumbers.Black&&(t&&typeof t.comment==`string`||t&&t.lines&&t.lines.length||e.ids&&e.ids.move===0))}function pee( _hh$temp458 ){ var e=_hh$temp458.node,t=_hh$temp458.previous,_hh$temp458$startingMoveNumber=_hh$temp458.startingMoveNumber,n=_hh$temp458$startingMoveNumber===void 0?1:_hh$temp458$startingMoveNumber; let r=``;if(!e)return r;let i=dee({color:e.color,ply:e.moveNumber,startingMoveNumber:n});return uee(e,t)&&(r+=`${i}.`,fee(e,t)&&(r+=`..`)),r}function mee( _hh$temp459 ){ var e=_hh$temp459.moveList,t=_hh$temp459.game,n=_hh$temp459.node,r=_hh$temp459.options,i=_hh$temp459.emitter,a=_hh$temp459.translations; if(Yc(n))throw new LC({code:RC.BadData,data:n,message:`Invalid move ids.`});let o=lee(r.target,{anchor:r.anchor,props:{annotation:Zl(n),id:u(),moveListEl:e.dom.getElement(),moveNumber: __call$(VC,FC.Keys.MoveNumber,[c()]) ,san: __call$(VC,FC.Keys.San,[c()]) ,selected:!1}}),s={addNodeStyles:_,destroy:o.destroy,getElement:l,getId:u,getNodeData:d,ids:n.ids,insertBeforeNode:h,insertAfterNode:g,removeNodeStyles:v,set:o.set,touch:p,touchNextNode:m};return f(),s;function c(){return{game:{getNodeByIds:t.getNodeByIds,getStartingMoveNumber:t.getStartingMoveNumber},moveList:{getOptions:e.api.getOptions},node:d(),translations:a}}function l(){let t=e.dom.getElement(),r=`[${SC.ComponentIdentifier}="${u()}"]`,i=t.querySelector(r)??o.el.querySelector(r);if(!i)throw new LC({code:RC.ElementNotFound,data:n.ids,message:`Move node element was not found for ${n.ids.line}-${n.ids.move}.`});return i}function u(){let e=n.ids;return`move-node-${e.line}-${e.move}`}function d(){return t.getNodeByIds(n.ids)}function f(){o.on(IC.Events.Click,function(){e.api.getOptions().enabled&&t.selectNode(n.ids.line,n.ids.move)}),o.on(IC.Events.OpenContextMenu,function(){e.api.getOptions().moveListContextMenuEnabled&&(t.selectNode(n.ids.line,n.ids.move),i.emit(IC.Events.OpenContextMenu,{node:n}))})}function p(e){o.set({[e]: __call$(VC,e,[c()]) })}function m(t=[FC.TouchableKeys.MoveNumber]){let r=e.api.getMoveNode({line:n.ids.line,move:n.ids.move+1});r&&t.forEach(e=>r.touch(e))}function h(e){let t=l();t.parentNode&&t.parentNode.insertBefore(e,t)}function g(t){let n=e.dom.getElement(),r=l();r.nextElementSibling?n.insertBefore(t,r.nextElementSibling):n.appendChild(t)}function _(e){let t=l();e&& __call$(Object,"assign",[t.style,e]) }function v(){l().removeAttribute(`style`)}}function hee(e){return function(t,n){ let _hh$temp460=e,r=_hh$temp460.game,i=_hh$temp460.getComponent,a=_hh$temp460.state,o=_hh$temp460.stateMachine,s=_hh$temp460.translations,c=t.ids; return  __get$(a.nodes,c.line) ===void 0&&( __set$(a.nodes,c.line,{}) ), __get$(__get$(a.nodes,c.line),c.move) !==void 0&& __get$(__get$(a.nodes,c.line),c.move) .destroy(), __set$(__get$(a.nodes,c.line),c.move,mee({emitter:o,game:r,moveList:i()??e.el,node:t,options:n,translations:s})) , __get$(__get$(a.nodes,c.line),c.move) }}function Ql(e){e.preventDefault()}function gee(e){return function(){ let _hh$temp461=e,t=_hh$temp461.dom,n=_hh$temp461.el,r=_hh$temp461.queue; n.classList.remove(SC.ClassNames.Component),n.removeEventListener(`contextmenu`,Ql),t.reset(),r.clear()}}function $l(e){if(e===void 0)return;let t;return t=zs(Bs(e)),t===` `&&(t=``),t}function eu(e){let t,n,r,i,a;return{c(){t=F(`span`),n=I(e[2]),R(t,`class`,j(DC.Classes.Component)+` svelte-1toz211`),R(t,`contenteditable`,`true`),R(t,`placeholder`,r= __call$(e[0],`Add Comment...`,[]) )},m(r,o){N(r,t,o),M(t,n),e[7](t),i||=(a=[L(t,`focusin`,e[3]),L(t,`focusout`,e[4]),L(t,`input`,e[5])],!0)},p(e, _hh$temp462 ){ var _hh$temp463=__arrayFrom$(_hh$temp462),i=_hh$temp463[0]; i&4&&se(n,e[2]),i&1&&r!==(r= __call$(e[0],`Add Comment...`,[]) )&&R(t,`placeholder`,r)},i:S,o:S,d(n){n&&P(t),e[7](null),i=!1,E(a)}}}function tu(e,t,n){ let r,i=ge(),_hh$temp464=t,_hh$temp464$comment=_hh$temp464.comment,a=_hh$temp464$comment===void 0?``:_hh$temp464$comment,_hh$temp465=t,o=_hh$temp465.translations,s; function c(){a&&document.execCommand(`selectAll`,!1,null)}function l(){i(DC.Events.FocusOut,s.innerHTML)}function u(){i(DC.Events.CommentChanged,s.innerHTML)}z(()=>{s.focus()});function d(e){ __call$(ot,e?`unshift`:`push`,[()=>{s=e,n(1,s);}]) }return e.$$set=e=>{`comment`in e&&n(6,a=e.comment),`translations`in e&&n(0,o=e.translations)},e.$$.update=()=>{e.$$.dirty&64&&n(2,r=a||``)},[o,s,r,c,l,u,a,d]}function nu(e, _hh$temp466 ){ var t=_hh$temp466.anchor,n=_hh$temp466.props; return Ws({ComponentType:HC,options:{anchor:t,props:n,target:e},replaceContainer:!1})}function ru(e, _hh$temp467 ){ var t=_hh$temp467.api,n=_hh$temp467.comment,r=_hh$temp467.moveList,i=_hh$temp467.noUIUpdates; t.updateLineComment(typeof n==`string`&&n.length>0?n:void 0,e.id),!i&&e.initComment&&(e.id===0?r.dom.getElement():Kl(e.id,r.dom.getElement())).prepend(r.dom.addComment(e))}function iu(e, _hh$temp468 ){ var t=_hh$temp468.moveList,n=_hh$temp468.api; let r,i;i=e.id===0?t.dom.getElement():Kl(e.id,t.dom.getElement());let a=t.api.getMoveNode({line:e.id,move:0});return a&&(r=a.getElement()),{anchor:r,comment:e.initComment,element:i,handler:function(r,i){ru(e,{api:n,comment:r,moveList:t,noUIUpdates:i})}}}function au(e, _hh$temp469 ){ var t=_hh$temp469.api,n=_hh$temp469.comment,r=_hh$temp469.moveList,i=_hh$temp469.noUIUpdates; t.updateNode(e.ids,{comment:typeof n==`string`&&n.length>0?n:void 0}),!i&&(e.getNodeData().comment&&e.getElement().appendChild(r.dom.addComment(e.getNodeData())),e.touchNextNode())}function ou(e, _hh$temp470 ){ var t=_hh$temp470.moveList,n=_hh$temp470.api; let r=t.api.getMoveNode(e.ids);if(!r)throw new LC({code:RC.ElementNotFound,data:e,message:`No move node found.`});return{comment:e.comment,element:r.getElement(),handler:function(e,i){au(r,{api:n,comment:e,moveList:t,noUIUpdates:i})}}}function su(e){return function(t){ let _hh$temp471=e,n=_hh$temp471.dom,r=_hh$temp471.game,i=_hh$temp471.getComponent,a=_hh$temp471.translations,o,s; if(qc(t))o=ou(t,{api:r,moveList:i()});else if(Yc(t))o=iu(t,{api:r,moveList:i()});else throw new LC({code:RC.BadData,data:t,message:`No line or node found`});n.removeEditableComment(),e.editableCommentComponent=nu(o.element,{anchor:o.anchor,props:{comment:o.comment,translations:a}}),e.editableCommentComponent.on(DC.Events.CommentChanged,function( _hh$temp472 ){ var e=_hh$temp472.detail; clearTimeout(s),s=window.setTimeout(()=>{c(e)},DC.Constants.CommentUpdateDelay)}),e.editableCommentComponent.on(DC.Events.FocusOut,function( _hh$temp473 ){ var t=_hh$temp473.detail; clearTimeout(s);let n=$l(t)??``;o.handler(n),e.dom.removeEditableComment()});function c(e=``){let t=$l(e)??``;o.handler(t,!0)}}}function cu(e){if(Yc(e))return`line-comment-${e.id}`;if(qc(e))return`move-node-comment-${e.ids.line}-${e.ids.move}`;throw new LC({code:RC.BadData,data:e,message:`No line or node found`})}function lu(e){return e.split(` `).map(e=>qs(e)?Js(e):e).join(` `)}function uu( _hh$temp474 ){ var e=_hh$temp474.commentLinkData,t=_hh$temp474.lineOrNode,n=_hh$temp474.context; let r=cu(t),i=!1,a,o,s;if(Yc(t))a=lu(t.initComment),s={line:t.id,move:0};else if(qc(t))a=t.comment?lu(t.comment):t.comment,s=t.ids;else throw new LC({code:RC.BadData,data:t,message:`No line or node found`});return c(),{deregisterClickListeners:d,destroy:l,getElement:()=>o,getId:()=>r,registerClickListeners:u};function c(){let t=e?`a`:`span`;o=document.createElement(t),o.setAttribute(SC.ComponentIdentifier,r),o.innerHTML=Bs((e?.text??a)||``,!0),o.classList.add(IC.Classes.Comment,IC.Classes.StaticComment),e&&(o.setAttribute(`href`, __get$(e,"href") ),o.setAttribute(`target`,`_blank`)),n.editingEnabled&&!e&&u()}function l(){d(),n.removeCommentFromMoveList(r)}function u(){i||=(o.addEventListener(`click`,f,{once:!0}),o.addEventListener(`contextmenu`,p),!0)}function d(){o.removeEventListener(`click`,f),o.removeEventListener(`contextmenu`,p),i=!1}function f(){l(),n.emitter.emit(UC.Events.Click,t)}function p(e){e.preventDefault(),n.emitter.emit(IC.Events.OpenContextMenu,{node:{ids:s}})}}function du(e){return function(t,n=!0,r){ let _hh$temp475=e,i=_hh$temp475.dom,a=_hh$temp475.options,o=_hh$temp475.state,s=_hh$temp475.stateMachine,c=!!(`isCommentEnabled`in t?t.isCommentEnabled:n),l=uu({commentLinkData:r??null,lineOrNode:t,context:{editingEnabled:a.moveListContextMenuEnabled&&c,emitter:s,removeCommentFromMoveList(){i.removeComment(t);}}}); return  __get$(o.comments,l.getId()) &&i.removeComment(t), __set$(o.comments,l.getId(),l) ,l.getElement()}}function fu(e){return e===0}function pu(e){return function( _hh$temp476 ){ var t=_hh$temp476.node,n=_hh$temp476.nodeToInsertAfter;  let _hh$temp477=e,r=_hh$temp477.dom,i=_hh$temp477.el,a=_hh$temp477.placeholders,o=__get$(a,SC.Placeholders.Moves),s=fu(t.ids.line)?o:void 0,c=i; if(n){let e=n.getElement();if(!e)throw new LC({code:RC.ElementNotFound,message:`Node element does not exist.`});c=e.parentNode}r.addNode(t,{anchor:s,target:c})}}function mu(e,...t){let n=document.createElement(`span`);return n.setAttribute(SC.ComponentIdentifier,`line-${e}`),n.classList.add(...t),n}function hu(e){return function( _hh$temp478 ){ var t=_hh$temp478.node;  let _hh$temp479=e,n=_hh$temp479.api,r=_hh$temp479.dom,i=_hh$temp479.el,a=_hh$temp479.game,o=t.ids,s=__get$(a.getRawLines(),o.line),c={line:s.parentId,move:s.atMoveNode},l=n.getMoveNode({line:c.line,move:c.move+1}),u=a.getNodeByIds(c); if(!u)throw new LC({code:RC.ElementNotFound,message:`Anchor node element for variation not found.`});let d=i,f=mu(s.id,SC.ClassNames.Variation);if(u.ids.line===0&&f.classList.add(SC.ClassNames.MainLine),r.addNode(t,{target:f}),u.lines&&u.lines.length>1)d=Kl( __get$(u.lines,u.lines.length-2) ,i);else{let e=n.getMoveNode(u.ids);e&&(d=e.getElement())}d&&d.after(f),l!==void 0&&l.touch(FC.TouchableKeys.MoveNumber)}}function gu(e,t){return t.lines?t.lines.reduce((t,n)=>(t.push( __get$(e,n) ),t),[]):[]}function _u( _hh$temp480 ){ var e=_hh$temp480.api,t=_hh$temp480.depth,n=_hh$temp480.parentLineEl,r=_hh$temp480.lines,i=_hh$temp480.line; let a;a=t===1?document.createDocumentFragment():mu(i.id,SC.ClassNames.Variation),i.initComment&&a.appendChild(e.addComment(i)),i.forEach(n=>{let i=e.addNode(n,{target:a});n.comment&&i.getElement().appendChild(e.addComment(n)),n.lines&&gu(r,n).forEach(n=>{_u({api:e,depth:t+1,line:n,lines:r,parentLineEl:a})})}),n.appendChild(a)}function vu( _hh$temp481 ){ var e=_hh$temp481.dom,t=_hh$temp481.game; t.getRawLines().forEach(n=>{n.forEach(n=>{let r=t.getNodeByIds(n.ids);if(!r)return;let i=r.customColor;i&&e.updateMoveNodeComponent(n.ids,{customColor:i})})})}function yu(e){return function(){ let _hh$temp482=e,t=_hh$temp482.api,n=_hh$temp482.dom,r=_hh$temp482.el,i=_hh$temp482.game,a=_hh$temp482.placeholders,o=__get$(a,SC.Placeholders.Moves); n.reset();let s=i.getRawLines();s[0].initComment&&r.insertBefore(n.addComment(s[0]),o),s[0].forEach(e=>{let t=n.addNode(e,{anchor:o,target:r});if(e.comment&&t.getElement().appendChild(n.addComment(e)),e.commands?.text&& __get$(e.commands,"href",true) ){ let _hh$temp483=e.commands,t=_hh$temp483.text,n=__get$(_hh$temp483,"href"); i.hml.addCommentLink({node:e,text:t,href:n})}e.lines&&gu(s,e).forEach(e=>{let t=mu(e.id,SC.ClassNames.Variation,SC.ClassNames.MainLine);_u({api:{addComment:n.addComment,addNode:n.addNode},depth:1,line:e,lines:s,parentLineEl:t}),r.insertBefore(t,o)})});let c=i.getSelectedNode();c&&t.selectNode(c.ids),vu(e),e.state.nodeLimit&&e.game.hml.updateNodeLimits(e.state.nodeLimit)}}function bu(e,t){let n=t.querySelector(`[${SC.ComponentIdentifier}="${cu(e)}"`);n&&n.parentNode&&n.parentNode.removeChild(n)}function xu(e){return function(t){ let _hh$temp484=e,n=_hh$temp484.state,r=cu(t),i=e.el;  __get$(n.comments,r) &&(bu(t,i),delete n.comments[r])}}function Su(e){return function(){if(e.editableCommentComponent!==void 0){try{e.editableCommentComponent.destroy()}catch{}e.editableCommentComponent=void 0}}}function Cu(e){return function(t){ let _hh$temp485=e,n=_hh$temp485.api,r=_hh$temp485.dom,i=_hh$temp485.el,a=_hh$temp485.state,o=t.id; if( __get$(a.nodes,o) ===void 0)throw new LC({code:RC.BadData,data:t,message:`No line with id ${o} found`}); __get$(a.nodes,o) [0]&&r.removeNode({line:o,move:0});let s=Kl(o,i);s&&s.parentNode.removeChild(s),delete a.nodes[o];let c;t.atMoveNode!==void 0&&t.parentId!==void 0&&(c=n.getMoveNode({line:t.parentId,move:t.atMoveNode+1})),c&&c.touch(FC.TouchableKeys.MoveNumber)}}function wu( _hh$temp486 ){ var e=_hh$temp486.el,t=_hh$temp486.game,n=_hh$temp486.state; let r=t.getRawLines();Object.keys(n.nodes).forEach(t=>{var i; __get$(r,t) ||(Object.values( __get$(n.nodes,t) ).forEach(e=>e.destroy()),(i=Kl(Number(t),e))==null||i.remove(),delete n.nodes[t])})}function Tu(e){return function( _hh$temp487 ){ var t=_hh$temp487.line,n=_hh$temp487.move;  let _hh$temp488=e,r=_hh$temp488.api,i=_hh$temp488.state,a=r.getMoveNode({line:t,move:n}); if(!a)return;let o=Object.keys( __get$(i.nodes,a.ids.line) ).length-1;if( __get$(__get$(i.nodes,a.ids.line),a.ids.move) !== __get$(__get$(i.nodes,a.ids.line),o) )for(let e=o;e>a.ids.move;e--) __get$(__get$(i.nodes,a.ids.line),e) .destroy(),delete  __get$(i.nodes,a.ids.line) [e];a.destroy(),delete  __get$(i.nodes,a.ids.line) [a.ids.move],wu(e);let s=r.getMoveNode({line:a.ids.line,move:a.ids.move+1});s&&s.touch(FC.TouchableKeys.MoveNumber)}}function Eu(e){return function(){ let _hh$temp489=e,t=_hh$temp489.dom,n=_hh$temp489.el,r=_hh$temp489.state,i=_hh$temp489.placeholders; t.removeEditableComment(),n.innerHTML=``,r.comments={},r.nodes={},r.selectedNode=void 0,n.appendChild( __get$(i,SC.Placeholders.Moves) ),n.appendChild( __get$(i,SC.Placeholders.GameResult) )}}function Du(e){return function(t){var n; let _hh$temp490=e,r=_hh$temp490.el,i=r.querySelector(`.${IC.Classes.GameResultNode}`),a=__get$(e.placeholders,SC.Placeholders.GameResult); if(i&&((n=i.parentElement)==null||n.removeChild(i)),t===J.Results.None)return;let o=document.createElement(`span`);o.classList.add(IC.Classes.GameResultNode),o.innerText=t,r.insertBefore(o,a)}}function Ou(e){return function(t,n){ let _hh$temp491=e,r=_hh$temp491.dom,i=_hh$temp491.game,a=i.getLine(t); if(!a)return; let _hh$temp492=n,o=_hh$temp492.initComment; o!==void 0&&(a.id===0?r?.getElement()??e.el:Kl(a.id,e.el))?.prepend(r.addComment(a))}}function ku(e){return function(t,n){ let _hh$temp493=e,r=_hh$temp493.api,i=_hh$temp493.dom,a=_hh$temp493.game,o=a.getNodeByIds(t),s=r.getMoveNode(t); if(!o||!s)return; let c=(s?.getElement()),l=[],_hh$temp494=n,u=_hh$temp494.additionalAnnotation,d=_hh$temp494.annotation,f=_hh$temp494.comment,p=_hh$temp494.customColor,m=_hh$temp494.isCommentEnabled; if((u!==void 0||d!==void 0)&&l.push(FC.TouchableKeys.Annotation),f!==void 0)if(f===``)i.removeComment(o);else{let e=s.getNodeData(),t=i.addComment(e,m??!0);c.appendChild(t)}p!==void 0&&l.push(FC.TouchableKeys.CustomColor),l.forEach(e=>s.touch(e))}}function Au(e){ let _hh$temp495=e,t=_hh$temp495.el,n=_hh$temp495.placeholders; return t.classList.add(SC.ClassNames.Component),t.addEventListener(`contextmenu`,Ql),t.appendChild( __get$(n,SC.Placeholders.Moves) ),t.appendChild( __get$(n,SC.Placeholders.GameResult) ),{addComment:du(e),addNode:hee(e),destroy:gee(e),getElement:()=>t,insertEditableComment:su(e),insertNode:pu(e),insertVariation:hu(e),load:yu(e),removeComment:xu(e),removeEditableComment:Su(e),removeLine:Cu(e),removeNode:Tu(e),reset:Eu(e),setResultNode:Du(e),setScrollContainer:t=>e.scrollContainer=t,updateLineComponent:Ou(e),updateMoveNodeComponent:ku(e)}}function ju(e=[],t,n=s()){let r=new Map,i=t;return o(e),{add:a,addMany:o,destroy:c,...n,getAll:l,getContext:u,getOne:d,has:r.has.bind(r),remove:f,setContext:p};function a(e){var t;return e.name?(r.has(e.name)&&f(e.name),r.set(e.name,e),(t=e.create)==null||t.call(e,i),n.emit(WC.Events.PluginAdded,e),!0):!1}function o(e){return!e||e.length===0?!1:(Array.isArray(e)?e:[e]).reduce(function(e,t){return a(t)||(e=!1),e},!0)}function c(){r.forEach(e=>f(e.name))}function l(){return[...r.values()]}function u(){return i}function d(e){return r.get(e)}function f(e){var t;let a=r.get(e);return a?((t=a.destroy)==null||t.call(a,i),r.delete(e),n.emit(WC.Events.PluginRemoved,a),!0):!1}function p(e){i=e,n.emit(WC.Events.ContextSet,i)}}function Mu(e,t){return function(n,r){let i= __get$(e,n) ;return  __set$(e,n,r(t)) ,function(){var t,r;(r=(t= __get$(e,n) ).destroy)==null||r.call(t), __set$(e,n,i) }}}function Nu(e,t,n){let r=Mu(t,n),i=new Map;return e.on(WC.Events.PluginAdded,function(e){if(e.api){let t=r(e.name,e.api);t&&i.set(e.name,t)}}),e.on(WC.Events.PluginRemoved,function(e){i.get(e.name)?.(),i.delete(e.name)}),e}function Pu(e,t){return Nu(ju([],t),e,t)}function Fu( _hh$temp496 ){ var e=_hh$temp496.el,t=_hh$temp496.game,n=_hh$temp496.nodeLimit,r=_hh$temp496.options,_hh$temp496$plugins=_hh$temp496.plugins,i=_hh$temp496$plugins===void 0?[Bl()]:_hh$temp496$plugins,a=_hh$temp496.stateMachineListeners,o=_hh$temp496.stateMachine,s=_hh$temp496.queue,c=_hh$temp496.placeholders,l=_hh$temp496.scrollContainer,_hh$temp496$translations=_hh$temp496.translations,u=_hh$temp496$translations===void 0?jS:_hh$temp496$translations;  let d={},f={api:d,contextMenuActions:zC,dom:{getElement:()=>e},editableCommentComponent:void 0,el:e,game:t,getComponent:v,options:r,queue:s,placeholders:c,scrollContainer:l,state:{comments:{},nodes:{},nodeLimit:n,selectedNode:void 0},stateMachine:o,stateMachineListeners:a,translations:u},_hh$temp497=f,p=_hh$temp497.dom,m=_hh$temp497.game,h=Pu(m.hml,f); h.addMany(i), __call$(Object,"assign",[d,{...oee(f)}]) , __call$(Object,"assign",[p,{...Au(f)}]) ,m.extendAPI(Eb.Plugin.Name,{addContextMenuActions(){return Rl(f)}});let g={api:d,destroy:_,dom:p,plugins:h};return g;function _(){h.destroy()}function v(){return g}}function Iu( _hh$temp498 ){ var e=_hh$temp498.context,t=_hh$temp498.coreContext; var n,r; let _hh$temp499=e,i=_hh$temp499.el,a=_hh$temp499.nodeLimit,o=_hh$temp499.scrollContainer,s=_hh$temp499.translations,_hh$temp500=t,c=_hh$temp500.api,l=c.getOptions(); (r=(n=e.moveList)?.destroy)==null||r.call(n),e.methods.destroy(),e.stateMachineListeners.push([UC.Events.Click,e.methods.handleCommentClick]),e.stateMachine.on(UC.Events.Click,e.methods.handleCommentClick),e.moveList=Fu({el:i,game:c,nodeLimit:a,options:{enabled:l.enabled,moveListContextMenuEnabled:l.moveListContextMenuEnabled,moveListDisplayType:l.moveListDisplayType},queue:e.queue,placeholders:e.placeholders,scrollContainer:o,stateMachine:e.stateMachine,stateMachineListeners:e.stateMachineListeners,translations:s}),e.moveList.dom.load(),e.moveList.dom.setResultNode(c.getResult())}function Lu( _hh$temp501 ){ var e=_hh$temp501.node,t=_hh$temp501.game,n=_hh$temp501.data,r=_hh$temp501.moveNodeComponent; let i=Js(n),a=r.getNodeData().annotation===i?void 0:i;t.updateNode(e.ids,{annotation:a}),r.touch(FC.TouchableKeys.Annotation)}function Ru( _hh$temp502 ){ var e=_hh$temp502.node,t=_hh$temp502.game,n=_hh$temp502.data,r=_hh$temp502.moveNodeComponent; let i=Js(n),a=r.getNodeData().additionalAnnotation?.[0]===i?void 0:[i];t.updateNode(e.ids,{additionalAnnotation:a}),r.touch(FC.TouchableKeys.Annotation)}function zu(e,t){return function( _hh$temp503 ){ var n=_hh$temp503.action,r=_hh$temp503.data,i=_hh$temp503.event,a=_hh$temp503.moveNode; let o=t.api.getMoveNode(a.ids);if(!o)throw new LC({code:RC.BadData,data:a.ids,message:`No move node found.`});n.handler(a,{context:e,data:r,moveList:t,moveNodeComponent:o,event:i}),e.queue.flush()}}function Bu(e,t,n){let r=e.slice();return r[9]= __get$(t,n) ,r}function Vu(e,t,n){let r=e.slice();return r[12]= __get$(t,n) ,r}function Hu(e){let t,n=( __get$(e[1],e[12].name) ? __call$(e[1],e[12].name,[]) :e[12].name)+``,r,i,a;function o(...t){return e[6](e[12],...t)}return{c(){t=F(`span`),r=I(n),R(t,`class`,j(zS.Classes.ActionName)+` svelte-1rncn27`)},m(e,n){N(e,t,n),M(t,r),i||=(a=L(t,`click`,o),!0)},p(t,i){e=t,i&3&&n!==(n=( __get$(e[1],e[12].name) ? __call$(e[1],e[12].name,[]) :e[12].name)+``)&&oe(r,n)},d(e){e&&P(t),i=!1,a()}}}function Uu(e){let t,n=e[9].display+``,r,i,a,o,s;function c(){return e[7](e[9])}return{c(){t=F(`span`),r=I(n),i=re(),R(t,`alt`,a= __call$(e[1],e[9].meaning,[]) ),R(t,`class`,j(zS.Classes.Annotation)+` svelte-1rncn27`)},m(e,n){N(e,t,n),M(t,r),M(t,i),o||=(s=L(t,`click`,c),!0)},p(n,r){e=n,r&2&&a!==(a= __call$(e[1],e[9].meaning,[]) )&&R(t,`alt`,a)},d(e){e&&P(t),o=!1,s()}}}function Wu(e){let t,n,r,i,a,o,s,c,l=e[0],u=[];for(let t=0;t<l.length;t+=1) __set$(u,t,Hu(Vu(e,l,t))) ;let d=US,f=[];for(let t=0;t<d.length;t+=1) __set$(f,t,Uu(Bu(e,d,t))) ;return{c(){t=F(`div`);for(let e=0;e<u.length;e+=1) __get$(u,e) .c();n=re(),r=F(`div`),i=re(),a=F(`div`);for(let e=0;e<f.length;e+=1) __get$(f,e) .c();o=re(),R(r,`class`,j(zS.Classes.Divider)+` svelte-1rncn27`),R(a,`class`,j(zS.Classes.AnnotationsContainer)+` svelte-1rncn27`),R(t,`class`,j(zS.Classes.Component)+` svelte-1rncn27`)},m(l,d){N(l,t,d);for(let e=0;e<u.length;e+=1) __get$(u,e) && __get$(u,e) .m(t,null);M(t,n),M(t,r),M(t,i),M(t,a);for(let e=0;e<f.length;e+=1) __get$(f,e) && __get$(f,e) .m(a,null);M(t,o),e[8](t),s||=(c=L(document.body,`click`,e[4]),!0)},p(e, _hh$temp504 ){ var _hh$temp505=__arrayFrom$(_hh$temp504),r=_hh$temp505[0]; if(r&11){l=e[0];let i;for(i=0;i<l.length;i+=1){let a=Vu(e,l,i); __get$(u,i) ? __get$(u,i) .p(a,r):( __set$(u,i,Hu(a)) , __get$(u,i) .c(), __get$(u,i) .m(t,n))}for(;i<u.length;i+=1) __get$(u,i) .d(1);u.length=l.length}if(r&10){d=US;let t;for(t=0;t<d.length;t+=1){let n=Bu(e,d,t); __get$(f,t) ? __get$(f,t) .p(n,r):( __set$(f,t,Uu(n)) , __get$(f,t) .c(), __get$(f,t) .m(a,null))}for(;t<f.length;t+=1) __get$(f,t) .d(1);f.length=d.length}},i:S,o:S,d(n){n&&P(t),te(u,n),te(f,n),e[8](null),s=!1,c()}}}function Gu(e,t,n){ let _hh$temp506=t,r=_hh$temp506.actions,_hh$temp507=t,i=_hh$temp507.translations,a=ge(),o; function s(){return o}function c(e){e.target.classList.contains(zS.Classes.Component)||a(RS.Events.Close)}let l=(e,t)=>a(RS.Events.ActionClicked,{action:e,event:t}),u=e=>a(RS.Events.AnnotationClicked,{action:e.action,data:e.code});function d(e){ __call$(ot,e?`unshift`:`push`,[()=>{o=e,n(2,o);}]) }return e.$$set=e=>{`actions`in e&&n(0,r=e.actions),`translations`in e&&n(1,i=e.translations)},[r,i,o,a,c,s,l,u,d]}function Ku(e, _hh$temp508 ){ var t=_hh$temp508.anchor,n=_hh$temp508.props; return Ws({ComponentType:GC,methods:[`getElement`],options:{anchor:t,props:n,target:e},replaceContainer:!1})}function qu( _hh$temp509 ){ var e=_hh$temp509.contextMenu,t=_hh$temp509.moveNode,_hh$temp509$padding=_hh$temp509.padding,n=_hh$temp509$padding===void 0?{x:10,y:20}:_hh$temp509$padding; let r=t.y+n.y-window.pageYOffset,i=window.innerHeight-e.height,a={left:0,top:0};return a.top=Math.min(r,i),a.bottom=a.top+e.height,t.x>window.innerWidth-e.width?a.left=t.x+t.width-e.width:(r<i&&(n.x=0),a.left=t.x+n.x),a}function Ju(e,t){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>{n=null,e(...r)},t)}}function Yu(e){let t;return function(...n){t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{t=null,e(...n)})}}function Xu( _hh$temp510 ){ var e=_hh$temp510.actions,t=_hh$temp510.el,n=_hh$temp510.moveNode,r=_hh$temp510.emitter,i=_hh$temp510.translations; let a=n?.getElement(),o=Ku(a?.parentElement||t,{anchor:a,props:{actions:e,translations:i}});return l(),c(),{destroy:o.destroy};function s(e){return function( _hh$temp511 ){ var t=_hh$temp511.detail; r.emit(e,{action:t.action,data:t.data,event:t.event,moveNode:n.getNodeData()})}}function c(){o.on(RS.Events.ActionClicked,s(RS.Events.ActionClicked)),o.on(RS.Events.AnnotationClicked,s(RS.Events.AnnotationClicked)),o.on(RS.Events.Close,()=>r.emit(RS.Events.Close)),t.addEventListener(`scroll`,Ju(l,50))}function l(){let e=o?.getElement();if(!e)return; let _hh$temp512=qu({contextMenu:e.getBoundingClientRect(),moveNode:(a?.getBoundingClientRect())||t.getBoundingClientRect()}),n=_hh$temp512.left,r=_hh$temp512.top; e.style.left=`${n}px`,e.style.top=`${r}px`}}function Zu(e){ let _hh$temp513=e,t=_hh$temp513.el,n=_hh$temp513.moveList,r=_hh$temp513.stateMachine,_hh$temp513$methods=_hh$temp513.methods,i=_hh$temp513$methods.destroyContextMenu,a=_hh$temp513.translations; e.stateMachineListeners.push([RS.Events.ActionClicked,o],[RS.Events.AnnotationClicked,s],[RS.Events.Close,i],[IC.Events.OpenContextMenu,c]),r.on(RS.Events.Close,i),r.on(RS.Events.ActionClicked,o),r.on(RS.Events.AnnotationClicked,s),r.on(IC.Events.OpenContextMenu,c);function o(e){i(),zu(n.api.getContext(),n)(e)}function s( _hh$temp514 ){ var e=_hh$temp514.action,t=_hh$temp514.data,r=_hh$temp514.moveNode; i();let a=n.api.getMoveNode(r.ids);if(!a)throw new LC({code:RC.BadData,data:r.ids,message:`No move node found.`});let o={data:t,game:n.api.getContext().game,moveNodeComponent:a,node:r};e===RS.AnnotationActions.AddAnnotation?Lu(o):e===RS.AnnotationActions.AddAdditionalAnnotation&&Ru(o)}function c(o){n.api.selectNode(o.node.ids);let s=n.api.getContextMenuActions(o.node.ids);i(),e.contextMenu=Xu({actions:s,el:e.scrollContainer??t,emitter:r,moveNode:n.api.getMoveNode(o.node.ids),translations:a})}}function Qu( _hh$temp515 ){ var e=_hh$temp515.context,t=_hh$temp515.event; return function(){return t.type===K.InstanceEvents.Create||t.type===K.InstanceEvents.ModeChanged||!e.moveList||Object.entries(e.moveList).length===0}}function $u( _hh$temp516 ){ var e=_hh$temp516.context,t=_hh$temp516.coreContext; Iu({context:e,coreContext:t}),e.enableContextMenu&&Zu(e)}function ed(e,t){return function(n){n.selectedNode={...n.coreContext.api.getRelativeNode()},e.add(t,n)}}function td( _hh$temp517 ){ var e=_hh$temp517.conditionParams,t=_hh$temp517.handlerContext;  let _hh$temp518=t.context,n=_hh$temp518.queue; rl([wC,TC,EC,KC,OC,kC,AC,jC,MC,PC,NC].map( _hh$temp519=>{var t=_hh$temp519.condition,r=_hh$temp519.handler;return[t(e),ed(n,r)];} ),t),ql(function(){n.flush()})}function nd(e){return function(t){if(t){if(Yc(t)){e.moveList.api.selectLineStart(t);return}qc(t)&&e.moveList.api.selectNode(t.ids)}}}function rd(e){return function(){e.stateMachineListeners.forEach(( _hh$temp520 )=>{ var _hh$temp521=__arrayFrom$(_hh$temp520),t=_hh$temp521[0],n=_hh$temp521[1]; e.stateMachine.off({handler:n,type:t})}),e.stateMachineListeners=[],!(!e.moveList||!e.moveList?.dom?.destroy)&&(e.moveList.dom.destroy(),e.moveList.plugins.destroy())}}function id(e){return function(){e.contextMenu&&=(e.contextMenu.destroy(),void 0)}}function ad( _hh$temp522 ){ var e=_hh$temp522.api,t=_hh$temp522.el,_hh$temp522$win=_hh$temp522.win,n=_hh$temp522$win===void 0?window:_hh$temp522$win; let r=n.getSelection(),i=r?.anchorNode,a=r?.focusNode;if(!i||!a)return null;let o=e.getPGN(),s=cd({moveList:t,node:i,pgn:o}),c=cd({moveList:t,node:a,pgn:o});if(s===null||c===null)return null;let l=Math.min(s,c),u=Math.max(s,c),d=dd(ld(s<c?a:i)).length,f=u+d-l,p=o.substr(l,f);return p=od({lastIndex:u+d,pgn:o,pgnPiece:p}),sd(p),p}function od( _hh$temp523 ){ var e=_hh$temp523.lastIndex,t=_hh$temp523.pgn,n=_hh$temp523.pgnPiece; let r=RegExp(`\\${qC}`,`g`),i=(n.match(r)||[]).length,a=n;for(let n=0;n<i&& __get$(t,e+n) ===JC;n++)a+=JC;return a}function sd(e){let t=document.createElement(`textarea`);document.body.append(t),t.value=e,t.focus(),t.select(),document.execCommand(`cut`),t.remove()}function cd( _hh$temp524 ){ var e=_hh$temp524.moveList,t=_hh$temp524.pgn,n=_hh$temp524.node; let r=ld(n),i=dd(r),a=ud(e,r)||0;return t.split(``).findIndex((e,n)=>{if(t.substr(n,i.length)===i){if(a===0)return n;a--}return!1})}function ld(e){return!e.parentNode||(e?.classList)?.contains(IC.Classes.MoveNode)?e:ld(e.parentNode)}function ud(e,t){return Array.from(e.querySelectorAll(`.${IC.Classes.MoveNode}`)).filter(e=>e.textContent===t.textContent).findIndex(e=>e===t)}function dd(e){let t=e.querySelector(`.${IC.Classes.MoveNumber}`),n=e.querySelector(`.${IC.Classes.MoveText}`),r=e.querySelector(`.${IC.Classes.Comment}`),i=``;return t&&(i+=`${t.textContent} `),n&&(i+=n.textContent),r&&(i+=` {${r.textContent}}`),i}function fd( _hh$temp525 ){ var e=_hh$temp525.context,t=_hh$temp525.el; return function(n){n.target.classList?.contains(DC.Classes.Component)||ad({api:e.api,el:t})&&n.preventDefault()}}function pd(e){return function(t){e.moveList.dom.insertEditableComment(t)}}function md( _hh$temp526 ){ var e=_hh$temp526.action,t=_hh$temp526.nodeLimit; let n=e.includes(`Set`);return{action: __get$(RS.Actions,e) ,handler:i,isVisible:r,name: __get$(Y.Translation.Actions,e) };function r( _hh$temp527 ){ var e=_hh$temp527.state; let r= __get$(e.nodeLimit,t,true) ,i=r?.move===e.selectedNode?.getNodeData().move;return n?!r||!i:!!(r&&i)}function i(e, _hh$temp528 ){ var r=_hh$temp528.moveList,i=_hh$temp528.moveNodeComponent; gd({limitType:t,isSettingNodeLimits:n,moveList:r,moveNodeComponent:i,node:e})}}function hd(e,t){ let _hh$temp529=e,n=_hh$temp529.api; return function(){n.addContextMenuActions(YC),bd(e,t)}}function gd( _hh$temp530 ){ var e=_hh$temp530.limitType,t=_hh$temp530.isSettingNodeLimits,n=_hh$temp530.moveList,r=_hh$temp530.moveNodeComponent,i=_hh$temp530.node; var a; let o=n.api.getContext(),s=(__get$(o.state.nodeLimit,e,true)),_hh$temp531=o.game.getContext(),c=_hh$temp531.respond,l; s&&(l=n.api.getMoveNode({line:s.ids.line,move:s.ids.move})),t?_d({limitType:e,moveList:n,moveNodeComponent:r,node:i}):((a=o.state.nodeLimit)==null||delete a[e],vd({limitType:e,moveList:n,moveNodeComponent:r})),l&&vd({limitType:e,moveList:n,moveNodeComponent:l}),c(SC.Events.UpdateNodeLimit,{isSettingNodeLimits:t,limitType:e,node:i})}function _d( _hh$temp532 ){ var e=_hh$temp532.limitType,t=_hh$temp532.moveList,n=_hh$temp532.moveNodeComponent,r=_hh$temp532.node; let i=t.api.getContext();if(i.state.nodeLimit&&( __set$(i.state.nodeLimit,e,r) ),e===SC.NodeLimitTypes.Focus){n.addNodeStyles({fontStyle:`italic`});return}let a=document.createElement(`span`),o=`diagram-${e}`,s=e===SC.NodeLimitTypes.Begin?`[[`:`]]`;a.classList.add(o),a.innerHTML=s,e===SC.NodeLimitTypes.Begin?n.insertBeforeNode(a):e===SC.NodeLimitTypes.End&&n.insertAfterNode(a)}function vd( _hh$temp533 ){ var e=_hh$temp533.limitType,t=_hh$temp533.moveList,n=_hh$temp533.moveNodeComponent; let r=t.dom.getElement().querySelector(`.diagram-${e}`);r?r.remove():n.removeNodeStyles()}function yd(e,t){return function(n){ let _hh$temp534=t,r=_hh$temp534.moveList; e.api.getDiagramNodeLimits||bd(e,t),Object.entries(n).forEach(( _hh$temp535 )=>{ var _hh$temp536=__arrayFrom$(_hh$temp535),e=_hh$temp536[0],t=_hh$temp536[1]; gd({limitType:e,isSettingNodeLimits:!0,moveList:r,moveNodeComponent:r.api.getMoveNode({line:t.ids.line,move:t.ids.move}),node:t})})}}function bd(e,t){let n=t.moveList.api.getContext();n.state.nodeLimit=e.api.getDiagramNodeLimits??{},t.methods.destroyDiagramActions=e.api.extendAPI(Eb.Plugin.Name,{getDiagramNodeLimits(){return n?.state.nodeLimit??{}}})}function xd(e,t){return function( _hh$temp537 ){ var n=_hh$temp537.node,r=_hh$temp537.text,i=__get$(_hh$temp537,"href"); var a,o;let s=t.moveList.dom.addComment(n,!1,{text:r,href:i});e.api.getOptions().test&&An(s,{[sx.Element]:cx.CommentLink}),n.commands||={},e.api.updateNode(n.ids,{commands: __call$(Object,"assign",[n.commands,{href:`${i}`,text:`${r}`}]) }),n.ids.line===0?(a=t.moveList.api.getMoveNode(n.ids))==null||a.getElement().appendChild(s):(o=Kl(n.ids.line,t.el))==null||o.append(s)}}function Sd(e){return function(t){e.scrollContainer=t,e.moveList.dom.setScrollContainer(t)}}function Cd(e,t){return{addDiagramActions:hd(e,t),addCommentLink:xd(e,t),setScrollContainer:Sd(t),updateNodeLimits:yd(e,t)}}function wd( _hh$temp538 ){ var e=_hh$temp538.el,_hh$temp538$enableContextMenu=_hh$temp538.enableContextMenu,t=_hh$temp538$enableContextMenu===void 0?!0:_hh$temp538$enableContextMenu,n=_hh$temp538.nodeLimit,r=_hh$temp538.scrollContainer,_hh$temp538$translations=_hh$temp538.translations,i=_hh$temp538$translations===void 0?jS:_hh$temp538$translations; let a={[SC.Placeholders.GameResult]:document.createComment(`/Game Result`),[SC.Placeholders.Moves]:document.createComment(`/Moves`)},o={contextMenu:void 0,el:e,enableContextMenu:t,methods:{destroy:fC,destroyContextMenu:fC,destroyDiagramActions:fC,handleCommentClick:fC,handleCopy:fC,selectCurrentPosition:fC},moveList:{},nodeLimit:n,queue:Cc(!1),placeholders:a,scrollContainer:r||e,stateMachine:nl(),stateMachineListeners:[],translations:i};return{api:e=>Cd(e,o),create:c,destroy:l,match:[{condition:Ct([K.APIEvents.AddMove,K.APIEvents.CreateContinuation,K.APIEvents.CreateGame,K.APIEvents.DeletePosition,K.APIEvents.LineCommentUpdated,K.APIEvents.Load,K.APIEvents.Move,K.APIEvents.MoveBackward,K.APIEvents.MoveForward,K.APIEvents.MoveVariation,K.APIEvents.NodeUpdated,K.APIEvents.PromoteVariation,K.APIEvents.ResetToMainLine,K.APIEvents.SelectLineEnd,K.APIEvents.SelectLineStart,K.APIEvents.SelectNode,K.APIEvents.Undo,K.APIEvents.UpdatePGNHeaders,K.InstanceEvents.Create,K.OptionsEvents.Update]),handler:f},{condition:xt(K.InstanceEvents.ModeChanged),handler:s}],name:Eb.Plugin.Name};function s(e,t){l(),d(t),u(),f({data:null,type:K.InstanceEvents.ModeChanged},t)}function c(e){l(),d(e),u(),f({data:null,type:K.APIEvents.Load},e)}function l(){var t,n;o.queue.clear(),o.methods.destroy(),(n=(t=o.methods).destroyDiagramActions)==null||n.call(t),e.removeEventListener(SC.Events.Copy,o.methods.handleCopy)}function u(){e.addEventListener(SC.Events.Copy,o.methods.handleCopy)}function d(t){o.methods.destroy=rd(o),o.methods.destroyContextMenu=id(o),o.methods.handleCommentClick=pd(o),o.methods.handleCopy=fd({context:t,el:e}),o.methods.selectCurrentPosition=nd(o)}function f(e,t){td({conditionParams:{context:o,event:e},handlerContext:{context:o,coreContext:t,event:e}})}}function Td(e){return function(){e.boardImages.setFrames(),e.boardImages.clearMarkings(),e.boardImages.hideWindow(),e.boardImages.setWindow(),e.boardImages.setHotkeys()}}function Ed(e){return function(){return[...e.values()]}}function Dd(e){ let _hh$temp539=e,t=_hh$temp539.id,n=_hh$temp539.itemsPerRow,r=_hh$temp539.rows,_hh$temp539$itemsConfiguration=_hh$temp539.itemsConfiguration,i=_hh$temp539$itemsConfiguration===void 0?[]:_hh$temp539$itemsConfiguration; return[...Array(n*r)].map((e,r)=>{ let a=__get$(i,r),_hh$temp540=typeof a==`object`?a:{name:a??`${t}-${r}`},o=_hh$temp540.name,_hh$temp540$animatedImageURL=_hh$temp540.animatedImageURL,s=_hh$temp540$animatedImageURL===void 0?void 0:_hh$temp540$animatedImageURL,_hh$temp540$removalSoundBaseURL=_hh$temp540.removalSoundBaseURL,c=_hh$temp540$removalSoundBaseURL===void 0?void 0:_hh$temp540$removalSoundBaseURL; return{name:o,frameId:t,xIndex:r%n,yIndex:Math.floor(r/n),animatedImageURL:s,removalSoundBaseURL:c}})}function Od(e){let t=new Image;return t.src=e,t}function kd( _hh$temp541 ){ var e=_hh$temp541.api,t=_hh$temp541.framesMap,n=_hh$temp541.shortcuts; return function(e=[]){t.clear(),n.clear(),e.forEach(e=>{t.set(e.id,e),Od(e.imageURL)}),e.map(Dd).forEach(e=>{e.forEach(e=>{n.set(e),e.animatedImageURL&&Od(e.animatedImageURL)})}),r()};function r(){let t=n.getAsArray().filter(e=>e.removalSoundBaseURL);if(!t.length)return;let r=t.reduce((e,t)=>{ let _hh$temp542=t,n=_hh$temp542.name,_hh$temp542$removalSoundBaseURL=_hh$temp542.removalSoundBaseURL,r=_hh$temp542$removalSoundBaseURL===void 0?``:_hh$temp542$removalSoundBaseURL,i=__get$(e,r)??[]; return i.push(n), __set$(e,r,i) ,e},{}),i=Object.keys(r);if(i.length){let t=e.sounds.getSoundsInstance();i.forEach(e=>{t.loadExtra({baseURL:e,codes: __get$(r,e) })})}}}function Ad(e){return function(){return e.getAsArray()}}function jd(e){return function(t){return e.find({name:t})}}function Md( _hh$temp543 ){ var e=_hh$temp543.xIndex,t=_hh$temp543.yIndex,n=_hh$temp543.frameId; return`frameId=${n}, xIndex=${e}, yIndex=${t}`}function Nd(e){if(`xIndex`in e){ let _hh$temp544=e,t=_hh$temp544.xIndex,n=_hh$temp544.yIndex,r=_hh$temp544.frameId; return`Marking shortcut: '${Md({xIndex:t,yIndex:n,frameId:r})}' not found`}return`Marking shortcut: '${e.name}' not found`}function Pd(e,t){return`Frame: '${e}' not found (frames available: ${t.join(`, `)})`}function Fd(e){return`Hotkey combination already in use: ${e.join(`, `)})`}function Id( _hh$temp545 ){ var e=_hh$temp545.markings,t=_hh$temp545.framesMap,n=_hh$temp545.shortcuts; let r=[],i=[];return e.forEach(e=>{ let _hh$temp546=e,a=_hh$temp546.model; (Array.isArray(e.square)?e.square:[e.square]).forEach(o=>{if(typeof a==`string`){let t={data:{square:o,type: __get$(Cb,a) },type:`effect`,persistent:!0,node:!0};r.push({square:o,input:e,marking:t});return} let _hh$temp547=Ld({model:a,shortcuts:n,framesMap:t,square:o}),s=_hh$temp547.customMarking,c=_hh$temp547.itemDisappears; r.push({square:o,input:e,marking:s}),c&&i.push(o)})}),{resultMarkings:r,disappearingMarkingSquares:i}}function Ld( _hh$temp548 ){ var e=_hh$temp548.model,t=_hh$temp548.shortcuts,n=_hh$temp548.framesMap,r=_hh$temp548.square; let i=t.find(e);if(!i)throw Error(Nd(e));let a=n.get(i.frameId);if(!a)throw Error(Pd(i.frameId,[...n.keys()])); let _hh$temp549=i,o=_hh$temp549.xIndex,s=_hh$temp549.yIndex,c=_hh$temp549.animatedImageURL,l=_hh$temp549.removalSoundBaseURL,u=_hh$temp549.name,_hh$temp550=a,d=_hh$temp550.itemsPerRow,f=_hh$temp550.rows,p=_hh$temp550.imageURL,m=c?{imageAnimated:!0,imageURL:c,positionRatioX:0,positionRatioY:0,widthRatio:1,heightRatio:1}:{imageURL:p,positionRatioX:o/d,positionRatioY:s/f,widthRatio:1/d,heightRatio:1/f}; return{customMarking:{data:{square:r,type:vb.Image,removalTimeout:2e3,removalClass:c?void 0:`custom-item__frame--disappear`,removalSound:l?u:void 0,frame:m},type:`customItem`,persistent:!0},itemDisappears:e.autoRemove??!1}}function Rd( _hh$temp551 ){ var e=_hh$temp551.api,t=_hh$temp551.markedSquares,n=_hh$temp551.framesMap,r=_hh$temp551.shortcuts; return function(a){ let _hh$temp552=Id({markings:Array.isArray(a)?a:[a],framesMap:n,shortcuts:r}),o=_hh$temp552.resultMarkings,s=_hh$temp552.disappearingMarkingSquares,c; o.length&&(c=i(o.map(e=>e.marking))),o.forEach((e,n)=>{ let _hh$temp553=e,r=_hh$temp553.input,i=_hh$temp553.marking,a=_hh$temp553.square,o=(__get$(c,n,true))??``; o.length&&i.type!==`effect`&&t.set(a,{input:r,marking:{...i,key:o}})}),s.length&&setTimeout(()=>{e.boardImages.unmark(s)},1500)};function i(t){return t.length?t.length>1?e.markings.addMany(t).map(e=>e??``):[e.markings.addOne(t[0])??``]:[]}}function zd(e,t){return function(n){let r=Array.isArray(n)?n:[n],i=[];r.forEach(e=>{let n=t.get(e);n&&(i.push(n.marking.key),t.delete(e))}),i.length&&(i.length>1?e.markings.removeMany(i):e.markings.removeOne(i[0]))}}function Bd(e){return function(){return[...e.values()].map(e=>e.input)}}function Vd(e,t){return function(){let n=[...e.keys()];n.length&&t.boardImages.unmark(n)}}function Hd(e){return function(t){return e.has(t)}}function Ud(e){return function(){return e.boardImages.getFrames().length>0}}function Wd(e){return function(){return e.window}}function Gd( _hh$temp554 ){ var e=_hh$temp554.boardImagesDOM,t=_hh$temp554.framesMap,n=_hh$temp554.windowState,r=_hh$temp554.hotkeysMap,i=_hh$temp554.shortcuts,a=_hh$temp554.showCloseButton,o=_hh$temp554.api; return function(t){n.window=t,e.clearElement(),t&&(e.setSize(t.widthPercent/(t.boardContainerAspectRatio??1),t.heightPercent),e.setWindow({elements:s(t.elements??[]),elementClickedCallback:t.paletteMode?d:u,closeButtonCallback:a?o.boardImages.hideWindow:void 0,addTitleElement:!t.paletteMode,addHoverElement:t.paletteMode}))};function s(e){let t=new Map,n=e=>[...e,`left click`].join(` + `);return[...r.values()].forEach(e=>{ let _hh$temp555=e,r=_hh$temp555.keys,a=_hh$temp555.model; if(typeof a==`string`)t.set(a,n(r));else{let e=i.find(a);if(e){ let _hh$temp556=e,i=_hh$temp556.xIndex,a=_hh$temp556.yIndex,o=_hh$temp556.frameId; t.set(Md({xIndex:i,yIndex:a,frameId:o}),n(r))}}}),e.map(e=>{if(`frameId`in e)return c(e,t);{ let _hh$temp557=e,n=_hh$temp557.effects,r=_hh$temp557.id,i=_hh$temp557.emptyItemsPerRow,a=_hh$temp557.itemsPerRow; return{id:r,emptyItemsPerRow:i,itemsPerRow:a,effects:n.map(e=>{if(typeof e==`string`){let n=t.get(e);return n?{title:n,type:e}:e}else return e})}}})}function c(e,n){let r=t.get(e.frameId);if(!r){let n=Pd(e.frameId,[...t.keys()]);throw Error(n)} let _hh$temp558=e,i=_hh$temp558.frameId,a=_hh$temp558.emptyItemsPerRow,o=_hh$temp558.itemsAutoRemove,_hh$temp559=r,s=_hh$temp559.itemsPerRow,c=_hh$temp559.rows,u=_hh$temp559.imageURL; return{id:i,emptyItemsPerRow:a,itemsPerRow:s,rows:c,imageURL:u,itemsAutoRemove:o,titles:l(r,n)}}function l(e,t){ let _hh$temp560=e,n=_hh$temp560.itemsPerRow,r=_hh$temp560.rows,i=_hh$temp560.id; return[...Array(n*r)].map((e,r)=>{let a=Md({xIndex:r%n,yIndex:Math.floor(r/n),frameId:i});return t.get(a)??``})}function u(e){n.windowPosition&&(`type`in e?o.boardImages.mark({square:n.windowPosition,model:e.type}):o.boardImages.mark({square:n.windowPosition,model:e}),o.boardImages.hideWindow())}function d(e){let t=o.boardImages.getSelectedMarking();if(`type`in e)e.type===t?o.boardImages.selectMarking():o.boardImages.selectMarking(e.type);else{let n=t;e.frameId===n?.frameId&&e.yIndex===n?.yIndex&&e.xIndex===n?.xIndex?o.boardImages.selectMarking():o.boardImages.selectMarking(e)}}}function Kd(e,t){return Math.min(Math.max(e,t.min),t.max)}function qd( _hh$temp561 ){ var e=_hh$temp561.squareCoords,t=_hh$temp561.heightInPercent,n=_hh$temp561.widthInPercent,r=_hh$temp561.allowOverflow; let i=!1,a=e.x,o=e.y;return r||(o+t>100&&(o=Kd(100-t,{min:0,max:100})),a+n>100&&(a=Kd(a-n-(e.centered?0:12.5),{min:0,max:100}),i=!0)),{top:o,left:a,overflows:i}}function Jd( _hh$temp562 ){ var e=_hh$temp562.windowState,t=_hh$temp562.api,n=_hh$temp562.boardImagesDOM; return function(r){ let _hh$temp563=e,i=_hh$temp563.window,a=_hh$temp563.windowPosition; if(!i)return;if(!r){n.showWindow();return} let _hh$temp564=r,o=_hh$temp564.square,s=_hh$temp564.squareCoords,_hh$temp564$allowWindowOverflow=_hh$temp564.allowWindowOverflow,c=_hh$temp564$allowWindowOverflow===void 0?!1:_hh$temp564$allowWindowOverflow; if(a){let e=t.markings.getAllWhere({types:[nb]}).find(e=>e.data.square===a);e&&t.markings.removeOne(e.key)}e.windowPosition=o,t.markings.addOne({data:{square:o,color:Qb.HighlightColors.Selected,opacity:.5},persistent:!0,type:nb}); let _hh$temp565=qd({squareCoords:s,heightInPercent:i.heightPercent,widthInPercent:i.widthPercent/(i.boardContainerAspectRatio??1),allowOverflow:c}),l=_hh$temp565.top,u=_hh$temp565.left,d=_hh$temp565.overflows; n.setPosition(l,u,d),n.showWindow()}}function Yd( _hh$temp566 ){ var e=_hh$temp566.state,t=_hh$temp566.api,n=_hh$temp566.boardImagesDOM; return function(){ let _hh$temp567=e.windowState,r=_hh$temp567.window,i=_hh$temp567.windowPosition; if(r){if(i){let r=t.markings.getAllWhere({types:[nb]}).find(e=>e.data.square===i);r&&t.markings.removeOne(r.key),e.windowState.windowPosition=void 0,n.setPosition()}e.selectedMarking&&t.boardImages.selectMarking(),n.hideWindow()}}}function Xd(e,t){return function(n){let r=t.isVisible();if(!n){r?e.boardImages.hideWindow():e.boardImages.showWindow();return} let _hh$temp568=n,i=_hh$temp568.square,a=_hh$temp568.squareCoords,_hh$temp568$allowWindowOverflow=_hh$temp568.allowWindowOverflow,o=_hh$temp568$allowWindowOverflow===void 0?!1:_hh$temp568$allowWindowOverflow; i===e.boardImages.getWindowPosition()?e.boardImages.hideWindow():e.boardImages.showWindow({square:i,squareCoords:a,allowWindowOverflow:o})}}function Zd(e){return function(){ let _hh$temp569=e,t=_hh$temp569.window,n=_hh$temp569.windowPosition; if(!(!t||t.paletteMode))return n}}function Qd( _hh$temp570 ){ var e=_hh$temp570.imagesBaseURL,t=_hh$temp570.soundsBaseURL,n=_hh$temp570.paletteMode,r=_hh$temp570.boardContainerAspectRatio; let i={heightPercent:n?100:50,widthPercent:n?100:40,boardContainerAspectRatio:r,paletteMode:n,elements:[{id:`effects`,itemsPerRow:5,effects:[Cb.Brilliant,Cb.GreatFind,Cb.BestMove,Cb.Excellent,Cb.Inaccuracy,Cb.Mistake,Cb.Miss,Cb.Blunder,Cb.Equal,Cb.Correct,Cb.Interesting,Cb.Incorrect,Cb.Book,Cb.Warning,Cb.WinnerWhite]},{frameId:`objective-markers`},{frameId:`emotive-markers`,itemsAutoRemove:!0}]},a=`${e}/animated-images`,o=[{id:`objective-markers`,imageURL:`${e}/objective-markers.png`,rows:1,itemsPerRow:5,itemsConfiguration:[{name:`star`,animatedImageURL:`${a}/star.png`,removalSoundBaseURL:t},{name:`coin`,animatedImageURL:`${a}/coin.png`,removalSoundBaseURL:t},{name:`target`,animatedImageURL:`${a}/target.png`,removalSoundBaseURL:t},{name:`skull`,animatedImageURL:`${a}/skull.png`,removalSoundBaseURL:t},{name:`bomb`,animatedImageURL:`${a}/bomb.png`,removalSoundBaseURL:t}]},{id:`emotive-markers`,imageURL:`${e}/emotive-markers.png`,rows:17,itemsPerRow:5,itemsConfiguration:`happy.sad.wut.wink.cry.cheeky.meh.bigsmile.cringe.mad.blush.shock.dead.sleepy.tongue.lol.crying.horror.love.nerd.glasses.mustache.kisses.mindblow.stareyes.sick.devil.ghost.scream.facepalm.thumbsup.thumbsdown.worship.wave.clap.knuckles.muscle.donkey.clock.fire.troll.donut.earth.panda.unicorn.shakehands.resign.gameover.bullet.blitz.skewer.fork.pin.fish.trophy.arena.puzzle.computer.scc.tt.tilt.960.doubleexclam.doublequestion.10.1.12.hype.gg.rip.present.gold.stockfish.lc0.komodo.danny.omg.robert.hikaru.anna.alexandra.andrea.levy.eric.aman`.split(`.`)}],s=[{keys:[`B`],model:Cb.Brilliant},{keys:[`G`],model:Cb.GreatFind},{keys:[`B`,`E`],model:Cb.BestMove},{keys:[`G`,`D`],model:Cb.Excellent},{keys:[`K`],model:Cb.Correct},{keys:[`E`,`Q`],model:Cb.Equal},{keys:[`I`],model:Cb.Interesting},{keys:[`D`],model:Cb.Inaccuracy},{keys:[`M`],model:Cb.Mistake},{keys:[`L`],model:Cb.Blunder},{keys:[`W`],model:Cb.Incorrect},{keys:[`O`],model:Cb.Book},{keys:[`H`],model:Cb.Warning},{keys:[`shift`,`8`],model:Cb.WinnerWhite},{keys:[`S`],model:{name:`star`}},{keys:[`C`],model:{name:`coin`}},{keys:[`T`],model:{name:`target`}},{keys:[`S`,`K`],model:{name:`skull`}},{keys:[`F`],model:{name:`bomb`}},{keys:[`0`],model:{name:`happy`,autoRemove:!0}},{keys:[`shift`,`S`],model:{name:`sad`,autoRemove:!0}},{keys:[`shift`,`W`],model:{name:`wut`,autoRemove:!0}},{keys:[`shift`,`0`],model:{name:`wink`,autoRemove:!0}},{keys:[`shift`,`R`],model:{name:`cry`,autoRemove:!0}},{keys:[`shift`,`Q`],model:{name:`cheeky`,autoRemove:!0}},{keys:[`shift`,`E`],model:{name:`meh`,autoRemove:!0}},{keys:[`shift`,`B`],model:{name:`bigsmile`,autoRemove:!0}},{keys:[`shift`,`C`],model:{name:`cringe`,autoRemove:!0}},{keys:[`shift`,`1`],model:{name:`mad`,autoRemove:!0}},{keys:[`shift`,`U`],model:{name:`blush`,autoRemove:!0}},{keys:[`shift`,`O`],model:{name:`shock`,autoRemove:!0}},{keys:[`shift`,`D`],model:{name:`dead`,autoRemove:!0}},{keys:[`S`,`E`],model:{name:`sleepy`,autoRemove:!0}},{keys:[`shift`,`P`],model:{name:`tongue`,autoRemove:!0}},{keys:[`shift`,`L`],model:{name:`lol`,autoRemove:!0}},{keys:[`shift`,`I`],model:{name:`crying`,autoRemove:!0}},{keys:[`shift`,`H`],model:{name:`horror`,autoRemove:!0}},{keys:[`shift`,`V`],model:{name:`love`,autoRemove:!0}},{keys:[`shift`,`N`],model:{name:`nerd`,autoRemove:!0}},{keys:[`shift`,`G`],model:{name:`glasses`,autoRemove:!0}},{keys:[`shift`,`T`],model:{name:`mustache`,autoRemove:!0}},{keys:[`shift`,`K`],model:{name:`kisses`,autoRemove:!0}},{keys:[`shift`,`M`],model:{name:`mindblow`,autoRemove:!0}},{keys:[`shift`,`Y`],model:{name:`stareyes`,autoRemove:!0}},{keys:[`S`,`I`],model:{name:`sick`,autoRemove:!0}},{keys:[`D`,`V`],model:{name:`devil`,autoRemove:!0}},{keys:[`G`,`H`],model:{name:`ghost`,autoRemove:!0}},{keys:[`shift`,`J`],model:{name:`scream`,autoRemove:!0}},{keys:[`shift`,`F`],model:{name:`facepalm`,autoRemove:!0}},{keys:[`arrowup`],model:{name:`thumbsup`,autoRemove:!0}},{keys:[`arrowdown`],model:{name:`thumbsdown`,autoRemove:!0}},{keys:[`I`,`P`],model:{name:`worship`,autoRemove:!0}},{keys:[`W`,`V`],model:{name:`wave`,autoRemove:!0}},{keys:[`L`,`P`],model:{name:`clap`,autoRemove:!0}},{keys:[`K`,`N`],model:{name:`knuckles`,autoRemove:!0}},{keys:[`M`,`U`],model:{name:`muscle`,autoRemove:!0}},{keys:[`D`,`K`],model:{name:`donkey`,autoRemove:!0}},{keys:[`L`,`K`],model:{name:`clock`,autoRemove:!0}},{keys:[`F`,`R`],model:{name:`fire`,autoRemove:!0}},{keys:[`T`,`R`],model:{name:`troll`,autoRemove:!0}},{keys:[`N`,`T`],model:{name:`donut`,autoRemove:!0}},{keys:[`E`,`T`],model:{name:`earth`,autoRemove:!0}},{keys:[`P`,`N`],model:{name:`panda`,autoRemove:!0}},{keys:[`U`,`I`],model:{name:`unicorn`,autoRemove:!0}},{keys:[`S`,`H`],model:{name:`shakehands`,autoRemove:!0}},{keys:[`R`,`E`],model:{name:`resign`,autoRemove:!0}},{keys:[`G`,`M`],model:{name:`gameover`,autoRemove:!0}},{keys:[`B`,`U`],model:{name:`bullet`,autoRemove:!0}},{keys:[`B`,`T`],model:{name:`blitz`,autoRemove:!0}},{keys:[`W`,`E`],model:{name:`skewer`,autoRemove:!0}},{keys:[`R`,`R`],model:{name:`fork`,autoRemove:!0}},{keys:[`I`,`N`],model:{name:`pin`,autoRemove:!0}},{keys:[`H`,`I`],model:{name:`fish`,autoRemove:!0}},{keys:[`H`,`Y`],model:{name:`trophy`,autoRemove:!0}},{keys:[`A`,`R`],model:{name:`arena`,autoRemove:!0}},{keys:[`U`,`L`],model:{name:`puzzle`,autoRemove:!0}},{keys:[`M`,`P`],model:{name:`computer`,autoRemove:!0}},{keys:[`S`,`C`],model:{name:`scc`,autoRemove:!0}},{keys:[`T`,`Y`],model:{name:`tt`,autoRemove:!0}},{keys:[`T`,`L`],model:{name:`tilt`,autoRemove:!0}},{keys:[`9`],model:{name:`960`,autoRemove:!0}},{keys:[`2`],model:{name:`doubleexclam`,autoRemove:!0}},{keys:[`3`],model:{name:`doublequestion`,autoRemove:!0}},{keys:[`J`],model:{name:`10`,autoRemove:!0}},{keys:[`Q`],model:{name:`1`,autoRemove:!0}},{keys:[`V`],model:{name:`12`,autoRemove:!0}},{keys:[`Y`],model:{name:`hype`,autoRemove:!0}},{keys:[`G`,`E`],model:{name:`gg`,autoRemove:!0}},{keys:[`R`,`I`],model:{name:`rip`,autoRemove:!0}},{keys:[`P`],model:{name:`present`,autoRemove:!0}},{keys:[`G`,`L`],model:{name:`gold`,autoRemove:!0}},{keys:[`S`,`T`],model:{name:`stockfish`,autoRemove:!0}},{keys:[`L`,`0`],model:{name:`lc0`,autoRemove:!0}},{keys:[`K`,`O`],model:{name:`komodo`,autoRemove:!0}},{keys:[`D`,`N`],model:{name:`danny`,autoRemove:!0}},{keys:[`O`,`M`],model:{name:`omg`,autoRemove:!0}},{keys:[`R`,`B`],model:{name:`robert`,autoRemove:!0}},{keys:[`H`,`K`],model:{name:`hikaru`,autoRemove:!0}},{keys:[`N`,`R`],model:{name:`anna`,autoRemove:!0}},{keys:[`D`,`R`],model:{name:`alexandra`,autoRemove:!0}},{keys:[`E`,`A`],model:{name:`andrea`,autoRemove:!0}},{keys:[`L`,`Y`],model:{name:`levy`,autoRemove:!0}},{keys:[`E`,`C`],model:{name:`eric`,autoRemove:!0}},{keys:[`M`,`N`],model:{name:`aman`,autoRemove:!0}}];return{defaultFrames:o,defaultWindow:i,defaultHotkeys:n?[]:s}}function $d( _hh$temp571 ){ var e=_hh$temp571.api,t=_hh$temp571.boardImagesDOM,n=_hh$temp571.imagesBaseURL,r=_hh$temp571.soundsBaseURL,i=_hh$temp571.paletteContainer; return function(a={}){ let o=__call$(__get$(__get$(window,"location"),"href"),"replace",[__get$(window,"location").search,``]),s=!!i,_hh$temp572=Qd({imagesBaseURL:a.imagesBaseURL??n??`${o}/static/test`,soundsBaseURL:a.soundsBaseURL??r??`${o}/static/test/sounds`,paletteMode:s,boardContainerAspectRatio:a.boardContainerAspectRatio??1}),c=_hh$temp572.defaultFrames,l=_hh$temp572.defaultWindow,u=_hh$temp572.defaultHotkeys; e.boardImages.reset(),e.boardImages.setFrames(c),e.boardImages.setWindow(l),e.boardImages.setHotkeys(u),i&&(t.resetBoardElement(i),t.showWindow())}}function ef(e,t){return function(){e.boardImages.reset(),t.getElement().remove()}}function tf(e){return[...e.map(e=>e.toLowerCase())].sort().join(`-`)}function nf( _hh$temp573 ){ var e=_hh$temp573.hotkeysMap,t=_hh$temp573.windowState,n=_hh$temp573.api; return function(r=[]){e.clear(),r.forEach(t=>{let n=tf(t.keys);if(e.has(n))throw Error(Fd(t.keys));e.set(n,t)}),n.boardImages.setWindow(t.window)}}function rf(e){return function(){return[...e.values()]}}function af(e){return function(t){return e.get(tf(t))}}function of(e,t){return function(n){e.selectedMarking=n,n||t.clearSelection()}}function sf(e){return function(){return e.selectedMarking}}function cf(e){return function(){return e}}function lf( _hh$temp574 ){ var e=_hh$temp574.element,t=_hh$temp574.elements,n=_hh$temp574.addCloseButton,r=_hh$temp574.addTitleElement,i=_hh$temp574.addHoverElement; let a=document.createElement(`div`);a.className=`board-images__window`;let o=document.createElement(`div`);o.className=`board-images__window-body`;let s=document.createElement(`div`);s.className=`board-images__close-button`;let c=document.createElement(`div`);c.innerHTML=XC,s.appendChild(c);let l=document.createElement(`div`);l.className=`board-images__title`;let u=t.map(e=>`effects`in e?uf(e):df(e,i));return u.forEach(e=>{o.appendChild(e.container)}),a.appendChild(o),e.appendChild(a),r&&e.appendChild(l),n&&e.appendChild(s),{closeButton:n?s:void 0,titleElement:l,domElements:u,windowElement:a}}function uf(e){ let _hh$temp575=e,t=_hh$temp575.id,n=_hh$temp575.effects,r=_hh$temp575.itemsPerRow,_hh$temp575$emptyItemsPerRow=_hh$temp575.emptyItemsPerRow,i=_hh$temp575$emptyItemsPerRow===void 0?0:_hh$temp575$emptyItemsPerRow,a=r+i,o=document.createElement(`div`); return o.className=`board-images__effects-container`,{id:t,container:o,domEffects:n.map((e,t)=>{let n=typeof e==`string`?e:e.type,s=document.createElement(`div`);if(s.className=`board-images__effect`,typeof e==`object`&&e.title&&s.setAttribute(`custom-title`,e.title),s.style.width=`${100/a}%`,s.innerHTML=Ln({path: __get$(Yx,n) ,size:`100%`}),i>0&&t/r>0&&t%r===0){let e=document.createElement(`div`);e.className=`board-images__break`,e.style.width=`${100*(i/a)}%`,o.append(e)}return o.append(s),{container:s,type:n}})}}function df(e,t){ let _hh$temp576=e,n=_hh$temp576.id,r=_hh$temp576.itemsPerRow,i=_hh$temp576.rows,a=_hh$temp576.imageURL,_hh$temp576$emptyItemsPerRow=_hh$temp576.emptyItemsPerRow,o=_hh$temp576$emptyItemsPerRow===void 0?0:_hh$temp576$emptyItemsPerRow,s=_hh$temp576.itemsAutoRemove,c=_hh$temp576.titles,l=r+o,u=document.createElement(`div`); u.className=`board-images__hover-container`,u.style.width=`${100*(r/l)}%`;let d=document.createElement(`div`);d.className=`board-images__hover`,d.style.width=`${100/r}%`,d.style.height=`${100/i}%`,d.style.display=`none`;let f=document.createElement(`img`);return f.className=`board-images__image`,f.src=a,f.draggable=!1,u.appendChild(f),t&&u.appendChild(d),{id:n,container:u,imageElement:f,hoverElement:d,itemsPerRow:r,rows:i,itemsAutoRemove:s,titles:c}}function ff( _hh$temp577 ){ var e=_hh$temp577.offsetX,t=_hh$temp577.offsetY,n=_hh$temp577.itemsPerRow,r=_hh$temp577.rows,i=_hh$temp577.width,a=_hh$temp577.height; let o=i/n,s=a/r,c=Kd(e,{min:0,max:i}),l=Kd(t,{min:0,max:a});return{xIndex:Kd(Math.floor(c/o),{min:0,max:n-1}),yIndex:Kd(Math.floor(l/s),{min:0,max:r-1})}}function pf( _hh$temp578 ){ var e=_hh$temp578.clientX,t=_hh$temp578.clientY,n=_hh$temp578.pointer,r=_hh$temp578.type,i=_hh$temp578.touches; return(r===pC.Touchmove||r===pC.Touchstart)&&i.length>0&&($C=i[0].clientX,ew=i[0].clientY),r===pC.Touchend?{x:$C,y:ew}:n?{x:n.x,y:n.y}:i&&i.length>0?{x:i[0].clientX,y:i[0].clientY}:{x:e??ZC,y:t??QC}}function mf( _hh$temp579 ){ var e=_hh$temp579.itemsPerRow,t=_hh$temp579.rows,n=_hh$temp579.imageElement,r=_hh$temp579.event;  let _hh$temp580=n,i=_hh$temp580.width,a=_hh$temp580.height,o,s; if(`offsetX`in r)o=r.offsetX,s=r.offsetY;else{ let _hh$temp581=pf(r),e=_hh$temp581.x,t=_hh$temp581.y; o=e,s=t}return ff({offsetX:o,offsetY:s,itemsPerRow:e,rows:t,width:i,height:a})}function hf( _hh$temp582 ){ var e=_hh$temp582.windowElement,t=_hh$temp582.titleElement,n=_hh$temp582.domElements,r=_hh$temp582.elementClickedCallback,i=_hh$temp582.allowToggling,a=_hh$temp582.closeButton,o=_hh$temp582.closeButtonCallback; var s;e.addEventListener(`contextmenu`,e=>(e.stopPropagation(),e.preventDefault(),!1)),(s=a?.firstChild)==null||s.addEventListener(mC,e=>{e.stopPropagation(),o?.()});let c,l=e=>(c=i&&c?.xIndex===e.xIndex&&c?.yIndex===e.yIndex&&c?.frameId===e.frameId?void 0:e,c),u=()=>{n.filter(e=>`hoverElement`in e).map(e=>e.hoverElement).forEach(e=>{e&&(e.style.display=`none`)}),n.filter(e=>`domEffects`in e).map(e=>e.domEffects).forEach(e=>{e.forEach(e=>e.container.classList.remove(`selected`))})},d=()=>{t.style.display=`none`,t.innerHTML=``};n.forEach(e=>{`domEffects`in e?gf({domElement:e,titleElement:t,hideTitle:d,clearSelection:u,elementClickedCallback:r,allowToggling:i}):_f({domElement:e,titleElement:t,hideTitle:d,clearSelection:u,elementClickedCallback:r,toggleEmoji:l})})}function gf( _hh$temp583 ){ var e=_hh$temp583.domElement,t=_hh$temp583.titleElement,n=_hh$temp583.hideTitle,r=_hh$temp583.clearSelection,i=_hh$temp583.elementClickedCallback,a=_hh$temp583.allowToggling;  let _hh$temp584=e,o=_hh$temp584.domEffects,s=_hh$temp584.id; o.forEach((e,o)=>{ let _hh$temp585=e,c=_hh$temp585.container,l=_hh$temp585.type,u=c.getAttribute(`custom-title`); c.addEventListener(mC,e=>{if(e.stopPropagation(),a){let e=c.classList.contains(`selected`);r(),c.classList.toggle(`selected`,!e)}i({effectsId:s,index:o,type:l})}),u&&(c.addEventListener(hC,()=>{t.innerHTML=u,t.style.display=``}),c.addEventListener(`pointerout`,n))})}function _f( _hh$temp586 ){ var e=_hh$temp586.domElement,t=_hh$temp586.titleElement,n=_hh$temp586.hideTitle,r=_hh$temp586.clearSelection,i=_hh$temp586.elementClickedCallback,a=_hh$temp586.toggleEmoji;  let _hh$temp587=e,o=_hh$temp587.container,s=_hh$temp587.imageElement,c=_hh$temp587.hoverElement,l=_hh$temp587.id,u=_hh$temp587.itemsPerRow,d=_hh$temp587.rows,f=_hh$temp587.itemsAutoRemove,_hh$temp587$titles=_hh$temp587.titles,p=_hh$temp587$titles===void 0?[]:_hh$temp587$titles; o.addEventListener(mC,e=>{e.stopPropagation(); let _hh$temp588=mf({itemsPerRow:u,rows:d,imageElement:s,event:e}),t=_hh$temp588.xIndex,n=_hh$temp588.yIndex; if(i({frameId:l,xIndex:t,yIndex:n,autoRemove:f}),c){let e=a({xIndex:t,yIndex:n,frameId:l});r(),e&&(c.style.display=`block`,c.style.left=`${t/u*100}%`,c.style.top=`${n/d*100}%`)}}),s.addEventListener(hC,e=>{n(); let _hh$temp589=mf({itemsPerRow:u,rows:d,imageElement:s,event:e}),r=_hh$temp589.xIndex,i=_hh$temp589.yIndex; t.innerHTML= __get$(p,r+i*u) ??``,t.style.display=``}),s.addEventListener(`pointerout`,n)}function vf(e){return function(t){ let _hh$temp590=t,n=_hh$temp590.elements,r=_hh$temp590.elementClickedCallback,i=_hh$temp590.closeButtonCallback,_hh$temp590$addTitleElement=_hh$temp590.addTitleElement,a=_hh$temp590$addTitleElement===void 0?!0:_hh$temp590$addTitleElement,_hh$temp590$addHoverElement=_hh$temp590.addHoverElement,o=_hh$temp590$addHoverElement===void 0?!1:_hh$temp590$addHoverElement,_hh$temp591=lf({element:e,elements:n,addCloseButton:!!i,addTitleElement:a,addHoverElement:o}),s=_hh$temp591.closeButton,c=_hh$temp591.titleElement,l=_hh$temp591.domElements,u=_hh$temp591.windowElement; hf({windowElement:u,titleElement:c,domElements:l,elementClickedCallback:r,allowToggling:o,closeButton:s,closeButtonCallback:i})}}function yf(e){return function(){e.classList.remove(`board-images--hidden`)}}function bf(e){return function(){e.classList.add(`board-images--hidden`)}}function xf(e){return function(t,n){e.style.width=t?`${t}%`:``,e.style.height=n?`${n}%`:``}}function Sf(e){let t=`horizontal-overflow`;return function(n,r,i){e.classList.contains(t)&&e.classList.remove(t),e.style.top=n?`${n}%`:``,e.style.left=r?`${r}%`:``,i&&e.classList.add(t)}}function Cf(e){return function(){e.innerHTML=``}}function wf(e){return function(t){e.remove(),t.appendChild(e)}}function Tf(e){return function(){return!e.classList.contains(`board-images--hidden`)}}function Ef(e){return function(){e.querySelectorAll(`.board-images__hover`).forEach(e=>{e.style.display=`none`}),e.querySelectorAll(`.board-images__effect.selected`).forEach(e=>{e.classList.remove(`selected`)})}}function Df(e){let t=n();return{showWindow:yf(t),hideWindow:bf(t),setWindow:vf(t),setSize:xf(t),setPosition:Sf(t),getElement:cf(t),clearElement:Cf(t),resetBoardElement:wf(t),isVisible:Tf(t),clearSelection:Ef(t)};function n(){let t=document.createElement(`div`);return t.className=`board-images`,t.classList.add(`board-images--hidden`),e&&t.classList.add(`board-images--palette`),t.addEventListener(`pointerdown`,e=>{e.stopPropagation()}),t.addEventListener(`wheel`,e=>{e.stopPropagation()}),t}}function Of( _hh$temp592 ={}){ var _hh$temp592$items=_hh$temp592.items,e=_hh$temp592$items===void 0?[]:_hh$temp592$items,_hh$temp592$keys=_hh$temp592.keys,t=_hh$temp592$keys===void 0?[]:_hh$temp592$keys,n=_hh$temp592.createKey; if(!n&&!t.length)throw Error(`Need to specify at least one key or createKey function`);let r=!t.includes(`id`)&&n?[`id`,...t]:t,i=r.map(()=>new Map);e.forEach(e=>{o(e)});function a(e){let t,a=i.find(i=>{let a=!1,o=r.find(t=>{let n= __get$(e,t) ;return n&&(a=!0),n&&i.has(n)});if(o)return t= __get$(e,o) ,!0;let s=n?.(e);if(!a&&!s)throw Error(`Could not find a key or create a key with passed in parameter`);return s&&i.has(s)?(t=s,!0):!1});return t&&a?.get(t)}function o(e){r.forEach((t,r)=>{let a= __get$(e,t) ??n?.(e);a&& __get$(i,r) .set(a,e)})}function s(){return[...i[0]?.values()]}function c(){i.forEach(e=>e.clear())}return{find:a,set:o,getAsArray:s,clear:c}}function kf( _hh$temp593 ){ var e=_hh$temp593.context,t=_hh$temp593.imagesBaseURL,n=_hh$temp593.soundsBaseURL,r=_hh$temp593.showCloseButton,i=_hh$temp593.paletteContainer; let a=e.api,o=new Map,s=new Map,c=new Map,l=Of({keys:[`id`,`name`],createKey:Md}),u={windowPosition:void 0,window:void 0},d=Df(!!i),f={framesMap:o,markedSquares:s,hotkeysMap:c,shortcuts:l,windowState:u};return p(d);function p(e){let p=af(c),m=rf(c),h=Ed(o),g=kd({api:a,framesMap:o,shortcuts:l}),_=Ad(l),v=jd(l),y=zd(a,s),b=Rd({api:a,markedSquares:s,framesMap:o,shortcuts:l}),x=Hd(s),S=Bd(s),C=Vd(s,a),w=Wd(u),T=Yd({state:f,api:a,boardImagesDOM:e}),E=Ud(a),D=Gd({boardImagesDOM:e,framesMap:o,windowState:u,hotkeysMap:c,shortcuts:l,showCloseButton:r,api:a}),O=nf({windowState:u,hotkeysMap:c,api:a}),k=Jd({windowState:u,api:a,boardImagesDOM:e}),ee=Zd(u),A=Xd(a,e),j=Td(a);return{initDefault:$d({api:a,boardImagesDOM:d,imagesBaseURL:t,soundsBaseURL:n,paletteContainer:i}),reset:j,destroy:ef(a,e),isInitialized:E,getFrames:h,setFrames:g,getAllMarkingShortcuts:_,getMarkingShortcut:v,setHotkeys:O,getHotkeys:m,getHotkey:p,mark:b,unmark:y,isMarked:x,getMarkings:S,clearMarkings:C,selectMarking:of(f,e),getSelectedMarking:sf(f),getWindow:w,setWindow:D,showWindow:k,hideWindow:T,toggleWindow:A,getWindowPosition:ee,dom:e}}}function Af(e){return function(t,n){return e in t.data&& __get$(t.data,e) !==void 0&& __get$(t.data,e) !==null}}function jf(e){return function(t,n){return n.api.keys.getPressedKeys().includes(e)}}function Mf( _hh$temp594 ){ var e=_hh$temp594.context,_hh$temp594$squares=_hh$temp594.squares,t=_hh$temp594$squares===void 0?[]:_hh$temp594$squares,n=_hh$temp594.whereOptions; let r=e.api,i=Array.isArray(t)?t:[t],a=n?r.markings.getAllWhere(n):r.markings.getAll();return i.length>0?a.filter(e=>i.includes(e.data.square)):a}function Nf( _hh$temp595 ){ var e=_hh$temp595.getSquares,t=_hh$temp595.whereOptions; return function(n,r){return Mf({context:r,squares:e?.(n,r),whereOptions:t}).length>0}}function Pf( _hh$temp596 ){ var e=_hh$temp596.getSquares,t=_hh$temp596.whereOptions; return function(n,r){return Mf({context:r,squares:e?.(n,r),whereOptions:t}).length===0}}function Ff( _hh$temp597 ){ var e=_hh$temp597.getSquares; return function(t,n){let r=e(t,n);if(!r)return!1;let i=Array.isArray(r)?r:[r],a=n.api;return!!i.find(e=>a.boardImages.isMarked(e))}}function If(e,t){return t.api.keys.getPressedKeys().length>0}function Lf(e,t){return!If(e,t)}function Rf(e,t){let n=t.api,r=n.keys.getPressedKeys();return!!n.boardImages.getHotkey(r)}function zf(e,t){return!!t.api.boardImages.getWindowPosition()}function Bf(e,t){return!t.api.boardImages.isInitialized()}function Vf(e,t){return t.api.boardImages.isInitialized()}function Hf(e,t){return!!t.api.boardImages.getSelectedMarking()}function Uf( _hh$temp598 ){ var e=_hh$temp598.getValue,_hh$temp598$ignoreFirstValue=_hh$temp598.ignoreFirstValue,t=_hh$temp598$ignoreFirstValue===void 0?!1:_hh$temp598$ignoreFirstValue; let n,r=!1;return function(i,a){let o=e(i,a);if(t&&!r)return r=!0,n=o,!1;let s=n!==o;return n=o,s}}function Wf(e,t){ let _hh$temp599=t,n=_hh$temp599.queue,r=t.api; return n.add(r.boardImages.hideWindow),!1}function Gf( _hh$temp600 ){ var e=_hh$temp600.square,t=_hh$temp600.el,n=_hh$temp600.renderer,_hh$temp600$boardFlipped=_hh$temp600.boardFlipped,r=_hh$temp600$boardFlipped===void 0?!1:_hh$temp600$boardFlipped; if(!n)return{x:0,y:0};let i=n.getCoordsFromSquare(e,r);return n.name===nx.Types.WebGL2D?{x:i.x/t.clientWidth*100+6.25,y:i.y/t.clientHeight*100-6.25}:n.name===nx.Types.WebGL3D?{x:i.x/t.clientWidth*100,y:i.y/t.clientHeight*100,centered:!0}:{x:(i.x+100)/800*100,y:i.y/800*100}}function Kf( _hh$temp601 ){ var e=_hh$temp601.getContainer; return function(t,n){let r=e(t,n);if(!r)return; let _hh$temp602=n,i=_hh$temp602.queue,a=_hh$temp602.renderer,o=_hh$temp602.options,s=n.api,c=s.boardImages.getWindowPosition(); if(!c)return;let l=Gf({square:c,el:r,renderer:a,boardFlipped:o.flipped});i.add(s.boardImages.showWindow,{square:c,squareCoords:l})}}function qf( _hh$temp603 ){ var e=_hh$temp603.getContainer; return function(t,n){let r=e(t,n);if(!r)return!0; let _hh$temp604=n,i=_hh$temp604.renderer,a=n.api; return a.boardImages.initDefault({boardContainerAspectRatio:i?.getBoardContainerAspectRatio()}),a.boardImages.dom.resetBoardElement(r),!0}}function Jf( _hh$temp605 ){ var e=_hh$temp605.getSquares; return function(t,n){ let r=(e?.(t,n)),_hh$temp606=n,i=_hh$temp606.queue,a=n.api; return r?i.add(a.boardImages.unmark,r):i.add(a.boardImages.clearMarkings),!1}}function Yf( _hh$temp607 ){ var e=_hh$temp607.getSquare; return function(t,n){let r=e(t,n);if(!r)return!0; let _hh$temp608=n,i=_hh$temp608.queue,a=n.api,o=a.keys.getPressedKeys(),s=a.boardImages.getHotkey(o); return s?(i.add(a.boardImages.mark,{square:r,model:s.model}),!1):!0}}function Xf( _hh$temp609 ){ var e=_hh$temp609.getSquares,t=_hh$temp609.whereOptions; return function(n,r){ let i=(e?.(n,r)),_hh$temp610=r,a=_hh$temp610.queue,o=r.api,s=t?o.markings.getAllWhere(t):o.markings.getAll(),c=Array.isArray(i)?i:[i],l=(i?s.filter(e=>c.includes(e.data.square)):s).map(e=>e.key); return l.length?(l.length===1?a.add(o.markings.removeOne,l[0]):l.length>1&&a.add(o.markings.removeMany,l),!1):!0}}function Zf( _hh$temp611 ){ var e=_hh$temp611.getContainer,t=_hh$temp611.getSquare; return function(n,r){let i=e(n,r),a=t(n,r);if(!i||!a)return!0; let _hh$temp612=r,o=_hh$temp612.queue,s=_hh$temp612.renderer,c=_hh$temp612.options,l=r.api,u=Gf({square:a,el:i,renderer:s,boardFlipped:c.flipped}); return o.add(l.boardImages.toggleWindow,{square:a,squareCoords:u}),!1}}function Qf( _hh$temp613 ){ var e=_hh$temp613.getSquares,t=_hh$temp613.getMarking; return function(n,r){let i=e(n,r),a=t(n,r);if(!i||!a)return!0; let _hh$temp614=r,o=_hh$temp614.queue,s=r.api,c={model:a,square:i}; return o.add(s.boardImages.mark,c),!1}}function $f(e,t){ let _hh$temp615=t,n=_hh$temp615.queue,r=t.api; return n.add(r.boardImages.selectMarking),!1}function ep(e,t){return e.data}function tp(...e){return function(t,n){let r=e.map(e=>e.includes(`.`)?e.split(`.`).reduce((e,t)=> __get$(e,t,true) ,t.data):e.length>0? __get$(t.data,e) :t.data).filter(e=>e!==void 0);if(r.length!==0)return r.length>1?r:r[0]}}function np(e){return function(t,n){return e??n.el}}function rp(){return function(e,t){return t.api.boardImages.getSelectedMarking()}}function ip(e){return[{condition:ir(Ct(sS),Af(nw),Vf,Ff({getSquares:tp(rw,iw)})),handler:Jf({getSquares:tp(rw,iw)})},{condition:ir(xt(K.InstanceEvents.RendererSet),Uf({getValue:ep,ignoreFirstValue:!0}),Vf),handler:qf({getContainer:np(e)})}]}function ap(e){return[{condition:ir(xt(K.OptionsEvents.Update),Af(aw),Vf,zf),handler:Kf({getContainer:np(e)})}]}function op( _hh$temp616 ){ var e=_hh$temp616.keyToOpenWindow,t=_hh$temp616.useLeftClick,n=_hh$temp616.container; let r=t?K.UserEvents.PointerdownLeft:K.UserEvents.PointerdownRight;return[{condition:ir(xt(r),If,Af(tw),Bf),handler:qf({getContainer:np(n)})},{condition:ir(xt(r),If,Af(tw),Vf,Pf({getSquares:tp(tw),whereOptions:{persistent:!0,types:[Sb,gb]}}),jf(e)),handler:Zf({getContainer:np(n),getSquare:tp(tw)})},{condition:ir(Ct([K.UserEvents.PointerdownLeft,K.UserEvents.PointerdownRight]),Lf,Vf,zf),handler:Wf}]}function sp( _hh$temp617 ){ var e=_hh$temp617.keyToOpenWindow,t=_hh$temp617.useLeftClick; let n=t?K.UserEvents.PointerdownLeft:K.UserEvents.PointerdownRight;return[{condition:ir(xt(n),If,Af(tw),Vf,Pf({getSquares:tp(tw),whereOptions:{persistent:!0,types:[Sb,gb]}}),Rf),handler:Yf({getSquare:tp(tw)})},{condition:ir(xt(n),If,Af(tw),Vf,Ff({getSquares:tp(tw)}),yc(jf(e),Rf)),handler:Jf({getSquares:tp(tw)})},{condition:ir(xt(n),If,Af(tw),Vf,Nf({getSquares:tp(tw),whereOptions:{persistent:!0,types:[Sb]}}),yc(jf(e),Rf)),handler:Xf({getSquares:tp(tw),whereOptions:{persistent:!0,types:[Sb]}})}]}function cp(e){let t=e?K.UserEvents.PointerdownLeft:K.UserEvents.PointerdownRight;return[{condition:ir(xt(e?K.UserEvents.PointerdownRight:K.UserEvents.PointerdownLeft),Vf,Hf),handler:$f},{condition:ir(xt(t),Af(tw),Lf,Vf,Pf({getSquares:tp(tw),whereOptions:{persistent:!0,types:[Sb,gb]}}),Hf),handler:Qf({getSquares:tp(tw),getMarking:rp()})},{condition:ir(xt(t),Af(tw),Lf,Vf,Ff({getSquares:tp(tw)}),Hf),handler:Jf({getSquares:tp(tw)})},{condition:ir(xt(t),Af(tw),Lf,Vf,Nf({getSquares:tp(tw),whereOptions:{persistent:!0,types:[Sb]}}),Hf),handler:Xf({getSquares:tp(tw),whereOptions:{persistent:!0,types:[Sb]}})}]}function lp( _hh$temp618 ={}){ var _hh$temp618$keyToOpenWindow=_hh$temp618.keyToOpenWindow,e=_hh$temp618$keyToOpenWindow===void 0?ub.DefaultKeyToOpenWindow:_hh$temp618$keyToOpenWindow,t=_hh$temp618.imagesBaseURL,n=_hh$temp618.soundsBaseURL,_hh$temp618$useLeftClick=_hh$temp618.useLeftClick,r=_hh$temp618$useLeftClick===void 0?!0:_hh$temp618$useLeftClick,i=_hh$temp618.paletteContainer;  let _hh$temp619=p(),a=_hh$temp619.commonBeforeHandlers,o=_hh$temp619.windowBeforeHandlers,s=_hh$temp619.commonHandlers,c=_hh$temp619.windowHandlers,l=_hh$temp619.paletteModeBeforeHandlers,u=!!i; return{api:e=>kf({context:e,imagesBaseURL:t,soundsBaseURL:n,showCloseButton:!u,paletteContainer:i}),beforeState:[...u?l:o,...a],match:[...u?[]:c,...s],name:ub.Plugin.Name,requires:[`keys`,`custom-items`,`effects`,`sounds`],create:d,destroy:f};function d(e){e.api.boardImages.dom.resetBoardElement(i??e.el)}function f(e){e.api.boardImages.destroy()}function p(){return{commonBeforeHandlers:sp({keyToOpenWindow:e,useLeftClick:r}),windowBeforeHandlers:op({keyToOpenWindow:e,useLeftClick:r,container:i}),commonHandlers:ip(i),windowHandlers:ap(i),paletteModeBeforeHandlers:cp(r)}}}function up(){return[Qt(),nn(),Ur(),Gr()]}function dp( _hh$temp620 ={}){ var e=_hh$temp620.exclude; let t={[iS.Plugin.Name]:li,[Zy.Plugin.Name]:St,[rb.Plugin.Name]:Tt,[ib.Plugin.Name]:Nt,[sb.Plugin.Name]:en,[mb.Plugin.Name]:ln,[rS.Plugin.Name]:Jn,[tb.Plugin.Name]:rr,[Db.Plugin.Name]:or,[uS.Plugin.Name]:zr,[$b.Plugin.Name]:tn,[Ob.Plugin.Name]:Hr,[Ib.Plugin.Name]:ii};e&&e.forEach(e=>{delete t[e]});let n=[bi,yi,vi],r=[...up()];return Object.keys(t).forEach(e=>e===tb.Plugin.Name?r.push( __call$(t,e,[n]) ):r.push( __call$(t,e,[]) )),r}function fp(){return[...dp(),qn(),Kn(),Fn(),cn()]}function pp(){return[...fp(),wt(),In(),fi()]}function mp(e){if(e.search(`rgb`)===-1)return e;let t=e.match(sw);return`#${gp(t[1])}${gp(t[2])}${gp(t[3])}`}function hp(e){return e.search(`rgba`)===-1?1:parseFloat(e.match(sw)[4])}function gp(e){return`0${parseInt(e,10).toString(16)}`.slice(-2)}function _p(e,t){return function(n){let r=Object.entries(n).map(( _hh$temp621 )=>{ var _hh$temp622=__arrayFrom$(_hh$temp621),n=_hh$temp622[0],r=_hh$temp622[1]; if(!r||!e.overridableMethods?.includes(n))return;let i= __get$(e,n) ;return  __set$(e,n,r(e,t)) ,function(){ __set$(e,n,i) }});return function(){r.map(e=>e?.())}}}function vp( _hh$temp623 ){ var e=_hh$temp623.base,t=_hh$temp623.initialOptions; return function(n){let r=Object.keys(t).reduce((e,n)=>( __set$(e,n,__get$(t,n).default) ,e),{}),i=e({api:n,options:r}),a=_p(i,n);return  __call$(Object,"assign",[i,{extendMode:a,getOptions:o,setOption:s}]) ;function o(){return r}function s(e,i){if(! __get$(t,e) ?.editable){bp(e);return} __set$(r,e,i) ,n.emit(K.OptionsEvents.UpdateMode,Zt(K.OptionsEvents.UpdateMode,{[e]:i}))}}}function yp(e,t){return function(n={}){return vp({base:e,initialOptions:Object.keys(n).reduce((e,r)=>( __get$(t,r) ?.editable? __call$(Object,"assign",[e,{[r]:{default:__get$(n,r),editable:!0}}]) :bp(r),e),t)})}}function bp(e){console.warn(`${e} is not an editable option in this mode.`)}function xp( _hh$temp624 ){ var e=_hh$temp624.api,_hh$temp624$followAlternateLines=_hh$temp624.followAlternateLines,t=_hh$temp624$followAlternateLines===void 0?!1:_hh$temp624$followAlternateLines,n=_hh$temp624.mv;  let _hh$temp625=e.getContext(),r=_hh$temp625.game,i=_hh$temp625.mutateGame; return i(function(){r.moveForward(t,n)})?.plyDiff?(r.moveBackward(),!0):!1}function Sp( _hh$temp626 ){ var e=_hh$temp626.canAddMovesToMainLine,t=_hh$temp626.isAtEndOfLine,n=_hh$temp626.node; let r=qc(n)?n?.ids?.line:n?.id;return!e&&t&&r===0}function Cp(e,t,n){let r;if(typeof e==`string`)r=Ve.sanToObj(e,t,n);else if(`san`in e)if(`to`in e)r=e;else{ let _hh$temp627=e,i=_hh$temp627.san,a=__rest$Object(_hh$temp627,["san"]),o=Ve.sanToObj(i,t,n); r=o?{...o,...a}:null}else if(`tcn`in e){ let _hh$temp628=e,t=_hh$temp628.tcn,n=__rest$Object(_hh$temp628,["tcn"]); r={...Ve.decodeTCN(t)[0],...n}}else r=e;return r?{animate:!0,...r}:null}function wp(e){ let _hh$temp629=e,t=_hh$temp629.api,n=t.move; return function(e){let r=Cp(e,t.getFEN(),t.getVariant());if(!r)return n(e); let i=t.isAtEndOfLine(),_hh$temp630=t.getMode().getOptions(),a=_hh$temp630.canAddMovesToMainLine; if(xp({api:t,followAlternateLines:!0,mv:r}))return n(e);if(Sp({canAddMovesToMainLine:a,isAtEndOfLine:i,node:t.getRelativeNode()}))return o();return n(e);function o(){return t.createContinuation()?n(e):null}}}function Tp(){return{apiOverrides:{move:wp},name:cw.Plugin.Name}}function Ep( _hh$temp631 ){ var e=_hh$temp631.api; return{isAllowedToMove:t,name:lw.Types.Analysis,plugins:[Tp(),wt()]};function t(){ let _hh$temp632=e.getMode().getOptions(),t=_hh$temp632.canAddMovesToMainLine; return t||!!e.getSelectedNode()||e.getLine(0)?.length}}function Dp(e){return function(t){e.config.set(`items`,t)}}function Op(e){return function(){return e.getHistorySANs()?.length-1||0}}function kp(e,t){return function(){let n=e.captureTheStar;return{completed:t.status.get(`completed`)||!1,completedMoveCount:t.status.get(`completedMoveCount`),itemsRemaining:n.getNumItemsRemaining(),moveCount:n.getCurrentMoveCount()}}}function Ap(e){return function t(n={}){ let _hh$temp633=e,r=_hh$temp633.api,i=_hh$temp633.game,a=r.markings,_hh$temp634=n,o=_hh$temp634.previousNode,s=[]; if(o){let e=i.ids();i.moveBackward(),s=t(),i.selectPosition(e.move,e.line)}else s=a.getAllWhere({types:[gb]});return s}}function jp(e){return function(){return e.captureTheStar.getItems().map(e=>e.data.square)}}function Mp(e,t){ let _hh$temp635=On(e),n=_hh$temp635.file,r=_hh$temp635.rank,_hh$temp636=On(t),i=_hh$temp636.file,a=_hh$temp636.rank,o=`abcdefgh`,s=`12345678`; if(n===i)return Np(r,a).map(e=>`${o.charAt(n-1)}${s.charAt(e-1)}`);if(r===a)return Np(n,i).map(e=>`${o.charAt(e-1)}${s.charAt(r-1)}`);if(Math.abs(i-n)!==Math.abs(a-r))throw Error(`Squares are not on same file, rank, or diagonal`);let c=Np(n,i),l=Np(r,a);return c.reduce((e,t,n)=>(e.push(`${o.charAt(t-1)}${s.charAt( __get$(l,n) -1)}`),e),[])}function Np(e,t){ let _hh$temp637=__arrayFrom$([e,t].sort()),n=_hh$temp637[0],r=_hh$temp637[1]; return Array(r-n-1).fill(void 0).map((e,t)=>n+t+1)}function Pp(e){return function(t){ let n=e.captureTheStar,_hh$temp638=t,r=_hh$temp638.from,i=_hh$temp638.to; if(!r)throw Error(pw.noFromSquareOnMoveObj);let a=[];return a=t.piece.toLowerCase()===`n`?[i]:[i,...Mp(r,i)],n.getItems({previousNode:!0}).filter(e=>!a.includes(e.data.square))}}function Fp(e){return function(){let t=e.captureTheStar;return Object.keys(t.getItems()).length}}function Ip(e){return function(){return!!e.status.get(`completed`)}}function Lp(e,t,n){let r= __get$(e,n,true) ;if(! __get$(vb,n) &&!r)return null;let i={data:{square:t,type:r?vb.Image:vb.Star},node:!0,persistent:!0,type:gb,key:`cts-${t}`};return r&&(i.data.image={url:r}),i}function Rp(e,t){return function(n){ let _hh$temp639=n,r=_hh$temp639.items,i=_hh$temp639.piece,_hh$temp640=e,a=_hh$temp640.api,o=_hh$temp640.game,s=_hh$temp640.respond,c=a.captureTheStar,l=a.markings; if(!Object.keys(r).length)throw Error(pw.cannotLoadWithoutItems);if(!i)throw Error(pw.cannotLoadWithoutPiece);return a.clearMarkings(),o.load(`8/8/8/8/8/8/8/8`),o.put(i,i.square),Object.entries(r).forEach(( _hh$temp641 )=>{ var _hh$temp642=__arrayFrom$(_hh$temp641),e=_hh$temp642[0],n=_hh$temp642[1]; let r=Lp(t.config.get(`items`),e,n);if(!r)throw Error(pw.configurationMissingForItem);l.addOne(r)}),a.setPlayingAs(i.color),a.setTurn(i.color),c.resetPuzzleStatus(),s(K.APIEvents.Load,{pieces:a.getPieces()})}}function zp(e){return function(){e.status.set(`completed`,!1),e.status.delete(`completedMoveCount`)}}function Bp(e,t){return function(){let n=e.captureTheStar;n.getNumItemsRemaining()===0&&!n.isCompleted()&&(t.status.set(`completed`,!0),t.status.set(`completedMoveCount`,n.getCurrentMoveCount()),n.emit(fw.Events.Completed,n.getData()))}}function Vp(e){ let _hh$temp643=e,t=_hh$temp643.api,n=s(),r=a(); r.config.set(`items`,{});let i=zp(r);return i(),{configureItems:Dp(r),getCurrentMoveCount:Op(t),getData:kp(t,r),getItems:Ap(e),getItemSquares:jp(t),getNextItems:Pp(t),getNumItemsRemaining:Fp(t),...n,isCompleted:Ip(r),load:Rp(e,r),resetPuzzleStatus:i,updatePuzzleStatus:Bp(t,r)};function a(){return{config:new Map,status:new Map}}}function Hp(e){return e===J.ColorsAsNumbers.Black?J.ColorsAsLetters.Black:J.ColorsAsLetters.White}function Up(e){return e===J.ColorsAsNumbers.Black?J.ColorsAsNumbers.White:J.ColorsAsNumbers.Black}function Wp(e,t,n){let r=Up(t.color)===J.ColorsAsNumbers.Black?`p`:`P`,i=t.color===J.ColorsAsNumbers.Black?t.type:t.type.toUpperCase(),a=Array(8).fill(void 0).map(()=>Array(8).fill(`.`));return  __set$(__get$(a,8-t.rank),t.file-1,i) ,e.reduce((e,t)=>{ let _hh$temp644=On(t),n=_hh$temp644.file,i=_hh$temp644.rank; return!n||!i||( __set$(__get$(e,8-i),n-1,r) ),e},a).map(e=> __call$(e.join(``),"replace",[/(\.+)/g,e=>e.length.toString()]) ).join(`/`).concat(` ${Hp(n)}`)}function Gp(e,t){return[... new Map(e.map(e=>[__get$(e,t),e])) .values()]}function Kp(e){ let _hh$temp645=e,t=_hh$temp645.api,n=_hh$temp645.game,r=t.getLegalMoves; return function(){let e=t.captureTheStar,i=t.getPlayingAs();if(!i)return[];let a=r(),o=n.getPieces(!1)[0];if(!o||o.type!==`p`)return a;let s=Wp(e.getItemSquares(),o,i),c=Ve.getLegalMoves(s);return Gp([...a,...c],`san`)}}function qp(e){ let _hh$temp646=e,t=_hh$temp646.api,n=t.getMove; return function(e){return n(e)||(t.getLegalMoves().find(t=>t.to===e.to)??null)}}function Jp(e){ let _hh$temp647=e,t=_hh$temp647.api,n=_hh$temp647.game,r=t.move; return function(e){if(!t.isAtEndOfLine())return t.selectLineEnd();let i=Cp(e,t.getFEN(),t.getVariant());return!i||!i.userGenerated||!(`flags`in i)||Qr(i)&&i.piece===`p`&&n.put({type:`p`,color:Up(i.color)},i.to),r(e)}}function Yp(e){return function(){ let _hh$temp648=e,t=_hh$temp648.respond,n=_hh$temp648.game,r=_hh$temp648.mutateGame,i=r(function(){n.moveBackward();}); return!i||i.lineDiff===0&&i.plyDiff===0?t(K.APIEvents.MoveBackward,null):(i.move?.captured&&(i.move.captured=void 0),t(K.APIEvents.MoveBackward,i))}}function Xp(e){return{api:Vp,apiOverrides:{getLegalMoves:Kp,getMove:qp,move:Jp,moveBackward:Yp},create:t,match:[{condition:Ct(sS),handler:r},{condition:xt(K.APIEvents.Move),handler:n}],name:fw.Plugin.Name};function t(t){ let _hh$temp649=t,n=_hh$temp649.api,r=n.captureTheStar; e&&r.configureItems(e.items)}function n(e,t){ let _hh$temp650=t,n=_hh$temp650.api,r=_hh$temp650.queue,i=n.captureTheStar,a=n.markings,o=n.getContext().game,s=i.getNextItems(e.data.move); r.add(function(){r.add(function(){a.addMany(s),o.turn(n.getPlayingAs()),i.updatePuzzleStatus()})})}function r(e,t){ let _hh$temp651=t,n=_hh$temp651.api,r=_hh$temp651.queue,i=n.getPlayingAs(); i&&r.add(n.setTurn,i)}}function Zp(e){return function(){e.isAtEndOfLine()||e.selectLineEnd()}}function Qp( _hh$temp652 ){ var e=_hh$temp652.api; return{isAllowedToMove:t,handleIllegalMove:Zp(e),name:lw.Types.CaptureTheStar,plugins:[Xp()],usePlayingAs:!0};function t(){return!0}}function $p(e){return qc(e)?{line:e.ids.line,move:e.ids.move+1}:{line:0,move:0}}function em(e){ let _hh$temp653=e,t=_hh$temp653.api,n=t.move; return function(e){if(t.isAtEndOfLine())return n(e); let _hh$temp654=$p(t.getRelativeNode()),r=_hh$temp654.line,i=_hh$temp654.move; return t.deletePosition(i,r),n(e)}}function tm(){return{apiOverrides:{move:em},name:gw.Plugin.Name}}function nm(){return{isAllowedToMove:e,name:lw.Types.Explorer,plugins:[tm()]};function e(){return!0}}function rm(e){let t=[];return{cancel:n,confirm:r,get:i,getActiveGuess:a,guess:s,reset:c};function n(){ let _hh$temp655=e,n=_hh$temp655.api,r=_hh$temp655.respond,i=a(); i&&(t.pop(),r(K.APIEvents.SetBoardPosition,{pieces:n.getPieces()}),r(yw.APIEvents.CancelGuess,i))}function r(t){ let _hh$temp656=e,n=_hh$temp656.respond,r=o(); r&&( __call$(Object,"assign",[r,{confirmed:!0,correct:t}]) ,n(yw.APIEvents.GuessConfirmed,r))}function i(){return t}function a(){let e=o();return e?.confirmed?void 0:e}function o(){return  __get$(t,t.length-1) }function s(n){ let _hh$temp657=e,r=_hh$temp657.api,i=_hh$temp657.respond,a={...n,confirmed:!1,correct:!1,ids:r.getSelectedNode()?.ids??{line:0,move:0}}; t.push(a),i(yw.APIEvents.GuessMade,a)}function c(){t=[]}}function im(e){ let _hh$temp658=e,t=_hh$temp658.api,n=_hh$temp658.game,r=_hh$temp658.respond,i=t.move; return function(e){let n=Cp(e,t.getFEN(),t.getVariant());return n?n.userGenerated?o(n):a(n):r(K.APIEvents.IllegalMove)};function a(e){let n={...e},r=t.guessTheMove.getActiveGuess(),a=t.getMove(e);if(!a||!r)return t.isAtEndOfLine()?i(e):t.addMoveToEndOfLine(n);let o=a.color===t.getPlayingAs()&&a.san===r.san;return e.animate=!o,t.reload(),i(e),t.guessTheMove.confirm(o)}function o(e){if(t.isLegalMove(e)){let i=n.move(e);if(!i)return r(K.APIEvents.IllegalMove);t.guessTheMove.guess(i);let a={...t.getPieces()};return n.undo(),r(K.APIEvents.SetBoardPosition,{pieces:a})}return r(K.APIEvents.IllegalMove)}}function am(e,t){ let _hh$temp659=t,n=_hh$temp659.api,r=_hh$temp659.options,i=(n.guessTheMove?.getActiveGuess()); if(!r||!r.allowMarkings||!i)return[];let a=[];if(i.from){let e=gi({color:r.premoveHighlightColor,opacity:r.premoveHighlightOpacity,square:i.from,type:bw});a.push(e)}let o=gi({color:r.premoveHighlightColor,opacity:r.premoveHighlightOpacity,square:yr(i),type:bw});return a.push(o),a}function om(){let e=!1;return{api:rm,apiOverrides:{move:im},beforeState:[{condition:xt(K.UserEvents.PointerdownRight),handler:n}],destroy:r,match:[{condition:Ct(sS),handler:a},{condition:Ct(yw.APIEvents),handler:t},{condition:xt(yw.APIEvents.GuessConfirmed),handler:i}],name:yw.Plugin.Name};function t(t,n){var r;if(e)return; let _hh$temp660=n,i=_hh$temp660.api; (r=i.highlights)==null||r.addModule(am),(i.highlights?.getModules()??[]).find(e=>e.name===`getGuessTheMoveHighlights`)&&(e=!0)}function n(e, _hh$temp661 ){ var t=_hh$temp661.api,n=_hh$temp661.queue; return t.guessTheMove.getActiveGuess()?(n.add(t.guessTheMove.cancel),!1):!0}function r(e){var t; let _hh$temp662=e,n=_hh$temp662.api; (t=n.highlights)==null||t.removeModule(am)}function i(e,t){ let _hh$temp663=t,n=_hh$temp663.api,_hh$temp664=e.data,r=_hh$temp664.correct,i=_hh$temp664.ids; n.updateNode(i,{customColor:r?yw.Colors.Correct:yw.Colors.Incorrect})}function a(e,t){ let _hh$temp665=t,n=_hh$temp665.api,r=_hh$temp665.queue; e.type===K.APIEvents.Load&&n.guessTheMove.reset();let i=n.getTurn();r.add(n.setPlayingAs,i)}}function sm( _hh$temp666 ){ var e=_hh$temp666.api; return{isAllowedToMove:t,handleIllegalMove:Zp(e),name:lw.Types.GuessTheMove,plugins:[om()],usePlayingAs:!0};function t(){return e.guessTheMove&&e.isAtEndOfLine()&&!e.guessTheMove.getActiveGuess()}}function cm(e){ let _hh$temp667=e,t=_hh$temp667.api,n=_hh$temp667.respond,r=t.load; return function(e,i){let a=t.observing;return a.setCachedPGN(``),a.isAnalyzing()&&(a.clearCachedIds(),n(xC.APIEvents.AnalysisEnd)),r(e,i)}}function lm(e){return!!(e&&`san`in e&&e.san===`--`)}function um( _hh$temp668 ){ var e=_hh$temp668.move,t=_hh$temp668.api,n=_hh$temp668.game; let r=t.observing,i=n.ids();n.selectPosition(0,0),n.createVariation(),n.move(e);let a=t.getRawLines().length-1;n.promoteVariation(a,0),n.deletePosition(0,a); let _hh$temp669=t.getOptions(),o=_hh$temp669.playSounds; o&&t.setOptions({playSounds:!1});let s=r.getCachedIds();s&&r.clearCachedIds(),t.load({pgn:t.getPGN()}),o&&t.setOptions({playSounds:!0}),s&&r.setCachedIds(s.move,s.line),t.selectNode(i.line,i.move)}function dm(e){ let _hh$temp670=e,t=_hh$temp670.api,n=_hh$temp670.respond,r=_hh$temp670.game,i=t.move; return function(e){let n=t.observing.getCachedPGN();n&&t.load({pgn:n});let r=Cp(e,t.getFEN(),t.getVariant());return r?r.userGenerated?a(r):o(r):i(e)};function a(e){ let a=t.observing,_hh$temp671=r.ids(),o=_hh$temp671.move,s=_hh$temp671.line,c=a.isAnalyzing(),l=fu(s); t.getLine(0)?.length===0&&r.move(`--`);let u=t.getNodeByIds({line:0,move:0});if(lm(u)&&lm(t.getSelectedNode())&&t.selectNode(0,-1),lm(u)&&`san`in e){let n=Ve.sanToObj(e.san,t.getFEN()); __call$(Object,"assign",[e,n]) ,e.san=``}l&&!xp({api:t,followAlternateLines:!0,mv:e})&&t.isAtEndOfLine()&&t.createContinuation();let d=i(e);if(d?.type!==K.APIEvents.Move)return d;let f=fu(r.ids().line);return l&&!f&&!c&&(a.setCachedIds(o,s),n(xC.APIEvents.AnalysisStart)),d}function o(e){let n=t.observing,a=lm(t.getNodeByIds({line:0,move:0})),o=t.getLine(0);if(a&&o?.length===1){um({move:e,api:t,game:r});return}return n.isAnalyzing()||!t.isAtEndOfLine()?t.addMoveToEndOfLine(e,0):i(e,!1)}}function fm( _hh$temp672 ){ var e=_hh$temp672.api; let t=e.moveForward;return function(n,r){return t(i(),r);function i(){return n??(e.observing.isAnalyzing()?void 0:!1)}}}function pm(e){ let _hh$temp673=e,t=_hh$temp673.api; return function(e,n){let r=t.observing;if(!r.isAnalyzing())return;if(lm(t.getNodeByIds({line:0,move:0}))){let e=t.getPGN();t.load({pgn:`*`}),r.setCachedPGN(e);return}let i=r.getCachedIds();e?t.load(e,n):t.load({pgn:t.getPGN()}),i&&t.selectNode(i.line,i.move)}}function mm(e){let t,n=``;return{clearCachedIds:r,getCachedIds:i,isAnalyzing:a,restorePosition:pm(e),setCachedIds:o,setCachedPGN:s,getCachedPGN:c};function r(){t=void 0}function i(){return t}function a(){return!!t}function o(e,n){t={move:e,line:n}}function s(e){n=e}function c(){return n}}function hm( _hh$temp674 ){ var e=_hh$temp674.data; return e.lineDiff!==void 0&&e.lineDiff!==0}function gm(e,t){return!_m(e,t)}function _m(e, _hh$temp675 ){ var t=_hh$temp675.api; return t.observing.isAnalyzing()}function vm(e,t){ let _hh$temp676=t,n=_hh$temp676.api; return lm(n.getNodeByIds({line:0,move:0}))}function ym(e,t){ let _hh$temp677=t,n=_hh$temp677.api; return!lm(n.getNodeByIds({line:0,move:0}))}function bm(e,t){ let _hh$temp678=t,n=_hh$temp678.api; return lm(n.getSelectedNode())}function xm(e,t){ let _hh$temp679=t,n=_hh$temp679.api,r=n.getSelectedNode(); return r?.ids?.line===0&&r?.ids?.move===-1}function Sm(e,t){ let _hh$temp680=t,n=_hh$temp680.api,r=n.getSelectedNode(); return!!(r&&r.ids.line!==0)}function Cm(e,t){ let _hh$temp681=t,n=_hh$temp681.api,r=n.getLine(1); return!r||r.length===0}function wm(e,t){ let _hh$temp682=e,n=_hh$temp682.data; return n.line?.atMoveNode===0}function Tm(e,t){ let _hh$temp683=t,n=_hh$temp683.api,r=_hh$temp683.queue; if(n.observing.isAnalyzing())return;r.add(function(){let e=i();e&&(n.observing.setCachedIds(e.move,e.line),n.getContext().respond(xC.APIEvents.AnalysisStart))});function i(){let e=n.getSelectedNode()?.ids;if(!e)return;if(e.line===0)return e;let t=n.getLine(e.line);for(;t.parentId&&t.parentId>1;)t=n.getLine(t.parentId);return{line:t.parentId,move:t.atMoveNode}}}function Em(e,t){ let _hh$temp684=t,n=_hh$temp684.api,r=_hh$temp684.queue; r.add(function(){n.selectNode(1,0)})}function Dm(e,t){ let _hh$temp685=t,n=_hh$temp685.api,r=_hh$temp685.queue,i=n.getLine(1); if(i){let e=Math.max(...i.map(e=>e.moveNumber));r.add(function(){n.selectNode(1,e)})}}function Om(e,t){ let _hh$temp686=t,n=_hh$temp686.api,r=n.observing; n.deletePosition(0,0),r.setCachedPGN(``),r.restorePosition()}function km(e,t){ let _hh$temp687=t,n=_hh$temp687.api,r=_hh$temp687.queue; r.add(function(){n.selectNode(0,-1)})}function Am(e,t){ let _hh$temp688=t,n=_hh$temp688.api,r=n.observing,_hh$temp689=n.getOptions(),i=_hh$temp689.overlayInAnalysisMode,a=r.isAnalyzing(); a!==i&&n.setOptions({overlayInAnalysisMode:a})}function jm(e,t){ let _hh$temp690=t,n=_hh$temp690.api; n.observing.restorePosition()}function Mm(e,t){ let _hh$temp691=t,n=_hh$temp691.api,r=_hh$temp691.queue; r.add(function(){n.selectNode(0,0)})}function Nm(e,t){ let _hh$temp692=t,n=_hh$temp692.api,r=n.observing,i=n.getSelectedNode()?.ids; if(!i)return;if(i.line===0){r.setCachedIds(i.move,i.line);return}let a=n.getLine(i.line)?.id;if(!a)return;for(;n.getLine(a)?.parentId;){let e=n.getLine(a)?.parentId;if(typeof e==`number`&&(a=e),!e)break}let o=n.getLine(a),s=o?.atMoveNode??0;o?.[0].isContinuation||--s,r.setCachedIds(s,0)}function Pm(){return[{condition:Ct([xC.APIEvents.AnalysisStart,xC.APIEvents.AnalysisEnd]),handler:Am},{condition:ir(Ct(sS),_m),handler:Nm},{condition:ir(xt(K.APIEvents.ResetToMainLine),vm),handler:Om},{condition:ir(xt(K.APIEvents.ResetToMainLine),ym),handler:jm},{condition:ir(xt(K.APIEvents.DeletePosition),vm,Cm),handler:Om},{condition:ir(xt(K.APIEvents.DeletePosition),vm,wm),handler:Mm},{condition:ir(xt(K.APIEvents.DeletePosition),ym,Cm),handler:jm},{condition:ir(xt(K.APIEvents.SelectNode),bm),handler:km},{condition:ir(xt(K.InstanceEvents.ModeChanged),Sm),handler:Tm},{condition:ir(xt(K.APIEvents.SelectNode),ym,Sm),handler:Tm},{condition:ir(xt(K.APIEvents.MoveForward),gm,hm),handler:Tm},{condition:ir(xt(K.APIEvents.MoveForward),vm,yc(bm,xm)),handler:Em},{condition:ir(xt(K.APIEvents.SelectLineEnd),vm,yc(bm,xm)),handler:Dm}]}function Fm(){return{api:mm,apiOverrides:{load:cm,move:dm,moveForward:fm},create:e,match:Pm(),name:xC.Plugin.Name};function e(e){ let _hh$temp693=e,t=_hh$temp693.api; t.setOptions({overlayInAnalysisMode:!1})}}function Im(){return{isAllowedToMove:e,name:lw.Types.Observing,plugins:[wt(),Fm()]};function e(){return!0}}function Lm(e){ let _hh$temp694=e,t=_hh$temp694.api; return function(){if(!t.isAtEndOfLine())if(t.getMode().getOptions().canModifyExistingMovesOnMainLine){ let _hh$temp695=$p(t.getRelativeNode()),e=_hh$temp695.line,n=_hh$temp695.move; t.deletePosition(n,e)}else t.selectLineEnd()}}function Rm(e){ let _hh$temp696=e,t=_hh$temp696.api,n=t.move,r=Lm(e); return function(e){return t.isGameOver()&&t.getMode().getOptions().canMoveWhenGameIsOver&&t.setResult(J.Results.None),r(),n(e)}}function zm(){return{apiOverrides:{move:Rm},name:Tw.Plugin.Name}}function Bm( _hh$temp697 ){ var e=_hh$temp697.api; return{handleIllegalMove:Zp(e),isAllowedToMove:t,name:lw.Types.Playing,plugins:[zm()],overridableMethods:[`isAllowedToMove`],usePlayingAs:!0};function t(){return Qi({api:e,canMoveWhenNotPlayerTurn:!1,modeOptions:e.getMode().getOptions()})}}function Vm(){return{isAllowedToMove:e,name:lw.Types.PassiveObserving};function e(){return!1}}function Hm(e){return function( _hh$temp698 ){ var t=_hh$temp698.piece,n=_hh$temp698.square;  let _hh$temp699=e,r=_hh$temp699.api,i=_hh$temp699.game; return i.remove(n),i.put(t,n),r.setGameDetails({FEN:i.fen()}),r.reload()}}function Um(e){return function( _hh$temp700 ){ var t=_hh$temp700.from,n=_hh$temp700.piece,r=_hh$temp700.to;  let _hh$temp701=e,i=_hh$temp701.api,a=_hh$temp701.game; return a.remove(t),a.remove(r),a.put(n,r),i.setGameDetails({FEN:a.fen()}),i.reload()}}function Wm(e){return function(t){ let _hh$temp702=e,n=_hh$temp702.api,r=_hh$temp702.game; return r.remove(t),n.setGameDetails({FEN:r.fen()}),n.reload()}}function Gm(e){return{dropPiece:Hm(e),movePiece:Um(e),removePiece:Wm(e)}}function Km(){return function(e){return e}}function qm(e){ let _hh$temp703=e,t=_hh$temp703.api; return function(e){let n=Cp(e,t.getFEN(),t.getVariant());if(!n)return; let _hh$temp704=t,r=_hh$temp704.setup,i; `color`in n&&n.color&&`drop`in n&&n.drop?i={color:n.color,type:n.drop}:`from`in n&&n.from&&(i=t.getPiece(n.from)),i&&(`from`in n&&n.from&&n.to?r.movePiece({from:n.from,piece:i,to:n.to}):n.to?r.dropPiece({piece:i,square:n.to}):`from`in n&&n.from&&r.removePiece(n.from))}}function Jm(){return{api:Gm,apiOverrides:{getMove:Km,isLegalMove:()=>!0,move:qm},name:Aw.Plugin.Name}}function Ym(){return{isAllowedToMove:e,name:lw.Types.Setup,plugins:[Jm()]};function e(){return!0}}function Xm( _hh$temp705 ){ var e=_hh$temp705.move,t=_hh$temp705.startingMoveNumber; if(!e)return null;let n=ko(e,t);return{...e,ply:e.ids.move+1,wholeMoveNumber:n}}function Zm( _hh$temp706 ){ var e=_hh$temp706.baseTimeDs,t=_hh$temp706.incrementDs,n=_hh$temp706.lastTimeDs,r=_hh$temp706.currentTimeDs; if(!r)return kS;let i=(n??e)-(r-t);return Math.max(i,kS)}function Qm( _hh$temp707 ){ var e=_hh$temp707.api,t=_hh$temp707.node; let n=e.getLine(0),r=e.timeControl.get();if(!n||!r)return null; let i=t.time,a=na({api:e,node:t})?.time,_hh$temp708=r,o=_hh$temp708.baseTime,s=_hh$temp708.increment; return Zm({baseTimeDs:ta(o),incrementDs:ta(s),lastTimeDs:a,currentTimeDs:i})}function $m(e){let t=Math.floor(e%36e3/600),n=Math.floor(e%36e3%600)/10;return`${Math.floor(e/36e3)}:${t<10?`0`:``}${t}:${n<10?`0`:``}${n}`}function eh( _hh$temp709 ){ var e=_hh$temp709.api,t=_hh$temp709.node,n=_hh$temp709.clk;  let _hh$temp710=t.ids,r=_hh$temp710.line,i=_hh$temp710.move,a=e.getContext().game; t.commands||={},a.updateNode({commands: __call$(Object,"assign",[t.commands,{clk:n===null?n:$m(n)}]) },i,r)}function th( _hh$temp711 ){ var e=_hh$temp711.context,t=_hh$temp711.time;  let _hh$temp712=e,n=_hh$temp712.api,r=_hh$temp712.game,i=r.moveDetails(); i.time=t,eh({api:n,node:i,clk:t});let a=Qm({api:n,node:i});a&&ea({api:n,node:i,timestamp:a})}function nh(e){return function(t,n=0){ let _hh$temp713=e,r=_hh$temp713.api,i=_hh$temp713.game,a=_hh$temp713.mutateGame,o=_hh$temp713.respond,_hh$temp714=r.getSelectedNode()??{ids:{move:-1,line:0}},s=_hh$temp714.ids,_hh$temp715=s,c=_hh$temp715.move,l=_hh$temp715.line; i.selectLineEnd(n);let u=Cp(t,r.getFEN(),r.getVariant()),d=u===null?null:a(function(){i.move(u,!1),u.time&&th({context:e,time:u.time})});return i.selectPosition(c,l),d===null?o(K.APIEvents.IllegalMove,{fen:i.fen(),move:u}):(d.move=Xm({move:d.move,startingMoveNumber:i.startingMoveNumber()})||void 0,o(K.APIEvents.AddMove,{listMove:d.move}))}}function rh(e){return function(){ let _hh$temp716=e,t=_hh$temp716.api,n=_hh$temp716.respond; if(t.isGameOver())return null;let r=J.Results.Draw,i=Y.Translation.GameTerminationMessages.DrawByAgreement;return t.setGameDetails({Result:r,Termination:i}),n(K.APIEvents.DrawAgreed)}}function ih(e){return function(t){ let _hh$temp717=e,n=_hh$temp717.respond,r={data:t,type:nb}; return n(K.APIEvents.BlinkHighlight,[r])}}function ah(e){ let _hh$temp718=e,t=_hh$temp718.move,_hh$temp718$followContinuations=_hh$temp718.followContinuations,n=_hh$temp718$followContinuations===void 0?!0:_hh$temp718$followContinuations,_hh$temp718$steps=_hh$temp718.steps,r=_hh$temp718$steps===void 0?1:_hh$temp718$steps,i=_hh$temp718.context,_hh$temp719=i,a=_hh$temp719.mutateGame,o=_hh$temp719.game,s=o.ids(),c=a(function(){o.moveForward(n,t);}),l=c?.plyDiff===1; if(r>1&&l)for(let e=1;e<r&&(l=o.moveForward(n),l);e++);let u=o.ids();return o.selectPosition(s.move,s.line),{firstStepData:c,startIds:s,endIds:u,success:l}}function oh(e){return function(t){ let _hh$temp720=t??{},n=_hh$temp720.move,r=_hh$temp720.followContinuations,i=_hh$temp720.steps,_hh$temp721=ah({context:e,move:n,followContinuations:r,steps:i}),a=_hh$temp721.success; return a}}function sh(e){return e.inThreefoldRepetition()||e.in50MoveRule()}function ch(e){return function(){ let _hh$temp722=e,t=_hh$temp722.api,n=_hh$temp722.game; return t.isGameOver()?null:sh(n)?(t.setResult(J.Results.Draw),e.respond(K.APIEvents.DrawClaimed)):null}}function lh(e,t){return`The "${e}" method is deprecated and will be removed in v2.0.0. Please use the ${t} methods instead.`}function uh(e){return function(t,n={}){console.warn(Nw.ClearMarkings); let _hh$temp723=e,r=_hh$temp723.api,i=_hh$temp723.respond,a=r.markings,o=(t?.map(e=>e===`square`?`highlight`:e)); return a.removeAllWhere({...n,types:o}),i(K.APIEvents.ClearMarkings)}}function dh(e){return function(){ let _hh$temp724=e,t=_hh$temp724.api,n=_hh$temp724.game,r=_hh$temp724.respond,i=n._getPos(); if(`initial`in i)return null;n.createVariation(),n.move(i);let a=t.getRelativeNode();return r(K.APIEvents.CreateContinuation,{node:a})}}function fh(e){return function(t,n){ let _hh$temp725=e,r=_hh$temp725.api,i=_hh$temp725.game,a=_hh$temp725.respond,o=__get$(r.getRawLines(),n); return i.deletePosition(t,n),n===0&&r.getResult()!==J.Results.None&&r.setResult(J.Results.None),a(K.APIEvents.DeletePosition,{ids:{line:n,move:t},line:o,pieces:r.getPieces()})}}function ph(e){let t={};return function(n,r){let i=Object.entries(r).map(( _hh$temp726 )=>{ var _hh$temp727=__arrayFrom$(_hh$temp726),r=_hh$temp727[0],i=_hh$temp727[1]; if(i)return  __get$(t,r) ||( __set$(t,r,{extensions:{},original:__get$(e.api,r)}) ), __set$(e.api,r,i(e)) , __set$(__get$(t,r).extensions,n,i) ,function(){delete  __get$(t,r) .extensions[n], __set$(e.api,r,__get$(t,r).original) ,Object.keys( __get$(t,r) .extensions).map(n=> __set$(e.api,r,__call$(__get$(t,r).extensions,n,[e])) )}});return function(){i.map(e=>e&&e())}}}function mh(e){return e.inCheckmate()||!!e.isVariantWin()||!!e.isBughouseWin()}function hh(e){return function(){ let _hh$temp728=e,t=_hh$temp728.api,n=_hh$temp728.game,r=J.Results.None,i=sh(n); return mh(n)?r=n.turn()===J.ColorsAsNumbers.Black?J.Results.White:J.Results.Black:(i&&t.getOptions().autoClaimDraw||!i&&n.inDraw())&&(r=J.Results.Draw),r}}function gh(e){return function(){return e}}function _h(e){return function(){ let _hh$temp729=e,t=_hh$temp729.game; return t.history({toCurrent:!0,verbose:!0})}}function vh(e){return function(){ let _hh$temp730=e,t=_hh$temp730.game; return t.fen()}}function yh(e){return function(){return Ve.gameFingerprints({game:e.game,analysis:!0})}}function bh(e){return function(){ let _hh$temp731=e,t=_hh$temp731.game; return t.headers()}}function xh(e){return e===-1}function Sh(e){return function(t=!1){ let _hh$temp732=e,n=_hh$temp732.game,r=n._getPos(); return r.ids&&r.ids.line===0&&xh(r.ids.move)&&r.fen?[r.fen]:n.history({toCurrent:!t,verbose:!0}).map(e=>e.fen)}}function Ch(e){return function(){ let _hh$temp733=e,t=_hh$temp733.game; return t.history(!1)}}function wh(e){return function(){ let _hh$temp734=e,t=_hh$temp734.api,n=(t.premoves?.getQueue())||[],r=Ve.createGame({pgn:t.getPGN(),analysis:!0,timestamps:t.times.get()||t.timestamps.get()||void 0}); if(!r)throw Error(`Unable to create JCE game copy`);return r.premove.queue.push(...n),r}}function Th(e){return function(){ let _hh$temp735=e,t=_hh$temp735.game; return t.history(!0).slice(-1)[0]}}function Eh(e){return function(){ let _hh$temp736=e,t=_hh$temp736.game; return Ve.getLegalMoves({game:t})}}function Dh(e){return function(t){return Br(e.api.getLegalMoves().filter(e=>t===void 0||e.from===t).map(e=>e.to))}}function Oh(e){function t(t){ let _hh$temp737=e,n=_hh$temp737.game,r=n.startingMoveNumber(),i=__get$(e.api.getRawLines(),t); if(!i){if(t===0)throw Error(`Expected a main line`);return}return i.forEach((e,t)=>{ __set$(i,t,Xm({move:e,startingMoveNumber:r})) }),i}return t}function kh(e){let t={[J.Node.Marking.Types.Arrow]:{},[J.Node.Marking.Types.CustomItem]:{},[J.Node.Marking.Types.Effect]:{},[J.Node.Marking.Types.Square]:{}};return e.map(e=>({markingType:e.type===`highlight`?`square`:e.type,key:e.data.square??`${e.data.from}${e.data.to}`,color:aS.Default,...e.data})).reduce((e,t)=>{ let _hh$temp738=t,n=_hh$temp738.key,r=_hh$temp738.markingType; return  __set$(__get$(e,r),n,t) ,e},t)}function Ah(e){return function(){ let _hh$temp739=e,t=_hh$temp739.api,n=t.markings; return kh(n.getAll())}}function jh(e){return function(){ let _hh$temp740=e,t=_hh$temp740.game; return t.material()}}function Mh(e){return function(t){ let _hh$temp741=e,n=_hh$temp741.game; if(t.to===null)return null;let r=n.getMove(t);return r===null&&( __call$(Object,"assign",[t,{promotion:`q`}]) ,r=n.getMove(t)),r&&=n.moveDetails(r),r}}function Nh(e){return function(t){ let _hh$temp742=e,n=_hh$temp742.api,r=_hh$temp742.game,i=__get$(n.getRawLines(),t.line); return!i||t.move===-1?null:Xm({move: __get$(i,t.move) ,startingMoveNumber:r.startingMoveNumber()})}}function Ph(e,t){return t.ids.line-e.ids.line}function Fh(e){ let _hh$temp743=e,t=_hh$temp743.moveNumber; return t===void 0?-1:t}function Ih(e,t){return Fh(t)-Fh(e)}function Lh(e){if(!(e.flags!==J.Move.Flags.EPCapture||!e.from))return`${e.to.slice(0,1)}${e.from.slice(-1)}`}function Rh(e){let t={...e,EPCapturedSquare:Lh(e)};return e.rookFrom&&e.rookTo&&(t.rookMove={animate:!0,from:e.rookFrom,to:e.rookTo}),t}function zh(e){return function(t,n){ let _hh$temp744=e,r=_hh$temp744.api,i=_hh$temp744.game,a=n??i._getPos(),o=t??i._getPos(-1,0),s={}; return s.plyDiff=Ih(o,a),s.lineDiff=Ph(o,a),s.plyDiff===-1?s.move=Rh({...t,animate:!0}):s.plyDiff===1?(s.animate=!0,s.move=Rh({...a,animate:!0})):s.pieces=r.getPieces(),s}}function Bh(e){return function(){ let _hh$temp745=e,t=_hh$temp745.game; return t.ids()}}function Vh(e){return function(){ let _hh$temp746=e,t=_hh$temp746.game; return En(t.getPieces(!0))}}function Hh(e){return function(t={}){ let _hh$temp747=e,n=_hh$temp747.game; return n.pgn({...t,useResultHeader:!0})}}function Uh(e){return function(t){ let _hh$temp748=e,n=_hh$temp748.game; return n.get(t)}}function Wh(e){return function(t,n){ let _hh$temp749=e,r=_hh$temp749.game; return r._getPos(t,n)}}function Gh(e){return function(t){let n=e.api.getPGN();return Ve.getPositionDetails({pgn:n},t)}}function Kh(e){return e.color!==void 0}function qh(e){return function(t=[],n,r){ let _hh$temp750=e,i=_hh$temp750.api,a=n??{game:e.game,analysis:!0},o=__get$(J.JCEVariantTypes,i.getVariant()),s=Ve.getPositionInfo(a,t,{variant:o}); if(typeof s==`object`){let n=e.game.header().Termination,a={...s,...Jh(n,r),gameOver:i.isGameOver()||s.gameOver,draw:i.getResult()===J.Results.Draw||s.draw};if(typeof t!=`string`){let e= __get$(t,t.length-1) ;e!==void 0&&Kh(e)&&(a.lastMoveColor=e.color)}return a}return!1}}function Jh(e,t){return t?{drawByAgreement:e===t.drawByAgreement,timeoutVsInsufficientMaterial:e===t.timeoutVsInsufficientMaterial}:{}}function Yh(e){return function(){ let _hh$temp751=e,t=_hh$temp751.game; return t._lines()}}function Xh(e){return function(t=0){ let _hh$temp752=e,n=_hh$temp752.game,r={...n.ids()}; r.move+=t;let i= __get$(e.api.getRawLines(),r.line) ;return xh(r.move)?i:Xm({move: __get$(i,r.move) ,startingMoveNumber:n.startingMoveNumber()})}}function Zh(e){return function(){ let _hh$temp753=e,t=_hh$temp753.game; return t.headers().Result}}function Qh(e){return function(){ let _hh$temp754=e,t=_hh$temp754.api,n=_hh$temp754.game,r=n.ids(); if(xh(r.move))return null;let i= __get$(t.getRawLines(),r.line) ;return Xm({move: __get$(i,r.move) ,startingMoveNumber:n.startingMoveNumber()})}}function $h(e){return function(){ let _hh$temp755=e,t=_hh$temp755.game; return Ve.encodeTCN(t.history(!0))}}function eg(e){return function(){ let _hh$temp756=e,t=_hh$temp756.game; return t.turn()}}function tg(e){return function(){ let _hh$temp757=e,t=_hh$temp757.api,n=t.getHeaders().Variant; return n? __get$(Pw,n) ??J.Variants.Chess:J.Variants.Chess}}function ng(e){return function(){ let _hh$temp758=e,t=_hh$temp758.game,n=t.ids(); return  __get$(e.api.getRawLines(),n.line) .length-1===n.move}}function rg(e){return function(){ let _hh$temp759=e,t=_hh$temp759.game; if(t.inCheck()){let n=e.api.getPieces();return n.keys().filter(e=>{let r=n.get(e);return r.type===`k`&&r.color===t.turn()})[0]}return!1}}function ig(e){return function(){ let _hh$temp760=e,t=_hh$temp760.api; return t.getResult()!==`*`}}function ag(e){return function(t){ let _hh$temp761=e,n=_hh$temp761.game; return n.getMove(t)!==null}}function og(e,t){if(t&&e){let n=ta(e.baseTime),r=ta(e.increment);return t.map((e,i)=>typeof e==`number`?Zm({baseTimeDs:n,incrementDs:r,lastTimeDs:i<=1?void 0: __get$(t,i-2) ,currentTimeDs:e}):e)}return t}function sg(e){let t=e;return Object.keys(VS).reverse().forEach(e=>{t= __call$(t,"replace",[RegExp(`\\${e}`,`gm`),__get$(VS,e)]) }),t}function cg(e){return function( _hh$temp762 ,l){ var t=_hh$temp762.fen,n=_hh$temp762.moves,r=_hh$temp762.pgn,i=_hh$temp762.times,a=_hh$temp762.timestamps,o=_hh$temp762.timeControl,_hh$temp762$variant=_hh$temp762.variant,s=_hh$temp762$variant===void 0?J.Variants.Chess:_hh$temp762$variant,c=_hh$temp762.pieces;  let _hh$temp763=e,u=_hh$temp763.api,d=_hh$temp763.game,f=_hh$temp763.respond,p=!1; if(r){let e=sg(r);p=d.loadPgn(e)}else t&&(p=d.load(t,s));(n||n===``)&&(p=d.loadMoves(n,{autoPromote:!0,...l}));let m=u.getLine(0),h=i?og(o||u.timeControl.get(),i):a;if(h&&m&&m.forEach((e,t)=>{let n= __get$(h,t) ;n!==void 0&&ea({api:u,node:e,timestamp:n})}),o&&u.timeControl.set(o),!p)throw new LC({code:RC.BadData,data:{fen:t,pgn:r},message:`Unable to load with provided data.`});let g=u.getResult();return u.setResult(g===J.Results.None?u.getCalculatedResult():g),d._lines().forEach(e=>e.forEach(e=>d.moveDetails(e))),f(K.APIEvents.Load,{...Ve.getPositionDetails({game:d,skipValidation:!0}),...Ve.getPositionInfo({analysis:!0,game:d}),line:m,pieces:c??u.getPieces(),variant:s})}}function lg(e,t={}){ let _hh$temp764=__arrayFrom$(Object.entries(e)[0]),n=_hh$temp764[0],r=_hh$temp764[1],_hh$temp765=t,i=_hh$temp765.node,a=_hh$temp765.persistent; return sr(r).map(e=>{let t={data:e,node:i,persistent:a,type:n===`square`?nb:n};return{...t,key:kr(t)}})}function ug(e){return function(t,n,r){console.warn(Nw.Mark); let _hh$temp766=e,i=_hh$temp766.api,a=i.markings,o=lg(t,{node:r?.node??n,persistent:r?.persistent??!0}); return a.addMany(o),Zt(K.APIEvents.Mark,o)}}function dg(e={}){let t=o(e);return{add:n,clear:r,get:i,remove:a};function n(e,...n){let r=t;n.forEach(e=>{e in r||( __set$(r,e,{}) ),r= __get$(r,e) }), __call$(Object,"assign",[r,e]) }function r(n){n? __set$(t,n,{}) :t=o(e)}function i(){return o(t)}function a(...e){let n=t,r=e.length-1;e.forEach((e,t)=>{e in n&&t!==r&&(n= __get$(n,e) )}),delete n[ __get$(e,r) ]}function o(e){return JSON.parse(JSON.stringify(e))}}function fg(e){return function(t,n=!0){ let _hh$temp767=e,r=_hh$temp767.api,i=_hh$temp767.game,a=_hh$temp767.mutateGame,o=_hh$temp767.respond,s=Cp(t,r.getFEN(),r.getVariant()),c=s===null?null:a(function(){let r;if(r=`san`in s?i.move(s.san||s,n):typeof t==`object`&&`tcn`in t?i.loadMoves(t.tcn.slice(0,2),{atCurrent:!0,method:`merge`}):i.move(s,n),!r)return null;s.time&&th({context:e,time:s.time});}); return c===null?o(K.APIEvents.IllegalMove,{fen:i.fen(),move:t}):(c.result&&r.setResult(c.result),c.move&&s&&( __call$(Object,"assign",[c.move,{animate:s.animate,userGenerated:s.userGenerated,userGeneratedDrop:s.userGeneratedDrop,isExternalBoard:s.isExternalBoard}]) ,c.move=Rh(c.move)),o(K.APIEvents.Move,c))}}function pg(e){return function(){ let _hh$temp768=e,t=_hh$temp768.respond,n=_hh$temp768.game,r=_hh$temp768.mutateGame,i=r(function(){n.moveBackward();}); return!i||i.lineDiff===0&&i.plyDiff===0?t(K.APIEvents.MoveBackward,null):t(K.APIEvents.MoveBackward,i)}}function mg(e){return function(t,n){ let _hh$temp769=e,r=_hh$temp769.respond,i=_hh$temp769.api,a=_hh$temp769.game,_hh$temp770=hg(t,n),o=_hh$temp770.move,s=_hh$temp770.followContinuations,c=_hh$temp770.steps; if(c<1)return null; let _hh$temp771=ah({context:e,move:o,followContinuations:s,steps:c}),l=_hh$temp771.firstStepData,u=_hh$temp771.success,d=_hh$temp771.endIds; return c===1||l?.plyDiff!==1?(a.selectPosition(d.move,d.line),r(K.APIEvents.MoveForward,l)):u?i.selectNode(d.line,d.move):r(K.APIEvents.MoveForward,null)}}function hg(e,t){let n={},r;typeof e==`object`?n=e:r=e; let _hh$temp772=n,i=_hh$temp772.move,a=_hh$temp772.followContinuations,o=_hh$temp772.steps; return{move:i??t,followContinuations:a??r??!0,steps:o??1}}function gg(e){return function(t,n){ let _hh$temp773=e,r=_hh$temp773.game,i=_hh$temp773.respond; return r.moveVariation(t,n)?i(K.APIEvents.MoveVariation):null}}function _g(e,t){return function(n){let r=e.moveDetails(),i=t.getCalculatedResult();if(n()===null)return null;let a=e.moveDetails(),o=t.getCalculatedResult(),s=t.getNodeDiffData(r,a);i!==o&&fu(a?.ids.line)&&(s.result=o); let _hh$temp774=e.ids(),c=_hh$temp774.line,l=_hh$temp774.move; return s.linesReordered=c!==0&&l===0&&e.reorderLines(),s}}function vg(e){return Object.keys(e).reduce((t,n)=>( __get$(e,n) !==J.EmptyPGNHeaders.Value&& __get$(e,n) !==J.EmptyPGNHeaders.Date&&( __set$(t,n,__get$(e,n)) ),t),{})}function yg(e,t,n){return e}function bg(e,t,n,r){return`${t}`}function xg(e){return function(n){ let _hh$temp775=e,r=_hh$temp775.api,i=_hh$temp775.game,a=_hh$temp775.respond,o=Up(n),_hh$temp776=t(n)?u():l(),s=_hh$temp776.Result,c=_hh$temp776.Termination; return r.setGameDetails({Result:s,Termination:c}),i.header({Termination:c}),a(K.APIEvents.OutOfTime,{...vg(i.header()),color:n});function l(){let e=ze(ja(o)),t= __get$(r.getHeaders(),e) ;return{Result:o===J.ColorsAsNumbers.Black?J.Results.Black:J.Results.White,Termination:Fw.trans(`%username% won on time`,{"%username":t})}}function u(){return{Result:J.Results.Draw,Termination:Y.Translation.GameTerminationMessages.TimeoutVsInsufficientMaterial}}};function t(t){let n= __call$(e.api.getFEN(),"replace",[RegExp(t===J.ColorsAsNumbers.Black?`[a-jl-z]`:`[A-JL-Z]`,`g`),`1`]) ;return Ve.createGame({fen:n,analysis:!0}).insufficientMaterial()}}function Sg(e){let t={};return function(i,a){let o=Object.entries(a);return o.forEach(( _hh$temp777 )=>{ var _hh$temp778=__arrayFrom$(_hh$temp777),a=_hh$temp778[0],o=_hh$temp778[1]; let s= __get$(t,a) ;s||( __set$(t,a,{methodName:a,original:__get$(e.api,a),current:__get$(e.api,a),before:[],after:[],instead:[],extensions:{}}) ,s= __get$(t,a) , __set$(e.api,a,n(a)) );let c=t=>{ __get$(s,t.run) .push({id:i,...t,handler:t.handler(e)}), __get$(s,t.run) .sort((e,t)=>(e.order||0)-(t.order||0))};Array.isArray(o)?o.forEach(e=>{c(e)}):typeof o==`object`?c(o):typeof o==`function`&&( __set$(s.extensions,i,o) ,s.current=o(r(s)))}),function(){o.forEach(( _hh$temp779 )=>{ var _hh$temp780=__arrayFrom$(_hh$temp779),e=_hh$temp780[0]; let n= __get$(t,e) ;delete n.extensions[i];let a=Object.values(n.extensions)[0];n.current=a?a(r(n)):n.original,[`before`,`after`,`instead`].forEach(e=>{ __set$(n,e,__get$(n,e).filter(e=>e.id!==i)) })})}};function n(n){let r= __get$(t,n) ,i=(t,...n)=> __get$(r,t) .filter(t=>t.conditions?Array.isArray(t.conditions)?t.conditions.every(t=>!!t(e,...n)):!!t.conditions(e,...n):!0);return(...e)=>{let t=i(`before`,...e),n=i(`instead`,...e)[0]?.handler,a=t.reduce((e,t)=>{let n=t.handler(...e);return t.changeArgs?n:e},e),o;return o=n?n(...a):r.current(...a),i(`after`,o,...a).reduce((e,t)=>t.handler(e,...a),o)}}function r(t){return{...e,api:{...e.api,[t.methodName]:t.original}}}}function Cg(e){return function(){ let _hh$temp781=e,t=_hh$temp781.api,n=_hh$temp781.game,r=_hh$temp781.respond; return r(K.APIEvents.Reload,{holdSelectedPiece:!0,pieces:En(n.getPieces(!0)),variant:t.getVariant()})}}function wg(e){let t=J.ColorsAsNumbers.White,n=!1;return{getPlayingAs:r,setPlayingAs:i,usePlayingAs:a};function r(){return n?t:void 0}function i(n){if(n===t)return null; let _hh$temp782=e,r=_hh$temp782.respond; return t=n,r(K.APIEvents.SetPlayingAs,n)}function a(e){n=e||!1}}function Tg(e){return function(t,n,r={replace:!1}){ let _hh$temp783=e,i=_hh$temp783.game,a=_hh$temp783.respond; return i.promoteVariation(t,n)?(r.replace&&i.deletePosition(-1,t),a(K.APIEvents.PromoteVariation)):null}}function Eg(e){return function(){ let _hh$temp784=e,t=_hh$temp784.api,n=_hh$temp784.respond; return t.setResult(J.Results.None),t.load({fen:Iw}),n(K.APIEvents.ResetGame)}}function Dg(e){return function(t){ let _hh$temp785=e,n=_hh$temp785.api,r=_hh$temp785.respond; if(n.isGameOver())return null;let i=t===J.ColorsAsNumbers.White?J.Results.Black:J.Results.White;return n.setResult(i),r(K.APIEvents.GameResigned,i)}}function Og(e){return function(){ let _hh$temp786=e,t=_hh$temp786.api,n=_hh$temp786.game,r=_hh$temp786.respond; return n.resetToMainLine(),r(K.APIEvents.ResetToMainLine,{pieces:t.getPieces()})}}function kg(e){return function(t,n){let r=Zt(t,n);return e.emit(t,r),r}}function Ag(e){return function(t){ let _hh$temp787=e,n=_hh$temp787.api,r=_hh$temp787.game,i=_hh$temp787.mutateGame,a=_hh$temp787.respond,o=i(function(){r.selectLineEnd(t);}); return o&&(o.pieces=n.getPieces()),a(K.APIEvents.SelectLineEnd,o)}}function jg(e){return function(){ let _hh$temp788=e,t=_hh$temp788.api,n=_hh$temp788.game,r=_hh$temp788.mutateGame,i=_hh$temp788.respond,a=r(function(){n.selectLineStart();}); return a&&(a.pieces=t.getPieces()),i(K.APIEvents.SelectLineStart,a)}}function Mg(e){return function(t,n){ let _hh$temp789=e,r=_hh$temp789.api,i=_hh$temp789.game,a=_hh$temp789.respond,o=i.moveDetails(); i.selectPosition(n,t);let s=i.moveDetails(),c=r.getNodeDiffData(o,s);return c.plyDiff===0&&c.lineDiff===0?null:(c.lineDiff!==0&&(c.pieces=r.getPieces()),a(K.APIEvents.SelectNode,c))}}function Ng(e){return function(t){ let _hh$temp790=e,n=_hh$temp790.game,r=_hh$temp790.respond,i=vg(n.header(t)); return r(K.APIEvents.UpdatePGNHeaders,i)}}function Pg(e){return function(t){ let _hh$temp791=e,n=_hh$temp791.api; return n.setGameDetails({Result:t})}}function Fg(e){return function(t){ let _hh$temp792=e,n=_hh$temp792.game,r=_hh$temp792.respond; return n.turn()===t?null:(n.turn(t),r(K.APIEvents.TurnSet,t))}}function Ig(e){return function(t,n,r){console.warn(Nw.ToggleMarking); let _hh$temp793=e,i=_hh$temp793.api,a=i.markings,o=lg(t,{node:r?.node??n,persistent:r?.persistent??!0}); return a.toggleMany(o),Zt(K.APIEvents.Mark,o)}}function Lg(e){return function(){ let _hh$temp794=e,t=_hh$temp794.api,n=t.getSelectedNode(); return n?t.deletePosition(n.ids.move,n.ids.line):null}}function Rg(e){return function(t,n){ let _hh$temp795=e,r=_hh$temp795.game,i=_hh$temp795.respond; return r.updateNode(n,t.move,t.line),i(K.APIEvents.NodeUpdated,{changes:n,ids:t,node:r._getPos(t.move,t.line)})}}function zg(e){return function(t,n){ let _hh$temp796=e,r=_hh$temp796.game,i=_hh$temp796.respond; return r.updateLineComment(t,n),i(K.APIEvents.LineCommentUpdated,{comment:t,lineId:n})}}function Bg(e){return function(t,n,r){console.warn(Nw.Unmark); let _hh$temp797=e,i=_hh$temp797.api,a=i.markings,o=lg(t,{node:r?.node??n,persistent:r?.persistent??!0}); return a.removeMany(o.map(e=>e.key)),Zt(K.APIEvents.Unmark,o)}}function Vg(e){return Array.isArray(e)&&Array.isArray(e[0])?e[0]:e}function Hg(e){return function(t){let n=Ve.createGame({timestamps:t.times||t.timestamps||void 0,...t,analysis:!0,autoPromote:!0});if(!n)return; let _hh$temp798=e,r=_hh$temp798.api,_hh$temp799=t,i=_hh$temp799.times,a=_hh$temp799.timestamps; return t.variant===J.Variants.Bughouse&&(i=Vg(i),a=Vg(a)),r.load({pgn:n.pgn({useResultHeader:!0}),variant:t.variant,times:i,timestamps:a,premoves:n.premove.queue&&n.premove.queue.length>0?n.premove.queue:void 0})}}function Ug(e){return function(){let t=e.api.getHeaders().TimeControl;if(!t||t===Rb.Header.Null||t.includes(Rb.Header.Unset)||t.includes(Rb.Header.TimePerMove))return null; let _hh$temp800=__arrayFrom$(t.split(Rb.Header.Separator).map(e=>Math.round(parseFloat(e)*1e3))),n=_hh$temp800[0],r=_hh$temp800[1]; return{baseTime:n,increment:r||0}}}function Wg(e){ let _hh$temp801=e,t=_hh$temp801.baseTime,n=_hh$temp801.increment; return(t+40*(n||0))/1e3}function Gg(e){return function(){ let _hh$temp802=e,t=_hh$temp802.api,n=t.timeControl.get(); if(n){let e=Wg(n);if(e<Lw)return Rb.Types.Bullet;if(e>Rw)return Rb.Types.Rapid}return Rb.Types.Blitz}}function Kg(e){return function(t){ let _hh$temp803=e,n=_hh$temp803.api; if(t===null)return n.setGameDetails({TimeControl:Rb.Header.Null}); let _hh$temp804=t,r=_hh$temp804.baseTime,i=_hh$temp804.increment,a=r/1e3,o=i/1e3; return n.setGameDetails({TimeControl:o?`${a}+${o}`:`${a}`})}}function qg(e){return{get:Ug(e),getType:Gg(e),set:Kg(e)}}function Jg(e,t){if(e===null)return null;let n;switch(t){case eb.Units.Milliseconds:n=e*100;break;case eb.Units.Seconds:n=e*10;break;case eb.Units.Deciseconds:default:n=e;break}return n}function Yg(e,t){let n;switch(t){case eb.Units.Milliseconds:n=e/100;break;case eb.Units.Seconds:n=e*10;break;case eb.Units.Deciseconds:default:n=e;break}return Math.round(n)}function Xg(e,t){return e===null?null:Math.max(kS,Yg(e,t))}function Zg(e){return{get:t,set:r,setMany:i};function t(t, _hh$temp805 ={},r=eb.Units.Deciseconds){ var _hh$temp805$filtered=_hh$temp805.filtered,n=_hh$temp805$filtered===void 0?!0:_hh$temp805$filtered;  let _hh$temp806=e,i=_hh$temp806.api,a=(i.getLine(0)?.map(yo)); return t===void 0?(n?a.filter(e=>e!==void 0):a).map(e=>Jg(e,r)): __get$(a,t) &&Jg( __get$(a,t) ,r)}function n(){return t(void 0,{filtered:!1})}function r(t,n,r=eb.Units.Deciseconds){ let _hh$temp807=e,i=_hh$temp807.api,a=_hh$temp807.respond,_hh$temp808=i,o=_hh$temp808.getLine,s=(__get$(o(0),n,true)); if(!s)return null;let c=Xg(t,r);return c===void 0?null:(ea({api:i,node:s,timestamp:c}),a(K.APIEvents.NodeUpdated,{changes:{timestamp:c,node:s}}))}function i(t=[],r=eb.Units.Deciseconds){ let _hh$temp809=e,i=_hh$temp809.api,a=_hh$temp809.respond,o=t.length===0?n().map(()=>null):t; return i.getRawLines()[0].forEach((e,t)=>{if( __get$(o,t) ===void 0)return;let n=Xg( __get$(o,t) ,r);n!==void 0&&ea({api:i,node:e,timestamp:n})}),a(K.APIEvents.LineUpdated)}}function Qg(e){return function(t){ let _hh$temp810=e,n=_hh$temp810.api,r=n.getLine(0); return t===void 0?r.map(e=>e.time): __get$(r,t) ?.time}}function $g(e){return function(t=[]){ let _hh$temp811=e,n=_hh$temp811.api,r=_hh$temp811.respond; return n.getRawLines()[0].forEach((e,r)=>{ __get$(t,r) !==void 0&&(!e.time&& __get$(t,r) &&(e.time= __get$(t,r) ),n.timestamps.set(Qm({api:n,node:e}),r))}),r(K.APIEvents.LineUpdated)}}function e_(e){return function(t,n){ let _hh$temp812=e,r=_hh$temp812.api,i=_hh$temp812.respond,_hh$temp813=r,a=_hh$temp813.getLine,o=(__get$(a(0),n,true)); return o?(o.time||=t,r.timestamps.set(Qm({api:r,node:o}),n),i(K.APIEvents.NodeUpdated,{changes:{time:t,node:o}})):null}}function t_(e){return{get:Qg(e),set:e_(e),setMany:$g(e)}}function n_(e=100){let t=s(),n=[],r=dx.Levels.Debug,i={[dx.Levels.None]:0,[dx.Levels.Error]:1,[dx.Levels.Debug]:2};return{...t,clear:a,get:o,log:c,setLogLevel:l};function a(){n.length=0}function o(e){return e?n.filter(t=>Object.entries(e).every( _hh$temp814=>{var _hh$temp815=__arrayFrom$(_hh$temp814),e=_hh$temp815[0],n=_hh$temp815[1];return __get$(t,e)===n;} )):n}function c( _hh$temp816 ){ var a=_hh$temp816.code,o=_hh$temp816.data,_hh$temp816$level=_hh$temp816.level,s=_hh$temp816$level===void 0?dx.Levels.Debug:_hh$temp816$level,c=_hh$temp816.message; if( __get$(i,s) > __get$(i,r) )return;n.length===e&&n.shift();let l={code:a,data:o,level:s,message:c,timestamp:Date.now()};n.push(l),t.emit(dx.Events.EntryAdded,l)}function l(e){r=e}}function r_(e){return function(t){ let _hh$temp817=e,n=_hh$temp817.api,r=n.getLine(0),_hh$temp818=n.getFingerprints(),i=_hh$temp818.startingFen; return n.getPositionInfo(r,i,t)}}function i_( _hh$temp819 ){ var e=_hh$temp819.game,t=_hh$temp819.logger,n=_hh$temp819.options,r=_hh$temp819.eventEmitter; let i=e||Ve.createGame({...n,analysis:!0,autoPromote:!0});if(!i)throw new LC({code:RC.BadData,data:n,message:`Error creating game from createAPI`});let a=r||s(),o=dg({arrow:{},customItem:{},effect:{},square:{}}),c={},l={api:c,emitter:a,game:i,markingCache:o,mutateGame:_g(i,c),respond:kg(a)};return  __call$(Object,"assign",[l.api,u()]) ,l.api;function u(){return{addMoveToEndOfLine:nh(l),agreeDraw:rh(l),blinkSquare:ih(l),canMoveForward:oh(l),claimDraw:ch(l),clearMarkings:uh(l),createContinuation:dh(l),createGame:Hg(l),...wg(l),deletePosition:fh(l),...a,extendAPI:ph(l),overrideAPI:Sg(l),getCalculatedResult:hh(l),getContext:gh(l),getCurrentFullLine:_h(l),getFEN:vh(l),getFingerprints:yh(l),getHeaders:bh(l),getHistoryFENs:Sh(l),getHistorySANs:Ch(l),getJCEGameCopy:wh(l),getLastMove:Th(l),getLegalMoves:Eh(l),getLegalMovesForSquare:Dh(l),getLine:Oh(l),getMarkings:Ah(l),getMaterial:jh(l),getMove:Mh(l),getNodeByIds:Nh(l),getNodeDiffData:zh(l),getNodeIds:Bh(l),getPGN:Hh(l),getPiece:Uh(l),getPieces:Vh(l),getPosition:Wh(l),getPositionDetails:Gh(l),getPositionInfo:qh(l),getFinalPositionInfo:r_(l),getRawLines:Yh(l),getRelativeNode:Xh(l),getResult:Zh(l),getSelectedNode:Qh(l),getStartingMoveNumber:l.game.startingMoveNumber,getTCN:$h(l),getTurn:eg(l),getVariant:tg(l),isAtEndOfLine:ng(l),isCheck:rg(l),isGameOver:ig(l),isLegalMove:ag(l),load:cg(l),logger:t||n_(),mark:ug(l),move:fg(l),moveBackward:pg(l),moveForward:mg(l),moveVariation:gg(l),outOfTime:xg(l),promoteVariation:Tg(l),reload:Cg(l),resetGame:Eg(l),resetToMainLine:Og(l),resign:Dg(l),selectLineEnd:Ag(l),selectLineStart:jg(l),selectNode:Mg(l),setGameDetails:Ng(l),setResult:Pg(l),setTurn:Fg(l),timeControl:qg(l),times:t_(l),timestamps:Zg(l),toggleMarking:Ig(l),undo:Lg(l),unmark:Bg(l),updateLineComment:zg(l),updateNode:Rg(l)}}}function a_(e={}){let t=e;return{get:n,set:r};function n(e){return e? __get$(t,e) :t}function r(e){ __call$(Object,"assign",[t,e]) }}function o_( _hh$temp820 ){ var e=_hh$temp820.params,t=_hh$temp820.run; let n={queue:Cc(!1),reset:r,run:t,setMode:i,setRenderer:a,state:a_(),...e};return n.reset(),n;function r(){n.queue=Cc(!1),n.state=a_()}function i(e){n.mode=e}function a(e){n.renderer=e}}function s_(e){return Object.values(K.APIEvents).includes(e.type)}function c_(e){return[K.APIEvents.AddMove,K.APIEvents.BlinkHighlight,K.APIEvents.ClearMarkings,K.APIEvents.Mark,K.APIEvents.LineUpdated,K.APIEvents.NodeUpdated,K.APIEvents.Unmark,K.APIEvents.UpdatePGNHeaders].includes(e)}function l_(e){return{cancelMarkingStartSquare:t,cancelPromotion:n,deselectPiece:r,dragPiece:i,dropPiece:a,resetElevatedState:o,selectPiece:s,setMarkingStartSquare:c,showPromotionArea:l};function t(){e.markingStartSquare=void 0}function n(){e.promotionMove=void 0}function r(){e.selectedPiece=void 0}function i(t,n){e.draggingPiece=n,e.draggingCoords=t}function a(){e.draggingPiece=void 0,e.draggingCoords=void 0}function o(){e.draggingPiece=void 0,e.draggingCoords=void 0,e.promotionMove=void 0,e.selectedPiece=void 0}function s(t){e.selectedPiece=t}function c(t){e.markingStartSquare=t}function l(t){e.promotionMove={...t}}}function u_( _hh$temp821 ){ var e=_hh$temp821.api,t=_hh$temp821.move,n=_hh$temp821.plyDiff,r=_hh$temp821.pieceSquare; let i=r&& __get$(e.getPieces().getCollection(),r) ?.color;return!t||n!==1||!i||i===t.color&&!t.userGenerated?!0:t.from===r||t.to===r}function d_( _hh$temp822 ){ var e=_hh$temp822.context,_hh$temp822$params=_hh$temp822.params,t=_hh$temp822$params.draggingPiece,n=_hh$temp822.UpdateParams;  let _hh$temp823=e,r=_hh$temp823.renderer; return n.dropPiece(),n.cancelPromotion(),r?.dropPiece(t,e),r?.closePromotionWindow(e),ix.States.Idle}function f_(){let e=Ww.getParams(),t=Ww.createUpdateParams(e),n=Ww.getCurrentState(),r=[zb.Events.Tick];return function(a,o){if(r.includes(a.type))return; let _hh$temp824=o,s=_hh$temp824.state; s.set({draggingPiece:e.draggingPiece,machineState:n,promotionMove:e.promotionMove,selectedPiece:e.selectedPiece});let c=s_(a)&&!c_(a.type)?`anyAPIEvent`:a.type;if(! __get$(Ww.states,n) ||! __get$(__get$(Ww.states,n),c) ){s.set({machineState:n});return}let l= __call$(__get$(Ww.states,n),c,[{context:o,data:a.data,params:e,UpdateParams:t,type:a.type}]) ,u=n;if(n=l||n,u!==n&&(n===ix.States.PieceDragging?document.onselectstart=()=>!1:u===ix.States.PieceDragging&&(document.onselectstart=null)),!i())throw{data:{draggingPiece:e.draggingPiece,machineState:n,oldState:u,selectedPiece:e.selectedPiece},error:new LC({code:RC.InvalidStateMachine,message:`The machine parameters and state do not match up.`})};s.set({draggingPiece:e.draggingPiece,machineState:n,selectedPiece:e.selectedPiece})};function i(){return n===ix.States.Idle?!e.draggingPiece&&!e.selectedPiece:n===ix.States.PieceDragging?!!e.draggingPiece:n===ix.States.PieceSelected?!e.draggingPiece&&!!e.selectedPiece:!0}}function p_(e,t){if(!e.beforeState)return!0;let n=!0;return e.beforeState.forEach(e=>{m_(e,t)===!1&&(n=!1)}),n}function m_(e,t){if(e.condition(...t))return e.handler(...t)}function h_(e,t){if(!e.match)return;e.match.forEach(e=>n(e,t));function n(e,t){e.condition(...t)&&e.handler(...t)}}function g_(e){return e.reduce((e,t)=>(t.afterRender?e.afterRender.push(t):e.beforeRender.push(t),e),{beforeRender:[],afterRender:[]})}function __( _hh$temp825 ){ var e=_hh$temp825.params,t=_hh$temp825.plugins; let n=o_({params:e,run:o}),r=f_();return{getContext:i,getMode:a,run:o,setMode:s,setRenderer:c};function i(){return n}function a(){return n.mode}function o(e){ let _hh$temp826=n,_hh$temp826$api=_hh$temp826.api,i=_hh$temp826$api.logger; i.log({code:K.LogCodes.Event,data:e}),n.reset();let a=t.get();l(e,a)&&r(e,n); let _hh$temp827=g_(a),o=_hh$temp827.beforeRender,s=_hh$temp827.afterRender; try{o.forEach(t=>h_(t,[e,n])),n.queue.flush(),s.forEach(t=>h_(t,[e,n])),n.queue.flush(),i.log({code:K.LogCodes.State,data:n.state.get()})}catch(t){throw i.log({code:K.LogCodes.State,data:{...t.data,event:e,queue:n.queue,state:n.state.get()},level:dx.Levels.Error}),t}}function s(e){n.setMode(e)}function c(e){n.setRenderer(e)}function l(e,t){return t.every(t=>p_(t,[e,n]))}}function v_(e){return e.altKey?Ub.Alt:e.ctrlKey?Ub.Ctrl:e.shiftKey?Ub.Shift:Ub.None}function y_(e){return e.touches!==void 0}function b_(e){return!y_(e)&&e.which===3}function x_(e){setTimeout(e)}function S_( _hh$temp828 ){ var e=_hh$temp828.el,t=_hh$temp828.getPointerPosition,n=_hh$temp828.options,r=_hh$temp828.run,i=_hh$temp828.api,a=_hh$temp828.monitorUntrustedEvents; let o=Yu(d);return{handleDocumentPointerdown:s(c),handlePointerdown:s(l),handlePointermove:s(o),handlePointerup:s(f)};function s(e){return function(t){if(e(t),!t.isTrusted&&a){let e=Zt(K.FairPlay.UntrustedUserEvent,t);i.emit(K.FairPlay.UntrustedUserEvent,e)}}}function c(e){let t=Zt(b_(e)?K.UserEvents.PointerdownRight:K.UserEvents.PointerdownLeft);return t.data={square:null},r(t)}function l(i){i.stopPropagation(),document.addEventListener(hC,o),document.addEventListener(gC,f);let a=Zt(b_(i)?K.UserEvents.PointerdownRight:K.UserEvents.PointerdownLeft);return a.data={...t({el:e,event:i,flipped:n.flipped}),keyPressed:v_(i)},x_(function(){document.addEventListener(pC.Mousedown,u,{once:!0})}),r(a)}function u(i){let a=Zt(b_(i)?K.UserEvents.MousedownRight:K.UserEvents.MousedownLeft);return a.data={...t({el:e,event:i,flipped:n.flipped}),keyPressed:v_(i)},r(a)}function d(i){let a=Zt(K.UserEvents.Pointermove);a.data={...t({el:e,event:i,flipped:n.flipped}),keyPressed:v_(i)},r(a)}function f(i){document.removeEventListener(pC.Mousedown,u),document.removeEventListener(hC,o),document.removeEventListener(gC,f);let a=Zt(K.UserEvents.Pointerup);return a.data={...t({el:e,event:i,flipped:n.flipped}),keyPressed:v_(i)},r(a)}}function C_(e){return(Array.isArray(e)?e:[e]).map(e=>`${e.name} (requires: ${e.requires?.join(`, `)})`).join(`, `)}function w_(e,t=new Map){return!e||e.every(e=>t.has(e))}function T_(e,t=new Map){return E_(e,t,new Map)}function E_(e,t,n){if(e.size===0)return n;let r=e.size,i=new Map([...t.entries(),...n.entries()]);return e.forEach(t=>{w_(t.requires,i)&&(n.set(t.name,t),e.delete(t.name))}),r===e.size?(n.clear(),n):E_(e,t,n)}function D_(e,t){if(e.length===0)return[];let n=T_(new Map(e.map(e=>[e.name,e])),new Map(t.map(e=>[e.name,e])));if(n.size===0){let t=C_(e);throw Error(`Required plugins do not exist: ${t}`)}return[...n.values()]}function O_(e=[],t){let n=ju();return n.addMany(e),{add:i,addMany:i,get:n.getAll,has:n.has,remove:a,setCreatePluginContext:n.setContext};function r(e){let t=n.getContext();if(!t)return; let _hh$temp829=e,r=_hh$temp829.api,i=_hh$temp829.apiOverrides,a=_hh$temp829.modeOverrides,o=_hh$temp829.name; r&&(e.destroyAPIMethods=t.api.extendAPI(o,{[o]:r})),i&&(e.destroyAPIOverrides=t.api.overrideAPI(o,i)),a&&(e.destroyModeOverrides=t.mode.extendMode(a))}function i(e){D_(Array.isArray(e)?e:[e],n.getAll()).forEach(i=>{if(n.has(i.name)&&n.remove(i.name),r(i),!n.add(i)){ let _hh$temp830=i,r=_hh$temp830.name; t?.log({code:Gw.LogCodes.CreateFailure,data:{currentPlugins:n.getAll().map(e=>e.name),data:C_(e),plugin:r},level:dx.Levels.Error,message:`Could not create ${r} plugin`}),a(i.name)}})}function a(e){var t,r,i;if(!n.has(e))return;let a=n.getOne(e);n.remove(e),(t=a?.destroyAPIMethods)==null||t.call(a),(r=a?.destroyAPIOverrides)==null||r.call(a),(i=a?.destroyModeOverrides)==null||i.call(a)}}function k_(e){return e===nx.Types.WebGL3D?a(()=>import( __get$ProxyUrl(`./index-fdb95f4b-CEuBKAke.js`,"https://www.chesskid.com/js/client-prod/assets/") ),[]):e===nx.Types.WebGL2D?a(()=>import( __get$ProxyUrl(`./index-a2f1ff53-CllNbWhD.js`,"https://www.chesskid.com/js/client-prod/assets/") ),[]):a(()=>import( __get$ProxyUrl(`./index-14f2a846-Cp1IOUIO.js`,"https://www.chesskid.com/js/client-prod/assets/") ),[])}function A_(e){ let _hh$temp831=Qb.Animation.Types,t=_hh$temp831.Arcade,n=_hh$temp831.Natural; return(e.themeAssets?e.themeAssets.config.perspective===qb.Perspective.REAL_3D:e.pieceStyle===X.PieceStyles.Trigger)?nx.Types.WebGL3D:[t,n].includes(e.animationType)?nx.Types.WebGL2D:nx.Types.Default}function j_(e){return k_(A_(e))}function M_(e={},t,n,r){let i=A_(n),a=i!==r,o=i===nx.Types.WebGL2D,s=`animationType`in e,c=e.animationType!==t.animationType,l=o&&s&&c;return(e.themeAssets&&e.themeAssets.config.perspective!==t.themeAssets?.config.perspective||Object.keys(e).some(e=>nx.TriggerOptions.includes(e)))&&(a||l)}function N_(e){let t=A_(e);if(!(t===nx.Types.WebGL2D||t===nx.Types.WebGL3D)||(window.hasWebGLSupport===void 0&&(window.hasWebGLSupport=n()),window.hasWebGLSupport))return!0;return P_(e,t===nx.Types.WebGL3D),!1;function n(){let e=document.createElement(`canvas`),t=e.getContext(`webgl`)||e.getContext(`experimental-webgl`);return!!t&&t instanceof WebGLRenderingContext}}function P_(e,t=!1){ let _hh$temp832=Bt(),n=_hh$temp832.pieceStyle,r=_hh$temp832.animationType; e.animationType=r,t&&(e.pieceStyle=n,e.themeAssets&&=Lt(e.themeAssets))}async function F_(e){return yt( __call$(Object,"assign",[{"../analysis/index.ts":()=>Promise.resolve().then(()=>dw),"../capture-the-star/index.ts":()=>Promise.resolve().then(()=>hw),"../exploring/index.ts":()=>Promise.resolve().then(()=>vw),"../guess-the-move/index.ts":()=>Promise.resolve().then(()=>Sw),"../observing/index.ts":()=>Promise.resolve().then(()=>ww),"../passive-observing/index.ts":()=>Promise.resolve().then(()=>kw),"../playing/index.ts":()=>Promise.resolve().then(()=>Dw),"../setup/index.ts":()=>Promise.resolve().then(()=>Mw)}]) ,`../${e.toLowerCase()}/index.ts`)}function I_(e){return function(){return e.state.get().machineState===ix.States.PieceDragging}}function L_( _hh$temp833 ){ var e=_hh$temp833.api,t=_hh$temp833.apiOptions,n=_hh$temp833.el,r=_hh$temp833.emitter,i=_hh$temp833.init,a=_hh$temp833.logger,o=_hh$temp833.mode,_hh$temp833$options=_hh$temp833.options,s=_hh$temp833$options===void 0?Bt():_hh$temp833$options,_hh$temp833$plugins=_hh$temp833.plugins,c=_hh$temp833$plugins===void 0?dp():_hh$temp833$plugins,l=_hh$temp833.renderer,_hh$temp833$monitorUntrustedEvents=_hh$temp833.monitorUntrustedEvents,u=_hh$temp833$monitorUntrustedEvents===void 0?!1:_hh$temp833$monitorUntrustedEvents; let d=e||i_({eventEmitter:r,logger:a,options:t||{}}),f={...Bt(),...s};n.id=`board-${f.id}`;let p=O_(),m=ee(),h,g,_=__({params:{api:d,el:n,options:f},plugins:p});p.setCreatePluginContext(_.getContext());let v= __call$(Object,"assign",[d,{destroy:x,getMode:_.getMode,getOptions:C,getVersion:()=>Kw,isDragging:I_(_.getContext()),getRenderer:()=>h,playSound:T,plugins:p,resize:E,run:w,setMode:D,setOptions:k,setRenderer:m}]) ,y=D(o);return`name`in y?b():y.then(b),v;function b(){p.add(c),w(Zt(K.InstanceEvents.Create)),n.addEventListener(`contextmenu`,e=>(e.stopPropagation(),e.preventDefault(),!1)),d.onAll(w),d.emit(K.InstanceEvents.Create,Zt(K.InstanceEvents.Create,_.getMode().name)),m(l).then(()=>{i&&d.load(i)})}function x(){S(),d.offAll(w);let e=Zt(K.InstanceEvents.Destroy);w(e),d.emit(K.InstanceEvents.Destroy,e)}function S(){_.setRenderer(),h?.offAll(d.logger.log),h?.destroy(),h=void 0,n.removeEventListener(mC,g?.handlePointerdown),document.removeEventListener(mC,g?.handleDocumentPointerdown),document.removeEventListener(hC,g?.handlePointermove),document.removeEventListener(gC,g?.handlePointerup)}function C(){return{...f}}function w(e){return _.run(e),e}function T(e){w(Zt(K.SoundEvents.Play,{sound:e}))}function E(e,t){w(Zt(K.UIEvents.Resize,{height:t,width:e}))}function D(e){return`modeType`in e?F_(e.modeType).then(t=>O(t.create(e.options))):O(e)}function O(e){var t,n;let r=_&&_.getMode();r&&((t=r.plugins)==null||t.forEach(e=>p.remove(e.name)),p.get().forEach(e=>e.destroyModeOverrides?.call(e)),(n=r.destroy)==null||n.call(r));let i=e(d);return d.usePlayingAs(i.usePlayingAs),i.plugins&&p.add(i.plugins),p.get().forEach(e=>e.modeOverrides&&i.extendMode(e.modeOverrides)),_&&(_.setMode(i),w(Zt(K.InstanceEvents.ModeChanged)),d.emit(K.InstanceEvents.ModeChanged,Zt(K.InstanceEvents.ModeChanged,_.getMode().name))),i}function k(e){let t={...f}; __call$(Object,"assign",[f||{},e]) ,e&&h&&M_(e,t,f,h.name)&&m(),d.emit(K.OptionsEvents.Update,Zt(K.OptionsEvents.Update,e))}function ee(){let e=Cc();return async function(n){e.add(t,n)};async function t(e){if(S(),e)h=e;else try{N_(f)||d.emit(K.InstanceEvents.RendererSetFailed,Zt(K.InstanceEvents.RendererSetFailed,{message:`WebGL is not supported by the browser. Will fallback to default.`,isWebGLRenderError:!0})),h=(await j_(f)).createRenderer({el:n,options:f})}catch(e){d.emit(K.InstanceEvents.RendererSetFailed,Zt(K.InstanceEvents.RendererSetFailed,{message:`Problem creating renderer. Will fallback to default.`,error:e})),P_(f,!0),h=(await j_(f)).createRenderer({el:n,options:f})}_.setRenderer(h), __call$(Object,"assign",[v,{animationComplete:h.animationComplete,getPointerPosition:h.getPointerPosition,isAnimating:h.isAnimating}]) ,g=S_({el:n,getPointerPosition:h.getPointerPosition,options:f,run:w,monitorUntrustedEvents:u,api:d}),n.addEventListener(mC,g.handlePointerdown),document.addEventListener(mC,g.handleDocumentPointerdown),h.onAll(d.logger.log),h.on(K.InstanceEvents.WebGLAssetsInitialized,()=>{d.emit(K.InstanceEvents.WebGLAssetsInitialized,{type:K.InstanceEvents.WebGLAssetsInitialized})}),d.emit(K.InstanceEvents.RendererSet,Zt(K.InstanceEvents.RendererSet,h.name))}}}function R_(e){return e===J.ColorsAsLetters.Black||e===J.ColorsAsWords.Black?J.ColorsAsNumbers.Black:J.ColorsAsNumbers.White}function z_( _hh$temp834 ){ var e=_hh$temp834.game,t=_hh$temp834.piece,n=_hh$temp834.toSquare;  let _hh$temp835=__arrayFrom$(t),r=_hh$temp835[0],i=_hh$temp835[1]; return n&&t&&e.getMode().isAllowedToMove()?e.move({color:R_(r),drop:i,to:n,userGenerated:!0})?.type===`Move`:!1}function B_(e,t){return e.getPlayingAs()===void 0?!0:e.getPlayingAs()===R_(t)}function V_(e,t,n){let r=document.createElement(`style`);return document.head.append(r),{getPieceStyles:o,removePieceStyleElement:i,updatePieceStyle:s};function i(){r.remove()}function a(e){ let _hh$temp836=__get$(t,e)??Zb.neo,r=_hh$temp836.path,i=_hh$temp836.format,a=_hh$temp836.isPseudo3d,o=It(r,void 0,(n?.getOptions())),s=a?`::after`:``; return Yb.reduce((e,t)=>`${e} .hand-piece.${t}${s} { background-image: url('${o}/${t}.${i}'); }`,``)}function o(e,t){if(!t)return a(e);let n=t.config.perspective===qb.Perspective.PSEUDO_3D?`::after`:``,r=t.config.perspective===qb.Perspective.REAL_3D?Wb:t.pieces.assets;return Jb.reduce((e,t)=>`${e} .hand-piece.${t}${n} { background-image: url('${ __get$(r,t) }'); }`,``)}function s(n,i){r.innerHTML=o(n,i),e(!!(i?i.config.perspective===qb.Perspective.PSEUDO_3D: __get$(t,n) ?.isPseudo3d))}}function H_(e,t,n){let r=e.slice();return r[30]= __get$(t,n) [0],r[31]= __get$(t,n) [1],r}function U_(e){let t,n=e[31]+``,r;return{c(){t=F(`span`),r=I(n),R(t,`class`,j(`hand-piece-count ${e[21]}`)+` svelte-qfge40`)},m(e,n){N(e,t,n),M(t,r)},p(e,t){t[0]&256&&n!==(n=e[31]+``)&&oe(r,n)},d(e){e&&P(t)}}}function W_(e){let t,n=Ca(e[31]),r,i,a,o,s,c,l=n&&U_(e);function u(...t){return e[28](e[30],...t)}return{c(){t=F(`div`),l&&l.c(),R(t,`class`,r=j(`hand-piece ${e[30]} ${wa({hidden:Sa(e[31])})} `)+` svelte-qfge40`),R(t,`style`,i=`${wa({[e[23]]:xa(e[30],e[9])})}`),R(t,`data-hand-piece`,a=e[30]),R(t,`data-hand-piece-selected`,o=xa(e[3],Jw.Selected)&&xa(e[30],e[9])?e[22]:null)},m(e,n){N(e,t,n),l&&l.m(t,null),s||=(c=L(t,`pointerdown`,u),!0)},p(s,c){e=s,c[0]&256&&(n=Ca(e[31])),n?l?l.p(e,c):(l=U_(e),l.c(),l.m(t,null)):l&&=(l.d(1),null),c[0]&256&&r!==(r=j(`hand-piece ${e[30]} ${wa({hidden:Sa(e[31])})} `)+` svelte-qfge40`)&&R(t,`class`,r),c[0]&768&&i!==(i=`${wa({[e[23]]:xa(e[30],e[9])})}`)&&R(t,`style`,i),c[0]&256&&a!==(a=e[30])&&R(t,`data-hand-piece`,a),c[0]&776&&o!==(o=xa(e[3],Jw.Selected)&&xa(e[30],e[9])?e[22]:null)&&R(t,`data-hand-piece-selected`,o)},d(e){e&&P(t),l&&l.d(),s=!1,c()}}}function G_(e){let t,n,r;return{c(){t=F(`div`),R(t,`class`,n=j(`hand-piece dragging ${e[10]}`)+` svelte-qfge40`),R(t,`style`,r=`${ev(e[11].current)}; width: ${e[2]}px; height: ${e[2]}px;`),R(t,`data-hand-piece`,e[10]),R(t,`data-hand-piece-dragging`,`true`)},m(e,n){N(e,t,n)},p(e,i){i[0]&1024&&n!==(n=j(`hand-piece dragging ${e[10]}`)+` svelte-qfge40`)&&R(t,`class`,n),i[0]&2052&&r!==(r=`${ev(e[11].current)}; width: ${e[2]}px; height: ${e[2]}px;`)&&R(t,`style`,r),i[0]&1024&&R(t,`data-hand-piece`,e[10])},d(e){e&&P(t)}}}function K_(e){let t,n,r=xa(e[3],Jw.Dragging),i,a=Object.entries(e[8]),o=[];for(let t=0;t<a.length;t+=1) __set$(o,t,W_(H_(e,a,t))) ;let s=r&&G_(e);return{c(){t=F(`div`);for(let e=0;e<o.length;e+=1) __get$(o,e) .c();n=re(),s&&s.c(),R(t,`class`,i=j(`${e[4]} ${qw.Classes.Component} ${wa({[qw.Classes.Flipped]:e[5],[qw.Classes.WithKing]:e[6],[qw.Classes.Pseudo3d]:e[7]})}`)+` svelte-qfge40`)},m(r,i){N(r,t,i);for(let e=0;e<o.length;e+=1) __get$(o,e) && __get$(o,e) .m(t,null);M(t,n),s&&s.m(t,null),e[29](t)},p(e,c){if(c[0]&14680841){a=Object.entries(e[8]);let r;for(r=0;r<a.length;r+=1){let i=H_(e,a,r); __get$(o,r) ? __get$(o,r) .p(i,c):( __set$(o,r,W_(i)) , __get$(o,r) .c(), __get$(o,r) .m(t,n))}for(;r<o.length;r+=1) __get$(o,r) .d(1);o.length=a.length}c[0]&8&&(r=xa(e[3],Jw.Dragging)),r?s?s.p(e,c):(s=G_(e),s.c(),s.m(t,null)):s&&=(s.d(1),null),c[0]&240&&i!==(i=j(`${e[4]} ${qw.Classes.Component} ${wa({[qw.Classes.Flipped]:e[5],[qw.Classes.WithKing]:e[6],[qw.Classes.Pseudo3d]:e[7]})}`)+` svelte-qfge40`)&&R(t,`class`,i)},i:S,o:S,d(n){n&&P(t),te(o,n),s&&s.d(),e[29](null)}}}function q_(e,t,n){ let r,i,a,o,s,c,l,u,d,_hh$temp837=t,f=_hh$temp837.data,_hh$temp838=t,p=_hh$temp838.game,_hh$temp839=t,m=_hh$temp839.boardEl,_hh$temp840=t,h=_hh$temp840.eventHandlers,_hh$temp841=t,g=_hh$temp841.removePieceStyleElement,_hh$temp842=f,_=_hh$temp842.handPieces,v=_hh$temp842.currentState,y=_hh$temp842.selectedPieceId,b=_hh$temp842.draggingPieceId,x=_hh$temp842.dragCoords,S=_hh$temp842.direction,C=_hh$temp842.showAllPieces,w=_hh$temp842.flipped,T=_hh$temp842.pseudo3d; A(e,_,e=>n(8,c=e)),A(e,v,e=>n(3,r=e)),A(e,y,e=>n(9,l=e)),A(e,b,e=>n(10,u=e)),A(e,x,e=>n(11,d=e)),A(e,S,e=>n(4,i=e)),A(e,C,e=>n(6,o=e)),A(e,w,e=>n(5,a=e)),A(e,T,e=>n(7,s=e));let E,D,O=p.getOptions().isSiblingBoard?`small`:``,k=$_(p.getOptions()),ee=`background-color: ${k};`;he(()=>{document.removeEventListener(pC.PointerMove,h.move),document.removeEventListener(pC.PointerUp,h.placeDrag),document.removeEventListener(pC.PointerDown,h.placeSelect),m.removeEventListener(pC.PointerDown,h.placeSelect),document.removeEventListener(pC.Mousedown,h.reset),g()});let j=(e,t)=>h.startDrag({event:t,piece:e});function M(e){ __call$(ot,e?`unshift`:`push`,[()=>{E=e,n(1,E);}]) }return e.$$set=e=>{`data`in e&&n(24,f=e.data),`game`in e&&n(25,p=e.game),`boardEl`in e&&n(26,m=e.boardEl),`eventHandlers`in e&&n(0,h=e.eventHandlers),`removePieceStyleElement`in e&&n(27,g=e.removePieceStyleElement)},e.$$.update=()=>{e.$$.dirty[0]&15&&(r===Jw.Dragging?(document.addEventListener(pC.PointerMove,h.move),document.addEventListener(pC.PointerUp,h.placeDrag),document.body.classList.add(qw.Classes.BodyDragging),D||n(2,D=E.children[0].clientWidth)):(document.removeEventListener(pC.PointerMove,h.move),document.removeEventListener(pC.PointerUp,h.placeDrag),document.body.classList.remove(qw.Classes.BodyDragging))),e.$$.dirty[0]&67108873&&(r===Jw.Selected?(document.addEventListener(pC.PointerDown,h.placeSelect),m.addEventListener(pC.PointerDown,h.placeSelect)):(document.removeEventListener(pC.PointerDown,h.placeSelect),m.removeEventListener(pC.PointerDown,h.placeSelect))),e.$$.dirty[0]&9&&(r===Jw.Idle?document.removeEventListener(pC.Mousedown,h.reset):document.addEventListener(pC.Mousedown,h.reset))},[h,E,D,r,i,a,o,s,c,l,u,d,_,v,y,b,x,S,C,w,T,O,k,ee,f,p,m,g,j,M]}function J_( _hh$temp843 ){ var e=_hh$temp843.options,t=_hh$temp843.target,_hh$temp843$replaceContainer=_hh$temp843.replaceContainer,n=_hh$temp843$replaceContainer===void 0?!0:_hh$temp843$replaceContainer; return Ws({ComponentType:Xw,options:{...e,target:t},replaceContainer:n})}function Y_( _hh$temp844 ){ var e=_hh$temp844.game,t=_hh$temp844.square; if(!e.getPieces().isDefined(t))return!1;let n=e.getVariant(),r=n===J.Variants.Crazyhouse||n===J.Variants.Bughouse,i=e.getPieces().get(t).color===e.getPlayingAs();return r&&i}function X_( _hh$temp845 ){ var e=_hh$temp845.game,t=_hh$temp845.boardEl,n=_hh$temp845.coords; return e.getPointerPosition({el:t,event:{clientX:n.x,clientY:n.y},flipped:e.getOptions().flipped})?.square}function Z_(e){ let _hh$temp846=e.getContext(),t=_hh$temp846.game; return(t?.hand)?.call(t)||``}function Q_(){let e=Object.values(J.Piece.Types);return[...e,...e.map(e=>e.toUpperCase())]}function $_(e){return e.themeAssets?.board.config.highlightSquareHex??Pt(e.boardStyle)?.highlightColor??Qb.HighlightColors.Selected}function ev(e){return`top: ${e.y}px; left: ${e.x}px; transform: translate(-50%, -50%)`}function tv( _hh$temp847 ){ var e=_hh$temp847.el,t=_hh$temp847.event;  let _hh$temp848=e.getBoundingClientRect(),n=_hh$temp848.width,r=_hh$temp848.height; return{height:r,width:n,x:t.clientX,y:t.clientY}}function nv( _hh$temp849 ){ var e=_hh$temp849.coords,t=_hh$temp849.initialCoords;  let _hh$temp850=e,n=_hh$temp850.x,r=_hh$temp850.y; if(n===0&&r===0)return!0; let _hh$temp851=t,i=_hh$temp851.height,a=_hh$temp851.width,o=_hh$temp851.x,s=_hh$temp851.y,c=a/2,l=i/2,u=o-c,d=o+c,f=s+l,p=s-l; return n>=u&&n<=d&&r<=f&&r>=p}function rv(e,t){let n=t.toLowerCase(),r=`${t===n?`b`:`w`}${n}`;return  __get$(e,r) ||( __set$(e,r,0) ), __set$(e,r,__get$(e,r)+1) ,e}function iv(e){ let _hh$temp852=e.actions,t=_hh$temp852.movePiece,n=_hh$temp852.selectPiece,r=_hh$temp852.deselectPiece,i=_hh$temp852.setState,a=_hh$temp852.startDrag,o=_hh$temp852.reset,s=_hh$temp852.afterPlaceAttempt,c=gs(av(e)); return c.onTransition(function( _hh$temp853 ){ var c=_hh$temp853.type,l=_hh$temp853.value,u=_hh$temp853.nextState; var d;let f=e.data.currentState.get();f!==u&&i(u);let p={[Yw.START_DRAG]:a,[Yw.MOVE]:t,[Yw.DESELECT]:r,[Yw.SELECT]:n,[Yw.PLACE]: _hh$temp854=>{var t=_hh$temp854.coords;return s({coords:t,game:e.game,oldState:f,nextState:u});} ,[Yw.RESET]:()=>o(e.game)};(d= __get$(p,c) )==null||d.call(p,l,u)}),c.on(`Enter`,function( _hh$temp855 ){ var t=_hh$temp855.nextState; t===Jw.Selected&&e.game.run({type:K.UserEvents.PointerdownRight,data:{}})}),c}function av( _hh$temp856 ){ var e=_hh$temp856.game,t=_hh$temp856.boardEl,n=_hh$temp856.data;  let _hh$temp857=n,r=_hh$temp857.draggingPieceId,i=_hh$temp857.dragCoords,a=_hh$temp857.selectedPieceId,o=_hh$temp857.continuousDrop; return{initialState:Jw.Idle,states:{[Jw.Idle]:{START_DRAG:()=>Jw.Dragging},[Jw.Selected]:{DESELECT:()=>Jw.Idle,SELECT:()=>Jw.Selected,START_DRAG:()=>Jw.Dragging,RESET:()=>Jw.Idle,PLACE:( _hh$temp858 )=>{ var n=_hh$temp858.coords; if(nv({coords:n,initialCoords:i.get().initial}))return Jw.Idle;let r=X_({game:e,coords:n,boardEl:t});if(r){if(e.plugins.has(`premoves`)&&Y_({game:e,square:r})||!z_({game:e,piece:a.get(),toSquare:r})&&Y_({game:e,square:r}))return e.run({data:{square:r},type:K.UserEvents.PointerdownLeft}),Jw.Idle;if(o.get())return e.getMode().name===`setup`&&e.run({type:K.UserEvents.MousedownRight}),Jw.Selected}return Jw.Idle}},[Jw.Dragging]:{RESET:()=>Jw.Idle,MOVE:()=>Jw.Dragging,PLACE: _hh$temp859=>{var n=_hh$temp859.coords;return nv({coords:n,initialCoords:i.get().initial})?Jw.Selected:(z_({game:e,piece:r.get(),toSquare:X_({game:e,coords:n,boardEl:t})}),Jw.Idle);} }}}}function ov( _hh$temp860 ){ var e=_hh$temp860.handPieces,t=_hh$temp860.continuousDrop,n=_hh$temp860.currentState,r=_hh$temp860.direction,i=_hh$temp860.dragCoords,a=_hh$temp860.draggingPieceId,o=_hh$temp860.flipped,s=_hh$temp860.pseudo3d,c=_hh$temp860.selectedPieceId,l=_hh$temp860.showAllPieces; function u(e){n.set(e)}function d(e){t.set(e)}function f(e){s.set(e)}function p(e){o.set(e)}function m(e){r.set(e)}function h(e){l.set(e)}function g(e){c.set(e)}function _(){c.set(``)}function v(e){a.set(e)}function y(e){i.update(t=>({current:e,initial:t.initial}))}function b( _hh$temp861 ){ var t=_hh$temp861.piece,n=_hh$temp861.initialCoords; v(t),g(``),i.set({current:n,initial:n}),e.update(e=>{let n= __get$(e,t) ;return n>0&&( __set$(e,t,n-1) ),e})}function x(t,n=!1){let r=l.get();n&&v(``);let i=(r?Q_():t.split(``)).reduce(rv,{});e.set(i);let o=a.get();o&& __get$(i,o) >0&&e.update(e=>{let t= __get$(e,o) ;return t>0&&( __set$(e,o,t-1) ),e})}function S( _hh$temp862 ){ var e=_hh$temp862.coords,t=_hh$temp862.game,n=_hh$temp862.oldState,r=_hh$temp862.nextState; let o=n===Jw.Dragging?a.get():``;x(Z_(t),!0),nv({coords:e,initialCoords:i.get().initial})&&g(o),r===`idle`&&w(t)}function C(e){e.direction&&m(e.direction),p(!!e.flipped),h(!!e.showAllPieces),d(!!e.canDropPiecesContinuously)}function w(e){g(``),x(Z_(e),!0)}return{setState:u,setContinuousDrop:d,setPseudo3d:f,setFlipped:p,setDirection:m,setShowAllPieces:h,selectPiece:g,deselectPiece:_,dragPiece:v,movePiece:y,startDrag:b,setHand:x,afterPlaceAttempt:S,setInitialData:C,reset:w}}function sv(){let e={handPieces:{},continuousDrop:!1,currentState:Jw.Idle,direction:`vertical`,dragCoords:{current:{x:0,y:0},initial:{x:0,y:0}},draggingPieceId:``,flipped:!1,isPseudo3d:!1,selectedPieceId:``,showAllPieces:!1},t={handPieces:bs(e.handPieces),continuousDrop:bs(e.continuousDrop),currentState:bs(e.currentState),direction:bs(e.direction),dragCoords:bs(e.dragCoords),draggingPieceId:bs(e.draggingPieceId),flipped:bs(e.flipped),pseudo3d:bs(e.isPseudo3d),selectedPieceId:bs(e.selectedPieceId),showAllPieces:bs(e.showAllPieces)};return{data:t,actions:ov(t)}}function cv(e, _hh$temp863 ){ var t=_hh$temp863.game,n=_hh$temp863.data;  let _hh$temp864=n,r=_hh$temp864.currentState,i=_hh$temp864.selectedPieceId,a=_hh$temp864.continuousDrop; return{startDrag:o,move:s,placeDrag:c,placeSelect:l,reset:u};function o( _hh$temp865 ){ var n=_hh$temp865.piece,o=_hh$temp865.event; o.stopPropagation(); let _hh$temp866=__arrayFrom$(n),s=_hh$temp866[0]; !B_(t,s)||b_(o)||(a.get()&&i.get()===n?e(Yw.DESELECT):a.get()&&r.get()===Jw.Selected?e(Yw.SELECT,n):e(Yw.START_DRAG,{piece:n,initialCoords:tv({el:o.currentTarget,event:o})}))}function s( _hh$temp867 ){ var t=_hh$temp867.clientX,n=_hh$temp867.clientY; e(Yw.MOVE,{x:t,y:n})}function c( _hh$temp868 ){ var t=_hh$temp868.clientX,n=_hh$temp868.clientY; e(Yw.PLACE,{coords:{x:t,y:n}})}function l(t){t.stopPropagation(),!b_(t)&&e(Yw.PLACE,{coords:{x:t.clientX,y:t.clientY},targetEl:t.target})}function u(t){t.stopPropagation(),b_(t)&&(document.oncontextmenu=()=>!1,x_(()=>document.oncontextmenu=()=>!0),e(Yw.RESET,{targetEl:t.target}))}}function lv( _hh$temp869 ){ var e=_hh$temp869.boardEl,t=_hh$temp869.containerEl,n=_hh$temp869.direction,_hh$temp869$showAllPieces=_hh$temp869.showAllPieces,r=_hh$temp869$showAllPieces===void 0?!1:_hh$temp869$showAllPieces,_hh$temp869$canDropPiecesContinuously=_hh$temp869.canDropPiecesContinuously,i=_hh$temp869$canDropPiecesContinuously===void 0?!1:_hh$temp869$canDropPiecesContinuously,a=_hh$temp869.flipped,o=_hh$temp869.game,_hh$temp869$pieceStyles=_hh$temp869.pieceStyles,s=_hh$temp869$pieceStyles===void 0?Zb:_hh$temp869$pieceStyles,c=_hh$temp869.replaceContainer;  let _hh$temp870=sv(),l=_hh$temp870.data,u=_hh$temp870.actions,_hh$temp871=u,d=_hh$temp871.setDirection,f=_hh$temp871.setHand,p=_hh$temp871.setFlipped,m=_hh$temp871.setInitialData,h=_hh$temp871.setPseudo3d,g=_hh$temp871.setShowAllPieces,_=_hh$temp871.setContinuousDrop; m({direction:n,showAllPieces:r,flipped:a,canDropPiecesContinuously:i}); let v=iv({data:l,actions:u,boardEl:e,game:o}),y=cv(v.send,{data:l,game:o}),_hh$temp872=V_(h,s,o),b=_hh$temp872.removePieceStyleElement,x=_hh$temp872.updatePieceStyle; return{destroy:J_({options:{props:{data:l,game:o,boardEl:e,eventHandlers:y,removePieceStyleElement:b}},replaceContainer:c,target:t}).destroy,getHand:()=>Z_(o),reset:()=>v.send(Yw.RESET),setDirection:d,setFlipped:p,setHand:f,setShowAllPieces:g,setContinuousDrop:_,updatePieceStyle:x}}function uv( _hh$temp873 ={}){ var e=_hh$temp873.direction,t=_hh$temp873.el,n=_hh$temp873.pieceStyles,r=_hh$temp873.replaceContainer; let i;return{create:a,destroy:o,match:[{condition:Ct([K.APIEvents.Load,K.OptionsEvents.Update]),handler:s},{condition:xt(K.OptionsEvents.UpdateMode),handler:u},{condition:Ct([...sS,Tb.Events.SetHand]),handler:c},{condition:xt(K.InstanceEvents.ModeChanged),handler:l}],name:Tb.Plugin.Name};function a(a){ let _hh$temp874=a,o=_hh$temp874.api,s=_hh$temp874.el,c=_hh$temp874.mode,_hh$temp875=a.options,l=_hh$temp875.flipped,u=_hh$temp875.pieceStyle,f=_hh$temp875.themeAssets,_hh$temp876=c.getOptions(),p=_hh$temp876.canDropPiecesContinuously,m=d(c.name); i=lv({boardEl:s,containerEl:t||s,direction:e,flipped:l,game:o,pieceStyles:n,canDropPiecesContinuously:p,replaceContainer:r,showAllPieces:m}),i.updatePieceStyle(u,f),i.setHand(i.getHand())}function o(){i.destroy()}function s(e,t){e.type===K.APIEvents.Load&&i.reset(); let _hh$temp877=t.options,n=_hh$temp877.flipped,r=_hh$temp877.pieceStyle,a=_hh$temp877.themeAssets; i.setHand(i.getHand()),i.setFlipped(n),i.updatePieceStyle(r,a)}function c(){i.setHand(i.getHand())}function l(e,t){ let n=d(e.data),_hh$temp878=(t.mode?.getOptions()),r=_hh$temp878.canDropPiecesContinuously; i.setContinuousDrop(!!r),i.setShowAllPieces(n)}function u(e){e.data.canDropPiecesContinuously!==void 0&&i.setContinuousDrop(!!e.data.canDropPiecesContinuously)}function d(e){return e===lw.Types.Setup}}function dv(e,t=150,n){return`${Ft(n)}/boards/${e}/${t}.png`}function fv(e){return!e||!e.file||!e.rank||e.file>8||e.rank>8||e.file<1||e.rank<1?null:`${String.fromCharCode(96+e.file)}${e.rank.toString()}`}function pv(e){let t=[{animate:e.animate,from:yr(e),to:e.from}];e.rookMove&&t.push({...e.rookMove,from:e.rookMove.to,to:e.rookMove.from});let n=e.captured&&e.capturedStr?{color:Up(e.color),promoted:e.capturedPromotedPawn,square:e.EPCapturedSquare||e.to,type:e.capturedStr.toLowerCase()}:void 0;return{movedPieces:t,promotedSquare:e.promotion?e.from:void 0,restoredPiece:n}}function mv(e,t){return(e&& __get$(t,__get$(J.Node.Marking.JCEColorsMap,e)) )??e??t.default}function hv( _hh$temp879 ){ var e=_hh$temp879.from,t=_hh$temp879.to; return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)}function gv( _hh$temp880 ){ var e=_hh$temp880.from,t=_hh$temp880.to; let n=hv({from:e,to:t}),r={x:e.x,y:e.y+n},i={x:e.x-r.x,y:e.y-r.y},a={x:e.x-t.x,y:e.y-t.y},o=Math.acos((i.x*a.x+i.y*a.y)/n**2),s=Math.floor(o*(180/Math.PI)*100)/100;return e.x<t.x?360-s:s}function _v( _hh$temp881 ){ var e=_hh$temp881.from,t=_hh$temp881.to; let n=(e.y-t.y)/(e.x-t.x);return Number(n.toFixed(1))}function vv( _hh$temp882 ){ var e=_hh$temp882.from,t=_hh$temp882.slope,n=_hh$temp882.to; switch(t){case 2:return e.x>n.x?180:0;case-2:return e.x>n.x?0:180;case .5:return e.x>n.x?90:270;case-.5:return e.x>n.x?90:270;default:return 0}}function yv(e,t){return e.test(t)}function bv(e){e||=typeof navigator<`u`?navigator.userAgent:``;let t=e.split(`[FBAN`);t[1]!==void 0&&(e=t[0]),t=e.split(`Twitter`),t[1]!==void 0&&(e=t[0]);let n={apple:{phone:yv(eT,e)&&!yv(sT,e),ipod:yv(tT,e),tablet:!yv(eT,e)&&yv(nT,e)&&!yv(sT,e),device:(yv(eT,e)||yv(tT,e)||yv(nT,e))&&!yv(sT,e)},amazon:{phone:yv(aT,e),tablet:!yv(aT,e)&&yv(oT,e),device:yv(aT,e)||yv(oT,e)},android:{phone:!yv(sT,e)&&yv(aT,e)||!yv(sT,e)&&yv(rT,e),tablet:!yv(sT,e)&&!yv(aT,e)&&!yv(rT,e)&&(yv(oT,e)||yv(iT,e)),device:!yv(sT,e)&&(yv(aT,e)||yv(oT,e)||yv(rT,e)||yv(iT,e))||yv(/\bokhttp\b/i,e)},windows:{phone:yv(sT,e),tablet:yv(cT,e),device:yv(sT,e)||yv(cT,e)},other:{blackberry:yv(lT,e),blackberry10:yv(uT,e),opera:yv(dT,e),firefox:yv(pT,e),chrome:yv(fT,e),device:yv(lT,e)||yv(uT,e)||yv(dT,e)||yv(pT,e)||yv(fT,e)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}function xv(e){var t=!0;if(mT.tablet||mT.phone){if(t=!1,mT.apple.device){var n=navigator.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)>=11&&(t=!0)}if(mT.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)>=7&&(t=!0)}}return t?e:4}function Sv(){return!mT.apple.device}function Cv(e,t,n){n||=2;var r=t&&t.length,i=r?t[0]*n:e.length,a=wv(e,0,i,n,!0),o=[];if(!a||a.next===a.prev)return o;var s,c,l,u,d,f,p;if(r&&(a=jv(e,t,a,n)),e.length>80*n){s=l=e[0],c=u=e[1];for(var m=n;m<i;m+=n)d= __get$(e,m) ,f= __get$(e,m+1) ,d<s&&(s=d),f<c&&(c=f),d>l&&(l=d),f>u&&(u=f);p=Math.max(l-s,u-c),p=p===0?0:1/p}return Ev(a,o,n,s,c,p),o}function wv(e,t,n,r,i){var a,o;if(i===ey(e,t,n,r)>0)for(a=t;a<n;a+=r)o=Zv(a, __get$(e,a) , __get$(e,a+1) ,o);else for(a=n-r;a>=t;a-=r)o=Zv(a, __get$(e,a) , __get$(e,a+1) ,o);return o&&Uv(o,o.next)&&(Qv(o),o=o.next),o}function Tv(e,t){if(!e)return e;t||=e;var n=e,r;do if(r=!1,!n.steiner&&(Uv(n,n.next)||Hv(n.prev,n,n.next)===0)){if(Qv(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function Ev(e,t,n,r,i,a,o){if(e){!o&&a&&Iv(e,r,i,a);for(var s=e,c,l;e.prev!==e.next;){if(c=e.prev,l=e.next,a?Ov(e,r,i,a):Dv(e)){t.push(c.i/n),t.push(e.i/n),t.push(l.i/n),Qv(e),e=l.next,s=l.next;continue}if(e=l,e===s){o?o===1?(e=kv(Tv(e),t,n),Ev(e,t,n,r,i,a,2)):o===2&&Av(e,t,n,r,i,a):Ev(Tv(e),t,n,r,i,a,1);break}}}}function Dv(e){var t=e.prev,n=e,r=e.next;if(Hv(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(Bv(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Hv(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Ov(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Hv(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,c=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,u=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,d=Rv(s,c,t,n,r),f=Rv(l,u,t,n,r),p=e.prevZ,m=e.nextZ;p&&p.z>=d&&m&&m.z<=f;){if(p!==e.prev&&p!==e.next&&Bv(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Hv(p.prev,p,p.next)>=0||(p=p.prevZ,m!==e.prev&&m!==e.next&&Bv(i.x,i.y,a.x,a.y,o.x,o.y,m.x,m.y)&&Hv(m.prev,m,m.next)>=0))return!1;m=m.nextZ}for(;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&Bv(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Hv(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;m&&m.z<=f;){if(m!==e.prev&&m!==e.next&&Bv(i.x,i.y,a.x,a.y,o.x,o.y,m.x,m.y)&&Hv(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function kv(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!Uv(i,a)&&Wv(i,r,r.next,a)&&Jv(i,a)&&Jv(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),Qv(r),Qv(r.next),r=e=a),r=r.next}while(r!==e);return Tv(r)}function Av(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Vv(o,s)){var c=Xv(o,s);o=Tv(o,o.next),c=Tv(c,c.next),Ev(o,t,n,r,i,a),Ev(c,t,n,r,i,a);return}s=s.next}o=o.next}while(o!==e)}function jv(e,t,n,r){var i=[],a,o,s,c,l;for(a=0,o=t.length;a<o;a++)s= __get$(t,a) *r,c=a<o-1? __get$(t,a+1) *r:e.length,l=wv(e,s,c,r,!1),l===l.next&&(l.steiner=!0),i.push(zv(l));for(i.sort(Mv),a=0;a<i.length;a++)Nv( __get$(i,a) ,n),n=Tv(n,n.next);return n}function Mv(e,t){return e.x-t.x}function Nv(e,t){if(t=Pv(e,t),t){var n=Xv(t,e);Tv(t,t.next),Tv(n,n.next)}}function Pv(e,t){var n=t,r=e.x,i=e.y,a=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>a){if(a=s,s===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!o)return null;if(r===a)return o;var c=o,l=o.x,u=o.y,d=1/0,f;n=o;do r>=n.x&&n.x>=l&&r!==n.x&&Bv(i<u?r:a,i,l,u,i<u?a:r,i,n.x,n.y)&&(f=Math.abs(i-n.y)/(r-n.x),Jv(n,e)&&(f<d||f===d&&(n.x>o.x||n.x===o.x&&Fv(o,n)))&&(o=n,d=f)),n=n.next;while(n!==c);return o}function Fv(e,t){return Hv(e.prev,e,t.prev)<0&&Hv(t.next,e,e.next)<0}function Iv(e,t,n,r){var i=e;do i.z===null&&(i.z=Rv(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,Lv(i)}function Lv(e){var t,n,r,i,a,o,s,c,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ,r);t++);for(c=l;s>0||c>0&&r;)s!==0&&(c===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1);return e}function Rv(e,t,n,r,i){return e=32767*(e-n)*i,t=32767*(t-r)*i,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function zv(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function Bv(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Vv(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!qv(e,t)&&(Jv(e,t)&&Jv(t,e)&&Yv(e,t)&&(Hv(e.prev,e,t.prev)||Hv(e,t.prev,t))||Uv(e,t)&&Hv(e.prev,e,e.next)>0&&Hv(t.prev,t,t.next)>0)}function Hv(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Uv(e,t){return e.x===t.x&&e.y===t.y}function Wv(e,t,n,r){var i=Kv(Hv(e,t,n)),a=Kv(Hv(e,t,r)),o=Kv(Hv(n,r,e)),s=Kv(Hv(n,r,t));return!!(i!==a&&o!==s||i===0&&Gv(e,n,t)||a===0&&Gv(e,r,t)||o===0&&Gv(n,e,r)||s===0&&Gv(n,t,r))}function Gv(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Kv(e){return e>0?1:e<0?-1:0}function qv(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Wv(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function Jv(e,t){return Hv(e.prev,e,e.next)<0?Hv(e,t,e.next)>=0&&Hv(e,e.prev,t)>=0:Hv(e,t,e.prev)<0||Hv(e,e.next,t)<0}function Yv(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function Xv(e,t){var n=new $v(e.i,e.x,e.y),r=new $v(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Zv(e,t,n,r){var i=new $v(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Qv(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function $v(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ey(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=( __get$(e,o) - __get$(e,a) )*( __get$(e,a+1) + __get$(e,o+1) ),o=a;return i}function ty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ny(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null, __set$(this,"href",null) }function ry(e,t,n){if(e&&OT.isObject(e)&&e instanceof ny)return e;var r=new ny;return r.parse(e,t,n),r}function iy(e){return OT.isString(e)&&(e=ry(e)),e instanceof ny?e.format():ny.prototype.format.call(e)}function ay(e,t){return ry(e,!1,!0).resolve(t)}function oy(e,t){return e?ry(e,!1,!0).resolveObject(t):t}function sy(e){var t;if(!iE){if(navigator.userAgent.toLowerCase().indexOf(`chrome`)>-1){var n=[`
 %c %c %c PixiJS `+aE+` -  `+e+`   %c  %c  http://www.pixijs.com/  %c %c %c%c 

`,`background: #ff66a5; padding:5px 0;`,`background: #ff66a5; padding:5px 0;`,`color: #ff66a5; background: #030307; padding:5px 0;`,`background: #ff66a5; padding:5px 0;`,`background: #ffc3dc; padding:5px 0;`,`background: #ff66a5; padding:5px 0;`,`color: #ff2424; background: #fff; padding:5px 0;`,`color: #ff2424; background: #fff; padding:5px 0;`,`color: #ff2424; background: #fff; padding:5px 0;`];(t=window.console).log.apply(t,n)}else window.console&&window.console.log(`PixiJS `+aE+` - `+e+` - http://www.pixijs.com/`);iE=!0}}function cy(){return oE===void 0&&(oE=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:hT.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement(`canvas`),n=t.getContext(`webgl`,e)||t.getContext(`experimental-webgl`,e),r=!!(n&&n.getContextAttributes().stencil);if(n){var i=n.getExtension(`WEBGL_lose_context`);i&&i.loseContext()}return n=null,r}catch{return!1}}()),oE}function ly(e,t){return t||=[],t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t}function uy(e){var t=e.toString(16);return t=`000000`.substr(0,6-t.length)+t,`#`+t}function dy(e){return typeof e==`string`&&e[0]===`#`&&(e=e.substr(1)),parseInt(e,16)}function fy(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)}function py(){for(var e=[],t=[],n=0;n<32;n++) __set$(e,n,n) , __set$(t,n,n) ; __set$(e,KT.NORMAL_NPM,KT.NORMAL) , __set$(e,KT.ADD_NPM,KT.ADD) , __set$(e,KT.SCREEN_NPM,KT.SCREEN) , __set$(t,KT.NORMAL,KT.NORMAL_NPM) , __set$(t,KT.ADD,KT.ADD_NPM) , __set$(t,KT.SCREEN,KT.SCREEN_NPM) ;var r=[];return r.push(t),r.push(e),r}function my(e,t){return  __get$(__get$(sE,t?1:0),e) }function hy(e,t,n,r){return n||=new Float32Array(4),r||r===void 0?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t):(n[0]=e[0],n[1]=e[1],n[2]=e[2]),n[3]=t,n}function gy(e,t){if(t===1)return(t*255<<24)+e;if(t===0)return 0;var n=e>>16&255,r=e>>8&255,i=e&255;return n=n*t+.5|0,r=r*t+.5|0,i=i*t+.5|0,(t*255<<24)+(n<<16)+(r<<8)+i}function _y(e,t,n,r){return n||=new Float32Array(4),n[0]=(e>>16&255)/255,n[1]=(e>>8&255)/255,n[2]=(e&255)/255,(r||r===void 0)&&(n[0]*=t,n[1]*=t,n[2]*=t),n[3]=t,n}function vy(e,t){t===void 0&&(t=null);var n=e*6;if(t||=new Uint16Array(n),t.length!==n)throw Error(`Out buffer length is incorrect, got `+t.length+` and expected `+n);for(var r=0,i=0;r<n;r+=6,i+=4) __set$(t,r+0,i+0) , __set$(t,r+1,i+1) , __set$(t,r+2,i+2) , __set$(t,r+3,i+0) , __set$(t,r+4,i+2) , __set$(t,r+5,i+3) ;return t}function yy(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function by(e){return!(e&e-1)&&!!e}function xy(e){var t=(e>65535?1:0)<<4;e>>>=t;var n=(e>255?1:0)<<3;return e>>>=n,t|=n,n=(e>15?1:0)<<2,e>>>=n,t|=n,n=(e>3?1:0)<<1,e>>>=n,t|=n,t|e>>1}function Sy(e,t,n){var r=e.length,i;if(!(t>=r||n===0)){n=t+n>r?r-t:n;var a=r-n;for(i=t;i<a;++i) __set$(e,i,__get$(e,i+n)) ;e.length=a}}function Cy(e){return e===0?0:e<0?-1:1}function wy(){return++cE}function Ty(e,t,n){if(n===void 0&&(n=3),! __get$(lE,t) ){var r=Error().stack;r===void 0?console.warn(`PixiJS Deprecation Warning: `,t+`
Deprecated since v`+e):(r=r.split(`
`).splice(n).join(`
`),console.groupCollapsed?(console.groupCollapsed(`%cPixiJS Deprecation Warning: %c%s`,`color:#614108;background:#fffbe6`,`font-weight:normal;color:#614108;background:#fffbe6`,t+`
Deprecated since v`+e),console.warn(r),console.groupEnd()):(console.warn(`PixiJS Deprecation Warning: `,t+`
Deprecated since v`+e),console.warn(r))), __set$(lE,t,!0) }}function Ey(e){var t=e.width,n=e.height,r=e.getContext(`2d`),i=r.getImageData(0,0,t,n).data,a=i.length,o={top:null,left:null,right:null,bottom:null},s=null,c,l,u;for(c=0;c<a;c+=4) __get$(i,c+3) !==0&&(l=c/4%t,u=~~(c/4/t),o.top===null&&(o.top=u),(o.left===null||l<o.left)&&(o.left=l),(o.right===null||o.right<l)&&(o.right=l+1),(o.bottom===null||o.bottom<u)&&(o.bottom=u));return o.top!==null&&(t=o.right-o.left,n=o.bottom-o.top+1,s=r.getImageData(o.left,o.top,t,n)),{height:n,width:t,data:s}}function Dy(e,t){if(t===void 0&&(t= __get$(window,"location") ),e.indexOf(`data:`)===0)return``;t||= __get$(window,"location") ,mE||=document.createElement(`a`), __set$(mE,"href",e) ;var n=kT( __get$(mE,"href") ),r=!n.port&&t.port===``||n.port===t.port;return n.hostname!==t.hostname||!r||n.protocol!==t.protocol?`anonymous`:``}function Oy(e,t){var n=hT.RETINA_PREFIX.exec(e);return n?parseFloat(n[1]):t===void 0?1:t}function ky(){for(var e=0;e<16;e++){var t=[];EE.push(t);for(var n=0;n<16;n++)for(var r=OE( __get$(SE,e) * __get$(SE,n) + __get$(wE,e) * __get$(CE,n) ),i=OE( __get$(CE,e) * __get$(SE,n) + __get$(TE,e) * __get$(CE,n) ),a=OE( __get$(SE,e) * __get$(wE,n) + __get$(wE,e) * __get$(TE,n) ),o=OE( __get$(CE,e) * __get$(wE,n) + __get$(TE,e) * __get$(TE,n) ),s=0;s<16;s++)if( __get$(SE,s) ===r&& __get$(CE,s) ===i&& __get$(wE,s) ===a&& __get$(TE,s) ===o){t.push(s);break}}for(var e=0;e<16;e++){var c=new xE;c.set( __get$(SE,e) , __get$(CE,e) , __get$(wE,e) , __get$(TE,e) ,0,0),DE.push(c)}}function Ay(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}function jy(e,t){if(!e)return null;var n=``;if(typeof e==`string`){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);r&&(n=r[1].toLowerCase())}for(var i=JE.length-1;i>=0;--i){var a= __get$(JE,i) ;if(a.test&&a.test(e,n))return new a(e,t)}return new qE(e,t)}function My(){var e=document.createElement(`canvas`);e.width=16,e.height=16;var t=e.getContext(`2d`);return t.fillStyle=`white`,t.fillRect(0,0,16,16),new dD(new ZE(new $E(e)))}function Ny(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}function Py(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?`Float32Array`:e instanceof Uint32Array?`Uint32Array`:`Int32Array`;if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return`Uint16Array`}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return`Uint8Array`;return null}function Fy(e,t){for(var n=0,r=0,i={},a=0;a<e.length;a++)r+= __get$(t,a) ,n+= __get$(e,a) .length;for(var o=new ArrayBuffer(n*4),s=null,c=0,l=0;l<e.length;l++){var u= __get$(t,l) ,d= __get$(e,l) ,f=Py(d); __get$(i,f) ||( __set$(i,f,new _D[f](o)) ),s= __get$(i,f) ;for(var p=0;p<d.length;p++){var m=(p/u|0)*r+c,h=p%u; __set$(s,m+h,__get$(d,p)) }c+=u}return new Float32Array(o)}function Iy(e,t,n,r){var i=Ly(e,e.VERTEX_SHADER,t),a=Ly(e,e.FRAGMENT_SHADER,n),o=e.createProgram();if(e.attachShader(o,i),e.attachShader(o,a),r)for(var s in r)e.bindAttribLocation(o, __get$(r,s) ,s);return e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||(e.getShaderParameter(i,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(i))),e.getShaderParameter(a,e.COMPILE_STATUS)||(console.warn(n),console.error(e.getShaderInfoLog(a))),console.error(`Pixi.js Error: Could not initialize shader.`),console.error(`gl.VALIDATE_STATUS`,e.getProgramParameter(o,e.VALIDATE_STATUS)),console.error(`gl.getError()`,e.getError()),e.getProgramInfoLog(o)!==``&&console.warn(`Pixi.js Warning: gl.getProgramInfoLog()`,e.getProgramInfoLog(o)),e.deleteProgram(o),o=null),e.deleteShader(i),e.deleteShader(a),o}function Ly(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}function Ry(e,t){switch(e){case`float`:return 0;case`vec2`:return new Float32Array(2*t);case`vec3`:return new Float32Array(3*t);case`vec4`:return new Float32Array(4*t);case`int`:case`sampler2D`:case`sampler2DArray`:return 0;case`ivec2`:return new Int32Array(2*t);case`ivec3`:return new Int32Array(3*t);case`ivec4`:return new Int32Array(4*t);case`bool`:return!1;case`bvec2`:return zy(2*t);case`bvec3`:return zy(3*t);case`bvec4`:return zy(4*t);case`mat2`:return new Float32Array([1,0,0,1]);case`mat3`:return new Float32Array([1,0,0,0,1,0,0,0,1]);case`mat4`:return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function zy(e){for(var t=Array(e),n=0;n<t.length;n++) __set$(t,n,!1) ;return t}function By(){if(RD===LD||RD&&RD.isContextLost()){var e=document.createElement(`canvas`),t;hT.PREFER_ENV>=WT.WEBGL2&&(t=e.getContext(`webgl2`,{})),t||(t=e.getContext(`webgl`,{})||e.getContext(`experimental-webgl`,{}),t?t.getExtension(`WEBGL_draw_buffers`):t=null),RD=t}return RD}function Vy(){if(!zD){zD=nE.MEDIUM;var e=By();e&&e.getShaderPrecisionFormat&&(zD=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?nE.HIGH:nE.MEDIUM)}return zD}function Hy(e,t,n){if(e.substring(0,9)!==`precision`){var r=t;return t===nE.HIGH&&n!==nE.HIGH&&(r=nE.MEDIUM),`precision `+r+` float;
`+e}else if(n!==nE.HIGH&&e.substring(0,15)===`precision highp`)return  __call$(e,"replace",[`precision highp`,`precision mediump`]) ;return e}function Uy(e){return  __get$(BD,e) }function Wy(e,t){if(!VD){var n=Object.keys(HD);VD={};for(var r=0;r<n.length;++r){var i= __get$(n,r) ; __set$(VD,__get$(e,i),__get$(HD,i)) }}return  __get$(VD,t) }function Gy(e,t){var n=`var v = null;
    var cv = null
    var t = 0;
    var gl = renderer.gl
    `;for(var r in e.uniforms){var i= __get$(t,r) ;if(!i){ __get$(e.uniforms,r) .group&&(n+=`
                    renderer.shader.syncUniformGroup(uv.`+r+`, syncData);
                `);continue}if(i.type===`float`&&i.size===1)n+=`
            if(uv.`+r+` !== ud.`+r+`.value)
            {
                ud.`+r+`.value = uv.`+r+`
                gl.uniform1f(ud.`+r+`.location, uv.`+r+`)
            }
`;else if((i.type===`sampler2D`||i.type===`samplerCube`||i.type===`sampler2DArray`)&&i.size===1&&!i.isArray)n+=`

            t = syncData.textureCount++;

            renderer.texture.bind(uv.`+r+`, t);
            
            if(ud.`+r+`.value !== t)
            {
                ud.`+r+`.value = t;
                gl.uniform1i(ud.`+r+`.location, t);
; // eslint-disable-line max-len
            }
`;else if(i.type===`mat3`&&i.size===1) __get$(e.uniforms,r) .a===void 0?n+=`
                gl.uniformMatrix3fv(ud.`+r+`.location, false, uv.`+r+`);
                
`:n+=`
                gl.uniformMatrix3fv(ud.`+r+`.location, false, uv.`+r+`.toArray(true));
                
`;else if(i.type===`vec2`&&i.size===1) __get$(e.uniforms,r) .x===void 0?n+=`
                cv = ud.`+r+`.value;
                v = uv.`+r+`;

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud.`+r+`.location, v[0], v[1]);
                }
                
`:n+=`
                cv = ud.`+r+`.value;
                v = uv.`+r+`;

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud.`+r+`.location, v.x, v.y);
                }
`;else if(i.type===`vec4`&&i.size===1) __get$(e.uniforms,r) .width===void 0?n+=`
                cv = ud.`+r+`.value;
                v = uv.`+r+`;

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud.`+r+`.location, v[0], v[1], v[2], v[3])
                }
                
`:n+=`
                cv = ud.`+r+`.value;
                v = uv.`+r+`;

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud.`+r+`.location, v.x, v.y, v.width, v.height)
                }
`;else{var a= __call$(__get$(i.size===1?UD:WD,i.type),"replace",[`location`,`ud.`+r+`.location`]) ;n+=`
            cv = ud.`+r+`.value;
            v = uv.`+r+`;
            `+a+`;
`}}return Function(`ud`,`uv`,`renderer`,`syncData`,n)}function Ky(e,t){if(e===0)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=t.createShader(t.FRAGMENT_SHADER);;){var r= __call$(GD,"replace",[/%forloop%/gi,qy(e)]) ;if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))e=e/2|0;else break}return e}function qy(e){for(var t=``,n=0;n<e;++n)n>0&&(t+=`
else `),n<e-1&&(t+=`if(test == `+n+`.0){}`);return t}function Jy(){if(typeof KD==`boolean`)return KD;try{KD=Function(`param1`,`param2`,`param3`,`return param1[param2] === param3;`)({a:`b`},`a`,`b`)===!0}catch{KD=!1}return KD}function Yy(e,t){return t===void 0&&(t=[]), __set$(t,KT.NORMAL,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.ADD,[e.ONE,e.ONE]) , __set$(t,KT.MULTIPLY,[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.SCREEN,[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.OVERLAY,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.DARKEN,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.LIGHTEN,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.COLOR_DODGE,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.COLOR_BURN,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.HARD_LIGHT,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.SOFT_LIGHT,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.DIFFERENCE,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.EXCLUSION,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.HUE,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.SATURATION,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.COLOR,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.LUMINOSITY,[e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.NONE,[0,0]) , __set$(t,KT.NORMAL_NPM,[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.ADD_NPM,[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE]) , __set$(t,KT.SCREEN_NPM,[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.SRC_IN,[e.DST_ALPHA,e.ZERO]) , __set$(t,KT.SRC_OUT,[e.ONE_MINUS_DST_ALPHA,e.ZERO]) , __set$(t,KT.SRC_ATOP,[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.DST_OVER,[e.ONE_MINUS_DST_ALPHA,e.ONE]) , __set$(t,KT.DST_IN,[e.ZERO,e.SRC_ALPHA]) , __set$(t,KT.DST_OUT,[e.ZERO,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.DST_ATOP,[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA]) , __set$(t,KT.XOR,[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA]) , __set$(t,KT.SUBTRACT,[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD]) ,t}function Xy(e){return RO.create(e)}var Zy,K,Qy,$y,eb,tb,nb,rb,ib,ab,ob,sb,cb,lb,ub,db,fb,pb,mb,hb,gb,_b,vb,yb,bb,xb,Sb,Cb,wb,Tb,Eb,Db,Ob,kb,Ab,jb,Mb,Nb,Pb,Fb,Ib,Lb,Rb,zb,Bb,Vb,Hb,Ub,Wb,Gb,Kb,qb,Jb,Yb,Xb,Zb,Qb,$b,ex,tx,nx,rx,ix,ax,ox,sx,cx,lx,ux,dx,q,fx,px,mx,hx,gx,_x,vx,yx,bx,xx,Sx,Cx,wx,Tx,Ex,Dx,Ox,kx,Ax,jx,Mx,Nx,Px,Fx,Ix,Lx,Rx,zx,Bx,Vx,Hx,Ux,Wx,Gx,Kx,qx,Jx,Yx,Xx,Zx,Qx,$x,eS,tS,nS,rS,iS,aS,oS,sS,cS,lS,uS,J,dS,fS,pS,mS,hS,gS,_S,vS,yS,bS,xS,SS,CS,wS,TS,ES,DS,OS,kS,AS,Y,jS,MS,NS,PS,FS,IS,LS,RS,zS,BS,VS,HS,US,WS,GS,KS,qS,JS,YS,XS,ZS,QS,$S,eC,tC,nC,rC,iC,aC,oC,sC,cC,lC,uC,dC,fC,pC,mC,hC,gC,_C,vC,yC,bC,xC,SC,CC,wC,TC,EC,DC,OC,kC,AC,jC,MC,NC,PC,FC,IC,LC,RC,zC,BC,VC,HC,UC,WC,GC,KC,qC,JC,YC,XC,ZC,QC,$C,ew,tw,nw,rw,iw,aw,ow,sw,cw,lw,uw,dw,fw,pw,mw,hw,gw,_w,vw,yw,bw,xw,Sw,Cw,ww,Tw,Ew,Dw,Ow,kw,Aw,jw,Mw,Nw,Pw,Fw,Iw,Lw,Rw,zw,Bw,Vw,Hw,Uw,Ww,Gw,X,Kw,qw,Jw,Yw,Xw,Zw,Qw,$w,eT,tT,nT,rT,iT,aT,oT,sT,cT,lT,uT,dT,fT,pT,mT,hT,gT,_T,vT,yT,bT,xT,ST,CT,wT,TT,ET,DT,OT,kT,AT,jT,MT,NT,PT,FT,IT,LT,RT,zT,BT,VT,HT,UT,WT,GT,KT,qT,JT,YT,XT,ZT,QT,$T,eE,tE,nE,rE,iE,aE,oE,sE,cE,lE,uE,dE,fE,pE,mE,hE,gE,_E,vE,yE,bE,xE,SE,CE,wE,TE,EE,DE,OE,kE,AE,jE,ME,NE,PE,FE,IE,LE,RE,zE,BE,VE,HE,UE,WE,GE,KE,qE,JE,YE,XE,ZE,QE,$E,eD,tD,nD,rD,iD,aD,oD,sD,cD,lD,uD,dD,fD,pD,mD,hD,gD,_D,vD,yD,bD,xD,SD,CD,wD,TD,ED,DD,OD,kD,AD,jD,MD,ND,PD,FD,ID,LD,RD,zD,BD,VD,HD,UD,WD,GD,KD,qD,JD,YD,XD,ZD,QD,$D,eO,tO,nO,rO,iO,aO,oO,sO,cO,lO,uO,dO,fO,pO,mO,hO,gO,_O,vO,yO,bO,xO,SO,CO,wO,TO,EO,DO,OO,kO,AO,jO,MO,NO,PO,FO,IO,LO,RO,zO,BO,VO,HO,UO,WO,GO,KO,qO,JO,YO,XO,ZO=e((()=>{ var _hh$temp885; bt(),o(),(e=>{e.DefaultRightClickModifierKey=`a`,(e=>{e.Name=`accessibility`})(e.Plugin||={})})(Zy||={}),(e=>{(e=>{e.Event=`Event`,e.State=`State`})(e.LogCodes||={}),(e=>{e.DraggingPiece=`draggingPiece`,e.HideHoverSquare=`hideHoverSquare`,e.MachineState=`machineState`,e.PromotionMove=`promotionMove`,e.SoundPlayed=`soundPlayed`,e.SelectedPiece=`selectedPiece`})(e.State||={}),(e=>{e.AddMove=`AddMove`,e.BlinkHighlight=`BlinkHighlight`,e.ClearMarkings=`ClearMarkings`,e.CreateContinuation=`CreateContinuation`,e.CreateGame=`CreateGame`,e.DeletePosition=`DeletePosition`,e.DrawAgreed=`DrawAgreed`,e.DrawClaimed=`DrawClaimed`,e.GameResigned=`GameResigned`,e.IllegalMove=`IllegalMove`,e.LineCommentUpdated=`LineCommentUpdated`,e.LineUpdated=`LineUpdated`,e.Load=`Load`,e.Mark=`Mark`,e.Move=`Move`,e.MoveBackward=`MoveBackward`,e.MoveForward=`MoveForward`,e.MoveVariation=`MoveVariation`,e.NodeUpdated=`NodeUpdated`,e.NodeLimitsUpdated=`NodeLimitsUpdated`,e.OutOfTime=`OutOfTime`,e.PromoteVariation=`PromoteVariation`,e.Reload=`Reload`,e.ResetGame=`ResetGame`,e.ResetToMainLine=`ResetToMainLine`,e.SelectLineEnd=`SelectLineEnd`,e.SelectNode=`SelectNode`,e.SelectLineStart=`SelectLineStart`,e.SetBoardPosition=`SetBoardPosition`,e.SetPlayingAs=`SetPlayingAs`,e.TurnSet=`TurnSet`,e.Undo=`Undo`,e.Unmark=`Unmark`,e.UpdatePGNHeaders=`UpdatePGNHeaders`})(e.APIEvents||={}),(e=>{e.PromotionAreaClosePointerdown=`PromotionAreaClosePointerdown`,e.PromotionPiecePointerdown=`PromotionPiecePointerdown`})(e.BoardEvents||={}),(e=>{e.Create=`Create`,e.Destroy=`Destroy`,e.ModeChanged=`ModeChanged`,e.RendererSet=`RendererSet`,e.RendererSetFailed=`RendererSetFailed`,e.WebGLAssetsInitialized=`WebGLAssetsInitialized`,e.StylesSetFailed=`StylesSetFailed`})(e.InstanceEvents||={}),(e=>{e.Update=`UpdateOptions`,e.UpdateMode=`UpdateModeOptions`})(e.OptionsEvents||={}),(e=>{e.Play=`PlaySound`})(e.SoundEvents||={}),(e=>{e.Resize=`Resize`})(e.UIEvents||={}),(e=>{e.MousedownLeft=`MousedownLeft`,e.MousedownRight=`MousedownRight`,e.PointerdownLeft=`PointerdownLeft`,e.PointerdownRight=`PointerdownRight`,e.Pointermove=`Pointermove`,e.Pointerup=`Pointerup`,e.Wheel=`Wheel`})(e.UserEvents||={}),(e=>{e.UntrustedUserEvent=`UntrustedUserEvent`})(e.FairPlay||={})})(K||={}),(e=>{(e=>{e.Name=`analysis-overlay`})(e.Plugin||={})})(Qy||={}),(e=>{(e=>{e.Name=`cheatDetection`})(e.Plugin||={}),(e=>{e.CheatDetectionError=`CheatDetectionError`})(e.Events||={})})($y||={}),(e=>{(e=>{e.Milliseconds=`Milliseconds`,e.Deciseconds=`Deciseconds`,e.Seconds=`Seconds`})(e.Units||={})})(eb||={}),(e=>{(e=>{e.Name=`highlights`})(e.Plugin||={})})(tb||={}),nb=`highlight`,(e=>{(e=>{e.Name=`arrowKeys`})(e.Plugin||={}),(e=>{e.Left=`arrowleft`,e.NumLeft=`numpad4`,e.Up=`arrowup`,e.NumUp=`numpad8`,e.Right=`arrowright`,e.NumRight=`numpad6`,e.Down=`arrowdown`,e.NumDown=`numpad5`})(e.Arrow||={})})(rb||={}),(e=>{(e=>{e.Name=`arrows`})(e.Plugin||={})})(ib||={}),ab=`arrow`,(e=>{(e=>{e.Name=`assets`})(e.Plugin||={})})(ob||={}),(e=>{(e=>{e.Name=`blinking-highlight`})(e.Plugin||={})})(sb||={}),(e=>{(e=>{e.Name=`blinking-highlight`})(e.Plugin||={})})(cb||={}),(e=>{(e=>{e.Name=`board-size`})(e.Plugin||={})})(lb||={}),(e=>{e.DefaultKeyToOpenWindow=`e`,(e=>{e.Name=`boardImages`})(e.Plugin||={})})(ub||={}),(e=>{(e=>{e.Name=`bughouse-api`})(e.Plugin||={})})(db||={}),(e=>{(e=>{e.Name=`bughouse-sibling-board`})(e.Plugin||={})})(fb||={}),(e=>{(e=>{e.Name=`clocks`})(e.Plugin||={}),(e=>{e.Blitz=`blitz`,e.Bullet=`bullet`,e.Rapid=`rapid`})(e.TimeControlTypes||={})})(pb||={}),(e=>{(e=>{e.Name=`coordinates`})(e.Plugin||={})})(mb||={}),(e=>{(e=>{e.Name=`custom-items`})(e.Plugin||={}),(e=>{e.Root=`custom-item`})(e.Classes||={})})(hb||={}),gb=`customItem`,(e=>{(e=>{e.Arrows=`arrows`,e.Effects=`effects`,e.Pieces=`pieces`})(e.Targets||={}),(e=>{e.Above=`above`,e.Below=`below`})(e.Positions||={})})(_b||={}),vb=(e=>(e.Image=`Image`,e.Star=`Star`,e.TextBox=`TextBox`,e))(vb||{}),(e=>{(e=>{e.Name=`debug`})(e.Plugin||={})})(yb||={}),(e=>{e.Name=`eco`,(e=>{e.Update=`UpdateECO`})(e.Events||={}),(e=>{(e=>{e.StartingPosition=`A00`})(e.Codes||={}),e.InitialFen=`rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1`})(e.Config||={})})(bb||={}),(e=>{(e=>{e.Name=`effects`})(e.Plugin||={})})(xb||={}),Sb=`effect`,Cb=(e=>(e.Alternative=`Alternative`,e.BestMove=`BestMove`,e.Blunder=`Blunder`,e.Book=`Book`,e.Brilliant=`Brilliant`,e.CheckmateBlack=`CheckmateBlack`,e.CheckmateWhite=`CheckmateWhite`,e.Correct=`Correct`,e.Critical=`Critical`,e.Custom=`Custom`,e.DrawBlack=`DrawBlack`,e.DrawWhite=`DrawWhite`,e.Excellent=`Excellent`,e.FastWin=`FastWin`,e.Forced=`Forced`,e.FreePiece=`FreePiece`,e.Gamechanger=`Gamechanger`,e.Good=`Good`,e.GreatFind=`GreatFind`,e.Inaccuracy=`Inaccuracy`,e.Incorrect=`Incorrect`,e.Mate=`Mate`,e.Miss=`Miss`,e.MissedWin=`MissedWin`,e.Mistake=`Mistake`,e.ResignBlack=`ResignBlack`,e.ResignWhite=`ResignWhite`,e.Sharp=`Sharp`,e.Takeback=`Takeback`,e.Threat=`Threat`,e.TimeoutBlack=`TimeoutBlack`,e.TimeoutWhite=`TimeoutWhite`,e.Undo=`Undo`,e.Winner=`Winner`,e.WinnerWhite=`WinnerWhite`,e.Interesting=`Interesting`,e.Warning=`Warning`,e.Equal=`Equal`,e))(Cb||{}),(e=>{(e=>{e.Name=`fade-setup`})(e.Plugin||={})})(wb||={}),(e=>{(e=>{e.Name=`handPieces`})(e.Plugin||={}),(e=>{e.SetHand=`SetHand`})(e.Events||={})})(Tb||={}),(e=>{(e=>{e.Name=`hml`})(e.Plugin||={})})(Eb||={}),(e=>{(e=>{e.Name=`hover-square`})(e.Plugin||={})})(Db||={}),(e=>{(e=>{e.Name=`move-hints`})(e.Plugin||={})})(Ob||={}),(e=>{(e=>{e.Ready=`Ready`,e.Updated=`Updated`})(e.Events||={}),e.Name=`move-list`})(kb||={}),(e=>{(e=>{e.Name=`performanceMetrics`})(e.Plugin||={})})(Ab||={}),(e=>{(e=>{e.Name=`pieces`})(e.Plugin||={})})(jb||={}),(e=>{(e=>{e.Name=`pregame`})(e.Plugin||={})})(Mb||={}),(e=>{(e=>{e.Premove=`Premove`})(e.Events||={}),(e=>{e.Name=`premoves`})(e.Plugin||={})})(Nb||={}),(e=>{(e=>{e.Name=`reporting`})(e.Plugin||={})})(Pb||={}),(e=>{(e=>{e.Name=`scroll-through-moves`})(e.Plugin||={})})(Fb||={}),(e=>{(e=>{e.Name=`sounds`})(e.Plugin||={}),(e=>{e.GameStart=`game-start`,e.GameEnd=`game-end`,e.Capture=`capture`,e.Castle=`castle`,e.Premove=`premove`,e.MoveSelf=`move-self`,e.MoveCheck=`move-check`,e.MoveOpponent=`move-opponent`,e.Promote=`promote`,e.Notify=`notify`,e.TenSeconds=`tenseconds`,e.Illegal=`illegal`})(e.BoardSounds||={})})(Ib||={}),(e=>{(e=>{e.Updated=`ThreatsUpdated`})(e.Events||={}),(e=>{e.Name=`threats`})(e.Plugin||={})})(Lb||={}),(e=>{(e=>{e.Name=`timeControl`})(e.Plugin||={}),(e=>{e.Blitz=`blitz`,e.Bullet=`bullet`,e.Rapid=`rapid`})(e.Types||={}),(e=>{e.Null=`-`,e.Separator=`+`,e.TimePerMove=`/`,e.Unset=`?`})(e.Header||={})})(Rb||={}),(e=>{(e=>{e.Reset=`Reset`,e.Start=`Start`,e.Stop=`Stop`,e.Tick=`Tick`})(e.Actions||={}),(e=>{e.End=`End`,e.Reset=`Reset`,e.Start=`Start`,e.Stop=`Stop`,e.Tick=`Tick`,e.TimeAdded=`TimeAdded`})(e.Events||={}),(e=>{e.Ended=`Ended`,e.Going=`Going`,e.Initial=`Initial`,e.Stopped=`Stopped`})(e.States||={})})(zb||={}),(e=>{(e=>{e.Name=`validate`})(e.Plugin||={}),(e=>{e.InvalidPosition=`InvalidPosition`})(e.ErrorCodes||={}),e.ErrorMessages={InvalidPosition:`Board position does not match the FEN from JCE`}})(Bb||={}),(e=>{(e=>{e.Ready=`Ready`,e.Updated=`Updated`})(e.Events||={}),(e=>{e.Name=`vml`})(e.Plugin||={})})(Vb||={}),Hb=Object.freeze(Object.defineProperty({__proto__:null,get AnalysisOverlay(){return Qy},get ArrowKeys(){return rb},get Arrows(){return ib},get Assets(){return ob},get BlinkingHighlight(){return sb},get BlinkingSquare(){return cb},get BoardImages(){return ub},get BoardSize(){return lb},get BughouseAPI(){return db},get BughouseSiblingBoard(){return fb},get CheatDetection(){return $y},get Clocks(){return pb},get Coordinates(){return mb},get CustomItems(){return hb},get CustomTimestamps(){return eb},get Debug(){return yb},get ECO(){return bb},get Effects(){return xb},get FadeSetup(){return wb},get HML(){return Eb},get HandPieces(){return Tb},get Highlights(){return tb},get HoverSquare(){return Db},get MoveHints(){return Ob},get MoveListPlugin(){return kb},get PerformanceMetrics(){return Ab},get Pieces(){return jb},get Pregame(){return Mb},get Premoves(){return Nb},get Reporting(){return Pb},get ScrollThroughMoves(){return Fb},get Sounds(){return Ib},get Threats(){return Lb},get TimeControl(){return Rb},get Timer(){return zb},get VML(){return Vb},get Validate(){return Bb}},Symbol.toStringTag,{value:`Module`})),Ub=(e=>(e.Alt=`alt`,e.Ctrl=`ctrl`,e.None=`none`,e.Shift=`shift`,e))(Ub||{}),Wb={wp:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA8UExURUxpcUFBQUNDQ0REREREREVFRUVFRUVFRf////j4+O/v7+Li4tPT08TExK+vr5SUlICAgGtra1VVVUZGRh1ZfCsAAAAIdFJOUwAgPF19qsrhYMPqTAAAA+1JREFUeNrtm9vSqyAMhSv1FAmKrPd/132BWs+2u0g6/7Bu25l+k4QQFvTxSEpKSkpKSkpKSkpKSkpKSkpKSvpVZUoplf0UkspLDCpz9SNhyissVOU/QJVjq+opnT4fKWdbo7XWprVDLkWr7AkA6A3VNQ1q2h4AoIQT6Ez9giIiotYBwFOUqqM1FVHTC3IpAGjrLRVR04nlMasOqYh0B6CSqPvihIqILYBCZhHaQyrS3IuksQTQHFIRcSsRLjWk8IiKNFsAWfzKcs05lgEQe3sE0J1RUcPcA1X8HPIpFjF30bOYA6BTKmI20Vt9AfTnwSLN7GIXVwnYcypi5j52iyiB7i2sMipW9RaWFcE6pWokolUC9hxLS9RWAfTXWNFXYg7gMofx+5YCYK6CFb/LPwB0F8ES2BP9BHHaHUQmCAWgPU0hW4nxtAScPqMyIsP8E4A9ziALzfKP8iCNjacSOvk8MuxyaU8ldk70vki7C8WdoDsyeBCv9I1QLOlB+OP+VPeNntRDLIWjD2h3mqqPFiTMSlUO5tZu4+qcjCfoQ9U19cGWaCQCNoXq2Bnh+AEbQkXHR7KGOXbA/AJ0XNdnhg0zcxszYM8pVCdYvoUZG6+tKgCmrqmuqT4fbYZ2Hw+L6UJjv2+jDc7Z1Rz/GiN8tOKdXe0F1nx3jHWCLQDo96jaiB1C4SJcExX3Mc9kxeKazvBK7eLjeCOqWvzumorN4uOIu888XG6DxXOqmJt1lg8qgX6L5YBy/IbIMFgBVm+weplDz8qK2HDZ+ObDnnGz5hKwajaDl6YNVyt5J+xP1v2qgY41L1hc2eucqNfFBdkcMu1wyWaxGnO44XKxre/V9NzSLpcVfKBRAW5/cGADsXDlANr6gMtKVVeGVbDmszIbJ2SOlAA2DkSz6PSFTAp3rhSbxWCaS6xC1+w9r1kMg5FXo8LhHXqzmJ2jcqnq5HVGM1+NMbkUhmcQNf0Q13Oiqi/O1DGt3fyKatZYbaxTRla+qGp6j+t+h8sbgeaK6pXIDvcn0ofK6WuqF5i3BIvs5lqfjMArrBHMe6iVujWBbkjgG1TTfUt350PU3F9afEI1kpn7OsVzemb6CdR4HXRXZ1WzFfghlX9RfI97U81iRf+j7o45On/10P+jIrLhG34GoKdvoIgaFzyNxTBefUHlyysPHSz7LRVRH9gDyMdgfUVFoZ8oVf7h5JdURGE9gMsHzJ80iSxoDpsAVKSDZrEE+hBUREH9OFw/53y/pVYh24MJQkUhrxefAHQYLBNwjrh8NilT8zng6kBcAfefYm6Rfr8U/z6W6wIpLFZI/XWsKqh+4a+xSUlJSUlJSX9R/wAgFdSXQxyROwAAAABJRU5ErkJggg==`,wn:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABCUExURUxpcUVFRfj4+EZGRkRERENDQ0VFRUVFRUREREFBQdPT0////5OTk+7u7uHh4V1dXU9PT6SkpG5ubre3t8jIyIKCgji/HX0AAAAKdFJOUwC1//+RRfHebR4QloLCAAAF2ElEQVR42u2c3bacIAyFK/6gKIio7/+qFVBHHcWMhBnbZS66zkV75jvZmxACp3/+PPHEE0888cQTTzxRpHl6P6goHiK/GVWaxfH9uIqR6mZcWsFetDfjSjVVWZY340riWPIBi9yLK7LJKsm9uAbDNxbrTlzaWl15O658AOET1n24BsfX5YxluZI8LX6MRUfHj1iWa4iMJnnxUw3bJdbMpYMm6c8MX5Ml1cBVywVZ9gOygs7r8IU1hOiaXs1wNP8BVfVOZYKLrprQsuSLNjMNjSIHWIaMNSNZlnzTV04qC9ZVtQXLv7YG4564oKzPGGssWFR8iaoqT6lMxkaw8AkzCjYQKg3GGKvkNxJGZyoCiSFhnTLFoggtYQWnsglrdMKykNU1ey/uAK62DttgvHZCAg82CZkHdFa9puqalgO4WB+Qq4hfjbL9QK2ObCBcleYK469k6kinVI1b34+5Bg3VgopPvYLkAN8brqwIU0rbBVY/N1cdoH5Zf9EwB1bywhKvno8REJdej0mIotUvklXNVApWvlhXB7DXfDIcP6meqThsGxrqagB7bTRkseyrXqm+A1dVa/skqIZNQz4Kky5jrxR741lqyMmHwSYZadiNh1xJV4+brnxTtD4PsxiZ3hkoarKWhr8SbHZ9irkdQlsaxl0qMsR0mcM9kEow4VIRM126hWcwquHDhVNF7a4ITcIKaCwtlRPLLMYCS0ICTtYh1miuFqdRNdcVQAltRtxYuqdFUDHa9sqnNdNZuazpC4xCqoBU9oPFCRaGilpCKYB1VICwMFSkH+w6bWc+lbvrvFmLmX9t6IFUXaxgWI2vuUxt4MBFONTJxuH4F1bnaa5iKu8QX+kuunZY64WlzZUg1AbIIrS9fePAmi2vm1TqWRsIrLqPJw7lsNYLS1eub9QGoyDV68NhrReWl+en2gClKsy5WwCwWo/mJh9rA6AySDuHNCMdflJsTXgsRWpvo3e/vVh+eDNNRwv3+GaBJS8vxeJoFW52GGFGfdE8PCHn9cGnQoz3q8cOMQnjZmA7foa2vABhqcu7or1fdUrBOzt2n8bI1Dkm4Qus3gdLlYenYz1+mIYj02VA7tZQrLHoZSx5NGmvl1et6aLM1Rykoa6n9Lq3xO7P3C8uWaN0tVO1MA01VnZ9JVZ7P7OlolGUrN6URScDOIGDZT6ne//mpkq9394nsVvClYY+WLoKya0q5vS5s3Hon0EyAtTQw1s2AXEv1slSe/uGeY4nOwLV0GMlTlzxYgzJjYTRbrfoplony6OcmtVoH9rVDVtI+DaUNXfqkhF4sjyxxseSmqwaOhZhRtj53j2xEuSDZHls1RNYMj9NlFLuSGgdyCEjN4Z1xjBgebQs6sVOOs+mzhsJvdrANRndp6J7VeRMQpwpxEiQ5sn2qbClOr3y2VL51QfYiKkW5EMJsUZJLqrzG583CVEc70v1LiGW448HAQCqdwn9Tq+AUySA6l1C7xp/1vZcpPKv8c7e9XwN7koY0FoFqF4dJCuctai7b3eswpDWMuMJck1CU7WSUBVL8osSmk4yiLUSoIS7yUKYMx/7HfD24SBZwTbEBPRQ5ChZbagNMfNKFmKv9XZ+vO4szymzc9tZLkP9Irfr2rYxUdmwX+o/27brvrLzZHo2IVjbVL1aPUY/Dlkr1VeNvhMKVR70OgTS7PDpoViA8lDk9DglJpRS9otDdPTHxItDo86ZEWZQRnA+vgjfBOfaea3Ve/W7B6hb4Qgl+6YTvPw0+OBHtZ0h4pRRPZAQpU+IccSZY1IpVvqHGWUglQkzAWlLlLAXHylSXZCbVBHw+yT9V1f/FOuZYPT6HRqPx1IG0USDImNhr8sIVpSlwqirufs650KgnPgjWDPzSWC0g5CH3h8GwjSpgDyo/jBa/+Niim4ta67C3/HIVOYJeeqNJbGxuD+WvorFxiL+FeK+WAodSz5YD5a95q+wA8XyQeL/xMppmLjb/zbzxBNPPPHEE0/84/EXqrqgdaE+G+kAAAAASUVORK5CYII=`,wb:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABIUExURUxpcUJCQkREREVFRUREREREREVFRUVFRT8/P0RERPj4+EZGRtPT0////6CgoOHh4f39/bKysmRkZFFRUcXFxY+Pj+/v73p6esE377UAAAAKdFJOUwAoZMREiPDfEqnkaJEWAAAFq0lEQVR42u2b2ZajOgxFmzCaGMzM///pRTIhsoF0IBaw+qKHfqjK6ux1JB3LQ/35c8cdd9xxxx13OI3ES66GFITxc4hIPC4E5fnPKeLLgIVPI/zkQlR92TRlW6NgyVWo2i4rUoiyvgZXMGDUzQg1RFMNPxCnY0EHEqpUIZd3AbFyQpUqWV5ALjGkMM1SiiX7gevk6oqGcqdiARbIFZxrpFBZlAqw5NCN4emlpQwsqbHE+ViUqhuo2uflsIYc5rBmn1tbyYBQmjmEgj+54tFNezOH4KanTxGhmUV1gcJ6OURPxGouMkEImB/eYlUXKCyIx/PN1WEXiqtQVUqvPyhWdIEU4gzYp1n2Fiu8CFVbjGv1VcRCqjIbqbRYk2UF4sQmHCbT11wjTbHik2o/1FP8i6rDZSekvSDOopITVWpOpUn0PIXLplJo8MLa0ooz/OqdQRArJwYPa1JVH84V2FQKCz6m3YBT6qE25kXaGTIy0DSEIdEL+MFcSYy7Q1OsluxaobIkbLHrI4cvX3v7mwomeJrDAbvSW/8DB2jQokozusM3cxi8R2nwsmPWIzwM6UhhoVi0D2Gr3Y2/g9z6RxQWlLvMLLHASyO61Z5+2R9T9sIudxSLbllBzub920MGVvDRqqApRLEa0nJQex3Zox1QXpDCWhli4f4+J/ZgbdLSAyZpMfqoJRaUVry2peVPY/BKoSWWXVqSYqGrsu7SwEiVKRYWvFVatUGVKuYZH+q9zUyxMIf0pM23SgvIec9T49FIM+tACxfE5O1auYmV8p6nPl71Xlg5pBXvGa71UrRnlCvG81tTLMwhJEkQdpXaWWz45AoWxBqxSEnPK34a9D2uNpyJpUuLNqJ4DTXmpxquZvTGxTCbHeHajdjOsPRpPcsSFL48a46Vf27E6bT+wVPwfWbncPKHaG3pmfq1Zhm8vKWCH7Esf5CLWC3LnQuOKzOx0pc/+KRdVbpQ80xZ9BdzmC7ZVreIxXK5kSznUPsWueR5LNmWxqJztUsvVXOxNJY5P1QLWMoaFR2WVl18gSXWsRqG4hJjaRULPdaYm7F+BYvjQi+eT1oT1udp641Vua/5+Qxvtr73ae2ZD/wOG7FZEGtaV/6CZS8GDj1ermHRJTFeWhJHteBzPP6wKAR2fqJjBWu2orNjKfw6EsdjFQvf2H2B1UnJ4qcfsPQ2kES5UlrHqjV8aWmEPA5r7MR0Z0jJ04mjb+2k0qXF4Ft6ril2YukcMrg87hwcYLme5n376dH2HHIs1TBH7cUaxeIYbHAM/KkPjbHMqXH9JhbH0Ly8Ld0iFoM/jOPpT2LR3aTTmq9/aUOWHYbel8pfxMpZTriSlUnqWyoOjx8NtdqfQrZzt11ZnKiMmz3X1z397hQat7PujwP3UpVst9bec6N1ESrOx0pim1yUqmS89THfJ26h4n3ZJRYuTv7eg+O5Kd8VGbwWqbptfoWexXyhGH5Z9UYCJf+zT/+bNHYWFf/LXQ+fbW2SCv2d++UuPjhQX1cVeEN9xEMI6Mb1sp9BaaoDXiX5o16dUrJp4NAhH6LV0eO/8IOybJoXFf9jlsR74GvEun5+EfpTccD650hBKOLnzojFg4UtENGqJBWNelXIOHRNFviUA769b3OpVIe3xPPooPLytq/6vqKUvsuWnP5cs2pLqVZI1iNVTdlW438hnDlYoIu8bTYDGQI2vU6l55Cqzrvs5+had1z46q7/BFVY8eGjqnL1VhBsvS9shjT94vymSGek+JjLgb2+n2whzP4Y6brayaCKA/xvQCack31sEu09qVkNFzvGYMP4/mWUDs5Iwp3nR5/GRAeTjti+w/9rODjajZ2XFhbXr6N9tOtU63M4uDbYf5K7Hu1lsX50iMS9P+Aj5+jG2uCnP2J5/yOs3AlWnzuO3gkWR/ybWEnMFH/uuOOOO+644447nMd/5mwuGyzR1rsAAAAASUVORK5CYII=`,wr:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA/UExURUxpcUFBQUNDQ0REREREREVFRUVFRUVFRf////j4+O/v7+Li4tPT08XFxbS0tKCgoI+Pj3p6emNjY1NTU0ZGRi8lq24AAAAIdFJOUwAiRmyXweDwOT8tswAABR1JREFUeNrtm2FzozYQht+VsO/aGZxk2v//C3vTnP3h7my0bz9gbIEhloTkuK02M5nYKPDw7mq1SAKoVq1atWrVqlWrVq1atWrVriZ5ziLnExHkU2BZEdmNvtmTdJ+Ntd3NfLk/PhZLREQAoBt89edwiP7Z/hraNwBAMtK3TURbY8xFmr/d9bY6VVIhAESMWAvImcK8XARU1QJYYm07o7IAOLnLN6RCPayrM3bAwTnmxRL7OvyphBgYD4tjAPU+mb597/gWeA8EC8OyTQsAdOoUwGaL3bfL+anjGCUvH2QHdEcA1lojAF4PncuHJS0A13XsL+9wcZNMYh0AOGQxyNBYtTPWGqB9zxtb/NVd3USBUQ9r3J+vXxiArv8kcM5sg3tXGBMgnRdBCk8PTrMM/aPqQesQiJmwphlOgZcrlmAJ6wXQpIwdrBaMh+Yu/9nO3D+B9nJy592VlFer/zx7IfpHnaQMKeFq+eeknv9Tzowju0Cb68Hlm8iIBR9rWa0pFnI78QDIJJO31hgjmCmwSECMMbadSCnAIevgM720A/C2ePsUvHoNfbWYM7ZuUqYSH3iFoyAcqZUX66YbaRiWJlabTZpa+PVR6+Nx/p7C1WqQZkw5mDtv3aqVVJsXiS1ZS5V9TLzNp4li5Vcrpuky1jOpJSikFg9r1LpiHTI7UTNgmZlqYyUWAZvqxfM1xAT7MEYtbJKnc/qnOuRXS/fARlaJZYF9biw4QLYpWtlhmJNrmXP/eTl4EDx9hZHoeSsZ7rtpgO9d/hmbDsBGjlwKn3NWGherZvD7xp5PkX20sm8A9NRdhehnu2QyWpLsZ7T0EiLWGm/yKfMgat8AQDsVIyIhUakESbEGcVRxI4ppdskpdd8pCmEBzWjuDSAx/AznO/+MT3xwXVxPie7vr713SFJJf/Z7Zpr1HHfvLnJaPLZoJgH80JvHwtsiceiS8gXxk/XRtbxMn7IGBlkoX0kpVp0uPIyNLq/K+KeRjGotO3hWMeIBan1YNFH5SVjtx16ZWRMgsCuNdbcep+bIQ9mxbrn4IKw7o8iU6xFYCMiNE66Uhc8EtRgLzoc4MeDm9TmxbtqUxtqFYenKxGVy54cZroSuaLLnh1svlscKrwi4qoQopdYUq7gTA++dXJMh4rE0ye3FYys0UnRNcJno5oznZ8p1MhaBy4BtSSxBqlqRwWUK5YcbfnkWta4ttTxW0m42lsWK6+xMzxDxaiViydNgjdqWxNqlzSjEF4KmWH7w1YpOXKZcflhTCEb3xGS18H9TK7ra8vN8Uaz0HcvPiMWnwuJDsNo1arWlsGKz6YquaIrmBz4K60FqNekR3y/oyGhLCM+/2W+S97ikGBYAPa9tSthOIKJf8oQyrrCJVMv8HplCk3adRrTtN0YuSLLM4tvBBb9gEIhl7Is/6zEsRy+9QCP9Sme/kO27+7vTfFiXdwuoTqmxKVWMGDus8YeteIZgyWYHAJ3r1rxaJI1tAGB/YhYs2bYATifFWjObDYDD8T5XwK6R7Q7Qn6cML2HROSv4EvA6xn21mlfA/Zx0ttA0RJl2068WeO9WY8kfgP5gwrPe/AApvxng2z3pTYiXj5x29KSYFxEBjyGhE4LlnOR5XxCAiHMZsEwbsesqzBzQmpVYErW/Kci6gCgNwFLmxaJmwcpMFfS88S/FQhksZAj5ArZWrbaMWu16J36GVaz/AFbAA5mVx0sRgmWrEwPz2rbQdY+oVq1atWrVqlXLbP8ALD7swRCgEUgAAAAASUVORK5CYII=`,wq:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABOUExURUxpcUBAQENDQ0REREREREVFRUREREVFRUVFRUVFRf////j4+PHx8ejo6N7e3tPT08nJyby8vK+vr6CgoJGRkYKCgnBwcGBgYFFRUUZGRknouq0AAAAKdFJOUwAVMlVylLzf7PdB/fgsAAAHtUlEQVR42u1c27akKAxt71qAeBf+/0dngZaSQNVRwbN6ZsxL9+qiZJuE7Gyg+s+fxx577LHHHnvssceiACPCWpzlpZSyyNNPM0dpXkgpyzyLfwtUoiZcrcpcwKJsHyHz5Fdil0tgpT1rWsEh2f3RjBdXjX3bdsO8zIqGLK6ah67t+kn/vbgbV6xySnT09SLKmsnGpb051usI1v8Crkj5amKvdU5CiJ41NSOocLfGCK58mt8KS8VnJMachHUq8XdnxApVbY4gzYyQB3eWyhmAilDegzCqEDZgBKkbIWUZ3essDucknKv8igxnDWgE08hvdFcp5YTmJJy3xqQKOEUjaq7Sq7hvGUopWzQn5XrSd0oXUo5ohII1GA4NX97drlCTVnvyuYArhyY3ppZwzKlTJ9r8yR3A+Z3JlUk5u+ZUNSLeYDE4gqkRXPwqrGXODnirflnuvNdbqoC75oRBbF6WO3lzZ26plOf2nKpwvZd/JWXvGNFvYb6pyPewZmlXiL3M54oGcJA18PK+cppLKagVw8GIkHJohwfo+pDd2JcqasGw1JyFSQSCoRBqerqzeVZ9TQtDpPuDBCyLiYIga3fe2tmolbYHSddv3E2pFmKuTVijvLeBWJ0hJ757Q+DeU3eK8x7kTnfWQatD5O5tpJzbd+5MFgnHWwJSzvul3U9CichV6BV5gr6faFnTv+ftrEnTrbrRJYCyjA8++0dQ2a6pytQhAvttqQmHxJi3II+2HjOfXZ3SakkJdF6B3nZPe6YnrqIPNVd/Wnx9dnk86wyht0jBKvkAi9hRVDGst08HXN5T/OzDFL6utrcUtFZSZBQvpqOYu2NIaqND3Auy8ezp+CrV3+z2lp2p/KhiCKshIH2gIOt3WIqjcd3rDTkwoGd/V6hAUuEqHZuwmI5i6ozhqnkixBJApPTymPpI0fuod56Aq2Ozv6FAYeiJJwIxR1+eTerxWBgL3YKCb+rWJQewauPTEelEs4PoAEkXi/oF/W0jjhCmQ3RxJKhU8jFjaqwT8Wfxd0F3SKwpP8MXomvTmwJdZjoT6sTJfCMASyknYsE6JNYyLZwtGTEbtVwjd78vjCEhsInPrWfrlxYHesTcksX12sjlBiwBBuxRzKAjSY1hDRgWg6/8BdaANxl+gMX2LYZS7TOBVzKjX1jPfjch+QFYk0N0mW+UQRmxFrZ4zboWIjZ1q44EgsWPeUsLegsWSHkLFmtWCZFBCYJhZcjNi7OaI7xoaUH67sbNBTWhV16VIo4hoSCfLWfq5XRIQ0YVejRdlWABVgXK2+XR9rQERqiEfqb1mh/lsa6mQX4egZ9tWHSJoiNIEFYGBEq9Ce4DGlKVnplBd01AR9iwSK1ks3L04PggB13ACAV3K1Ab+c1dCJfuufLIWOdodqrfGfsZwVp2zylQtgrVwUZQKT3RgBxoTDVYoJ0IHaylBcYx1A1C/hlVL44rW/19ObXMrNYGrtIBiy2nKIP171szr8+KZmpWnUWt5UdVxvu0aaYGwYgtNRHvLdbpb/DPsHIzN+pldZ9CpfJr0UwtceFywqqFxFVWu+WtMQAqtpZCKatze4RRpnSTWTXrbsUV2dVJ2SgdsdXNerWuI1Gb7K8CWF440stQUPTpjkyhwtitBT0r6NUxKrbut17aTY1wCq+4YjcsKhwxXHJO63DBQU8yHSxXP+79vc8GM1dq6yj2H2BpOdwAIvTYH0ys3F5wuaNFGue/tus3Wsj9o8f+YGGtLbqsH8mIy13ECdZa0+vxweX9wdTOohUXdSFwYl3Kf+c4jrm8E2c1OeqpeseKHLZaosLBjzcz32oEc+ASx2ExtJ5ZgA3x2FUi6XQGFoGo6LbJ67PHm7s8Q6f5BCwxWuquEZ4b4omTaOh4AtZIrcOWwfv0oLTkhJfxd8J7nlxnH2rnNau340fPw8XI1dtdNbqdAFW+hxoWMXqHMMhxWeJs+jxCGCDh3cR40d5HniLIcVnqbq+uJpYfHX4nRo8QetLhd2K8HsJg58OxWztcC6E3Hf5AjBdRNSLY+bCbGC8lFrgFEOLaVhhUQS9y+RIj21B1Ie/aeBLjllhh6DAQMRqomrC3R3yI0UAViA6DEGNtwBKBb49cJ0YTVR/8nsZVYjRRBaNDX2KkANUN16UuEaOZ7UHp0H2P4BqqRtxwXeo8MTKIKigdXiZGmFah6fAqMWJXBaZD17WsK64KTYcXiNEFKjQdniZGJ6jwdHiKGClzgwpPh67bdSsE3jRt23W9skHZOOo/hr7vu65tmhvpEBEj4203jNMs5BET8zyNQ981N94ejgrpY/kd6zBK8y8uMU18dOTpm5M/H5iZv1ZbAtM2vGZU/erHNqpyv2m7XsXb+GaVhgS23X6cp4HT11mjfJjE+ZuTR3hHyrmvXz5W9+4f6HmhmpqXvy23MrNg5UrfrAxgyw/0QsQxrtT1A/z410HSViPBN9tAt9Tz9U7mC/947LQtz+iChFEJ/dEbkYktSIeTBj0veB98JgFiOJGwNgeIYhVgh9K+GuHb1MeBtr+tOwj+LWkdGBb3b1TTUwfTx4+vE29YIjQs+nfCIv6KMQt1EPUvgCUeWA+s5XZ0H9qCpPwt9t+ElRb32K/8by2PPfbYY4899tj/y/4BGYsA2gPdkaEAAAAASUVORK5CYII=`,wk:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABIUExURUxpcUFBQUNDQ0REREREREREREVFRUVFRUVFRf////39/fj4+PHx8eTk5NTU1MnJyb6+vq+vr56enoaGhnNzc2JiYlJSUkZGRt7Q2EcAAAAJdFJOUwAaSmmEosHg8fYyyCoAAAXsSURBVHja7ZvXuqM6DIXpkLjhut7/Tc+FYSeAIQacMudDlxPKvyUhL8meLLvssssuu+yyf8+KheW/gNVhbtWF9Q9iKfow90NYt/to5KewyJ9dWBdWstq+xKq/V+8n1WqG9cUKdmEdru3kgXX/br2f1vb7A+thX8Mim3ZhXVgX1oX1c1j3n8TS/WjsCUb8/av79lLdP2GZ31EQz95SP4NlnzNKfBUrH60F9DMWBVCNP35N0+cA5OQDtED9sbcXZVXVdV1XVTlpHAoAfIKlgXZyZ1FWtb81bctR1O1s+NHWVeF/qwA3LVcSQD4QVc18cNKMN55mWo5kxjfkWdYAZorFARRZllfNyn1tddppxePZzhpjjHXTNwBQy+peVxP/OmuMsY9bu3NgeT08VktGbjcv2ikTUtunl4oZ1nNBNUqKR1VjQg0/duVxqtKHT4v77Xa7T1dAKtSIRmdY6g+J0+VKSaW/rznqMO8qRZdM4x8vDRapNRRUI9nqGi4MAHSHcj9vAECz2+22oRSYcmrhDzjFtsVF7wCgPEolb9tUhBC6JJCUvDJmjnE1ABx/CXXcFHwh2Z1Xlr2RypfdnVwlAPdeKu+vds/3mHdDBMk7jWrsW9UbAP2bfUUI4XZXGAsA+v1UhPWYqo2XznL0/VSEcr2jShQA1LsTy0dRuHh3NYAjH3AWIYyr6OzKvbM+QEUoFy72YywBsE9hcQ10sTG0H8ksQgjnMjaKL2LIeyl7TmOzR0jZC7aeXDwyigUAvuYsod2fxmMvmR5X25WrGecGaCJTi4SdxfSkVdB8eym2EzkvV7AUgDjtYMMxZHbew+gNBbq8OIz16N9eZbwOYlELAHWR+wbQ+0CsfGJez3d1mWdZlpdeUwY/xT4u51tABVNLTfuCoSuS69qzLaepARbC4nHrT7eCRd1cHXldHfKXWU5rikBD6bHipnMdIEMxFAFnV7OR2xNWWwTKYSi3IrGwgiUDX0y+jlWHvnAawrKnsFRgrd+DVYSSKx6r+zRWXBBbQK0FMT+BtZw4EUJ49JfYACaExQKj0B1YeRcYC1AeXbcqwAWLvFm6awdWHbqUcb/45LFyi4QrRHMUq0CoPnAeLbhyADIoIJZtXTRW3i1GrEMMuY1TEFkLmCAWtfP0isXK22CNZ0NqRfU+FQAWFDbczZ4RiZU3QQFBhxgij20xdFicitn0JxKrAWBpMLOEi4yhfwqLmrLEYTUALAuGkOv4dr9Y0WxLriisGoALa5pd7WvWrOiVUXX9TT1jsGoAjoepuNkzG8nDufAoE10ejVVtUUlEZ9b4rLUwPnO9xirDStFTCRf7GT5qV/B9f1xep77EKraouN2741iEXT881Iy+f4VVIHjBQKX3hfAxPF3jsgDqoiw3RHNTlWXZBXuQgUo9Jem+UfNa2jMX3j4P7PqoNSp5ZADuq4RZ4+IuEstsUh3Zxmi3uMSwIWdNKAPVuEu39PdA1bujG+zbXIy9HNrQwDXPVAd3tPNuq3wdnbOdpcqyIjXXM1WTZT/ClYgqMVcyqqRcCakSciWlGrhUKiqRiCoR10hlU1ENOkCmoOL2zEmDIJdIQGX27reekDnxVDotlVfR5iyVPCKwXsscdY5KuEMC67Wc4DOBwIXopZRKKaWUVlpppZRSUsq+F4J7/TBScfOOs4LjJIiJXik9Oy+1as4ao5WUYnfztSe9rMVBc3Zv8xUZxWrjlRNzq45si9RQ9fPjrdFKyV5wxii5BexOKWNc9FJpbZ4p2zJ1AD2QFIzedtqd8v5vZzGhx/xumJHsdsLuXHm0MiWV4bfTdvw02Uoj68SWH+a2AaaRqKYW45mpKQQhEScS7mQBKncdq9kOIR94zmibkU4nCaM/cHNPdVjD/1fiNkVmOZq0hZUpsqtL3VgH97R2l/etseBBM+fX7GJ9Rn/mqOLZ5CoBvONk5/nV0KbGEuclTn1Cw6+eafpdrOL3sFgSLP2DWM0bsOiF9XEsq1JbEqy32P8Tq27fY6kb2csuu+yyyy677LLsP+d98B4+O0hIAAAAAElFTkSuQmCC`,bp:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAwUExURUxpcSQkJCUlJSUlJSUlJSUlJSUlJSUlJSwsK3d0dGZjYlZTUk1KSUVCQjo5OSYmJrRYvAoAAAAJdFJOUwAfN1Z6o8Tg+2/nYHEAAAPpSURBVHja7ZlNTxNRFIZb2gpL4kKX4EbdlcSYuMMYEt3Vf4D+growcVklboDEWU/5BdA/AJxWtioUtiXktluRxApoGejHa+5MP+ZOKb09lxij8+7K4sk5Z87HO0MkEipUqFChQoUKFeqf1s0Hd66J9DADoPbkGkjRp/D02pz1DB29N0XdA5yDtVzhK4CXZqiYhdaGnSOiggVnxoiVgrPqoogKwKkJKg7s2yvkaR0wCWwWdTtLHVVxYtAPFjbaGUrt4mySzbqhhCXL/9wgxcNutYgoXzJIMg3bJp/KqLGbCw1/ikRFC9NMVgLnvspLVgWPmawJ7CspUqGEV0xWEqtZlVXGMXuA/E9RsgR7jOZbarkk6ye3JZp9LOsXk5VpqKWXrBqblf0rWemm+hipyK/XfCvAEvznmEKuj3XK7nsVlRf8vp/AUaBc/HlMoB5IscJerDG01I4Q/P0VyWBbSdFgr0Zm/QUrCGGy72+g6XuIMkX+HYpaOOhlKMom9zEy2w2sKIQwutvST7gVy0tUycxPjFlwJGpHyjJKMZICvnWr/8nIGt4FlnurIl81sIZxQNn4woLDvLVjGWkK/Y1fBmqT3GLtK36iIB8lq2S3gSVbObYF2WKsks2iYdvKgfTG6ITF+rK5uUYBVpnFSioLp50jc0tP9eZaYf1gsMYD296bb97GT6ARPEPuruB065i67b2whAVWs6a9Vz3RVtn7yTMBSZUlvJ/vmOfxMhZvuKNzc3NzGafHqsk/GKzDTKvYYbH9Ukdo5busMzPUGJrUCayKSSNWHHXKd1lm79vjWKZOYBWDq+312BF1AivhreF3gO3O9Iiy2XeAiOV0p1o2mGnpu2Mtqnwn55Z+qbduRAUvjMq16ds3JZOCRS0n69uDwvD7RNa/CKsGHZbC/op/QZfYrzCRGJze3S56K4w7Rvdx4bvbXpILbFO4YQevozPNDKvh/wST987QAq9afZaJ7X9TMqwV9d1KBsZ4lLeAz6plcrMsMQxY3ELdtu1+c1Id+XNmNC29qp3tdyeje9ZHsvCBFNuwEkZ7lnHXqwZTlNpxPevMSM+waV8WlvdqZI2ye2LAhh1oCB9td5TAku4zzNIgVUdwOxk3rNxA1kf9KxJ3qzUYJQPTtU5TWLwqQyLa0k5yHquXtYN/AHSnMipTzF3JIsvRLdfF1RkS0Z5mwcZxOCwsWtc8u0llNQ/qimPNARrU8b7e1xyjtDM0RSJNI2w1skNRVD3Ta4n6ynBWRcsIx3AxPEXa0/JicZyTDmtGi7WowdrSatZE2wteD2tZg7Wuyfrwfbj0bF0CevrjrDd64v6nKFSoUP+zfgN+r0dDyFRp3AAAAABJRU5ErkJggg==`,bn:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAwUExURUxpcSUlJSUlJSUlJSUlJSUlJSUlJSUlJSwsLHd0dGZjYlZTUk5LSkVCQjo5OCYmJvq3tckAAAAJdFJOUwASKUhtlMDg/auJd7sAAAV0SURBVHja7ZlNTxtHGMeNwUmOSEmbK6e2N9Nbb6GKWvXmREFqb05U9UzSF/XoSk0qIhL2vHb7AWz6AYpnnV6LjMXVyMz6CiFh1QL2FrD/1azNendnvDNjVlUOfs7Wz8/b/OeZZ1OpqU1talN7V+zm3cRQHwBLCaFmDeAkIdZHQGKOreD1TkKOpdE3f0vIsQz+NUvtZBy7hgOzVEvGsRvYMoskGceyKJtFkoxjOZhmkSTjWN71WDVg+eMromYKPY9F2gB+WV64CmsO5wNWjbU/ug+ulPrnAxZpejA8W5y46wvYNM0SYxHL3vdc+3RC1ofomaa5QQZmNRjNvT+Z3hRwYJom8a1hG5PCPkE/4JbnGt0HukuTFJG5VSQkCuvo98YdL1skbNsM9lS7iAa2whEOckYd4JEm6/pln3IwA90F3WO9K3CLpcwGftY8iq7QLUJqtKmpQd5RLIlYhFJDT4OusaM4cKPOOWbrOZb11JkQy0CPd8zBsY4KYhAiU66WyDENxSj0vSpaTBzOuVJSB9+qn2uWekLIK8a64HusiY7WJcvStSNk1Vgp76l3/a6XLoex1gRt0VTP/h1seiyDyV9dcJBsdOc1yshS7x7tr7dEvU8d1SBnjJ7HqrWEnc8qqRzkHM446YokzFat5HU8Fx/sUcKoo9iuOWxKWW08VhacUhyrxoI8VuvUc4EO1uqh5FO1hGUvBSccV4SllrCCN8JxtauHCknbKh2WQU8QokVbYVYTf6scIFFHNEKsBkv+iUIVURZUkUZZ1OgoSP2FIPMWz3IwL2/UA0GINRrK/YC1JL383bLgkqVhVs1L/kNpiOditwSsx1Lp2hVkvv2S0ijbxj+yW8MVZR59nkVlTXEbZ4IQ/4IrYBmnstfnlqDnDeDtHs/qSBS1L3QLeNniWA4kD+wzPvOWgR/Qa0XEkLEW4kPcNAVudW+iX+dY7VjVmUNP6NaTGTFrSXJp+Jmnw2y30ZmfQZ8IWPdiFXWzGDjNe8PEP0rNRsYwhqLNWFYOoxBZqfa8UeeU6eOFiPUw/iEbDmPPBtxFFvxaRIHkrH4peDfvr7Lh5L7ncItn2bGHO+9uBAZ5w3uAfu0NGC4nGzKhyKE+Ynko98FAiHoCVrxfWRz6P28CnW+WF4dCtMa3BLXxU6wQ+v/fcHAy799ykYGOKrBmRxM4Dczd+UhHWFQhxlT+8qxYzZHSvQ/UBemSiXQGQ1jD8ZsnXYiO0g2q0F+p1BeA+8YL0V3wH97R8ZdShTOUSqXzANb3AiHOAS+IKF3y6ST91WBH4vufj0iEny6J5njzxOeD7c28n/hDIkyX0gR260v4D/SZAvfouwxRZaBgm+PP7vqLGLc+JkRqdHX3Qy/ImBBVhqbwfsgl40Kkes/udIF/pfkh2lov5dRt3q1RiLbKwDpqjxXerVGI8vkrfDpdMjZEtaE8ILMvRAOiRqsG1uSojw9RsVV5lRWEqNdeOe4kBqpIKU41qmi4JCZErfbKCEIMsJqxNwd3wa3FhajVXnnU41htjcWVKF2B7pJNmJG7MjZdWuqVGS6rrO0GpUcjeztBS9zAoUWPVg1w5q6uH+m1RBariLFVjZa4VQh5MrQg7anqcXxvENs6rVcrZTNgxQrZHk55z9Rg7GMh3lTNcVbcYGu27xT7FIdlM9Z+N9TWrBngtSmzkqPUFjm20ZHarypr1rSB8jDRlUr0NVmtVi6r8SeeKAjquVewOKtWTLOkEGQWu8UNIrVq2XEV1h1EzXbklVxxFVl/yK9IbhIcZ6+k6460QLnG7A2lI8Usv84eY5ZsdcI+diizjqWsNUUWkbIyGqyTKesdZq0fKZoCS93+T9bcj+r2fWpqU5va1HTsP1MAb+04YA6IAAAAAElFTkSuQmCC`,bb:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAqUExURUxpcSUlJSUlJSUlJSUlJSUlJSUlJSwsLHd0dGdkZFZTUkVCQjw6OiYmJk6AIV8AAAAIdFJOUwAWNFWCq977e1jxYQAABNNJREFUeNrtmb9v20YUx/XDUlZrSScBGVJkMpCtk4AiuwAXBdqJQIMk3Qg07eAkCHfSyB9ACegc+9hdgk+aGyTSEDsSK4nf/6W4H6QpmSLveETRAHqbnfiD977v3feeTrXaIQ5xiK8qOpWRHtpY/lgN6luweFYF6ggifqiAZQEfyQRYHleR1tgj5C/gqTHrBCuXEEJGWBizbPjnjEUdPDBENbHhaZFgjlNDVguveFqEjvDZkHUP46HIa4IbY+l9IvKi+GLMGiQs00b2MCSxXgvjvKRcdI4/DFldkFh6PDZktfFRsEbGbawdYS3kMh/VWgMhZ02q8AmLF1lFiWwoompOIzvbeO0xlwjNS+wjcj0m15eaeRsxdrlcLytQfu2ec7m+Z009NXIvXHgkkau9MEpr5Q5JIlffoJktwPfEdDFPrTsGVtGXadEpT6gFlE6sCfiuPIwPuGeUT6yHFWsiCaizFOpR8H6WONYOLlzhg1z6OkIyLTmz97FmI08IneCaz+2GBCUd0cKYK8+s/hdui28ImeL3UscncmWJU65SD1eEBKV8rIfXosRAttHi1l/GfOo2fFmibKPDjIy8L6F+C2tRYnzLNrDhPzr66vfwIS6Rcn+Ob5Gp9lJXd+DzQSUBnfDTyNtI2Ia4MChRjESXtbFUkSdxiZx1yosWKP0i7bhEQuV49WOWbifZaikmIqByvOxQsgLNzbWNV1IuzjpOxqvEXdnDhZQrkKMajxd32WstuUJXysVYC171WrKI3obYZBMxlNIL9zpKsbQEazG5blk3/FdvEtZUR7AuxlJ6QqUTxkud8LOXOheQL6XnrM980U9Yequ+HcXSc9Zv6SPE/V9d/Mat9MlxPEmzxMQp2vM/W6yt4yhYj9Wn/kMsfTZLo5HdZOozjjZjjbiEiifIv8sKU6yJ+inqI2kjL4iJY6VZVH0orCiRfh9L2cLsTZolb8cozXKUByzx+hTL3mYtVe+gXdbxHdY8VB77VdJGvshlsFCW1el0OrusY3XWeZrFoxyrucUKjFgNuT7LkKxNFSwq4ir9Cy0WyQmq0ce6AivUmPsClvLc15y1l4MKqM55tDfVsazIyy9Rw3P6KGTdqHv0MJ+l4dFdFMilcXe0b+/VfSzlOy2102TLNVX/GNlMHeSstKRtKx6iKJ+lPvZbF1hWiVpPmr294vO0JjrL7ze3i1tWWmKLUv80lJMWneu8BjT2iS8sVu8xzEJOWpqPYSfZglEpl9ZjWCtzWkVaenKxj7Xh3rQoljWt6GcUGcQlaj6Ptu8WKVH6L8ANZ3f0Y1SJF+Deru/QJK1rTVSthTATNSnzBGaxxFhhMxZns7ez2ewTS0v/DabxHeAgK55pfuf08CfkxIsnGjn9nP7L8IzHVpLPVXNr2vz/v/17djXw3VR4AzqbnfF/XKjB6haAT5dblC3icMRgSkP2CNjsBYk4n6t9Hdlw2EeFgvCmStN/H5HvFsMcFc9nT6FC6MFgd0W5vBwMBgL2TmFmG+wp1BvkLTrkkrVXwfRbWHm5IInz/yw+l/uvxp14XyxYL29f2vKz4u9c+yCKUWzVOWvJLquwkXakyirey9VZ80KWs1FmFV6TqI5V12CF/0/W9OtlRTPFcIpZ6vGfsn7ViNohDnGIQ2jGv7ULQsgUpwsIAAAAAElFTkSuQmCC`,br:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAwUExURUxpcSUlJSUlJSYmJiUlJSYmJiUlJYiGhXh1dW1ramBeXVZTUk1LSkVCQjk3NyYmJt1oLkIAAAAHdFJOUwApUXmew+Gm1HRSAAAEcklEQVR42u2ZvW8cRRjGf7N2QBcRMnM+UlDAnnEoaEj8DxBb9EhBQqJBUESpIKHmP0AIXUOBUuAaKYEORQqJKwoULIsCiRDsoySxbkdHsKXEvpdid897vv2YWR+EYt/uZnefeZ73az4OGmusscYaa6yxo6YcXukaiAb2+JMtvSOxXVo9NtYVSW23rsb2otH73wACEJn03RcuSLS1nf/NfO5o8OZN4NEpUBxc37JLoTKLWlt47Wvg0q1+7ld5gwsf3kx5KPY3bCdEBvHnGuDaL+ddsTo7PSBKngnBOQCLBkLZttDaWHHTOPcQDq63WQq1RQGLyQMNqvfkS169qLl9ftOFl4IHn/ycEFFYFWawGBG8tGUTsZVYwuPPCcESgsIupMMaAoRlGFiso+9HECYfK2xKK/7Zn9OAdfS9JCEU1qDFcKymByfZ7Mb6XHmpBCsAGGamIGQYFuZ9Aa8AEBTosZOTn8NErjsvAGyQxQIFoYTFdZfLSyUAJ7MEBAVrkkJb13qMsaxetlnvBIvl3S4P6+pnCRY/JS6PmejfD4O851iPVhXKGEMLzr7XRe/b2AHaVWPK6+DWxPDdPH6VGit6sfbTWMtq8FJevs937b/ES82Kl/bjFVbqceW1W46lQfG+I9aoFCtOmL4z1lwFlnbGkqsnSkIZAnrPusZxkwulSaTYd95P/MBCocIQMLznXHpqxE5miVcaJBHV1qC6GOtcxq9vcr8PqK7SJh2MxA6CGOqv591bQnCAbCljpp9EYKDb9yjTM1JmH/jtMd9YTwtK0j3mmOWjU5578re+RaIosihzWMwGA38/57GmJQV+N46VDKLuobciFsWnTxzdMci2rd0Lp7qKTBw6VA1eWRtMr3i1sdh24FX4QEa3JydNe1pbK09eKmcPW9Xwi7GOhr4/ThZ9nDgeJXZcjZllUx8fK6qPZQtEyyx4jdF9sVo5uwp7eP7wwtIlkVXeOWGd9hB1ecXw4s0r98Bj62nUNe4hAp8NlszQX1LeDP002loaeyV6Wn5YqjTntCeWlCTxTLCkDq+ZnTuK/SX1/GVLFgI9C17U4dUq4GXLmmHgX9qFrAP3Vlh5HAw82lf2AuUpaZwplpQl6wx5WT+sXmk7bj2t2i5sX6XFHdQoR+uJJTWKe748kbRBnU4ucCyRWN87PlDYttFqcvp2sjuUoRcvRadTMLmBts/dUefKxNEzGg0iibIjuyuuETt7L1Yz2I4mPKS0Me1ufCR9+4YTVuchcH9ju4h1+5VVYPWOA5b6qMdvN8qdcPYiey9OxXT65ubM9/z4XYVDB78un7i3WZ2r7/LgziRzpYw5Erqdr/iiWuP8E/k0drTSmbP/+OghNg7HZb2yXoX1cv/PNUzeNUcGMop45uPh6apcPcd6u1vhLmMY/DHt6imsUBYWHNK5beyzVb5XPXGrDWVbugIrcDhzpufcsIqXR0/WlViu/6WKA9bseM1yHWp5aOz993vfBst5fXQqbUcs87/UuHfZ/dvHNNZYY4352T/ZP4i5JEtsbQAAAABJRU5ErkJggg==`,bq:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAzUExURUxpcSYmJiUlJSUlJSUlJSUlJSUlJSUlJS4uLXd0dGZjY1ZTUk5MS0VCQjw6OiYmJh8fH+/JGhMAAAAJdFJOUwAWOFp1lLzg/a0PANwAAAbDSURBVHja7ZvrlqsqDIC3ipqRW9//ac8CvJAQW6ph1l77mPk3pfCZxFyA/vnzyCOPPPLII4888kgnMEJW+nEC7/08DWcrd2qavfcwqf63oIaw4CowcmDdeIzw06+AdZNHAkMxRAEeMra3Zp9U5YzWxqXlRzIkqQqyEXNrri5S6Z+fn0VrrY1/FVxRm27ZRrjXL3AFKrdBBYHXy/vcjmrj3kbYgD41pRopVdIGHMroA9WCRkQu1dKEwWcQlTY2cI3IhIhKa2tfr5y8ibLImsZGZXSZsmxmwYTl2qprTibUGCtfNICTEdpG8rldcEjOvBAs6w+XnqOyFooFmULlwzuvirAoHM6nyYgAHhTaLNir6PCFsuKi3a7PpVRWdHrV0OOBUVaBVY5oj7WUa77DMu2xQgCn0SH6lt+wgm8tzIiANbR0eUZZAWt7/cF7s5Qj3OvVzuWDLgyniiPMT95DSZW9qy0kZBbGhtnbHxRqC+6grLFhXRoyNefwMyoxDFWWbxm21kWpMjyqbMJrAURZofhpWtnEssWi+E2rqWmtTHMjty0gtiJvXTUuG6pAVHvG+hWyFOBpodiiFVwLdXuehPvdAU2IHa8TqmvqWxu9shUcYtfg8qpmKBS6GzHW1HNfOfdHqKzRA8V85vZXrXj3j9BlkjJJP9aN8KHNPA0EuNGjT3u4fVoY+XN3QKdPZ7ajO5v7k1+jRm84wdKlFVUWuJjw/mnuD1R7oxcTMfpul2GZaMWJteGK5WlAzppIqOfqSaMXuXI7ESz8LvZ5Iki6pHObrMJ14R99bSRfsm8a6zyKmD3OL66I8uTDDs+dt7bahLnnShMaVLGngmrgsQzqMOLCQJrI7s3cmsz9TllAvklWRlgaW7EnSRP3FuXcoeeu2Qoom66U+bKHHhCWKfpEc4bFN3TgK5o1VTRdMbP5rC0ecNVF+0TQZ1iKaegMkyf4NsLRXj1hjfns+HlRi2Hx9kO25lTMnSKM/1wjTrEtLrAgcwCCpTMrjvQjimUZLF+LVfYu77Ci186MDVks3NsW79M5lmMaPcieaCRrm72apzZMWOp07n0LY6zwLWCwcpenWMfi1IbaIKxi7uQhNbtMQznzGiD6U6zdioA6kO2T8XRubWu3TTpfmCgpa2aTcRaqe9KNlVjU9fYWpSL7jKV/xFUVcj9d2mosbUixRtqgrMqq6CG7rIc4KvK8jyixdFRnB/wHE+o+XLkNUNUWjSdcU5dtVZLVYyFQ6JlgZT0R6rcr93Kmo7XBXOdYOljRFzZMXjeVVLmuajvbdFIBlua97fuMrdY6k8Hdd3PiWRHut1MLOdV2GdtpE1CukZby2Ip4P2fHnWm3vYar1+srqr1JzVePoStxcVjRiWjcWLGgoDJpC+BVdnsfG0Ugy+xcHYsVrej4f2/PiXZywt7FfOFIbyRGSVzqBCs2C0azxuWo3NXd1I4+fvIf1bPra8PZMNF2mMqsyrq4izMV6THZkcfSwNgwYWEqfXN/sC9TnFtbdA7Lsv/dvkE26+DG/uBc2GXj4gA0Z8P0huJ3et0Qv7w/qEqANWzqarGUymw2vLwTx+XexPUllrtWzNTGiJ2rHsuQ99neig7MPkf2yn2H5crO4Obx4sRpxgDUY2n8XPa2w5eHEsf7+AWW06yy7p0ezHzsvijGCjj8mdNfFyvh8GxilFHW7UON6atwUEMlclzW82XMdRMKOLyo01srEx1OE+MdE9btsl1LjHeUJXWvRSZGWCsWHd4lxosmFLxtM913+p3Kyp0PD/djhLWi0WHv7kGGSvQi112nP6hEr73dTIwGKUvwjP9WYsyorOztkTtOn1OB8O2R64kxp7LSt0cuJ0ZE5cTvaVx0ekTV4JrntRiBqRpcl7qUGDFVk8unFxIjobItrkt9HyMIlHh0uJQYqapa3Wv+zulLqka3wL+JESWUdDq8kBg5KOl0+LXT81CNHL4yMZoTqDbRgU+MxqwUbhMAF/5WaZoOqdOH+4AOgPzw6VQAImbDXz10s78jTX6C1KnpnUZyOR03SZsxv/0YMJwNTrYs4frZiSzx3ryxLucEJamy/WYlOPsO5RRxu57o/TyI5p1wSHkBCLElNCVJ5e4xrWTgvRcK9vtP6CTEfHPT9FNd6hfizFE+paFFrwPzL2tyW/RWht5xrvfWG58WMWOXfpF4BwjD/TgJdSm5DfDszGwQsCHIYmkQsKLkKcZxfD0LvIdWGMv62/3iIHoUdThXfx9L67/O51UDLP3PYo3y8SFiqQfrwfprsbyTFhmsFvJvYqm5jTT7kfUjjzzyyCOPPPL/lf8AtuykcwsccVwAAAAASUVORK5CYII=`,bk:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAzUExURUxpcSIiIiUlJSUlJSUlJSUlJSUlJSUlJSUlJYWDgnd0dGNgYFZTUk5MS0NAQDIxMSYmJtBHgnAAAAAJdFJOUwARMVJ8nr7f8e5A/hcAAAUDSURBVHja7ZrrmqMgDIYrB3WLHO7/avcBPCJgwNh29+GbX9Pq+E4SYxLzejU1NTU1Nf17oieRX8AaTSjWsP5BrOnPqvdPYb0XTT+FJaZFDathoeX2Mxb/Xr4/ZKsA64sZrGHV5/YNS2yffQ3rvSX3RdtH769hba6LqWE1rIbVsH4O6z39IpZaJXcwcv30649qtcPSP1RB7KR+Bkv/Dla3aAiwXKQvX36tpu+C0HLBxT92dUIZd2KMkp0VqDFGhlhDcOZy6uHM20iUD8HwY+gZ9VfgQcT74OrmE1kfDk56htMNEX4eyeyu0IehNUljDH29COsT5w3sts3o9re11kpprY9XOIWW7xTZ0b7aaf115LfAOj7/VTUJV54LIYRN5Ac4GWDtv9NKye17KdX85XgjdVDvPjUjBb5armDCZ6FakWTsUTmf19cazJtKxpj2ZPr0cYbJH+DARlrlQBdVKg01k51CywZXhmlnUFpLNeWhPNn5otOlvMHKA8xSaXHoTHGlauxl40oDTHWXqyy30uepPNdQcj92NjOIh6l8fPHCwJqeppozGC1yoXqeymaXY7WRl32ePXgPVpqLzrl9eh6rxFy9N5Z4HksWmKv7mLFsTwm+GZlPDh8wlvWiNmbsgD7UnzGWxVJQL3ofiozh1VWBMO0Lv0MhWO1FkvOh1CZf4xUeLZ0XB2BoJXwo9bFAl9dJKT6nCLBMB6oddNxYAVUe7HywSkQErI7o3YMnhuUuxG1/2K3dlsyWnyN378jmo1USi4KePDLqQ3t+T3b9Y8Y3OuwHafx/kOAx2JjCOlVHpE/Zy1fE3enxfw9rimHJiLFZwlz27iKRdHgDyySw7OnX45r00IZFOsoFi9/CGu5g0ZjDLRZs8DR+GgvmxNSdGMsvJVg85kT4QNrnrXjI83os27XoFBaFZvnEXU+qsXjsUKnAWZ66R/UUN1fQ1sGxqEkZyxZcwOI0/trk3NaBscgYTbyzsXpg36PidY0OoxOKZafkiRwPfgXjiub4PCucsgCx3PQnnuKhdY2vA2W8ZpbBlAWGlaBajQXy4dyQgaY/MKw+XpmtxgL2r8TNSyFcICyermmK2lc/GcnUdyMpwMpSFc1GSDwWzlwALJajKoisZErep4mZ6xrrkqpkHpjIMzsun+4vsahJJyzvwqKpLsm1D47LTfuvsMglVf8qErvmopTlimbG3NpgnmosfZXBc2EvL9o/nftaqqrA2idBAFceS2epal5jDFdpwr+Qk9E+X0Ooqt6SkSyXBAxtpMxSVb7RdkWSxh7/3aV6gGtP1b9eP8KFRIXMhUaFyoVIhch1oLq/pUHG3GP7W1Tz+32FRKWxqJLVyZepkhPGOqoBb/uH3eN6iOqizIFSHboTHPU3wkvdK2UuyxwZFgjbMqfS88+68ymX+kGpysq9pElzKMG6VEZuQaqm+SoJezBNhA8/sJwX2YVJVqWPGyi2C7k574oJId5p+QW0YANtQA0uNq4dQxYlibgtyQ5ojvQ7U0ZP71sS87s8ipizlk28e/KdGkXL8AYDyqqyaU3sTIkgmIVfqcxqOez4H01FazX5hRux3Vu1Wvlwtvv9wo1AWtawaBrDXDwzsKwsKDCia8RurB0WQ3hCK1wsmyV6jNDCX1UcEOqGJzYo70e8xsZCiPmGVfiYfgSLNiyoGtbnsRSyNArWI/o/sfjwjLAb2aampqampqam1195W8+wSJhrTQAAAABJRU5ErkJggg==`},Gb={board:`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABLAAAASwAQMAAADR7yGMAAAABlBMVEV2llbu7tLDYEXtAAADBUlEQVR4Ae3cQQ2FABBDwU0QgCSsIwkBJPsF9Pq5NPMENKOgs9E70bnRPdEfp7CwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsDIsLCwsLCwsLCwsLCwsLCwsLCwsLKwMCwsLCwsLCwsLCwsLCwsLCwsLCwsry46NnomujT6dwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCyrCwsLCwsLCwsLCwsLCwsLCwsLCwsCIsLCwsLCwsLCwsLCwsLCwsLCwsLKymn2YsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLKyqn2YsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCw/zVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYRSwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLKymn2YsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLKymn2YsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLKymn2YsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLKwf7yJE8wq7ySwAAAAASUVORK5CYII=`},(e=>{(e=>{ __set$(e,e.DefaultWidth=300,`DefaultWidth`) , __set$(e,e.DefaultHeight=300,`DefaultHeight`) ,e.DefaultDarkSquareColor=`#000000`,e.DefaultLightSquareColor=`#ffffff`})(e.Board||={}),(e=>{ __set$(e,e.Opacity=.2,`Opacity`) })(e.AnalysisOverlay||={}),(e=>{ __set$(e,e.Opacity=.8,`Opacity`) , __set$(e,e.FrameCropRatio=.9,`FrameCropRatio`) })(e.CustomItem||={}),(e=>{ __set$(e,e.SizeRatio=.4,`SizeRatio`) , __set$(e,e.OffsetRatio=.44,`OffsetRatio`) })(e.Effect||={}),(e=>{e.Color=`#000000`, __set$(e,e.Opacity=.1,`Opacity`) , __set$(e,e.RadiusRatio=.16,`RadiusRatio`) })(e.MoveHint||={}),(e=>{e.Color=`#000000`, __set$(e,e.Opacity=.1,`Opacity`) , __set$(e,e.OuterRadiusRatio=.5,`OuterRadiusRatio`) , __set$(e,e.InnerRadiusRatio=.41,`InnerRadiusRatio`) })(e.CaptureHint||={}),(e=>{ __set$(e,e.ImageSize=256,`ImageSize`) })(e.SVG||={})})(Kb||={}),(e=>{(e=>{e.PIECE_PERSPECTIVE_UNSPECIFIED=`PIECE_PERSPECTIVE_UNSPECIFIED`,e.TOP_DOWN=`TOP_DOWN`,e.PSEUDO_3D=`PSEUDO_3D`,e.REAL_3D=`REAL_3D`})(e.Perspective||={})})(qb||={}),Jb=[`wk`,`wq`,`wr`,`wb`,`wn`,`wp`,`bk`,`bq`,`br`,`bb`,`bn`,`bp`],Yb=[`wp`,`wn`,`wb`,`wr`,`wq`,`wk`,`bp`,`bn`,`bb`,`br`,`bq`,`bk`],Xb={"8_bit":[`#6a9b41`,`#f3f3f4`,`8_bit`,`.png`,`#ffff00`],bases:[`#c26b38`,`#efcca1`,`bases`,`.jpg`,`#f5cc2a`],blackwhite:[`#667188`,`#282f3f`,`translucent`,`.png`,`#5b91b3`],blue:[`#4D6D92`,`#ECECD7`,`blue`,`.png`,`#00a5ff`],brown:[`#B58863`,`#F0D9B5`,`brown`,`.png`,`#ffff00`],bubblegum:[`#f9cdd3`,`#fff3f3`,`bubblegum`,`.png`,`#de5d6f`],burled_wood:[`#895132`,`#d9b088`,`burled_wood`,`.jpg`,`#ee9016`],checkers:[`#e3a6a9`,`#999999`,`checkers`,`.jpg`,`#fae18a`],dark_wood:[`#8d675e`,`#e7cdb2`,`dark_wood`,`.jpg`,`#cc9122`],dash:[`#6b3a27`,`#bd9257`,`dash`,`.jpg`,`#eca722`],default:[`#779952`,`#edeed1`,`green`,`.png`,`#ffff00`],glass:[`#282f3f`,`#667188`,`glass`,`.png`,`#5b91b3`],graffiti:[`#b96f18`,`#aeaeae`,`graffiti`,`.jpg`,`#f39011`],green:[`#779952`,`#edeed1`,`green`,`.png`,`#ffff00`],grey:[`#aaaaaa`,`#dcdcdc`,`light`,`.png`,`#a4b8c4`],icy_sea:[`#7a9db2`,`#c5d5dc`,`icy_sea`,`.jpg`,`#5ed7f1`],light:[`#aaaaaa`,`#dcdcdc`,`light`,`.png`,`#a4b8c4`],lolz:[`#909898`,`#e0e9e9`,`lolz`,`.jpg`,`#a3becd`],marble:[`#706b66`,`#c7bdaa`,`marble`,`.jpg`,`#f0db86`],marbleblue:[`#c2d7e2`,`#efefef`,`marbleblue`,`.jpg`,`#65daf7`],marblebrown:[`#b96f18`,`#aeaeae`,`graffiti`,`.jpg`,`#f39011`],marblegreen:[`#706b66`,`#c7bdaa`,`marblegreen`,`.jpg`,`#f0db86`],metal:[`#6e6e6e`,`#c9c9c9`,`metal`,`.jpg`,`#a3becd`],natural:[`#D08B18`,`#FCE4B2`,`tan`,`.png`,`#f0e464`],nature:[`#8c976e`,`#c3d1a4`,`translucent`,`.png`,`#eef396`],neon:[`#636363`,`#b9b9b9`,`neon`,`.png`,`#6d90a6`],newspaper:[`#5a5956`,`#5a5956`,`newspaper`,`.jpg`,`#99976e`],orange:[`#D08B18`,`#FCE4B2`,`orange`,`.png`,`#ffff00`],overlay:[`#789ebd`,`#4878a0`,`overlay`,`.png`,`#0d9acf`],parchment:[`#B58863`,`#F0D9B5`,`parchment`,`.jpg`,`#d8cc66`],pink:[`#f9cdd3`,`#fff3f3`,`bubblegum`,`.png`,`#de5d6f`],purple:[`#8877B7`,`#EFEFEF`,`purple`,`.png`,`#7dacc9`],red:[`#BA5546`,`#F0D8BF`,`red`,`.png`,`#f8f893`],sand:[`#b8a590`,`#e5d3c4`,`sand`,`.jpg`,`#e2bc87`],sky:[`#c2d7e2`,`#efefef`,`sky`,`.png`,`#65daf7`],stone:[`#666463`,`#c8c3bd`,`stone`,`.jpg`,`#36525f`],tan:[`#D08B18`,`#FCE4B2`,`tan`,`.png`,`#f7d84a`],tournament:[`#316549`,`#ebece8`,`tournament`,`.jpg`,`#a4c25b`],translucent:[`#667188`,`#282f3f`,`translucent`,`.png`,`#5b91b3`],walnut:[`#835f42`,`#c0a684`,`walnut`,`.jpg`,`#d1a52d`],winboard:[`#316549`,`#ebece8`,`tournament`,`.jpg`,`#a4c25b`],wood:[`#8d675e`,`#e7cdb2`,`dark_wood`,`.jpg`,`#cc9122`],wooddark:[`#895132`,`#d9b088`,`burled_wood`,`.jpg`,`#ee9016`],woodlight:[`#B58863`,`#F0D9B5`,`parchment`,`.jpg`,`#d8cc66`],woodmid:[`#8d675e`,`#e7cdb2`,`dark_wood`,`.jpg`,`#cc9122`],woodolive:[`#6e6e6e`,`#c9c9c9`,`woodolive`,`.jpg`,`#a3becd`]},Zb={"3d_staunton":{format:`png`,isPseudo3d:!0,path:`3d_staunton`},"3dchesskid":{format:`png`,isPseudo3d:!0,path:`3d_chesskid`},"3dplastic":{format:`png`,isPseudo3d:!0,path:`3d_plastic`},"3dwood":{format:`png`,isPseudo3d:!0,path:`3d_wood`},"8_bit":{format:`png`,path:`8_bit`},alpha:{format:`png`,path:`alpha`},bases:{format:`png`,path:`bases`},blindfold:{format:`png`,path:`blindfold`},book:{format:`png`,path:`book`},bubblegum:{format:`png`,path:`bubblegum`},cases:{format:`png`,path:`cases`},classic:{format:`png`,path:`classic`},club:{format:`png`,path:`club`},condal:{format:`png`,path:`condal`},dash:{format:`png`,path:`dash`},game_room:{format:`png`,path:`game_room`},glass:{format:`png`,path:`glass`},gothic:{format:`png`,path:`gothic`},graffiti:{format:`png`,path:`graffiti`},icy_sea:{format:`png`,path:`icy_sea`},light:{format:`png`,path:`light`},lolz:{format:`png`,path:`lolz`},luca:{format:`png`,path:`luca`},marble:{format:`png`,path:`marble`},maya:{format:`png`,path:`maya`},metal:{format:`png`,path:`metal`},modern2:{format:`png`,path:`modern`},nature:{format:`png`,path:`nature`},neo:{format:`png`,path:`neo`},neo_wood:{format:`png`,path:`neo_wood`},neon:{format:`png`,path:`neon`},newspaper:{format:`png`,path:`newspaper`},ocean:{format:`png`,path:`ocean`},real3d:{format:`png`,path:`neo`},sky:{format:`png`,path:`sky`},space:{format:`png`,path:`space`},tigers:{format:`png`,path:`tigers`},tournament:{format:`png`,path:`tournament`},vintage:{format:`png`,path:`vintage`},wood:{format:`png`,path:`wood`}},(e=>{class t extends Error{}e.StylesSetFailed=t,(e=>{(e=>{e.Arcade=`arcade`,e.Default=`default`,e.Fast=`fast`,e.Natural=`natural`,e.None=`none`,e.Slow=`slow`})(e.Types||={}),(e=>{ __set$(e,e.Default=180,`Default`) , __set$(e,e.Fast=100,`Fast`) , __set$(e,e.Slow=500,`Slow`) })(e.Speeds||={})})(e.Animation||={}),(e=>{e.Selected=`#ffff00`,e.Blue=`#52b0dc`,e.Green=`#acce59`,e.Orange=`#ffaa00`,e.Red=`#eb6150`})(e.HighlightColors||={}),(e=>{e.Analysis=`analysis`,e.Move=`move`,e.Selected=`selected`})(e.HighlightTypes||={}),(e=>{e.Blue=`rgba(72, 193, 249, 0.8)`,e.Green=`rgba(159, 207, 63, 0.8)`,e.Orange=`rgba(255, 170, 0, 0.8)`,e.Red=`rgba(248, 85, 63, 0.8)`})(e.HighlightedArrowColors||={}),(e=>{e.Inside=`inside`,e.Off=`off`,e.Outside=`outside`})(e.CoordinatesPositions||={}),(e=>{e.Click=`click`,e.Drag=`drag`,e.Drag_Only=`drag_only`,e.DragOnly=`drag-only`})(e.MoveMethods||={}),(e=>{e.Figurine=`figurine`,e.Text=`text`})(e.MoveListDisplayTypes||={}),(e=>{e.HoverSquareOutline=`hoverSquareOutline`})(e.BooleanOptions||={}),(e=>{e.AnimationType=`animationType`,e.BoardStyle=`boardStyle`,e.Coordinates=`coordinates`,e.DarkMode=`darkMode`,e.EvaluationBarType=`evaluationBarType`,e.HighlightLegalMoves=`highlightLegalMoves`,e.HighlightMoves=`highlightMoves`,e.MoveListDisplayType=`moveListDisplayType`,e.PieceStyle=`pieceStyle`,e.SoundTheme=`soundTheme`,e.PlaySounds=`playSounds`})(e.SaveableOptions||={})})(Qb||={}),(e=>{(e=>{e.Name=`board-disabled`})(e.Plugin||={})})($b||={}),ex=(e=>(e.Pseudo3d=`pseudo3d`,e.Disabled=`board-disabled`,e.Flipped=`flipped`,e))(ex||{}),tx=(e=>(e.All=`All`,e.Move=`Move`,e))(tx||{}),(e=>{(e=>{e.Default=`default`,e.WebGL2D=`webgl-2d`,e.WebGL3D=`webgl-3d`})(e.Types||={}),e.TriggerOptions=[Qb.SaveableOptions.AnimationType,Qb.SaveableOptions.PieceStyle]})(nx||={}),rx=c({data:rn(),initialState:`idle`,states:{changedPiece:{load:an,move:()=>({data:{chosenPiece:void 0,didChangePieces:!0,mouseCoords:[...rx.getData().mouseCoords,rx.getData().tentativeMouseCoords],moveHoldTimes:[...rx.getData().moveHoldTimes,Date.now()-rx.getData().moveHoldTimeStart]},nextState:`idle`})},chosenPiece:{choosePiece: _hh$temp883=>{var e=_hh$temp883.tentativeMouseCoords,t=_hh$temp883.moveHoldTimeStart;return{data:{moveHoldTimeStart:t,tentativeMouseCoords:e},nextState:`changedPiece`};} ,load:an,move:()=>({data:{chosenPiece:void 0,mouseCoords:[...rx.getData().mouseCoords,rx.getData().tentativeMouseCoords],moveHoldTimes:[...rx.getData().moveHoldTimes,Date.now()-rx.getData().moveHoldTimeStart]},nextState:`idle`})},idle:{choosePiece: _hh$temp884=>{var e=_hh$temp884.chosenPiece,t=_hh$temp884.moveHoldTimeStart,n=_hh$temp884.tentativeMouseCoords;return{data:{chosenPiece:e,didChangePieces:!1,moveHoldTimeStart:t,tentativeMouseCoords:n},nextState:`chosenPiece`};} ,load:an}}}),(e=>{(e=>{e.AddingMarkings=`AddingMarkings`,e.Idle=`Idle`,e.PieceDragging=`PieceDragging`,e.PieceSelected=`PieceSelected`,e.PromotionAreaShowing=`PomotionAreaShowing`})(e.States||={})})(ix||={}),(e=>{e.Name=`core`})(ax||={}),ox=(e=>(e.Arrows=`arrows`,e.BlinkingHighlights=`blinking-highlights`,e.CaptureHints=`capture-hints`,e.Coordinates=`coordinates`,e.Effects=`effects`,e.FadeSetup=`fade-setup`,e.HoverSquare=`hover-square`,e.MoveHints=`move-hints`,e.Pieces=`pieces`,e.PromotionWindow=`promotion-window`,e.Squares=`squares`,e))(ox||{}),sx=(e=>(e.Anchor=`anchor`,e.Animated=`animated`,e.Blinking=`blinking`,e.Color=`color`,e.Dragging=`dragging`,e.Editable=`editable`,e.Element=`element`,e.EnPassant=`enPassant`,e.File=`file`,e.Figurine=`figurine`,e.Flipped=`flipped`,e.Inside=`inside`,e.Interval=`interval`,e.LeadingFigurine=`leadingFigurine`,e.Opacity=`opacity`,e.Outside=`outside`,e.Position=`position`,e.Rank=`rank`,e.Selected=`selected`,e.ShortString=`shortstring`,e.Square=`square`,e.Star=`star`,e.TextColor=`textColor`,e.TextValue=`textValue`,e.Times=`times`,e.TrailingFigurine=`trailingFigurine`,e.Type=`type`,e.WholeMoveNumber=`wholeMoveNumber`,e.X=`x`,e.Y=`y`,e))(sx||{}),cx=(e=>(e.Arrow=`arrow`,e.BlinkingHighlight=`blinking-highlight`,e.Board=`board`,e.CommentLink=`comment-link`,e.Coordinates=`coordinates`,e.CustomItem=`custom-item`,e.Effect=`effect`,e.FadeInOverlay=`fade-in-overlay`,e.GameResult=`game-result`,e.HalfMove=`half-move`,e.Highlight=`highlight`,e.Hint=`hint`,e.HoverSquare=`hover-square`,e.Move=`move`,e.Piece=`piece`,e.PotentialCapture=`capture-hint`,e.PromotionCloseButton=`promotion-close-button`,e.PromotionPiece=`promotion-piece`,e.PromotionWindow=`promotion-window`,e.Square=`square`,e.SiblingBoard=`sibling-board`,e))(cx||{}),lx=Object.freeze(Object.defineProperty({__proto__:null,Image:`
<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
  <image x="7.5" y="7.5" width="25" height="25" />
</svg>
`,Star:`
  <svg xmlns="http://www.w3.org/2000/svg" style="fill: #ffa704" viewBox="0 0 40 40">
    <path
      d="M23.12,17.84H16.4a1.11,1.11,0,0,1-1.06-1.43L18.7,5.21a1.11,1.11,0,0,1,2.13,0l3.36,11.2A1.11,1.11,0,0,1,23.12,17.84Z" />
    <path
      d="M27.21,34.11,4.35,16.88a1.11,1.11,0,0,1,.67-2l17.89,0a1.11,1.11,0,0,1,1.06.8l5,17.19A1.11,1.11,0,0,1,27.21,34.11Z" />
    <path
      d="M35.17,16.88,12.31,34.11a1.11,1.11,0,0,1-1.74-1.2l5-17.19a1.11,1.11,0,0,1,1.06-.8l17.89,0A1.11,1.11,0,0,1,35.17,16.88Z" />
  </svg>
`,TextBox:`
<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect x="5" y="12.5" width="30" height="15" rx="3" fill="inherit" />
  <text fill="#676767" font-size="0.8rem" x="20.5" y="20.5" dominant-baseline="middle" text-anchor="middle"></text>
</svg>
`},Symbol.toStringTag,{value:`Module`})),(e=>{e.DefaultSquareColor=`#ffa704`})(ux||={}),(e=>{(e=>{e.EntryAdded=`EntryAdded`})(e.Events||={}),(e=>{e.Debug=`Debug`,e.Error=`Error`,e.None=`None`})(e.Levels||={})})(dx||={}),(e=>{(e=>{e.Background=`icon-background`,e.Component=`icon-component`,e.ComponentShadow=`icon-component-shadow`,e.Shadow=`icon-shadow`})(e.ClassNames||={})})(q||={}),fx=`<g id="alternative">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M14.57,4.71l-4.42.2a.2.2,0,0,0-.11,0A.16.16,0,0,0,10,5a.21.21,0,0,0,0,.11.31.31,0,0,0,0,.1l1.4,1.4L8.92,9.13,6.5,6.71,8,5.24a.19.19,0,0,0,0-.1A.14.14,0,0,0,8,5,.15.15,0,0,0,8,4.94a.21.21,0,0,0-.11,0L3.42,4.71l-.08,0-.06,0a.18.18,0,0,0,0,.07.19.19,0,0,0,0,.08l.19,4.42a.15.15,0,0,0,0,.11.18.18,0,0,0,.08.07.25.25,0,0,0,.12,0,.18.18,0,0,0,.09-.06L5.21,8l2.55,2.56v4.49a.29.29,0,0,0,0,.09l0,.07.08,0,.09,0H9.85l.09,0a.18.18,0,0,0,.07,0l.05-.07a.29.29,0,0,0,0-.09V10.57l2.63-2.63,1.55,1.54a.16.16,0,0,0,.09,0,.17.17,0,0,0,.12,0,.18.18,0,0,0,.08-.07.13.13,0,0,0,0-.1l.19-4.43a.19.19,0,0,0,0-.08.18.18,0,0,0,0-.07l-.07,0Z"></path>
      </g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M14.57,4.21l-4.42.2a.2.2,0,0,0-.11,0,.16.16,0,0,0-.07.09.21.21,0,0,0,0,.11.31.31,0,0,0,0,.1l1.4,1.4L8.92,8.63,6.5,6.21,8,4.74a.19.19,0,0,0,0-.1.14.14,0,0,0,0-.11A.15.15,0,0,0,8,4.44a.21.21,0,0,0-.11,0L3.42,4.21l-.08,0-.06,0a.18.18,0,0,0,0,.07.19.19,0,0,0,0,.08l.19,4.42a.15.15,0,0,0,0,.11A.18.18,0,0,0,3.53,9a.25.25,0,0,0,.12,0A.18.18,0,0,0,3.74,9L5.21,7.51l2.55,2.56v4.49a.29.29,0,0,0,0,.09l0,.07.08,0,.09,0H9.85l.09,0a.18.18,0,0,0,.07,0l.05-.07a.29.29,0,0,0,0-.09V10.07l2.63-2.63L14.26,9a.16.16,0,0,0,.09,0,.17.17,0,0,0,.12,0A.18.18,0,0,0,14.55,9a.13.13,0,0,0,0-.1l.19-4.43a.19.19,0,0,0,0-.08.18.18,0,0,0,0-.07l-.07,0Z"></path>
    </g>
  </g>`,px=`<g id="best">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path class="${q.ClassNames.ComponentShadow}" opacity="0.2" d="M9,3.43a.5.5,0,0,0-.27.08.46.46,0,0,0-.17.22L7.24,7.17l-3.68.19a.52.52,0,0,0-.26.1.53.53,0,0,0-.16.23.45.45,0,0,0,0,.28.44.44,0,0,0,.15.23l2.86,2.32-1,3.56a.45.45,0,0,0,0,.28.46.46,0,0,0,.17.22.41.41,0,0,0,.26.09.43.43,0,0,0,.27-.08l3.09-2,3.09,2a.46.46,0,0,0,.53,0,.46.46,0,0,0,.17-.22.53.53,0,0,0,0-.28l-1-3.56L14.71,8.2A.44.44,0,0,0,14.86,8a.45.45,0,0,0,0-.28.53.53,0,0,0-.16-.23.52.52,0,0,0-.26-.1l-3.68-.2L9.44,3.73a.46.46,0,0,0-.17-.22A.5.5,0,0,0,9,3.43Z"></path>
    <path class="${q.ClassNames.Component}" fill="#fff" d="M9,2.93A.5.5,0,0,0,8.73,3a.46.46,0,0,0-.17.22L7.24,6.67l-3.68.19A.52.52,0,0,0,3.3,7a.53.53,0,0,0-.16.23.45.45,0,0,0,0,.28.44.44,0,0,0,.15.23L6.15,10l-1,3.56a.45.45,0,0,0,0,.28.46.46,0,0,0,.17.22.41.41,0,0,0,.26.09.43.43,0,0,0,.27-.08l3.09-2,3.09,2a.46.46,0,0,0,.53,0,.46.46,0,0,0,.17-.22.53.53,0,0,0,0-.28l-1-3.56L14.71,7.7a.44.44,0,0,0,.15-.23.45.45,0,0,0,0-.28A.53.53,0,0,0,14.7,7a.52.52,0,0,0-.26-.1l-3.68-.2L9.44,3.23A.46.46,0,0,0,9.27,3,.5.5,0,0,0,9,2.93Z"></path>
  </g>`,mx=`<g id="blunder">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#ca3431" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M14.74,5.45A2.58,2.58,0,0,0,14,4.54,3.76,3.76,0,0,0,12.89,4a4.07,4.07,0,0,0-1.2-.19A3.92,3.92,0,0,0,10.51,4a5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06l.11-.08a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83V11a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.8a1,1,0,0,1,.26-.7q.27-.28.66-.63A5.79,5.79,0,0,0,14.05,9a4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5.45Z"></path>
      <path d="M12.38,12.65H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V13a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.65Z"></path>
      <path d="M6.79,12.65H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,15a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V13a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.65Z"></path>
      <path d="M8.39,4.54A3.76,3.76,0,0,0,7.3,4a4.07,4.07,0,0,0-1.2-.19A3.92,3.92,0,0,0,4.92,4a5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06l.11-.08a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,6.06a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.9a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83V11a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1A.5.5,0,0,0,7,11V10.8a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9.47c.18-.15.35-.31.52-.48A7,7,0,0,0,9,8.39a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1,2.66,2.66,0,0,0-.29-1.27A2.58,2.58,0,0,0,8.39,4.54Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M14.74,5A2.58,2.58,0,0,0,14,4a3.76,3.76,0,0,0-1.09-.56,4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06L10.37,6a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.3a1,1,0,0,1,.26-.7q.27-.28.66-.63a5.79,5.79,0,0,0,.51-.48,4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M12.38,12.15H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.15Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M6.79,12.15H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,14.51a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.15Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M8.39,4A3.76,3.76,0,0,0,7.3,3.48a4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06L4.78,6a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,5.56a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.4a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1.5.5,0,0,0,0-.12V10.3a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9c.18-.15.35-.31.52-.48A7,7,0,0,0,9,7.89a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1A2.66,2.66,0,0,0,9.15,5,2.58,2.58,0,0,0,8.39,4Z"></path>
    </g>
  </g>`,hx=`<g id="book">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#a88865" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g>
      <path class="${q.ClassNames.ComponentShadow}" opacity="0.3" isolation="isolate" d="M8.45,5.9c-1-.75-2.51-1.09-4.83-1.09H2.54v8.71H3.62a8.16,8.16,0,0,1,4.83,1.17Z"></path>
      <path class="${q.ClassNames.ComponentShadow}" opacity="0.3" isolation="isolate" d="M9.54,14.69a8.14,8.14,0,0,1,4.84-1.17h1.08V4.81H14.38c-2.31,0-3.81.34-4.84,1.09Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M8.45,5.4c-1-.75-2.51-1.09-4.83-1.09H3V13h.58a8.09,8.09,0,0,1,4.83,1.17Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M9.54,14.19A8.14,8.14,0,0,1,14.38,13H15V4.31h-.58c-2.31,0-3.81.34-4.84,1.09Z"></path>
    </g>
  </g>`,gx=`<g id="Brilliant">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#1bada6" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M12.57,14.6a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.84A.41.41,0,0,1,10,14.6V12.7a.32.32,0,0,1,.09-.23.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.9A.36.36,0,0,1,10,3.66a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
      <path d="M8.07,14.6a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.7a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.67a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.9a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M12.57,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.34A.41.41,0,0,1,10,14.1V12.2A.32.32,0,0,1,10,12a.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.4A.36.36,0,0,1,10,3.16a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M8.07,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2A.31.31,0,0,1,8,12a.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.17a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
    </g>
  </g>`,_x=`<g id="checkmate_black">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path d="M11.44,8.41h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.86H8.31l.18-2.78H6.94L6.76,6.86H5l-.1,1.55H6.66l-.11,1.68H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.64H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,10.09l.1-1.68H9.89l-.1,1.68Z"></path>
    <path class="${q.ClassNames.ComponentShadow}" fill="#fff" d="M11.44,7.91h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.36H8.31l.18-2.78H6.94L6.76,6.36H5l-.1,1.55H6.66L6.55,9.59H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.14H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.59l.1-1.68H9.89l-.1,1.68Z"></path>
  </g>`,vx=`<g id="checkmate_white">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <circle class="${q.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>
    <path class="${q.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path d="M11.44,8.11h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.56H8.31l.18-2.78H6.94L6.76,6.56H5l-.1,1.55H6.66L6.55,9.79H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.34H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.79l.1-1.68H9.89l-.1,1.68Z"></path>
  </g>`,yx=`<g id="correct">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.ComponentShadow}" opacity="0.2" d="M15.11,6.81,9.45,12.47,7.79,14.13a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.78a.39.39,0,0,1-.11-.28.39.39,0,0,1,.11-.27L4.28,7.85a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09l2.69,2.68,5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.81Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M15.11,6.31,9.45,12,7.79,13.63a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.28A.39.39,0,0,1,2.78,9a.39.39,0,0,1,.11-.27L4.28,7.35a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09L7.52,10l5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.31Z"></path>
    </g>
  </g>`,bx=`<g id="critical">
    <g class="${q.ClassNames.Shadow}" opacity="0.3">
      <path d="M17.68,5.2,11.06,16.67a2.37,2.37,0,0,1-4.11,0L.32,5.2A2.38,2.38,0,0,1,2.38,1.64H15.62A2.38,2.38,0,0,1,17.68,5.2Z"></path>
    </g>
    <path class="${q.ClassNames.Background}" fill="#ad5b8c" d="M17.68,4.7,11.06,16.17a2.37,2.37,0,0,1-4.11,0L.32,4.7A2.38,2.38,0,0,1,2.38,1.14H15.62A2.38,2.38,0,0,1,17.68,4.7Z"></path>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M8.67,3.22,5.9,9.92V10a.14.14,0,0,0,0,.06l0,0,0,0H8.4a.1.1,0,0,1,.09,0,.09.09,0,0,1,0,.08l0,5c0,.11.17.17.21.07L12.1,8V7.92a.14.14,0,0,0,0-.06.09.09,0,0,0-.05,0l-.06,0H9.32a.11.11,0,0,1-.08,0,.12.12,0,0,1,0-.09l-.32-4.4C8.87,3.18,8.71,3.12,8.67,3.22Z"></path>
    </g>
    <path class="${q.ClassNames.Component}" fill="#fff" d="M8.67,2.72,5.9,9.42v.05a.14.14,0,0,0,0,.06l0,0,0,0H8.4a.1.1,0,0,1,.09,0,.09.09,0,0,1,0,.08l0,5c0,.11.17.17.21.07l3.4-7.24V7.42a.14.14,0,0,0,0-.06.09.09,0,0,0-.05,0l-.06,0H9.32a.11.11,0,0,1-.08,0,.12.12,0,0,1,0-.09l-.32-4.4C8.87,2.68,8.71,2.62,8.67,2.72Z"></path>
  </g>`,xx=`<g id="draw_black">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path d="M2.92,7V5.84c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V7Zm8.87-2.39L7,13.88H5l4.8-9.26ZM9.85,13.88c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,8.26,15,8.78,15,10c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>
    <path class="${q.ClassNames.ComponentShadow}" fill="#fff" d="M2.92,6.51V5.34c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V6.51Zm8.87-2.39L7,13.38H5l4.8-9.26ZM9.85,13.38c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,7.76,15,8.28,15,9.5c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>
  </g>`,Sx=`<g id="draw_white">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <circle class="${q.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>
    <path class="${q.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path d="M2.92,6.61V5.44c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V6.61Zm8.87-2.39L7,13.48H5l4.8-9.26ZM9.85,13.48c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,7.86,15,8.38,15,9.6c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>
  </g>`,Cx=`<g id="excellent">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M13.79,11.34c0-.2.4-.53.4-.94S14,9.72,14,9.58a2.06,2.06,0,0,0,.18-.83,1,1,0,0,0-.3-.69,1.13,1.13,0,0,0-.55-.2,10.29,10.29,0,0,1-2.07,0c-.37-.23,0-1.18.18-1.7S11.9,4,10.62,3.7c-.69-.17-.66.37-.78.9-.05.21-.09.43-.13.57A5,5,0,0,1,7.05,8.23a1.57,1.57,0,0,1-.42.18v4.94A7.23,7.23,0,0,1,8,13.53c.52.12.91.25,1.44.33A11.11,11.11,0,0,0,11,14a6.65,6.65,0,0,0,1.18,0,1.09,1.09,0,0,0,1-.59.66.66,0,0,0,.06-.2,1.63,1.63,0,0,1,.07-.3c.13-.28.37-.3.5-.68S13.74,11.53,13.79,11.34Z"></path>
      <path d="M5.49,8.09H4.31a.5.5,0,0,0-.5.5v4.56a.5.5,0,0,0,.5.5H5.49a.5.5,0,0,0,.5-.5V8.59A.5.5,0,0,0,5.49,8.09Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M13.79,10.84c0-.2.4-.53.4-.94S14,9.22,14,9.08a2.06,2.06,0,0,0,.18-.83,1,1,0,0,0-.3-.69,1.13,1.13,0,0,0-.55-.2,10.29,10.29,0,0,1-2.07,0c-.37-.23,0-1.18.18-1.7s.51-2.12-.77-2.43c-.69-.17-.66.37-.78.9-.05.21-.09.43-.13.57A5,5,0,0,1,7.05,7.73a1.57,1.57,0,0,1-.42.18v4.94A7.23,7.23,0,0,1,8,13c.52.12.91.25,1.44.33a11.11,11.11,0,0,0,1.62.16,6.65,6.65,0,0,0,1.18,0,1.09,1.09,0,0,0,1-.59.66.66,0,0,0,.06-.2,1.63,1.63,0,0,1,.07-.3c.13-.28.37-.3.5-.68S13.74,11,13.79,10.84Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M5.49,7.59H4.31a.5.5,0,0,0-.5.5v4.56a.5.5,0,0,0,.5.5H5.49a.5.5,0,0,0,.5-.5V8.09A.5.5,0,0,0,5.49,7.59Z"></path>
    </g>
  </g>`,wx=`<g id="fast_win">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M4.85,4.7,9.67,9.19a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18l-.05.07L4.85,14a.24.24,0,0,1-.11.06.3.3,0,0,1-.13,0A.23.23,0,0,1,4.52,14a.28.28,0,0,1,0-.12v-9a.28.28,0,0,1,0-.12.23.23,0,0,1,.09-.08.3.3,0,0,1,.13,0A.24.24,0,0,1,4.85,4.7Z"></path>
      <path d="M10,4.7l4.82,4.49a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18l-.05.07L10,14a.24.24,0,0,1-.11.06.27.27,0,0,1-.13,0A.18.18,0,0,1,9.7,14a.19.19,0,0,1,0-.12v-9a.19.19,0,0,1,0-.12.18.18,0,0,1,.09-.08.27.27,0,0,1,.13,0A.24.24,0,0,1,10,4.7Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M4.85,4.2,9.67,8.69a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18L9.67,9,4.85,13.5a.24.24,0,0,1-.11.06.3.3,0,0,1-.13,0,.23.23,0,0,1-.09-.08.28.28,0,0,1,0-.12v-9a.28.28,0,0,1,0-.12.23.23,0,0,1,.09-.08.3.3,0,0,1,.13,0A.24.24,0,0,1,4.85,4.2Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M10,4.2l4.82,4.49a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18L14.85,9,10,13.5a.24.24,0,0,1-.11.06.27.27,0,0,1-.13,0,.18.18,0,0,1-.09-.08.19.19,0,0,1,0-.12v-9a.19.19,0,0,1,0-.12.18.18,0,0,1,.09-.08.27.27,0,0,1,.13,0A.24.24,0,0,1,10,4.2Z"></path>
    </g>
  </g>`,Tx=`<g id="free_piece">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M9.76,9.66h3.89v4.19a.68.68,0,0,1-.68.68H9.76Z"></path>
      <path d="M4.35,9.66H8.24v4.87H5a.58.58,0,0,1-.26-.06.6.6,0,0,1-.36-.36.58.58,0,0,1,0-.26V9.66Z"></path>
      <path d="M13.39,7H10.13l2-1a.78.78,0,0,0,.29-.25.78.78,0,0,0,.13-.36A.82.82,0,0,0,12.53,5a.87.87,0,0,0-.23-.31l-1.15-1a.76.76,0,0,0-.34-.16.74.74,0,0,0-.39,0,.94.94,0,0,0-.33.2.84.84,0,0,0-.19.33L9.08,7H9l-.83-2.9A.73.73,0,0,0,8,3.81a.79.79,0,0,0-.33-.2.7.7,0,0,0-.38,0,.75.75,0,0,0-.35.16l-1.14,1A.87.87,0,0,0,5.54,5a.71.71,0,0,0,0,.38.78.78,0,0,0,.13.36A.71.71,0,0,0,5.91,6l2,1H4.61a.46.46,0,0,0-.49.44v.87a.47.47,0,0,0,.49.45h8.78a.47.47,0,0,0,.49-.45V7.48A.47.47,0,0,0,13.39,7Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M9.76,14H13a.71.71,0,0,0,.48-.19.72.72,0,0,0,.2-.48V9.16H9.76Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M4.36,13.35a.58.58,0,0,0,0,.26.6.6,0,0,0,.36.36A.58.58,0,0,0,5,14H8.24V9.16H4.36Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M13.39,6.54H10.13l2-1a.78.78,0,0,0,.29-.25.78.78,0,0,0,.13-.36.82.82,0,0,0-.05-.38.87.87,0,0,0-.23-.31l-1.15-1a.76.76,0,0,0-.34-.16.74.74,0,0,0-.39,0,.94.94,0,0,0-.33.2.84.84,0,0,0-.19.33l-.82,2.9H9l-.83-2.9A.73.73,0,0,0,8,3.31a.79.79,0,0,0-.33-.2.7.7,0,0,0-.38,0,.75.75,0,0,0-.35.16l-1.14,1a.87.87,0,0,0-.23.31.71.71,0,0,0,0,.38.78.78,0,0,0,.13.36.71.71,0,0,0,.29.25l2,1H4.61A.46.46,0,0,0,4.12,7v.87a.47.47,0,0,0,.49.45h8.78a.47.47,0,0,0,.49-.45V7A.47.47,0,0,0,13.39,6.54Z"></path>
    </g>
  </g>`,Ex=`<path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
<path class="${q.ClassNames.Background}" fill="#7979a1" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
<g class="${q.ClassNames.ComponentShadow}" opacity="0.1">
    <polygon points="11.29 11.34 11.29 8.56 7.79 11.3 7.79 11.34 5.39 11.34 9.54 16.5 13.73 11.34 11.29 11.34"></polygon>
    <polygon points="7.83 7.51 7.83 10.32 11.33 7.58 11.33 7.5 13.73 7.5 9.58 2.35 5.39 7.51 7.83 7.51"></polygon>
  </g>
<g>
    <polygon class="${q.ClassNames.Component}" fill="#fff" points="10.9 10.92 10.9 8.13 7.4 10.87 7.4 10.92 5 10.92 9.15 16.07 13.34 10.92 10.9 10.92"></polygon>
    <polygon class="${q.ClassNames.Component}" fill="#fff" points="7.44 7.08 7.44 9.9 10.94 7.16 10.94 7.08 13.34 7.08 9.19 1.93 5 7.08 7.44 7.08"></polygon>
  </g>`,Dx=`<g id="great_find">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#5c8bb0" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g>
      <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M10.32,14.6a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.7a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.9a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
      </g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M10.32,14.1a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
    </g>
  </g>`,Ox=`<g id="forced">
    <g id="fast_win">
      <g>
        <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
        <path class="${q.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
      </g>
    </g>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M14.39,9.07,9,4.31a.31.31,0,0,0-.3,0,.32.32,0,0,0-.13.1.29.29,0,0,0,0,.16V7.42H3.9a.58.58,0,0,0-.19,0,.5.5,0,0,0-.17.11.91.91,0,0,0-.11.16.63.63,0,0,0,0,.19v3.41a.58.58,0,0,0,0,.19.64.64,0,0,0,.11.16.39.39,0,0,0,.17.11.41.41,0,0,0,.19,0H8.5v2.74a.26.26,0,0,0,.16.26.3.3,0,0,0,.16,0A.34.34,0,0,0,9,14.79L14.39,10a.69.69,0,0,0,.16-.22.7.7,0,0,0,0-.52A.69.69,0,0,0,14.39,9.07Z"></path>
    </g>
    <path class="${q.ClassNames.Component}" fill="#fff" d="M14.39,8.57,9,3.81a.31.31,0,0,0-.3,0,.32.32,0,0,0-.13.1A.29.29,0,0,0,8.5,4V6.92H3.9a.58.58,0,0,0-.19,0,.5.5,0,0,0-.17.11.91.91,0,0,0-.11.16.63.63,0,0,0,0,.19v3.41a.58.58,0,0,0,0,.19.64.64,0,0,0,.11.16.39.39,0,0,0,.17.11.41.41,0,0,0,.19,0H8.5v2.74a.26.26,0,0,0,.16.26.3.3,0,0,0,.16,0A.34.34,0,0,0,9,14.29l5.42-4.76a.69.69,0,0,0,.16-.22.7.7,0,0,0,0-.52A.69.69,0,0,0,14.39,8.57Z"></path>
  </g>`,kx=`<g id="good">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.ComponentShadow}" opacity="0.2" d="M15.11,6.81,9.45,12.47,7.79,14.13a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.78a.39.39,0,0,1-.11-.28.39.39,0,0,1,.11-.27L4.28,7.85a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09l2.69,2.68,5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.81Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M15.11,6.31,9.45,12,7.79,13.63a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.28A.39.39,0,0,1,2.78,9a.39.39,0,0,1,.11-.27L4.28,7.35a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09L7.52,10l5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.31Z"></path>
    </g>
  </g>`,Ax=`<g id="inaccuracy">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#f7c045" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M13.66,14.8a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.8V12.9a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,4.1A.5.5,0,0,1,11,3.86l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>
      <path d="M7.65,14.82a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V13a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73A5.58,5.58,0,0,1,9,9a4.85,4.85,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7V11a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27A1.16,1.16,0,0,0,6.49,6,1.61,1.61,0,0,0,6,6.11a3,3,0,0,0-.41.18,1.75,1.75,0,0,0-.29.18l-.11.09A.5.5,0,0,1,5,6.62a.31.31,0,0,1-.21-.13l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.68a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17,3.92,3.92,0,0,1,2.3.75,2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.71,3,3,0,0,1,9.85,7.65Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M13.66,14.3a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.3V12.4a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,3.6A.5.5,0,0,1,11,3.36l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M7.65,14.32a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.49a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6A4.85,4.85,0,0,1,8.48,9a8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24A1.61,1.61,0,0,0,6,5.61a3,3,0,0,0-.41.18A1.75,1.75,0,0,0,5.3,6l-.11.09A.5.5,0,0,1,5,6.12.31.31,0,0,1,4.74,6l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.18a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17A3.92,3.92,0,0,1,8.93,4a2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.21,3,3,0,0,1,9.85,7.15Z"></path>
    </g>
  </g>`,jx=`<g id="incorrect">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#ca3431" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M14,12.51a.57.57,0,0,1,.08.13.39.39,0,0,1,0,.3.5.5,0,0,1-.08.12l-1.38,1.38a.5.5,0,0,1-.12.08l-.15,0-.15,0a.57.57,0,0,1-.13-.08L9,11.37,5.94,14.44a.57.57,0,0,1-.13.08l-.15,0-.15,0a.36.36,0,0,1-.12-.08L4,13.06a.39.39,0,0,1-.11-.27A.41.41,0,0,1,4,12.51L7.07,9.45,4,6.39a.43.43,0,0,1-.11-.28A.39.39,0,0,1,4,5.84L5.39,4.46a.39.39,0,0,1,.27-.11.43.43,0,0,1,.28.11L9,7.52l3.06-3.06a.41.41,0,0,1,.28-.11.39.39,0,0,1,.27.11L14,5.84a.36.36,0,0,1,.08.12.39.39,0,0,1,0,.3.57.57,0,0,1-.08.13L10.92,9.45Z"></path>
    </g>
    <path class="${q.ClassNames.Component}" fill="#f1f2f2" d="M14,12a.57.57,0,0,1,.08.13.39.39,0,0,1,0,.3.5.5,0,0,1-.08.12l-1.38,1.38a.5.5,0,0,1-.12.08l-.15,0-.15,0a.57.57,0,0,1-.13-.08L9,10.87,5.94,13.94a.57.57,0,0,1-.13.08l-.15,0-.15,0a.36.36,0,0,1-.12-.08L4,12.56a.39.39,0,0,1-.11-.27A.41.41,0,0,1,4,12L7.07,9,4,5.89a.43.43,0,0,1-.11-.28A.39.39,0,0,1,4,5.34L5.39,4a.39.39,0,0,1,.27-.11A.43.43,0,0,1,5.94,4L9,7,12.06,4a.41.41,0,0,1,.28-.11.39.39,0,0,1,.27.11L14,5.34a.36.36,0,0,1,.08.12.39.39,0,0,1,0,.3.57.57,0,0,1-.08.13L10.92,9Z"></path>
  </g>`,Mx=`<g id="mate">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g>
      <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M11.44,8.61h1.74l.1-1.55H11.54l.18-2.78H10.17L10,7.06H8.31l.18-2.78H6.94L6.76,7.06H5l-.1,1.55H6.66l-.11,1.68H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.84H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,10.29l.1-1.68H9.89l-.1,1.68Z"></path>
      </g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M11.44,8.11h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.56H8.31l.18-2.78H6.94L6.76,6.56H5l-.1,1.55H6.66L6.55,9.79H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.34H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.79l.1-1.68H9.89l-.1,1.68Z"></path>
    </g>
  </g>`,Nx=`<defs><style>.cls-1{fill:#f1f2f2;}.cls-2{fill:#ee6b55;}.cls-3{opacity:.2;}.cls-4{opacity:.3;}</style></defs><g id="incorrect"><path class="cls-4" d="M9,.5C4.03,.5,0,4.53,0,9.5s4.03,9,9,9,9-4.03,9-9S13.97,.5,9,.5Z"/><path class="cls-2" d="M9,0C4.03,0,0,4.03,0,9s4.03,9,9,9,9-4.03,9-9S13.97,0,9,0Z"/><g class="cls-3"><path d="M13.99,12.51s.06,.08,.08,.13c.02,.05,.03,.1,.03,.15s-.01,.1-.03,.15c-.02,.05-.05,.09-.08,.13l-1.37,1.37s-.08,.06-.13,.08c-.05,.02-.1,.03-.15,.03s-.1-.01-.15-.03c-.05-.02-.09-.05-.13-.08l-3.06-3.06-3.06,3.06s-.08,.06-.13,.08c-.05,.02-.1,.03-.15,.03s-.1-.01-.15-.03c-.05-.02-.09-.05-.13-.08l-1.37-1.37c-.07-.07-.11-.17-.11-.28s.04-.2,.11-.28l3.06-3.06-3.06-3.06c-.07-.07-.11-.17-.11-.28s.04-.2,.11-.28l1.37-1.37c.07-.07,.17-.11,.28-.11s.2,.04,.28,.11l3.06,3.06,3.06-3.06c.07-.07,.17-.11,.28-.11s.2,.04,.28,.11l1.37,1.37s.06,.08,.08,.13c.02,.05,.03,.1,.03,.15s-.01,.1-.03,.15c-.02,.05-.05,.09-.08,.13l-3.06,3.06,3.06,3.06Z"/></g><path class="cls-1" d="M13.99,12.01s.06,.08,.08,.13c.02,.05,.03,.1,.03,.15s-.01,.1-.03,.15c-.02,.05-.05,.09-.08,.13l-1.37,1.37s-.08,.06-.13,.08c-.05,.02-.1,.03-.15,.03s-.1-.01-.15-.03c-.05-.02-.09-.05-.13-.08l-3.06-3.06-3.06,3.06s-.08,.06-.13,.08c-.05,.02-.1,.03-.15,.03s-.1-.01-.15-.03c-.05-.02-.09-.05-.13-.08l-1.37-1.37c-.07-.07-.11-.17-.11-.28s.04-.2,.11-.28l3.06-3.06-3.06-3.06c-.07-.07-.11-.17-.11-.28s.04-.2,.11-.28l1.37-1.37c.07-.07,.17-.11,.28-.11s.2,.04,.28,.11l3.06,3.06,3.06-3.06c.07-.07,.17-.11,.28-.11s.2,.04,.28,.11l1.37,1.37s.06,.08,.08,.13c.02,.05,.03,.1,.03,.15s-.01,.1-.03,.15c-.02,.05-.05,.09-.08,.13l-3.06,3.06,3.06,3.06Z"/></g>`,Px=`<g id="missed_win">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
        <rect x="2.74" y="8.1" width="12.51" height="3.11" rx="0.36"></rect>
      </g>
      <rect class="${q.ClassNames.Component}" fill="#fff" x="2.74" y="7.6" width="12.51" height="3.11" rx="0.36"></rect>
    </g>
  </g>`,Fx=`<g id="mistake">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#e58f2a" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M9.92,15a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08A.31.31,0,0,1,7.39,15V13.19A.32.32,0,0,1,7.48,13l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35A2.42,2.42,0,0,1,7.61,10a2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34.75.75,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07,3,3,0,0,0-.41.18,1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.69L6,5.48a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2,3.07,3.07,0,0,1,.56-.38,5.38,5.38,0,0,1,.89-.37A3.75,3.75,0,0,1,8.9,4a4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.85Z"></path>
      </g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M9.92,14.52a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.69a.32.32,0,0,1,.09-.23l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35a2.42,2.42,0,0,1,.13-.84,2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34A.75.75,0,0,0,9.48,6a1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07A3,3,0,0,0,7.86,6a1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.19L6,5a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2A3.07,3.07,0,0,1,6.81,4a5.38,5.38,0,0,1,.89-.37,3.75,3.75,0,0,1,1.2-.17,4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.35Z"></path>
    </g>
  </g>`,Ix=`<g id="resign_black">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g>
      <path d="M4.94,6.34H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.78A.62.62,0,0,0,4.94,6.34Z"></path>
      <path d="M12.33,4.48c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69a.46.46,0,0,0,.12-.44c-.21-.78-.8-3-1.1-4.05C12.62,4.44,12.42,4.36,12.33,4.48Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.ComponentShadow}" fill="#fff" d="M4.94,5.74H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.18A.62.62,0,0,0,4.94,5.74Z"></path>
      <path class="${q.ClassNames.ComponentShadow}" fill="#fff" d="M12.33,3.88c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69A.46.46,0,0,0,13.76,8c-.21-.78-.8-3-1.1-4C12.62,3.84,12.42,3.76,12.33,3.88Z"></path>
    </g>
  </g>`,Lx=`<g id="resign_white">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <circle class="${q.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>
      <g>
        <path d="M4.94,5.74H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.18A.62.62,0,0,0,4.94,5.74Z"></path>
        <path d="M12.33,3.88c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69A.46.46,0,0,0,13.76,8c-.21-.78-.8-3-1.1-4C12.62,3.84,12.42,3.76,12.33,3.88Z"></path>
      </g>
    </g>
    <path class="${q.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
  </g>`,Rx=`<g id="sharp">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#ad5b8c" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M13.37,11.74,9.25,2.81a.22.22,0,0,0-.1-.11.27.27,0,0,0-.28,0,.18.18,0,0,0-.1.11L4.63,11.74a.26.26,0,0,0,0,.15.25.25,0,0,0,.08.14l2.67,2.29.07.09a.3.3,0,0,1,0,.1v1.08a.25.25,0,0,0,.08.18.24.24,0,0,0,.18.07h2.57a.26.26,0,0,0,.18-.07.25.25,0,0,0,.08-.18V14.51a.16.16,0,0,1,0-.1.47.47,0,0,1,.06-.09L13.31,12a.25.25,0,0,0,.08-.14A.26.26,0,0,0,13.37,11.74ZM9,5v8.73a.24.24,0,0,1-.38.17L5.91,11.76a.3.3,0,0,1-.09-.13.22.22,0,0,1,0-.16L8.84,5a.08.08,0,0,1,0,0h.06A.09.09,0,0,1,9,5S9,5,9,5Z"></path>
    </g>
    <path class="${q.ClassNames.Component}" fill="#fff" d="M13.37,11.24,9.25,2.31a.22.22,0,0,0-.1-.11.26.26,0,0,0-.28,0,.18.18,0,0,0-.1.11L4.63,11.24a.26.26,0,0,0,0,.15.25.25,0,0,0,.08.14l2.67,2.29.07.09a.3.3,0,0,1,0,.1v1.08a.25.25,0,0,0,.08.18.24.24,0,0,0,.18.07h2.57a.26.26,0,0,0,.18-.07.25.25,0,0,0,.08-.18V14a.16.16,0,0,1,0-.1.47.47,0,0,1,.06-.09l2.67-2.29a.25.25,0,0,0,.08-.14A.26.26,0,0,0,13.37,11.24ZM9,4.51v8.73a.24.24,0,0,1-.38.17L5.91,11.26a.3.3,0,0,1-.09-.13.22.22,0,0,1,0-.16l3-6.49a.08.08,0,0,1,0,0h.06a.09.09,0,0,1,.05,0S9,4.49,9,4.51Z"></path>
  </g>`,zx=`<g id="take_back">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M3.67,10.38a.25.25,0,0,1,.24-.31L5,9.93a.49.49,0,0,1,.2.05.26.26,0,0,1,.1.2,3.77,3.77,0,0,0,1.26,2.34,3.87,3.87,0,0,0,2.52.94,3.53,3.53,0,0,0,1.47-.31,3.72,3.72,0,0,0,1.22-.81,4.13,4.13,0,0,0,.82-1.2,3.74,3.74,0,0,0,0-3A3.94,3.94,0,0,0,11.77,7a3.72,3.72,0,0,0-1.22-.81,3.53,3.53,0,0,0-1.47-.31,3.43,3.43,0,0,0-1.23.22,3.07,3.07,0,0,0-1.09.6L7.85,7.75c.16.14.22.29.16.38s-.18.16-.4.16H4.45a.33.33,0,0,1-.19,0,1,1,0,0,1-.17-.1A.57.57,0,0,1,4,8a.46.46,0,0,1,0-.21V4.6a.4.4,0,0,1,.16-.38c.11,0,.26,0,.42.17L5.6,5.49a5.93,5.93,0,0,1,1.63-1,5.42,5.42,0,0,1,4,.11A5.17,5.17,0,0,1,12.93,5.8a5.48,5.48,0,0,1,1.16,1.73,5.17,5.17,0,0,1,.44,2.12,5,5,0,0,1-.44,2.12,5.54,5.54,0,0,1-2.88,2.91,5.77,5.77,0,0,1-2.13.42,5.39,5.39,0,0,1-1.94-.37,5.36,5.36,0,0,1-2.85-2.48A5.43,5.43,0,0,1,3.67,10.38Z"></path>
    </g>
    <path class="${q.ClassNames.Component}" fill="#fff" d="M3.67,9.88a.25.25,0,0,1,.24-.31L5,9.43a.49.49,0,0,1,.2.05.26.26,0,0,1,.1.2A3.77,3.77,0,0,0,6.56,12,3.87,3.87,0,0,0,9.08,13a3.53,3.53,0,0,0,1.47-.31,3.72,3.72,0,0,0,1.22-.81,4.13,4.13,0,0,0,.82-1.2,3.74,3.74,0,0,0,0-3,3.94,3.94,0,0,0-.82-1.2,3.72,3.72,0,0,0-1.22-.81,3.53,3.53,0,0,0-1.47-.31,3.43,3.43,0,0,0-1.23.22,3.07,3.07,0,0,0-1.09.6L7.85,7.25c.16.14.22.29.16.38s-.18.16-.4.16H4.45a.33.33,0,0,1-.19,0,1,1,0,0,1-.17-.1A.57.57,0,0,1,4,7.47a.46.46,0,0,1,0-.21V4.1a.4.4,0,0,1,.16-.38c.11-.05.26,0,.42.17L5.6,5A5.93,5.93,0,0,1,7.23,4a5.42,5.42,0,0,1,4,.11A5.17,5.17,0,0,1,12.93,5.3,5.48,5.48,0,0,1,14.09,7a5.17,5.17,0,0,1,.44,2.12,5,5,0,0,1-.44,2.12,5.54,5.54,0,0,1-2.88,2.91,5.77,5.77,0,0,1-2.13.42,5.39,5.39,0,0,1-1.94-.37,5.63,5.63,0,0,1-1.65-1,5.59,5.59,0,0,1-1.2-1.5A5.43,5.43,0,0,1,3.67,9.88Z"></path>
  </g>`,Bx=`<g id="threat">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${q.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M15.12,9.65a6.14,6.14,0,0,1-3.78,5.65,6.19,6.19,0,0,1-3.53.35A6.15,6.15,0,0,1,3,10.84,6.11,6.11,0,0,1,9,3.53a6.15,6.15,0,0,1,6.12,6.12ZM5,9.65a4,4,0,0,0,.67,2.22,4.09,4.09,0,0,0,1.79,1.47,4,4,0,0,0,5.22-5.22A4,4,0,0,0,5,9.65Z"></path>
      <path d="M6.75,9.65a2.24,2.24,0,0,0,.38,1.25,2.27,2.27,0,0,0,1,.83,2.22,2.22,0,0,0,1.3.12,2.22,2.22,0,0,0,1.76-1.76,2.22,2.22,0,0,0-.13-1.3,2.25,2.25,0,0,0-4.32.86Z"></path>
    </g>
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M15.12,9.15a6.14,6.14,0,0,1-3.78,5.65,6.19,6.19,0,0,1-3.53.35A6.15,6.15,0,0,1,3,10.34,6.11,6.11,0,0,1,9,3a6.15,6.15,0,0,1,6.12,6.12ZM5,9.15a4,4,0,0,0,.67,2.22,4.09,4.09,0,0,0,1.79,1.47,4,4,0,0,0,5.22-5.22A4,4,0,0,0,5,9.15Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M6.75,9.15a2.24,2.24,0,0,0,.38,1.25,2.27,2.27,0,0,0,1,.83,2.22,2.22,0,0,0,1.3.12A2.22,2.22,0,0,0,11.2,9.59a2.22,2.22,0,0,0-.13-1.3,2.25,2.25,0,0,0-4.32.86Z"></path>
    </g>
  </g>`,Vx=`<path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
<path class="${q.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
<path d="M8.57,7.26,8.11,10l.89.86L9.89,10,9.45,7.26ZM9,12.86A3.35,3.35,0,1,1,12.36,9.5,3.34,3.34,0,0,1,9,12.86Zm.7-8.29V4.12h.82V2.79h-3V4.12H8.3v.45a5,5,0,1,0,1.4,0Z"></path>
<path class="${q.ClassNames.ComponentShadow}" fill="#fff" d="M8.57,6.76,8.11,9.48l.89.86.89-.86L9.45,6.76ZM9,12.36A3.35,3.35,0,1,1,12.36,9,3.34,3.34,0,0,1,9,12.36Zm.7-8.29V3.62h.82V2.29h-3V3.62H8.3v.45a5,5,0,1,0,1.4,0Z"></path>`,Hx=`<path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
<circle class="${q.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>
<path class="${q.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
<path d="M8.57,6.76,8.11,9.48l.89.86.89-.86L9.45,6.76ZM9,12.36A3.35,3.35,0,1,1,12.36,9,3.34,3.34,0,0,1,9,12.36Zm.7-8.29V3.62h.82V2.29h-3V3.62H8.3v.45a5,5,0,1,0,1.4,0Z"></path>`,Ux=`
  <path
    class="${q.ClassNames.Shadow}"
    d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"
    opacity=".3"></path>
  <path
    class="${q.ClassNames.Background}"
    d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"
    fill="#8a8886"></path>
  <path
    d="M3.59,10.23a.25.25,0,0,1,.24-.31l1.08-.15a.49.49,0,0,1,.2.06.25.25,0,0,1,.11.2,3.58,3.58,0,0,0,.42,1.28,3.68,3.68,0,0,0,.84,1.06,3.76,3.76,0,0,0,1.16.69A3.9,3.9,0,0,0,9,13.31,3.58,3.58,0,0,0,10.47,13a3.94,3.94,0,0,0,1.22-.81A4.09,4.09,0,0,0,12.5,11a3.74,3.74,0,0,0,0-3,4.09,4.09,0,0,0-.81-1.2A3.94,3.94,0,0,0,10.47,6,3.65,3.65,0,0,0,9,5.69a3.61,3.61,0,0,0-1.23.21,3.23,3.23,0,0,0-1.09.6L7.77,7.59c.16.15.21.29.16.38s-.18.17-.4.17H4.37a.36.36,0,0,1-.2,0A.76.76,0,0,1,4,8a.52.52,0,0,1-.17-.38V4.45c0-.2.06-.33.17-.38s.25,0,.41.16L5.51,5.34a5.83,5.83,0,0,1,1.64-1A5.19,5.19,0,0,1,9,4.05a5.3,5.3,0,0,1,2.12.44,5,5,0,0,1,1.73,1.16A5.59,5.59,0,0,1,14,7.38a5.23,5.23,0,0,1,.44,2.12A5.16,5.16,0,0,1,14,11.62a5.59,5.59,0,0,1-1.16,1.73,5.32,5.32,0,0,1-1.73,1.18A5.64,5.64,0,0,1,9,15a5.23,5.23,0,0,1-1.94-.37A5.27,5.27,0,0,1,4.21,12.1,5.1,5.1,0,0,1,3.59,10.23Z"
    class="${q.ClassNames.ComponentShadow}"
    opacity=".3"></path>
  <path
    d="M3.59,9.73a.25.25,0,0,1,.24-.31l1.08-.15a.49.49,0,0,1,.2.06.25.25,0,0,1,.11.2,3.58,3.58,0,0,0,.42,1.28,3.68,3.68,0,0,0,.84,1.06,3.76,3.76,0,0,0,1.16.69A3.9,3.9,0,0,0,9,12.81a3.58,3.58,0,0,0,1.47-.31,3.94,3.94,0,0,0,1.22-.81,4.09,4.09,0,0,0,.81-1.2,3.74,3.74,0,0,0,0-3,4.09,4.09,0,0,0-.81-1.2,3.94,3.94,0,0,0-1.22-.81A3.65,3.65,0,0,0,9,5.19a3.61,3.61,0,0,0-1.23.21A3.23,3.23,0,0,0,6.68,6L7.77,7.09c.16.15.21.29.16.38s-.18.17-.4.17H4.37a.36.36,0,0,1-.2,0A.76.76,0,0,1,4,7.49a.52.52,0,0,1-.17-.38V4c0-.2.06-.33.17-.38s.25,0,.41.16L5.51,4.84a5.83,5.83,0,0,1,1.64-1A5.19,5.19,0,0,1,9,3.55,5.3,5.3,0,0,1,11.12,4a5,5,0,0,1,1.73,1.16A5.59,5.59,0,0,1,14,6.88,5.23,5.23,0,0,1,14.45,9,5.16,5.16,0,0,1,14,11.12a5.59,5.59,0,0,1-1.16,1.73A5.32,5.32,0,0,1,11.12,14,5.64,5.64,0,0,1,9,14.45a5.23,5.23,0,0,1-1.94-.37A5.27,5.27,0,0,1,4.21,11.6,5.1,5.1,0,0,1,3.59,9.73Z"
    class="${q.ClassNames.Component}"
    fill="#ffffff"></path>
`,Wx=`<g id="winner">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path class="cls-4" d="M4.35,12.66,2.86,7.72a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,7.34a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21.05L6.27,9.15l.14,0h.14a.31.31,0,0,0,.13-.06A.48.48,0,0,0,6.77,9L8.69,5.54a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18L11.22,9a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21-.05.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.37.37,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.66Z"></path>
    </g>
    <path class="undefined" fill-rule="evenodd" d="M4.35,12.06,2.86,7.12a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,6.74a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21,0L6.27,8.55l.14,0h.14a.31.31,0,0,0,.13-.06.48.48,0,0,0,.09-.11L8.69,4.94a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18l1.91,3.48a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21,0,.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.38.38,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.06Z"></path>
  </g>`,Gx=`<g id="winner-white" fill="#fff">
    <g>
      <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${q.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
      <path class="cls-4" d="M4.35,12.66,2.86,7.72a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,7.34a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21.05L6.27,9.15l.14,0h.14a.31.31,0,0,0,.13-.06A.48.48,0,0,0,6.77,9L8.69,5.54a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18L11.22,9a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21-.05.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.37.37,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.66Z"></path>
    </g>
    <path class="undefined" fill-rule="evenodd" d="M4.35,12.06,2.86,7.12a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,6.74a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21,0L6.27,8.55l.14,0h.14a.31.31,0,0,0,.13-.06.48.48,0,0,0,.09-.11L8.69,4.94a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18l1.91,3.48a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21,0,.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.38.38,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.06Z"></path>
  </g>`,Kx=`<g id="interesting">
    <path class="${q.ClassNames.Shadow}" d="m9 .5a9 9 0 1 0 9 9 9 9 0 0 0 -9-9z" opacity="0.3"></path>
    <path  class="${q.ClassNames.Background}" d="m0 9a9 9 0 1 0 9-9 9 9 0 0 0 -9 9z" fill="#7979a1"></path>
    <g  class="${q.ClassNames.Component}" opacity=".2">
      <path d="m4.75 12.9a.28.28 0 0 1 0-.13.25.25 0 0 1 .08-.1.33.33 0 0 1 .23-.1h2 .12l.11.08a.36.36 0 0 1 .07.1.59.59 0 0 1 0 .13v1.9a.36.36 0 0 1 -.09.24.27.27 0 0 1 -.1.08h-.13-2-.12a.44.44 0 0 1 -.19-.19.28.28 0 0 1 0-.13zm-.06-8.8a.41.41 0 0 1 .08-.24.35.35 0 0 1 .23-.1h2.14.13l.11.08a.5.5 0 0 1 .09.24l-.15 6.77c0 .21-.15.31-.34.31h-1.78a.3.3 0 0 1 -.2-.06.3.3 0 0 1 -.1-.1.31.31 0 0 1 0-.13z"/><path d="m12.39 14.82a.25.25 0 0 1 0 .12.28.28 0 0 1 -.08.11l-.1.07h-.12-1.91a.27.27 0 0 1 -.13 0 .39.39 0 0 1 -.05-.12.35.35 0 0 1 -.08-.22v-1.78a.32.32 0 0 1 .09-.23l.1-.07h.12 1.89a.33.33 0 0 1 .23.09.61.61 0 0 1 .07.1.27.27 0 0 1 0 .13zm2.2-7.17a2.49 2.49 0 0 1 -.36.73 4.51 4.51 0 0 1 -.48.6 6 6 0 0 1 -.52.49q-.39.34-.66.63a1 1 0 0 0 -.27.7v.2a.22.22 0 0 1 0 .12.35.35 0 0 1 -.17.17.2.2 0 0 1 -.11 0h-1.75-.12a.23.23 0 0 1 -.1-.07.26.26 0 0 1 -.07-.1.22.22 0 0 1 .02-.12v-.35a2.41 2.41 0 0 1 .12-.84 2.91 2.91 0 0 1 .33-.66 3.38 3.38 0 0 1 .45-.55l.49-.42a6.55 6.55 0 0 0 .61-.62 1 1 0 0 0 .26-.67.66.66 0 0 0 -.08-.34.64.64 0 0 0 -.18-.27 1.18 1.18 0 0 0 -.77-.28 1.66 1.66 0 0 0 -.49.07 3 3 0 0 0 -.41.18 2.29 2.29 0 0 0 -.29.18l-.1.09a.53.53 0 0 1 -.24.06c-.12 0-.19-.07-.21-.13l-1-1.21a.29.29 0 0 1 0-.4 1.36 1.36 0 0 1 .21-.2 3 3 0 0 1 .55-.38 5.87 5.87 0 0 1 .9-.37 3.75 3.75 0 0 1 1.2-.17 4.12 4.12 0 0 1 1.2.19 4 4 0 0 1 1.09.56 2.73 2.73 0 0 1 .77.92 2.7 2.7 0 0 1 .29 1.28 2.72 2.72 0 0 1 -.11.98z"/></g><g fill="#fff"><path d="m4.75 12.4a.28.28 0 0 1 0-.13.25.25 0 0 1 .08-.1.33.33 0 0 1 .23-.1h2 .12l.11.08a.36.36 0 0 1 .07.1.59.59 0 0 1 0 .13v1.9a.36.36 0 0 1 -.09.24.27.27 0 0 1 -.1.08h-.13-2-.12a.44.44 0 0 1 -.19-.19.28.28 0 0 1 0-.13zm-.06-8.8a.41.41 0 0 1 .08-.24.35.35 0 0 1 .23-.1h2.14.13l.11.08a.5.5 0 0 1 .09.24l-.15 6.77c0 .21-.15.31-.34.31h-1.78a.3.3 0 0 1 -.2-.06.3.3 0 0 1 -.07-.1.31.31 0 0 1 0-.13z"/><path d="m12.39 14.32a.25.25 0 0 1 0 .12.28.28 0 0 1 -.08.11l-.1.07h-.12-1.91a.27.27 0 0 1 -.13 0 .39.39 0 0 1 -.1-.08.35.35 0 0 1 -.08-.22v-1.83a.32.32 0 0 1 .09-.23l.1-.07h.12 1.89a.33.33 0 0 1 .23.09.61.61 0 0 1 .07.1.27.27 0 0 1 0 .13zm2.2-7.17a2.49 2.49 0 0 1 -.36.73 4.51 4.51 0 0 1 -.48.6 6 6 0 0 1 -.52.49q-.39.34-.66.63a1 1 0 0 0 -.27.7v.22a.22.22 0 0 1 0 .12.35.35 0 0 1 -.17.17.2.2 0 0 1 -.11 0h-1.75-.12a.23.23 0 0 1 -.1-.07.26.26 0 0 1 -.07-.1.22.22 0 0 1 0-.12v-.35a2.41 2.41 0 0 1 .12-.84 2.91 2.91 0 0 1 .33-.66 3.38 3.38 0 0 1 .45-.55l.49-.42a6.55 6.55 0 0 0 .63-.64 1 1 0 0 0 .26-.67.66.66 0 0 0 -.08-.34.64.64 0 0 0 -.18-.27 1.18 1.18 0 0 0 -.73-.24 1.66 1.66 0 0 0 -.49.07 3 3 0 0 0 -.41.18 2.29 2.29 0 0 0 -.37.21l-.1.09a.53.53 0 0 1 -.24.06c-.12 0-.19-.07-.21-.13l-1-1.21a.29.29 0 0 1 0-.4 1.36 1.36 0 0 1 .21-.2 3 3 0 0 1 .55-.38 5.87 5.87 0 0 1 .9-.37 3.75 3.75 0 0 1 1.2-.17 4.12 4.12 0 0 1 1.2.19 4 4 0 0 1 1.16.52 2.73 2.73 0 0 1 .77.92 2.7 2.7 0 0 1 .29 1.28 2.72 2.72 0 0 1 -.14.95z"/>
    </g>
  </g>`,qx=`<g id="warning">
    <g>
      <g class="${q.ClassNames.Shadow}" opacity="0.3">
        <path d="M.32,14.3,6.94,2.83a2.37,2.37,0,0,1,4.11,0L17.68,14.3a2.38,2.38,0,0,1-2.06,3.56H2.38A2.38,2.38,0,0,1,.32,14.3Z"></path>
      </g>
      <path class="${q.ClassNames.Background}" fill="#ec6250" d="M.32,13.8,6.94,2.33a2.37,2.37,0,0,1,4.11,0L17.68,13.8a2.38,2.38,0,0,1-2.06,3.56H2.38A2.38,2.38,0,0,1,.32,13.8Z"></path>
    </g>
    <g>
      <g class="${q.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M10.21,15.19a.5.5,0,0,1,0,.12.26.26,0,0,1-.07.1.31.31,0,0,1-.22.09H8.1a.25.25,0,0,1-.12,0,.31.31,0,0,1-.09-.07.35.35,0,0,1-.08-.22V13.45a.29.29,0,0,1,.09-.21A.22.22,0,0,1,8,13.17l.11,0H9.9a.31.31,0,0,1,.22.09.27.27,0,0,1,.09.21ZM10.1,11.6a.22.22,0,0,1,0,.11.23.23,0,0,1-.07.1.27.27,0,0,1-.21.07H8.18a.29.29,0,0,1-.31-.28L7.73,5.41a.35.35,0,0,1,.08-.22.23.23,0,0,1,.1-.07A.25.25,0,0,1,8,5.1H10a.32.32,0,0,1,.23.09.35.35,0,0,1,.08.22Z"></path>
      </g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M10.21,14.69a.5.5,0,0,1,0,.12.26.26,0,0,1-.07.1A.31.31,0,0,1,9.9,15H8.1A.25.25,0,0,1,8,15a.31.31,0,0,1-.09-.07.35.35,0,0,1-.08-.22V13a.29.29,0,0,1,.09-.21A.22.22,0,0,1,8,12.67l.11,0H9.9a.31.31,0,0,1,.22.09.27.27,0,0,1,.09.21ZM10.1,11.1a.22.22,0,0,1,0,.11.23.23,0,0,1-.07.1.27.27,0,0,1-.21.07H8.18a.29.29,0,0,1-.31-.28L7.73,4.91a.35.35,0,0,1,.08-.22.23.23,0,0,1,.1-.07A.25.25,0,0,1,8,4.6H10a.32.32,0,0,1,.23.09.35.35,0,0,1,.08.22Z"></path>
    </g>
  </g>`,Jx=`<g id="equal">
    <path class="${q.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"/>
    <path class="${q.ClassNames.Background}" fill="#a88865" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"/>
    <g class="${q.ClassNames.ComponentShadow}" opacity="0.4">
      <path d="M5.31,8.36l-.15,0A.57.57,0,0,1,5,8.25.57.57,0,0,1,5,8.12a.4.4,0,0,1,0-.15V6a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V8a.4.4,0,0,1,0,.15.57.57,0,0,1-.08.13.57.57,0,0,1-.13.08l-.15,0Z"/>
      <path d="M5.31,13.36l-.15,0A.57.57,0,0,1,5,13.25.57.57,0,0,1,5,13.12a.4.4,0,0,1,0-.15V11a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V13a.4.4,0,0,1,0,.15.33.33,0,0,1-.21.21l-.15,0Z"/>
    </g>
    <g>
      <path class="${q.ClassNames.Component}" fill="#f1f2f2" d="M5.31,7.86l-.15,0A.57.57,0,0,1,5,7.75.57.57,0,0,1,5,7.62a.4.4,0,0,1,0-.15V5.53a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V7.47a.4.4,0,0,1,0,.15.57.57,0,0,1-.08.13.57.57,0,0,1-.13.08l-.15,0Z"/>
      <path class="${q.ClassNames.Component}" fill="#f1f2f2" d="M5.31,12.86l-.15,0A.57.57,0,0,1,5,12.75.57.57,0,0,1,5,12.62a.4.4,0,0,1,0-.15V10.53a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39v1.94a.4.4,0,0,1,0,.15.33.33,0,0,1-.21.21l-.15,0Z"/>
    </g>
  </g>`,Yx={[Cb.Alternative]:fx,[Cb.BestMove]:px,[Cb.Blunder]:mx,[Cb.Book]:hx,[Cb.Brilliant]:gx,[Cb.CheckmateBlack]:_x,[Cb.CheckmateWhite]:vx,[Cb.Correct]:yx,[Cb.Critical]:bx,[Cb.DrawBlack]:xx,[Cb.DrawWhite]:Sx,[Cb.Excellent]:Cx,[Cb.FastWin]:wx,[Cb.Forced]:Ox,[Cb.FreePiece]:Tx,[Cb.Gamechanger]:Ex,[Cb.Good]:kx,[Cb.GreatFind]:Dx,[Cb.Inaccuracy]:Ax,[Cb.Incorrect]:jx,[Cb.Mate]:Mx,[Cb.Miss]:Nx,[Cb.MissedWin]:Px,[Cb.Mistake]:Fx,[Cb.ResignBlack]:Ix,[Cb.ResignWhite]:Lx,[Cb.Sharp]:Rx,[Cb.Takeback]:zx,[Cb.Threat]:Bx,[Cb.TimeoutBlack]:Vx,[Cb.TimeoutWhite]:Hx,[Cb.Undo]:Ux,[Cb.Winner]:Wx,[Cb.WinnerWhite]:Gx,[Cb.Interesting]:Kx,[Cb.Warning]:qx,[Cb.Equal]:Jx},Xx=`<g id="Brilliant">
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M12.57,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.34A.41.41,0,0,1,10,14.1V12.2A.32.32,0,0,1,10,12a.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.4A.36.36,0,0,1,10,3.16a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M8.07,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2A.31.31,0,0,1,8,12a.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.17a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
    </g>
  </g>`,Zx=`<g id="great_find">
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M10.32,14.1a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
    </g>
  </g>`,Qx=`<g id="inaccuracy">
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M13.66,14.3a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.3V12.4a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,3.6A.5.5,0,0,1,11,3.36l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M7.65,14.32a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.49a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6A4.85,4.85,0,0,1,8.48,9a8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24A1.61,1.61,0,0,0,6,5.61a3,3,0,0,0-.41.18A1.75,1.75,0,0,0,5.3,6l-.11.09A.5.5,0,0,1,5,6.12.31.31,0,0,1,4.74,6l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.18a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17A3.92,3.92,0,0,1,8.93,4a2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.21,3,3,0,0,1,9.85,7.15Z"></path>
    </g>
  </g>`,$x=`<g id="mistake">
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M9.92,14.52a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.69a.32.32,0,0,1,.09-.23l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35a2.42,2.42,0,0,1,.13-.84,2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34A.75.75,0,0,0,9.48,6a1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07A3,3,0,0,0,7.86,6a1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.19L6,5a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2A3.07,3.07,0,0,1,6.81,4a5.38,5.38,0,0,1,.89-.37,3.75,3.75,0,0,1,1.2-.17,4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.35Z"></path>
    </g>
  </g>`,eS=`<g id="blunder">
    <g>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M14.74,5A2.58,2.58,0,0,0,14,4a3.76,3.76,0,0,0-1.09-.56,4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06L10.37,6a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.3a1,1,0,0,1,.26-.7q.27-.28.66-.63a5.79,5.79,0,0,0,.51-.48,4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M12.38,12.15H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.15Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M6.79,12.15H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,14.51a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.15Z"></path>
      <path class="${q.ClassNames.Component}" fill="#fff" d="M8.39,4A3.76,3.76,0,0,0,7.3,3.48a4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06L4.78,6a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,5.56a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.4a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1.5.5,0,0,0,0-.12V10.3a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9c.18-.15.35-.31.52-.48A7,7,0,0,0,9,7.89a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1A2.66,2.66,0,0,0,9.15,5,2.58,2.58,0,0,0,8.39,4Z"></path>
    </g>
  </g>`,tS={[Cb.Brilliant]:Xx,[Cb.GreatFind]:Zx,[Cb.BestMove]:Xx,[Cb.Excellent]:Xx,[Cb.Good]:Xx,[Cb.Book]:Xx,[Cb.Inaccuracy]:Qx,[Cb.Mistake]:$x,[Cb.Miss]:Xx,[Cb.Blunder]:eS},nS={Brilliant:`Brilliant!!`,GreatFind:`Great!`,Inaccuracy:`Inaccuracy`,Mistake:`Mistake`,Blunder:`Blunder`},(e=>{e.FlipBoardModifierKey=`x`,(e=>{e.Name=`flip-board`})(e.Plugin||={})})(rS||={}),(e=>{(e=>{e.Name=`keys`})(e.Plugin||={}),(e=>{e.Keydown=`Keydown`,e.Keyup=`Keyup`})(e.Events||={})})(iS||={}),aS=(e=>(e.Alt=`a`,e.Ctrl=`l`,e.Custom=`c`,e.Default=`d`,e.Shift=`s`,e))(aS||{}),(e=>{(e=>{e.$1=`$1`,e.$2=`$2`,e.$3=`$3`,e.$4=`$4`,e.$5=`$5`,e.$6=`$6`,e.$9=`$9`,e.$10=`$10`,e.$11=`$11`,e.$12=`$12`,e.$13=`$13`,e.$14=`$14`,e.$15=`$15`,e.$16=`$16`,e.$17=`$17`,e.$18=`$18`,e.$19=`$19`,e.$22=`$22`,e.$23=`$23`,e.$32=`$32`,e.$33=`$33`,e.$36=`$36`,e.$37=`$37`,e.$40=`$40`,e.$41=`$41`,e.$44=`$44`,e.$45=`$45`,e.$132=`$132`,e.$133=`$133`,e.$138=`$138`,e.$146=`$146`,e.$222=`$222`,e.$256=`$256`})(e.Nags||={}),(e=>{e.$1=`!`,e.$2=`?`,e.$3=`!!`,e.$4=`??`,e.$5=`!?`,e.$6=`?!`,e.$9=``,e.$10=`=`,e.$11=`=`,e.$12=`=`,e.$13=``,e.$14=``,e.$15=``,e.$16=``,e.$17=``,e.$18=`+-`,e.$19=`-+`,e.$22=``,e.$23=``,e.$32=``,e.$33=``,e.$36=``,e.$37=``,e.$40=``,e.$41=``,e.$44=`/=`,e.$45=`=/`,e.$132=``,e.$133=``,e.$138=``,e.$146=`N`,e.$222=``,e.$256=`=/`})(e.Values||={}),(e=>{e.GreatFind=`!`,e.Mistake=`?`,e.Brilliant=`!!`,e.Blunder=`??`,e.Interesting=`!?`,e.Inaccuracy=`?!`})(e.Effects||={}),(e=>{e.Drawish=`=`,e.Unclear=``,e.WhiteHasModerateAdvantage=``,e.BlackHasModerateAdvantage=``,e.WhiteHasDecisiveAdvantage=`+-`,e.BlackHasDecisiveAdvantage=`-+`,e.PositionInZugzwang=``,e.WithCompensation=``,e.Novelty=`N`,e.WithAttack=`=/`})(e.Additional||={})})(oS||={}),sS=[K.APIEvents.CreateGame,K.APIEvents.CreateContinuation,K.APIEvents.DeletePosition,K.APIEvents.Load,K.APIEvents.Move,K.APIEvents.MoveBackward,K.APIEvents.MoveForward,K.APIEvents.MoveVariation,K.APIEvents.PromoteVariation,K.APIEvents.SelectLineEnd,K.APIEvents.SelectLineStart,K.APIEvents.SelectNode,K.APIEvents.Reload,K.APIEvents.ResetToMainLine,K.APIEvents.Undo],cS=e=>(t,n)=>{n.api.getOptions().syncEffects&&e(t,n)},lS=[{condition:Ct(sS),handler:Nr},{condition:xt(K.APIEvents.Mark),handler:cS(jr)},{condition:xt(K.APIEvents.Unmark),handler:cS(Mr)},{condition:xt(K.APIEvents.Load),handler:cS(Pr)},{condition:xt(K.APIEvents.NodeUpdated),handler:cS(Fr)}],(e=>{(e=>{e.Name=`markings`})(e.Plugin||={})})(uS||={}),(e=>{(e=>{ __set$(e,e.White=1,`White`) , __set$(e,e.Black=2,`Black`) })(e.ColorsAsNumbers||={}),(e=>{e.Bughouse=`bughouse`,e.Chess=`chess`,e.Chess960=`chess960`,e.Crazyhouse=`crazyhouse`,e.KingOfTheHill=`kingofthehill`,e.ThreeCheck=`threecheck`})(e.Variants||={}),e.JCEVariantTypes={bughouse:`Bughouse`,chess:`Chess`,chess960:`Chess960`,crazyhouse:`Crazyhouse`,threecheck:`3-check`,kingofthehill:`King of the Hill`},(e=>{e.White=`w`,e.Black=`b`})(e.ColorsAsLetters||={}),(e=>{e.White=`white`,e.Black=`black`})(e.ColorsAsWords||={}),e.DefaultTimeControl=5,(e=>{e.Black=`?`,e.Event=`?`,e.Date=`????.??.??`,e.Site=`?`,e.Value=`?`,e.Result=`*`,e.Round=`?`,e.White=`?`})(e.EmptyPGNHeaders||={}),(e=>{(e=>{ __set$(e,e.Capture=1,`Capture`) , __set$(e,e.BigPawn=2,`BigPawn`) , __set$(e,e.EPCapture=4,`EPCapture`) , __set$(e,e.AnyCapture=5,`AnyCapture`) , __set$(e,e.Promotion=8,`Promotion`) , __set$(e,e.CapturePromotion=9,`CapturePromotion`) , __set$(e,e.KingsideCastle=16,`KingsideCastle`) , __set$(e,e.QueensideCastle=32,`QueensideCastle`) , __set$(e,e.AnyCastle=48,`AnyCastle`) , __set$(e,e.Drop=64,`Drop`) , __set$(e,e.DropOrCapture=69,`DropOrCapture`) , __set$(e,e.DropOrPromote=72,`DropOrPromote`) })(e.Flags||={}),(e=>{ __set$(e,e.Capture=0,`Capture`) , __set$(e,e.Castle=1,`Castle`) , __set$(e,e.Check=2,`Check`) , __set$(e,e.Checkmate=3,`Checkmate`) , __set$(e,e.Normal=4,`Normal`) , __set$(e,e.Premove=5,`Premove`) , __set$(e,e.Promotion=6,`Promotion`) })(e.Types||={})})(e.Move||={}),(e=>{(e=>{(e=>{(e=>{(e=>{e.Arrows=`arrows`,e.Effects=`effects`,e.Pieces=`pieces`})(e.Targets||={}),(e=>{e.Above=`above`,e.Below=`below`})(e.Positions||={})})(e.VisualOrder||={}),(e=>{e.Image=`Image`,e.Star=`Star`,e.TextBox=`TextBox`})(e.Types||={})})(e.CustomItem||={}),(e=>{e.alt=`a`,e.custom=`c`,e.default=`d`,e.shift=`s`,e.ctrl=`l`})(e.ColorKeys||={}),(e=>{e.a=`alt`,e.c=`custom`,e.d=`default`,e.s=`shift`,e.l=`ctrl`})(e.JCEColorsMap||={}),(e=>{e.Arrow=`arrow`,e.Effect=`effect`,e.Square=`square`,e.CustomItem=`customItem`})(e.Types||={})})(e.Marking||={})})(e.Node||={}),(e=>{(e=>{e.p=`pawn`,e.n=`knight`,e.b=`bishop`,e.r=`rook`,e.q=`queen`,e.k=`king`})(e.Names||={}),(e=>{e.Pawn=`p`,e.Knight=`n`,e.Bishop=`b`,e.Rook=`r`,e.Queen=`q`,e.King=`k`})(e.Types||={})})(e.Piece||={}),(e=>{(e=>{e.Color=`#ffff00`, __set$(e,e.Opacity=.5,`Opacity`) })(e.Defaults||={}),(e=>{e.Analysis=`analysis`,e.Move=`move`,e.Premove=`premove`,e.Selection=`selection`})(e.Types||={})})(e.Highlight||={}),(e=>{e.Blitz=`blitz`,e.Bullet=`bullet`,e.Rapid=`rapid`})(e.TimeControlTypes||={}),(e=>{e.Black=`0-1`,e.Draw=`1/2-1/2`,e.None=`*`,e.White=`1-0`})(e.Results||={})})(J||={}),(e=>{(e=>{e.StateDesynchronisation=`StateDesynchronisation`})(e.ErrorCodes||={}),(e=>{e.Name=`rendererErrorCatcher`})(e.Plugin||={})})(dS||={}),fS=()=>!1,pS=[Ib.BoardSounds.GameStart,Ib.BoardSounds.GameEnd,Ib.BoardSounds.Capture,Ib.BoardSounds.Castle,Ib.BoardSounds.Premove,Ib.BoardSounds.MoveSelf,Ib.BoardSounds.MoveCheck,Ib.BoardSounds.MoveOpponent,Ib.BoardSounds.Promote,Ib.BoardSounds.Notify,Ib.BoardSounds.TenSeconds,Ib.BoardSounds.Illegal],(e=>{(e=>{e.Shift=`Shift`,e.Control=`Control`,e.Alt=`Alt`,e.Meta=`Meta`})(e.Modifiers||={})})(mS||={}),hS=[`Escape`,`Tab`,`Backspace`,`Enter`,`Backlash`,`Period`,`Slash`,`Comma`,`Space`,`Delete`,`Home`,`End`,`PageUp`,`PageDown`,`ArrowUp`,`Numpad8`,`ArrowDown`,`Numpad5`,`ArrowLeft`,`Numpad4`,`ArrowRight`,`Numpad6`],gS=[`meta`,`alt`,`control`],(e=>{e.DefaultAcceptableFrequency=1e3,(e=>{e.Name=`webgl-context-lost`})(e.Plugin||={})})(_S||={}),(e=>{(e=>{e.Name=`recorder`})(e.Plugin||={}),(e=>{e.Idle=`Idle`,e.Playing=`Playing`,e.Recording=`Recording`})(e.Mode||={})})(vS||={}),yS=[{name:`addMoveToEndOfLine`},{name:`agreeDraw`},{name:`blinkSquare`},{name:`claimDraw`},{name:`clearMarkings`},{name:`createContinuation`},{name:`createGame`},{name:`setPlayingAs`},{name:`usePlayingAs`},{name:`deletePosition`},{name:`load`},{name:`mark`},{name:`move`},{name:`moveBackward`},{name:`moveForward`},{name:`moveVariation`},{name:`outOfTime`},{name:`promoteVariation`},{name:`reload`},{name:`resetGame`},{name:`resetToMainLine`},{name:`resign`},{name:`selectLineEnd`},{name:`selectLineStart`},{name:`selectNode`},{name:`setGameDetails`},{name:`setResult`},{name:`setTurn`},{name:`toggleMarking`},{name:`undo`},{name:`unmark`},{name:`updateLineComment`},{name:`updateNode`},{name:`setOptions`},{name:`setMode`},{name:`playSound`},{namespace:`arrowKeys`,name:`setKeys`},{namespace:`arrowKeys`,name:`resetKeys`},{namespace:`boardImages`,name:`mark`},{namespace:`boardImages`,name:`unmark`},{namespace:`boardImages`,name:`showWindow`},{namespace:`boardImages`,name:`hideWindow`},{namespace:`clocks`,name:`activate`},{namespace:`clocks`,name:`deactivate`},{namespace:`clocks`,name:`resetClocks`},{namespace:`clocks`,name:`stopClocks`},{namespace:`hml`,name:`addDiagramActions`},{namespace:`hml`,name:`addCommentLink`},{namespace:`hml`,name:`setScrollContainer`},{namespace:`hml`,name:`updateNodeLimits`},{namespace:`keys`,name:`setOverrides`},{namespace:`keys`,name:`removeOverrides`},{namespace:`premoves`,name:`cancel`},{namespace:`premoves`,name:`consumeNext`},{namespace:`premoves`,name:`loadQueue`},{namespace:`premoves`,name:`move`},{namespace:`premoves`,name:`reload`},{namespace:`threats`,name:`enable`},{namespace:`threats`,name:`onlyShowThreatsCreatedByColor`},{namespace:`vml`,name:`activate`},{namespace:`vml`,name:`deactivate`},{namespace:`vml`,name:`waitForVMLReady`},{namespace:`markings`,name:`addMany`},{namespace:`markings`,name:`addOne`},{namespace:`markings`,name:`removeAll`},{namespace:`markings`,name:`removeAllWhere`},{namespace:`markings`,name:`removeMany`},{namespace:`markings`,name:`removeOne`},{namespace:`markings`,name:`toggleMany`},{namespace:`markings`,name:`toggleOne`}],bS={mode:vS.Mode.Idle,recordEvents:!1,lastRecordedEventTime:0,verbose:!1,playState:{playCounter:0,initDirty:!1,playedEvents:[]},recording:{events:[],pgn:``,modeName:``,variant:``,modeOptions:{},boardOptions:{},plugins:[],timestamp:``}},xS=`move`,SS=`80c9e98e8c9de27d1d064928dd7b5415`,wS=`IS_POPULATED`,TS=`VERSION`,ES=(e=>(e.ECO=`chesscom_eco`,e))(ES||{}),DS=(e=>(e.ECO=`eco`,e))(DS||{}),OS={get:e=>fetch(e,{method:`GET`}).then(e=>e.json())},kS=1,AS=`premove`,(e=>{(e=>{(e=>{e.ClearAllAnalysis=`Clear All Analysis`,e.DeleteCommentAfter=`Delete Comment After`,e.DeleteCommentBefore=`Delete Comment Before`,e.DeleteComment=`Delete Comment`,e.DeleteLine=`Delete Entire Variation`,e.DeleteMove=`Delete Move`,e.InsertComment=`Comment`,e.InsertCommentAfter=`Comment After`,e.InsertCommentBefore=`Comment Before`,e.InsertContinuation=`Insert Continuation`,e.MoveVariationDown=`Move Variation Down`,e.MoveVariationUp=`Move Variation Up`,e.Promote=`Promote`,e.RemoveAnnotation=`Remove Annotation`,e.ShowAllAnnotations=`Show All Annotations`,e.HideAllAnnotations=`Hide All Annotations`,e.RemoveBegin=`Remove Begin`,e.RemoveEnd=`Remove End`,e.RemoveEvaluationAnnotation=`Remove Evaluation Annotation`,e.RemoveFocus=`Remove Focus`,e.SetBegin=`Set Begin`,e.SetEnd=`Set End`,e.SetFocus=`Set Focus`})(e.Actions||={}),(e=>{e.BadMove=`Bad move`,e.BlackHasDecisiveAdvantage=`Black has a decisive advantage`,e.BlackHasModerateAdvantage=`Black has a moderate advantage`,e.BlackHasSlightAdvantage=`Black has a slight advantage`,e.Blunder=`Blunder`,e.Drawish=`Drawish`,e.DubiousMove=`Dubious move`,e.ExcellentMove=`Excellent move`,e.GoodMove=`Good move`,e.Miss=`Miss`,e.Novelty=`Novelty`,e.Unclear=`Unclear`,e.PositionInZuqZwang=`The position is in zugzwang`,e.SpeculativeMove=`Speculative move`,e.WhiteHasSlightAdvantage=`White has a slight advantage`,e.WhiteHasModerateAdvantage=`White has a moderate advantage`,e.WhiteHasDecisiveAdvantage=`White has a decisive advantage`,e.WithInitiative=`With initiative`,e.WithCompensation=`With compensation`,e.WithAttack=`With an attack`,e.TimeTrouble=`Time trouble`,e.Counterplay=`Counterplay`,e.DevelopmentLead=`Development lead`})(e.Annotations||={}),(e=>{e.B=`B`,e.K=`K`,e.N=`N`,e.P=`P`,e.Q=`Q`,e.R=`R`})(e.Pieces||={}),(e=>{e.NumberOfDays=`numberOfDays`,e.NumberOfHours=`numberOfHours`,e.NumberOfMinutes=`numberOfMinutes`})(e.Plural||={}),(e=>{e.AddComment=`Add Comment...`})(e.Prompt||={}),(e=>{e.FiftyMove=`Fifty moves were played with no capture or pawn move, so the game ended in a draw.`,e.InsufficientMaterial=`Neither player had enough material to force checkmate, so the game ended in a draw.`,e.WhiteTimeoutVsInsufficientMaterial=`Although White ran out of time, Black did not have sufficient material to ever force checkmate, so the game ended in a draw.`,e.BlackTimeoutVsInsufficientMaterial=`Although Black ran out of time, White did not have sufficient material to ever force checkmate, so the game ended in a draw.`,e.DrawByAgreement=`The game has been drawn by agreement.`,e.Stalemate=`A draw by stalemate occurs when the player whose turn it is has no legal moves, but their king is not in check.`,e.EnPassant=`En passant is a special pawn move by which a pawn captures another pawn that has advanced two squares.`,e.ThreeFoldRepetition=`This game ended in a draw because the same position was repeated three times.`})(e.Tooltips||={}),(e=>{e.TimeoutVsInsufficientMaterial=`Game drawn by timeout vs insufficient material`,e.DrawByAgreement=`Game drawn by agreement`})(e.GameTerminationMessages||={})})(e.Translation||={}),(e=>{e.HML=`hml`,e.VML=`vml`,e.MOVE_LIST=`move-list`})(e.Types||={})})(Y||={}),jS={[Y.Translation.Prompt.AddComment]:()=>Y.Translation.Prompt.AddComment,[Y.Translation.Annotations.BadMove]:()=>Y.Translation.Annotations.BadMove,[Y.Translation.Annotations.BlackHasDecisiveAdvantage]:()=>Y.Translation.Annotations.BlackHasDecisiveAdvantage,[Y.Translation.Annotations.BlackHasModerateAdvantage]:()=>Y.Translation.Annotations.BlackHasModerateAdvantage,[Y.Translation.Annotations.BlackHasSlightAdvantage]:()=>Y.Translation.Annotations.BlackHasSlightAdvantage,[Y.Translation.Annotations.Blunder]:()=>Y.Translation.Annotations.Blunder,[Y.Translation.Actions.ClearAllAnalysis]:()=>Y.Translation.Actions.ClearAllAnalysis,[Y.Translation.Actions.DeleteCommentAfter]:()=>Y.Translation.Actions.DeleteCommentAfter,[Y.Translation.Actions.DeleteCommentBefore]:()=>Y.Translation.Actions.DeleteCommentBefore,[Y.Translation.Actions.DeleteComment]:()=>Y.Translation.Actions.DeleteComment,[Y.Translation.Actions.DeleteLine]:()=>Y.Translation.Actions.DeleteLine,[Y.Translation.Actions.DeleteMove]:()=>Y.Translation.Actions.DeleteMove,[Y.Translation.Annotations.Drawish]:()=>Y.Translation.Annotations.Drawish,[Y.Translation.Annotations.DubiousMove]:()=>Y.Translation.Annotations.DubiousMove,[Y.Translation.Annotations.ExcellentMove]:()=>Y.Translation.Annotations.ExcellentMove,[Y.Translation.Tooltips.EnPassant]:()=>Y.Translation.Tooltips.EnPassant,[Y.Translation.Tooltips.Stalemate]:()=>Y.Translation.Tooltips.Stalemate,[Y.Translation.Tooltips.InsufficientMaterial]:()=>Y.Translation.Tooltips.InsufficientMaterial,[Y.Translation.Tooltips.FiftyMove]:()=>Y.Translation.Tooltips.FiftyMove,[Y.Translation.Tooltips.WhiteTimeoutVsInsufficientMaterial]:()=>Y.Translation.Tooltips.WhiteTimeoutVsInsufficientMaterial,[Y.Translation.Tooltips.BlackTimeoutVsInsufficientMaterial]:()=>Y.Translation.Tooltips.BlackTimeoutVsInsufficientMaterial,[Y.Translation.Tooltips.DrawByAgreement]:()=>Y.Translation.Tooltips.DrawByAgreement,[Y.Translation.Annotations.GoodMove]:()=>Y.Translation.Annotations.GoodMove,[Y.Translation.Actions.InsertCommentAfter]:()=>Y.Translation.Actions.InsertCommentAfter,[Y.Translation.Actions.InsertCommentBefore]:()=>Y.Translation.Actions.InsertCommentBefore,[Y.Translation.Actions.InsertComment]:()=>Y.Translation.Actions.InsertComment,[Y.Translation.Actions.InsertContinuation]:()=>Y.Translation.Actions.InsertContinuation,[Y.Translation.Annotations.Miss]:()=>Y.Translation.Annotations.Miss,[Y.Translation.Actions.MoveVariationDown]:()=>Y.Translation.Actions.MoveVariationDown,[Y.Translation.Actions.MoveVariationUp]:()=>Y.Translation.Actions.MoveVariationUp,[Y.Translation.Actions.ShowAllAnnotations]:()=>Y.Translation.Actions.ShowAllAnnotations,[Y.Translation.Actions.HideAllAnnotations]:()=>Y.Translation.Actions.HideAllAnnotations,[Y.Translation.Annotations.Novelty]:()=>Y.Translation.Annotations.Novelty,[Y.Translation.Pieces.B]:()=>Y.Translation.Pieces.B,[Y.Translation.Pieces.K]:()=>Y.Translation.Pieces.K,[Y.Translation.Pieces.N]:()=>Y.Translation.Pieces.N,[Y.Translation.Pieces.P]:()=>Y.Translation.Pieces.P,[Y.Translation.Pieces.Q]:()=>Y.Translation.Pieces.Q,[Y.Translation.Pieces.R]:()=>Y.Translation.Pieces.R,[Y.Translation.Actions.Promote]:()=>Y.Translation.Actions.Promote,[Y.Translation.Actions.RemoveAnnotation]:()=>Y.Translation.Actions.RemoveAnnotation,[Y.Translation.Actions.RemoveBegin]:()=>Y.Translation.Actions.RemoveBegin,[Y.Translation.Actions.RemoveEnd]:()=>Y.Translation.Actions.RemoveEnd,[Y.Translation.Actions.RemoveEvaluationAnnotation]:()=>Y.Translation.Actions.RemoveEvaluationAnnotation,[Y.Translation.Actions.RemoveFocus]:()=>Y.Translation.Actions.RemoveFocus,[Y.Translation.Actions.SetBegin]:()=>Y.Translation.Actions.SetBegin,[Y.Translation.Actions.SetEnd]:()=>Y.Translation.Actions.SetEnd,[Y.Translation.Actions.SetFocus]:()=>Y.Translation.Actions.SetFocus,[Y.Translation.Annotations.Counterplay]:()=>Y.Translation.Annotations.Counterplay,[Y.Translation.Annotations.DevelopmentLead]:()=>Y.Translation.Annotations.DevelopmentLead,[Y.Translation.Annotations.TimeTrouble]:()=>Y.Translation.Annotations.TimeTrouble,[Y.Translation.Annotations.SpeculativeMove]:()=>Y.Translation.Annotations.SpeculativeMove,[Y.Translation.Tooltips.ThreeFoldRepetition]:()=>Y.Translation.Tooltips.ThreeFoldRepetition,[Y.Translation.Annotations.PositionInZuqZwang]:()=>Y.Translation.Annotations.PositionInZuqZwang,[Y.Translation.Annotations.Unclear]:()=>Y.Translation.Annotations.Unclear,[Y.Translation.Annotations.WhiteHasDecisiveAdvantage]:()=>Y.Translation.Annotations.WhiteHasDecisiveAdvantage,[Y.Translation.Annotations.WhiteHasModerateAdvantage]:()=>Y.Translation.Annotations.WhiteHasModerateAdvantage,[Y.Translation.Annotations.WhiteHasSlightAdvantage]:()=>Y.Translation.Annotations.WhiteHasSlightAdvantage,[Y.Translation.Annotations.WithAttack]:()=>Y.Translation.Annotations.WithAttack,[Y.Translation.Annotations.WithCompensation]:()=>Y.Translation.Annotations.WithCompensation,[Y.Translation.Annotations.WithInitiative]:()=>Y.Translation.Annotations.WithInitiative,[Y.Translation.Plural.NumberOfDays]:e=>e===1?`${e} day`:`${e} days`,[Y.Translation.Plural.NumberOfHours]:e=>e===1?`${e} hr`:`${e} hrs`,[Y.Translation.Plural.NumberOfMinutes]:e=>e===1?`${e} min`:`${e} mins`,[Y.Translation.GameTerminationMessages.DrawByAgreement]:()=>Y.Translation.GameTerminationMessages.DrawByAgreement,[Y.Translation.GameTerminationMessages.TimeoutVsInsufficientMaterial]:()=>Y.Translation.GameTerminationMessages.TimeoutVsInsufficientMaterial},(e=>{(e=>{e.CircleInfo=`circle-info`,e.MoveInfoIcon=`move-info-icon`,e.ThreeFoldIcon=`redo`,e.IconFont=`icon-font-chess`,e.MoveList=`move-list`})(e.Classes||={}),(e=>{e.EnPassantIcon=`span`})(e.Tags||={}),(e=>{e.Color=`--nodeCustomColor`,e.TooltipTop=`--tooltip-top`})(e.CssVariables||={})})(MS||={}),NS=class extends ht{constructor(e){super(),Pe(this,e,Aa,ka,O,{color:0,san:1,textType:2,annotation:3})}},PS=()=>{},FS=class extends ht{constructor(e){super(),Pe(this,e,Ba,za,O,{eventHandlers:0,variationPopover:1,selectedNodeRect:2,textType:3})}},IS=7,(e=>{(e=>{e.Component=`move-list`})(e.Classes||={}),(e=>{e.TimeBarWidth=`--timeBarWidth`,e.TimeValue=`--timeValue`,e.MaxMoveTimeTaken=`--timeMaxValue`,e.TimestampWidth=`--timestampWidth`})(e.CSSVariables||={}),(e=>{e.WithBaseTime=`timestamps-with-base-time`,e.ToggleTimestamps=`toggle-timestamps`})(e.ClassNames||={}),(e=>{e.Node=`data-node`,e.Time=`data-time`,e.WholeMoveNumber=`data-whole-move-number`,e.VMLElement=`data-vml-element`})(e.Attributes||={}),e.Constants={CommentUpdateDelay:500}})(LS||={}),(e=>{(e=>{e.ClearAnalysis=`ClearAnalysis`,e.DeleteComment=`DeleteComment`,e.DeleteCommentBefore=`DeleteCommentBefore`,e.DeleteMove=`DeleteMove`,e.DeleteVariation=`DeleteVariation`,e.InsertComment=`InsertComment`,e.InsertCommentBefore=`InsertCommentBefore`,e.InsertContinuation=`InsertContinuation`,e.MoveVariationDown=`MoveVariationDown`,e.MoveVariationUp=`MoveVariationUp`,e.PromoteVariation=`PromoteVariation`,e.RemoveAnnotation=`RemoveAnnotation`,e.RemoveBegin=`RemoveBegin`,e.RemoveEnd=`RemoveEnd`,e.RemoveAdditionalAnnotation=`RemoveAdditionalAnnotation`,e.RemoveFocus=`RemoveFocus`,e.SetBegin=`SetBegin`,e.SetEnd=`SetEnd`,e.SetFocus=`SetFocus`})(e.Actions||={}),(e=>{e.AddAnnotation=`AddAnnotation`,e.AddAdditionalAnnotation=`AddAdditionalAnnotation`})(e.AnnotationActions||={}),(e=>{e.Actions=`actions`,e.Translations=`translations`})(e.Keys||={}),(e=>{e.ActionClicked=`action-clicked`,e.AnnotationClicked=`annotation-clicked`,e.Close=`close-context-menu`})(e.Events||={}),(e=>{e.Name=`contextMenu`})(e.Plugin||={})})(RS||={}),(e=>{(e=>{e.ActionName=`action-name`,e.Annotation=`annotation`,e.AnnotationsContainer=`annotations-container`,e.Component=`move-node-context-menu`,e.Divider=`divider`})(e.Classes||={})})(zS||={}),BS={AddAnnotation:`AddAnnotation`,AddComment:`AddComment`,AddCommentBefore:`AddCommentBefore`,DeleteCommentAfter:`DeleteCommentAfter`,DeleteCommentBefore:`DeleteCommentBefore`,AddAdditionalAnnotation:`AddAdditionalAnnotation`,HideAllAnnotations:`HideAllAnnotations`,ShowAllAnnotations:`ShowAllAnnotations`,RemoveAnnotation:`RemoveAnnotation`,DeleteVariation:`DeleteVariation`,PromoteVariation:`PromoteVariation`,DeleteMove:`DeleteMove`,ClearAnalysis:`ClearAnalysis`,InsertContinuation:`InsertContinuation`,MoveVariationUp:`MoveVariationUp`,MoveVariationDown:`MoveVariationDown`,RemoveBegin:`RemoveBegin`,RemoveEnd:`RemoveEnd`,RemoveFocus:`RemoveFocus`,SetBegin:`SetBegin`,SetEnd:`SetEnd`,SetFocus:`SetFocus`},VS={$1:`!`,$2:`?`,$3:`!!`,$4:`??`,$5:`!?`,$6:`?!`,$9:``,$10:`=`,$11:`=`,$12:`=`,$13:``,$14:``,$15:``,$16:``,$17:``,$18:`+-`,$19:`-+`,$22:``,$23:``,$32:``,$33:``,$36:``,$37:``,$40:``,$41:``,$44:`/=`,$45:`=/`,$132:``,$133:``,$138:``,$146:`N`,$222:``,$256:`=/`},HS=Fe(VS),US=[{action:RS.AnnotationActions.AddAnnotation,code:oS.Nags.$1,display:VS.$1,meaning:Y.Translation.Annotations.GoodMove},{action:RS.AnnotationActions.AddAnnotation,code:oS.Nags.$2,display:VS.$2,meaning:Y.Translation.Annotations.BadMove},{action:RS.AnnotationActions.AddAnnotation,code:oS.Nags.$3,display:VS.$3,meaning:Y.Translation.Annotations.ExcellentMove},{action:RS.AnnotationActions.AddAnnotation,code:oS.Nags.$4,display:VS.$4,meaning:Y.Translation.Annotations.Blunder},{action:RS.AnnotationActions.AddAnnotation,code:oS.Nags.$5,display:VS.$5,meaning:Y.Translation.Annotations.SpeculativeMove},{action:RS.AnnotationActions.AddAnnotation,code:oS.Nags.$6,display:VS.$6,meaning:Y.Translation.Annotations.DubiousMove},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$9,display:VS.$9,meaning:Y.Translation.Annotations.Miss},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$10,display:VS.$10,meaning:Y.Translation.Annotations.Drawish},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$13,display:VS.$13,meaning:Y.Translation.Annotations.Unclear},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$14,display:VS.$14,meaning:Y.Translation.Annotations.WhiteHasSlightAdvantage},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$15,display:VS.$15,meaning:Y.Translation.Annotations.BlackHasSlightAdvantage},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$16,display:VS.$16,meaning:Y.Translation.Annotations.WhiteHasModerateAdvantage},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$17,display:VS.$17,meaning:Y.Translation.Annotations.BlackHasModerateAdvantage},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$18,display:VS.$18,meaning:Y.Translation.Annotations.WhiteHasDecisiveAdvantage},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$19,display:VS.$19,meaning:Y.Translation.Annotations.BlackHasDecisiveAdvantage},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$22,display:VS.$22,meaning:Y.Translation.Annotations.PositionInZuqZwang},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$36,display:VS.$36,meaning:Y.Translation.Annotations.WithInitiative},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$40,display:VS.$40,meaning:Y.Translation.Annotations.WithCompensation},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$146,display:VS.$146,meaning:Y.Translation.Annotations.Novelty},{action:RS.AnnotationActions.AddAdditionalAnnotation,code:oS.Nags.$256,display:VS.$256,meaning:Y.Translation.Annotations.WithAttack}],WS=[{action:BS.AddAnnotation,code:oS.Nags.$3,display:VS.$3,meaning:Y.Translation.Annotations.ExcellentMove},{action:BS.AddAnnotation,code:oS.Nags.$1,display:VS.$1,meaning:Y.Translation.Annotations.GoodMove},{action:BS.AddAnnotation,code:oS.Nags.$5,display:VS.$5,meaning:Y.Translation.Annotations.SpeculativeMove},{action:BS.AddAnnotation,code:oS.Nags.$6,display:VS.$6,meaning:Y.Translation.Annotations.DubiousMove},{action:BS.AddAnnotation,code:oS.Nags.$2,display:VS.$2,meaning:Y.Translation.Annotations.BadMove},{action:BS.AddAnnotation,code:oS.Nags.$4,display:VS.$4,meaning:Y.Translation.Annotations.Blunder},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$9,display:VS.$9,meaning:Y.Translation.Annotations.Miss},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$18,display:VS.$18,meaning:Y.Translation.Annotations.WhiteHasDecisiveAdvantage},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$16,display:VS.$16,meaning:Y.Translation.Annotations.WhiteHasModerateAdvantage},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$14,display:VS.$14,meaning:Y.Translation.Annotations.WhiteHasSlightAdvantage},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$10,display:VS.$10,meaning:Y.Translation.Annotations.Drawish},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$15,display:VS.$15,meaning:Y.Translation.Annotations.BlackHasSlightAdvantage},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$17,display:VS.$17,meaning:Y.Translation.Annotations.BlackHasModerateAdvantage},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$19,display:VS.$19,meaning:Y.Translation.Annotations.BlackHasDecisiveAdvantage},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$13,display:VS.$13,meaning:Y.Translation.Annotations.Unclear},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$45,display:VS.$45,meaning:Y.Translation.Annotations.WithCompensation},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$146,display:VS.$146,meaning:Y.Translation.Annotations.Novelty},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$22,display:VS.$22,meaning:Y.Translation.Annotations.PositionInZuqZwang},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$138,display:VS.$138,meaning:Y.Translation.Annotations.TimeTrouble},{display:``},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$222,display:VS.$222,meaning:Y.Translation.Annotations.DevelopmentLead},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$40,display:VS.$40,meaning:Y.Translation.Annotations.WithInitiative},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$36,display:VS.$36,meaning:Y.Translation.Annotations.WithAttack},{action:BS.AddAdditionalAnnotation,code:oS.Nags.$132,display:VS.$132,meaning:Y.Translation.Annotations.Counterplay}],(e=>{(e=>{e.Actions=`actions`,e.Translations=`translations`})(e.Keys||={}),(e=>{e.Name=`contextMenu`})(e.Plugin||={})})(GS||={}),(e=>{(e=>{e.ActionName=`action-name`,e.Annotation=`annotation`,e.ActionsContainer=`actions-container`,e.AnnotationsContainer=`annotations-container`,e.Component=`move-node-context-menu`,e.Divider=`divider`})(e.Classes||={})})(KS||={}),qS=class extends ht{constructor(e){super(),Pe(this,e,to,eo,O,{selectedNodeKeys:10,selectedNodeRect:0,menuProps:1,game:11})}},JS=class extends ht{constructor(e){super(),Pe(this,e,ro,no,O,{tooltipMessage:0,handleClick:1,iconClassName:2})}},YS=class extends ht{constructor(e){super(),Pe(this,e,so,oo,O,{comment:13,className:0})}},XS=class extends ht{constructor(e){super(),Pe(this,e,lo,co,O,{moveListRow:0})}},ZS={"!!":{icon:gx,color:`#1baca6`},"!":{icon:Dx,color:`#5c8bb0`},"?":{icon:Fx,color:`#e6912c`},"??":{icon:mx,color:`#b33430`},"?!":{icon:Ax,color:`#f0c15c`},"!?":{icon:Kx,color:`#7979a1`},"":{icon:Nx,color:`#ee6b55`}},QS=class extends ht{constructor(e){super(),Pe(this,e,vo,_o,O,{node:0,isVariationPly:1},null,[-1,-1])}},$S=45,eC=class extends ht{constructor(e){super(),Pe(this,e,Oo,Do,O,{timestamp:0,color:1,ply:2,displayTimeInClockFormat:7})}},tC=class extends ht{constructor(e){super(),Pe(this,e,jo,Ao,O,{color:0})}},nC=class extends ht{constructor(e){super(),Pe(this,e,Bo,zo,O,{moveListRow:0,displayTimeInClockFormat:1,showTimestamps:7})}},rC=class extends ht{constructor(e){super(),Pe(this,e,Xo,Yo,O,{moveListNodes:0})}},iC=class extends ht{constructor(e){super(),Pe(this,e,ns,$o,O,{moveListRow:0,rowIndex:4,moveListRows:1})}},aC=class extends ht{constructor(e){super(),Pe(this,e,hs,ms,O,{data:32,eventHandlers:0,hideTimestampText:1,displayTimeInClockFormat:2,showTimestamps:3,game:4},null,[-1,-1])}},oC=(e=>(e.NodeSelected=`nodeSelected`,e.NoNodeSelected=`noNodeSelected`,e))(oC||{}),sC=(e=>(e.LOAD_LINE=`LOAD_LINE`,e.SELECT_NODE=`SELECT_NODE`,e.DESELECT_NODE=`DESELECT_NODE`,e))(sC||{}),cC=8,lC=(e=>( __set$(e,e.MainLine=0,`MainLine`) , __set$(e,e.MainLineChild=-1,`MainLineChild`) , __set$(e,e.Parent=1,`Parent`) ,e))(lC||{}),uC=[K.APIEvents.MoveBackward,K.APIEvents.MoveForward,K.APIEvents.SelectLineEnd,K.APIEvents.SelectLineStart,K.APIEvents.SelectNode],dC=sS.filter(e=>!uC.includes(e)),fC=()=>{},pC=(e=>(e.Mousedown=`mousedown`,e.MouseMove=`mousemove`,e.Mouseup=`mouseup`,e.PointerDown=`pointerdown`,e.PointerMove=`pointermove`,e.PointerUp=`pointerup`,e.Touchstart=`touchstart`,e.Touchmove=`touchmove`,e.Touchend=`touchend`,e))(pC||{}), _hh$temp885=kc(),mC=_hh$temp885.Pointerdown,hC=_hh$temp885.Pointermove,gC=_hh$temp885.Pointerup,_hh$temp885 ,_C=65,vC=7,(e=>{(e=>{(e=>{e.Ply=`data-ply`,e.Time=`data-time`,e.WholeMoveNumber=`data-whole-move-number`,e.VMLElement=`data-vml-element`})(e.Attributes||={}),(e=>{e.TimeBarWidth=`--timeBarWidth`,e.TimeValue=`--timeValue`,e.MaxMoveTimeTaken=`--timeMaxValue`,e.TimestampWidth=`--timestampWidth`})(e.CSSVariables||={}),(e=>{e.ColorsEnabled=`movelist-colored`,e.List=`vertical-move-list`,e.GameResult=`game-result`,e.Move=`move`,e.Node=`node`,e.Selected=`selected`,e.WithBaseTime=`timestamps-with-base-time`,e.ToggleTimestamps=`toggle-timestamps`})(e.ClassNames||={}),(e=>{e.Timestamp=`timestamp`})(e.ElementTypes||={})})(e.DOM||={}),(e=>{e.SelectNode=`SelectNode`})(e.Events||={})})(yC||={}),bC={enPassant:`https://www.chess.com/article/view/how-to-capture-en-passant`,soundsDefault:`https://www.chess.com/bundles/web/sounds`,soundsTheme:`https://images.chesscomfiles.com/chess-themes/sounds/`,webglAssetPaths:`__CHESSCOM_WEBGL_ASSET_PATHS__`,webglDataUrl:`https://www.chess.com/bundles/web/images/webgl_data`,webglDataUrlDev:`static/webgl_data`},(e=>{(e=>{e.AddMove=`AddMove`,e.AnalysisEnd=`AnalysisEnd`,e.AnalysisStart=`AnalysisStart`})(e.APIEvents||={}),(e=>{e.Name=`observing`})(e.Plugin||={})})(xC||={}),(e=>{(e=>{e.GameResult=`game-result`,e.Moves=`moves`})(e.Placeholders||={}),(e=>{e.Component=`horizontal-move-list`,e.MainLine=`main`,e.Variation=`variation`})(e.ClassNames||={}),e.ComponentIdentifier=`data-id`,(e=>{e.Copy=`copy`,e.UpdateNodeLimit=`UpdateNodeLimit`})(e.Events||={}),(e=>{e.Before=`(`,e.After=`)`})(e.VariationParenthesis||={}),(e=>{e.Begin=`begin`,e.Focus=`focus`,e.End=`end`})(e.NodeLimitTypes||={})})(SC||={}),CC=(e=>(e.EndOfLineSelected=`EndOfLineSelected`,e.MiddleOfLineSelected=`MiddleOfLineSelected`,e.StartingPosition=`StartingPosition`,e))(CC||{}),wC={condition:il,handler:al},TC={condition:ol,handler:sl},EC={condition:cl,handler:ll},(e=>{(e=>{e.FocusOut=`comment-field-focus-out`,e.CommentChanged=`comment-has-changed`})(e.Events||={}),(e=>{e.Component=`editable-comment`})(e.Classes||={}),(e=>{ __set$(e,e.CommentUpdateDelay=500,`CommentUpdateDelay`) })(e.Constants||={})})(DC||={}),OC={condition:dl,handler:fl},kC={condition:pl,handler:ml},AC={condition:hl,handler:gl},jC={condition:_l,handler:vl},MC={condition:yl,handler:bl},NC={condition:xl,handler:Sl},PC={condition:Cl,handler:wl},(e=>{(e=>{e.Annotation=`annotation`,e.CustomColor=`customColor`,e.id=`id`,e.MoveNumber=`moveNumber`,e.San=`san`,e.Selected=`selected`})(e.Keys||={}),(e=>{e.Annotation=`annotation`,e.CustomColor=`customColor`,e.MoveNumber=`moveNumber`,e.San=`san`})(e.TouchableKeys||={})})(FC||={}),(e=>{(e=>{e.Comment=`comment`,e.GameResultNode=`game-result-node`,e.IconFont=`icon-font-chess`,e.MoveNode=`move-node`,e.MoveNumber=`move-number`,e.MoveText=`move-text`,e.Selected=`selected`,e.StaticComment=`static-comment`})(e.Classes||={}),(e=>{ __set$(e,e.TouchDelay=500,`TouchDelay`) })(e.Constants||={}),(e=>{e.Click=`click`,e.OpenContextMenu=`contextmenu`})(e.Events||={})})(IC||={}),LC=class extends Error{constructor( _hh$temp886 ){ var e=_hh$temp886.code,t=_hh$temp886.message,n=_hh$temp886.data; super(t),this.code=e,this.data=n,this.message=t,this.name=`ChessError`}},RC=(e=>(e.BadData=`Bad Data`,e.BeforeStateHooksConflict=`Before State hooks conflict`,e.DOMDoesNotMatchJCE=`DOM Does Not Match JCE`,e.ElementAlreadyExists=`Element Already Exists`,e.ElementNotFound=`Element Not Found`,e.IllegalJCECall=`Illegal JCE Call`,e.IncorrectMode=`Incorrect Mode`,e.InvalidStateMachine=`Invalid State Machine`,e.MissingPluginDependency=`Missing Plugin Dependency`,e))(RC||{}),zC={[RS.Actions.InsertCommentBefore]:jl(),[RS.Actions.InsertComment]:Al(),[RS.Actions.DeleteCommentBefore]:Dl(),[RS.Actions.DeleteComment]:El(),[RS.Actions.RemoveAnnotation]:Il(),[RS.Actions.RemoveAdditionalAnnotation]:Ll(),[RS.Actions.DeleteVariation]:kl(),[RS.Actions.DeleteMove]:Ol(),[RS.Actions.PromoteVariation]:Fl(),[RS.Actions.MoveVariationDown]:Pl(),[RS.Actions.MoveVariationUp]:Nl(),[RS.Actions.InsertContinuation]:Ml(),[RS.Actions.ClearAnalysis]:Tl()},BC=class extends ht{constructor(e){super(),Pe(this,e,cee,see,O,{customColor:0,id:1,moveListEl:10,moveNumber:2,san:3,annotation:4,selected:5})}},VC={[FC.Keys.MoveNumber]:function( _hh$temp887 ){ var e=_hh$temp887.game,t=_hh$temp887.node; return pee({node:t,previous:t?.previous?e.getNodeByIds(t.previous)??void 0:void 0,startingMoveNumber:e.getStartingMoveNumber()})},[FC.Keys.Annotation]:function( _hh$temp888 ){ var e=_hh$temp888.node; return Zl(e)},[FC.Keys.CustomColor]:function( _hh$temp889 ){ var e=_hh$temp889.node; return e.customColor},[FC.Keys.San]:function( _hh$temp890 ){ var e=_hh$temp890.moveList,t=_hh$temp890.node,n=_hh$temp890.translations; return Fc({color:ja(t?.color),moveListDisplayType:e.getOptions().moveListDisplayType,san:t?.san,translations:n})}},HC=class extends ht{constructor(e){super(),Pe(this,e,tu,eu,O,{comment:6,translations:0})}},(e=>{(e=>{e.Click=`click`})(e.Events||={})})(UC||={}),(e=>{(e=>{e.PluginAdded=`PluginAdded`,e.PluginRemoved=`PluginRemoved`,e.ContextSet=`ContextSet`})(e.Events||={})})(WC||={}),GC=class extends ht{constructor(e){super(),Pe(this,e,Gu,Wu,O,{actions:0,translations:1,getElement:5})}get getElement(){return this.$$.ctx[5]}},KC={condition:Qu,handler:$u},qC=SC.VariationParenthesis.Before,JC=SC.VariationParenthesis.After,YC={[RS.Actions.SetBegin]:md({action:RS.Actions.SetBegin,nodeLimit:SC.NodeLimitTypes.Begin}),[RS.Actions.SetFocus]:md({action:RS.Actions.SetFocus,nodeLimit:SC.NodeLimitTypes.Focus}),[RS.Actions.SetEnd]:md({action:RS.Actions.SetEnd,nodeLimit:SC.NodeLimitTypes.End}),[RS.Actions.RemoveBegin]:md({action:RS.Actions.RemoveBegin,nodeLimit:SC.NodeLimitTypes.Begin}),[RS.Actions.RemoveFocus]:md({action:RS.Actions.RemoveFocus,nodeLimit:SC.NodeLimitTypes.Focus}),[RS.Actions.RemoveEnd]:md({action:RS.Actions.RemoveEnd,nodeLimit:SC.NodeLimitTypes.End})},XC=`
<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 19">
  <defs>
    <style>
      .cls-1 {
        opacity: 0.3;
      }

      .cls-2 {
        fill: #f8f8f8;
      }

      .cls-3 {
        fill: #8a8886;
      }
    </style>
  </defs>
  <g>
    <path class="cls-1" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"/>
    <circle class="cls-2" cx="9" cy="9" r="8.5"/>
    <path class="cls-2" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"/>
    <path class="cls-3" d="M13.37,12a.53.53,0,0,1,0,.78l-.59.61a.56.56,0,0,1-.4.17.54.54,0,0,1-.4-.17l-3-3-3,3a.58.58,0,0,1-.4.17.54.54,0,0,1-.39-.17l-.59-.59a.54.54,0,0,1-.17-.4.52.52,0,0,1,.17-.4l3-3-3-3a.52.52,0,0,1-.17-.4.54.54,0,0,1,.17-.4l.59-.59a.56.56,0,0,1,.8,0l3,3,3-3a.58.58,0,0,1,.4-.17.56.56,0,0,1,.4.17l.59.59a.54.54,0,0,1,.17.41.5.5,0,0,1-.17.39l-3,3,3,3Z"/>
  </g>
</svg>
`,ZC=-1,QC=-1,$C=ZC,ew=QC,tw=`square`,nw=`move`,rw=`move.to`,iw=`move.rookTo`,aw=`flipped`,ow=Object.freeze(Object.defineProperty({__proto__:null,createAnalysisOverlayPlugin:wt,createArrowKeysPlugin:Tt,createArrowsPlugin:Nt,createAssetsPlugin:Qt,createBlinkingHighlightPlugin:en,createBoardDisabledPlugin:tn,createBoardImagesPlugin:lp,createBoardSizePlugin:nn,createCheatDetectionPlugin:cn,createCoordinatesPlugin:ln,createCustomItemsPlugin:Fn,createDebugPlugin:In,createEcoPlugin:Pi,createEffectsPlugin:Kn,createFadeSetupPlugin:qn,createFlipBoardPlugin:Jn,createHighlightsPlugin:rr,createHorizontalMoveListPlugin:wd,createHoverSquarePlugin:or,createKeysPlugin:li,createKitchenSinkPlugins:pp,createMinimalPlugins:up,createMoveHintsPlugin:Hr,createMoveListPlugin:xc,createPiecesPlugin:Ur,createPregamePlugin:Fi,createPremiumPlugins:fp,createPremovesPlugin:va,createRecorderPlugin:fi,createRendererErrorCatcherPlugin:Gr,createReportingPlugin:ba,createSoundsPlugin:ii,createStandardPlugins:dp,createTimeControlPlugin:ai,createVerticalMoveListPlugin:Jc,createWebGLContextLostPlugin:ui},Symbol.toStringTag,{value:`Module`})),sw=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*((\d|\.)+))?\)$/,(e=>{(e=>{e.Name=`analysis`})(e.Plugin||={})})(cw||={}),(e=>{(e=>{e.Analysis=`analysis`,e.CaptureTheStar=`capture-the-star`,e.Explorer=`exploring`,e.GuessTheMove=`guess-the-move`,e.PassiveObserving=`passive-observing`,e.Observing=`observing`,e.Playing=`playing`,e.Setup=`setup`})(e.Types||={})})(lw||={}),uw=yp(Ep,{canAddMovesToMainLine:{default:!0,editable:!0},canInteractWithPieces:{default:!0,editable:!0},canMoveWhenGameIsOver:{default:!0,editable:!1},canModifyExistingMovesOnMainLine:{default:!0,editable:!0}}),dw=Object.freeze(Object.defineProperty({__proto__:null,create:uw},Symbol.toStringTag,{value:`Module`})),(e=>{(e=>{e.Completed=`CTSCompleted`})(e.Events||={}),(e=>{e.Name=`captureTheStar`})(e.Plugin||={})})(fw||={}),pw={noFromSquareOnMoveObj:`Move object has no "from" square.`,cannotLoadWithoutItems:`Cannot load without any items.`,cannotLoadWithoutPiece:`Cannot load without a piece.`,configurationMissingForItem:`Configuration missing for custom item`},mw=yp(Qp,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}}),hw=Object.freeze(Object.defineProperty({__proto__:null,create:mw},Symbol.toStringTag,{value:`Module`})),(e=>{(e=>{e.Name=`exploring`})(e.Plugin||={})})(gw||={}),_w=yp(nm,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!0,editable:!1}}),vw=Object.freeze(Object.defineProperty({__proto__:null,create:_w},Symbol.toStringTag,{value:`Module`})),(e=>{(e=>{e.Name=`guessTheMove`})(e.Plugin||={}),(e=>{e.CancelGuess=`CancelGuess`,e.GuessConfirmed=`GuessConfirmed`,e.GuessMade=`GuessMade`})(e.APIEvents||={}),(e=>{e.Correct=`#96bc4b`,e.Incorrect=`#c93430`})(e.Colors||={})})(yw||={}),bw=`gtm`,xw=yp(sm,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}}),Sw=Object.freeze(Object.defineProperty({__proto__:null,create:xw},Symbol.toStringTag,{value:`Module`})),Cw=yp(Im,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}}),ww=Object.freeze(Object.defineProperty({__proto__:null,create:Cw},Symbol.toStringTag,{value:`Module`})),(e=>{(e=>{e.Name=`playing`})(e.Plugin||={})})(Tw||={}),Ew=yp(Bm,{canAddMovesToMainLine:{default:!0,editable:!0},canMoveWhenGameIsOver:{default:!1,editable:!0},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!0}}),Dw=Object.freeze(Object.defineProperty({__proto__:null,create:Ew},Symbol.toStringTag,{value:`Module`})),Ow=yp(Vm,{canAddMovesToMainLine:{default:!1,editable:!1},canInteractWithPieces:{default:!1,editable:!1},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}}),kw=Object.freeze(Object.defineProperty({__proto__:null,create:Ow},Symbol.toStringTag,{value:`Module`})),(e=>{(e=>{e.DropPiece=`DropPiece`,e.MovePiece=`MovePiece`,e.RemovePiece=`RemovePiece`})(e.Events||={}),(e=>{e.Name=`setup`})(e.Plugin||={})})(Aw||={}),jw=yp(Ym,{canAddMovesToMainLine:{default:!1,editable:!1},canDropOffBoard:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1},canDropPiecesContinuously:{default:!0,editable:!0}}),Mw=Object.freeze(Object.defineProperty({__proto__:null,create:jw},Symbol.toStringTag,{value:`Module`})),Nw={ClearMarkings:lh(`clearMarkings`,`api.markings.removeAll/removeAllWhere/removeMany/removeOne`),Mark:lh(`mark`,`api.markings.addOne/addMany`),ToggleMarking:lh(`toggleMarking`,`api.markings.toggleOne/toggleMany`),Unmark:lh(`unmark`,`api.markings.removeOne/removeMany`)},Pw={"3-check":J.Variants.ThreeCheck,Bughouse:J.Variants.Bughouse,Chess:J.Variants.Chess,Chess960:J.Variants.Chess960,Crazyhouse:J.Variants.Crazyhouse,"King of the Hill":J.Variants.KingOfTheHill},Fw={trans:yg,transChoice:bg},Iw=`rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1`,Lw=1800,Rw=6e3,zw={anyAPIEvent: _hh$temp891=>{var e=_hh$temp891.UpdateParams;return e.cancelMarkingStartSquare(),ix.States.Idle;} ,[K.UserEvents.PointerdownLeft]: _hh$temp892=>{var e=_hh$temp892.UpdateParams;return e.cancelMarkingStartSquare(),ix.States.Idle;} ,[K.UserEvents.Pointerup]:( _hh$temp893 )=>{ var e=_hh$temp893.context,_hh$temp893$data=_hh$temp893.data,t=_hh$temp893$data.keyPressed,n=_hh$temp893$data.square,_hh$temp893$params=_hh$temp893.params,r=_hh$temp893$params.markingStartSquare,i=_hh$temp893.UpdateParams;  let _hh$temp894=e,_hh$temp894$api=_hh$temp894.api,a=_hh$temp894$api.markings,o=_hh$temp894.queue; if(n&&r){let e=r===n?a.factory.buildStandardAnalysisHighlight(n,t):a.factory.buildStandardArrow(r,n,t);o.add(a.toggleOne,e)}return i.cancelMarkingStartSquare(),ix.States.Idle}},Bw={[K.UserEvents.PointerdownLeft]:( _hh$temp895 )=>{ var e=_hh$temp895.context,_hh$temp895$data=_hh$temp895.data,t=_hh$temp895$data.coords,n=_hh$temp895$data.square,r=_hh$temp895.UpdateParams;  let _hh$temp896=e,_hh$temp896$api=_hh$temp896.api,i=_hh$temp896$api.getPieces,a=_hh$temp896$api.markings,_hh$temp896$mode=_hh$temp896.mode,o=_hh$temp896$mode.getOptions,s=_hh$temp896.options,c=_hh$temp896.queue,l=_hh$temp896.renderer,u=_hh$temp896.state; if(n&&!s.disableUserMarkings&&c.add(a.removeAllWhere,{node:!0,persistent:!1,types:[ab,Sb,nb]}),!s.enabled||!o().canInteractWithPieces||!i().isDefined(n))return ix.States.Idle;if(s.moveMethod===Qb.MoveMethods.Click){let t=l?.getCoordsFromSquare(n,s.flipped);if(t===void 0)throw new LC({code:RC.BadData,message:`getCoordsFromSquare returned undefined for ${n}`});return r.dragPiece(t,n),u.set({hideHoverSquare:!0}),l?.dragPiece({coords:t,square:n},e),ix.States.PieceDragging}r.dragPiece(t,n);let d=t||l?.getCoordsFromSquare(n,s.flipped);return l?.dragPiece({coords:d,square:n},e),ix.States.PieceDragging},[K.UserEvents.PointerdownRight]:( _hh$temp897 )=>{ var e=_hh$temp897.context,_hh$temp897$data=_hh$temp897.data,t=_hh$temp897$data.square,n=_hh$temp897.UpdateParams;  let _hh$temp898=e,r=_hh$temp898.options; if(!(!r.enabled||r.disableUserMarkings))return n.setMarkingStartSquare(t),ix.States.AddingMarkings}},Vw={anyAPIEvent:( _hh$temp899 )=>{ var e=_hh$temp899.context,_hh$temp899$data=_hh$temp899.data,t=_hh$temp899$data.holdSelectedPiece,n=_hh$temp899$data.move,r=_hh$temp899$data.plyDiff,_hh$temp899$params=_hh$temp899.params,i=_hh$temp899$params.draggingPiece,a=_hh$temp899.UpdateParams;  let _hh$temp900=e,o=_hh$temp900.renderer; return i&&!t&&u_({api:e.api,move:n,pieceSquare:i,plyDiff:r})?(a.resetElevatedState(),o?.dropPiece(i,e),ix.States.Idle):ix.States.PieceDragging},[K.UserEvents.MousedownRight]:( _hh$temp901 )=>{ var e=_hh$temp901.context,_hh$temp901$params=_hh$temp901.params,t=_hh$temp901$params.draggingPiece,n=_hh$temp901.UpdateParams;  let _hh$temp902=e,r=_hh$temp902.renderer; if(!t)throw new LC({code:RC.BadData,message:`Attempted to pointerdown on a dragging piece but dragging piece is null or undefined`});return n.dropPiece(),n.deselectPiece(),r?.dropPiece(t,e),ix.States.Idle},[K.UserEvents.Pointermove]:( _hh$temp903 )=>{ var e=_hh$temp903.context,_hh$temp903$data=_hh$temp903.data,t=_hh$temp903$data.coordsInsideBoard,_hh$temp903$params=_hh$temp903.params,n=_hh$temp903$params.draggingPiece,r=_hh$temp903.UpdateParams;  let _hh$temp904=e,i=_hh$temp904.renderer; if(!n)throw new LC({code:RC.BadData,message:`Attempted to drag a piece but draggingPiece is null or undefined`});return r.dragPiece(t,n),i?.dragPiece({coords:t,square:n},e),ix.States.PieceDragging},[K.UserEvents.Pointerup]:( _hh$temp905 )=>{ var e=_hh$temp905.context,_hh$temp905$data=_hh$temp905.data,t=_hh$temp905$data.keyPressed,n=_hh$temp905$data.square,_hh$temp905$params=_hh$temp905.params,r=_hh$temp905$params.draggingPiece,i=_hh$temp905$params.selectedPiece,a=_hh$temp905.UpdateParams;  let _hh$temp906=e,_hh$temp906$api=_hh$temp906.api,o=_hh$temp906$api.getMove,s=_hh$temp906$api.getPiece,c=_hh$temp906$api.getTurn,l=_hh$temp906$api.isCheck,u=_hh$temp906$api.move,d=_hh$temp906$api.playSound,f=_hh$temp906.mode,p=_hh$temp906.options,m=_hh$temp906.queue,h=_hh$temp906.renderer; if(!r)throw new LC({code:RC.BadData,message:`Attempted to pointerup on a dragging piece but dragging piece is null or undefined`});if(e.options.test){let t=e.el.querySelector(`.dragging`);t?.setAttribute(`data-test-dragging`,`false`),t?.removeAttribute(`dragging`)}if(r===n)return a.dropPiece(),h?.dropPiece(r,e),i===n||p.moveMethod===Qb.MoveMethods.Drag_Only||p.moveMethod===Qb.MoveMethods.DragOnly?(a.deselectPiece(),ix.States.Idle):(a.selectPiece(r),ix.States.PieceSelected);i&&a.deselectPiece();let g={from:r,to:n},_=o(g),v=f.isAllowedToMove()&&_?{..._,animate:!1,userGenerated:!0,userGeneratedDrop:!0}:!1;if(!v){a.dropPiece(),f.handleIllegalMove&&m.add(f.handleIllegalMove,g);let t=l(),n=!1;return s(r)?.color===c()&&t&&(p.playSounds&&m.add(d,Ib.BoardSounds.Illegal),n=t),h?.illegalMove(n,e),h?.dropPiece(r,e),p.moveMethod===Qb.MoveMethods.DragOnly?(a.deselectPiece(),ix.States.Idle):(a.selectPiece(r),ix.States.PieceSelected)}return ti(v)?!p.autoPromote||t===`alt`?(a.dragPiece({},r),a.showPromotionArea(v),h?.dragPiece({square:r,toSquare:v.to},e),h?.openPromotionWindow(v,e),ix.States.PromotionAreaShowing):(a.dropPiece(),h?.dropPiece(v.to,e),m.add(u,{...v,promotion:J.Piece.Types.Queen}),ix.States.Idle):(a.dropPiece(),n===null&&f.getOptions().canDropOffBoard?h?.removePiece(r,e):h?.dropPiece(n,e),m.add(u,v),ix.States.Idle)}},Hw={anyAPIEvent: _hh$temp907=>{var e=_hh$temp907.context,_hh$temp907$data=_hh$temp907.data,t=_hh$temp907$data.holdSelectedPiece,n=_hh$temp907$data.move,r=_hh$temp907$data.plyDiff,_hh$temp907$params=_hh$temp907.params,i=_hh$temp907$params.selectedPiece,a=_hh$temp907.UpdateParams;return!t&&u_({api:e.api,move:n,pieceSquare:i,plyDiff:r})?(a.resetElevatedState(),ix.States.Idle):ix.States.PieceSelected;} ,[K.UserEvents.PointerdownLeft]:( _hh$temp908 )=>{ var e=_hh$temp908.context,_hh$temp908$data=_hh$temp908.data,t=_hh$temp908$data.coords,n=_hh$temp908$data.keyPressed,r=_hh$temp908$data.square,_hh$temp908$params=_hh$temp908.params,i=_hh$temp908$params.selectedPiece,a=_hh$temp908.UpdateParams;  let _hh$temp909=e,_hh$temp909$api=_hh$temp909.api,o=_hh$temp909$api.getMove,s=_hh$temp909$api.getPieces,c=_hh$temp909$api.getVariant,l=_hh$temp909$api.move,_hh$temp909$mode=_hh$temp909.mode,u=_hh$temp909$mode.isAllowedToMove,d=_hh$temp909.options,f=_hh$temp909.queue,p=_hh$temp909.renderer,m=_hh$temp909.state; if(!i)throw new LC({code:RC.BadData,message:`Attempted to interact with a selectedPiece but selectedPiece is null or undefined`});if(r===i){let n=d.moveMethod===Qb.MoveMethods.Drag||d.moveMethod===Qb.MoveMethods.Drag_Only||d.moveMethod===Qb.MoveMethods.DragOnly?t:p?.getCoordsFromSquare(r,d.flipped)||t;return a.dragPiece(n,i),d.moveMethod===Qb.MoveMethods.Click&&m.set({hideHoverSquare:!0}),p?.dragPiece({coords:n,square:i},e),ix.States.PieceDragging}let h={from:i,to:r},g=s(),_=o(h),v=u()&&_?{..._,userGenerated:!0}:!1,y=c()===J.Variants.Chess960,b=g.isDefined(r)&&g.get(r)?.type===J.Piece.Types.Rook,x=d.disableRookCastling&&v&&!y&&$r(v)&&b;if(!v||x){if(a.deselectPiece(),!g.isDefined(r))return ix.States.Idle;if(d.moveMethod===Qb.MoveMethods.Click){let n=p?.getCoordsFromSquare(r,d.flipped)||t;return a.dragPiece(n,r),m.set({hideHoverSquare:!0}),p?.dragPiece({coords:n,square:r},e),ix.States.PieceDragging}return a.dragPiece(t,r),p?.dragPiece({coords:t,square:r},e),ix.States.PieceDragging}return ti(v)?!d.autoPromote||n===`alt`?(a.deselectPiece(),a.dragPiece({},i),a.showPromotionArea(v),p?.dragPiece({square:i,toSquare:v.to},e),p?.openPromotionWindow(v,e),ix.States.PromotionAreaShowing):(a.deselectPiece(),f.add(l,v,{...v,promotion:J.Piece.Types.Queen}),ix.States.Idle):(a.deselectPiece(),f.add(l,v),ix.States.Idle)},[K.UserEvents.PointerdownRight]:( _hh$temp910 )=>{ var e=_hh$temp910.context,_hh$temp910$data=_hh$temp910.data,t=_hh$temp910$data.square,n=_hh$temp910.UpdateParams;  let _hh$temp911=e,r=_hh$temp911.options; if(!(!r.enabled||r.disableUserMarkings))return n.deselectPiece(),n.setMarkingStartSquare(t),ix.States.AddingMarkings}},Uw={anyAPIEvent:e=>e.type===K.APIEvents.Move?ix.States.PromotionAreaShowing:d_(e),[K.BoardEvents.PromotionPiecePointerdown]:( _hh$temp912 )=>{ var e=_hh$temp912.context,_hh$temp912$data=_hh$temp912.data,t=_hh$temp912$data.piece,_hh$temp912$params=_hh$temp912.params,n=_hh$temp912$params.draggingPiece,r=_hh$temp912$params.promotionMove,i=_hh$temp912.UpdateParams;  let _hh$temp913=e,_hh$temp913$api=_hh$temp913.api,a=_hh$temp913$api.move,o=_hh$temp913.queue,s=_hh$temp913.renderer; return i.dropPiece(),i.cancelPromotion(),s?.dropPiece(n,e),s?.closePromotionWindow(e),r&&o.add(a,{animate:!1,flags:r.flags,from:r.from,piece:J.Piece.Types.Pawn,promotion:t,to:r.to,userGenerated:!0}),ix.States.Idle},[K.BoardEvents.PromotionAreaClosePointerdown]:d_,[K.UserEvents.PointerdownLeft]:d_,[K.UserEvents.PointerdownRight]:d_},Ww={createUpdateParams:l_,getCurrentState:()=>ix.States.Idle,getParams:()=>({draggingCoords:void 0,draggingPiece:void 0,markingStartSquare:void 0,promotionMove:void 0,selectedPiece:void 0}),states:{[ix.States.AddingMarkings]:zw,[ix.States.PieceDragging]:Vw,[ix.States.Idle]:Bw,[ix.States.PromotionAreaShowing]:Uw,[ix.States.PieceSelected]:Hw}},(e=>{(e=>{e.CreateFailure=`CreateFailure`})(e.LogCodes||={})})(Gw||={}),(e=>{(e=>{e.Default=`staunton_executive`,e.Trigger=`real3d`})(e.PieceStyles||={}),(e=>{e.CameraSettings=`cameraSettings`})(e.CacheKeys||={}),(e=>{e.Board=`board-webgl-3d`,e.PieceDrag=`piece-dragging`,e.PieceHover=`piece-hover`,e.PromotionWindow=`promotion-window-3d`,e.StatisticsPanel=`statistics-panel`})(e.CssClasses||={}),(e=>{ __set$(e,e.AnalysisOverlay=1,`AnalysisOverlay`) , __set$(e,e.NotationPlane=2,`NotationPlane`) , __set$(e,e.OverSquare=3,`OverSquare`) , __set$(e,e.HighligtedSquare=4,`HighligtedSquare`) , __set$(e,e.Hint=5,`Hint`) , __set$(e,e.CustomItem=6,`CustomItem`) , __set$(e,e.PieceShadow=7,`PieceShadow`) , __set$(e,e.Arrow=8,`Arrow`) , __set$(e,e.Effect=9,`Effect`) , __set$(e,e.Highest=10,`Highest`) })(e.ObjectsRenderOrder||={}),(e=>{ __set$(e,e.PositionY=.005,`PositionY`) })(e.Arrow||={}),(e=>{ __set$(e,e.PositionY=.005,`PositionY`) })(e.CustomItem||={}),(e=>{ __set$(e,e.PositionY=.005,`PositionY`) })(e.Effect||={}),(e=>{ __set$(e,e.Size=10,`Size`) , __set$(e,e.HalfSize=5,`HalfSize`) , __set$(e,e.BorderSize=.5,`BorderSize`) , __set$(e,e.OverBorderSize=.5,`OverBorderSize`) , __set$(e,e.VisibleY=.005,`VisibleY`) , __set$(e,e.InvisibleY=-.2,`InvisibleY`) , __set$(e,e.InsideTolerance=.01,`InsideTolerance`) })(e.Square||={}),(e=>{ __set$(e,e.MarginSize=4,`MarginSize`) , __set$(e,e.Size=88,`Size`) })(e.Board||={}),(e=>{ __set$(e,e.Distance=140,`Distance`) , __set$(e,e.DistanceMin=50,`DistanceMin`) , __set$(e,e.DistanceMax=500,`DistanceMax`) , __set$(e,e.PanAngle=0,`PanAngle`) , __set$(e,e.TiltAngle=100,`TiltAngle`) , __set$(e,e.HorizontalPanning=0,`HorizontalPanning`) , __set$(e,e.VerticalPanning=-12,`VerticalPanning`) , __set$(e,e.ZoomIncrement=5,`ZoomIncrement`) })(e.Camera||={})})(X||={}),Kw=`1.64.0`,(e=>{(e=>{e.BodyDragging=`hand-pieces-dragging-body`,e.Component=`hand-pieces`,e.Dragging=`dragging`,e.Flipped=`flipped`,e.Horizontal=`horizontal`,e.Piece=`hand-piece`,e.Pseudo3d=`pseudo3d`,e.Vertical=`vertical`,e.WithKing=`with-king`})(e.Classes||={}),(e=>{e.Horizontal=`horizontal`,e.Vertical=`vertical`})(e.DisplayDirections||={})})(qw||={}),Jw=(e=>(e.Dragging=`dragging`,e.Idle=`idle`,e.Selected=`selected`,e))(Jw||{}),Yw=(e=>(e.RESET=`RESET`,e.PLACE=`PLACE`,e.SELECT=`SELECT`,e.DESELECT=`DESELECT`,e.START_DRAG=`START_DRAG`,e.MOVE=`MOVE`,e))(Yw||{}),Xw=class extends ht{constructor(e){super(),Pe(this,e,q_,K_,O,{data:24,game:25,boardEl:26,eventHandlers:0,removePieceStyleElement:27},null,[-1,-1])}},Zw={HEAD_HEIGHT:4.5,HEAD_WIDTH:6.5,TAIL_PADDING:4.5,WIDTH:2.75},Qw=[.5,-2],$w=[2,.5,-.5,-2],eT=/iPhone/i,tT=/iPod/i,nT=/iPad/i,rT=/\bAndroid(?:.+)Mobile\b/i,iT=/Android/i,aT=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,oT=/Silk/i,sT=/Windows Phone/i,cT=/\bWindows(?:.+)ARM\b/i,lT=/BlackBerry/i,uT=/BB10/i,dT=/Opera Mini/i,fT=/\b(CriOS|Chrome)(?:.+)Mobile/i,pT=/Mobile(?:.+)Firefox\b/i,mT=bv(),hT={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:xv(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:`highp`,PRECISION_FRAGMENT:mT.apple.device?`highp`:`mediump`,CAN_UPLOAD_SAME_BUFFER:Sv(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},gT={},(function(e){var t=Object.prototype.hasOwnProperty,n=`~`;function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,r,a,o){if(typeof r!=`function`)throw TypeError(`The listener must be a function`);var s=new i(r,a||e,o),c=n?n+t:t;return  __get$(e._events,c) ? __get$(e._events,c) .fn? __set$(e._events,c,[__get$(e._events,c),s]) : __get$(e._events,c) .push(s):( __set$(e._events,c,s) ,e._eventsCount++),e}function o(e,t){--e._eventsCount===0?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)t.call(r,i)&&e.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e},s.prototype.listeners=function(e){var t=n?n+e:e,r= __get$(this._events,t) ;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=Array(a);i<a;i++) __set$(o,i,__get$(r,i).fn) ;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,r= __get$(this._events,t) ;return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,a,o){var s=n?n+e:e;if(! __get$(this._events,s) )return!1;var c= __get$(this._events,s) ,l=arguments.length,u,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,a),!0;case 6:return c.fn.call(c.context,t,r,i,a,o),!0}for(d=1,u=Array(l-1);d<l;d++) __set$(u,d-1,__get$(arguments,d)) ;c.fn.apply(c.context,u)}else{var f=c.length,p;for(d=0;d<f;d++)switch( __get$(c,d) .once&&this.removeListener(e, __get$(c,d) .fn,void 0,!0),l){case 1: __get$(c,d) .fn.call( __get$(c,d) .context);break;case 2: __get$(c,d) .fn.call( __get$(c,d) .context,t);break;case 3: __get$(c,d) .fn.call( __get$(c,d) .context,t,r);break;case 4: __get$(c,d) .fn.call( __get$(c,d) .context,t,r,i);break;default:if(!u)for(p=1,u=Array(l-1);p<l;p++) __set$(u,p-1,__get$(arguments,p)) ; __get$(c,d) .fn.apply( __get$(c,d) .context,u)}}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var a=n?n+e:e;if(! __get$(this._events,a) )return this;if(!t)return o(this,a),this;var s= __get$(this._events,a) ;if(s.fn)s.fn===t&&(!i||s.once)&&(!r||s.context===r)&&o(this,a);else{for(var c=0,l=[],u=s.length;c<u;c++)( __get$(s,c) .fn!==t||i&&! __get$(s,c) .once||r&& __get$(s,c) .context!==r)&&l.push( __get$(s,c) );l.length? __set$(this._events,a,l.length===1?l[0]:l) :o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e, __get$(this._events,t) &&o(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})({get exports(){return gT},set exports(e){gT=e}}),_T=gT,vT={},yT={get exports(){return vT},set exports(e){vT=e}},yT.exports=Cv,vT.default=Cv,Cv.deviation=function(e,t,n,r){var i=t&&t.length,a=i?t[0]*n:e.length,o=Math.abs(ey(e,0,a,n));if(i)for(var s=0,c=t.length;s<c;s++){var l= __get$(t,s) *n,u=s<c-1? __get$(t,s+1) *n:e.length;o-=Math.abs(ey(e,l,u,n))}var d=0;for(s=0;s<r.length;s+=3){var f= __get$(r,s) *n,p= __get$(r,s+1) *n,m= __get$(r,s+2) *n;d+=Math.abs(( __get$(e,f) - __get$(e,m) )*( __get$(e,p+1) - __get$(e,f+1) )-( __get$(e,f) - __get$(e,p) )*( __get$(e,m+1) - __get$(e,f+1) ))}return o===0&&d===0?0:Math.abs((d-o)/o)},Cv.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var a=0;a< __get$(e,i) .length;a++)for(var o=0;o<t;o++)n.vertices.push( __get$(__get$(__get$(e,i),a),o) );i>0&&(r+= __get$(e,i-1) .length,n.holes.push(r))}return n},bT={},xT={},(function(e,t){(function(n){var r=t&&!t.nodeType&&t,i=e&&!e.nodeType&&e,a=typeof H==`object`&&H;(a.global===a||a.window===a||a.self===a)&&(n=a);var o,s=2147483647,c=36,l=1,u=26,d=38,f=700,p=72,m=128,h=`-`,g=/^xn--/,_=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:`Overflow: input needs wider integers to process`,"not-basic":`Illegal input >= 0x80 (not a basic code point)`,"invalid-input":`Invalid input`},b=c-l,x=Math.floor,S=String.fromCharCode,C;function w(e){throw RangeError( __get$(y,e) )}function T(e,t){for(var n=e.length,r=[];n--;) __set$(r,n,t(__get$(e,n))) ;return r}function E(e,t){var n=e.split(`@`),r=``;n.length>1&&(r=n[0]+`@`,e=n[1]),e= __call$(e,"replace",[v,`.`]) ;var i=T(e.split(`.`),t).join(`.`);return r+i}function D(e){for(var t=[],n=0,r=e.length,i,a;n<r;)i=e.charCodeAt(n++),i>=55296&&i<=56319&&n<r?(a=e.charCodeAt(n++),(a&64512)==56320?t.push(((i&1023)<<10)+(a&1023)+65536):(t.push(i),n--)):t.push(i);return t}function O(e){return T(e,function(e){var t=``;return e>65535&&(e-=65536,t+=S(e>>>10&1023|55296),e=56320|e&1023),t+=S(e),t}).join(``)}function k(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:c}function ee(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function A(e,t,n){var r=0;for(e=n?x(e/f):e>>1,e+=x(e/t);e>b*u>>1;r+=c)e=x(e/b);return x(r+(b+1)*e/(e+d))}function j(e){var t=[],n=e.length,r,i=0,a=m,o=p,d=e.lastIndexOf(h),f,g,_,v,y,b,S,C;for(d<0&&(d=0),f=0;f<d;++f)e.charCodeAt(f)>=128&&w(`not-basic`),t.push(e.charCodeAt(f));for(g=d>0?d+1:0;g<n;){for(_=i,v=1,y=c;g>=n&&w(`invalid-input`),b=k(e.charCodeAt(g++)),(b>=c||b>x((s-i)/v))&&w(`overflow`),i+=b*v,S=y<=o?l:y>=o+u?u:y-o,!(b<S);y+=c)C=c-S,v>x(s/C)&&w(`overflow`),v*=C;r=t.length+1,o=A(i-_,r,_==0),x(i/r)>s-a&&w(`overflow`),a+=x(i/r),i%=r,t.splice(i++,0,a)}return O(t)}function M(e){var t,n,r,i,a,o,d,f,g,_,v,y=[],b,C,T,E;for(e=D(e),b=e.length,t=m,n=0,a=p,o=0;o<b;++o)v= __get$(e,o) ,v<128&&y.push(S(v));for(r=i=y.length,i&&y.push(h);r<b;){for(d=s,o=0;o<b;++o)v= __get$(e,o) ,v>=t&&v<d&&(d=v);for(C=r+1,d-t>x((s-n)/C)&&w(`overflow`),n+=(d-t)*C,t=d,o=0;o<b;++o)if(v= __get$(e,o) ,v<t&&++n>s&&w(`overflow`),v==t){for(f=n,g=c;_=g<=a?l:g>=a+u?u:g-a,!(f<_);g+=c)E=f-_,T=c-_,y.push(S(ee(_+E%T,0))),f=x(E/T);y.push(S(ee(f,0))),a=A(n,C,r==i),n=0,++r}++n,++t}return y.join(``)}function N(e){return E(e,function(e){return g.test(e)?j(e.slice(4).toLowerCase()):e})}function P(e){return E(e,function(e){return _.test(e)?`xn--`+M(e):e})}if(o={version:`1.3.2`,ucs2:{decode:D,encode:O},decode:j,encode:M,toASCII:P,toUnicode:N},r&&i)if(e.exports==r)i.exports=o;else for(C in o)o.hasOwnProperty(C)&&( __set$(r,C,__get$(o,C)) );else n.punycode=o})(H)})({get exports(){return xT},set exports(e){xT=e}},xT),ST={isString:function(e){return typeof e==`string`},isObject:function(e){return typeof e==`object`&&!!e},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}},CT={},wT=function(e,t,n,r){t||=`&`,n||=`=`;var i={};if(typeof e!=`string`||e.length===0)return i;var a=/\+/g;e=e.split(t);var o=1e3;r&&typeof r.maxKeys==`number`&&(o=r.maxKeys);var s=e.length;o>0&&s>o&&(s=o);for(var c=0;c<s;++c){var l= __call$(__get$(e,c),"replace",[a,`%20`]) ,u=l.indexOf(n),d,f,p,m;u>=0?(d=l.substr(0,u),f=l.substr(u+1)):(d=l,f=``),p=decodeURIComponent(d),m=decodeURIComponent(f),ty(i,p)?Array.isArray( __get$(i,p) )? __get$(i,p) .push(m): __set$(i,p,[__get$(i,p),m]) : __set$(i,p,m) }return i},TT=function(e){switch(typeof e){case`string`:return e;case`boolean`:return e?`true`:`false`;case`number`:return isFinite(e)?e:``;default:return``}},ET=function(e,t,n,r){return t||=`&`,n||=`=`,e===null&&(e=void 0),typeof e==`object`?Object.keys(e).map(function(r){var i=encodeURIComponent(TT(r))+n;return Array.isArray( __get$(e,r) )? __get$(e,r) .map(function(e){return i+encodeURIComponent(TT(e))}).join(t):i+encodeURIComponent(TT( __get$(e,r) ))}).join(t):r?encodeURIComponent(TT(r))+n+encodeURIComponent(TT(e)):``},CT.decode=CT.parse=wT,CT.encode=CT.stringify=ET,DT=xT,OT=ST,kT=bT.parse=ry,bT.resolve=ay,bT.resolveObject=oy,bT.format=iy,bT.Url=ny,AT=/^([a-z0-9.+-]+:)/i,jT=/:[0-9]*$/,MT=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,NT=[`{`,`}`,`|`,`\\`,`^`,"`",`<`,`>`,`"`,"`",` `,`\r`,`
`,`	`],PT=[`'`].concat(NT),FT=[`%`,`/`,`?`,`;`,`#`].concat(PT),IT=[`/`,`?`,`#`],LT=255,RT=/^[+a-z0-9A-Z_-]{0,63}$/,zT=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,BT={javascript:!0,"javascript:":!0},VT={javascript:!0,"javascript:":!0},HT={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},UT=CT,ny.prototype.parse=function(e,t,n){if(!OT.isString(e))throw TypeError(`Parameter 'url' must be a string, not `+typeof e);var r=e.indexOf(`?`),i=r!==-1&&r<e.indexOf(`#`)?`?`:`#`,a=e.split(i);a[0]= __call$(a[0],"replace",[/\\/g,`/`]) ,e=a.join(i);var o=e;if(o=o.trim(),!n&&e.split(`#`).length===1){var s=MT.exec(o);if(s)return this.path=o, __set$(this,"href",o) ,this.pathname=s[1],s[2]?(this.search=s[2],t?this.query=UT.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search=``,this.query={}),this}var c=AT.exec(o);if(c){c=c[0];var l=c.toLowerCase();this.protocol=l,o=o.substr(c.length)}if(n||c||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=o.substr(0,2)===`//`;u&&!(c&& __get$(VT,c) )&&(o=o.substr(2),this.slashes=!0)}if(! __get$(VT,c) &&(u||c&&! __get$(HT,c) )){for(var d=-1,f=0;f<IT.length;f++){var p=o.indexOf( __get$(IT,f) );p!==-1&&(d===-1||p<d)&&(d=p)}var m,h=d===-1?o.lastIndexOf(`@`):o.lastIndexOf(`@`,d);h!==-1&&(m=o.slice(0,h),o=o.slice(h+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<FT.length;f++){var p=o.indexOf( __get$(FT,f) );p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=o.length),this.host=o.slice(0,d),o=o.slice(d),this.parseHost(),this.hostname=this.hostname||``;var g=this.hostname[0]===`[`&& __get$(this.hostname,this.hostname.length-1) ===`]`;if(!g)for(var _=this.hostname.split(/\./),f=0,v=_.length;f<v;f++){var y= __get$(_,f) ;if(y&&!y.match(RT)){for(var b=``,x=0,S=y.length;x<S;x++)y.charCodeAt(x)>127?b+=`x`:b+= __get$(y,x) ;if(!b.match(RT)){var C=_.slice(0,f),w=_.slice(f+1),T=y.match(zT);T&&(C.push(T[1]),w.unshift(T[2])),w.length&&(o=`/`+w.join(`.`)+o),this.hostname=C.join(`.`);break}}}this.hostname.length>LT?this.hostname=``:this.hostname=this.hostname.toLowerCase(),g||(this.hostname=DT.toASCII(this.hostname));var E=this.port?`:`+this.port:``;this.host=(this.hostname||``)+E, __set$(this,"href",__get$(this,"href")+this.host) ,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),o[0]!==`/`&&(o=`/`+o))}if(! __get$(BT,l) )for(var f=0,v=PT.length;f<v;f++){var D= __get$(PT,f) ;if(o.indexOf(D)!==-1){var O=encodeURIComponent(D);O===D&&(O=escape(D)),o=o.split(D).join(O)}}var k=o.indexOf(`#`);k!==-1&&(this.hash=o.substr(k),o=o.slice(0,k));var ee=o.indexOf(`?`);if(ee===-1?t&&(this.search=``,this.query={}):(this.search=o.substr(ee),this.query=o.substr(ee+1),t&&(this.query=UT.parse(this.query)),o=o.slice(0,ee)),o&&(this.pathname=o), __get$(HT,l) &&this.hostname&&!this.pathname&&(this.pathname=`/`),this.pathname||this.search){var E=this.pathname||``;this.path=E+(this.search||``)}return  __set$(this,"href",this.format()) ,this},ny.prototype.format=function(){var e=this.auth||``;e&&(e=encodeURIComponent(e),e= __call$(e,"replace",[/%3A/i,`:`]) ,e+=`@`);var t=this.protocol||``,n=this.pathname||``,r=this.hash||``,i=!1,a=``;this.host?i=e+this.host:this.hostname&&(i=e+(this.hostname.indexOf(`:`)===-1?this.hostname:`[`+this.hostname+`]`),this.port&&(i+=`:`+this.port)),this.query&&OT.isObject(this.query)&&Object.keys(this.query).length&&(a=UT.stringify(this.query));var o=this.search||a&&`?`+a||``;return t&&t.substr(-1)!==`:`&&(t+=`:`),this.slashes||(!t|| __get$(HT,t) )&&i!==!1?(i=`//`+(i||``),n&&n.charAt(0)!==`/`&&(n=`/`+n)):i||=``,r&&r.charAt(0)!==`#`&&(r=`#`+r),o&&o.charAt(0)!==`?`&&(o=`?`+o),n= __call$(n,"replace",[/[?#]/g,function(e){return encodeURIComponent(e);}]) ,o= __call$(o,"replace",[`#`,`%23`]) ,t+i+n+o+r},ny.prototype.resolve=function(e){return this.resolveObject(ry(e,!1,!0)).format()},ny.prototype.resolveObject=function(e){if(OT.isString(e)){var t=new ny;t.parse(e,!1,!0),e=t}for(var n=new ny,r=Object.keys(this),i=0;i<r.length;i++){var a= __get$(r,i) ; __set$(n,a,__get$(this,a)) }if(n.hash=e.hash, __get$(e,"href") ===``)return  __set$(n,"href",n.format()) ,n;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),s=0;s<o.length;s++){var c= __get$(o,s) ;c!==`protocol`&&( __set$(n,c,__get$(e,c)) )}return  __get$(HT,n.protocol) &&n.hostname&&!n.pathname&&(n.path=n.pathname=`/`), __set$(n,"href",n.format()) ,n}if(e.protocol&&e.protocol!==n.protocol){if(! __get$(HT,e.protocol) ){for(var l=Object.keys(e),u=0;u<l.length;u++){var d= __get$(l,u) ; __set$(n,d,__get$(e,d)) }return  __set$(n,"href",n.format()) ,n}if(n.protocol=e.protocol,!e.host&&! __get$(VT,e.protocol) ){for(var f=(e.pathname||``).split(`/`);f.length&&!(e.host=f.shift()););e.host||=``,e.hostname||=``,f[0]!==``&&f.unshift(``),f.length<2&&f.unshift(``),n.pathname=f.join(`/`)}else n.pathname=e.pathname;return n.search=e.search,n.query=e.query,n.host=e.host||``,n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,(n.pathname||n.search)&&(n.path=(n.pathname||``)+(n.search||``)),n.slashes=n.slashes||e.slashes, __set$(n,"href",n.format()) ,n}var p=n.pathname&&n.pathname.charAt(0)===`/`,m=e.host||e.pathname&&e.pathname.charAt(0)===`/`,h=m||p||n.host&&e.pathname,g=h,_=n.pathname&&n.pathname.split(`/`)||[],f=e.pathname&&e.pathname.split(`/`)||[],v=n.protocol&&! __get$(HT,n.protocol) ;if(v&&(n.hostname=``,n.port=null,n.host&&(_[0]===``?_[0]=n.host:_.unshift(n.host)),n.host=``,e.protocol&&(e.hostname=null,e.port=null,e.host&&(f[0]===``?f[0]=e.host:f.unshift(e.host)),e.host=null),h&&=f[0]===``||_[0]===``),m)n.host=e.host||e.host===``?e.host:n.host,n.hostname=e.hostname||e.hostname===``?e.hostname:n.hostname,n.search=e.search,n.query=e.query,_=f;else if(f.length)_||=[],_.pop(),_=_.concat(f),n.search=e.search,n.query=e.query;else if(!OT.isNullOrUndefined(e.search)){if(v){n.hostname=n.host=_.shift();var y=n.host&&n.host.indexOf(`@`)>0?n.host.split(`@`):!1;y&&(n.auth=y.shift(),n.host=n.hostname=y.shift())}return n.search=e.search,n.query=e.query,(!OT.isNull(n.pathname)||!OT.isNull(n.search))&&(n.path=(n.pathname?n.pathname:``)+(n.search?n.search:``)), __set$(n,"href",n.format()) ,n}if(!_.length)return n.pathname=null,n.search?n.path=`/`+n.search:n.path=null, __set$(n,"href",n.format()) ,n;for(var b=_.slice(-1)[0],x=(n.host||e.host||_.length>1)&&(b===`.`||b===`..`)||b===``,S=0,C=_.length;C>=0;C--)b= __get$(_,C) ,b===`.`?_.splice(C,1):b===`..`?(_.splice(C,1),S++):S&&(_.splice(C,1),S--);if(!h&&!g)for(;S--;)_.unshift(`..`);h&&_[0]!==``&&(!_[0]||_[0].charAt(0)!==`/`)&&_.unshift(``),x&&_.join(`/`).substr(-1)!==`/`&&_.push(``);var w=_[0]===``||_[0]&&_[0].charAt(0)===`/`;if(v){n.hostname=n.host=w?``:_.length?_.shift():``;var y=n.host&&n.host.indexOf(`@`)>0?n.host.split(`@`):!1;y&&(n.auth=y.shift(),n.host=n.hostname=y.shift())}return h||=n.host&&_.length,h&&!w&&_.unshift(``),_.length?n.pathname=_.join(`/`):(n.pathname=null,n.path=null),(!OT.isNull(n.pathname)||!OT.isNull(n.search))&&(n.path=(n.pathname?n.pathname:``)+(n.search?n.search:``)),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes, __set$(n,"href",n.format()) ,n},ny.prototype.parseHost=function(){var e=this.host,t=jT.exec(e);t&&(t=t[0],t!==`:`&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},(function(e){ __set$(e,e.WEBGL_LEGACY=0,`WEBGL_LEGACY`) , __set$(e,e.WEBGL=1,`WEBGL`) , __set$(e,e.WEBGL2=2,`WEBGL2`) })(WT||={}),(function(e){ __set$(e,e.UNKNOWN=0,`UNKNOWN`) , __set$(e,e.WEBGL=1,`WEBGL`) , __set$(e,e.CANVAS=2,`CANVAS`) })(GT||={}),(function(e){ __set$(e,e.NORMAL=0,`NORMAL`) , __set$(e,e.ADD=1,`ADD`) , __set$(e,e.MULTIPLY=2,`MULTIPLY`) , __set$(e,e.SCREEN=3,`SCREEN`) , __set$(e,e.OVERLAY=4,`OVERLAY`) , __set$(e,e.DARKEN=5,`DARKEN`) , __set$(e,e.LIGHTEN=6,`LIGHTEN`) , __set$(e,e.COLOR_DODGE=7,`COLOR_DODGE`) , __set$(e,e.COLOR_BURN=8,`COLOR_BURN`) , __set$(e,e.HARD_LIGHT=9,`HARD_LIGHT`) , __set$(e,e.SOFT_LIGHT=10,`SOFT_LIGHT`) , __set$(e,e.DIFFERENCE=11,`DIFFERENCE`) , __set$(e,e.EXCLUSION=12,`EXCLUSION`) , __set$(e,e.HUE=13,`HUE`) , __set$(e,e.SATURATION=14,`SATURATION`) , __set$(e,e.COLOR=15,`COLOR`) , __set$(e,e.LUMINOSITY=16,`LUMINOSITY`) , __set$(e,e.NORMAL_NPM=17,`NORMAL_NPM`) , __set$(e,e.ADD_NPM=18,`ADD_NPM`) , __set$(e,e.SCREEN_NPM=19,`SCREEN_NPM`) , __set$(e,e.NONE=20,`NONE`) , __set$(e,e.SRC_OVER=0,`SRC_OVER`) , __set$(e,e.SRC_IN=21,`SRC_IN`) , __set$(e,e.SRC_OUT=22,`SRC_OUT`) , __set$(e,e.SRC_ATOP=23,`SRC_ATOP`) , __set$(e,e.DST_OVER=24,`DST_OVER`) , __set$(e,e.DST_IN=25,`DST_IN`) , __set$(e,e.DST_OUT=26,`DST_OUT`) , __set$(e,e.DST_ATOP=27,`DST_ATOP`) , __set$(e,e.ERASE=26,`ERASE`) , __set$(e,e.SUBTRACT=28,`SUBTRACT`) , __set$(e,e.XOR=29,`XOR`) })(KT||={}),(function(e){ __set$(e,e.POINTS=0,`POINTS`) , __set$(e,e.LINES=1,`LINES`) , __set$(e,e.LINE_LOOP=2,`LINE_LOOP`) , __set$(e,e.LINE_STRIP=3,`LINE_STRIP`) , __set$(e,e.TRIANGLES=4,`TRIANGLES`) , __set$(e,e.TRIANGLE_STRIP=5,`TRIANGLE_STRIP`) , __set$(e,e.TRIANGLE_FAN=6,`TRIANGLE_FAN`) })(qT||={}),(function(e){ __set$(e,e.RGBA=6408,`RGBA`) , __set$(e,e.RGB=6407,`RGB`) , __set$(e,e.ALPHA=6406,`ALPHA`) , __set$(e,e.LUMINANCE=6409,`LUMINANCE`) , __set$(e,e.LUMINANCE_ALPHA=6410,`LUMINANCE_ALPHA`) , __set$(e,e.DEPTH_COMPONENT=6402,`DEPTH_COMPONENT`) , __set$(e,e.DEPTH_STENCIL=34041,`DEPTH_STENCIL`) })(JT||={}),(function(e){ __set$(e,e.TEXTURE_2D=3553,`TEXTURE_2D`) , __set$(e,e.TEXTURE_CUBE_MAP=34067,`TEXTURE_CUBE_MAP`) , __set$(e,e.TEXTURE_2D_ARRAY=35866,`TEXTURE_2D_ARRAY`) , __set$(e,e.TEXTURE_CUBE_MAP_POSITIVE_X=34069,`TEXTURE_CUBE_MAP_POSITIVE_X`) , __set$(e,e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,`TEXTURE_CUBE_MAP_NEGATIVE_X`) , __set$(e,e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,`TEXTURE_CUBE_MAP_POSITIVE_Y`) , __set$(e,e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,`TEXTURE_CUBE_MAP_NEGATIVE_Y`) , __set$(e,e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,`TEXTURE_CUBE_MAP_POSITIVE_Z`) , __set$(e,e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,`TEXTURE_CUBE_MAP_NEGATIVE_Z`) })(YT||={}),(function(e){ __set$(e,e.UNSIGNED_BYTE=5121,`UNSIGNED_BYTE`) , __set$(e,e.UNSIGNED_SHORT=5123,`UNSIGNED_SHORT`) , __set$(e,e.UNSIGNED_SHORT_5_6_5=33635,`UNSIGNED_SHORT_5_6_5`) , __set$(e,e.UNSIGNED_SHORT_4_4_4_4=32819,`UNSIGNED_SHORT_4_4_4_4`) , __set$(e,e.UNSIGNED_SHORT_5_5_5_1=32820,`UNSIGNED_SHORT_5_5_5_1`) , __set$(e,e.FLOAT=5126,`FLOAT`) , __set$(e,e.HALF_FLOAT=36193,`HALF_FLOAT`) })(XT||={}),(function(e){ __set$(e,e.NEAREST=0,`NEAREST`) , __set$(e,e.LINEAR=1,`LINEAR`) })(ZT||={}),(function(e){ __set$(e,e.CLAMP=33071,`CLAMP`) , __set$(e,e.REPEAT=10497,`REPEAT`) , __set$(e,e.MIRRORED_REPEAT=33648,`MIRRORED_REPEAT`) })(QT||={}),(function(e){ __set$(e,e.OFF=0,`OFF`) , __set$(e,e.POW2=1,`POW2`) , __set$(e,e.ON=2,`ON`) })($T||={}),(function(e){ __set$(e,e.NPM=0,`NPM`) , __set$(e,e.UNPACK=1,`UNPACK`) , __set$(e,e.PMA=2,`PMA`) , __set$(e,e.NO_PREMULTIPLIED_ALPHA=0,`NO_PREMULTIPLIED_ALPHA`) , __set$(e,e.PREMULTIPLY_ON_UPLOAD=1,`PREMULTIPLY_ON_UPLOAD`) , __set$(e,e.PREMULTIPLY_ALPHA=2,`PREMULTIPLY_ALPHA`) })(eE||={}),(function(e){ __set$(e,e.AUTO=0,`AUTO`) , __set$(e,e.MANUAL=1,`MANUAL`) })(tE||={}),(function(e){e.LOW=`lowp`,e.MEDIUM=`mediump`,e.HIGH=`highp`})(nE||={}),(function(e){ __set$(e,e.NONE=0,`NONE`) , __set$(e,e.SCISSOR=1,`SCISSOR`) , __set$(e,e.STENCIL=2,`STENCIL`) , __set$(e,e.SPRITE=3,`SPRITE`) })(rE||={}),hT.RETINA_PREFIX=/@([0-9\.]+)x/,hT.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0,iE=!1,aE=`5.2.1`,sE=py(),cE=0,lE={},uE={},dE=Object.create(null),fE=Object.create(null),pE=function(){function e(e,t,n){this.canvas=document.createElement(`canvas`),this.context=this.canvas.getContext(`2d`),this.resolution=n||hT.RESOLUTION,this.resize(e,t)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(e.prototype,`width`,{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,`height`,{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!0,configurable:!0}),e}(),hE=function(){function e(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},e.prototype.copyTo=function(e){return e.set(this.x,this.y),e},e.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},e.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x=e,this.y=t,this},e}(),gE=function(){function e(e,t,n,r){n===void 0&&(n=0),r===void 0&&(r=0),this._x=n,this._y=r,this.cb=e,this.scope=t}return e.prototype.clone=function(t,n){return t===void 0&&(t=this.cb),n===void 0&&(n=this.scope),new e(t,n,this._x,this._y)},e.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this},e.prototype.copyFrom=function(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},e.prototype.copyTo=function(e){return e.set(this._x,this._y),e},e.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},Object.defineProperty(e.prototype,`x`,{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,`y`,{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),e}(),_E=Math.PI*2,vE=180/Math.PI,yE=Math.PI/180,(function(e){ __set$(e,e.POLY=0,`POLY`) , __set$(e,e.RECT=1,`RECT`) , __set$(e,e.CIRC=2,`CIRC`) , __set$(e,e.ELIP=3,`ELIP`) , __set$(e,e.RREC=4,`RREC`) })(bE||={}),xE=function(){function e(e,t,n,r,i,a){e===void 0&&(e=1),t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=1),i===void 0&&(i=0),a===void 0&&(a=0),this.array=null,this.a=e,this.b=t,this.c=n,this.d=r,this.tx=i,this.ty=a}return e.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},e.prototype.set=function(e,t,n,r,i,a){return this.a=e,this.b=t,this.c=n,this.d=r,this.tx=i,this.ty=a,this},e.prototype.toArray=function(e,t){this.array||=new Float32Array(9);var n=t||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},e.prototype.apply=function(e,t){t||=new hE;var n=e.x,r=e.y;return t.x=this.a*n+this.c*r+this.tx,t.y=this.b*n+this.d*r+this.ty,t},e.prototype.applyInverse=function(e,t){t||=new hE;var n=1/(this.a*this.d+this.c*-this.b),r=e.x,i=e.y;return t.x=this.d*n*r+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,t.y=this.a*n*i+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,t},e.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},e.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},e.prototype.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),r=this.a,i=this.c,a=this.tx;return this.a=r*t-this.b*n,this.b=r*n+this.b*t,this.c=i*t-this.d*n,this.d=i*n+this.d*t,this.tx=a*t-this.ty*n,this.ty=a*n+this.ty*t,this},e.prototype.append=function(e){var t=this.a,n=this.b,r=this.c,i=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*n+e.b*i,this.c=e.c*t+e.d*r,this.d=e.c*n+e.d*i,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*n+e.ty*i+this.ty,this},e.prototype.setTransform=function(e,t,n,r,i,a,o,s,c){return this.a=Math.cos(o+c)*i,this.b=Math.sin(o+c)*i,this.c=-Math.sin(o-s)*a,this.d=Math.cos(o-s)*a,this.tx=e-(n*this.a+r*this.c),this.ty=t-(n*this.b+r*this.d),this},e.prototype.prepend=function(e){var t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){var n=this.a,r=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},e.prototype.decompose=function(e){var t=this.a,n=this.b,r=this.c,i=this.d,a=-Math.atan2(-r,i),o=Math.atan2(n,t),s=Math.abs(a+o);return s<1e-5||Math.abs(_E-s)<1e-5?(e.rotation=o,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=o),e.scale.x=Math.sqrt(t*t+n*n),e.scale.y=Math.sqrt(r*r+i*i),e.position.x=this.tx,e.position.y=this.ty,e},e.prototype.invert=function(){var e=this.a,t=this.b,n=this.c,r=this.d,i=this.tx,a=e*r-t*n;return this.a=r/a,this.b=-t/a,this.c=-n/a,this.d=e/a,this.tx=(n*this.ty-r*i)/a,this.ty=-(e*this.ty-t*i)/a,this},e.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},e.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},Object.defineProperty(e,`IDENTITY`,{get:function(){return new e},enumerable:!0,configurable:!0}),Object.defineProperty(e,`TEMP_MATRIX`,{get:function(){return new e},enumerable:!0,configurable:!0}),e}(),SE=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],CE=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],wE=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],TE=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],EE=[],DE=[],OE=Math.sign,ky(),kE={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(e){return  __get$(SE,e) },uY:function(e){return  __get$(CE,e) },vX:function(e){return  __get$(wE,e) },vY:function(e){return  __get$(TE,e) },inv:function(e){return e&8?e&15:-e&7},add:function(e,t){return  __get$(__get$(EE,e),t) },sub:function(e,t){return  __get$(__get$(EE,e),kE.inv(t)) },rotate180:function(e){return e^4},isVertical:function(e){return(e&3)==2},byDirection:function(e,t){return Math.abs(e)*2<=Math.abs(t)?t>=0?kE.S:kE.N:Math.abs(t)*2<=Math.abs(e)?e>0?kE.E:kE.W:t>0?e>0?kE.SE:kE.SW:e>0?kE.NE:kE.NW},matrixAppendRotationInv:function(e,t,n,r){n===void 0&&(n=0),r===void 0&&(r=0);var i= __get$(DE,kE.inv(t)) ;i.tx=n,i.ty=r,e.append(i)}},AE=function(){function e(){this.worldTransform=new xE,this.localTransform=new xE,this.position=new gE(this.onChange,this,0,0),this.scale=new gE(this.onChange,this,1,1),this.pivot=new gE(this.onChange,this,0,0),this.skew=new gE(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},e.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var n=e.worldTransform,r=this.worldTransform;r.a=t.a*n.a+t.b*n.c,r.b=t.a*n.b+t.b*n.d,r.c=t.c*n.a+t.d*n.c,r.d=t.c*n.b+t.d*n.d,r.tx=t.tx*n.a+t.ty*n.c+n.tx,r.ty=t.tx*n.b+t.ty*n.d+n.ty,this._parentID=e._worldID,this._worldID++}},e.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(e.prototype,`rotation`,{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!0,configurable:!0}),e.IDENTITY=new e,e}(),jE=function(){function e(e,t,n,r){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),this.x=Number(e),this.y=Number(t),this.width=Number(n),this.height=Number(r),this.type=bE.RECT}return Object.defineProperty(e.prototype,`left`,{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,`right`,{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,`top`,{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,`bottom`,{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e,`EMPTY`,{get:function(){return new e(0,0,0,0)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},e.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},e.prototype.contains=function(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height},e.prototype.pad=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this},e.prototype.fit=function(e){var t=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(n-t,0),this.y=r,this.height=Math.max(i-r,0),this},e.prototype.ceil=function(e,t){e===void 0&&(e=1),t===void 0&&(t=.001);var n=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=n-this.x,this.height=r-this.y,this},e.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=n-t,this.y=r,this.height=i-r,this},e}(),ME=function(){function e(e,t,n){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),this.x=e,this.y=t,this.radius=n,this.type=bE.CIRC}return e.prototype.clone=function(){return new e(this.x,this.y,this.radius)},e.prototype.contains=function(e,t){if(this.radius<=0)return!1;var n=this.radius*this.radius,r=this.x-e,i=this.y-t;return r*=r,i*=i,r+i<=n},e.prototype.getBounds=function(){return new jE(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},e}(),NE=function(){function e(e,t,n,r){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),this.x=e,this.y=t,this.width=n,this.height=r,this.type=bE.ELIP}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var n=(e-this.x)/this.width,r=(t-this.y)/this.height;return n*=n,r*=r,n+r<=1},e.prototype.getBounds=function(){return new jE(this.x-this.width,this.y-this.height,this.width,this.height)},e}(),PE=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++) __set$(t,n,__get$(e,n)) ;if(Array.isArray(t[0])&&(t=t[0]),t[0]instanceof hE){t=t;for(var r=[],i=0,a=t.length;i<a;i++)r.push( __get$(t,i) .x, __get$(t,i) .y);t=r}this.points=t,this.type=bE.POLY,this.closeStroke=!0}return e.prototype.clone=function(){var t=new e(this.points.slice());return t.closeStroke=this.closeStroke,t},e.prototype.contains=function(e,t){for(var n=!1,r=this.points.length/2,i=0,a=r-1;i<r;a=i++){var o= __get$(this.points,i*2) ,s= __get$(this.points,i*2+1) ,c= __get$(this.points,a*2) ,l= __get$(this.points,a*2+1) ;s>t!=l>t&&e<(c-o)*((t-s)/(l-s))+o&&(n=!n)}return n},e}(),FE=function(){function e(e,t,n,r,i){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=20),this.x=e,this.y=t,this.width=n,this.height=r,this.radius=i,this.type=bE.RREC}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.radius)},e.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){if(t>=this.y+this.radius&&t<=this.y+this.height-this.radius||e>=this.x+this.radius&&e<=this.x+this.width-this.radius)return!0;var n=e-(this.x+this.radius),r=t-(this.y+this.radius),i=this.radius*this.radius;if(n*n+r*r<=i||(n=e-(this.x+this.width-this.radius),n*n+r*r<=i)||(r=t-(this.y+this.height-this.radius),n*n+r*r<=i)||(n=e-(this.x+this.radius),n*n+r*r<=i))return!0}return!1},e}(),hT.SORTABLE_CHILDREN=!1,IE=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null},IE.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},IE.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},IE.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?jE.EMPTY:(e||=new jE(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},IE.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},IE.prototype.addQuad=function(e){var t=this.minX,n=this.minY,r=this.maxX,i=this.maxY,a=e[0],o=e[1];t=a<t?a:t,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,a=e[2],o=e[3],t=a<t?a:t,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,a=e[4],o=e[5],t=a<t?a:t,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,a=e[6],o=e[7],t=a<t?a:t,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,this.minX=t,this.minY=n,this.maxX=r,this.maxY=i},IE.prototype.addFrame=function(e,t,n,r,i){this.addFrameMatrix(e.worldTransform,t,n,r,i)},IE.prototype.addFrameMatrix=function(e,t,n,r,i){var a=e.a,o=e.b,s=e.c,c=e.d,l=e.tx,u=e.ty,d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,h=a*t+s*n+l,g=o*t+c*n+u;d=h<d?h:d,f=g<f?g:f,p=h>p?h:p,m=g>m?g:m,h=a*r+s*n+l,g=o*r+c*n+u,d=h<d?h:d,f=g<f?g:f,p=h>p?h:p,m=g>m?g:m,h=a*t+s*i+l,g=o*t+c*i+u,d=h<d?h:d,f=g<f?g:f,p=h>p?h:p,m=g>m?g:m,h=a*r+s*i+l,g=o*r+c*i+u,d=h<d?h:d,f=g<f?g:f,p=h>p?h:p,m=g>m?g:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m},IE.prototype.addVertexData=function(e,t,n){for(var r=this.minX,i=this.minY,a=this.maxX,o=this.maxY,s=t;s<n;s+=2){var c= __get$(e,s) ,l= __get$(e,s+1) ;r=c<r?c:r,i=l<i?l:i,a=c>a?c:a,o=l>o?l:o}this.minX=r,this.minY=i,this.maxX=a,this.maxY=o},IE.prototype.addVertices=function(e,t,n,r){this.addVerticesMatrix(e.worldTransform,t,n,r)},IE.prototype.addVerticesMatrix=function(e,t,n,r,i,a){var o=e.a,s=e.b,c=e.c,l=e.d,u=e.tx,d=e.ty;i||=0,a||=0;for(var f=this.minX,p=this.minY,m=this.maxX,h=this.maxY,g=n;g<r;g+=2){var _= __get$(t,g) ,v= __get$(t,g+1) ,y=o*_+c*v+u,b=l*v+s*_+d;f=Math.min(f,y-i),m=Math.max(m,y+i),p=Math.min(p,b-a),h=Math.max(h,b+a)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=h},IE.prototype.addBounds=function(e){var t=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>i?e.maxY:i},IE.prototype.addBoundsMask=function(e,t){var n=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,i=e.maxX<t.maxX?e.maxX:t.maxX,a=e.maxY<t.maxY?e.maxY:t.maxY;if(n<=i&&r<=a){var o=this.minX,s=this.minY,c=this.maxX,l=this.maxY;this.minX=n<o?n:o,this.minY=r<s?r:s,this.maxX=i>c?i:c,this.maxY=a>l?a:l}},IE.prototype.addBoundsMatrix=function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},IE.prototype.addBoundsArea=function(e,t){var n=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,i=e.maxX<t.x+t.width?e.maxX:t.x+t.width,a=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(n<=i&&r<=a){var o=this.minX,s=this.minY,c=this.maxX,l=this.maxY;this.minX=n<o?n:o,this.minY=r<s?r:s,this.maxX=i>c?i:c,this.maxY=a>l?a:l}},IE.prototype.pad=function(e,t){e||=0,t||=t===0?0:e,this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},IE.prototype.addFramePad=function(e,t,n,r,i,a){e-=i,t-=a,n+=i,r+=a,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r},LE=function(e){function t(){e.call(this),this.tempDisplayObjectParent=null,this.transform=new AE,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new IE,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return t.mixin=function(e){for(var n=Object.keys(e),r=0;r<n.length;++r){var i= __get$(n,r) ;Object.defineProperty(t.prototype,i,Object.getOwnPropertyDescriptor(e,i))}},n._tempDisplayObjectParent.get=function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new t),this.tempDisplayObjectParent},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.calculateBounds=function(){},t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.getBounds=function(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),t||=(this._boundsRect||=new jE,this._boundsRect),this._bounds.getRectangle(t)},t.prototype.getLocalBounds=function(e){var t=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,e||=(this._localBoundsRect||=new jE,this._localBoundsRect);var r=this.getBounds(!1,e);return this.parent=n,this.transform=t,r},t.prototype.toGlobal=function(e,t,n){return n===void 0&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)},t.prototype.toLocal=function(e,t,n,r){return t&&(e=t.toGlobal(e,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)},t.prototype.render=function(e){},t.prototype.setParent=function(e){if(!e||!e.addChild)throw Error(`setParent: Argument must be a Container`);return e.addChild(this),e},t.prototype.setTransform=function(e,t,n,r,i,a,o,s,c){return e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),c===void 0&&(c=0),this.position.x=e,this.position.y=t,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=a,this.skew.y=o,this.pivot.x=s,this.pivot.y=c,this},t.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},n.x.get=function(){return this.position.x},n.x.set=function(e){this.transform.position.x=e},n.y.get=function(){return this.position.y},n.y.set=function(e){this.transform.position.y=e},n.worldTransform.get=function(){return this.transform.worldTransform},n.localTransform.get=function(){return this.transform.localTransform},n.position.get=function(){return this.transform.position},n.position.set=function(e){this.transform.position.copyFrom(e)},n.scale.get=function(){return this.transform.scale},n.scale.set=function(e){this.transform.scale.copyFrom(e)},n.pivot.get=function(){return this.transform.pivot},n.pivot.set=function(e){this.transform.pivot.copyFrom(e)},n.skew.get=function(){return this.transform.skew},n.skew.set=function(e){this.transform.skew.copyFrom(e)},n.rotation.get=function(){return this.transform.rotation},n.rotation.set=function(e){this.transform.rotation=e},n.angle.get=function(){return this.transform.rotation*vE},n.angle.set=function(e){this.transform.rotation=e*yE},n.zIndex.get=function(){return this._zIndex},n.zIndex.set=function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},n.worldVisible.get=function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},n.mask.get=function(){return this._mask},n.mask.set=function(e){if(this._mask){var t=this._mask.maskObject||this._mask;t.renderable=!0,t.isMask=!1}if(this._mask=e,this._mask){var n=this._mask.maskObject||this._mask;n.renderable=!1,n.isMask=!0}},Object.defineProperties(t.prototype,n),t}(_T),LE.prototype.displayObjectUpdateTransform=LE.prototype.updateTransform,RE=function(e){function t(){e.call(this),this.children=[],this.sortableChildren=hT.SORTABLE_CHILDREN,this.sortDirty=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={width:{configurable:!0},height:{configurable:!0}};return t.prototype.onChildrenChange=function(){},t.prototype.addChild=function(e){var t=arguments,n=arguments.length;if(n>1)for(var r=0;r<n;r++)this.addChild( __get$(t,r) );else e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit(`childAdded`,e,this,this.children.length-1),e.emit(`added`,this);return e},t.prototype.addChildAt=function(e,t){if(t<0||t>this.children.length)throw Error(e+`addChildAt: The index `+t+` supplied is out of bounds `+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit(`added`,this),this.emit(`childAdded`,e,this,t),e},t.prototype.swapChildren=function(e,t){if(e!==t){var n=this.getChildIndex(e),r=this.getChildIndex(t); __set$(this.children,n,t) , __set$(this.children,r,e) ,this.onChildrenChange(n<r?n:r)}},t.prototype.getChildIndex=function(e){var t=this.children.indexOf(e);if(t===-1)throw Error(`The supplied DisplayObject must be a child of the caller`);return t},t.prototype.setChildIndex=function(e,t){if(t<0||t>=this.children.length)throw Error(`The index `+t+` supplied is out of bounds `+this.children.length);var n=this.getChildIndex(e);Sy(this.children,n,1),this.children.splice(t,0,e),this.onChildrenChange(t)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw Error(`getChildAt: Index (`+e+`) does not exist.`);return  __get$(this.children,e) },t.prototype.removeChild=function(e){var t=arguments,n=arguments.length;if(n>1)for(var r=0;r<n;r++)this.removeChild( __get$(t,r) );else{var i=this.children.indexOf(e);if(i===-1)return null;e.parent=null,e.transform._parentID=-1,Sy(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit(`removed`,this),this.emit(`childRemoved`,e,this,i)}return e},t.prototype.removeChildAt=function(e){var t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Sy(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit(`removed`,this),this.emit(`childRemoved`,t,this,e),t},t.prototype.removeChildren=function(e,t){e===void 0&&(e=0);var n=e,r=typeof t==`number`?t:this.children.length,i=r-n,a;if(i>0&&i<=r){a=this.children.splice(n,i);for(var o=0;o<a.length;++o) __get$(a,o) .parent=null, __get$(a,o) .transform&&( __get$(a,o) .transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var s=0;s<a.length;++s) __get$(a,s) .emit(`removed`,this),this.emit(`childRemoved`, __get$(a,s) ,this,s);return a}else if(i===0&&this.children.length===0)return[];throw RangeError(`removeChildren: numeric values are outside the acceptable range.`)},t.prototype.sortChildren=function(){for(var e=!1,t=0,n=this.children.length;t<n;++t){var r= __get$(this.children,t) ;r._lastSortedIndex=t,!e&&r.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(Ay),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,t=this.children.length;e<t;++e){var n= __get$(this.children,e) ;n.visible&&n.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var t= __get$(this.children,e) ;if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){var n=t._mask.maskObject||t._mask;n.calculateBounds(),this._bounds.addBoundsMask(t._bounds,n._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.render=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else{this._render(e);for(var t=0,n=this.children.length;t<n;++t) __get$(this.children,t) .render(e)}},t.prototype.renderAdvanced=function(e){e.batch.flush();var t=this.filters,n=this._mask;if(t){this._enabledFilters||=[],this._enabledFilters.length=0;for(var r=0;r<t.length;r++) __get$(t,r) .enabled&&this._enabledFilters.push( __get$(t,r) );this._enabledFilters.length&&e.filter.push(this,this._enabledFilters)}n&&e.mask.push(this,this._mask),this._render(e);for(var i=0,a=this.children.length;i<a;i++) __get$(this.children,i) .render(e);e.batch.flush(),n&&e.mask.pop(this,this._mask),t&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(t){e.prototype.destroy.call(this),this.sortDirty=!1;var n=typeof t==`boolean`?t:t&&t.children,r=this.removeChildren(0,this.children.length);if(n)for(var i=0;i<r.length;++i) __get$(r,i) .destroy(t)},n.width.get=function(){return this.scale.x*this.getLocalBounds().width},n.width.set=function(e){var t=this.getLocalBounds().width;t===0?this.scale.x=1:this.scale.x=e/t,this._width=e},n.height.get=function(){return this.scale.y*this.getLocalBounds().height},n.height.set=function(e){var t=this.getLocalBounds().height;t===0?this.scale.y=1:this.scale.y=e/t,this._height=e},Object.defineProperties(t.prototype,n),t}(LE),RE.prototype.containerUpdateTransform=RE.prototype.updateTransform,hT.TARGET_FPMS=.06,(function(e){ __set$(e,e.INTERACTION=50,`INTERACTION`) , __set$(e,e.HIGH=25,`HIGH`) , __set$(e,e.NORMAL=0,`NORMAL`) , __set$(e,e.LOW=-25,`LOW`) , __set$(e,e.UTILITY=-50,`UTILITY`) })(zE||={}),BE=function(){function e(e,t,n,r){t===void 0&&(t=null),n===void 0&&(n=0),r===void 0&&(r=!1),this.fn=e,this.context=t,this.priority=n,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}return e.prototype.match=function(e,t){return t===void 0&&(t=null),this.fn===e&&this.context===t},e.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},e.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},e.prototype.destroy=function(e){e===void 0&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},e}(),VE=function(){function e(){var e=this;this._head=new BE(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/hT.TARGET_FPMS,this.elapsedMS=1/hT.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&e._requestId===null&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return e.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(e,t,n){return n===void 0&&(n=zE.NORMAL),this._addListener(new BE(e,t,n))},e.prototype.addOnce=function(e,t,n){return n===void 0&&(n=zE.NORMAL),this._addListener(new BE(e,t,n,!0))},e.prototype._addListener=function(e){var t=this._head.next,n=this._head;if(!t)e.connect(n);else{for(;t;){if(e.priority>t.priority){e.connect(n);break}n=t,t=t.next}e.previous||e.connect(n)}return this._startIfPossible(),this},e.prototype.remove=function(e,t){for(var n=this._head.next;n;)n=n.match(e,t)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(e.prototype,`count`,{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},e.prototype.update=function(e){e===void 0&&(e=performance.now());var t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*hT.TARGET_FPMS;for(var r=this._head,i=r.next;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(e.prototype,`FPS`,{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,`minFPS`,{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e);this._maxElapsedMS=1/Math.min(Math.max(0,t)/1e3,hT.TARGET_FPMS)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,`maxFPS`,{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){e===0?this._minElapsedMS=0:this._minElapsedMS=1/(Math.max(this.minFPS,e)/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(e,`shared`,{get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared},enumerable:!0,configurable:!0}),Object.defineProperty(e,`system`,{get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system},enumerable:!0,configurable:!0}),e}(),HE=function(){function e(){}return e.init=function(e){var t=this;e= __call$(Object,"assign",[{autoStart:!0,sharedTicker:!1},e]) ,Object.defineProperty(this,`ticker`,{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,zE.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?VE.shared:new VE,e.autoStart&&this.start()},e.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},e}(),UE=function(){function e(e){this.items=[],this._name=e,this._aliasCount=0}return e.prototype.emit=function(e,t,n,r,i,a,o,s){if(arguments.length>8)throw Error(`max arguments reached`);var c=this,l=c.name,u=c.items;this._aliasCount++;for(var d=0,f=u.length;d<f;d++) __call$(__get$(u,d),l,[e,t,n,r,i,a,o,s]) ;return u===this.items&&this._aliasCount--,this},e.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},e.prototype.add=function(e){return  __get$(e,this._name) &&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},e.prototype.remove=function(e){var t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},e.prototype.contains=function(e){return this.items.indexOf(e)!==-1},e.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},e.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(e.prototype,`empty`,{get:function(){return this.items.length===0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,`name`,{get:function(){return this._name},enumerable:!0,configurable:!0}),e}(),Object.defineProperties(UE.prototype,{dispatch:{value:UE.prototype.emit},run:{value:UE.prototype.emit}}),WE=function(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new UE(`setRealSize`,2),this.onUpdate=new UE(`update`),this.onError=new UE(`onError`,1)},GE={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}},WE.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.run(this._width,this._height)},WE.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},WE.prototype.resize=function(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.run(e,t))},GE.valid.get=function(){return!!this._width&&!!this._height},WE.prototype.update=function(){this.destroyed||this.onUpdate.run()},WE.prototype.load=function(){return Promise.resolve()},GE.width.get=function(){return this._width},GE.height.get=function(){return this._height},WE.prototype.upload=function(e,t,n){return!1},WE.prototype.style=function(e,t,n){return!1},WE.prototype.dispose=function(){},WE.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(WE.prototype,GE),KE=function(e){function t(t){var n=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;e.call(this,n,r),this.source=t,this.noSubImage=!1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.crossOrigin=function(e,t,n){n===void 0&&t.indexOf(`data:`)!==0?e.crossOrigin=Dy(t):n!==!1&&(e.crossOrigin=typeof n==`string`?n:`anonymous`)},t.prototype.upload=function(e,t,n,r){var i=e.gl,a=t.realWidth,o=t.realHeight;return r||=this.source,i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===eE.UNPACK),!this.noSubImage&&t.target===i.TEXTURE_2D&&n.width===a&&n.height===o?i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,t.type,r):(n.width=a,n.height=o,i.texImage2D(t.target,0,t.format,t.format,t.type,r)),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,n=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,n),e.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(WE),qE=function(e){function t(t,n){if(n||={},!(t instanceof HTMLImageElement)){var r=new Image;e.crossOrigin(r,t,n.crossorigin),r.src=t,t=r}e.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(n.createBitmap===void 0?hT.CREATE_IMAGE_BITMAP:n.createBitmap)&&!!window.createImageBitmap,this.alphaMode=typeof n.alphaMode==`number`?n.alphaMode:null,n.premultiplyAlpha!==void 0&&(this.premultiplyAlpha=n.premultiplyAlpha),this.bitmap=null,this._load=null,n.autoLoad!==!1&&this.load()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(e){var t=this;return e!==void 0&&(this.createBitmap=e),this._load||=new Promise(function(e){t.url=t.source.src;var n=t.source,r=function(){t.destroyed||(n.onload=null,n.onerror=null,t.resize(n.width,n.height),t._load=null,t.createBitmap?e(t.process()):e(t))};n.complete&&n.src?r():(n.onload=r,n.onerror=function(e){return t.onError.run(e)})}),this._load},t.prototype.process=function(){var e=this;return this._process===null?this.bitmap!==null||!window.createImageBitmap?Promise.resolve(this):(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===eE.UNPACK?`premultiply`:`none`}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):this._process},t.prototype.upload=function(t,n,r){if(typeof this.alphaMode==`number`&&(n.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,n,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,n,r,this.bitmap),!this.preserveBitmap){var i=!0;for(var a in n._glTextures){var o= __get$(n._glTextures,a) ;if(o!==r&&o.dirtyId!==n.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&=(this.bitmap.close(),null),this._process=null,this._load=null},t}(KE),JE=[],YE=function(e){function t(t,n){var r=n||{},i=r.width,a=r.height;if(!i||!a)throw Error(`BufferResource width or height invalid`);e.call(this,i,a),this.data=t}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.upload=function(e,t,n){var r=e.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===eE.UNPACK),n.width===t.width&&n.height===t.height?r.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(n.width=t.width,n.height=t.height,r.texImage2D(t.target,0,n.internalFormat,t.width,t.height,0,t.format,n.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(WE),XE={scaleMode:ZT.NEAREST,format:JT.RGBA,alphaMode:eE.NPM},ZE=function(e){function t(t,n){t===void 0&&(t=null),n===void 0&&(n=null),e.call(this),n||={};var r=n.alphaMode,i=n.mipmap,a=n.anisotropicLevel,o=n.scaleMode,s=n.width,c=n.height,l=n.wrapMode,u=n.format,d=n.type,f=n.target,p=n.resolution,m=n.resourceOptions;t&&!(t instanceof WE)&&(t=jy(t,m),t.internal=!0),this.width=s||0,this.height=c||0,this.resolution=p||hT.RESOLUTION,this.mipmap=i===void 0?hT.MIPMAP_TEXTURES:i,this.anisotropicLevel=a===void 0?hT.ANISOTROPIC_LEVEL:a,this.wrapMode=l||hT.WRAP_MODE,this.scaleMode=o===void 0?hT.SCALE_MODE:o,this.format=u||JT.RGBA,this.type=d||XT.UNSIGNED_BYTE,this.target=f||YT.TEXTURE_2D,this.alphaMode=r===void 0?eE.UNPACK:r,n.premultiplyAlpha!==void 0&&(this.premultiplyAlpha=n.premultiplyAlpha),this.uid=wy(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=s>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={realWidth:{configurable:!0},realHeight:{configurable:!0}};return n.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},n.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},t.prototype.setStyle=function(e,t){var n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,n=!0),n&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,t,n){return this.resolution=n||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},t.prototype.setRealSize=function(e,t,n){return this.resolution=n||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=by(this.realWidth)&&by(this.realHeight)},t.prototype.setResolution=function(e){var t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit(`update`,this)),this._refreshPOT(),this)},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw Error(`Resource can be set only once`);return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit(`update`,this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit(`loaded`,this),this.emit(`update`,this))},t.prototype.onError=function(e){this.emit(`error`,this,e)},t.prototype.destroy=function(){this.resource&&=(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),null),this.cacheId&&=(delete fE[this.cacheId],delete dE[this.cacheId],null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit(`dispose`,this)},t.from=function(e,n,r){r===void 0&&(r=hT.STRICT_TEXTURE_CACHE);var i=typeof e==`string`,a=null;i?a=e:(e._pixiId||=`pixiid_`+wy(),a=e._pixiId);var o= __get$(fE,a) ;if(i&&r&&!o)throw Error(`The cacheId "`+a+`" does not exist in BaseTextureCache.`);return o||(o=new t(e,n),o.cacheId=a,t.addToCache(o,a)),o},t.fromBuffer=function(e,n,r,i){e||=new Float32Array(n*r*4);var a=new YE(e,{width:n,height:r}),o=e instanceof Float32Array?XT.FLOAT:XT.UNSIGNED_BYTE;return  new t(a,__call$(Object,"assign",[XE,i||{width:n,height:r,type:o}])) },t.addToCache=function(e,t){t&&(e.textureCacheIds.indexOf(t)===-1&&e.textureCacheIds.push(t), __get$(fE,t) &&console.warn(`BaseTexture added to the cache with an id [`+t+`] that already had an entry`), __set$(fE,t,e) )},t.removeFromCache=function(e){if(typeof e==`string`){var t= __get$(fE,e) ;if(t){var n=t.textureCacheIds.indexOf(e);return n>-1&&t.textureCacheIds.splice(n,1),delete fE[e],t}}else if(e&&e.textureCacheIds){for(var r=0;r<e.textureCacheIds.length;++r)delete fE[ __get$(e.textureCacheIds,r) ];return e.textureCacheIds.length=0,e}return null},Object.defineProperties(t.prototype,n),t}(_T),ZE._globalBatch=0,QE=function(e){function t(t,n){n||={};var r,i=t;Array.isArray(t)&&(r=t,i=t.length),e.call(this,n.width,n.height),this.items=[],this.itemDirtyIds=[];for(var a=0;a<i;a++){var o=new ZE;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=i,this._load=null,r)for(var s=0;s<i;s++)this.addResourceAt(jy( __get$(r,s) ,n),s)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.dispose=function(){for(var e=0,t=this.length;e<t;e++) __get$(this.items,e) .destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,t){if(! __get$(this.items,t) )throw Error(`Index `+t+` is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height), __get$(this.items,t) .setResource(e),this},t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=YT.TEXTURE_2D_ARRAY;for(var n=0;n<this.length;n++) __get$(this.items,n) .on(`update`,t.update,t)},t.prototype.unbind=function(t){e.prototype.unbind.call(this,t);for(var n=0;n<this.length;n++) __get$(this.items,n) .off(`update`,t.update,t)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.items.map(function(e){return e.resource}),n=t.map(function(e){return e.load()});return this._load=Promise.all(n).then(function(){var n=t[0],r=n.width,i=n.height;return e.resize(r,i),Promise.resolve(e)}),this._load},t.prototype.upload=function(e,t,n){var r=this,i=r.length,a=r.itemDirtyIds,o=r.items,s=e.gl;n.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,i,0,t.format,t.type,null);for(var c=0;c<i;c++){var l= __get$(o,c) ; __get$(a,c) <l.dirtyId&&( __set$(a,c,l.dirtyId) ,l.valid&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,c,l.resource.width,l.resource.height,1,t.format,t.type,l.resource.source))}return!0},t}(WE),$E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.test=function(e){var t=window.OffscreenCanvas;return t&&e instanceof t?!0:e instanceof HTMLCanvasElement},t}(KE),eD=function(e){function t(n,r){if(r||={},e.call(this,n,r),this.length!==t.SIDES)throw Error(`Invalid length. Got `+this.length+`, expected 6`);for(var i=0;i<t.SIDES;i++) __get$(this.items,i) .target=YT.TEXTURE_CUBE_MAP_POSITIVE_X+i;r.autoLoad!==!1&&this.load()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=YT.TEXTURE_CUBE_MAP},t.prototype.upload=function(e,n,r){for(var i=this.itemDirtyIds,a=0;a<t.SIDES;a++){var o= __get$(this.items,a) ; __get$(i,a) <o.dirtyId&&( __set$(i,a,o.dirtyId) ,o.valid&&o.resource.upload(e,o,r))}return!0},t}(QE),eD.SIDES=6,tD=function(e){function t(t,n){n||={},e.call(this,document.createElement(`canvas`)),this._width=0,this._height=0,this.svg=t,this.scale=n.scale||1,this._overrideWidth=n.width,this._overrideHeight=n.height,this._resolve=null,this._crossorigin=n.crossorigin,this._load=null,n.autoLoad!==!1&&this.load()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(){var e=this;return this._load||=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw Error(`Your browser doesn't support base64 conversions.`);e.svg=`data:image/svg+xml;base64,`+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}),this._load},t.prototype._loadSvg=function(){var t=this,n=new Image;e.crossOrigin(n,this.svg,this._crossorigin),n.src=this.svg,n.onerror=function(e){n.onerror=null,t.onError.run(e)},n.onload=function(){var e=n.width,r=n.height;if(!e||!r)throw Error(`The SVG image must have width and height defined (in pixels), canvas API needs them.`);var i=e*t.scale,a=r*t.scale;(t._overrideWidth||t._overrideHeight)&&(i=t._overrideWidth||t._overrideHeight/r*e,a=t._overrideHeight||t._overrideWidth/e*r),i=Math.round(i),a=Math.round(a);var o=t.source;o.width=i,o.height=a,o._pixiId=`canvas_`+wy(),o.getContext(`2d`).drawImage(n,0,0,e,r,0,0,i,a),t._resolve(),t._resolve=null}},t.getSize=function(e){var n=t.SVG_SIZE.exec(e),r={};return n&&( __set$(r,n[1],Math.round(parseFloat(n[3]))) , __set$(r,n[5],Math.round(parseFloat(n[7]))) ),r},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,t){return t===`svg`||typeof e==`string`&&e.indexOf(`data:image/svg+xml;base64`)===0||typeof e==`string`&&e.indexOf(`<svg`)===0},t}(KE),tD.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,nD=function(e){function t(t,n){if(n||={},!(t instanceof HTMLVideoElement)){var r=document.createElement(`video`);r.setAttribute(`preload`,`auto`),r.setAttribute(`webkit-playsinline`,``),r.setAttribute(`playsinline`,``),typeof t==`string`&&(t=[t]),e.crossOrigin(r,t[0].src||t[0],n.crossorigin);for(var i=0;i<t.length;++i){var a=document.createElement(`source`),o= __get$(t,i) ,s=o.src,c=o.mime;s||= __get$(t,i) ;var l=s.split(`?`).shift().toLowerCase(),u=l.substr(l.lastIndexOf(`.`)+1);c||=`video/`+u,a.src=s,a.type=c,r.appendChild(a)}t=r}e.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,this._updateFPS=n.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=n.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),n.autoLoad!==!1&&this.load()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return t.prototype.update=function(t){if(t===void 0&&(t=0),!this.destroyed){var n=VE.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener(`play`,this._onPlayStart.bind(this)),t.addEventListener(`pause`,this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener(`canplay`,this._onCanPlay),t.addEventListener(`canplaythrough`,this._onCanPlay),t.addEventListener(`error`,this._onError,!0)),this._load=new Promise(function(n){e.valid?n(e):(e._resolve=n,t.load())}),this._load},t.prototype._onError=function(){this.source.removeEventListener(`error`,this._onError,!0),this.onError.run(event)},t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&e.paused===!1&&e.ended===!1&&e.readyState>2},t.prototype._isSourceReady=function(){return this.source.readyState===3||this.source.readyState===4},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(VE.shared.add(this.update,this),this._isAutoUpdating=!0)},t.prototype._onPlayStop=function(){this._isAutoUpdating&&=(VE.shared.remove(this.update,this),!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener(`canplay`,this._onCanPlay),e.removeEventListener(`canplaythrough`,this._onCanPlay);var t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isAutoUpdating&&VE.shared.remove(this.update,this),this.source&&(this.source.removeEventListener(`error`,this._onError,!0),this.source.pause(),this.source.src=``,this.source.load()),e.prototype.dispose.call(this)},n.autoUpdate.get=function(){return this._autoUpdate},n.autoUpdate.set=function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isAutoUpdating?(VE.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(VE.shared.add(this.update,this),this._isAutoUpdating=!0))},n.updateFPS.get=function(){return this._updateFPS},n.updateFPS.set=function(e){e!==this._updateFPS&&(this._updateFPS=e)},t.test=function(e,n){return e instanceof HTMLVideoElement||t.TYPES.indexOf(n)>-1},Object.defineProperties(t.prototype,n),t}(KE),nD.TYPES=[`mp4`,`m4v`,`webm`,`ogg`,`ogv`,`h264`,`avi`,`mov`],rD=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.test=function(e){return!!window.createImageBitmap&&e instanceof ImageBitmap},t}(KE),JE.push(qE,rD,$E,nD,tD,YE,eD,QE),iD=function(e){this.renderer=e},iD.prototype.destroy=function(){this.renderer=null},aD=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.upload=function(e,t,n){var r=e.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===eE.UNPACK),n.width===t.width&&n.height===t.height?r.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(n.width=t.width,n.height=t.height,r.texImage2D(t.target,0,r.DEPTH_COMPONENT16,t.width,t.height,0,t.format,t.type,this.data)),!0},t}(YE),oD=function(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new UE(`disposeFramebuffer`,2)},sD={colorTexture:{configurable:!0}},sD.colorTexture.get=function(){return this.colorTextures[0]},oD.prototype.addColorTexture=function(e,t){return e===void 0&&(e=0), __set$(this.colorTextures,e,t||new ZE(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height})) ,this.dirtyId++,this.dirtyFormat++,this},oD.prototype.addDepthTexture=function(e){return this.depthTexture=e||new ZE(new aD(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:JT.DEPTH_COMPONENT,type:XT.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},oD.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},oD.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},oD.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var r= __get$(this.colorTextures,n) ,i=r.resolution;r.setSize(e/i,t/i)}if(this.depthTexture){var a=this.depthTexture.resolution;this.depthTexture.setSize(e/a,t/a)}}},oD.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(oD.prototype,sD),cD=function(e){function t(t){typeof t==`number`&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),e.call(this,null,t);var n=t||{},r=n.width,i=n.height;this.mipmap=!1,this.width=Math.ceil(r)||100,this.height=Math.ceil(i)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new oD(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this.framebuffer=null},t}(ZE),lD=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)},lD.prototype.set=function(e,t,n){var r=t.width,i=t.height;if(n){var a=e.width/2/r,o=e.height/2/i,s=e.x/r+a,c=e.y/i+o;n=kE.add(n,kE.NW),this.x0=s+a*kE.uX(n),this.y0=c+o*kE.uY(n),n=kE.add(n,2),this.x1=s+a*kE.uX(n),this.y1=c+o*kE.uY(n),n=kE.add(n,2),this.x2=s+a*kE.uX(n),this.y2=c+o*kE.uY(n),n=kE.add(n,2),this.x3=s+a*kE.uX(n),this.y3=c+o*kE.uY(n)}else this.x0=e.x/r,this.y0=e.y/i,this.x1=(e.x+e.width)/r,this.y1=e.y/i,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/i,this.x3=e.x/r,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},uD=new lD,dD=function(e){function t(n,r,i,a,o,s){if(e.call(this),this.noFrame=!1,r||=(this.noFrame=!0,new jE(0,0,1,1)),n instanceof t&&(n=n.baseTexture),this.baseTexture=n,this._frame=r,this.trim=a,this.valid=!1,this.requiresUpdate=!1,this._uvs=uD,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!=0)throw Error(`attempt to use diamond-shaped UVs. If you are sure, set rotation manually`);this.defaultAnchor=s?new hE(s.x,s.y):new hE(0,0),this._updateID=0,this.textureCacheIds=[],n.valid?this.noFrame?n.valid&&this.onBaseTextureUpdated(n):this.frame=r:n.once(`loaded`,this.onBaseTextureUpdated,this),this.noFrame&&n.on(`update`,this.onBaseTextureUpdated,this)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit(`update`,this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var n=this.baseTexture.resource;n&& __get$(dE,n.url) &&t.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off(`update`,this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},t.prototype.updateUvs=function(){this._uvs===uD&&(this._uvs=new lD),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,n,r){n===void 0&&(n={}),r===void 0&&(r=hT.STRICT_TEXTURE_CACHE);var i=typeof e==`string`,a=null;i?a=e:(e._pixiId||=`pixiid_`+wy(),a=e._pixiId);var o= __get$(dE,a) ;if(i&&r&&!o)throw Error(`The cacheId "`+a+`" does not exist in TextureCache.`);return o||(n.resolution||=Oy(e),o=new t(new ZE(e,n)),o.baseTexture.cacheId=a,ZE.addToCache(o.baseTexture,a),t.addToCache(o,a)),o},t.fromBuffer=function(e,n,r,i){return new t(ZE.fromBuffer(e,n,r,i))},t.fromLoader=function(e,n,r){var i=new qE(e);i.url=n;var a=new t(new ZE(i,{scaleMode:hT.SCALE_MODE,resolution:Oy(n)}));return r||=n,ZE.addToCache(a.baseTexture,r),t.addToCache(a,r),r!==n&&(ZE.addToCache(a.baseTexture,n),t.addToCache(a,n)),a},t.addToCache=function(e,t){t&&(e.textureCacheIds.indexOf(t)===-1&&e.textureCacheIds.push(t), __get$(dE,t) &&console.warn(`Texture added to the cache with an id [`+t+`] that already had an entry`), __set$(dE,t,e) )},t.removeFromCache=function(e){if(typeof e==`string`){var t= __get$(dE,e) ;if(t){var n=t.textureCacheIds.indexOf(e);return n>-1&&t.textureCacheIds.splice(n,1),delete dE[e],t}}else if(e&&e.textureCacheIds){for(var r=0;r<e.textureCacheIds.length;++r) __get$(dE,__get$(e.textureCacheIds,r)) ===e&&delete dE[ __get$(e.textureCacheIds,r) ];return e.textureCacheIds.length=0,e}return null},n.resolution.get=function(){return this.baseTexture.resolution},n.frame.get=function(){return this._frame},n.frame.set=function(e){this._frame=e,this.noFrame=!1;var t=e.x,n=e.y,r=e.width,i=e.height,a=t+r>this.baseTexture.width,o=n+i>this.baseTexture.height;if(a||o){var s=a&&o?`and`:`or`,c=`X: `+t+` + `+r+` = `+(t+r)+` > `+this.baseTexture.width,l=`Y: `+n+` + `+i+` = `+(n+i)+` > `+this.baseTexture.height;throw Error(`Texture Error: frame does not fit inside the base Texture dimensions: `+c+` `+s+` `+l)}this.valid=r&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()},n.rotate.get=function(){return this._rotate},n.rotate.set=function(e){this._rotate=e,this.valid&&this.updateUvs()},n.width.get=function(){return this.orig.width},n.height.get=function(){return this.orig.height},Object.defineProperties(t.prototype,n),t}(_T),dD.EMPTY=new dD(new ZE),Ny(dD.EMPTY),Ny(dD.EMPTY.baseTexture),dD.WHITE=My(),Ny(dD.WHITE),Ny(dD.WHITE.baseTexture),fD=function(e){function t(t,n){var r=null;if(!(t instanceof cD)){var i=arguments[1],a=arguments[2],o=arguments[3],s=arguments[4];console.warn(`Please use RenderTexture.create(`+i+`, `+a+`) instead of the ctor directly.`),r=arguments[0],n=null,t=new cD({width:i,height:a,scaleMode:o,resolution:s})}e.call(this,t,n),this.legacyRenderer=r,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.resize=function(e,t,n){n===void 0&&(n=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,n&&this.baseTexture.resize(e,t),this.updateUvs()},t.prototype.setResolution=function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},t.create=function(e){return typeof e==`number`&&(e={width:e,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new t(new cD(e))},t}(dD),pD=function(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0},pD.prototype.createTexture=function(e,t){return  new fD(new cD(__call$(Object,"assign",[{width:e,height:t,resolution:1},this.textureOptions]))) },pD.prototype.getOptimalTexture=function(e,t,n){n===void 0&&(n=1);var r=pD.SCREEN_KEY;e*=n,t*=n,(!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight)&&(e=yy(e),t=yy(t),r=(e&65535)<<16|t&65535), __get$(this.texturePool,r) ||( __set$(this.texturePool,r,[]) );var i= __get$(this.texturePool,r) .pop();return i||=this.createTexture(e,t),i.filterPoolKey=r,i.setResolution(n),i},pD.prototype.getFilterTexture=function(e,t){var n=this.getOptimalTexture(e.width,e.height,t||e.resolution);return n.filterFrame=e.filterFrame,n},pD.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null, __get$(this.texturePool,t) .push(e)},pD.prototype.returnFilterTexture=function(e){this.returnTexture(e)},pD.prototype.clear=function(e){if(e=e!==!1,e)for(var t in this.texturePool){var n= __get$(this.texturePool,t) ;if(n)for(var r=0;r<n.length;r++) __get$(n,r) .destroy(!0)}this.texturePool={}},pD.prototype.setScreenSize=function(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){var t=pD.SCREEN_KEY,n= __get$(this.texturePool,t) ;if(this.enableFullScreen=e.width>0&&e.height>0,n)for(var r=0;r<n.length;r++) __get$(n,r) .destroy(!0); __set$(this.texturePool,t,[]) ,this._pixelsWidth=e.width,this._pixelsHeight=e.height}},pD.SCREEN_KEY=`screen`,mD=function(e,t,n,r,i,a,o){n===void 0&&(n=!1),r===void 0&&(r=5126),this.buffer=e,this.size=t,this.normalized=n,this.type=r,this.stride=i,this.start=a,this.instance=o},mD.prototype.destroy=function(){this.buffer=null},mD.from=function(e,t,n,r,i){return new mD(e,t,n,r,i)},hD=0,gD=function(e,t,n){t===void 0&&(t=!0),n===void 0&&(n=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=t,this.id=hD++,this.disposeRunner=new UE(`disposeBuffer`,2)},gD.prototype.update=function(e){this.data=e||this.data,this._updateID++},gD.prototype.dispose=function(){this.disposeRunner.run(this,!1)},gD.prototype.destroy=function(){this.dispose(),this.data=null},gD.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new gD(e)},_D={Float32Array,Uint32Array,Int32Array,Uint8Array},vD={5126:4,5123:2,5121:1},yD=0,bD={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},xD=function(e,t){e===void 0&&(e=[]),t===void 0&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=yD++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new UE(`disposeGeometry`,2),this.refCount=0},xD.prototype.addAttribute=function(e,t,n,r,i,a,o,s){if(r===void 0&&(r=!1),s===void 0&&(s=!1),!t)throw Error(`You must pass a buffer when creating an attribute`);t.data||(t instanceof Array&&(t=new Float32Array(t)),t=new gD(t));var c=e.split(`|`);if(c.length>1){for(var l=0;l<c.length;l++)this.addAttribute( __get$(c,l) ,t,n,r,i);return this}var u=this.buffers.indexOf(t);return u===-1&&(this.buffers.push(t),u=this.buffers.length-1), __set$(this.attributes,e,new mD(u,n,r,i,a,o,s)) ,this.instanced=this.instanced||s,this},xD.prototype.getAttribute=function(e){return  __get$(this.attributes,e) },xD.prototype.getBuffer=function(e){return  __get$(this.buffers,this.getAttribute(e).buffer) },xD.prototype.addIndex=function(e){return e.data||(e instanceof Array&&(e=new Uint16Array(e)),e=new gD(e)),e.index=!0,this.indexBuffer=e,this.buffers.indexOf(e)===-1&&this.buffers.push(e),this},xD.prototype.getIndex=function(){return this.indexBuffer},xD.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var e=[],t=[],n=new gD,r;for(r in this.attributes){var i= __get$(this.attributes,r) ,a= __get$(this.buffers,i.buffer) ;e.push(a.data),t.push(i.size* __get$(vD,i.type) /4),i.buffer=0}for(n.data=Fy(e,t),r=0;r<this.buffers.length;r++) __get$(this.buffers,r) !==this.indexBuffer&& __get$(this.buffers,r) .destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},xD.prototype.getSize=function(){for(var e in this.attributes){var t= __get$(this.attributes,e) ;return  __get$(this.buffers,t.buffer) .data.length/(t.stride/4||t.size)}return 0},xD.prototype.dispose=function(){this.disposeRunner.run(this,!1)},xD.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},xD.prototype.clone=function(){for(var e=new xD,t=0;t<this.buffers.length;t++) __set$(e.buffers,t,new gD(__get$(this.buffers,t).data.slice())) ;for(var n in this.attributes){var r= __get$(this.attributes,n) ; __set$(e.attributes,n,new mD(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)) }return this.indexBuffer&&(e.indexBuffer= __get$(e.buffers,this.buffers.indexOf(this.indexBuffer)) ,e.indexBuffer.index=!0),e},xD.merge=function(e){for(var t=new xD,n=[],r=[],i=[],a,o=0;o<e.length;o++){a= __get$(e,o) ;for(var s=0;s<a.buffers.length;s++) __set$(r,s,__get$(r,s)||0) , __set$(r,s,__get$(r,s)+__get$(a.buffers,s).data.length) , __set$(i,s,0) }for(var c=0;c<a.buffers.length;c++) __set$(n,c,new bD[(Py(__get$(a.buffers,c).data))](__get$(r,c))) , __set$(t.buffers,c,new gD(__get$(n,c))) ;for(var l=0;l<e.length;l++){a= __get$(e,l) ;for(var u=0;u<a.buffers.length;u++) __get$(n,u) .set( __get$(a.buffers,u) .data, __get$(i,u) ), __set$(i,u,__get$(i,u)+__get$(a.buffers,u).data.length) }if(t.attributes=a.attributes,a.indexBuffer){t.indexBuffer= __get$(t.buffers,a.buffers.indexOf(a.indexBuffer)) ,t.indexBuffer.index=!0;for(var d=0,f=0,p=0,m=0,h=0;h<a.buffers.length;h++)if( __get$(a.buffers,h) !==a.indexBuffer){m=h;break}for(var g in a.attributes){var _= __get$(a.attributes,g) ;(_.buffer|0)===m&&(f+=_.size* __get$(vD,_.type) /4)}for(var v=0;v<e.length;v++){for(var y= __get$(e,v) .indexBuffer.data,b=0;b<y.length;b++) __set$(t.indexBuffer.data,b+p,__get$(t.indexBuffer.data,b+p)+d) ;d+= __get$(a.buffers,m) .data.length/f,p+=y.length}}return t},SD=function(e){function t(){e.call(this),this.addAttribute(`aVertexPosition`,[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(xD),CD=function(e){function t(){e.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new gD(this.vertices),this.uvBuffer=new gD(this.uvs),this.addAttribute(`aVertexPosition`,this.vertexBuffer).addAttribute(`aTextureCoord`,this.uvBuffer).addIndex([0,1,2,0,2,3])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(e,t){var n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+t.width/e.width,this.uvs[3]=r,this.uvs[4]=n+t.width/e.width,this.uvs[5]=r+t.height/e.height,this.uvs[6]=n,this.uvs[7]=r+t.height/e.height,n=t.x,r=t.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+t.width,this.vertices[3]=r,this.vertices[4]=n+t.width,this.vertices[5]=r+t.height,this.vertices[6]=n,this.vertices[7]=r+t.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(xD),wD=0,TD=function(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=wD++,this.static=!!t},TD.prototype.update=function(){this.dirtyId++},TD.prototype.add=function(e,t,n){ __set$(this.uniforms,e,new TD(t,n)) },TD.from=function(e,t){return new TD(e,t)},ED=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new jE,this.destinationFrame=new jE,this.filters=[]},ED.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},DD=function(e){function t(t){e.call(this,t),this.defaultFilterStack=[{}],this.texturePool=new pD,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new SD,this.quadUv=new CD,this.tempRect=new jE,this.activeState={},this.globalUniforms=new TD({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.push=function(e,t){for(var n=this.renderer,r=this.defaultFilterStack,i=this.statePool.pop()||new ED,a=t[0].resolution,o=t[0].padding,s=t[0].autoFit,c=t[0].legacy,l=1;l<t.length;l++){var u= __get$(t,l) ;a=Math.min(a,u.resolution),o=Math.max(o,u.padding),s||=u.autoFit,c||=u.legacy}r.length===1&&(this.defaultFilterStack[0].renderTexture=n.renderTexture.current),r.push(i),i.resolution=a,i.legacy=c,i.target=e,i.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),i.sourceFrame.pad(o),s&&i.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),i.sourceFrame.ceil(a),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,a),i.filters=t,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height,i.renderTexture.filterFrame=i.sourceFrame,n.renderTexture.bind(i.renderTexture,i.sourceFrame),n.renderTexture.clear()},t.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),n=t.filters;this.activeState=t;var r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;var i=r.inputSize,a=r.inputPixel,o=r.inputClamp;if(i[0]=t.destinationFrame.width,i[1]=t.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],a[0]=i[0]*t.resolution,a[1]=i[1]*t.resolution,a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=t.sourceFrame.width*i[2]-.5*a[2],o[3]=t.sourceFrame.height*i[3]-.5*a[3],t.legacy){var s=r.filterArea;s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=t.sourceFrame.x,s[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var c= __get$(e,e.length-1) ;if(n.length===1)n[0].apply(this,t.renderTexture,c.renderTexture,!1,t),this.returnFilterTexture(t.renderTexture);else{var l=t.renderTexture,u=this.getOptimalFilterTexture(l.width,l.height,t.resolution);u.filterFrame=l.filterFrame;var d=0;for(d=0;d<n.length-1;++d){ __get$(n,d) .apply(this,l,u,!0,t);var f=l;l=u,u=f} __get$(n,d) .apply(this,l,c.renderTexture,!1,t),this.returnFilterTexture(l),this.returnFilterTexture(u)}t.clear(),this.statePool.push(t)},t.prototype.applyFilter=function(e,t,n,r){var i=this.renderer;i.renderTexture.bind(n,n?n.filterFrame:null),r&&i.renderTexture.clear(),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,i.state.set(e.state),i.shader.bind(e),e.legacy?(this.quadUv.map(t._frame,t.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(qT.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(qT.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(e,t){var n=this.activeState,r=n.sourceFrame,i=n.destinationFrame,a=t._texture.orig,o=e.set(i.width,0,0,i.height,r.x,r.y),s=t.worldTransform.copyTo(xE.TEMP_MATRIX);return s.invert(),o.prepend(s),o.scale(1/a.width,1/a.height),o.translate(t.anchor.x,t.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(e,t,n){return n===void 0&&(n=1),this.texturePool.getOptimalTexture(e,t,n)},t.prototype.getFilterTexture=function(e,t){if(typeof e==`number`){var n=e;e=t,t=n}e||=this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return r.filterFrame=e.filterFrame,r},t.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t}(iD),OD=function(e){this.renderer=e},OD.prototype.flush=function(){},OD.prototype.destroy=function(){this.renderer=null},OD.prototype.start=function(){},OD.prototype.stop=function(){this.flush()},OD.prototype.render=function(e){},kD=function(e){function t(t){e.call(this,t),this.emptyRenderer=new OD(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(e,t){for(var n=this.renderer.texture.boundTextures,r=t-1;r>=0;--r) __set$(e,r,__get$(n,r)||null) , __get$(e,r) &&( __get$(e,r) ._batchLocation=r)},t.prototype.boundArray=function(e,t,n,r){for(var i=e.elements,a=e.ids,o=e.count,s=0,c=0;c<o;c++){var l= __get$(i,c) ,u=l._batchLocation;if(u>=0&&u<r&& __get$(t,u) ===l){ __set$(a,c,u) ;continue}for(;s<r;){var d= __get$(t,s) ;if(d&&d._batchEnabled===n&&d._batchLocation===s){s++;continue} __set$(a,c,s) ,l._batchLocation=s, __set$(t,s,l) ;break}}},t}(iD),hT.PREFER_ENV=mT.any?WT.WEBGL:WT.WEBGL2,hT.STRICT_TEXTURE_CACHE=!1,AD=0,jD=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener(`webglcontextlost`,this.handleContextLost,!1),t.view.addEventListener(`webglcontextrestored`,this.handleContextRestored,!1)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={isLost:{configurable:!0}};return n.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=AD++,e.isContextLost()&&e.getExtension(`WEBGL_lose_context`)&&e.getExtension(`WEBGL_lose_context`).restoreContext()},t.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=AD++,this.renderer.runners.contextChange.run(e)},t.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},t.prototype.createContext=function(e,t){var n;if(hT.PREFER_ENV>=WT.WEBGL2&&(n=e.getContext(`webgl2`,t)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext(`webgl`,t)||e.getContext(`experimental-webgl`,t),!n)throw Error(`This browser does not support WebGL. Try using the canvas renderer`);return this.gl=n,this.getExtensions(),n},t.prototype.getExtensions=function(){var e=this.gl;this.webGLVersion===1? __call$(Object,"assign",[this.extensions,{drawBuffers:e.getExtension(`WEBGL_draw_buffers`),depthTexture:e.getExtension(`WEBKIT_WEBGL_depth_texture`),loseContext:e.getExtension(`WEBGL_lose_context`),vertexArrayObject:e.getExtension(`OES_vertex_array_object`)||e.getExtension(`MOZ_OES_vertex_array_object`)||e.getExtension(`WEBKIT_OES_vertex_array_object`),anisotropicFiltering:e.getExtension(`EXT_texture_filter_anisotropic`),uint32ElementIndex:e.getExtension(`OES_element_index_uint`),floatTexture:e.getExtension(`OES_texture_float`),floatTextureLinear:e.getExtension(`OES_texture_float_linear`),textureHalfFloat:e.getExtension(`OES_texture_half_float`),textureHalfFloatLinear:e.getExtension(`OES_texture_half_float_linear`)}]) :this.webGLVersion===2&& __call$(Object,"assign",[this.extensions,{anisotropicFiltering:e.getExtension(`EXT_texture_filter_anisotropic`),colorBufferFloat:e.getExtension(`EXT_color_buffer_float`),floatTextureLinear:e.getExtension(`OES_texture_float_linear`)}]) },t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener(`webglcontextlost`,this.handleContextLost),e.removeEventListener(`webglcontextrestored`,this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(e){e.getContextAttributes().stencil||console.warn(`Provided WebGL context does not have a stencil buffer, masks may not render correctly`)},Object.defineProperties(t.prototype,n),t}(iD),MD=function(e){function t(t){e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new oD(10,10)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0}};return t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new jE,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var t=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;hT.PREFER_ENV===WT.WEBGL_LEGACY&&(t=null,n=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}},t.prototype.bind=function(e,t){var n=this.gl;if(e){var r= __get$(e.glFramebuffers,this.CONTEXT_UID) ||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==e.dirtyId&&(r.dirtyId=e.dirtyId,r.dirtyFormat===e.dirtyFormat?r.dirtySize!==e.dirtySize&&(r.dirtySize=e.dirtySize,this.resizeFramebuffer(e)):(r.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)));for(var i=0;i<e.colorTextures.length;i++) __get$(e.colorTextures,i) .texturePart?this.renderer.texture.unbind( __get$(e.colorTextures,i) .texture):this.renderer.texture.unbind( __get$(e.colorTextures,i) );e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(e,t,n,r){var i=this.viewport;(i.width!==n||i.height!==r||i.x!==e||i.y!==t)&&(i.x=e,i.y=t,i.width=n,i.height=r,this.gl.viewport(e,t,n,r))},n.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(e,t,n,r){var i=this.gl;i.clearColor(e,t,n,r),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(e){var t={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return  __set$(e.glFramebuffers,this.CONTEXT_UID,t) ,this.managedFramebuffers.push(e),e.disposeRunner.add(this),t},t.prototype.resizeFramebuffer=function(e){var t=this.gl,n= __get$(e.glFramebuffers,this.CONTEXT_UID) ;n.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,n.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var r=e.colorTextures,i=0;i<r.length;i++)this.renderer.texture.bind( __get$(r,i) ,0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},t.prototype.updateFramebuffer=function(e){var t=this.gl,n= __get$(e.glFramebuffers,this.CONTEXT_UID) ,r=e.colorTextures.length;t.drawBuffers||(r=Math.min(r,1));for(var i=[],a=0;a<r;a++){var o= __get$(e.colorTextures,a) ;o.texturePart?(this.renderer.texture.bind(o.texture,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+a,t.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side, __get$(o.texture._glTextures,this.CONTEXT_UID) .texture,0)):(this.renderer.texture.bind(o,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+a,t.TEXTURE_2D, __get$(o._glTextures,this.CONTEXT_UID) .texture,0)),i.push(t.COLOR_ATTACHMENT0+a)}if(i.length>1&&t.drawBuffers(i),e.depthTexture&&this.writeDepthTexture){var s=e.depthTexture;this.renderer.texture.bind(s,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D, __get$(s._glTextures,this.CONTEXT_UID) .texture,0)}!n.stencil&&(e.stencil||e.depth)&&(n.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,n.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,n.stencil))},t.prototype.disposeFramebuffer=function(e,t){var n= __get$(e.glFramebuffers,this.CONTEXT_UID) ,r=this.gl;if(n){delete e.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(e);i>=0&&this.managedFramebuffers.splice(i,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(n.framebuffer),n.stencil&&r.deleteRenderbuffer(n.stencil))}},t.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<t.length;n++)this.disposeFramebuffer( __get$(t,n) ,e)},t.prototype.forceStencil=function(){var e=this.current;if(e){var t= __get$(e.glFramebuffers,this.CONTEXT_UID) ;if(!(!t||t.stencil)){e.enableStencil();var n=e.width,r=e.height,i=this.gl,a=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,a),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,n,r),t.stencil=a,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,a)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new jE},Object.defineProperties(t.prototype,n),t}(iD),ND=function(e){this.buffer=e,this.updateID=-1,this.byteLength=-1,this.refCount=0},PD={5126:4,5123:2,5121:1},FD=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!e.createVertexArray){var n=this.renderer.context.extensions.vertexArrayObject;hT.PREFER_ENV===WT.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=function(){return n.createVertexArrayOES()},e.bindVertexArray=function(e){return n.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return n.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){},e.bindVertexArray=function(){},e.deleteVertexArray=function(){})}if(!e.vertexAttribDivisor){var r=e.getExtension(`ANGLE_instanced_arrays`);r?(e.vertexAttribDivisor=function(e,t){return r.vertexAttribDivisorANGLE(e,t)},e.drawElementsInstanced=function(e,t,n,i,a){return r.drawElementsInstancedANGLE(e,t,n,i,a)},e.drawArraysInstanced=function(e,t,n,i){return r.drawArraysInstancedANGLE(e,t,n,i)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex},t.prototype.bind=function(e,t){t||=this.renderer.shader.shader;var n=this.gl,r= __get$(e.glVertexArrayObjects,this.CONTEXT_UID) ;r||( __set$(this.managedGeometries,e.id,e) ,e.disposeRunner.add(this), __set$(e.glVertexArrayObjects,this.CONTEXT_UID,r={}) );var i= __get$(r,t.program.id) ||this.initGeometryVao(e,t.program);this._activeGeometry=e,this._activeVao!==i&&(this._activeVao=i,this.hasVao?n.bindVertexArray(i):this.activateVao(e,t.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.gl,n=0;n<e.buffers.length;n++){var r= __get$(e.buffers,n) ,i= __get$(r._glBuffers,this.CONTEXT_UID) ;if(r._updateID!==i.updateID){i.updateID=r._updateID;var a=r.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(a,i.buffer),this._boundBuffer=i,i.byteLength>=r.data.byteLength)t.bufferSubData(a,0,r.data);else{var o=r.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;i.byteLength=r.data.byteLength,t.bufferData(a,r.data,o)}}}},t.prototype.checkCompatibility=function(e,t){var n=e.attributes;for(var r in t.attributeData)if(! __get$(n,r) )throw Error(`shader and geometry incompatible, geometry missing the "`+r+`" attribute`)},t.prototype.getSignature=function(e,t){var n=e.attributes,r=t.attributeData,i=[`g`,e.id];for(var a in n) __get$(r,a) &&i.push(a);return i.join(`-`)},t.prototype.initGeometryVao=function(e,t){this.checkCompatibility(e,t);var n=this.gl,r=this.CONTEXT_UID,i=this.getSignature(e,t),a= __get$(e.glVertexArrayObjects,this.CONTEXT_UID) ,o= __get$(a,i) ;if(o)return  __set$(a,t.id,o) ,o;var s=e.buffers,c=e.attributes,l={},u={};for(var d in s) __set$(l,d,0) , __set$(u,d,0) ;for(var f in c)! __get$(c,f) .size&& __get$(t.attributeData,f) ? __get$(c,f) .size= __get$(t.attributeData,f) .size: __get$(c,f) .size||console.warn(`PIXI Geometry attribute '`+f+`' size cannot be determined (likely the bound shader does not have the attribute)`), __set$(l,__get$(c,f).buffer,__get$(l,__get$(c,f).buffer)+__get$(c,f).size*__get$(PD,__get$(c,f).type)) ;for(var p in c){var m= __get$(c,p) ,h=m.size;m.stride===void 0&&( __get$(l,m.buffer) ===h* __get$(PD,m.type) ?m.stride=0:m.stride= __get$(l,m.buffer) ),m.start===void 0&&(m.start= __get$(u,m.buffer) , __set$(u,m.buffer,__get$(u,m.buffer)+h*__get$(PD,m.type)) )}o=n.createVertexArray(),n.bindVertexArray(o);for(var g=0;g<s.length;g++){var _= __get$(s,g) ; __get$(_._glBuffers,r) ||( __set$(_._glBuffers,r,new ND(n.createBuffer())) , __set$(this.managedBuffers,_.id,_) ,_.disposeRunner.add(this)), __get$(_._glBuffers,r) .refCount++}return this.activateVao(e,t),this._activeVao=o, __set$(a,t.id,o) , __set$(a,i,o) ,o},t.prototype.disposeBuffer=function(e,t){if( __get$(this.managedBuffers,e.id) ){delete this.managedBuffers[e.id];var n= __get$(e._glBuffers,this.CONTEXT_UID) ,r=this.gl;e.disposeRunner.remove(this),n&&(t||r.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(e,t){if( __get$(this.managedGeometries,e.id) ){delete this.managedGeometries[e.id];var n= __get$(e.glVertexArrayObjects,this.CONTEXT_UID) ,r=this.gl,i=e.buffers;if(e.disposeRunner.remove(this),n){for(var a=0;a<i.length;a++){var o= __get$(__get$(i,a)._glBuffers,this.CONTEXT_UID) ;o.refCount--,o.refCount===0&&!t&&this.disposeBuffer( __get$(i,a) ,t)}if(!t){for(var s in n)if(s[0]===`g`){var c= __get$(n,s) ;this._activeVao===c&&this.unbind(),r.deleteVertexArray(c)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),n=0;n<t.length;n++)this.disposeGeometry( __get$(this.managedGeometries,__get$(t,n)) ,e);t=Object.keys(this.managedBuffers);for(var r=0;r<t.length;r++)this.disposeBuffer( __get$(this.managedBuffers,__get$(t,r)) ,e)},t.prototype.activateVao=function(e,t){var n=this.gl,r=this.CONTEXT_UID,i=e.buffers,a=e.attributes;e.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, __get$(e.indexBuffer._glBuffers,r) .buffer);var o=null;for(var s in a){var c= __get$(a,s) ,l= __get$(__get$(i,c.buffer)._glBuffers,r) ;if( __get$(t.attributeData,s) ){o!==l&&(n.bindBuffer(n.ARRAY_BUFFER,l.buffer),o=l);var u= __get$(__get$(t.attributeData,s),"location") ;if(n.enableVertexAttribArray(u),n.vertexAttribPointer(u,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)n.vertexAttribDivisor(u,1);else throw Error(`geometry error, GPU Instancing is not supported on this device`)}}},t.prototype.draw=function(e,t,n,r){var i=this.gl,a=this._activeGeometry;if(a.indexBuffer){var o=a.indexBuffer.data.BYTES_PER_ELEMENT,s=o===2?i.UNSIGNED_SHORT:i.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?a.instanced?i.drawElementsInstanced(e,t||a.indexBuffer.data.length,s,(n||0)*o,r||1):i.drawElements(e,t||a.indexBuffer.data.length,s,(n||0)*o):console.warn(`unsupported index buffer type: uint32`)}else a.instanced?i.drawArraysInstanced(e,n,t||a.getSize(),r||1):i.drawArrays(e,n,t||a.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t}(iD),ID=function(e){this.type=rE.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null},ID.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=rE.NONE,this.autoDetect=!0),this._target=null},ID.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},LD={},RD=LD,BD={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},VD=null,HD={FLOAT:`float`,FLOAT_VEC2:`vec2`,FLOAT_VEC3:`vec3`,FLOAT_VEC4:`vec4`,INT:`int`,INT_VEC2:`ivec2`,INT_VEC3:`ivec3`,INT_VEC4:`ivec4`,BOOL:`bool`,BOOL_VEC2:`bvec2`,BOOL_VEC3:`bvec3`,BOOL_VEC4:`bvec4`,FLOAT_MAT2:`mat2`,FLOAT_MAT3:`mat3`,FLOAT_MAT4:`mat4`,SAMPLER_2D:`sampler2D`,SAMPLER_CUBE:`samplerCube`,SAMPLER_2D_ARRAY:`sampler2DArray`},UD={float:`
    if(cv !== v)
    {
        cv.v = v;
        gl.uniform1f(location, v)
    }`,vec2:`
    if(cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`gl.uniform4f(location, v[0], v[1], v[2], v[3])`,int:`gl.uniform1i(location, v)`,ivec2:`gl.uniform2i(location, v[0], v[1])`,ivec3:`gl.uniform3i(location, v[0], v[1], v[2])`,ivec4:`gl.uniform4i(location, v[0], v[1], v[2], v[3])`,bool:`gl.uniform1i(location, v)`,bvec2:`gl.uniform2i(location, v[0], v[1])`,bvec3:`gl.uniform3i(location, v[0], v[1], v[2])`,bvec4:`gl.uniform4i(location, v[0], v[1], v[2], v[3])`,mat2:`gl.uniformMatrix2fv(location, false, v)`,mat3:`gl.uniformMatrix3fv(location, false, v)`,mat4:`gl.uniformMatrix4fv(location, false, v)`,sampler2D:`gl.uniform1i(location, v)`,samplerCube:`gl.uniform1i(location, v)`,sampler2DArray:`gl.uniform1i(location, v)`},WD={float:`gl.uniform1fv(location, v)`,vec2:`gl.uniform2fv(location, v)`,vec3:`gl.uniform3fv(location, v)`,vec4:`gl.uniform4fv(location, v)`,mat4:`gl.uniformMatrix4fv(location, false, v)`,mat3:`gl.uniformMatrix3fv(location, false, v)`,mat2:`gl.uniformMatrix2fv(location, false, v)`,int:`gl.uniform1iv(location, v)`,ivec2:`gl.uniform2iv(location, v)`,ivec3:`gl.uniform3iv(location, v)`,ivec4:`gl.uniform4iv(location, v)`,bool:`gl.uniform1iv(location, v)`,bvec2:`gl.uniform2iv(location, v)`,bvec3:`gl.uniform3iv(location, v)`,bvec4:`gl.uniform4iv(location, v)`,sampler2D:`gl.uniform1iv(location, v)`,samplerCube:`gl.uniform1iv(location, v)`,sampler2DArray:`gl.uniform1iv(location, v)`},GD=[`precision mediump float;`,`void main(void){`,`float test = 0.1;`,`%forloop%`,`gl_FragColor = vec4(0.0);`,`}`].join(`
`),qD=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,JD=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,YD=0,XD={},ZD=function e(t,n,r){r===void 0&&(r=`pixi-shader`),this.id=YD++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=n||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!==`#version`&&(r= __call$(r,"replace",[/\s+/g,`-`]) , __get$(XD,r) ?(XD[r]++,r+=`-`+ __get$(XD,r) ): __set$(XD,r,1) ,this.vertexSrc=`#define SHADER_NAME `+r+`
`+this.vertexSrc,this.fragmentSrc=`#define SHADER_NAME `+r+`
`+this.fragmentSrc,this.vertexSrc=Hy(this.vertexSrc,hT.PRECISION_VERTEX,nE.HIGH),this.fragmentSrc=Hy(this.fragmentSrc,hT.PRECISION_FRAGMENT,Vy())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},QD={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}},ZD.prototype.extractData=function(e,t){var n=By();if(n){var r=Iy(n,e,t);this.attributeData=this.getAttributeData(r,n),this.uniformData=this.getUniformData(r,n),n.deleteProgram(r)}else this.uniformData={},this.attributeData={}},ZD.prototype.getAttributeData=function(e,t){for(var n={},r=[],i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;a<i;a++){var o=t.getActiveAttrib(e,a),s=Wy(t,o.type),c={type:s,name:o.name,size:Uy(s),location:0}; __set$(n,o.name,c) ,r.push(c)}r.sort(function(e,t){return e.name>t.name?1:-1});for(var l=0;l<r.length;l++) __set$(__get$(r,l),"location",l) ;return n},ZD.prototype.getUniformData=function(e,t){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<r;i++){var a=t.getActiveUniform(e,i),o= __call$(a.name,"replace",[/\[.*?\]/,``]) ,s=a.name.match(/\[.*?\]/,``),c=Wy(t,a.type); __set$(n,o,{type:c,size:a.size,isArray:s,value:Ry(c,a.size)}) }return n},QD.defaultVertexSrc.get=function(){return JD},QD.defaultFragmentSrc.get=function(){return qD},ZD.from=function(e,t,n){var r=e+t,i= __get$(uE,r) ;return i||( __set$(uE,r,i=new ZD(e,t,n)) ),i},Object.defineProperties(ZD,QD),$D=function(e,t){for(var n in this.program=e,t?t instanceof TD?this.uniformGroup=t:this.uniformGroup=new TD(t):this.uniformGroup=new TD({}),e.uniformData) __get$(this.uniformGroup.uniforms,n) instanceof Array&&( __set$(this.uniformGroup.uniforms,n,new Float32Array(__get$(this.uniformGroup.uniforms,n))) )},eO={uniforms:{configurable:!0}},$D.prototype.checkUniformExists=function(e,t){if( __get$(t.uniforms,e) )return!0;for(var n in t.uniforms){var r= __get$(t.uniforms,n) ;if(r.group&&this.checkUniformExists(e,r))return!0}return!1},$D.prototype.destroy=function(){this.uniformGroup=null},eO.uniforms.get=function(){return this.uniformGroup.uniforms},$D.from=function(e,t,n){return new $D(ZD.from(e,t),n)},Object.defineProperties($D.prototype,eO),tO=0,nO=1,rO=2,iO=3,aO=4,oO=function(){this.data=0,this.blendMode=KT.NORMAL,this.polygonOffset=0,this.blend=!0},sO={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}},sO.blend.get=function(){return!!(this.data&1<<tO)},sO.blend.set=function(e){!!(this.data&1<<tO)!==e&&(this.data^=1<<tO)},sO.offsets.get=function(){return!!(this.data&1<<nO)},sO.offsets.set=function(e){!!(this.data&1<<nO)!==e&&(this.data^=1<<nO)},sO.culling.get=function(){return!!(this.data&1<<rO)},sO.culling.set=function(e){!!(this.data&1<<rO)!==e&&(this.data^=1<<rO)},sO.depthTest.get=function(){return!!(this.data&1<<iO)},sO.depthTest.set=function(e){!!(this.data&1<<iO)!==e&&(this.data^=1<<iO)},sO.clockwiseFrontFace.get=function(){return!!(this.data&1<<aO)},sO.clockwiseFrontFace.set=function(e){!!(this.data&1<<aO)!==e&&(this.data^=1<<aO)},sO.blendMode.get=function(){return this._blendMode},sO.blendMode.set=function(e){this.blend=e!==KT.NONE,this._blendMode=e},sO.polygonOffset.get=function(){return this._polygonOffset},sO.polygonOffset.set=function(e){this.offsets=!!e,this._polygonOffset=e},oO.for2d=function(){var e=new oO;return e.depthTest=!1,e.blend=!0,e},Object.defineProperties(oO.prototype,sO),cO=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,lO=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,uO=function(e){function t(n,r,i){var a=ZD.from(n||t.defaultVertexSrc,r||t.defaultFragmentSrc);e.call(this,a,i),this.padding=0,this.resolution=hT.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new oO}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={blendMode:{configurable:!0}},r={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return t.prototype.apply=function(e,t,n,r,i){e.applyFilter(this,t,n,r,i)},n.blendMode.get=function(){return this.state.blendMode},n.blendMode.set=function(e){this.state.blendMode=e},r.defaultVertexSrc.get=function(){return cO},r.defaultFragmentSrc.get=function(){return lO},Object.defineProperties(t.prototype,n),Object.defineProperties(t,r),t}($D),uO.SOURCE_KEY_MAP={},dO=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,fO=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,pO=new xE,mO=function(e,t){this._texture=e,this.mapCoord=new xE,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=t===void 0?.5:t,this.isSimple=!1},hO={texture:{configurable:!0}},hO.texture.get=function(){return this._texture},hO.texture.set=function(e){this._texture=e,this._updateID=-1},mO.prototype.multiplyUvs=function(e,t){t===void 0&&(t=e);for(var n=this.mapCoord,r=0;r<e.length;r+=2){var i= __get$(e,r) ,a= __get$(e,r+1) ; __set$(t,r,i*n.a+a*n.c+n.tx) , __set$(t,r+1,i*n.b+a*n.d+n.ty) }return t},mO.prototype.update=function(e){var t=this._texture;if(!t||!t.valid||!e&&this._updateID===t._updateID)return!1;this._updateID=t._updateID;var n=t._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var r=t.orig,i=t.trim;i&&(pO.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(pO));var a=t.baseTexture,o=this.uClampFrame,s=this.clampMargin/a.resolution,c=this.clampOffset;return o[0]=(t._frame.x+s+c)/a.width,o[1]=(t._frame.y+s+c)/a.height,o[2]=(t._frame.x+t._frame.width-s+c)/a.width,o[3]=(t._frame.y+t._frame.height-s+c)/a.height,this.uClampOffset[0]=c/a.realWidth,this.uClampOffset[1]=c/a.realHeight,this.isSimple=t._frame.width===a.width&&t._frame.height===a.height&&t.rotate===0,!0},Object.defineProperties(mO.prototype,hO),gO=function(e){function t(t){var n=new xE;e.call(this,dO,fO),t.renderable=!1,this.maskSprite=t,this.maskMatrix=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e,t,n,r){var i=this.maskSprite,a=this.maskSprite.texture;a.valid&&(a.transform||=new mO(a,0),a.transform.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,i).prepend(a.transform.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=a.transform.uClampFrame,e.applyFilter(this,t,n,r))},t}(uO),_O=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},t.prototype.push=function(e,t){if(!t.isMaskData){var n=this.maskDataPool.pop()||new ID;n.pooled=!0,n.maskObject=t,t=n}switch(t.autoDetect&&this.detect(t),t.copyCountersOrReset( __get$(this.maskStack,this.maskStack.length-1) ),t._target=e,t.type){case rE.SCISSOR:this.maskStack.push(t),this.renderer.scissor.push(t);break;case rE.STENCIL:this.maskStack.push(t),this.renderer.stencil.push(t);break;case rE.SPRITE:t.copyCountersOrReset(null),this.pushSpriteMask(t),this.maskStack.push(t);break}},t.prototype.pop=function(e){var t=this.maskStack.pop();if(!(!t||t._target!==e)){switch(t.type){case rE.SCISSOR:this.renderer.scissor.pop();break;case rE.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case rE.SPRITE:this.popSpriteMask();break}t.reset(),t.pooled&&this.maskDataPool.push(t)}},t.prototype.detect=function(e){var t=e.maskObject;if(t.isSprite){e.type=rE.SPRITE;return}if(e.type=rE.STENCIL,this.enableScissor&&t.isFastRect&&t.isFastRect()){var n=t.worldTransform,r=Math.atan2(n.b,n.a),i=Math.atan2(n.d,n.c);r=Math.round(r*(180/Math.PI)*100),i=Math.round(i*(180/Math.PI)*100)-r,r=(r%9e3+9e3)%9e3,i=(i%18e3+18e3)%18e3,r===0&&i===9e3&&(e.type=rE.SCISSOR)}},t.prototype.pushSpriteMask=function(e){var t=e.maskObject,n=e._target,r= __get$(this.alphaMaskPool,this.alphaMaskIndex) ;r||= __set$(this.alphaMaskPool,this.alphaMaskIndex,[new gO(t)]) ,r[0].resolution=this.renderer.resolution,r[0].maskSprite=t;var i=n.filterArea;n.filterArea=t.getBounds(!0),this.renderer.filter.push(n,r),n.filterArea=i,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(iD),vO=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(e){var t=this.renderer.gl,n=this.getStackLength();this.maskStack=e;var r=this.getStackLength();r!==n&&(r===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(iD),yO=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getStackLength=function(){var e= __get$(this.maskStack,this.maskStack.length-1) ;return e?e._scissorCounter:0},t.prototype.push=function(e){var t=e.maskObject;t.renderable=!0;var n=e._scissorRect,r=t.getBounds(!0),i=this.renderer.gl;t.renderable=!1,n?r.fit(n):i.enable(i.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=r,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e= __get$(this.maskStack,this.maskStack.length-1) ._scissorRect,t=this.renderer.renderTexture.current,n=this.renderer.projection,r=n.transform,i=n.sourceFrame,a=n.destinationFrame,o=t?t.resolution:this.renderer.resolution,s=(e.x-i.x)*o+a.x,c=(e.y-i.y)*o+a.y,l=e.width*o,u=e.height*o;r&&(s+=r.tx*o,c+=r.ty*o),t||(c=this.renderer.height-u-c),this.renderer.gl.scissor(s,c,l,u)},t}(vO),bO=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getStackLength=function(){var e= __get$(this.maskStack,this.maskStack.length-1) ;return e?e._stencilCounter:0},t.prototype.push=function(e){var t=e.maskObject,n=this.renderer.gl,r=e._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),n.enable(n.STENCIL_TEST)),e._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,r,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var t=this.renderer.gl;this.getStackLength()===0?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(vO),xO=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new xE,this.transform=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(e,t,n,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(e,t,n,r){var i=this.projectionMatrix;r?(i.a=1/e.width*2*n,i.d=-1/e.height*2*n,i.tx=-1-t.x*i.a,i.ty=1-t.y*i.d):(i.a=1/e.width*2*n,i.d=1/e.height*2*n,i.tx=-1-t.x*i.a,i.ty=-1-t.y*i.d)},t.prototype.setTransform=function(){},t}(iD),SO=new jE,CO=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new jE,this.destinationFrame=new jE}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.bind=function(e,t,n){e===void 0&&(e=null),this.current=e;var r=this.renderer,i;if(e){var a=e.baseTexture;i=a.resolution,n||=(SO.width=a.realWidth,SO.height=a.realHeight,SO),t||=n,this.renderer.framebuffer.bind(a.framebuffer,n),this.renderer.projection.update(n,t,i,!1),this.renderer.mask.setMaskStack(a.maskStack)}else i=this.renderer.resolution,n||=(SO.width=r.width,SO.height=r.height,SO),t||=n,r.framebuffer.bind(null,n),this.renderer.projection.update(n,t,i,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(t),this.destinationFrame.x=n.x/i,this.destinationFrame.y=n.y/i,this.destinationFrame.width=n.width/i,this.destinationFrame.height=n.height/i,t===n&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(e){this.current?e||=this.current.baseTexture.clearColor:e||=this.clearColor,this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(iD),wO=function(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}},wO.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},TO=0,EO={textureCount:0},DO=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=TO++}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.systemCheck=function(){if(!Jy())throw Error(`Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.`)},t.prototype.contextChange=function(e){this.gl=e,this.reset()},t.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var n=e.program,r= __get$(n.glPrograms,this.renderer.CONTEXT_UID) ||this.generateShader(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),t||(EO.textureCount=0,this.syncUniformGroup(e.uniformGroup,EO)),r},t.prototype.setUniforms=function(e){var t=this.shader.program,n= __get$(t.glPrograms,this.renderer.CONTEXT_UID) ;t.syncUniforms(n.uniformData,e,this.renderer)},t.prototype.syncUniformGroup=function(e,t){var n=this.getglProgram();(!e.static||e.dirtyId!== __get$(n.uniformGroups,e.id) )&&( __set$(n.uniformGroups,e.id,e.dirtyId) ,this.syncUniforms(e,n,t))},t.prototype.syncUniforms=function(e,t,n){( __get$(e.syncUniforms,this.shader.program.id) ||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,n)},t.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData);return  __get$(this.cache,t) ||( __set$(this.cache,t,Gy(e,this.shader.program.uniformData)) ), __set$(e.syncUniforms,this.shader.program.id,__get$(this.cache,t)) , __get$(e.syncUniforms,this.shader.program.id) },t.prototype.getSignature=function(e,t){var n=e.uniforms,r=[];for(var i in n)r.push(i), __get$(t,i) &&r.push( __get$(t,i) .type);return r.join(`-`)},t.prototype.getglProgram=function(){return this.shader? __get$(this.shader.program.glPrograms,this.renderer.CONTEXT_UID) :null},t.prototype.generateShader=function(e){var t=this.gl,n=e.program,r={};for(var i in n.attributeData) __set$(r,i,__get$(__get$(n.attributeData,i),"location")) ;var a=Iy(t,n.vertexSrc,n.fragmentSrc,r),o={};for(var s in n.uniformData){var c= __get$(n.uniformData,s) ; __set$(o,s,{location:t.getUniformLocation(a,s),value:Ry(c.type,c.size)}) }var l=new wO(a,o);return  __set$(n.glPrograms,this.renderer.CONTEXT_UID,l) ,l},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(iD),OO=0,kO=1,AO=2,jO=3,MO=4,NO=function(e){function t(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=KT.NONE,this._blendEq=!1,this.map=[], __set$(this.map,OO,this.setBlend) , __set$(this.map,kO,this.setOffset) , __set$(this.map,AO,this.setCullFace) , __set$(this.map,jO,this.setDepthTest) , __set$(this.map,MO,this.setFrontFace) ,this.checks=[],this.defaultState=new oO,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contextChange=function(e){this.gl=e,this.blendModes=Yy(e),this.set(this.defaultState),this.reset()},t.prototype.set=function(e){if(e||=this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,n=0;t;)t&1&& __get$(this.map,n) .call(this,!!(e.data&1<<n)),t>>=1,n++;this.stateId=e.data}for(var r=0;r<this.checks.length;r++) __call$(this.checks,r,[this,e]) },t.prototype.forceState=function(e){e||=this.defaultState;for(var t=0;t<this.map.length;t++) __get$(this.map,t) .call(this,!!(e.data&1<<t));for(var n=0;n<this.checks.length;n++) __call$(this.checks,n,[this,e]) ;this.stateId=e.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e), __call$(this.gl,e?`enable`:`disable`,[this.gl.BLEND]) },t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e), __call$(this.gl,e?`enable`:`disable`,[this.gl.POLYGON_OFFSET_FILL]) },t.prototype.setDepthTest=function(e){ __call$(this.gl,e?`enable`:`disable`,[this.gl.DEPTH_TEST]) },t.prototype.setCullFace=function(e){ __call$(this.gl,e?`enable`:`disable`,[this.gl.CULL_FACE]) },t.prototype.setFrontFace=function(e){this.gl.frontFace( __get$(this.gl,e?`CW`:`CCW`) )},t.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t= __get$(this.blendModes,e) ,n=this.gl;t.length===2?n.blendFunc(t[0],t[1]):n.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,n.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},t.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(e,t){var n=this.checks.indexOf(e);t&&n===-1?this.checks.push(e):!t&&n!==-1&&this.checks.splice(n,1)},t.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},t.checkPolygonOffset=function(e,t){e.setPolygonOffset(t.polygonOffset,0)},t}(iD),PO=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=hT.GC_MAX_IDLE,this.checkCountMax=hT.GC_MAX_CHECK_COUNT,this.mode=hT.GC_MODE}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==tE.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,n=!1,r=0;r<t.length;r++){var i= __get$(t,r) ;!i.framebuffer&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0), __set$(t,r,null) ,n=!0)}if(n){for(var a=0,o=0;o<t.length;o++) __get$(t,o) !==null&&( __set$(t,a++,__get$(t,o)) );t.length=a}},t.prototype.unload=function(e){var t=this.renderer.textureSystem;e._texture&&e._texture._glRenderTargets&&t.destroyTexture(e._texture);for(var n=e.children.length-1;n>=0;n--)this.unload( __get$(e.children,n) )},t}(iD),FO=function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},IO=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ZE}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var n=0;n<t;n++) __set$(this.boundTextures,n,null) ;this.emptyTextures={};var r=new FO(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)), __set$(this.emptyTextures,e.TEXTURE_2D,r) , __set$(this.emptyTextures,e.TEXTURE_CUBE_MAP,new FO(e.createTexture())) ,e.bindTexture(e.TEXTURE_CUBE_MAP, __get$(this.emptyTextures,e.TEXTURE_CUBE_MAP) .texture);for(var i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(var a=0;a<this.boundTextures.length;a++)this.bind(null,a)},t.prototype.bind=function(e,t){t===void 0&&(t=0);var n=this.gl;if(e){if(e=e.baseTexture||e,e.valid){e.touched=this.renderer.textureGC.count;var r= __get$(e._glTextures,this.CONTEXT_UID) ||this.initTexture(e); __get$(this.boundTextures,t) !==e&&(this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),n.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),this.updateTexture(e)), __set$(this.boundTextures,t,e) }}else this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),n.bindTexture(n.TEXTURE_2D, __get$(this.emptyTextures,n.TEXTURE_2D) .texture), __set$(this.boundTextures,t,null) },t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++) __set$(this.boundTextures,e,this.unknownTexture) },t.prototype.unbind=function(e){var t=this,n=t.gl,r=t.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++) __get$(r,i) ===this.unknownTexture&&this.bind(null,i)}for(var a=0;a<r.length;a++) __get$(r,a) ===e&&(this.currentLocation!==a&&(n.activeTexture(n.TEXTURE0+a),this.currentLocation=a),n.bindTexture(n.TEXTURE_2D, __get$(this.emptyTextures,e.target) .texture), __set$(r,a,null) )},t.prototype.initTexture=function(e){var t=new FO(this.gl.createTexture());return t.dirtyId=-1, __set$(e._glTextures,this.CONTEXT_UID,t) ,this.managedTextures.push(e),e.on(`dispose`,this.destroyTexture,this),t},t.prototype.initTextureType=function(e,t){if(t.internalFormat=e.format,t.type=e.type,this.webGLVersion===2){var n=this.renderer.gl;e.type===n.FLOAT&&e.format===n.RGBA&&(t.internalFormat=n.RGBA32F),e.type===XT.HALF_FLOAT&&(t.type=n.HALF_FLOAT),t.type===n.HALF_FLOAT&&e.format===n.RGBA&&(t.internalFormat=n.RGBA16F)}},t.prototype.updateTexture=function(e){var t= __get$(e._glTextures,this.CONTEXT_UID) ;if(t){var n=this.renderer;if(this.initTextureType(e,t),!(e.resource&&e.resource.upload(n,e,t))){var r=e.realWidth,i=e.realHeight,a=n.gl;(t.width!==r||t.height!==i||t.dirtyId<0)&&(t.width=r,t.height=i,a.texImage2D(e.target,0,t.internalFormat,r,i,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},t.prototype.destroyTexture=function(e,t){var n=this.gl;if(e=e.baseTexture||e, __get$(e._glTextures,this.CONTEXT_UID) &&(this.unbind(e),n.deleteTexture( __get$(e._glTextures,this.CONTEXT_UID) .texture),e.off(`dispose`,this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var r=this.managedTextures.indexOf(e);r!==-1&&Sy(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(e){var t= __get$(e._glTextures,this.CONTEXT_UID) ;t&&((e.mipmap===$T.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=0:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=QT.CLAMP:t.wrapMode=e.wrapMode,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},t.prototype.setStyle=function(e,t){var n=this.gl;if(t.mipmap&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,t.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===ZT.LINEAR){var i=Math.min(e.anisotropicLevel,n.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode?n.LINEAR:n.NEAREST)},t}(iD),LO=new xE,RO=function(e){function t(n){n===void 0&&(n={}),e.call(this,`WebGL`,n),n=this.options,this.type=GT.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new UE(`destroy`),contextChange:new UE(`contextChange`,1),reset:new UE(`reset`),update:new UE(`update`),postrender:new UE(`postrender`),prerender:new UE(`prerender`),resize:new UE(`resize`,2)},this.globalUniforms=new TD({projectionMatrix:new xE},!0),this.addSystem(_O,`mask`).addSystem(jD,`context`).addSystem(NO,`state`).addSystem(DO,`shader`).addSystem(IO,`texture`).addSystem(FD,`geometry`).addSystem(MD,`framebuffer`).addSystem(yO,`scissor`).addSystem(bO,`stencil`).addSystem(xO,`projection`).addSystem(PO,`textureGC`).addSystem(DD,`filter`).addSystem(CO,`renderTexture`).addSystem(kD,`batch`),this.initPlugins(t.__plugins),n.context?this.context.initFromContext(n.context):this.context.initFromOptions({alpha:this.transparent,antialias:n.antialias,premultipliedAlpha:this.transparent&&this.transparent!==`notMultiplied`,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,sy(this.context.webGLVersion===2?`WebGL 2`:`WebGL 1`),this.resize(this.options.width,this.options.height)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(e){if(cy())return new t(e);throw Error(`WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.`)},t.prototype.addSystem=function(e,t){t||=e.name;var n=new e(this);if( __get$(this,t) )throw Error(`Whoops! The name "`+t+`" is already in use`);for(var r in  __set$(this,t,n) ,this.runners) __get$(this.runners,r) .add(n);return this},t.prototype.render=function(e,t,n,r,i){if(this.renderingToScreen=!t,this.runners.prerender.run(),this.emit(`prerender`),this.projection.transform=r,!this.context.isLost){if(t||(this._lastObjectRendered=e),!i){var a=e.parent;e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=a}this.renderTexture.bind(t),this.batch.currentRenderer.start(),(n===void 0?this.clearBeforeRender:n)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),t&&t.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit(`postrender`)}},t.prototype.resize=function(t,n){e.prototype.resize.call(this,t,n),this.runners.resize.run(t,n)},t.prototype.reset=function(){return this.runners.reset.run(),this},t.prototype.clear=function(){this.framebuffer.bind(),this.framebuffer.clear()},t.prototype.destroy=function(t){for(var n in this.runners.destroy.run(),this.runners) __get$(this.runners,n) .destroy();e.prototype.destroy.call(this,t),this.gl=null},t.registerPlugin=function(e,n){t.__plugins=t.__plugins||{}, __set$(t.__plugins,e,n) },t}(function(e){function t(t,n){e.call(this),n= __call$(Object,"assign",[{},hT.RENDER_OPTIONS,n]) ,n.roundPixels&&(hT.ROUND_PIXELS=n.roundPixels,Ty(`5.0.0`,`Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS`,2)),this.options=n,this.type=GT.UNKNOWN,this.screen=new jE(0,0,n.width,n.height),this.view=n.view||document.createElement(`canvas`),this.resolution=n.resolution||hT.RESOLUTION,this.transparent=n.transparent,this.autoDensity=n.autoDensity||n.autoResize||!1,this.preserveDrawingBuffer=n.preserveDrawingBuffer,this.clearBeforeRender=n.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString=`#000000`,this.backgroundColor=n.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new RE,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return t.prototype.initPlugins=function(e){for(var t in e) __set$(this.plugins,t,new e[t](this)) },n.width.get=function(){return this.view.width},n.height.get=function(){return this.view.height},t.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+`px`,this.view.style.height=t+`px`)},t.prototype.generateTexture=function(e,t,n,r){r||=e.getLocalBounds(),r.width===0&&(r.width=1),r.height===0&&(r.height=1);var i=fD.create(r.width|0,r.height|0,t,n);return LO.tx=-r.x,LO.ty=-r.y,this.render(e,i,!1,LO,!!e.parent),i},t.prototype.destroy=function(e){for(var t in this.plugins) __get$(this.plugins,t) .destroy(), __set$(this.plugins,t,null) ;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=GT.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},n.backgroundColor.get=function(){return this._backgroundColor},n.backgroundColor.set=function(e){this._backgroundColor=e,this._backgroundColorString=uy(e),ly(e,this._backgroundColorRgba)},Object.defineProperties(t.prototype,n),t}(_T)),zO=function(){this.texArray=null,this.blend=0,this.type=qT.TRIANGLES,this.start=0,this.size=0,this.data=null},BO=function(){this.elements=[],this.ids=[],this.count=0},BO.prototype.clear=function(){for(var e=0;e<this.count;e++) __set$(this.elements,e,null) ;this.count=0},VO=function(e){this.rawBinaryData=new ArrayBuffer(e),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},HO={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}},HO.int8View.get=function(){return this._int8View||=new Int8Array(this.rawBinaryData),this._int8View},HO.uint8View.get=function(){return this._uint8View||=new Uint8Array(this.rawBinaryData),this._uint8View},HO.int16View.get=function(){return this._int16View||=new Int16Array(this.rawBinaryData),this._int16View},HO.uint16View.get=function(){return this._uint16View||=new Uint16Array(this.rawBinaryData),this._uint16View},HO.int32View.get=function(){return this._int32View||=new Int32Array(this.rawBinaryData),this._int32View},VO.prototype.view=function(e){return  __get$(this,e+`View`) },VO.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},VO.sizeOf=function(e){switch(e){case`int8`:case`uint8`:return 1;case`int16`:case`uint16`:return 2;case`int32`:case`uint32`:case`float32`:return 4;default:throw Error(e+` isn't a valid view type`)}},Object.defineProperties(VO.prototype,HO),UO=function(e){function t(t){e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=oO.for2d(),this.size=hT.SPRITE_BATCH_SIZE*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on(`prerender`,this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contextChange=function(){var e=this.renderer.gl;hT.PREFER_ENV===WT.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),hT.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Ky(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var t=0;t<this._packedGeometryPoolSize;t++) __set$(this._packedGeometries,t,new this.geometryClass()) ;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,n=t._textureArrayPool,r=this.size/4,i=Math.floor(r/this.MAX_TEXTURES)+1;e.length<r;)e.push(new zO);for(;n.length<i;)n.push(new BO);for(var a=0;a<this.MAX_TEXTURES;a++) __set$(this._tempBoundTextures,a,null) },t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length, __set$(this._bufferedTextures,this._bufferSize,e._texture.baseTexture) , __set$(this._bufferedElements,this._bufferSize++,e) )},t.prototype.buildTexturesAndDrawCalls=function(){var e=this,n=e._bufferedTextures,r=e.MAX_TEXTURES,i=t._textureArrayPool,a=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count,c=++ZE._globalBatch,l=0,u=i[0],d=0;a.copyBoundTextures(o,r);for(var f=0;f<this._bufferSize;++f){var p= __get$(n,f) ; __set$(n,f,null) ,p._batchEnabled!==c&&(u.count>=r&&(a.boundArray(u,o,c,r),this.buildDrawCalls(u,d,f),d=f,u= __get$(i,++l) ,++c),p._batchEnabled=c,p.touched=s, __set$(u.elements,u.count++,p) )}u.count>0&&(a.boundArray(u,o,c,r),this.buildDrawCalls(u,d,this._bufferSize),++l,++c);for(var m=0;m<o.length;m++) __set$(o,m,null) ;ZE._globalBatch=c},t.prototype.buildDrawCalls=function(e,n,r){var i=this,a=i._bufferedElements,o=i._attributeBuffer,s=i._indexBuffer,c=i.vertexSize,l=t._drawCallPool,u=this._dcIndex,d=this._aIndex,f=this._iIndex,p= __get$(l,u) ;p.start=this._iIndex,p.texArray=e;for(var m=n;m<r;++m){var h= __get$(a,m) ,g= __get$(__get$(sE,h._texture.baseTexture.alphaMode?1:0),h.blendMode) ; __set$(a,m,null) ,n<m&&p.blend!==g&&(p.size=f-p.start,n=m,p= __get$(l,++u) ,p.texArray=e,p.start=f),this.packInterleavedGeometry(h,o,s,d,f),d+=h.vertexData.length/2*c,f+=h.indices.length,p.blend=g}n<r&&(p.size=f-p.start,++u),this._dcIndex=u,this._aIndex=d,this._iIndex=f},t.prototype.bindAndClearTexArray=function(e){for(var t=this.renderer.texture,n=0;n<e.count;n++)t.bind( __get$(e.elements,n) , __get$(e.ids,n) ), __set$(e.elements,n,null) ;e.count=0},t.prototype.updateGeometry=function(){var e=this,t=e._packedGeometries,n=e._attributeBuffer,r=e._indexBuffer;hT.CAN_UPLOAD_SAME_BUFFER?( __get$(t,this._flushId) ._buffer.update(n.rawBinaryData), __get$(t,this._flushId) ._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++, __set$(t,this._flushId,new this.geometryClass()) ), __get$(t,this._flushId) ._buffer.update(n.rawBinaryData), __get$(t,this._flushId) ._indexBuffer.update(r),this.renderer.geometry.bind( __get$(t,this._flushId) ),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,n=this.renderer,r=n.gl,i=n.state,a=t._drawCallPool,o=null,s=0;s<e;s++){var c= __get$(a,s) ,l=c.texArray,u=c.type,d=c.size,f=c.start,p=c.blend;o!==l&&(o=l,this.bindAndClearTexArray(l)),this.state.blendMode=p,i.set(this.state),r.drawElements(u,d,r.UNSIGNED_SHORT,f*2)}},t.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),hT.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind( __get$(this._packedGeometries,this._flushId) )},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++) __get$(this._packedGeometries,t) && __get$(this._packedGeometries,t) .destroy();this.renderer.off(`prerender`,this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&=(this._shader.destroy(),null),e.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var t=yy(Math.ceil(e/8)),n=xy(t),r=t*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var i= __get$(this._aBuffers,r) ;return i||( __set$(this._aBuffers,r,i=new VO(r*this.vertexSize*4)) ),i},t.prototype.getIndexBuffer=function(e){var t=yy(Math.ceil(e/12)),n=xy(t),r=t*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var i= __get$(this._iBuffers,n) ;return i||( __set$(this._iBuffers,n,i=new Uint16Array(r)) ),i},t.prototype.packInterleavedGeometry=function(e,t,n,r,i){for(var a=t.uint32View,o=t.float32View,s=r/this.vertexSize,c=e.uvs,l=e.indices,u=e.vertexData,d=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),p=f<1&&e._texture.baseTexture.alphaMode?gy(e._tintRGB,f):e._tintRGB+(f*255<<24),m=0;m<u.length;m+=2) __set$(o,r++,__get$(u,m)) , __set$(o,r++,__get$(u,m+1)) , __set$(o,r++,__get$(c,m)) , __set$(o,r++,__get$(c,m+1)) , __set$(a,r++,p) , __set$(o,r++,d) ;for(var h=0;h<l.length;h++) __set$(n,i++,s+__get$(l,h)) },t}(OD),UO._drawCallPool=[],UO._textureArrayPool=[],WO=function(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf(`%count%`)<0)throw Error(`Fragment template must contain "%count%".`);if(t.indexOf(`%forloop%`)<0)throw Error(`Fragment template must contain "%forloop%".`)},WO.prototype.generateShader=function(e){if(! __get$(this.programCache,e) ){for(var t=new Int32Array(e),n=0;n<e;n++) __set$(t,n,n) ; __set$(this.defaultGroupCache,e,TD.from({uSamplers:t},!0)) ;var r=this.fragTemplate;r= __call$(r,"replace",[/%count%/gi,``+e]) ,r= __call$(r,"replace",[/%forloop%/gi,this.generateSampleSrc(e)]) , __set$(this.programCache,e,new ZD(this.vertexSrc,r)) }var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new xE,default: __get$(this.defaultGroupCache,e) };return  new $D(__get$(this.programCache,e),i) },WO.prototype.generateSampleSrc=function(e){var t=``;t+=`
`,t+=`
`;for(var n=0;n<e;n++)n>0&&(t+=`
else `),n<e-1&&(t+=`if(vTextureId < `+n+`.5)`),t+=`
{`,t+=`
	color = texture2D(uSamplers[`+n+`], vTextureCoord);`,t+=`
}`;return t+=`
`,t+=`
`,t},GO=function(e){function t(t){t===void 0&&(t=!1),e.call(this),this._buffer=new gD(null,t,!1),this._indexBuffer=new gD(null,t,!0),this.addAttribute(`aVertexPosition`,this._buffer,2,!1,XT.FLOAT).addAttribute(`aTextureCoord`,this._buffer,2,!1,XT.FLOAT).addAttribute(`aColor`,this._buffer,4,!0,XT.UNSIGNED_BYTE).addAttribute(`aTextureId`,this._buffer,1,!0,XT.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(xD),KO=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,qO=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,JO=function(){},YO={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}},JO.create=function(e){var t= __call$(Object,"assign",[{vertex:KO,fragment:qO,geometryClass:GO,vertexSize:6},e]) ,n=t.vertex,r=t.fragment,i=t.vertexSize,a=t.geometryClass;return function(e){function t(t){e.call(this,t),this.shaderGenerator=new WO(n,r),this.geometryClass=a,this.vertexSize=i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(UO)},YO.defaultVertexSrc.get=function(){return KO},YO.defaultFragmentTemplate.get=function(){return qO},Object.defineProperties(JO,YO),XO=JO.create()}));function QO(e,t){let n=Object.values(e).map(e=>e.name);return t.reduce((e,t)=>{let r=n.indexOf(t.name);return r>-1?e.splice(r,1,t):e.push(t),e},e)}var $O=e((()=>{bt(),ZO(),rb.Plugin.Name,Ib.Plugin.Name,qb.Perspective.TOP_DOWN,Gb.board}));function ek(e,t){let n=On(e);return t?{file:9-n.file,rank:9-n.rank}:n}function tk(e,t){let n=ek(e,t);return{x:n.file*100-100,y:(8-n.rank)*100}}function nk( _hh$temp914 ){ var e=_hh$temp914.appendTo,_hh$temp914$elementType=_hh$temp914.elementType,t=_hh$temp914$elementType===void 0?`div`:_hh$temp914$elementType,n=_hh$temp914.insertBefore,_hh$temp914$startingCount=_hh$temp914.startingCount,r=_hh$temp914$startingCount===void 0?0:_hh$temp914$startingCount; if(!e&&!n)throw new LC({code:RC.BadData,message:`When creating an element pool, you must provide an element to "appendTo" or "insertBefore".`});let i=Array(r).fill(void 0).map(a).map(c);return{destroy:o,get:s,put:l};function a(){var r;let i=document.createElement(t);return i.className=ik,e?e.appendChild(i):(r=n?.parentNode)==null||r.insertBefore(i,n),i}function o(){i.forEach(e=>e.parentNode?.removeChild(e)),i.length=0}function s(){return u(i.pop()||a())}function c(e){for(let t in e.dataset) __get$(e.dataset,t) &&( __set$(e.dataset,t,``) );return e.className=ik,e.style.cssText=``,e}function l(e){return c(e),i.push(e),e}function u(e){return e.className=``,e}}var rk,ik,ak,ok=e((()=>{ZO(),rk=(e=>( __set$(e,e.Slide=0,`Slide`) , __set$(e,e.FadeOut=1,`FadeOut`) ,e))(rk||{}),ik=`element-pool`,ak=(e=>(e.Created=`Created`,e.DetailsSet=`DetailsSet`,e.DragEnded=`DragEnd`,e.DragStarted=`DragStart`,e.PieceShown=`PieceShown`,e.PieceHidden=`PieceHidden`,e.PositionSetBySquare=`PositionSetBySquare`,e))(ak||{})}));function sk( _hh$temp915 ){ var e=_hh$temp915.board;  let _hh$temp916=e.el,t=_hh$temp916.classList; return{addAnalysisOverlay:n,removeAnalysisOverlay:r};function n(){t.add(`analysis-overlay`)}function r(){t.remove(`analysis-overlay`)}}function ck( _hh$temp917 ){ var e=_hh$temp917.from,t=_hh$temp917.to; let n=hv({from:e,to:t});return`
    ${e.x-Bk} ${e.y+Hk},
    ${e.x-Bk} ${e.y+n-Vk},
    ${e.x-Uk} ${e.y+n-Vk},
    ${e.x} ${e.y+n},
    ${e.x+Uk} ${e.y+n-Vk},
    ${e.x+Bk} ${e.y+n-Vk},
    ${e.x+Bk} ${e.y+Hk}
  `.trim()}function lk( _hh$temp918 ){ var e=_hh$temp918.from,t=_hh$temp918.polygon,n=_hh$temp918.to; let r=gv({from:e,to:n});return t.setAttribute(`transform`,`rotate(${r} ${e.x} ${e.y})`),t.setAttribute(`points`,ck({from:e,to:n})),t}function uk( _hh$temp919 ){ var e=_hh$temp919.from; return`
    ${e.x-Wk} ${e.y+Kk},
    ${e.x-Wk} ${e.y+25+Wk},
    ${e.x+12.5-Gk} ${e.y+25+Wk},
    ${e.x+12.5-Gk} ${e.y+25+qk},
    ${e.x+12.5} ${e.y+25},
    ${e.x+12.5-Gk} ${e.y+25-qk},
    ${e.x+12.5-Gk} ${e.y+25-Wk},
    ${e.x+Wk} ${e.y+25-Wk},
    ${e.x+Wk} ${e.y+Kk}
  `.trim()}function dk( _hh$temp920 ){ var e=_hh$temp920.from,t=_hh$temp920.polygon,n=_hh$temp920.slope,r=_hh$temp920.to; let i=`rotate(${vv({from:e,slope:n,to:r})} ${e.x} ${e.y})`;return Qw.includes(n)&&(i+=` scale(-1, 1) translate(-${2*e.x}, 0)`),t.setAttribute(`transform`,i),t.setAttribute(`points`,uk({from:e})),t}function fk(e,t){if(!e.key)return; let _hh$temp921=e.data,n=_hh$temp921.color,r=_hh$temp921.from,i=_hh$temp921.opacity,a=_hh$temp921.to,o=document.createElementNS(`http://www.w3.org/2000/svg`,`polygon`); o.setAttribute(`id`,`arrow-${r}${a}`),o.setAttribute(`data-arrow`,`${r}${a}`),o.setAttribute(`class`,`arrow`); let _hh$temp922=t.options,s=_hh$temp922.arrowColors; o.style.fill=mv(n,s),i&&(o.style.opacity=String(i));let c= __get$(zk,r) ,l= __get$(zk,a) ;if(!c||!l)return;let u=hv({from:c,to:l}),d=_v({from:c,to:l});return $w.includes(d)&&u===27.95084971874737?dk({from:c,polygon:o,slope:d,to:l}):lk({from:c,polygon:o,to:l})}function pk( _hh$temp923 ){ var e=_hh$temp923.board; let t=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);t.setAttribute(`viewBox`,`0 0 100 100`),t.classList.add(`arrows`),e.addToDom({el:t,type:ox.Arrows});let n=new Map;return{addArrows:r,removeArrows:i};function r(e,r){e.forEach(e=>{let i=fk(e,r);i&&(t.appendChild(i),n.set(e.key,i))})}function i(e){e.forEach(e=>{ let _hh$temp924=e,r=_hh$temp924.key,i=n.get(r); i&&(t.removeChild(i),n.delete(r))})}}function mk( _hh$temp925 ){ var e=_hh$temp925.boardStyles,t=_hh$temp925.options,n=_hh$temp925.pieceStyles; return c(t),{destroy:r,getStyleEl:i,getPieceStyles:()=>n,updateStyles:c};function r(){let e=document.getElementById(a());!e||!e.parentNode||e.parentNode.removeChild(e)}function i(){return document.getElementById(a())}function a(){return t.useSharedStyleTag?`board-styles-shared`:`board-styles-${t.id}`}function o(t,r=!1){ let _hh$temp926=t,i=_hh$temp926.boardStyle,a=_hh$temp926.id,o=_hh$temp926.pieceStyle,_hh$temp927=__get$(n,o)??Zb.neo,s=_hh$temp927.path,c=_hh$temp927.format,l=_hh$temp927.isPseudo3d,u=It(s,void 0,t),d=__get$(e,i)??Xb.green,f=l?`::after`:``,p=r?Yb.reduce((e,t)=>`${e}#board-${a} .piece.${t}, #board-${a} .promotion-piece.${t} {
            background-image: url('${__get$(Wb,t)}');
          }`,``):Yb.reduce((e,t)=>`${e}#board-${a} .piece.${t}${f}, #board-${a} .promotion-piece.${t}${f} {
            background-image: url('${u}/${t}.${c}');
          }`,``),m=`
      #board-${a}, .fade-in-overlay {
        background-image: url('${dv(d[2],void 0,t)}');
      }
      .coordinate-light {
        fill: ${d[0]};
      }
      .coordinate-dark {
        fill: ${d[1]};
      }
      .highlight {
        background-color: ${d[4]};
      }
    `,h=`#board-${a}, #board-${a} .piece {
      ${Yk}
    }`; return m+p+h}function s(e,t=!1){ let _hh$temp928=e,n=_hh$temp928.id,r=_hh$temp928.themeAssets; if(!r)return o(e,t);let i=r.config.perspective===qb.Perspective.PSEUDO_3D?`::after`:``,a=Object.keys(r.pieces.assets).reduce((e,t)=>`${e}#board-${n} .piece.${t}${i}, #board-${n} .promotion-piece.${t}${i} {
        background-image: url('${ __get$(r.pieces.assets,t) }');
      }`,``),s=`
      #board-${n}, .fade-in-overlay {
        background-image: url('${r.board.assets.background}');
      }
      .coordinate-light {
        fill: ${r.board.config.lightSquareCoordinateHex};
      }
      .coordinate-dark {
        fill: ${r.board.config.darkSquareCoordinateHex};
      }
      .highlight {
        background-color: ${r.board.config.highlightSquareHex};
      }
    `,c=`#board-${n}, #board-${n} .piece {
      ${Yk}
    }`;return s+a+c}function c(e,t=!1){let n=a(),r=i();if(!r){r=document.createElement(`style`),r.type=`text/css`,r.id=n;let e=document.head;e&&e.appendChild(r)}let o=s(e,t);r.innerHTML!==o&&(r.innerHTML=o,setTimeout(()=>{r&&(r.innerHTML= __call$(r.innerHTML,"replace",[Yk,``]) )},Jk+50))}}function hk( _hh$temp929 ){ var e=_hh$temp929.boardStyles,t=_hh$temp929.el,n=_hh$temp929.options,r=_hh$temp929.pieceStyles; let i=mk({boardStyles:e,options:n,pieceStyles:r});return{destroy:a,updateBoardImage:o,updatePieceBaseImage:s,togglePseudo3d:c,getPieceStyles:i.getPieceStyles};function a(){i.destroy()}function o(e){i.updateStyles(Ht(e.options))}function s(e,t=!1){c(e.options),i.updateStyles(Ht(e.options),t)}function c(e){let i=e.themeAssets?e.themeAssets.config.perspective===qb.Perspective.PSEUDO_3D: __get$(r,n.pieceStyle) .isPseudo3d;t.classList.toggle(ex.Pseudo3d,!!i)}}function gk( _hh$temp930 ){ var e=_hh$temp930.el,t=_hh$temp930.options,_hh$temp930$testElement=_hh$temp930.testElement,n=_hh$temp930$testElement===void 0?cx.Board:_hh$temp930$testElement; var r;let i={[ox.Coordinates]:document.createComment(`/Coordinates`),[ox.Squares]:document.createComment(`/Squares`),[ox.BlinkingHighlights]:document.createComment(`/Blinking Highlights`),[ox.Effects]:document.createComment(`/Effects`),[ox.HoverSquare]:document.createComment(`/Hover Square`),[ox.Pieces]:document.createComment(`/Pieces`),[ox.MoveHints]:document.createComment(`/MoveHints`),[ox.CaptureHints]:document.createComment(`/Capture Hints`),[ox.Arrows]:document.createComment(`/Arrows`),[ox.PromotionWindow]:document.createComment(`/Promotion Window`),[ox.FadeSetup]:document.createComment(`/Fade Setup`)};Object.values(i).forEach(t=>e.appendChild(t));let a=wc();return(r=a.resolve)==null||r.call(a,!0),t.test&&An(e,{[sx.Element]:n}),{addToDom:o,animationComplete:f,el:e,flipBoard:s,setBoardEnabled:u,isAnimating:d,isFlipped:p,placeholders:i,setAnimatingStatus:m,reset:c};function o( _hh$temp931 ){ var t=_hh$temp931.type,n=_hh$temp931.el,_hh$temp931$insertAfter=_hh$temp931.insertAfter,r=_hh$temp931$insertAfter===void 0?!1:_hh$temp931$insertAfter; r?e.insertBefore(n, __get$(i,t) .nextSibling):e.insertBefore(n, __get$(i,t) )}function s(t,n){if(e.classList.toggle(ex.Flipped,t),n?.options.allowMarkings){let e=n.api.markings.getAllWhere({types:[Sb]});e.length>0&&l(e,n.renderer)}}function c(){e.innerHTML=``,e.classList.remove(ex.Flipped)}function l(t,n){t.forEach(t=>{ let _hh$temp932=t,_hh$temp932$data=_hh$temp932.data,r=_hh$temp932$data.square,i=_hh$temp932.key,a=(n?.getEffectElements?.call(n).get(i)); if(a){if(a.classList.contains(`tuck-right`)||a.classList.contains(`tuck-top`)){a.classList.remove(`tuck-right`),a.classList.remove(`tuck-top`);return}Rn(r)&&zn({square:r,isFlipped:e.classList.contains(`flipped`),effectEl:a})}})}function u(){}function d(){return!!e.dataset.testAnimating}function f(e){return[tx.All,tx.Move].includes(e)?a.promise:Promise.resolve(!0)}function p(){return t.flipped}function m(t){var n;t?(e.dataset.testAnimating=`true`,a=wc()):(delete e.dataset.testAnimating,(n=a.resolve)==null||n.call(a,!0))}}function _k(e){let t=[`8`,`7`,`6`,`5`,`4`,`3`,`2`,`1`,`a`,`b`,`c`,`d`,`e`,`f`,`g`,`h`];return e?[...t.slice(0,8).reverse(),...t.slice(-8).reverse()]:t}function vk(e){return e===Qb.CoordinatesPositions.Outside?[{color:`grey`,fontSize:3.1,x:2,y:3.5},{color:`grey`,fontSize:3.1,x:2,y:16},{color:`grey`,fontSize:3.1,x:2,y:28.5},{color:`grey`,fontSize:3.1,x:2,y:41},{color:`grey`,fontSize:3.1,x:2,y:53.5},{color:`grey`,fontSize:3.1,x:2,y:66},{color:`grey`,fontSize:3.1,x:2,y:78.5},{color:`grey`,fontSize:3.1,x:2,y:91},{color:`grey`,fontSize:3.1,x:10.35,y:99.25},{color:`grey`,fontSize:3.1,x:22.85,y:99.25},{color:`grey`,fontSize:3.1,x:35.35,y:99.25},{color:`grey`,fontSize:3.1,x:47.85,y:99.25},{color:`grey`,fontSize:3.1,x:60.35,y:99.25},{color:`grey`,fontSize:3.1,x:72.85,y:99.25},{color:`grey`,fontSize:3.1,x:85.35,y:99.25},{color:`grey`,fontSize:3.1,x:97.85,y:99.25}]:[{color:`light`,fontSize:2.8,x:.75,y:3.5},{color:`dark`,fontSize:2.8,x:.75,y:15.75},{color:`light`,fontSize:2.8,x:.75,y:28.25},{color:`dark`,fontSize:2.8,x:.75,y:40.75},{color:`light`,fontSize:2.8,x:.75,y:53.25},{color:`dark`,fontSize:2.8,x:.75,y:65.75},{color:`light`,fontSize:2.8,x:.75,y:78.25},{color:`dark`,fontSize:2.8,x:.75,y:90.75},{color:`dark`,fontSize:2.8,x:10,y:99},{color:`light`,fontSize:2.8,x:22.5,y:99},{color:`dark`,fontSize:2.8,x:35,y:99},{color:`light`,fontSize:2.8,x:47.5,y:99},{color:`dark`,fontSize:2.8,x:60,y:99},{color:`light`,fontSize:2.8,x:72.5,y:99},{color:`dark`,fontSize:2.8,x:85,y:99},{color:`light`,fontSize:2.8,x:97.5,y:99}]}function yk(e,t){let n=_k(t);return vk(e).map((e,t)=>({...e,text: __get$(n,t) })).map(e=>`<text 
          x="${e.x}" 
          y="${e.y}" 
          ${e.fontSize?`font-size="${e.fontSize}"`:``} 
          class="coordinate-${e.color}">${e.text}</text>`).join(``)}function bk( _hh$temp933 ){ var e=_hh$temp933.board,t=_hh$temp933.options; return{setCoordinates:r};function n(n,r){let i=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);i.setAttribute(`viewBox`,`0 0 100 100`),i.classList.add(`coordinates`),n===Qb.CoordinatesPositions.Outside&&i.classList.add(`outside`),t.test&&An(i,{[sx.Element]:cx.Coordinates,[sx.Flipped]:r.toString(),[sx.Position]:n}),i.innerHTML=yk(n,r),e.addToDom({el:i,type:ox.Coordinates})}function r( _hh$temp934 ){ var e=_hh$temp934.flipped,t=_hh$temp934.position; i(),t!==Qb.CoordinatesPositions.Off&&n(t,e)}function i(){let t=e.el.querySelector(`.coordinates`);t&&t.parentNode.removeChild(t)}}function xk( _hh$temp935 ){ var e=_hh$temp935.board; let t;return{fadeSetup:a};function n(n){t=document.createElement(`div`),t.classList.add(`fade-in-overlay`),e.addToDom({el:t,type:ox.FadeSetup}),t.addEventListener(`animationend`,r),n.test&&An(t,{[sx.Element]:cx.FadeInOverlay})}function r(){t&&(t.style.animationDuration=``,t.classList.remove(`animate`))}function i(){t&&t.remove(),t=void 0}function a( _hh$temp936 ){ var e=_hh$temp936.options; if(e.fadeSetup===0){t&&i();return}t||n(e),t&&(t.style.animationDuration=`${e.fadeSetup/1e3}s`,t.classList.add(`animate`))}}function Sk( _hh$temp937 ){ var e=_hh$temp937.board,t=_hh$temp937.options; let n=a();return{hideHoverSquare:i,showHoverSquare:r};function r(e){n.style.visibility=``,t.test&&An(n,{[sx.Element]:cx.HoverSquare}),kn({el:n,square:e})}function i(){n&&(n.style.visibility=`hidden`)}function a(){let n=document.createElement(`div`),r=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);return r.setAttribute(`viewBox`,`0 0 100 100`),r.innerHTML=`<rect x="0" y="0" width="100" height="100" stroke="rgba(255, 255, 255, 0.65)" stroke-width="10" fill="none"/>`,n.append(r),n.classList.add(`hover-square`),n.style.visibility=`hidden`,e.addToDom({el:n,type:ox.HoverSquare}),t.test&&An(n,{[sx.Element]:cx.HoverSquare}),n}}function Ck( _hh$temp938 ){ var e=_hh$temp938.board; let t={};return{addCaptureHints:r,addMoveHints:n,removeHints:i};function n(n){n.forEach(n=>{ __get$(t,n) ||( __set$(t,n,a(n)) ,e.addToDom({el: __get$(t,n) ,type:ox.MoveHints}))})}function r(n){n.forEach(n=>{ __get$(t,n) &&o(n), __set$(t,n,a(n,{isPotentialCapture:!0})) ,e.addToDom({el: __get$(t,n) ,type:ox.CaptureHints}), __get$(t,n) .style.borderWidth=`${ __get$(t,n) .clientWidth*.1}px`})}function i(e){e.forEach(o)}function a(e,t={}){let n=document.createElement(`div`);return An(n,{[sx.Element]:t.isPotentialCapture?cx.PotentialCapture:cx.Hint}),n.classList.add(t.isPotentialCapture?`capture-hint`:`hint`),kn({el:n,square:e}),n}function o(e){ __get$(t,e) &&( __get$(t,e) .parentNode.removeChild( __get$(t,e) ),delete t[e])}}function wk(e,t){return{data:{color:t,interval:500,opacity:.5,square:e,times:3},key:e,type:nb}}function Tk( _hh$temp939 ){ var e=_hh$temp939.animation,t=_hh$temp939.numSteps; return Array(t).fill(void 0).map((n,r,i)=>{let a,o=2.86-2.86*((r+1)/t);return o=o>1?1:o,r===i.length-1&&e.callback&&(a=e.callback),{callback:a,el:e.el,style:{opacity:o.toString()}}})}function Ek( _hh$temp940 ){ var e=_hh$temp940.animation,_hh$temp940$isFlipped=_hh$temp940.isFlipped,t=_hh$temp940$isFlipped===void 0?!1:_hh$temp940$isFlipped,n=_hh$temp940.numSteps;  let _hh$temp941=e,r=_hh$temp941.el,i=_hh$temp941.from,a=_hh$temp941.to; if(!i||!a)return[];let o=tk(i,t),s=tk(a,t);if(!o||!s)return[];let c=(s.x-o.x)/n,l=(s.y-o.y)/n;return Array(n).fill(void 0).map((e,t)=>{let i=t===n-1,a=i?s:{x:o.x+c*(t+1),y:o.y+l*(t+1)};return{el:r,style:{transform:i?``:`translate(${a.x}%, ${a.y}%)`,zIndex:i?``:`10`}}})}function Dk(e){let t,n=[],r={[rk.FadeOut]:Tk,[rk.Slide]:Ek};return{add:i,flush:a,run:o};function i(e,t){ let _hh$temp942=t,i=_hh$temp942.animationType,a=_hh$temp942.flipped,o=Math.max(Math.floor(Ok(i)/Xk),1); e.map(e=> __call$(r,e.type,[{animation:e,isFlipped:a||!1,numSteps:o}]) ).forEach(e=>{if(e.length>n.length){let t=Array(e.length-n.length).fill([]);n.unshift(...t)}e.forEach((e,t,r)=>{let i=r.length-t; __set$(n,n.length-i,[...__get$(n,n.length-i),e]) })})}function a(){if(n.length===0){t=!0;return}n.splice(0,n.length-1),o()}function o(){t=n.length<2;let r=n.shift();r&&(e.isAnimating()||e.setAnimatingStatus(!0),r.forEach(e=>{Object.entries(e.style).forEach(( _hh$temp943 )=>{ var _hh$temp944=__arrayFrom$(_hh$temp943),t=_hh$temp944[0],n=_hh$temp944[1];  __set$(e.el.style,t,n) }),e.callback&&e.callback()}),n.length===0&&e.setAnimatingStatus(!1),t||requestAnimationFrame(()=>{o()}))}}function Ok(e){switch(e){case Qb.Animation.Types.Slow:return Qb.Animation.Speeds.Slow;case Qb.Animation.Types.Fast:return Qb.Animation.Speeds.Fast;case Qb.Animation.Types.None:return 0;default:return Qb.Animation.Speeds.Default}}function kk( _hh$temp945 ){ var e=_hh$temp945.details,t=_hh$temp945.el,n=_hh$temp945.emitter,r=_hh$temp945.test; let i,a={...e};return t.classList.add(`piece`),n.emit(ak.Created,{...a}),c(a.color,a.type),u(a.square),r&&An(t,{[sx.Element]:cx.Piece}),{el:t,getDetails:s,setDetails:c,setDraggingState:l,setPositionByCoords:d,setPositionBySquare:u};function o(e,t){return`${Hp(e)}${t}`}function s(){return e}function c(a,s){t.classList.remove(i),i=o(a,s),t.classList.add(i),e.type=s,e.color=a,n.emit(ak.DetailsSet,{...e,shortString:i}),r&&An(t,{[sx.Type]:s,[sx.Color]:Hp(a),[sx.ShortString]:a===J.ColorsAsNumbers.Black?s:s.toUpperCase()})}function l(i){if(i){t.classList.add(`dragging`),n.emit(ak.DragStarted,{...e}),r&&An(t,{[sx.Dragging]:`true`});return}r&&An(t,{[sx.Dragging]:void 0}),t.classList.remove(`dragging`),n.emit(ak.DragEnded,{...e})}function u(i,a){if(r){let e=On(i);if(!e)return;e&&!a&&An(t,{[sx.File]:e.file.toString(),[sx.Rank]:e.rank.toString(),[sx.Square]:i})}kn({el:t,square:i}),n.emit(ak.PositionSetBySquare,{...e})}function d(e){e&&(t.style.transform=`translate(${e.x}%, ${e.y}%)`)}}function Ak( _hh$temp946 ){ var e=_hh$temp946.board,t=_hh$temp946.emitter,n=_hh$temp946.options; let r=nk({insertBefore:e.placeholders.pieces,startingCount:32}),i=Dk(e),a,o=En();return{animations:i,create:s,destroy:c,get:l,getDraggingSquare:u,move:d,remove:f,setDraggingState:p,setPositionByCoords:m,setPositionBySquare:h,suspendOverSquare:g};function s(e){let i=kk({details:e,el:r.get(),emitter:t,test:n.test});return o.set(e.square,i),t.emit(ak.PieceShown,{...o.get(e.square)}),i}function c(){r.destroy()}function l(e,t=!0){if(!e)return o;if(!o.isDefined(e)&&t)throw new LC({code:RC.ElementNotFound,data:{square:e},message:`Piece does not exist.`});return o.isDefined(e)?o.get(e):void 0}function u(){return a}function d(e,t){let n=Array.isArray(e)?e:[e],r=n.filter(Boolean).map(e=>yr(e)),a=n.filter(Boolean).map(e=>l(e.from)),s=[];n.forEach((e,t)=>{if(!e)throw new LC({code:RC.ElementNotFound,message:`Move object does not exist.`});let n=yr(e);n&&( __get$(a,t) .setPositionBySquare(n),e.animate&&s.push({el: __get$(a,t) .el,from:e.from,to:n,type:rk.Slide}),o.set(n, __get$(a,t) ),r.includes(e.from)||o.deleteItem(e.from),e.promotion&&o.get(n).setDetails(e.color,e.promotion))}),s.length&&i.add(s,t)}function f( _hh$temp947 ){ var e=_hh$temp947.animate,n=_hh$temp947.options,s=_hh$temp947.squares; let c=[];s.forEach(n=>{if(!o.isDefined(n))return;let i=l(n).el;e?c.push({callback:a,el:l(n).el,type:rk.FadeOut}):a(),o.deleteItem(n);function a(){if(!i)throw new LC({code:RC.ElementNotFound,data:{square:n},message:`Piece does not exist. Cannot remove.`});r.put(i),t.emit(ak.PieceHidden,n)}}),c.length&&i.add(c,n),a&&!o.isDefined(a)&&(a=void 0)}function p(e,t){l(e).setDraggingState(t),a=t?e:void 0}function m(e,t){let n=l(e),r=u();r&&p(r,!1),n.setPositionByCoords(t)}function h(e,t){let n=l(e);t!==e&&(o.set(t,o.get(e)),o.deleteItem(e)),n.setPositionBySquare(t)}function g(e,t){l(e).setPositionBySquare(t,!0)}}function jk( _hh$temp948 ){ var e=_hh$temp948.board,t=_hh$temp948.emitter,n=_hh$temp948.options; let r=Ak({board:e,emitter:t,options:n});return{destroy:r.destroy,dragPiece:i,dropPiece:a,illegalMove:o,loadPieces:c,makeMove:s,removePiece:l,undoMove:u};function i(e){e&&(e.toSquare?r.suspendOverSquare(e.square,e.toSquare):e.coords&&r.setPositionByCoords(e.square,e.coords),r.setDraggingState(e.square,!0))}function a(){let e=r.getDraggingSquare();e&&(r.setPositionBySquare(e,e),r.setDraggingState(e,!1))}function o(e,t){if(e){ let _hh$temp949=t,r=_hh$temp949.renderer; r?.blinkHighlights([wk(e,n.checkBlinkingSquareColor)],t)}}function s(e,t){if(r.animations.flush(),e.drop){r.create({color:e.color,square:yr(e),type:e.piece});return}e.EPCapturedSquare?r.remove({animate:e.animate,options:t.options,squares:[e.EPCapturedSquare]}):r.get(e.to,!1)&&!$r(e)&&r.remove({animate:e.animate,options:t.options,squares:[e.to]});let n=[e,e.rookMove].filter(Boolean);r.move(n,t.options),r.animations.run()}function c(e,t){let n=e.pieces;r.animations.flush();let i=n.keys(),a=r.get().keys().filter(e=>!i.includes(e));r.remove({options:t.options,squares:a}),n.keys().forEach(e=>{let t=n.get(e),i=r.get(e,!1);if(!i){r.create(t);return} let _hh$temp950=i.getDetails(),a=_hh$temp950.type,o=_hh$temp950.color; (a!==t.type||o!==t.color)&&i.setDetails(t.color,t.type)}),r.animations.run()}function l(e,t){r.remove({options:t.options,squares:[e]})}function u(e,t){if(r.animations.flush(),e.drop){l(e.to,t);return} let _hh$temp951=pv(e),n=_hh$temp951.movedPieces,i=_hh$temp951.restoredPiece,a=_hh$temp951.promotedSquare; if(r.move(n,t.options),i&&r.create(i),a){ let e=r.get(a),_hh$temp952=e.getDetails(),t=_hh$temp952.color; e.setDetails(t,J.Piece.Types.Pawn)}r.animations.run()}}function Mk( _hh$temp953 ){ var e=_hh$temp953.board,t=_hh$temp953.options; let n,r,i={b:void 0,n:void 0,q:void 0,r:void 0};return{closePromotionWindow:u,openPromotionWindow:l};function a(){n=document.createElement(`div`),n.classList.add(`promotion-window`),t.test&&An(n,{[sx.Element]:cx.PromotionWindow}),e.addToDom({el:n,type:ox.PromotionWindow})}function o(e){r=document.createElement(`i`),r.className=`close-button icon-font-chess x`,t.test&&An(r,{[sx.Element]:cx.PromotionCloseButton}),n.appendChild(r),r.addEventListener(mC,t=>{t.stopPropagation(),e(Zt(K.BoardEvents.PromotionAreaClosePointerdown))})}function s(e){Object.keys(i).forEach(r=>{let a=document.createElement(`div`);a.addEventListener(mC,t=>{if(t.stopPropagation(),b_(t)){e(Zt(K.UserEvents.PointerdownRight));return}e(Zt(K.BoardEvents.PromotionPiecePointerdown,{piece:r}))}),a.classList.add(`promotion-piece`), __set$(i,r,a) ,t.test&&An( __get$(i,r) ,{[sx.Element]:cx.PromotionPiece,[sx.Type]:r}),n.appendChild(a)})}function c( _hh$temp954 ){ var e=_hh$temp954.flipped,t=_hh$temp954.promotionMove; let n;return n=e?t.color===J.ColorsAsNumbers.White?`bottom`:`top`:t.color===J.ColorsAsNumbers.White?`top`:`bottom`,{color:t.color,file:(e?`hgfedcba`:`abcdefgh`).indexOf(t.to.slice(0,1))+1,position:n}}function l(e,l){ let _hh$temp955=l,_hh$temp955$options=_hh$temp955.options,u=_hh$temp955$options.flipped,h=_hh$temp955.run,_hh$temp956=c({flipped:u,promotionMove:e}),g=_hh$temp956.color,_=_hh$temp956.file,v=_hh$temp956.position; n||a(),r||o(h),i.q||s(h),f(v),p(_),d(g),t.test&&An(n,{[sx.Color]:Hp(g),[sx.File]:_.toString(),[sx.Position]:v}),m()}function u(){if(!n)throw new LC({code:RC.ElementNotFound,message:`Promotion window does not exist.`});n.style.display=`none`}function d(e){Object.keys(i).forEach(n=>{ __get$(i,n) .className=`promotion-piece ${Hp(e)}${n}`,t.test&&An( __get$(i,n) ,{[sx.Color]:Hp(e)})})}function f(e){e===`top`?n.classList.add(`top`):n.classList.remove(`top`)}function p(e){n.style.transform=`translateX(${(e-1)*100}%`}function m(){n.style.display=``}}function Nk( _hh$temp957 ){ var e=_hh$temp957.board,t=_hh$temp957.options; let n=nk({insertBefore:e.placeholders.squares,startingCount:3}),r=En(),i=t.test;return{addHighlights:a,blinkHighlights:s,removeHighlights:c};function a(e){e.forEach(e=>{ let _hh$temp958=e.data,t=_hh$temp958.square; if(r.isDefined(t)||!e)return;let n=l(t,e);r.set(t,n)})}function o( _hh$temp959 ){ var e=_hh$temp959.el,t=_hh$temp959.interval,n=_hh$temp959.opacity,r=_hh$temp959.times; let i=0,a=!0,o=setInterval(()=>{if(i+=1,i===r*2){if(clearInterval(o),e){let t=e.parentNode;t&&t.removeChild(e)}return}a?(e.style.opacity=`0`,a=!1):(e.style.opacity=n.toString(),a=!0)},t/2)}function s(t){t.forEach(t=>{ let _hh$temp960=t.data,n=_hh$temp960.color,r=_hh$temp960.interval,a=_hh$temp960.opacity,s=_hh$temp960.square,c=_hh$temp960.times,u=l(s,t); e.addToDom({el:u,type:ox.BlinkingHighlights}),i&&An(u,{[sx.Element]:cx.BlinkingHighlight,[sx.Square]:s,[sx.Color]:n,[sx.Interval]:r,[sx.Opacity]:a,[sx.Times]:c,[sx.Type]:sx.Blinking}),o({el:u,interval:r,opacity:a,times:c})})}function c(e){e.forEach(u)}function l(e,t){let r=n.get();return An(r,{[sx.Element]:cx.Highlight}),r.classList.add(`highlight`),d(r,t),kn({el:r,square:e}),r}function u(e){ let _hh$temp961=e.data,t=_hh$temp961.square; if(!r.isDefined(t))return;let i=r.get(t);n.put(i),r.deleteItem(t)}function d(e,t){if(!e)throw new LC({code:RC.ElementNotFound,data:{highlight:t},message:`Highlight does not exist.`}); let _hh$temp962=t,_hh$temp962$data=_hh$temp962.data,n=_hh$temp962$data.color,r=_hh$temp962$data.opacity,i=n||``,a=String(r); e.style.backgroundColor!==i&&(e.style.backgroundColor=i),e.style.opacity!==a&&(e.style.opacity=a)}}function Pk(e){let t=Math.max(e.x,-50);t=Math.min(t,750);let n=Math.max(e.y,-50);return n=Math.min(n,750),{x:t,y:n}}function Fk(e,t){let n=Math.max(e,1);n=Math.min(n,8);let r=Math.max(t,1);return r=Math.min(r,8),fv({file:n,rank:r})}function Ik( _hh$temp963 ){ var e=_hh$temp963.el,t=_hh$temp963.event,n=_hh$temp963.flipped;  let r=e.getBoundingClientRect(),_hh$temp964=pf(t),i=_hh$temp964.x,a=_hh$temp964.y,o=r.width/8,s={x:Math.round((i-r.left)%o),y:Math.round((a-r.top)%o)},c=Math.ceil((i-r.left)/o),l=Math.ceil((r.bottom-a)/o),u=n?9-c:c,d=n?9-l:l,f=fv({file:u,rank:d}),p={x:(i-r.left-o/2)/r.width*800,y:(a-r.top-o/2)/r.height*800}; return{coords:p,coordsInsideBoard:Pk(p),coordsInsideSquare:s,square:f,squareInsideBoard:Fk(u,d)}}function Lk(e){let t={};return e.forEach(e=>{let n=e.className.split(` `),r=n.find(e=>e.startsWith(`square-`)),i=n.find(e=>e.startsWith(`w`)||e.startsWith(`b`));if(!r||!i)return; let _hh$temp965=__arrayFrom$(i),a=_hh$temp965[0],o=_hh$temp965[1],s=fv({file:parseInt(__get$(r,r.length-2),10),rank:parseInt(__get$(r,r.length-1),10)}); s&&( __set$(t,s,{color:R_(a),type:o}) )}),t}function Rk( _hh$temp966 ){ var e=_hh$temp966.el,_hh$temp966$emitter=_hh$temp966.emitter,t=_hh$temp966$emitter===void 0?s():_hh$temp966$emitter,_hh$temp966$options=_hh$temp966.options,n=_hh$temp966$options===void 0?Bt():_hh$temp966$options,_hh$temp966$boardStyles=_hh$temp966.boardStyles,r=_hh$temp966$boardStyles===void 0?Xb:_hh$temp966$boardStyles,_hh$temp966$pieceStyles=_hh$temp966.pieceStyles,i=_hh$temp966$pieceStyles===void 0?Zb:_hh$temp966$pieceStyles,a=_hh$temp966.testElement; let o=gk({el:e,options:n,testElement:a}),c={board:o,el:e,emitter:t,options:n},l=hk({...c,boardStyles:r,pieceStyles:i,options:Ht(n)}),u=jk(c);o.isFlipped()&&o.flipBoard(!0),l.togglePseudo3d(n);let d={...sk(c),...pk(c),...l,...bk(c),...xk(c),...Sk(c),...Ck(c),...Nk(c),...Mk(c),...u,animationComplete:o.animationComplete,areAssetsLoaded:()=>!0,createRenderer:Rk,destroy:f,...t,extendRenderer:p,flipBoard:o.flipBoard,setBoardEnabled:o.setBoardEnabled,getCoordsFromSquare:tk,getPieces:m,getPointerPosition:Ik,getRendererOptions:()=>({boardStyles:r,el:e,options:n,pieceStyles:i,emitter:t}),getBoardContainerAspectRatio:()=>1,isAnimating:o.isAnimating,name:nx.Types.Default,resize:h};return d;function f(){l.destroy(),u.destroy(),o.reset()}function p(e){ __call$(Object,"assign",[d,e(c)]) }function m(){return Lk(Array.from(e.querySelectorAll(`.piece`)))}function h(){}}var zk,Bk,Vk,Hk,Uk,Wk,Gk,Kk,qk,Jk,Yk,Xk,Zk=e((()=>{ZO(),ok(),bt(),zk={a1:{x:6.25,y:93.75},a2:{x:6.25,y:81.25},a3:{x:6.25,y:68.75},a4:{x:6.25,y:56.25},a5:{x:6.25,y:43.75},a6:{x:6.25,y:31.25},a7:{x:6.25,y:18.75},a8:{x:6.25,y:6.25},b1:{x:18.75,y:93.75},b2:{x:18.75,y:81.25},b3:{x:18.75,y:68.75},b4:{x:18.75,y:56.25},b5:{x:18.75,y:43.75},b6:{x:18.75,y:31.25},b7:{x:18.75,y:18.75},b8:{x:18.75,y:6.25},c1:{x:31.25,y:93.75},c2:{x:31.25,y:81.25},c3:{x:31.25,y:68.75},c4:{x:31.25,y:56.25},c5:{x:31.25,y:43.75},c6:{x:31.25,y:31.25},c7:{x:31.25,y:18.75},c8:{x:31.25,y:6.25},d1:{x:43.75,y:93.75},d2:{x:43.75,y:81.25},d3:{x:43.75,y:68.75},d4:{x:43.75,y:56.25},d5:{x:43.75,y:43.75},d6:{x:43.75,y:31.25},d7:{x:43.75,y:18.75},d8:{x:43.75,y:6.25},e1:{x:56.25,y:93.75},e2:{x:56.25,y:81.25},e3:{x:56.25,y:68.75},e4:{x:56.25,y:56.25},e5:{x:56.25,y:43.75},e6:{x:56.25,y:31.25},e7:{x:56.25,y:18.75},e8:{x:56.25,y:6.25},f1:{x:68.75,y:93.75},f2:{x:68.75,y:81.25},f3:{x:68.75,y:68.75},f4:{x:68.75,y:56.25},f5:{x:68.75,y:43.75},f6:{x:68.75,y:31.25},f7:{x:68.75,y:18.75},f8:{x:68.75,y:6.25},g1:{x:81.25,y:93.75},g2:{x:81.25,y:81.25},g3:{x:81.25,y:68.75},g4:{x:81.25,y:56.25},g5:{x:81.25,y:43.75},g6:{x:81.25,y:31.25},g7:{x:81.25,y:18.75},g8:{x:81.25,y:6.25},h1:{x:93.75,y:93.75},h2:{x:93.75,y:81.25},h3:{x:93.75,y:68.75},h4:{x:93.75,y:56.25},h5:{x:93.75,y:43.75},h6:{x:93.75,y:31.25},h7:{x:93.75,y:18.75},h8:{x:93.75,y:6.25}},Bk=Zw.WIDTH/2,Vk=Zw.HEAD_HEIGHT,Hk=Zw.TAIL_PADDING,Uk=Zw.HEAD_WIDTH/2,Wk=Zw.WIDTH/2,Gk=Zw.HEAD_HEIGHT,Kk=Zw.TAIL_PADDING,qk=Zw.HEAD_WIDTH/2,Jk=300,Yk=`transition: background-image ${Jk}ms linear;`,Xk=16}));function Qk(e){if(e==null)throw TypeError(`Object.assign cannot be called with null or undefined`);return Object(e)}function $k(){try{if(!Object.assign)return!1;var e=new String(`abc`);if(e[5]=`de`,Object.getOwnPropertyNames(e)[0]===`5`)return!1;for(var t={},n=0;n<10;n++) __set$(t,`_`+String.fromCharCode(n),n) ;if(Object.getOwnPropertyNames(t).map(function(e){return  __get$(t,e) }).join(``)!==`0123456789`)return!1;var r={};return`abcdefghijklmnopqrst`.split(``).forEach(function(e){ __set$(r,e,e) }),Object.keys( __call$(Object,"assign",[{},r]) ).join(``)===`abcdefghijklmnopqrst`}catch{return!1}}function eA(e,t){if(e){t||={};for(var n={key:[`source`,`protocol`,`authority`,`userInfo`,`user`,`password`,`host`,`port`,`relative`,`path`,`directory`,`file`,`query`,`anchor`],q:{name:`queryKey`,parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r= __get$(n.parser,t.strictMode?`strict`:`loose`) .exec(e),i={},a=14;a--;) __set$(i,__get$(n.key,a),__get$(r,a)||``) ;return  __set$(i,n.q.name,{}) , __call$(__get$(i,n.key[12]),"replace",[n.q.parser,function(e,t,r){t&&__set$(__get$(i,n.q.name),t,r);}]) ,i}}function tA(e,t){return e._head?(e._tail._next=t,t._prev=e._tail,e._tail=t):(e._head=t,e._tail=t),t._owner=e,t}function nA(){}function rA(e,t,n,r){var i=0,a=e.length;(function o(s){if(s||i===a){n&&n(s);return}r?setTimeout(function(){t( __get$(e,i++) ,o)},1):t( __get$(e,i++) ,o)})()}function iA(e){return function(){if(e===null)throw Error(`Callback was already called.`);var t=e;e=null,t.apply(this,arguments)}}function aA(e,t){if(t==null)t=1;else if(t===0)throw Error(`Concurrency must not be zero`);var n=0,r={_tasks:[],concurrency:t,saturated:nA,unsaturated:nA,buffer:t/4,empty:nA,drain:nA,error:nA,started:!1,paused:!1,push:function(e,t){i(e,!1,t)},kill:function(){n=0,r.drain=nA,r.started=!1,r._tasks=[]},unshift:function(e,t){i(e,!0,t)},process:function(){for(;!r.paused&&n<r.concurrency&&r._tasks.length;){var t=r._tasks.shift();r._tasks.length===0&&r.empty(),n+=1,n===r.concurrency&&r.saturated(),e(t.data,iA(a(t)))}},length:function(){return r._tasks.length},running:function(){return n},idle:function(){return r._tasks.length+n===0},pause:function(){r.paused!==!0&&(r.paused=!0)},resume:function(){if(r.paused!==!1){r.paused=!1;for(var e=1;e<=r.concurrency;e++)r.process()}}};function i(e,t,n){if(n!=null&&typeof n!=`function`)throw Error(`task callback must be a function`);if(r.started=!0,e==null&&r.idle()){setTimeout(function(){return r.drain()},1);return}var i={data:e,callback:typeof n==`function`?n:nA};t?r._tasks.unshift(i):r._tasks.push(i),setTimeout(function(){return r.process()},1)}function a(e){return function(){--n,e.callback.apply(e,arguments),arguments[0]!=null&&r.error(arguments[0],e.data),n<=r.concurrency-r.buffer&&r.unsaturated(),r.idle()&&r.drain(),r.process()}}return r}function oA(e,t){var n=this; __get$(yj,e.url) ?(e.data= __get$(yj,e.url) ,e.complete()):e.onComplete.once(function(){return  __set$(yj,n.url,n.data) }),t()}function sA(e,t){for(var n=0;n<t.length;n++){var r= __get$(t,n) ;r.enumerable=r.enumerable||!1,r.configurable=!0,`value`in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cA(e,t,n){return t&&sA(e.prototype,t),n&&sA(e,n),e}function lA(){}function uA(e,t,n){t&&t.indexOf(`.`)===0&&(t=t.substring(1)),t&&( __set$(e,t,n) )}function dA(e){return  __call$(e.toString(),"replace",[`object `,``]) }function fA(e){for(var t=``,n=0;n<e.length;){for(var r=[0,0,0],i=[0,0,0,0],a=0;a<r.length;++a)n<e.length? __set$(r,a,e.charCodeAt(n++)&255) : __set$(r,a,0) ;switch(i[0]=r[0]>>2,i[1]=(r[0]&3)<<4|r[1]>>4,i[2]=(r[1]&15)<<2|r[2]>>6,i[3]=r[2]&63,n-(e.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64;break}for(var o=0;o<i.length;++o)t+=Oj.charAt( __get$(i,o) )}return t}function pA(e,t){if(!e.data){t();return}if(e.xhr&&e.xhrType===Dj.XHR_RESPONSE_TYPE.BLOB){if(!window.Blob||typeof e.data==`string`){var n=e.xhr.getResponseHeader(`content-type`);if(n&&n.indexOf(`image`)===0){e.data=new Image,e.data.src=`data:`+n+`;base64,`+fA(e.xhr.responseText),e.type=Dj.TYPE.IMAGE,e.data.onload=function(){e.data.onload=null,t()};return}}else if(e.data.type.indexOf(`image`)===0){var r=kj.createObjectURL(e.data);e.blob=e.data,e.data=new Image,e.data.src=r,e.type=Dj.TYPE.IMAGE,e.data.onload=function(){kj.revokeObjectURL(r),e.data.onload=null,t()};return}}t()}function mA(e,t,n){return e+(t-e)*n}function hA(e,t,n,r,i,a,o){o===void 0&&(o=[]);for(var s=20,c=o,l=0,u=0,d=0,f=0,p=0,m=0,h=0,g=0;h<=s;++h)g=h/s,l=mA(e,n,g),u=mA(t,r,g),d=mA(n,i,g),f=mA(r,a,g),p=mA(l,d,g),m=mA(u,f,g),c.push(p,m);return c}function gA(e,t){e.lineStyle.native?vA(e,t):_A(e,t)}function _A(e,t){var n=e.shape,r=e.points||n.points.slice(),i=t.closePointEps;if(r.length!==0){var a=e.lineStyle,o=new hE(r[0],r[1]),s= new hE(__get$(r,r.length-2),__get$(r,r.length-1)) ,c=n.type!==bE.POLY||n.closeStroke,l=Math.abs(o.x-s.x)<i&&Math.abs(o.y-s.y)<i;if(c){r=r.slice(),l&&(r.pop(),r.pop(),s.set( __get$(r,r.length-2) , __get$(r,r.length-1) ));var u=s.x+(o.x-s.x)*.5,d=s.y+(o.y-s.y)*.5;r.unshift(u,d),r.push(u,d)}var f=t.points,p=r.length/2,m=r.length,h=f.length/2,g=a.width/2,_=r[0],v=r[1],y=r[2],b=r[3],x=0,S=0,C=-(v-b),w=_-y,T=0,E=0,D=0,O=0,k=Math.sqrt(C*C+w*w);C/=k,w/=k,C*=g,w*=g;var ee=a.alignment,A=(1-ee)*2,j=ee*2;f.push(_-C*A,v-w*A),f.push(_+C*j,v+w*j);for(var M=1;M<p-1;++M){_= __get$(r,(M-1)*2) ,v= __get$(r,(M-1)*2+1) ,y= __get$(r,M*2) ,b= __get$(r,M*2+1) ,x= __get$(r,(M+1)*2) ,S= __get$(r,(M+1)*2+1) ,C=-(v-b),w=_-y,k=Math.sqrt(C*C+w*w),C/=k,w/=k,C*=g,w*=g,T=-(b-S),E=y-x,k=Math.sqrt(T*T+E*E),T/=k,E/=k,T*=g,E*=g;var N=-w+v-(-w+b),P=-C+y-(-C+_),te=(-C+_)*(-w+b)-(-C+y)*(-w+v),F=-E+S-(-E+b),ne=-T+y-(-T+x),I=(-T+x)*(-E+b)-(-T+y)*(-E+S),re=N*ne-F*P;if(Math.abs(re)<.1){re+=10.1,f.push(y-C*A,b-w*A),f.push(y+C*j,b+w*j);continue}var ie=(P*I-ne*te)/re,L=(F*te-N*I)/re;(ie-y)*(ie-y)+(L-b)*(L-b)>196*g*g?(D=C-T,O=w-E,k=Math.sqrt(D*D+O*O),D/=k,O/=k,D*=g,O*=g,f.push(y-D*A,b-O*A),f.push(y+D*j,b+O*j),f.push(y-D*j*A,b-O*A),m++):(f.push(y+(ie-y)*A,b+(L-b)*A),f.push(y-(ie-y)*j,b-(L-b)*j))}_= __get$(r,(p-2)*2) ,v= __get$(r,(p-2)*2+1) ,y= __get$(r,(p-1)*2) ,b= __get$(r,(p-1)*2+1) ,C=-(v-b),w=_-y,k=Math.sqrt(C*C+w*w),C/=k,w/=k,C*=g,w*=g,f.push(y-C*A,b-w*A),f.push(y+C*j,b+w*j);for(var R=t.indices,ae=0;ae<m-2;++ae)R.push(h,h+1,h+2),h++}}function vA(e,t){var n=0,r=e.shape,i=e.points||r.points,a=r.type!==bE.POLY||r.closeStroke;if(i.length!==0){var o=t.points,s=t.indices,c=i.length/2,l=o.length/2,u=l;for(o.push(i[0],i[1]),n=1;n<c;n++)o.push( __get$(i,n*2) , __get$(i,n*2+1) ),s.push(u,u+1),u++;a&&s.push(u,l)}}function yA(e){return typeof e==`number`?uy(e):(typeof e==`string`&&e.indexOf(`0x`)===0&&(e= __call$(e,"replace",[`0x`,`#`]) ),e)}function bA(e){if(Array.isArray(e)){for(var t=0;t<e.length;++t) __set$(e,t,yA(__get$(e,t))) ;return e}else return yA(e)}function xA(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if( __get$(e,n) !== __get$(t,n) )return!1;return!0}function SA(e,t,n){for(var r in n)Array.isArray( __get$(t,r) )? __set$(e,r,__get$(t,r).slice()) : __set$(e,r,__get$(t,r)) }function CA(e,t){var n=!1;if(e&&e._textures&&e._textures.length){for(var r=0;r<e._textures.length;r++)if( __get$(e._textures,r) instanceof dD){var i= __get$(e._textures,r) .baseTexture;t.indexOf(i)===-1&&(t.push(i),n=!0)}}return n}function wA(e,t){if(e.baseTexture instanceof ZE){var n=e.baseTexture;return t.indexOf(n)===-1&&t.push(n),!0}return!1}function TA(e,t){if(e._texture&&e._texture instanceof dD){var n=e._texture.baseTexture;return t.indexOf(n)===-1&&t.push(n),!0}return!1}function EA(e,t){return t instanceof xM?(t.updateText(!0),!0):!1}function DA(e,t){if(t instanceof gM){var n=t.toFontString();return vM.measureFont(n),!0}return!1}function OA(e,t){if(e instanceof xM){t.indexOf(e.style)===-1&&t.push(e.style),t.indexOf(e)===-1&&t.push(e);var n=e._texture.baseTexture;return t.indexOf(n)===-1&&t.push(n),!0}return!1}function kA(e,t){return e instanceof gM?(t.indexOf(e)===-1&&t.push(e),!0):!1}function AA(e,t){return t instanceof ZE?( __get$(t._glTextures,e.CONTEXT_UID) ||e.texture.bind(t),!0):!1}function jA(e,t){if(!(t instanceof lM))return!1;var n=t.geometry;t.finishPoly(),n.updateBatches();for(var r=n.batches,i=0;i<r.length;i++){var a= __get$(r,i) .style.texture;a&&AA(e,a.baseTexture)}return n.batchable||e.geometry.bind(n,t._resolveDirectShader()),!0}function MA(e,t){return e instanceof lM?(t.push(e),!0):!1}var NA,PA,FA,IA,LA,RA,zA,BA,VA,HA,UA,WA,GA,KA,qA,JA,YA,XA,ZA,QA,$A,ej,tj,nj,rj,ij,aj,oj,sj,cj,lj,uj,dj,fj,pj,mj,hj,gj,_j,vj,yj,bj,xj,Sj,Cj,wj,Tj,Ej,Dj,Oj,kj,Aj,jj,Mj,Nj,Pj,Fj,Ij,Lj,Rj,zj,Bj,Vj,Hj,Uj,Wj,Gj,Kj,qj,Jj,Yj,Xj,Zj,Qj,$j,eM,tM,nM,rM,iM,aM,oM,sM,cM,lM,uM,dM,fM,pM,mM,hM,gM,_M,vM,yM,bM,xM,SM,CM,wM,TM,EM,DM,OM,kM,AM,jM,MM,NM,PM,FM,IM,LM,RM,zM,BM,VM,HM,UM,WM,GM,KM=e((()=>{for(ZO(),bt(),NA={},(function(e){(function(t){var n=t.Promise,r=n&&`resolve`in n&&`reject`in n&&`all`in n&&`race`in n&&function(){var e;return new n(function(t){e=t}),typeof e==`function`}();e?(e.Promise=r?n:w,e.Polyfill=w):r||(t.Promise=w);var i=`pending`,a=`sealed`,o=`fulfilled`,s=`rejected`,c=function(){};function l(e){return Object.prototype.toString.call(e)===`[object Array]`}var u=typeof setImmediate<`u`?setImmediate:setTimeout,d=[],f;function p(){for(var e=0;e<d.length;e++) __get$(d,e) [0]( __get$(d,e) [1]);d=[],f=!1}function m(e,t){d.push([e,t]),f||(f=!0,u(p,0))}function h(e,t){function n(e){v(t,e)}function r(e){b(t,e)}try{e(n,r)}catch(e){r(e)}}function g(e){var t=e.owner,n=t.state_,r=t.data_,i= __get$(e,n) ,a=e.then;if(typeof i==`function`){n=o;try{r=i(r)}catch(e){b(a,e)}}_(a,r)||(n===o&&v(a,r),n===s&&b(a,r))}function _(e,t){var n;try{if(e===t)throw TypeError(`A promises callback cannot return that same promise.`);if(t&&(typeof t==`function`||typeof t==`object`)){var r=t.then;if(typeof r==`function`)return r.call(t,function(r){n||(n=!0,t===r?y(e,r):v(e,r))},function(t){n||(n=!0,b(e,t))}),!0}}catch(t){return n||b(e,t),!0}return!1}function v(e,t){(e===t||!_(e,t))&&y(e,t)}function y(e,t){e.state_===i&&(e.state_=a,e.data_=t,m(S,e))}function b(e,t){e.state_===i&&(e.state_=a,e.data_=t,m(C,e))}function x(e){var t=e.then_;e.then_=void 0;for(var n=0;n<t.length;n++)g( __get$(t,n) )}function S(e){e.state_=o,x(e)}function C(e){e.state_=s,x(e)}function w(e){if(typeof e!=`function`)throw TypeError(`Promise constructor takes a function argument`);if(!(this instanceof w))throw TypeError(`Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.`);this.then_=[],h(e,this)}w.prototype={constructor:w,state_:i,then_:null,data_:void 0,then:function(e,t){var n={owner:this,then:new this.constructor(c),fulfilled:e,rejected:t};return this.state_===o||this.state_===s?m(g,n):this.then_.push(n),n.then},catch:function(e){return this.then(null,e)}},w.all=function(e){var t=this;if(!l(e))throw TypeError(`You must pass an array to Promise.all().`);return  new t(function(t,n){var r=[],i=0;function a(e){return i++,function(n){__set$(r,e,n),--i||t(r);};}for(var o=0,s;o<e.length;o++)s=__get$(e,o),s&&typeof s.then==`function`?s.then(a(o),n):__set$(r,o,s);i||t(r);}) },w.race=function(e){var t=this;if(!l(e))throw TypeError(`You must pass an array to Promise.race().`);return  new t(function(t,n){for(var r=0,i;r<e.length;r++)i=__get$(e,r),i&&typeof i.then==`function`?i.then(t,n):t(i);}) },w.resolve=function(e){var t=this;return e&&typeof e==`object`&&e.constructor===t?e:new t(function(t){t(e)})},w.reject=function(e){return new this(function(t,n){n(e)})}})(typeof window<`u`?window:H===void 0&&typeof self<`u`?self:H)})(NA),PA=Object.getOwnPropertySymbols,FA=Object.prototype.hasOwnProperty,IA=Object.prototype.propertyIsEnumerable,LA=$k()?Object.assign:function(e,t){for(var n,r=Qk(e),i,a=1;a<arguments.length;a++){for(var o in n=Object( __get$(arguments,a) ),n)FA.call(n,o)&&( __set$(r,o,__get$(n,o)) );if(PA){i=PA(n);for(var s=0;s<i.length;s++)IA.call(n, __get$(i,s) )&&( __set$(r,__get$(i,s),__get$(n,__get$(i,s))) )}}return r},window.Promise||(window.Promise=NA.Polyfill),Object.assign||(Object.assign=LA),RA=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},zA=16,Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),RA.performance&&RA.performance.now||(BA=Date.now(),RA.performance||={},RA.performance.now=function(){return Date.now()-BA}),VA=Date.now(),HA=[`ms`,`moz`,`webkit`,`o`],UA=0;UA<HA.length&&!RA.requestAnimationFrame;++UA)WA= __get$(HA,UA) ,RA.requestAnimationFrame= __get$(RA,WA+`RequestAnimationFrame`) ,RA.cancelAnimationFrame= __get$(RA,WA+`CancelAnimationFrame`) || __get$(RA,WA+`CancelRequestAnimationFrame`) ;RA.requestAnimationFrame||=function(e){if(typeof e!=`function`)throw TypeError(e+`is not a function`);var t=Date.now(),n=zA+VA-t;return n<0&&(n=0),VA=t,setTimeout(function(){VA=Date.now(),e(performance.now())},n)},RA.cancelAnimationFrame||=function(e){return clearTimeout(e)},Math.sign||(Math.sign=function(e){return e=Number(e),e===0||isNaN(e)?e:e>0?1:-1}),Number.isInteger||(Number.isInteger=function(e){return typeof e==`number`&&isFinite(e)&&Math.floor(e)===e}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array),LE.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1,accessibleType:`button`,accessiblePointerEvents:`auto`,accessibleChildren:!0}),GA=9,KA=100,qA=0,JA=0,YA=2,XA=1,ZA=-1e3,QA=-1e3,$A=2,ej=function(e){this._hookDiv=null,(mT.tablet||mT.phone)&&this.createTouchHook();var t=document.createElement(`div`);t.style.width=KA+`px`,t.style.height=KA+`px`,t.style.position=`absolute`,t.style.top=qA+`px`,t.style.left=JA+`px`,t.style.zIndex=YA,this.div=t,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessibility=!1,window.addEventListener(`keydown`,this._onKeyDown,!1)},ej.prototype.createTouchHook=function(){var e=this,t=document.createElement(`button`);t.style.width=XA+`px`,t.style.height=XA+`px`,t.style.position=`absolute`,t.style.top=ZA+`px`,t.style.left=QA+`px`,t.style.zIndex=$A,t.style.backgroundColor=`#FF0000`,t.title=`HOOK DIV`,t.addEventListener(`focus`,function(){e.isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t},ej.prototype.destroyTouchHook=function(){this._hookDiv&&=(document.body.removeChild(this._hookDiv),null)},ej.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener(`mousemove`,this._onMouseMove,!0),window.removeEventListener(`keydown`,this._onKeyDown,!1),this.renderer.on(`postrender`,this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},ej.prototype.deactivate=function(){!this.isActive||this.isMobileAccessibility||(this.isActive=!1,window.document.removeEventListener(`mousemove`,this._onMouseMove,!0),window.addEventListener(`keydown`,this._onKeyDown,!1),this.renderer.off(`postrender`,this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},ej.prototype.updateAccessibleObjects=function(e){if(!(!e.visible||!e.accessibleChildren)){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);for(var t=e.children,n=0;n<t.length;n++)this.updateAccessibleObjects( __get$(t,n) )}},ej.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),t=e.width/this.renderer.width,n=e.height/this.renderer.height,r=this.div;r.style.left=e.left+`px`,r.style.top=e.top+`px`,r.style.width=this.renderer.width+`px`,r.style.height=this.renderer.height+`px`;for(var i=0;i<this.children.length;i++){var a= __get$(this.children,i) ;if(a.renderId!==this.renderId)a._accessibleActive=!1,Sy(this.children,i,1),this.div.removeChild(a._accessibleDiv),this.pool.push(a._accessibleDiv),a._accessibleDiv=null,i--,this.children.length===0&&this.deactivate();else{r=a._accessibleDiv;var o=a.hitArea,s=a.worldTransform;a.hitArea?(r.style.left=(s.tx+o.x*s.a)*t+`px`,r.style.top=(s.ty+o.y*s.d)*n+`px`,r.style.width=o.width*s.a*t+`px`,r.style.height=o.height*s.d*n+`px`):(o=a.getBounds(),this.capHitArea(o),r.style.left=o.x*t+`px`,r.style.top=o.y*n+`px`,r.style.width=o.width*t+`px`,r.style.height=o.height*n+`px`,r.title!==a.accessibleTitle&&a.accessibleTitle!==null&&(r.title=a.accessibleTitle),r.getAttribute(`aria-label`)!==a.accessibleHint&&a.accessibleHint!==null&&r.setAttribute(`aria-label`,a.accessibleHint)),(a.accessibleTitle!==r.title||a.tabIndex!==r.tabIndex)&&(r.title=a.accessibleTitle,r.tabIndex=a.tabIndex,this.debug&&this.updateDebugHTML(r))}}this.renderId++}},ej.prototype.updateDebugHTML=function(e){e.innerHTML=`type: `+e.type+`</br> title : `+e.title+`</br> tabIndex: `+e.tabIndex},ej.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0),e.x+e.width>this.renderer.width&&(e.width=this.renderer.width-e.x),e.y+e.height>this.renderer.height&&(e.height=this.renderer.height-e.y)},ej.prototype.addChild=function(e){var t=this.pool.pop();t||(t=document.createElement(`button`),t.style.width=KA+`px`,t.style.height=KA+`px`,t.style.backgroundColor=this.debug?`rgba(255,255,255,0.5)`:`transparent`,t.style.position=`absolute`,t.style.zIndex=YA,t.style.borderStyle=`none`,navigator.userAgent.toLowerCase().indexOf(`chrome`)>-1?t.setAttribute(`aria-live`,`off`):t.setAttribute(`aria-live`,`polite`),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute(`aria-relevant`,`additions`):t.setAttribute(`aria-relevant`,`text`),t.addEventListener(`click`,this._onClick.bind(this)),t.addEventListener(`focus`,this._onFocus.bind(this)),t.addEventListener(`focusout`,this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`displayObject `+e.tabIndex),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute(`aria-label`,e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},ej.prototype._onClick=function(e){var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,`click`,t.eventData),t.dispatchEvent(e.target.displayObject,`pointertap`,t.eventData),t.dispatchEvent(e.target.displayObject,`tap`,t.eventData)},ej.prototype._onFocus=function(e){e.target.getAttribute(`aria-live`,`off`)||e.target.setAttribute(`aria-live`,`assertive`);var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,`mouseover`,t.eventData)},ej.prototype._onFocusOut=function(e){e.target.getAttribute(`aria-live`,`off`)||e.target.setAttribute(`aria-live`,`polite`);var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,`mouseout`,t.eventData)},ej.prototype._onKeyDown=function(e){e.keyCode===GA&&this.activate()},ej.prototype._onMouseMove=function(e){e.movementX===0&&e.movementY===0||this.deactivate()},ej.prototype.destroy=function(){this.destroyTouchHook(),this.div=null;for(var e=0;e<this.children.length;e++) __get$(this.children,e) .div=null;window.document.removeEventListener(`mousemove`,this._onMouseMove,!0),window.removeEventListener(`keydown`,this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},tj=function(){this.global=new hE,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0},nj={pointerId:{configurable:!0}},nj.pointerId.get=function(){return this.identifier},tj.prototype.getLocalPosition=function(e,t,n){return e.worldTransform.applyInverse(n||this.global,t)},tj.prototype.copyEvent=function(e){e.isPrimary&&(this.isPrimary=!0),this.button=e.button,this.buttons=Number.isInteger(e.buttons)?e.buttons:e.which,this.width=e.width,this.height=e.height,this.tiltX=e.tiltX,this.tiltY=e.tiltY,this.pointerType=e.pointerType,this.pressure=e.pressure,this.rotationAngle=e.rotationAngle,this.twist=e.twist||0,this.tangentialPressure=e.tangentialPressure||0},tj.prototype.reset=function(){this.isPrimary=!1},Object.defineProperties(tj.prototype,nj),rj=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null},rj.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},rj.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},ij=function e(t){this._pointerId=t,this._flags=e.FLAGS.NONE},aj={pointerId:{configurable:!0},flags:{configurable:!0},none:{configurable:!0},over:{configurable:!0},rightDown:{configurable:!0},leftDown:{configurable:!0}},ij.prototype._doSet=function(e,t){t?this._flags|=e:this._flags&=~e},aj.pointerId.get=function(){return this._pointerId},aj.flags.get=function(){return this._flags},aj.flags.set=function(e){this._flags=e},aj.none.get=function(){return this._flags===this.constructor.FLAGS.NONE},aj.over.get=function(){return(this._flags&this.constructor.FLAGS.OVER)!==0},aj.over.set=function(e){this._doSet(this.constructor.FLAGS.OVER,e)},aj.rightDown.get=function(){return(this._flags&this.constructor.FLAGS.RIGHT_DOWN)!==0},aj.rightDown.set=function(e){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,e)},aj.leftDown.get=function(){return(this._flags&this.constructor.FLAGS.LEFT_DOWN)!==0},aj.leftDown.set=function(e){this._doSet(this.constructor.FLAGS.LEFT_DOWN,e)},Object.defineProperties(ij.prototype,aj),ij.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),oj=function(){this._tempPoint=new hE},oj.prototype.recursiveFindHit=function(e,t,n,r,i){if(!t||!t.visible)return!1;var a=e.data.global;i=t.interactive||i;var o=!1,s=i,c=!0;if(t.hitArea?(r&&(t.worldTransform.applyInverse(a,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(r=!1,c=!1)),s=!1):t._mask&&r&&(t._mask.containsPoint&&t._mask.containsPoint(a)||(r=!1)),c&&t.interactiveChildren&&t.children)for(var l=t.children,u=l.length-1;u>=0;u--){var d= __get$(l,u) ,f=this.recursiveFindHit(e,d,n,r,s);if(f){if(!d.parent)continue;s=!1,f&&(e.target&&(r=!1),o=!0)}}return i&&(r&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(a)&&(o=!0),t.interactive&&(o&&!e.target&&(e.target=t),n&&n(e,t,!!o))),o},oj.prototype.findHit=function(e,t,n,r){this.recursiveFindHit(e,t,n,r,!1)},LE.mixin({interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor===`pointer`},set buttonMode(e){e?this.cursor=`pointer`:this.cursor===`pointer`&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}),sj=1,cj={target:null,data:{global:null}},lj=function(e){function t(t,n){e.call(this),n||={},this.renderer=t,this.autoPreventDefault=n.autoPreventDefault===void 0?!0:n.autoPreventDefault,this.interactionFrequency=n.interactionFrequency||10,this.mouse=new tj,this.mouse.identifier=sj,this.mouse.global.set(-999999),this.activeInteractionData={}, __set$(this.activeInteractionData,sj,this.mouse) ,this.interactionDataPool=[],this.eventData=new rj,this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.tickerAdded=!1,this.mouseOverRenderer=!1,this.supportsTouchEvents=`ontouchstart`in window,this.supportsPointerEvents=!!window.PointerEvent,this.onPointerUp=this.onPointerUp.bind(this),this.processPointerUp=this.processPointerUp.bind(this),this.onPointerCancel=this.onPointerCancel.bind(this),this.processPointerCancel=this.processPointerCancel.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.processPointerDown=this.processPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.processPointerMove=this.processPointerMove.bind(this),this.onPointerOut=this.onPointerOut.bind(this),this.processPointerOverOut=this.processPointerOverOut.bind(this),this.onPointerOver=this.onPointerOver.bind(this),this.cursorStyles={default:`inherit`,pointer:`pointer`},this.currentCursorMode=null,this.cursor=null,this.resolution=1,this.delayedEvents=[],this.search=new oj,this._useSystemTicker=n.useSystemTicker===void 0?!0:n.useSystemTicker,this.setTargetElement(this.renderer.view,this.renderer.resolution)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={useSystemTicker:{configurable:!0}};return n.useSystemTicker.get=function(){return this._useSystemTicker},n.useSystemTicker.set=function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},t.prototype.hitTest=function(e,t){return cj.target=null,cj.data.global=e,t||=this.renderer._lastObjectRendered,this.processInteractive(cj,t,null,!0),cj.target},t.prototype.setTargetElement=function(e,t){t===void 0&&(t=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=t,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(VE.system.add(this.tickerUpdate,this,zE.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){this.tickerAdded&&=(VE.system.remove(this.tickerUpdate,this),!1)},t.prototype.addEvents=function(){this.eventsAdded||!this.interactionDOMElement||(window.navigator.msPointerEnabled?( __set$(this.interactionDOMElement.style,`-ms-content-zooming`,`none`) , __set$(this.interactionDOMElement.style,`-ms-touch-action`,`none`) ):this.supportsPointerEvents&&( __set$(this.interactionDOMElement.style,`touch-action`,`none`) ),this.supportsPointerEvents?(window.document.addEventListener(`pointermove`,this.onPointerMove,!0),this.interactionDOMElement.addEventListener(`pointerdown`,this.onPointerDown,!0),this.interactionDOMElement.addEventListener(`pointerleave`,this.onPointerOut,!0),this.interactionDOMElement.addEventListener(`pointerover`,this.onPointerOver,!0),window.addEventListener(`pointercancel`,this.onPointerCancel,!0),window.addEventListener(`pointerup`,this.onPointerUp,!0)):(window.document.addEventListener(`mousemove`,this.onPointerMove,!0),this.interactionDOMElement.addEventListener(`mousedown`,this.onPointerDown,!0),this.interactionDOMElement.addEventListener(`mouseout`,this.onPointerOut,!0),this.interactionDOMElement.addEventListener(`mouseover`,this.onPointerOver,!0),window.addEventListener(`mouseup`,this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener(`touchstart`,this.onPointerDown,!0),this.interactionDOMElement.addEventListener(`touchcancel`,this.onPointerCancel,!0),this.interactionDOMElement.addEventListener(`touchend`,this.onPointerUp,!0),this.interactionDOMElement.addEventListener(`touchmove`,this.onPointerMove,!0)),this.eventsAdded=!0)},t.prototype.removeEvents=function(){!this.eventsAdded||!this.interactionDOMElement||(window.navigator.msPointerEnabled?( __set$(this.interactionDOMElement.style,`-ms-content-zooming`,``) , __set$(this.interactionDOMElement.style,`-ms-touch-action`,``) ):this.supportsPointerEvents&&( __set$(this.interactionDOMElement.style,`touch-action`,``) ),this.supportsPointerEvents?(window.document.removeEventListener(`pointermove`,this.onPointerMove,!0),this.interactionDOMElement.removeEventListener(`pointerdown`,this.onPointerDown,!0),this.interactionDOMElement.removeEventListener(`pointerleave`,this.onPointerOut,!0),this.interactionDOMElement.removeEventListener(`pointerover`,this.onPointerOver,!0),window.removeEventListener(`pointercancel`,this.onPointerCancel,!0),window.removeEventListener(`pointerup`,this.onPointerUp,!0)):(window.document.removeEventListener(`mousemove`,this.onPointerMove,!0),this.interactionDOMElement.removeEventListener(`mousedown`,this.onPointerDown,!0),this.interactionDOMElement.removeEventListener(`mouseout`,this.onPointerOut,!0),this.interactionDOMElement.removeEventListener(`mouseover`,this.onPointerOver,!0),window.removeEventListener(`mouseup`,this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener(`touchstart`,this.onPointerDown,!0),this.interactionDOMElement.removeEventListener(`touchcancel`,this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener(`touchend`,this.onPointerUp,!0),this.interactionDOMElement.removeEventListener(`touchmove`,this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement){if(this.didMove){this.didMove=!1;return}for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var t= __get$(this.activeInteractionData,e) ;if(t.originalEvent&&t.pointerType!==`touch`){var n=this.configureInteractionEventForDOMEvent(this.eventData,t.originalEvent,t);this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){if(e||=`default`,this.currentCursorMode!==e){this.currentCursorMode=e;var t= __get$(this.cursorStyles,e) ;if(t)switch(typeof t){case`string`:this.interactionDOMElement.style.cursor=t;break;case`function`:t(e);break;case`object`: __call$(Object,"assign",[this.interactionDOMElement.style,t]) ;break}else typeof e==`string`&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,t,n){(!n.stopPropagationHint||e===n.stopsPropagatingAt)&&(n.currentTarget=e,n.type=t,e.emit(t,n), __get$(e,t) && __call$(e,t,[n]) )},t.prototype.delayDispatchEvent=function(e,t,n){this.delayedEvents.push({displayObject:e,eventString:t,eventData:n})},t.prototype.mapPositionToPoint=function(e,t,n){var r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0},i=1/this.resolution;e.x=(t-r.left)*(this.interactionDOMElement.width/r.width)*i,e.y=(n-r.top)*(this.interactionDOMElement.height/r.height)*i},t.prototype.processInteractive=function(e,t,n,r){var i=this.search.findHit(e,t,n,r),a=this.delayedEvents;if(!a.length)return i;e.stopPropagationHint=!1;var o=a.length;this.delayedEvents=[];for(var s=0;s<o;s++){var c= __get$(a,s) ,l=c.displayObject,u=c.eventString,d=c.eventData;d.stopsPropagatingAt===l&&(d.stopPropagationHint=!0),this.dispatchEvent(l,u,d)}return i},t.prototype.onPointerDown=function(e){if(!(this.supportsTouchEvents&&e.pointerType===`touch`)){var t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!(`cancelable`in e))&&e.preventDefault();for(var n=t.length,r=0;r<n;r++){var i= __get$(t,r) ,a=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,a);if(o.data.originalEvent=e,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit(`pointerdown`,o),i.pointerType===`touch`)this.emit(`touchstart`,o);else if(i.pointerType===`mouse`||i.pointerType===`pen`){var s=i.button===2;this.emit(s?`rightdown`:`mousedown`,this.eventData)}}}},t.prototype.processPointerDown=function(e,t,n){var r=e.data,i=e.data.identifier;if(n){if( __get$(t.trackedPointers,i) ||( __set$(t.trackedPointers,i,new ij(i)) ),this.dispatchEvent(t,`pointerdown`,e),r.pointerType===`touch`)this.dispatchEvent(t,`touchstart`,e);else if(r.pointerType===`mouse`||r.pointerType===`pen`){var a=r.button===2;a? __get$(t.trackedPointers,i) .rightDown=!0: __get$(t.trackedPointers,i) .leftDown=!0,this.dispatchEvent(t,a?`rightdown`:`mousedown`,e)}}},t.prototype.onPointerComplete=function(e,t,n){for(var r=this.normalizeToPointerData(e),i=r.length,a=e.target===this.interactionDOMElement?``:`outside`,o=0;o<i;o++){var s= __get$(r,o) ,c=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,c);if(l.data.originalEvent=e,this.processInteractive(l,this.renderer._lastObjectRendered,n,t||!a),this.emit(t?`pointercancel`:`pointerup`+a,l),s.pointerType===`mouse`||s.pointerType===`pen`){var u=s.button===2;this.emit(u?`rightup`+a:`mouseup`+a,l)}else s.pointerType===`touch`&&(this.emit(t?`touchcancel`:`touchend`+a,l),this.releaseInteractionDataForPointerId(s.pointerId,c))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType===`touch`||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,t){var n=e.data,r=e.data.identifier; __get$(t.trackedPointers,r) !==void 0&&(delete t.trackedPointers[r],this.dispatchEvent(t,`pointercancel`,e),n.pointerType===`touch`&&this.dispatchEvent(t,`touchcancel`,e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType===`touch`||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,t,n){var r=e.data,i=e.data.identifier,a= __get$(t.trackedPointers,i) ,o=r.pointerType===`touch`,s=r.pointerType===`mouse`||r.pointerType===`pen`,c=!1;if(s){var l=r.button===2,u=ij.FLAGS,d=l?u.RIGHT_DOWN:u.LEFT_DOWN,f=a!==void 0&&a.flags&d;n?(this.dispatchEvent(t,l?`rightup`:`mouseup`,e),f&&(this.dispatchEvent(t,l?`rightclick`:`click`,e),c=!0)):f&&this.dispatchEvent(t,l?`rightupoutside`:`mouseupoutside`,e),a&&(l?a.rightDown=!1:a.leftDown=!1)}n?(this.dispatchEvent(t,`pointerup`,e),o&&this.dispatchEvent(t,`touchend`,e),a&&((!s||c)&&this.dispatchEvent(t,`pointertap`,e),o&&(this.dispatchEvent(t,`tap`,e),a.over=!1))):a&&(this.dispatchEvent(t,`pointerupoutside`,e),o&&this.dispatchEvent(t,`touchendoutside`,e)),a&&a.none&&delete t.trackedPointers[i]},t.prototype.onPointerMove=function(e){if(!(this.supportsTouchEvents&&e.pointerType===`touch`)){var t=this.normalizeToPointerData(e);(t[0].pointerType===`mouse`||t[0].pointerType===`pen`)&&(this.didMove=!0,this.cursor=null);for(var n=t.length,r=0;r<n;r++){var i= __get$(t,r) ,a=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,a);o.data.originalEvent=e,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerMove,!0),this.emit(`pointermove`,o),i.pointerType===`touch`&&this.emit(`touchmove`,o),(i.pointerType===`mouse`||i.pointerType===`pen`)&&this.emit(`mousemove`,o)}t[0].pointerType===`mouse`&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,t,n){var r=e.data,i=r.pointerType===`touch`,a=r.pointerType===`mouse`||r.pointerType===`pen`;a&&this.processPointerOverOut(e,t,n),(!this.moveWhenInside||n)&&(this.dispatchEvent(t,`pointermove`,e),i&&this.dispatchEvent(t,`touchmove`,e),a&&this.dispatchEvent(t,`mousemove`,e))},t.prototype.onPointerOut=function(e){if(!(this.supportsTouchEvents&&e.pointerType===`touch`)){var t=this.normalizeToPointerData(e)[0];t.pointerType===`mouse`&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(t),r=this.configureInteractionEventForDOMEvent(this.eventData,t,n);r.data.originalEvent=t,this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit(`pointerout`,r),t.pointerType===`mouse`||t.pointerType===`pen`?this.emit(`mouseout`,r):this.releaseInteractionDataForPointerId(n.identifier)}},t.prototype.processPointerOverOut=function(e,t,n){var r=e.data,i=e.data.identifier,a=r.pointerType===`mouse`||r.pointerType===`pen`,o= __get$(t.trackedPointers,i) ;n&&!o&&(o= __set$(t.trackedPointers,i,new ij(i)) ),o!==void 0&&(n&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(t,`pointerover`,e),a&&this.delayDispatchEvent(t,`mouseover`,e)),a&&this.cursor===null&&(this.cursor=t.cursor)):o.over&&(o.over=!1,this.dispatchEvent(t,`pointerout`,this.eventData),a&&this.dispatchEvent(t,`mouseout`,e),o.none&&delete t.trackedPointers[i]))},t.prototype.onPointerOver=function(e){var t=this.normalizeToPointerData(e)[0],n=this.getInteractionDataForPointerId(t),r=this.configureInteractionEventForDOMEvent(this.eventData,t,n);r.data.originalEvent=t,t.pointerType===`mouse`&&(this.mouseOverRenderer=!0),this.emit(`pointerover`,r),(t.pointerType===`mouse`||t.pointerType===`pen`)&&this.emit(`mouseover`,r)},t.prototype.getInteractionDataForPointerId=function(e){var t=e.pointerId,n;return t===sj||e.pointerType===`mouse`?n=this.mouse: __get$(this.activeInteractionData,t) ?n= __get$(this.activeInteractionData,t) :(n=this.interactionDataPool.pop()||new tj,n.identifier=t, __set$(this.activeInteractionData,t,n) ),n.copyEvent(e),n},t.prototype.releaseInteractionDataForPointerId=function(e){var t= __get$(this.activeInteractionData,e) ;t&&(delete this.activeInteractionData[e],t.reset(),this.interactionDataPool.push(t))},t.prototype.configureInteractionEventForDOMEvent=function(e,t,n){return e.data=n,this.mapPositionToPoint(n.global,t.clientX,t.clientY),t.pointerType===`touch`&&(t.globalX=n.global.x,t.globalY=n.global.y),n.originalEvent=t,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var n=0,r=e.changedTouches.length;n<r;n++){var i= __get$(e.changedTouches,n) ;i.button===void 0&&(i.button=e.touches.length?1:0),i.buttons===void 0&&(i.buttons=e.touches.length?1:0),i.isPrimary===void 0&&(i.isPrimary=e.touches.length===1&&e.type===`touchstart`),i.width===void 0&&(i.width=i.radiusX||1),i.height===void 0&&(i.height=i.radiusY||1),i.tiltX===void 0&&(i.tiltX=0),i.tiltY===void 0&&(i.tiltY=0),i.pointerType===void 0&&(i.pointerType=`touch`),i.pointerId===void 0&&(i.pointerId=i.identifier||0),i.pressure===void 0&&(i.pressure=i.force||.5),i.twist===void 0&&(i.twist=0),i.tangentialPressure===void 0&&(i.tangentialPressure=0),i.layerX===void 0&&(i.layerX=i.offsetX=i.clientX),i.layerY===void 0&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,t.push(i)}else e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof window.PointerEvent))?(e.isPrimary===void 0&&(e.isPrimary=!0),e.width===void 0&&(e.width=1),e.height===void 0&&(e.height=1),e.tiltX===void 0&&(e.tiltX=0),e.tiltY===void 0&&(e.tiltY=0),e.pointerType===void 0&&(e.pointerType=`mouse`),e.pointerId===void 0&&(e.pointerId=sj),e.pressure===void 0&&(e.pressure=.5),e.twist===void 0&&(e.twist=0),e.tangentialPressure===void 0&&(e.tangentialPressure=0),e.isNormalized=!0,t.push(e)):t.push(e);return t},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},Object.defineProperties(t.prototype,n),t}(_T),uj=function e(t){var n=this;t= __call$(Object,"assign",[{forceCanvas:!1},t]) ,this.renderer=Xy(t),this.stage=new RE,e._plugins.forEach(function(e){e.init.call(n,t)})},dj={view:{configurable:!0},screen:{configurable:!0}},uj.registerPlugin=function(e){uj._plugins.push(e)},uj.prototype.render=function(){this.renderer.render(this.stage)},dj.view.get=function(){return this.renderer.view},dj.screen.get=function(){return this.renderer.screen},uj.prototype.destroy=function(e,t){var n=this,r=uj._plugins.slice(0);r.reverse(),r.forEach(function(e){e.destroy.call(n)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null,this._options=null},Object.defineProperties(uj.prototype,dj),uj._plugins=[],fj=function(){},fj.init=function(e){var t=this;Object.defineProperty(this,`resizeTo`,{set:function(e){window.removeEventListener(`resize`,this.resize),this._resizeTo=e,e&&(window.addEventListener(`resize`,this.resize),this.resize())},get:function(){return this._resizeTo}}),this.resize=function(){t._resizeTo&&(t._resizeTo===window?t.renderer.resize(window.innerWidth,window.innerHeight):t.renderer.resize(t._resizeTo.clientWidth,t._resizeTo.clientHeight))},this._resizeTo=null,this.resizeTo=e.resizeTo||null},fj.destroy=function(){this.resizeTo=null,this.resize=null},uj.registerPlugin(fj),pj=new jE,mj=4,hj=function(e){this.renderer=e,e.extract=this},hj.prototype.image=function(e,t,n){var r=new Image;return r.src=this.base64(e,t,n),r},hj.prototype.base64=function(e,t,n){return this.canvas(e).toDataURL(t,n)},hj.prototype.canvas=function(e){var t=this.renderer,n,r,i=!1,a,o=!1;e&&(e instanceof fD?a=e:(a=this.renderer.generateTexture(e),o=!0)),a?(n=a.baseTexture.resolution,r=a.frame,i=!1,t.renderTexture.bind(a)):(n=this.renderer.resolution,i=!0,r=pj,r.width=this.renderer.width,r.height=this.renderer.height,t.renderTexture.bind(null));var s=Math.floor(r.width*n+1e-4),c=Math.floor(r.height*n+1e-4),l=new pE(s,c,1),u=new Uint8Array(mj*s*c),d=t.gl;d.readPixels(r.x*n,r.y*n,s,c,d.RGBA,d.UNSIGNED_BYTE,u);var f=l.context.getImageData(0,0,s,c);return hj.arrayPostDivide(u,f.data),l.context.putImageData(f,0,0),i&&(l.context.scale(1,-1),l.context.drawImage(l.canvas,0,-c)),o&&a.destroy(!0),l.canvas},hj.prototype.pixels=function(e){var t=this.renderer,n,r,i,a=!1;e&&(e instanceof fD?i=e:(i=this.renderer.generateTexture(e),a=!0)),i?(n=i.baseTexture.resolution,r=i.frame,t.renderTexture.bind(i)):(n=t.resolution,r=pj,r.width=t.width,r.height=t.height,t.renderTexture.bind(null));var o=r.width*n,s=r.height*n,c=new Uint8Array(mj*o*s),l=t.gl;return l.readPixels(r.x*n,r.y*n,o,s,l.RGBA,l.UNSIGNED_BYTE,c),a&&i.destroy(!0),hj.arrayPostDivide(c,c),c},hj.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},hj.arrayPostDivide=function(e,t){for(var n=0;n<e.length;n+=4){var r= __set$(t,n+3,__get$(e,n+3)) ;r===0?( __set$(t,n,__get$(e,n)) , __set$(t,n+1,__get$(e,n+1)) , __set$(t,n+2,__get$(e,n+2)) ):( __set$(t,n,Math.round(Math.min(__get$(e,n)*255/r,255))) , __set$(t,n+1,Math.round(Math.min(__get$(e,n+1)*255/r,255))) , __set$(t,n+2,Math.round(Math.min(__get$(e,n+2)*255/r,255))) )}},gj=eA,_j=class{constructor(e,t=!1,n){this._fn=e,this._once=t,this._thisArg=n,this._next=this._prev=this._owner=null}detach(){return this._owner===null?!1:(this._owner.detach(this),!0)}},vj=class{constructor(){this._head=this._tail=void 0}handlers(e=!1){let t=this._head;if(e)return!!t;let n=[];for(;t;)n.push(t),t=t._next;return n}has(e){if(!(e instanceof _j))throw Error(`MiniSignal#has(): First arg must be a MiniSignalBinding object.`);return e._owner===this}dispatch(){let e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,arguments),e=e._next;return!0}add(e,t=null){if(typeof e!=`function`)throw Error(`MiniSignal#add(): First arg must be a Function.`);return tA(this,new _j(e,!1,t))}once(e,t=null){if(typeof e!=`function`)throw Error(`MiniSignal#once(): First arg must be a Function.`);return tA(this,new _j(e,!0,t))}detach(e){if(!(e instanceof _j))throw Error(`MiniSignal#detach(): First arg must be a MiniSignalBinding object.`);return e._owner===this?(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,e._next===null&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null,this):this}detachAll(){let e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this}},yj={},bj=!!(window.XDomainRequest&&!(`withCredentials`in new XMLHttpRequest)),xj=null,Sj=0,Cj=200,wj=204,Tj=1223,Ej=2,Dj=function(){e.setExtensionLoadType=function(t,n){uA(e._loadTypeMap,t,n)},e.setExtensionXhrType=function(t,n){uA(e._xhrTypeMap,t,n)};function e(t,n,r){if(typeof t!=`string`||typeof n!=`string`)throw Error(`Both name and url are required for constructing a resource.`);r||={},this._flags=0,this._setFlag(e.STATUS_FLAGS.DATA_URL,n.indexOf(`data:`)===0),this.name=t,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=r.crossOrigin===!0?`anonymous`:r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=e.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=lA,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new vj,this.onProgress=new vj,this.onComplete=new vj,this.onAfterMiddleware=new vj}var t=e.prototype;return t.complete=function(){this._clearEvents(),this._finish()},t.abort=function(t){if(!this.error){if(this.error=Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=e.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.load=function(t){var n=this;if(!this.isLoading){if(this.isComplete){t&&setTimeout(function(){return t(n)},1);return}else t&&this.onComplete.once(t);switch(this._setFlag(e.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!=`string`)&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case e.LOAD_TYPE.IMAGE:this.type=e.TYPE.IMAGE,this._loadElement(`image`);break;case e.LOAD_TYPE.AUDIO:this.type=e.TYPE.AUDIO,this._loadSourceElement(`audio`);break;case e.LOAD_TYPE.VIDEO:this.type=e.TYPE.VIDEO,this._loadSourceElement(`video`);break;case e.LOAD_TYPE.XHR:default:bj&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},t._hasFlag=function(e){return(this._flags&e)!==0},t._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},t._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener(`error`,this._boundOnError,!1),this.data.removeEventListener(`load`,this._boundComplete,!1),this.data.removeEventListener(`progress`,this._boundOnProgress,!1),this.data.removeEventListener(`canplaythrough`,this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener(`error`,this._boundXhrOnError,!1),this.xhr.removeEventListener(`timeout`,this._boundXhrOnTimeout,!1),this.xhr.removeEventListener(`abort`,this._boundXhrOnAbort,!1),this.xhr.removeEventListener(`progress`,this._boundOnProgress,!1),this.xhr.removeEventListener(`load`,this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t._finish=function(){if(this.isComplete)throw Error(`Complete called again for an already completed resource.`);this._setFlag(e.STATUS_FLAGS.COMPLETE,!0),this._setFlag(e.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:e===`image`&&window.Image!==void 0?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener(`error`,this._boundOnError,!1),this.data.addEventListener(`load`,this._boundComplete,!1),this.data.addEventListener(`progress`,this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:e===`audio`&&window.Audio!==void 0?this.data=new Audio:this.data=document.createElement(e),this.data===null){this.abort(`Unsupported element: `+e);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(e, __get$(this.url,n) ,Array.isArray(t)? __get$(t,n) :t));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener(`error`,this._boundOnError,!1),this.data.addEventListener(`load`,this._boundComplete,!1),this.data.addEventListener(`progress`,this._boundOnProgress,!1),this.data.addEventListener(`canplaythrough`,this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t._loadXhr=function(){typeof this.xhrType!=`string`&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open(`GET`,this.url,!0),t.timeout=this.timeout,this.xhrType===e.XHR_RESPONSE_TYPE.JSON||this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=e.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener(`error`,this._boundXhrOnError,!1),t.addEventListener(`timeout`,this._boundXhrOnTimeout,!1),t.addEventListener(`abort`,this._boundXhrOnAbort,!1),t.addEventListener(`progress`,this._boundOnProgress,!1),t.addEventListener(`load`,this._boundXhrOnLoad,!1),t.send()},t._loadXdr=function(){typeof this.xhrType!=`string`&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open(`GET`,this.url,!0),setTimeout(function(){return e.send()},1)},t._createSource=function(e,t,n){n||=e+`/`+this._getExtension(t);var r=document.createElement(`source`);return r.src=t,r.type=n,r},t._onError=function(e){this.abort(`Failed to load element using: `+e.target.nodeName)},t._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},t._onTimeout=function(){this.abort(`Load timed out.`)},t._xhrOnError=function(){var e=this.xhr;this.abort(dA(e)+` Request failed. Status: `+e.status+`, text: "`+e.statusText+`"`)},t._xhrOnTimeout=function(){var e=this.xhr;this.abort(dA(e)+` Request timed out.`)},t._xhrOnAbort=function(){var e=this.xhr;this.abort(dA(e)+` Request was aborted by the user.`)},t._xhrOnLoad=function(){var t=this.xhr,n=``,r=t.status===void 0?Cj:t.status;if((t.responseType===``||t.responseType===`text`||t.responseType===void 0)&&(n=t.responseText),r===Sj&&(n.length>0||t.responseType===e.XHR_RESPONSE_TYPE.BUFFER)?r=Cj:r===Tj&&(r=wj),(r/100|0)===Ej)if(this.xhrType===e.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=e.TYPE.TEXT;else if(this.xhrType===e.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=e.TYPE.JSON}catch(e){this.abort(`Error trying to parse loaded json: `+e);return}else if(this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser)this.data=new DOMParser().parseFromString(n,`text/xml`);else{var i=document.createElement(`div`);i.innerHTML=n,this.data=i}this.type=e.TYPE.XML}catch(e){this.abort(`Error trying to parse loaded xml: `+e);return}else this.data=t.response||n;else{this.abort(`[`+t.status+`] `+t.statusText+`: `+t.responseURL);return}this.complete()},t._determineCrossOrigin=function(e,t){if(e.indexOf(`data:`)===0)return``;if(window.origin!== __get$(window,"location") .origin)return`anonymous`;t||= __get$(window,"location") ,xj||=document.createElement(`a`), __set$(xj,"href",e) ,e=gj( __get$(xj,"href") ,{strictMode:!0});var n=!e.port&&t.port===``||e.port===t.port,r=e.protocol?e.protocol+`:`:``;return e.host!==t.hostname||!n||r!==t.protocol?`anonymous`:``},t._determineXhrType=function(){return  __get$(e._xhrTypeMap,this.extension) ||e.XHR_RESPONSE_TYPE.TEXT},t._determineLoadType=function(){return  __get$(e._loadTypeMap,this.extension) ||e.LOAD_TYPE.XHR},t._getExtension=function(){var e=this.url,t=``;if(this.isDataUrl){var n=e.indexOf(`/`);t=e.substring(n+1,e.indexOf(`;`,n))}else{var r=e.indexOf(`?`),i=e.indexOf(`#`),a=Math.min(r>-1?r:e.length,i>-1?i:e.length);e=e.substring(0,a),t=e.substring(e.lastIndexOf(`.`)+1)}return t.toLowerCase()},t._getMimeFromXhrType=function(t){switch(t){case e.XHR_RESPONSE_TYPE.BUFFER:return`application/octet-binary`;case e.XHR_RESPONSE_TYPE.BLOB:return`application/blob`;case e.XHR_RESPONSE_TYPE.DOCUMENT:return`application/xml`;case e.XHR_RESPONSE_TYPE.JSON:return`application/json`;case e.XHR_RESPONSE_TYPE.DEFAULT:case e.XHR_RESPONSE_TYPE.TEXT:default:return`text/plain`}},cA(e,[{key:`isDataUrl`,get:function(){return this._hasFlag(e.STATUS_FLAGS.DATA_URL)}},{key:`isComplete`,get:function(){return this._hasFlag(e.STATUS_FLAGS.COMPLETE)}},{key:`isLoading`,get:function(){return this._hasFlag(e.STATUS_FLAGS.LOADING)}}]),e}(),Dj.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},Dj.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},Dj.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},Dj.XHR_RESPONSE_TYPE={DEFAULT:`text`,BUFFER:`arraybuffer`,BLOB:`blob`,DOCUMENT:`document`,JSON:`json`,TEXT:`text`},Dj._loadTypeMap={gif:Dj.LOAD_TYPE.IMAGE,png:Dj.LOAD_TYPE.IMAGE,bmp:Dj.LOAD_TYPE.IMAGE,jpg:Dj.LOAD_TYPE.IMAGE,jpeg:Dj.LOAD_TYPE.IMAGE,tif:Dj.LOAD_TYPE.IMAGE,tiff:Dj.LOAD_TYPE.IMAGE,webp:Dj.LOAD_TYPE.IMAGE,tga:Dj.LOAD_TYPE.IMAGE,svg:Dj.LOAD_TYPE.IMAGE,"svg+xml":Dj.LOAD_TYPE.IMAGE,mp3:Dj.LOAD_TYPE.AUDIO,ogg:Dj.LOAD_TYPE.AUDIO,wav:Dj.LOAD_TYPE.AUDIO,mp4:Dj.LOAD_TYPE.VIDEO,webm:Dj.LOAD_TYPE.VIDEO},Dj._xhrTypeMap={xhtml:Dj.XHR_RESPONSE_TYPE.DOCUMENT,html:Dj.XHR_RESPONSE_TYPE.DOCUMENT,htm:Dj.XHR_RESPONSE_TYPE.DOCUMENT,xml:Dj.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Dj.XHR_RESPONSE_TYPE.DOCUMENT,svg:Dj.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Dj.XHR_RESPONSE_TYPE.DOCUMENT,gif:Dj.XHR_RESPONSE_TYPE.BLOB,png:Dj.XHR_RESPONSE_TYPE.BLOB,bmp:Dj.XHR_RESPONSE_TYPE.BLOB,jpg:Dj.XHR_RESPONSE_TYPE.BLOB,jpeg:Dj.XHR_RESPONSE_TYPE.BLOB,tif:Dj.XHR_RESPONSE_TYPE.BLOB,tiff:Dj.XHR_RESPONSE_TYPE.BLOB,webp:Dj.XHR_RESPONSE_TYPE.BLOB,tga:Dj.XHR_RESPONSE_TYPE.BLOB,json:Dj.XHR_RESPONSE_TYPE.JSON,text:Dj.XHR_RESPONSE_TYPE.TEXT,txt:Dj.XHR_RESPONSE_TYPE.TEXT,ttf:Dj.XHR_RESPONSE_TYPE.BUFFER,otf:Dj.XHR_RESPONSE_TYPE.BUFFER},Dj.EMPTY_GIF=`data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==`,Oj=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=`,kj=window.URL||window.webkitURL,Aj={caching:oA,parsing:pA},jj=100,Mj=/(#[\w-]+)?$/,Nj=function(){function e(t,n){var r=this;t===void 0&&(t=``),n===void 0&&(n=10),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString=``,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(e,t){return r._loadResource(e,t)},this._queue=aA(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new vj,this.onError=new vj,this.onLoad=new vj,this.onStart=new vj,this.onComplete=new vj;for(var i=0;i<e._defaultBeforeMiddleware.length;++i)this.pre( __get$(e._defaultBeforeMiddleware,i) );for(var a=0;a<e._defaultAfterMiddleware.length;++a)this.use( __get$(e._defaultAfterMiddleware,a) )}var t=e.prototype;return t.add=function(e,t,n,r){if(Array.isArray(e)){for(var i=0;i<e.length;++i)this.add( __get$(e,i) );return this}if(typeof e==`object`&&(r=t||e.callback||e.onComplete,n=e,t=e.url,e=e.name||e.key||e.url),typeof t!=`string`&&(r=n,n=t,t=e),typeof t!=`string`)throw Error(`No url passed to add resource to loader.`);if(typeof n==`function`&&(r=n,n=null),this.loading&&(!n||!n.parentResource))throw Error(`Cannot add resources while the loader is running.`);if( __get$(this.resources,e) )throw Error(`Resource named "`+e+`" already exists.`);if(t=this._prepareUrl(t), __set$(this.resources,e,new Dj(e,t,n)) ,typeof r==`function`&& __get$(this.resources,e) .onAfterMiddleware.once(r),this.loading){for(var a=n.parentResource,o=[],s=0;s<a.children.length;++s) __get$(a.children,s) .isComplete||o.push( __get$(a.children,s) );var c=a.progressChunk*(o.length+1)/(o.length+2);a.children.push( __get$(this.resources,e) ),a.progressChunk=c;for(var l=0;l<o.length;++l) __get$(o,l) .progressChunk=c; __get$(this.resources,e) .progressChunk=c}return this._queue.push( __get$(this.resources,e) ),this},t.pre=function(e){return this._beforeMiddleware.push(e),this},t.use=function(e){return this._afterMiddleware.push(e),this},t.reset=function(){for(var e in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var t= __get$(this.resources,e) ;t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort()}return this.resources={},this},t.load=function(e){if(typeof e==`function`&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var t=jj/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n) __get$(this._queue._tasks,n) .data.progressChunk=t;this._onStart(),this._queue.resume()}return this},t._prepareUrl=function(e){var t=gj(e,{strictMode:!0}),n=t.protocol||!t.path||e.indexOf(`//`)===0?e:this.baseUrl.length&&this.baseUrl.lastIndexOf(`/`)!==this.baseUrl.length-1&&e.charAt(0)!==`/`?this.baseUrl+`/`+e:this.baseUrl+e;if(this.defaultQueryString){var r=Mj.exec(n)[0];n=n.substr(0,n.length-r.length),n.indexOf(`?`)===-1?n+=`?`+this.defaultQueryString:n+=`&`+this.defaultQueryString,n+=r}return n},t._loadResource=function(e,t){var n=this;e._dequeue=t,rA(this._beforeMiddleware,function(t,r){t.call(n,e,function(){r(e.isComplete?{}:null)})},function(){e.isComplete?n._onLoad(e):(e._onLoadBinding=e.onComplete.once(n._onLoad,n),e.load())},!0)},t._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t._onComplete=function(){this.progress=jj,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t._onLoad=function(e){var t=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),rA(this._afterMiddleware,function(n,r){n.call(t,e,r)},function(){e.onAfterMiddleware.dispatch(e),t.progress=Math.min(jj,t.progress+e.progressChunk),t.onProgress.dispatch(t,e),e.error?t.onError.dispatch(e.error,t,e):t.onLoad.dispatch(t,e),t._resourcesParsing.splice(t._resourcesParsing.indexOf(e),1),t._queue.idle()&&t._resourcesParsing.length===0&&t._onComplete()},!0)},cA(e,[{key:`concurrency`,get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e}}]),e}(),Nj._defaultBeforeMiddleware=[],Nj._defaultAfterMiddleware=[],Nj.pre=function(e){return Nj._defaultBeforeMiddleware.push(e),Nj},Nj.use=function(e){return Nj._defaultAfterMiddleware.push(e),Nj},Pj=function(){},Pj.use=function(e,t){e.data&&e.type===Dj.TYPE.IMAGE&&(e.texture=dD.fromLoader(e.data,e.url,e.name)),t()},Fj=function(e){function t(n,r){var i=this;e.call(this,n,r),_T.call(this);for(var a=0;a<t._plugins.length;++a){var o= __get$(t._plugins,a) ,s=o.pre,c=o.use;s&&this.pre(s),c&&this.use(c)}this.onStart.add(function(e){return i.emit(`start`,e)}),this.onProgress.add(function(e,t){return i.emit(`progress`,e,t)}),this.onError.add(function(e,t,n){return i.emit(`error`,e,t,n)}),this.onLoad.add(function(e,t){return i.emit(`load`,e,t)}),this.onComplete.add(function(e,t){return i.emit(`complete`,e,t)}),this._protected=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={shared:{configurable:!0}};return t.prototype.destroy=function(){this._protected||(this.removeAllListeners(),this.reset())},n.shared.get=function(){var e=t._shared;return e||(e=new t,e._protected=!0,t._shared=e),e},Object.defineProperties(t,n),t}(Nj), __call$(Object,"assign",[Fj.prototype,_T.prototype]) ,Fj._plugins=[],Fj.registerPlugin=function(e){return Fj._plugins.push(e),e.add&&e.add(),Fj},Fj.registerPlugin({use:Aj.parsing}),Fj.registerPlugin(Pj),Ij=function(){},Ij.init=function(e){e= __call$(Object,"assign",[{sharedLoader:!1},e]) ,this.loader=e.sharedLoader?Fj.shared:new Fj},Ij.destroy=function(){this.loader&&=(this.loader.destroy(),null)},Lj=Dj,Rj=function(e,t,n){this.geometry=new xD,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<e.length;++r){var i= __get$(e,r) ;i={attributeName:i.attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||XT.FLOAT,offset:i.offset}, __get$(t,r) ?this.dynamicProperties.push(i):this.staticProperties.push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()},Rj.prototype.initBuffers=function(){var e=this.geometry,t=0;this.indexBuffer=new gD(vy(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n){var r= __get$(this.dynamicProperties,n) ;r.offset=t,t+=r.size,this.dynamicStride+=r.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new gD(this.dynamicData,!1,!1);var a=0;this.staticStride=0;for(var o=0;o<this.staticProperties.length;++o){var s= __get$(this.staticProperties,o) ;s.offset=a,a+=s.size,this.staticStride+=s.size}var c=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(c),this.staticDataUint32=new Uint32Array(c),this.staticBuffer=new gD(this.staticData,!0,!1);for(var l=0;l<this.dynamicProperties.length;++l){var u= __get$(this.dynamicProperties,l) ;e.addAttribute(u.attributeName,this.dynamicBuffer,0,u.type===XT.UNSIGNED_BYTE,u.type,this.dynamicStride*4,u.offset*4)}for(var d=0;d<this.staticProperties.length;++d){var f= __get$(this.staticProperties,d) ;e.addAttribute(f.attributeName,this.staticBuffer,0,f.type===XT.UNSIGNED_BYTE,f.type,this.staticStride*4,f.offset*4)}},Rj.prototype.uploadDynamic=function(e,t,n){for(var r=0;r<this.dynamicProperties.length;r++){var i= __get$(this.dynamicProperties,r) ;i.uploadFunction(e,t,n,i.type===XT.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++},Rj.prototype.uploadStatic=function(e,t,n){for(var r=0;r<this.staticProperties.length;r++){var i= __get$(this.staticProperties,r) ;i.uploadFunction(e,t,n,i.type===XT.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++},Rj.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},zj=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,Bj=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,Vj=function(e){function t(t){e.call(this,t),this.shader=null,this.properties=null,this.tempMatrix=new xE,this.properties=[{attributeName:`aVertexPosition`,size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:`aPositionCoord`,size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:`aRotation`,size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:`aTextureCoord`,size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:`aColor`,size:1,type:XT.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=$D.from(zj,Bj,{}),this.state=oO.for2d()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(e){var t=e.children,n=e._maxSize,r=e._batchSize,i=this.renderer,a=t.length;if(a!==0){a>n&&!e.autoResize&&(a=n);var o=e._buffers;o||=e._buffers=this.generateBuffers(e);var s=t[0]._texture.baseTexture;this.state.blendMode=my(e.blendMode,s.alphaMode),i.state.set(this.state);var c=i.gl,l=e.worldTransform.copyTo(this.tempMatrix);l.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=l.toArray(!0),this.shader.uniforms.uColor=hy(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,s.alphaMode),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);for(var u=!1,d=0,f=0;d<a;d+=r,f+=1){var p=a-d;p>r&&(p=r),f>=o.length&&o.push(this._generateOneMoreBuffer(e));var m= __get$(o,f) ;m.uploadDynamic(t,d,p);var h= __get$(e._bufferUpdateIDs,f) ||0;u||=m._updateID<h,u&&(m._updateID=e._updateID,m.uploadStatic(t,d,p)),i.geometry.bind(m.geometry),c.drawElements(c.TRIANGLES,p*6,c.UNSIGNED_SHORT,0)}}},t.prototype.generateBuffers=function(e){for(var t=[],n=e._maxSize,r=e._batchSize,i=e._properties,a=0;a<n;a+=r)t.push(new Rj(this.properties,i,r));return t},t.prototype._generateOneMoreBuffer=function(e){var t=e._batchSize,n=e._properties;return new Rj(this.properties,n,t)},t.prototype.uploadVertices=function(e,t,n,r,i,a){for(var o=0,s=0,c=0,l=0,u=0;u<n;++u){var d= __get$(e,t+u) ,f=d._texture,p=d.scale.x,m=d.scale.y,h=f.trim,g=f.orig;h?(s=h.x-d.anchor.x*g.width,o=s+h.width,l=h.y-d.anchor.y*g.height,c=l+h.height):(o=g.width*(1-d.anchor.x),s=g.width*-d.anchor.x,c=g.height*(1-d.anchor.y),l=g.height*-d.anchor.y), __set$(r,a,s*p) , __set$(r,a+1,l*m) , __set$(r,a+i,o*p) , __set$(r,a+i+1,l*m) , __set$(r,a+i*2,o*p) , __set$(r,a+i*2+1,c*m) , __set$(r,a+i*3,s*p) , __set$(r,a+i*3+1,c*m) ,a+=i*4}},t.prototype.uploadPosition=function(e,t,n,r,i,a){for(var o=0;o<n;o++){var s= __get$(e,t+o) .position; __set$(r,a,s.x) , __set$(r,a+1,s.y) , __set$(r,a+i,s.x) , __set$(r,a+i+1,s.y) , __set$(r,a+i*2,s.x) , __set$(r,a+i*2+1,s.y) , __set$(r,a+i*3,s.x) , __set$(r,a+i*3+1,s.y) ,a+=i*4}},t.prototype.uploadRotation=function(e,t,n,r,i,a){for(var o=0;o<n;o++){var s= __get$(e,t+o) .rotation; __set$(r,a,s) , __set$(r,a+i,s) , __set$(r,a+i*2,s) , __set$(r,a+i*3,s) ,a+=i*4}},t.prototype.uploadUvs=function(e,t,n,r,i,a){for(var o=0;o<n;++o){var s= __get$(e,t+o) ._texture._uvs;s?( __set$(r,a,s.x0) , __set$(r,a+1,s.y0) , __set$(r,a+i,s.x1) , __set$(r,a+i+1,s.y1) , __set$(r,a+i*2,s.x2) , __set$(r,a+i*2+1,s.y2) , __set$(r,a+i*3,s.x3) , __set$(r,a+i*3+1,s.y3) ,a+=i*4):( __set$(r,a,0) , __set$(r,a+1,0) , __set$(r,a+i,0) , __set$(r,a+i+1,0) , __set$(r,a+i*2,0) , __set$(r,a+i*2+1,0) , __set$(r,a+i*3,0) , __set$(r,a+i*3+1,0) ,a+=i*4)}},t.prototype.uploadTint=function(e,t,n,r,i,a){for(var o=0;o<n;++o){var s= __get$(e,t+o) ,c=s._texture.baseTexture.alphaMode>0,l=s.alpha,u=l<1&&c?gy(s._tintRGB,l):s._tintRGB+(l*255<<24); __set$(r,a,u) , __set$(r,a+i,u) , __set$(r,a+i*2,u) , __set$(r,a+i*3,u) ,a+=i*4}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.shader&&=(this.shader.destroy(),null),this.tempMatrix=null},t}(OD),Hj={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function(e,t){if(t===void 0&&(t=20),!this.adaptive||!e||Number.isNaN(e))return t;var n=Math.ceil(e/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},Uj=function(){this.reset()},Uj.prototype.clone=function(){var e=new Uj;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},Uj.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=dD.WHITE,this.matrix=null,this.visible=!1},Uj.prototype.destroy=function(){this.texture=null,this.matrix=null},Wj={build:function(e){e.points=e.shape.points.slice()},triangulate:function(e,t){var n=e.points,r=e.holes,i=t.points,a=t.indices;if(n.length>=6){for(var o=[],s=0;s<r.length;s++){var c= __get$(r,s) ;o.push(n.length/2),n=n.concat(c.points)}var l=vT(n,o,2);if(!l)return;for(var u=i.length/2,d=0;d<l.length;d+=3)a.push( __get$(l,d) +u),a.push( __get$(l,d+1) +u),a.push( __get$(l,d+2) +u);for(var f=0;f<n.length;f++)i.push( __get$(n,f) )}}},Gj={build:function(e){var t=e.shape,n=e.points,r=t.x,i=t.y,a,o;if(n.length=0,e.type===bE.CIRC?(a=t.radius,o=t.radius):(a=t.width,o=t.height),!(a===0||o===0)){var s=Math.floor(30*Math.sqrt(t.radius))||Math.floor(15*Math.sqrt(t.width+t.height));s/=2.3;for(var c=Math.PI*2/s,l=0;l<s-.5;l++)n.push(r+Math.sin(-c*l)*a,i+Math.cos(-c*l)*o);n.push(n[0],n[1])}},triangulate:function(e,t){var n=e.points,r=t.points,i=t.indices,a=r.length/2,o=a;r.push(e.shape.x,e.shape.y);for(var s=0;s<n.length;s+=2)r.push( __get$(n,s) , __get$(n,s+1) ),i.push(a++,o,a)}},Kj={build:function(e){var t=e.shape,n=t.x,r=t.y,i=t.width,a=t.height,o=e.points;o.length=0,o.push(n,r,n+i,r,n+i,r+a,n,r+a)},triangulate:function(e,t){var n=e.points,r=t.points,i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},qj={build:function(e){var t=e.shape,n=e.points,r=t.x,i=t.y,a=t.width,o=t.height,s=t.radius;n.length=0,hA(r,i+s,r,i,r+s,i,n),hA(r+a-s,i,r+a,i,r+a,i+s,n),hA(r+a,i+o-s,r+a,i+o,r+a-s,i+o,n),hA(r+s,i+o,r,i+o,r,i+o-s,n)},triangulate:function(e,t){for(var n=e.points,r=t.points,i=t.indices,a=r.length/2,o=vT(n,null,2),s=0,c=o.length;s<c;s+=3)i.push( __get$(o,s) +a),i.push( __get$(o,s+1) +a),i.push( __get$(o,s+2) +a);for(var l=0,u=n.length;l<u;l++)r.push( __get$(n,l) , __get$(n,++l) )}},Jj=function(e){function t(t,n,r,i,a,o){a||=i/2;for(var s=-1*Math.PI/2+o,c=r*2,l=_E/c,u=[],d=0;d<c;d++){var f=d%2?a:i,p=d*l+s;u.push(t+f*Math.cos(p),n+f*Math.sin(p))}e.call(this,u)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(PE),Yj=function(){},Yj.curveTo=function(e,t,n,r,i,a){var o= __get$(a,a.length-2) ,s= __get$(a,a.length-1) -t,c=o-e,l=r-t,u=n-e,d=Math.abs(s*u-c*l);if(d<1e-8||i===0)return( __get$(a,a.length-2) !==e|| __get$(a,a.length-1) !==t)&&a.push(e,t),null;var f=s*s+c*c,p=l*l+u*u,m=s*l+c*u,h=i*Math.sqrt(f)/d,g=i*Math.sqrt(p)/d,_=h*m/f,v=g*m/p,y=h*u+g*c,b=h*l+g*s,x=c*(g+_),S=s*(g+_),C=u*(h+v),w=l*(h+v),T=Math.atan2(S-b,x-y),E=Math.atan2(w-b,C-y);return{cx:y+e,cy:b+t,radius:i,startAngle:T,endAngle:E,anticlockwise:c*l>u*s}},Yj.arc=function(e,t,n,r,i,a,o,s,c){for(var l=o-a,u=Hj._segmentsCount(Math.abs(l)*i,Math.ceil(Math.abs(l)/_E)*40),d=l/(u*2),f=d*2,p=Math.cos(d),m=Math.sin(d),h=u-1,g=h%1/h,_=0;_<=h;++_){var v=_+g*_,y=d+a+f*v,b=Math.cos(y),x=-Math.sin(y);c.push((p*b+m*x)*i+n,(p*-x+m*b)*i+r)}},Xj=function(){},Xj.curveLength=function(e,t,n,r,i,a,o,s){for(var c=10,l=0,u=0,d=0,f=0,p=0,m=0,h=0,g=0,_=0,v=0,y=0,b=e,x=t,S=1;S<=c;++S)u=S/c,d=u*u,f=d*u,p=1-u,m=p*p,h=m*p,g=h*e+3*m*u*n+3*p*d*i+f*o,_=h*t+3*m*u*r+3*p*d*a+f*s,v=b-g,y=x-_,b=g,x=_,l+=Math.sqrt(v*v+y*y);return l},Xj.curveTo=function(e,t,n,r,i,a,o){var s= __get$(o,o.length-2) ,c= __get$(o,o.length-1) ;o.length-=2;var l=Hj._segmentsCount(Xj.curveLength(s,c,e,t,n,r,i,a)),u=0,d=0,f=0,p=0,m=0;o.push(s,c);for(var h=1,g=0;h<=l;++h)g=h/l,u=1-g,d=u*u,f=d*u,p=g*g,m=p*g,o.push(f*s+3*d*g*e+3*u*p*n+m*i,f*c+3*d*g*t+3*u*p*r+m*a)},Zj=function(){},Zj.curveLength=function(e,t,n,r,i,a){var o=e-2*n+i,s=t-2*r+a,c=2*n-2*e,l=2*r-2*t,u=4*(o*o+s*s),d=4*(o*c+s*l),f=c*c+l*l,p=2*Math.sqrt(u+d+f),m=Math.sqrt(u),h=2*u*m,g=2*Math.sqrt(f),_=d/m;return(h*p+m*d*(p-g)+(4*f*u-d*d)*Math.log((2*m+_+p)/(_+g)))/(4*h)},Zj.curveTo=function(e,t,n,r,i){for(var a= __get$(i,i.length-2) ,o= __get$(i,i.length-1) ,s=Hj._segmentsCount(Zj.curveLength(a,o,e,t,n,r)),c=0,l=0,u=1;u<=s;++u){var d=u/s;c=a+(e-a)*d,l=o+(t-o)*d,i.push(c+(e+(n-e)*d-c)*d,l+(t+(r-t)*d-l)*d)}},Qj=function(){this.reset()},Qj.prototype.begin=function(e,t,n){this.reset(),this.style=e,this.start=t,this.attribStart=n},Qj.prototype.end=function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start},Qj.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},$j={}, __set$($j,bE.POLY,Wj) , __set$($j,bE.CIRC,Gj) , __set$($j,bE.ELIP,Gj) , __set$($j,bE.RECT,Kj) , __set$($j,bE.RREC,qj) ,eM=[],tM=[],nM=function(e,t,n,r){t===void 0&&(t=null),n===void 0&&(n=null),r===void 0&&(r=null),this.shape=e,this.lineStyle=n,this.fillStyle=t,this.matrix=r,this.type=e.type,this.points=[],this.holes=[]},nM.prototype.clone=function(){return new nM(this.shape,this.fillStyle,this.lineStyle,this.matrix)},nM.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},rM=new hE,iM=new IE,aM=function(e){function t(){e.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new IE,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null,this.closePointEps=1e-4}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={bounds:{configurable:!0}};return n.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++) __get$(this.drawCalls,e) .textures.length=0,tM.push( __get$(this.drawCalls,e) );this.drawCalls.length=0;for(var t=0;t<this.batches.length;t++){var n= __get$(this.batches,t) ;n.reset(),eM.push(n)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,t,n,r){var i=new nM(e,t,n,r);return this.graphicsData.push(i),this.dirty++,this},t.prototype.drawHole=function(e,t){if(!this.graphicsData.length)return null;var n=new nM(e,null,null,t),r= __get$(this.graphicsData,this.graphicsData.length-1) ;return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t);for(var n=0;n<this.graphicsData.length;++n) __get$(this.graphicsData,n) .destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var t=this.graphicsData,n=0;n<t.length;++n){var r= __get$(t,n) ;if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(e,rM):rM.copyFrom(e),r.shape.contains(rM.x,rM.y))){var i=!1;if(r.holes){for(var a=0;a<r.holes.length;a++)if( __get$(r.holes,a) .shape.contains(rM.x,rM.y)){i=!0;break}}if(!i)return!0}}return!1},t.prototype.updateBatches=function(){if(!this.graphicsData.length){this.batchable=!0;return}if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,t=this.graphicsData,n=null,r=null;this.batches.length>0&&(n= __get$(this.batches,this.batches.length-1) ,r=n.style);for(var i=this.shapeIndex;i<t.length;i++){this.shapeIndex++;var a= __get$(t,i) ,o=a.fillStyle,s=a.lineStyle; __get$($j,a.type) .build(a),a.matrix&&this.transformPoints(a.points,a.matrix);for(var c=0;c<2;c++){var l=c===0?o:s;if(l.visible){var u=l.texture.baseTexture,d=this.indices.length,f=this.points.length/2;u.wrapMode=QT.REPEAT,c===0?this.processFill(a):this.processLine(a);var p=this.points.length/2-f;p!==0&&(n&&!this._compareStyles(r,l)&&(n.end(d,f),n=null),n||(n=eM.pop()||new Qj,n.begin(l,d,f),this.batches.push(n),r=l),this.addUvs(this.points,e,l.texture,f,p,l.matrix))}}}if(n){var m=this.indices.length,h=this.points.length/2;n.end(m,h)}if(this.batches.length===0){this.batchable=!0;return}this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}},t.prototype._compareStyles=function(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,t=this.graphicsData.length;e<t;e++){var n= __get$(this.graphicsData,e) ,r=n.fillStyle,i=n.lineStyle;if(r&&!r.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,t=0,n=e.length;t<n;t++)for(var r= __get$(e,t) ,i=0;i<r.size;i++){var a=r.start+i; __set$(this.indicesUint16,a,__get$(this.indicesUint16,a)-r.attribStart) }},t.prototype.isBatchable=function(){for(var e=this.batches,n=0;n<e.length;n++)if( __get$(e,n) .style.native)return!1;return this.points.length<t.BATCHABLE_SIZE*2},t.prototype.buildDrawCalls=function(){for(var e=++ZE._globalBatch,t=0;t<this.drawCalls.length;t++) __get$(this.drawCalls,t) .textures.length=0,tM.push( __get$(this.drawCalls,t) );this.drawCalls.length=0;var n=this.colors,r=this.textureIds,i=tM.pop();i||(i=new zO,i.textures=new BO),i.textures.count=0,i.start=0,i.size=0,i.type=qT.TRIANGLES;var a=0,o=null,s=0,c=!1,l=qT.TRIANGLES,u=0;this.drawCalls.push(i);for(var d=0;d<this.batches.length;d++){var f= __get$(this.batches,d) ,p=8,m=f.style,h=m.texture.baseTexture;c!==!!m.native&&(c=!!m.native,l=c?qT.LINES:qT.TRIANGLES,o=null,a=p,e++),o!==h&&(o=h,h._batchEnabled!==e&&(a===p&&(e++,a=0,i.size>0&&(i=tM.pop(),i||(i=new zO,i.textures=new BO),this.drawCalls.push(i)),i.start=u,i.size=0,i.textures.count=0,i.type=l),h.touched=1,h._batchEnabled=e,h._batchLocation=a,h.wrapMode=10497, __set$(i.textures.elements,i.textures.count++,h) ,a++)),i.size+=f.size,u+=f.size,s=h._batchLocation,this.addColors(n,m.color,m.alpha,f.attribSize),this.addTextureIds(r,s,f.attribSize)}ZE._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,t=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(e.length*3*4),a=new Float32Array(i),o=new Uint32Array(i),s=0,c=0;c<e.length/2;c++) __set$(a,s++,__get$(e,c*2)) , __set$(a,s++,__get$(e,c*2+1)) , __set$(a,s++,__get$(t,c*2)) , __set$(a,s++,__get$(t,c*2+1)) , __set$(o,s++,__get$(n,c)) , __set$(a,s++,__get$(r,c)) ;this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){e.holes.length?(this.processHoles(e.holes),Wj.triangulate(e,this)): __get$($j,e.type) .triangulate(e,this)},t.prototype.processLine=function(e){gA(e,this);for(var t=0;t<e.holes.length;t++)gA( __get$(e.holes,t) ,this)},t.prototype.processHoles=function(e){for(var t=0;t<e.length;t++){var n= __get$(e,t) ; __get$($j,n.type) .build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds,t=iM,n=xE.IDENTITY;this._bounds.clear(),t.clear();for(var r=0;r<this.graphicsData.length;r++){var i= __get$(this.graphicsData,r) ,a=i.shape,o=i.type,s=i.lineStyle,c=i.matrix||xE.IDENTITY,l=0;if(s&&s.visible){var u=s.alignment;l=s.width,o===bE.POLY?l*=.5+Math.abs(.5-u):l*=Math.max(0,u)}n!==c&&(t.isEmpty()||(e.addBoundsMatrix(t,n),t.clear()),n=c),o===bE.RECT||o===bE.RREC?t.addFramePad(a.x,a.y,a.x+a.width,a.y+a.height,l,l):o===bE.CIRC?t.addFramePad(a.x,a.y,a.x,a.y,a.radius+l,a.radius+l):o===bE.ELIP?t.addFramePad(a.x,a.y,a.x,a.y,a.width+l,a.height+l):e.addVerticesMatrix(n,a.points,0,a.points.length,l,l)}t.isEmpty()||e.addBoundsMatrix(t,n),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,t){for(var n=0;n<e.length/2;n++){var r= __get$(e,n*2) ,i= __get$(e,n*2+1) ; __set$(e,n*2,t.a*r+t.c*i+t.tx) , __set$(e,n*2+1,t.b*r+t.d*i+t.ty) }},t.prototype.addColors=function(e,t,n,r){for(var i=gy((t>>16)+(t&65280)+((t&255)<<16),n);r-- >0;)e.push(i)},t.prototype.addTextureIds=function(e,t,n){for(;n-- >0;)e.push(t)},t.prototype.addUvs=function(e,t,n,r,i,a){for(var o=0,s=t.length,c=n.frame;o<i;){var l= __get$(e,(r+o)*2) ,u= __get$(e,(r+o)*2+1) ;if(a){var d=a.a*l+a.c*u+a.tx;u=a.b*l+a.d*u+a.ty,l=d}o++,t.push(l/c.width,u/c.height)}var f=n.baseTexture;(c.width<f.width||c.height<f.height)&&this.adjustUvs(t,n,s,i)},t.prototype.adjustUvs=function(e,t,n,r){for(var i=t.baseTexture,a=1e-6,o=n+r*2,s=t.frame,c=s.width/i.width,l=s.height/i.height,u=s.x/s.width,d=s.y/s.height,f=Math.floor( __get$(e,n) +a),p=Math.floor( __get$(e,n+1) +a),m=n+2;m<o;m+=2)f=Math.min(f,Math.floor( __get$(e,m) +a)),p=Math.min(p,Math.floor( __get$(e,m+1) +a));u-=f,d-=p;for(var h=n;h<o;h+=2) __set$(e,h,(__get$(e,h)+u)*c) , __set$(e,h+1,(__get$(e,h+1)+d)*l) },Object.defineProperties(t.prototype,n),t}(GO),aM.BATCHABLE_SIZE=100,oM=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e},t.prototype.reset=function(){e.prototype.reset.call(this),this.color=0,this.width=0,this.alignment=.5,this.native=!1},t}(Uj),sM=new Float32Array(3),cM={},lM=function(e){function t(t){t===void 0&&(t=null),e.call(this),this.geometry=t||new aM,this.geometry.refCount++,this.shader=null,this.state=oO.for2d(),this._fillStyle=new Uj,this._lineStyle=new oM,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.pluginName=`batch`,this.tint=16777215,this.blendMode=KT.NORMAL}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return t.prototype.clone=function(){return this.finishPoly(),new t(this.geometry)},n.blendMode.set=function(e){this.state.blendMode=e},n.blendMode.get=function(){return this.state.blendMode},n.tint.get=function(){return this._tint},n.tint.set=function(e){this._tint=e},n.fill.get=function(){return this._fillStyle},n.line.get=function(){return this._lineStyle},t.prototype.lineStyle=function(e){if(typeof e==`number`){var t=arguments;e={width:t[0]||0,color:t[1]||0,alpha:t[2]===void 0?1:t[2],alignment:t[3]===void 0?.5:t[3],native:!!t[4]}}return this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){typeof e==`number`&&(Ty(`v5.2.0`,`Please use object-based options for Graphics#lineTextureStyle`),e={width:arguments[0],texture:arguments[1],color:arguments[2],alpha:arguments[3],matrix:arguments[4],alignment:arguments[5],native:arguments[6]},Object.keys(e).forEach(function(t){return  __get$(e,t) ===void 0&&delete e[t]})),e= __call$(Object,"assign",[{width:0,texture:dD.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1},e]) ,this.currentPath&&this.startPoly();var t=e.width>0&&e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()), __call$(Object,"assign",[this._lineStyle,{visible:t},e]) ):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new PE,this.currentPath.closeStroke=!1,this.currentPath.points.push( __get$(e,t-2) , __get$(e,t-1) ))}else this.currentPath=new PE,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this},t.prototype.lineTo=function(e,t){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,r= __get$(n,n.length-2) ,i= __get$(n,n.length-1) ;return(r!==e||i!==t)&&n.push(e,t),this},t.prototype._initCurve=function(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)},t.prototype.quadraticCurveTo=function(e,t,n,r){this._initCurve();var i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),Zj.curveTo(e,t,n,r,i),this},t.prototype.bezierCurveTo=function(e,t,n,r,i,a){return this._initCurve(),Xj.curveTo(e,t,n,r,i,a,this.currentPath.points),this},t.prototype.arcTo=function(e,t,n,r,i){this._initCurve(e,t);var a=this.currentPath.points,o=Yj.curveTo(e,t,n,r,i,a);if(o){var s=o.cx,c=o.cy,l=o.radius,u=o.startAngle,d=o.endAngle,f=o.anticlockwise;this.arc(s,c,l,u,d,f)}return this},t.prototype.arc=function(e,t,n,r,i,a){if(a===void 0&&(a=!1),r===i||(!a&&i<=r?i+=_E:a&&r<=i&&(r+=_E),i-r===0))return this;var o=e+Math.cos(r)*n,s=t+Math.sin(r)*n,c=this.geometry.closePointEps,l=this.currentPath?this.currentPath.points:null;if(l){var u=Math.abs( __get$(l,l.length-2) -o),d=Math.abs( __get$(l,l.length-1) -s);u<c&&d<c||l.push(o,s)}else this.moveTo(o,s),l=this.currentPath.points;return Yj.arc(o,s,e,t,n,r,i,a,l),this},t.prototype.beginFill=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=1),this.beginTextureFill({texture:dD.WHITE,color:e,alpha:t})},t.prototype.beginTextureFill=function(e){e instanceof dD&&(Ty(`v5.2.0`,`Please use object-based options for Graphics#beginTextureFill`),e={texture:arguments[0],color:arguments[1],alpha:arguments[2],matrix:arguments[3]},Object.keys(e).forEach(function(t){return  __get$(e,t) ===void 0&&delete e[t]})),e= __call$(Object,"assign",[{texture:dD.WHITE,color:16777215,alpha:1,matrix:null},e]) ,this.currentPath&&this.startPoly();var t=e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()), __call$(Object,"assign",[this._fillStyle,{visible:t},e]) ):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,t,n,r){return this.drawShape(new jE(e,t,n,r))},t.prototype.drawRoundedRect=function(e,t,n,r,i){return this.drawShape(new FE(e,t,n,r,i))},t.prototype.drawCircle=function(e,t,n){return this.drawShape(new ME(e,t,n))},t.prototype.drawEllipse=function(e,t,n,r){return this.drawShape(new NE(e,t,n,r))},t.prototype.drawPolygon=function(e){var t=arguments,n=e,r=!0;if(n.points&&(r=n.closeStroke,n=n.points),!Array.isArray(n)){n=Array(arguments.length);for(var i=0;i<n.length;++i) __set$(n,i,__get$(t,i)) }var a=new PE(n);return a.closeStroke=r,this.drawShape(a),this},t.prototype.drawShape=function(e){return this._holeMode?this.geometry.drawHole(e,this._matrix):this.geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.drawStar=function(e,t,n,r,i,a){return a===void 0&&(a=0),this.drawPolygon(new Jj(e,t,n,r,i,a))},t.prototype.clear=function(){return this.geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){return this.geometry.graphicsData.length===1&&this.geometry.graphicsData[0].shape.type===bE.RECT&&!this.geometry.graphicsData[0].lineWidth},t.prototype._render=function(e){this.finishPoly();var t=this.geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this.geometry,t=this.blendMode;this.batches=[],this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.vertexData=new Float32Array(e.points);for(var n=0,r=e.batches.length;n<r;n++){var i= __get$(e.batches,n) ,a=i.style.color,o=new Float32Array(this.vertexData.buffer,i.attribStart*4*2,i.attribSize*2),s=new Float32Array(e.uvsFloat32.buffer,i.attribStart*4*2,i.attribSize*2),c={vertexData:o,blendMode:t,indices:new Uint16Array(e.indicesUint16.buffer,i.start*2,i.size),uvs:s,_batchRGB:ly(a),_tintRGB:a,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1}; __set$(this.batches,n,c) }},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer( __get$(e.plugins,this.pluginName) ),this.calculateVertices(),this.calculateTints();for(var t=0,n=this.batches.length;t<n;t++){var r= __get$(this.batches,t) ;r.worldAlpha=this.worldAlpha*r.alpha, __get$(e.plugins,this.pluginName) .render(r)}}},t.prototype._renderDirect=function(e){var t=this._resolveDirectShader(e),n=this.geometry,r=this.tint,i=this.worldAlpha,a=t.uniforms,o=n.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(r>>16&255)/255*i,a.tint[1]=(r>>8&255)/255*i,a.tint[2]=(r&255)/255*i,a.tint[3]=i,e.shader.bind(t),e.geometry.bind(n,t),e.state.set(this.state);for(var s=0,c=o.length;s<c;s++)this._renderDrawCallDirect(e, __get$(n.drawCalls,s) )},t.prototype._renderDrawCallDirect=function(e,t){for(var n=t.textures,r=t.type,i=t.size,a=t.start,o=n.count,s=0;s<o;s++)e.texture.bind( __get$(n.elements,s) ,s);e.geometry.draw(r,i,a)},t.prototype._resolveDirectShader=function(e){var t=this.shader,n=this.pluginName;if(!t){if(! __get$(cM,n) ){for(var r=new Int32Array(16),i=0;i<16;i++) __set$(r,i,i) ;var a={tint:new Float32Array([1,1,1,1]),translationMatrix:new xE,default:TD.from({uSamplers:r},!0)},o= __get$(e.plugins,n) ._shader.program; __set$(cM,n,new $D(o,a)) }t= __get$(cM,n) }return t},t.prototype._calculateBounds=function(){this.finishPoly();var e=this.geometry;if(e.graphicsData.length){var t=e.bounds,n=t.minX,r=t.minY,i=t.maxX,a=t.maxY;this._bounds.addFrame(this.transform,n,r,i,a)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this.geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=ly(this.tint,sM),t=0;t<this.batches.length;t++){var n= __get$(this.batches,t) ,r=n._batchRGB,i=e[0]*r[0]*255,a=e[1]*r[1]*255,o=e[2]*r[2]*255,s=(i<<16)+(a<<8)+(o|0);n._tintRGB=(s>>16)+(s&65280)+((s&255)<<16)}}},t.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var e=this.transform.worldTransform,t=e.a,n=e.b,r=e.c,i=e.d,a=e.tx,o=e.ty,s=this.geometry.points,c=this.vertexData,l=0,u=0;u<s.length;u+=2){var d= __get$(s,u) ,f= __get$(s,u+1) ; __set$(c,l++,t*d+r*f+a) , __set$(c,l++,i*f+n*d+o) }}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.geometry.refCount--,this.geometry.refCount===0&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,e.prototype.destroy.call(this,t)},Object.defineProperties(t.prototype,n),t}(RE),lM._TEMP_POINT=new hE,uM=new hE,dM=new Uint16Array([0,1,2,0,2,3]),fM=function(e){function t(t){e.call(this),this._anchor=new gE(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=KT.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=t||dD.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=dM,this.size=4,this.start=0,this.pluginName=`batch`,this.isSprite=!0,this._roundPixels=hT.ROUND_PIXELS}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Cy(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Cy(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(!(this._transformID===this.transform._worldID&&this._textureID===e._updateID)){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var t=this.transform.worldTransform,n=t.a,r=t.b,i=t.c,a=t.d,o=t.tx,s=t.ty,c=this.vertexData,l=e.trim,u=e.orig,d=this._anchor,f=0,p=0,m=0,h=0;if(l?(p=l.x-d._x*u.width,f=p+l.width,h=l.y-d._y*u.height,m=h+l.height):(p=-d._x*u.width,f=p+u.width,h=-d._y*u.height,m=h+u.height),c[0]=n*p+i*h+o,c[1]=a*h+r*p+s,c[2]=n*f+i*h+o,c[3]=a*h+r*f+s,c[4]=n*f+i*m+o,c[5]=a*m+r*f+s,c[6]=n*p+i*m+o,c[7]=a*m+r*p+s,this._roundPixels)for(var g=hT.RESOLUTION,_=0;_<c.length;++_) __set$(c,_,Math.round((__get$(c,_)*g|0)/g)) }},t.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,t=this.vertexTrimmedData,n=e.orig,r=this._anchor,i=this.transform.worldTransform,a=i.a,o=i.b,s=i.c,c=i.d,l=i.tx,u=i.ty,d=-r._x*n.width,f=d+n.width,p=-r._y*n.height,m=p+n.height;t[0]=a*d+s*p+l,t[1]=c*p+o*d+u,t[2]=a*f+s*p+l,t[3]=c*p+o*f+u,t[4]=a*f+s*m+l,t[5]=c*m+o*f+u,t[6]=a*d+s*m+l,t[7]=c*m+o*d+u},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer( __get$(e.plugins,this.pluginName) ), __get$(e.plugins,this.pluginName) .render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(t){return this.children.length===0?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||=(this._localBoundsRect||=new jE,this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,uM);var t=this._texture.orig.width,n=this._texture.orig.height,r=-t*this.anchor.x,i=0;return uM.x>=r&&uM.x<r+t&&(i=-n*this.anchor.y,uM.y>=i&&uM.y<i+n)},t.prototype.destroy=function(t){if(e.prototype.destroy.call(this,t),this._texture.off(`update`,this._onTextureUpdate,this),this._anchor=null,typeof t==`boolean`?t:t&&t.texture){var n=typeof t==`boolean`?t:t&&t.baseTexture;this._texture.destroy(!!n)}this._texture=null,this.shader=null},t.from=function(e,n){return new t(e instanceof dD?e:dD.from(e,n))},n.roundPixels.set=function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},n.roundPixels.get=function(){return this._roundPixels},n.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},n.width.set=function(e){var t=Cy(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e},n.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},n.height.set=function(e){var t=Cy(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e},n.anchor.get=function(){return this._anchor},n.anchor.set=function(e){this._anchor.copyFrom(e)},n.tint.get=function(){return this._tint},n.tint.set=function(e){this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16)},n.texture.get=function(){return this._texture},n.texture.set=function(e){this._texture!==e&&(this._texture&&this._texture.off(`update`,this._onTextureUpdate,this),this._texture=e||dD.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once(`update`,this._onTextureUpdate,this)))},Object.defineProperties(t.prototype,n),t}(RE),pM={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},mM={align:`left`,breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:`black`,dropShadowDistance:5,fill:`black`,fillGradientType:pM.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:`Arial`,fontSize:26,fontStyle:`normal`,fontVariant:`normal`,fontWeight:`normal`,letterSpacing:0,lineHeight:0,lineJoin:`miter`,miterLimit:10,padding:0,stroke:`black`,strokeThickness:0,textBaseline:`alphabetic`,trim:!1,whiteSpace:`pre`,wordWrap:!1,wordWrapWidth:100,leading:0},hM=[`serif`,`sans-serif`,`monospace`,`cursive`,`fantasy`,`system-ui`],gM=function(e){this.styleID=0,this.reset(),SA(this,e,e)},_M={align:{configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}},gM.prototype.clone=function(){var e={};return SA(e,this,mM),new gM(e)},gM.prototype.reset=function(){SA(this,mM,mM)},_M.align.get=function(){return this._align},_M.align.set=function(e){this._align!==e&&(this._align=e,this.styleID++)},_M.breakWords.get=function(){return this._breakWords},_M.breakWords.set=function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)},_M.dropShadow.get=function(){return this._dropShadow},_M.dropShadow.set=function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)},_M.dropShadowAlpha.get=function(){return this._dropShadowAlpha},_M.dropShadowAlpha.set=function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)},_M.dropShadowAngle.get=function(){return this._dropShadowAngle},_M.dropShadowAngle.set=function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)},_M.dropShadowBlur.get=function(){return this._dropShadowBlur},_M.dropShadowBlur.set=function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)},_M.dropShadowColor.get=function(){return this._dropShadowColor},_M.dropShadowColor.set=function(e){var t=bA(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},_M.dropShadowDistance.get=function(){return this._dropShadowDistance},_M.dropShadowDistance.set=function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)},_M.fill.get=function(){return this._fill},_M.fill.set=function(e){var t=bA(e);this._fill!==t&&(this._fill=t,this.styleID++)},_M.fillGradientType.get=function(){return this._fillGradientType},_M.fillGradientType.set=function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)},_M.fillGradientStops.get=function(){return this._fillGradientStops},_M.fillGradientStops.set=function(e){xA(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)},_M.fontFamily.get=function(){return this._fontFamily},_M.fontFamily.set=function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)},_M.fontSize.get=function(){return this._fontSize},_M.fontSize.set=function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)},_M.fontStyle.get=function(){return this._fontStyle},_M.fontStyle.set=function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)},_M.fontVariant.get=function(){return this._fontVariant},_M.fontVariant.set=function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)},_M.fontWeight.get=function(){return this._fontWeight},_M.fontWeight.set=function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)},_M.letterSpacing.get=function(){return this._letterSpacing},_M.letterSpacing.set=function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)},_M.lineHeight.get=function(){return this._lineHeight},_M.lineHeight.set=function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)},_M.leading.get=function(){return this._leading},_M.leading.set=function(e){this._leading!==e&&(this._leading=e,this.styleID++)},_M.lineJoin.get=function(){return this._lineJoin},_M.lineJoin.set=function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)},_M.miterLimit.get=function(){return this._miterLimit},_M.miterLimit.set=function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)},_M.padding.get=function(){return this._padding},_M.padding.set=function(e){this._padding!==e&&(this._padding=e,this.styleID++)},_M.stroke.get=function(){return this._stroke},_M.stroke.set=function(e){var t=bA(e);this._stroke!==t&&(this._stroke=t,this.styleID++)},_M.strokeThickness.get=function(){return this._strokeThickness},_M.strokeThickness.set=function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)},_M.textBaseline.get=function(){return this._textBaseline},_M.textBaseline.set=function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)},_M.trim.get=function(){return this._trim},_M.trim.set=function(e){this._trim!==e&&(this._trim=e,this.styleID++)},_M.whiteSpace.get=function(){return this._whiteSpace},_M.whiteSpace.set=function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)},_M.wordWrap.get=function(){return this._wordWrap},_M.wordWrap.set=function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)},_M.wordWrapWidth.get=function(){return this._wordWrapWidth},_M.wordWrapWidth.set=function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)},gM.prototype.toFontString=function(){var e=typeof this.fontSize==`number`?this.fontSize+`px`:this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(`,`));for(var n=t.length-1;n>=0;n--){var r= __get$(t,n) .trim();!/([\"\'])[^\'\"]+\1/.test(r)&&hM.indexOf(r)<0&&(r=`"`+r+`"`), __set$(t,n,r) }return this.fontStyle+` `+this.fontVariant+` `+this.fontWeight+` `+e+` `+t.join(`,`)},Object.defineProperties(gM.prototype,_M),vM=function(e,t,n,r,i,a,o,s,c){this.text=e,this.style=t,this.width=n,this.height=r,this.lines=i,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=s,this.fontProperties=c},vM.measureText=function(e,t,n,r){r===void 0&&(r=vM._canvas),n??=t.wordWrap;var i=t.toFontString(),a=vM.measureFont(i);a.fontSize===0&&(a.fontSize=t.fontSize,a.ascent=t.fontSize);var o=r.getContext(`2d`);o.font=i;for(var s=(n?vM.wordWrap(e,t,r):e).split(/(?:\r\n|\r|\n)/),c=Array(s.length),l=0,u=0;u<s.length;u++){var d=o.measureText( __get$(s,u) ).width+( __get$(s,u) .length-1)*t.letterSpacing; __set$(c,u,d) ,l=Math.max(l,d)}var f=l+t.strokeThickness;t.dropShadow&&(f+=t.dropShadowDistance);var p=t.lineHeight||a.fontSize+t.strokeThickness,m=Math.max(p,a.fontSize+t.strokeThickness)+(s.length-1)*(p+t.leading);return t.dropShadow&&(m+=t.dropShadowDistance),new vM(e,t,f,m,s,c,p+t.leading,l,a)},vM.wordWrap=function(e,t,n){n===void 0&&(n=vM._canvas);for(var r=n.getContext(`2d`),i=0,a=``,o=``,s={},c=t.letterSpacing,l=t.whiteSpace,u=vM.collapseSpaces(l),d=vM.collapseNewlines(l),f=!u,p=t.wordWrapWidth+c,m=vM.tokenize(e),h=0;h<m.length;h++){var g= __get$(m,h) ;if(vM.isNewline(g)){if(!d){o+=vM.addLine(a),f=!u,a=``,i=0;continue}g=` `}if(u){var _=vM.isBreakingSpace(g),v=vM.isBreakingSpace( __get$(a,a.length-1) );if(_&&v)continue}var y=vM.getFromCache(g,c,s,r);if(y>p)if(a!==``&&(o+=vM.addLine(a),a=``,i=0),vM.canBreakWords(g,t.breakWords))for(var b=vM.wordWrapSplit(g),x=0;x<b.length;x++){for(var S= __get$(b,x) ,C=1; __get$(b,x+C) ;){var w= __get$(b,x+C) ,T= __get$(S,S.length-1) ;if(!vM.canBreakChars(T,w,g,x,t.breakWords))S+=w;else break;C++}x+=S.length-1;var E=vM.getFromCache(S,c,s,r);E+i>p&&(o+=vM.addLine(a),f=!1,a=``,i=0),a+=S,i+=E}else{a.length>0&&(o+=vM.addLine(a),a=``,i=0);var D=h===m.length-1;o+=vM.addLine(g,!D),f=!1,a=``,i=0}else y+i>p&&(f=!1,o+=vM.addLine(a),a=``,i=0),(a.length>0||!vM.isBreakingSpace(g)||f)&&(a+=g,i+=y)}return o+=vM.addLine(a,!1),o},vM.addLine=function(e,t){return t===void 0&&(t=!0),e=vM.trimRight(e),e=t?e+`
`:e,e},vM.getFromCache=function(e,t,n,r){var i= __get$(n,e) ;if(i===void 0){var a=e.length*t;i=r.measureText(e).width+a, __set$(n,e,i) }return i},vM.collapseSpaces=function(e){return e===`normal`||e===`pre-line`},vM.collapseNewlines=function(e){return e===`normal`},vM.trimRight=function(e){if(typeof e!=`string`)return``;for(var t=e.length-1;t>=0;t--){var n= __get$(e,t) ;if(!vM.isBreakingSpace(n))break;e=e.slice(0,-1)}return e},vM.isNewline=function(e){return typeof e==`string`?vM._newlines.indexOf(e.charCodeAt(0))>=0:!1},vM.isBreakingSpace=function(e){return typeof e==`string`?vM._breakingSpaces.indexOf(e.charCodeAt(0))>=0:!1},vM.tokenize=function(e){var t=[],n=``;if(typeof e!=`string`)return t;for(var r=0;r<e.length;r++){var i= __get$(e,r) ;if(vM.isBreakingSpace(i)||vM.isNewline(i)){n!==``&&(t.push(n),n=``),t.push(i);continue}n+=i}return n!==``&&t.push(n),t},vM.canBreakWords=function(e,t){return t},vM.canBreakChars=function(e,t,n,r,i){return!0},vM.wordWrapSplit=function(e){return e.split(``)},vM.measureFont=function(e){if( __get$(vM._fonts,e) )return  __get$(vM._fonts,e) ;var t={},n=vM._canvas,r=vM._context;r.font=e;var i=vM.METRICS_STRING+vM.BASELINE_SYMBOL,a=Math.ceil(r.measureText(i).width),o=Math.ceil(r.measureText(vM.BASELINE_SYMBOL).width),s=2*o;o=o*vM.BASELINE_MULTIPLIER|0,n.width=a,n.height=s,r.fillStyle=`#f00`,r.fillRect(0,0,a,s),r.font=e,r.textBaseline=`alphabetic`,r.fillStyle=`#000`,r.fillText(i,0,o);var c=r.getImageData(0,0,a,s).data,l=c.length,u=a*4,d=0,f=0,p=!1;for(d=0;d<o;++d){for(var m=0;m<u;m+=4)if( __get$(c,f+m) !==255){p=!0;break}if(!p)f+=u;else break}for(t.ascent=o-d,f=l-u,p=!1,d=s;d>o;--d){for(var h=0;h<u;h+=4)if( __get$(c,f+h) !==255){p=!0;break}if(!p)f-=u;else break}return t.descent=d-o,t.fontSize=t.ascent+t.descent, __set$(vM._fonts,e,t) ,t},vM.clearMetrics=function(e){e===void 0&&(e=``),e?delete vM._fonts[e]:vM._fonts={}},yM=function(){try{var e=new OffscreenCanvas(0,0),t=e.getContext(`2d`);return t&&t.measureText?e:document.createElement(`canvas`)}catch{return document.createElement(`canvas`)}}(),yM.width=yM.height=10,vM._canvas=yM,vM._context=yM.getContext(`2d`),vM._fonts={},vM.METRICS_STRING=`|q`,vM.BASELINE_SYMBOL=`M`,vM.BASELINE_MULTIPLIER=1.4,vM._newlines=[10,13],vM._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],bM={texture:!0,children:!1,baseTexture:!0},xM=function(e){function t(t,n,r){r||=document.createElement(`canvas`),r.width=3,r.height=3;var i=dD.from(r);i.orig=new jE,i.trim=new jE,e.call(this,i),this.canvas=r,this.context=this.canvas.getContext(`2d`),this._resolution=hT.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font=``,this.text=t,this.style=n,this.localStyleID=-1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}};return t.prototype.updateText=function(e){var t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!(!this.dirty&&e)){this._font=this._style.toFontString();var n=this.context,r=vM.measureText(this._text||` `,this._style,this._style.wordWrap,this.canvas),i=r.width,a=r.height,o=r.lines,s=r.lineHeight,c=r.lineWidths,l=r.maxLineWidth,u=r.fontProperties;this.canvas.width=Math.ceil((Math.max(1,i)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+t.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=t.strokeThickness,n.textBaseline=t.textBaseline,n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit;for(var d,f,p=t.dropShadow?2:1,m=0;m<p;++m){var h=t.dropShadow&&m===0,g=h?a*2:0,_=g*this.resolution;if(h){n.fillStyle=`black`,n.strokeStyle=`black`;var v=t.dropShadowColor,y=ly(typeof v==`number`?v:dy(v));n.shadowColor=`rgba(`+y[0]*255+`,`+y[1]*255+`,`+y[2]*255+`,`+t.dropShadowAlpha+`)`,n.shadowBlur=t.dropShadowBlur,n.shadowOffsetX=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,n.shadowOffsetY=Math.sin(t.dropShadowAngle)*t.dropShadowDistance+_}else n.fillStyle=this._generateFillStyle(t,o),n.strokeStyle=t.stroke,n.shadowColor=0,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var b=0;b<o.length;b++)d=t.strokeThickness/2,f=t.strokeThickness/2+b*s+u.ascent,t.align===`right`?d+=l- __get$(c,b) :t.align===`center`&&(d+=(l- __get$(c,b) )/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing( __get$(o,b) ,d+t.padding,f+t.padding-g,!0),t.fill&&this.drawLetterSpacing( __get$(o,b) ,d+t.padding,f+t.padding-g)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,t,n,r){r===void 0&&(r=!1);var i=this._style.letterSpacing;if(i===0){r?this.context.strokeText(e,t,n):this.context.fillText(e,t,n);return}for(var a=t,o=Array.from?Array.from(e):e.split(``),s=this.context.measureText(e).width,c=0,l=0;l<o.length;++l){var u= __get$(o,l) ;r?this.context.strokeText(u,a,n):this.context.fillText(u,a,n),c=this.context.measureText(e.substring(l+1)).width,a+=s-c+i,s=c}},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var t=Ey(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}var n=this._texture,r=this._style,i=r.trim?0:r.padding,a=n.baseTexture;n.trim.width=n._frame.width=Math.ceil(e.width/this._resolution),n.trim.height=n._frame.height=Math.ceil(e.height/this._resolution),n.trim.x=-i,n.trim.y=-i,n.orig.width=n._frame.width-i*2,n.orig.height=n._frame.height-i*2,this._onTextureUpdate(),a.setRealSize(e.width,e.height,this._resolution),this.dirty=!1},t.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),e.prototype._render.call(this,t)},t.prototype.getLocalBounds=function(t){return this.updateText(!0),e.prototype.getLocalBounds.call(this,t)},t.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._onStyleChange=function(){this.dirty=!0},t.prototype._generateFillStyle=function(e,t){if(Array.isArray(e.fill)){if(e.fill.length===1)return e.fill[0]}else return e.fill;var n,r,i,a,o=e.dropShadow?e.dropShadowDistance:0,s=Math.ceil(this.canvas.width/this._resolution)-o,c=Math.ceil(this.canvas.height/this._resolution)-o,l=e.fill.slice(),u=e.fillGradientStops.slice();if(!u.length)for(var d=l.length+1,f=1;f<d;++f)u.push(f/d);if(l.unshift(e.fill[0]),u.unshift(0),l.push( __get$(e.fill,e.fill.length-1) ),u.push(1),e.fillGradientType===pM.LINEAR_VERTICAL){n=this.context.createLinearGradient(s/2,0,s/2,c),r=(l.length+1)*t.length,i=0;for(var p=0;p<t.length;p++){i+=1;for(var m=0;m<l.length;m++)a=typeof  __get$(u,m) ==`number`? __get$(u,m) /t.length+p/t.length:i/r,n.addColorStop(a, __get$(l,m) ),i++}}else{n=this.context.createLinearGradient(0,c/2,s,c/2),r=l.length+1,i=1;for(var h=0;h<l.length;h++)a=typeof  __get$(u,h) ==`number`? __get$(u,h) :i/r,n.addColorStop(a, __get$(l,h) ),i++}return n},t.prototype.destroy=function(t){typeof t==`boolean`&&(t={children:t}),t= __call$(Object,"assign",[{},bM,t]) ,e.prototype.destroy.call(this,t),this.context=null,this.canvas=null,this._style=null},n.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},n.width.set=function(e){this.updateText(!0);var t=Cy(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e},n.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},n.height.set=function(e){this.updateText(!0);var t=Cy(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e},n.style.get=function(){return this._style},n.style.set=function(e){e||={},e instanceof gM?this._style=e:this._style=new gM(e),this.localStyleID=-1,this.dirty=!0},n.text.get=function(){return this._text},n.text.set=function(e){e=String(e??``),this._text!==e&&(this._text=e,this.dirty=!0)},n.resolution.get=function(){return this._resolution},n.resolution.set=function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},Object.defineProperties(t.prototype,n),t}(fM),hT.UPLOADS_PER_FRAME=4,SM=function(e){this.maxItemsPerFrame=e,this.itemsLeft=0},SM.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},SM.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},CM=function(e){var t=this;this.limiter=new SM(hT.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){t.queue&&t.prepareItems()},this.registerFindHook(OA),this.registerFindHook(kA),this.registerFindHook(CA),this.registerFindHook(wA),this.registerFindHook(TA),this.registerUploadHook(EA),this.registerUploadHook(DA)},CM.prototype.upload=function(e,t){typeof e==`function`&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),this.ticking||(this.ticking=!0,VE.system.addOnce(this.tick,this,zE.UTILITY))):t&&t()},CM.prototype.tick=function(){setTimeout(this.delayedTick,0)},CM.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed){for(var n=0,r=this.uploadHooks.length;n<r;n++)if( __call$(this.uploadHooks,n,[this.uploadHookHelper,e]) ){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)VE.system.addOnce(this.tick,this,zE.UTILITY);else{this.ticking=!1;var i=this.completes.slice(0);this.completes.length=0;for(var a=0,o=i.length;a<o;a++) __call$(i,a,[]) }},CM.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},CM.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},CM.prototype.add=function(e){for(var t=0,n=this.addHooks.length;t<n&&! __call$(this.addHooks,t,[e,this.queue]) ;t++);if(e instanceof RE)for(var r=e.children.length-1;r>=0;r--)this.add( __get$(e.children,r) );return this},CM.prototype.destroy=function(){this.ticking&&VE.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},wM=function(e){function t(t){e.call(this,t),this.uploadHookHelper=this.renderer,this.registerFindHook(MA),this.registerUploadHook(AA),this.registerUploadHook(jA)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(CM),TM=function(e,t,n){n===void 0&&(n=null),this.baseTexture=e,this.textures={},this.animations={},this.data=t,this.resolution=this._updateResolution(n||(this.baseTexture.resource?this.baseTexture.resource.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null},EM={BATCH_SIZE:{configurable:!0}},EM.BATCH_SIZE.get=function(){return 1e3},TM.prototype._updateResolution=function(e){var t=this.data.meta.scale,n=Oy(e,null);return n===null&&(n=t===void 0?1:parseFloat(t)),n!==1&&this.baseTexture.setResolution(n),n},TM.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=TM.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},TM.prototype._processFrames=function(e){for(var t=e,n=TM.BATCH_SIZE;t-e<n&&t<this._frameKeys.length;){var r= __get$(this._frameKeys,t) ,i= __get$(this._frames,r) ,a=i.frame;if(a){var o=null,s=null,c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,l=new jE(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);o=i.rotated?new jE(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):new jE(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(s=new jE(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)), __set$(this.textures,r,new dD(this.baseTexture,o,l,s,i.rotated?2:0,i.anchor)) ,dD.addToCache( __get$(this.textures,r) ,r)}t++}},TM.prototype._processAnimations=function(){var e=this.data.animations||{};for(var t in e){ __set$(this.animations,t,[]) ;for(var n=0;n< __get$(e,t) .length;n++){var r= __get$(__get$(e,t),n) ; __get$(this.animations,t) .push( __get$(this.textures,r) )}}},TM.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},TM.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*TM.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*TM.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},TM.prototype.destroy=function(e){for(var t in e===void 0&&(e=!1),this.textures) __get$(this.textures,t) .destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&this.baseTexture.destroy(),this.baseTexture=null},Object.defineProperties(TM,EM),DM=function(){},DM.use=function(e,t){var n=e.name+`_image`;if(!e.data||e.type!==Lj.TYPE.JSON||!e.data.frames|| __get$(this.resources,n) ){t();return}var r={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},i=DM.getResourcePath(e,this.baseUrl);this.add(n,i,r,function(n){if(n.error){t(n.error);return}var r=new TM(n.texture.baseTexture,e.data,e.url);r.parse(function(){e.spritesheet=r,e.textures=r.textures,t()})})},DM.getResourcePath=function(e,t){return e.isDataUrl?e.data.meta.image:bT.resolve( __call$(e.url,"replace",[t,``]) ,e.data.meta.image)},new hE,OM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,kM=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord - floor(vTextureCoord - uClampOffset);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture2D(uSampler, coord);
    gl_FragColor = texSample * uColor;
}
`,AM=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 sample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = sample * uColor;
}
`,jM=new xE,MM=function(e){function t(t){e.call(this,t);var n={globals:this.renderer.globalUniforms};this.shader=$D.from(OM,kM,n),this.simpleShader=$D.from(OM,AM,n),this.quad=new CD,this.state=oO.for2d()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(e){var t=this.renderer,n=this.quad,r=n.vertices;r[0]=r[6]=e._width*-e.anchor.x,r[1]=r[3]=e._height*-e.anchor.y,r[2]=r[4]=e._width*(1-e.anchor.x),r[5]=r[7]=e._height*(1-e.anchor.y),e.uvRespectAnchor&&(r=n.uvs,r[0]=r[6]=-e.anchor.x,r[1]=r[3]=-e.anchor.y,r[2]=r[4]=1-e.anchor.x,r[5]=r[7]=1-e.anchor.y),n.invalidate();var i=e._texture,a=i.baseTexture,o=e.tileTransform.localTransform,s=e.uvMatrix,c=a.isPowerOfTwo&&i.frame.width===a.width&&i.frame.height===a.height;c&&( __get$(a._glTextures,t.CONTEXT_UID) ?c=a.wrapMode!==QT.CLAMP:a.wrapMode===QT.CLAMP&&(a.wrapMode=QT.REPEAT));var l=c?this.simpleShader:this.shader,u=i.width,d=i.height,f=e._width,p=e._height;jM.set(o.a*u/f,o.b*u/p,o.c*d/f,o.d*d/p,o.tx/f,o.ty/p),jM.invert(),c?jM.prepend(s.mapCoord):(l.uniforms.uMapCoord=s.mapCoord.toArray(!0),l.uniforms.uClampFrame=s.uClampFrame,l.uniforms.uClampOffset=s.uClampOffset),l.uniforms.uTransform=jM.toArray(!0),l.uniforms.uColor=_y(e.tint,e.worldAlpha,l.uniforms.uColor,a.alphaMode),l.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),l.uniforms.uSampler=i,t.shader.bind(l),t.geometry.bind(n),this.state.blendMode=my(e.blendMode,a.alphaMode),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t}(OD),NM=function(e){function t(t,n){var r=this;n===void 0&&(n={}),e.call(this),this._textWidth=0,this._textHeight=0,this._glyphs=[],this._font={tint:n.tint===void 0?16777215:n.tint,align:n.align||`left`,name:null,size:0},this.font=n.font,this._text=t,this._maxWidth=0,this._maxLineHeight=0,this._letterSpacing=0,this._anchor=new gE(function(){r.dirty=!0},this,0,0),this.dirty=!1,this.roundPixels=hT.ROUND_PIXELS,this.updateText()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={tint:{configurable:!0},align:{configurable:!0},anchor:{configurable:!0},font:{configurable:!0},text:{configurable:!0},maxWidth:{configurable:!0},maxLineHeight:{configurable:!0},textWidth:{configurable:!0},letterSpacing:{configurable:!0},textHeight:{configurable:!0}};return t.prototype.updateText=function(){for(var e= __get$(t.fonts,this._font.name) ,n=this._font.size/e.size,r=new hE,i=[],a=[],o= __call$(this._text,"replace",[/(?:\r\n|\r)/g,`
`]) ||` `,s=o.length,c=this._maxWidth*e.size/this._font.size,l=null,u=0,d=0,f=0,p=-1,m=0,h=0,g=0,_=0;_<s;_++){var v=o.charCodeAt(_),y=o.charAt(_);if(/(?:\s)/.test(y)&&(p=_,m=u),y===`\r`||y===`
`){a.push(u),d=Math.max(d,u),++f,++h,r.x=0,r.y+=e.lineHeight,l=null;continue}var b= __get$(e.chars,v) ;b&&(l&& __get$(b.kerning,l) &&(r.x+= __get$(b.kerning,l) ),i.push({texture:b.texture,line:f,charCode:v,position:new hE(r.x+b.xOffset+this._letterSpacing/2,r.y+b.yOffset)}),r.x+=b.xAdvance+this._letterSpacing,u=r.x,g=Math.max(g,b.yOffset+b.texture.height),l=v,p!==-1&&c>0&&r.x>c&&(++h,Sy(i,1+p-h,1+_-p),_=p,p=-1,a.push(m),d=Math.max(d,m),f++,r.x=0,r.y+=e.lineHeight,l=null))}var x=o.charAt(o.length-1);x!==`\r`&&x!==`
`&&(/(?:\s)/.test(x)&&(u=m),a.push(u),d=Math.max(d,u));for(var S=[],C=0;C<=f;C++){var w=0;this._font.align===`right`?w=d- __get$(a,C) :this._font.align===`center`&&(w=(d- __get$(a,C) )/2),S.push(w)}for(var T=i.length,E=this.tint,D=0;D<T;D++){var O= __get$(this._glyphs,D) ;O?O.texture= __get$(i,D) .texture:(O= new fM(__get$(i,D).texture) ,O.roundPixels=this.roundPixels,this._glyphs.push(O)),O.position.x=( __get$(i,D) .position.x+ __get$(S,__get$(i,D).line) )*n,O.position.y= __get$(i,D) .position.y*n,O.scale.x=O.scale.y=n,O.tint=E,O.parent||this.addChild(O)}for(var k=T;k<this._glyphs.length;++k)this.removeChild( __get$(this._glyphs,k) );if(this._textWidth=d*n,this._textHeight=(r.y+e.lineHeight)*n,this.anchor.x!==0||this.anchor.y!==0)for(var ee=0;ee<T;ee++) __get$(this._glyphs,ee) .x-=this._textWidth*this.anchor.x, __get$(this._glyphs,ee) .y-=this._textHeight*this.anchor.y;this._maxLineHeight=g*n},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype.getLocalBounds=function(){return this.validate(),e.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&=(this.updateText(),!1)},n.tint.get=function(){return this._font.tint},n.tint.set=function(e){this._font.tint=typeof e==`number`&&e>=0?e:16777215,this.dirty=!0},n.align.get=function(){return this._font.align},n.align.set=function(e){this._font.align=e||`left`,this.dirty=!0},n.anchor.get=function(){return this._anchor},n.anchor.set=function(e){typeof e==`number`?this._anchor.set(e):this._anchor.copyFrom(e)},n.font.get=function(){return this._font},n.font.set=function(e){e&&(typeof e==`string`?(e=e.split(` `),this._font.name=e.length===1?e[0]:e.slice(1).join(` `),this._font.size=e.length>=2?parseInt(e[0],10): __get$(t.fonts,this._font.name) .size):(this._font.name=e.name,this._font.size=typeof e.size==`number`?e.size:parseInt(e.size,10)),this.dirty=!0)},n.text.get=function(){return this._text},n.text.set=function(e){e=String(e??``),this._text!==e&&(this._text=e,this.dirty=!0)},n.maxWidth.get=function(){return this._maxWidth},n.maxWidth.set=function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},n.maxLineHeight.get=function(){return this.validate(),this._maxLineHeight},n.textWidth.get=function(){return this.validate(),this._textWidth},n.letterSpacing.get=function(){return this._letterSpacing},n.letterSpacing.set=function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},n.textHeight.get=function(){return this.validate(),this._textHeight},t.registerFont=function(e,n){var r={},i=e.getElementsByTagName(`info`)[0],a=e.getElementsByTagName(`common`)[0],o=e.getElementsByTagName(`page`),s=Oy(o[0].getAttribute(`file`),hT.RESOLUTION),c={};r.font=i.getAttribute(`face`),r.size=parseInt(i.getAttribute(`size`),10),r.lineHeight=parseInt(a.getAttribute(`lineHeight`),10)/s,r.chars={},n instanceof dD&&(n=[n]);for(var l=0;l<o.length;l++){var u= __get$(o,l) .getAttribute(`id`),d= __get$(o,l) .getAttribute(`file`); __set$(c,u,n instanceof Array?__get$(n,l):__get$(n,d)) }for(var f=e.getElementsByTagName(`char`),p=0;p<f.length;p++){var m= __get$(f,p) ,h=parseInt(m.getAttribute(`id`),10),g=m.getAttribute(`page`)||0,_= new jE(parseInt(m.getAttribute(`x`),10)/s+__get$(c,g).frame.x/s,parseInt(m.getAttribute(`y`),10)/s+__get$(c,g).frame.y/s,parseInt(m.getAttribute(`width`),10)/s,parseInt(m.getAttribute(`height`),10)/s) ; __set$(r.chars,h,{xOffset:parseInt(m.getAttribute(`xoffset`),10)/s,yOffset:parseInt(m.getAttribute(`yoffset`),10)/s,xAdvance:parseInt(m.getAttribute(`xadvance`),10)/s,kerning:{},texture:new dD(__get$(c,g).baseTexture,_),page:g}) }for(var v=e.getElementsByTagName(`kerning`),y=0;y<v.length;y++){var b= __get$(v,y) ,x=parseInt(b.getAttribute(`first`),10)/s,S=parseInt(b.getAttribute(`second`),10)/s,C=parseInt(b.getAttribute(`amount`),10)/s; __get$(r.chars,S) &&( __set$(__get$(r.chars,S).kerning,x,C) )}return  __set$(t.fonts,r.font,r) ,r},Object.defineProperties(t.prototype,n),t}(RE),NM.fonts={},PM=function(){},PM.parse=function(e,t){e.bitmapFont=NM.registerFont(e.data,t)},PM.add=function(){Lj.setExtensionXhrType(`fnt`,Lj.XHR_RESPONSE_TYPE.DOCUMENT)},PM.dirname=function(e){var t= __call$(__call$(__call$(e,"replace",[/\\/g,`/`]),"replace",[/\/$/,``]),"replace",[/\/[^\/]*$/,``]) ;return t===e?`.`:t===``?`/`:t},PM.use=function(e,t){if(!e.data||e.type!==Lj.TYPE.XML){t();return}if(e.data.getElementsByTagName(`page`).length===0||e.data.getElementsByTagName(`info`).length===0||e.data.getElementsByTagName(`info`)[0].getAttribute(`face`)===null){t();return}var n=e.isDataUrl?``:PM.dirname(e.url);e.isDataUrl&&(n===`.`&&(n=``),this.baseUrl&&n&&this.baseUrl.charAt(this.baseUrl.length-1)===`/`&&(n+=`/`)),n= __call$(n,"replace",[this.baseUrl,``]) ,n&&n.charAt(n.length-1)!==`/`&&(n+=`/`);for(var r=e.data.getElementsByTagName(`page`),i={},a=function(n){ __set$(i,n.metadata.pageFile,n.texture) ,Object.keys(i).length===r.length&&(PM.parse(e,i),t())},o=0;o<r.length;++o){var s= __get$(r,o) .getAttribute(`file`),c=n+s,l=!1;for(var u in this.resources){var d= __get$(this.resources,u) ;if(d.url===c){d.metadata.pageFile=s,d.texture?a(d):d.onAfterMiddleware.add(a),l=!0;break}}if(!l){var f={crossOrigin:e.crossOrigin,loadType:Lj.LOAD_TYPE.IMAGE,metadata: __call$(Object,"assign",[{pageFile:s},e.metadata.imageMetadata]) ,parentResource:e};this.add(c,f,a)}}},FM=new xE,LE.prototype._cacheAsBitmap=!1,LE.prototype._cacheData=!1,IM=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null},Object.defineProperties(LE.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(e){if(this._cacheAsBitmap!==e){this._cacheAsBitmap=e;var t;e?(this._cacheData||=new IM,t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}}),LE.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},LE.prototype._initCachedDisplayObject=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.alpha;this.alpha=1,e.batch.flush();var n=this.getLocalBounds().clone();if(this.filters){var r=this.filters[0].padding;n.pad(r)}n.ceil(hT.RESOLUTION);var i=e.renderTexture.current,a=e.renderTexture.sourceFrame,o=e.projection.transform,s=fD.create(n.width,n.height),c=`cacheAsBitmap_`+wy();this._cacheData.textureCacheId=c,ZE.addToCache(s.baseTexture,c),dD.addToCache(s,c);var l=FM;l.tx=-n.x,l.ty=-n.y,this.transform.worldTransform.identity(),this.render=this._cacheData.originalRender,e.render(this,s,!0,l,!0),e.projection.transform=o,e.renderTexture.bind(i,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var u=new fM(s);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(n.x/n.width),u.anchor.y=-(n.y/n.height),u.alpha=t,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}},LE.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},LE.prototype._initCachedDisplayObjectCanvas=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.getLocalBounds(),n=this.alpha;this.alpha=1;var r=e.context;t.ceil(hT.RESOLUTION);var i=fD.create(t.width,t.height),a=`cacheAsBitmap_`+wy();this._cacheData.textureCacheId=a,ZE.addToCache(i.baseTexture,a),dD.addToCache(i,a);var o=FM;this.transform.localTransform.copyTo(o),o.invert(),o.tx-=t.x,o.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,i,!0,o,!1),e.context=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var s=new fM(i);s.transform.worldTransform=this.transform.worldTransform,s.anchor.x=-(t.x/t.width),s.anchor.y=-(t.y/t.height),s.alpha=n,s._bounds=this._bounds,this._cacheData.sprite=s,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=s.containsPoint.bind(s)}},LE.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID},LE.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},LE.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ZE.removeFromCache(this._cacheData.textureCacheId),dD.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},LE.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},LE.prototype.name=null,RE.prototype.getChildByName=function(e){for(var t=0;t<this.children.length;t++)if( __get$(this.children,t) .name===e)return  __get$(this.children,t) ;return null},LE.prototype.getGlobalPosition=function(e,t){return e===void 0&&(e=new hE),t===void 0&&(t=!1),this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e},LM=function(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0},LM.prototype.update=function(e){if(!(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}},RM=new hE,zM=new PE,BM=function(e){function t(t,n,r,i){i===void 0&&(i=qT.TRIANGLES),e.call(this),this.geometry=t,t.refCount++,this.shader=n,this.state=r||oO.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=0,this._transformID=-1,this.tint=16777215,this.blendMode=KT.NORMAL,this._roundPixels=hT.ROUND_PIXELS,this.batchUvs=null}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={uvBuffer:{configurable:!0},verticesBuffer:{configurable:!0},material:{configurable:!0},blendMode:{configurable:!0},roundPixels:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return n.uvBuffer.get=function(){return this.geometry.buffers[1]},n.verticesBuffer.get=function(){return this.geometry.buffers[0]},n.material.set=function(e){this.shader=e},n.material.get=function(){return this.shader},n.blendMode.set=function(e){this.state.blendMode=e},n.blendMode.get=function(){return this.state.blendMode},n.roundPixels.set=function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},n.roundPixels.get=function(){return this._roundPixels},n.tint.get=function(){return this.shader.tint},n.tint.set=function(e){this.shader.tint=e},n.texture.get=function(){return this.shader.texture},n.texture.set=function(e){this.shader.texture=e},t.prototype._render=function(e){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===qT.TRIANGLES&&n.length<t.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)},t.prototype._renderDefault=function(e){var t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.program.uniformData.translationMatrix&&(t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},t.prototype._renderToBatch=function(e){var t=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var n=this.material.pluginName;e.batch.setObjectRenderer( __get$(e.plugins,n) ), __get$(e.plugins,n) .render(this)},t.prototype.calculateVertices=function(){var e=this.geometry,t=e.buffers[0].data;if(!(e.vertexDirtyId===this.vertexDirty&&this._transformID===this.transform._worldID)){this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));for(var n=this.transform.worldTransform,r=n.a,i=n.b,a=n.c,o=n.d,s=n.tx,c=n.ty,l=this.vertexData,u=0;u<l.length/2;u++){var d= __get$(t,u*2) ,f= __get$(t,u*2+1) ; __set$(l,u*2,r*d+a*f+s) , __set$(l,u*2+1,i*d+o*f+c) }if(this._roundPixels)for(var p=hT.RESOLUTION,m=0;m<l.length;++m) __set$(l,m,Math.round((__get$(l,m)*p|0)/p)) ;this.vertexDirty=e.vertexDirtyId}},t.prototype.calculateUvs=function(){var e=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||=new LM(e,this.shader.uvMatrix),this.batchUvs.update(),this.uvs=this.batchUvs.data)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},t.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,RM);for(var t=this.geometry.getBuffer(`aVertexPosition`).data,n=zM.points,r=this.geometry.getIndex().data,i=r.length,a=this.drawMode===4?3:1,o=0;o+2<i;o+=a){var s= __get$(r,o) *2,c= __get$(r,o+1) *2,l= __get$(r,o+2) *2;if(n[0]= __get$(t,s) ,n[1]= __get$(t,s+1) ,n[2]= __get$(t,c) ,n[3]= __get$(t,c+1) ,n[4]= __get$(t,l) ,n[5]= __get$(t,l+1) ,zM.contains(RM.x,RM.y))return!0}return!1},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.geometry.refCount--,this.geometry.refCount===0&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Object.defineProperties(t.prototype,n),t}(RE),BM.BATCHABLE_SIZE=100,VM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,HM=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,UM=function(e){function t(t,n){var r={uSampler:t,alpha:1,uTextureMatrix:xE.IDENTITY,uColor:new Float32Array([1,1,1,1])};n= __call$(Object,"assign",[{tint:16777215,alpha:1,pluginName:`batch`},n]) ,n.uniforms&& __call$(Object,"assign",[r,n.uniforms]) ,e.call(this,n.program||ZD.from(VM,HM),r),this._colorDirty=!1,this.uvMatrix=new mO(t),this.batchable=n.program===void 0,this.pluginName=n.pluginName,this.tint=n.tint,this.alpha=n.alpha}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={texture:{configurable:!0},alpha:{configurable:!0},tint:{configurable:!0}};return n.texture.get=function(){return this.uniforms.uSampler},n.texture.set=function(e){this.uniforms.uSampler!==e&&(this.uniforms.uSampler=e,this.uvMatrix.texture=e)},n.alpha.set=function(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)},n.alpha.get=function(){return this._alpha},n.tint.set=function(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16),this._colorDirty=!0)},n.tint.get=function(){return this._tint},t.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var e=this.texture.baseTexture;_y(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},Object.defineProperties(t.prototype,n),t}($D),WM=function(e){function t(t,n,r){t===void 0&&(t=200),r===void 0&&(r=0),e.call(this,new Float32Array(n.length*4),new Float32Array(n.length*4),new Uint16Array((n.length-1)*6)),this.points=n,this.width=t,this.textureScale=r,this.build()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.build=function(){var e=this.points;if(e){var t=this.getBuffer(`aVertexPosition`),n=this.getBuffer(`aTextureCoord`),r=this.getIndex();if(!(e.length<1)){t.data.length/4!==e.length&&(t.data=new Float32Array(e.length*4),n.data=new Float32Array(e.length*4),r.data=new Uint16Array((e.length-1)*6));var i=n.data,a=r.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;for(var o=0,s=e[0],c=this.width*this.textureScale,l=e.length,u=0;u<l;u++){var d=u*4;if(this.textureScale>0){var f=s.x- __get$(e,u) .x,p=s.y- __get$(e,u) .y,m=Math.sqrt(f*f+p*p);s= __get$(e,u) ,o+=m/c}else o=u/(l-1); __set$(i,d,o) , __set$(i,d+1,0) , __set$(i,d+2,o) , __set$(i,d+3,1) }for(var h=0,g=0;g<l-1;g++){var _=g*2; __set$(a,h++,_) , __set$(a,h++,_+1) , __set$(a,h++,_+2) , __set$(a,h++,_+2) , __set$(a,h++,_+1) , __set$(a,h++,_+3) }n.update(),r.update(),this.updateVertices()}}},t.prototype.updateVertices=function(){var e=this.points;if(!(e.length<1)){for(var t=e[0],n,r=0,i=0,a=this.buffers[0].data,o=e.length,s=0;s<o;s++){var c= __get$(e,s) ,l=s*4;n=s<e.length-1? __get$(e,s+1) :c,i=-(n.x-t.x),r=n.y-t.y;var u=Math.sqrt(r*r+i*i),d=this.textureScale>0?this.textureScale*this.width/2:this.width/2;r/=u,i/=u,r*=d,i*=d, __set$(a,l,c.x+r) , __set$(a,l+1,c.y+i) , __set$(a,l+2,c.x-r) , __set$(a,l+3,c.y-i) ,t=c}this.buffers[0].update()}},t.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},t}(function(e){function t(t,n,r){e.call(this);var i=new gD(t),a=new gD(n,!0),o=new gD(r,!0,!0);this.addAttribute(`aVertexPosition`,i,2,!1,XT.FLOAT).addAttribute(`aTextureCoord`,a,2,!1,XT.FLOAT).addIndex(o),this._updateId=-1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={vertexDirtyId:{configurable:!0}};return n.vertexDirtyId.get=function(){return this.buffers[0]._updateID},Object.defineProperties(t.prototype,n),t}(xD)),GM=function(e){function t(t,n){e.call(this,t[0]instanceof dD?t[0]:t[0].texture),this._textures=null,this._durations=null,this.textures=t,this._autoUpdate=n!==!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this.playing=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={totalFrames:{configurable:!0},textures:{configurable:!0},currentFrame:{configurable:!0}};return t.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&VE.shared.remove(this.update,this))},t.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&VE.shared.add(this.update,this,zE.HIGH))},t.prototype.gotoAndStop=function(e){this.stop();var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){var t=this.animationSpeed*e,n=this.currentFrame;if(this._durations!==null){var r=this._currentTime%1* __get$(this._durations,this.currentFrame) ;for(r+=t/60*1e3;r<0;)this._currentTime--,r+= __get$(this._durations,this.currentFrame) ;var i=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);r>= __get$(this._durations,this.currentFrame) ;)r-= __get$(this._durations,this.currentFrame) *i,this._currentTime+=i;this._currentTime+=r/ __get$(this._durations,this.currentFrame) }else this._currentTime+=t;this._currentTime<0&&!this.loop?(this._currentTime=0,this.stop(),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this._currentTime=this._textures.length-1,this.stop(),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())},t.prototype.updateTexture=function(){this._texture= __get$(this._textures,this.currentFrame) ,this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame)},t.prototype.destroy=function(t){this.stop(),e.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},t.fromFrames=function(e){for(var n=[],r=0;r<e.length;++r)n.push(dD.from( __get$(e,r) ));return new t(n)},t.fromImages=function(e){for(var n=[],r=0;r<e.length;++r)n.push(dD.from( __get$(e,r) ));return new t(n)},n.totalFrames.get=function(){return this._textures.length},n.textures.get=function(){return this._textures},n.textures.set=function(e){if(e[0]instanceof dD)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var t=0;t<e.length;t++)this._textures.push( __get$(e,t) .texture),this._durations.push( __get$(e,t) .time)}this.gotoAndStop(0),this.updateTexture()},n.currentFrame.get=function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},Object.defineProperties(t.prototype,n),t}(fM),RO.registerPlugin(`accessibility`,ej),RO.registerPlugin(`extract`,hj),RO.registerPlugin(`interaction`,lj),RO.registerPlugin(`particle`,Vj),RO.registerPlugin(`prepare`,wM),RO.registerPlugin(`batch`,XO),RO.registerPlugin(`tilingSprite`,MM),Fj.registerPlugin(PM),Fj.registerPlugin(DM),uj.registerPlugin(HE),uj.registerPlugin(Ij)}));function qM(e, _hh$temp967 ){ var t=_hh$temp967.options,n=_hh$temp967.boardThemes,r=_hh$temp967.pieceThemes; return{animatedOverPiece:null,animatedOverHint:null,animator:Tn(!0),attackedKing:null,arrows:{},assetsLoaded:!1,blinkingHighlights:{},boardId:t.id||`webglBoard`,boardStyle:t.boardStyle,boardThemes:n,containerEl:e,customItems:{},destroyed:!1,effects:{},fadeSetupAnimation:null,flipCoordinates:!1,highlights:{},hints:{},hoverSquare:null,isBoardFlipped:t.flipped,isBoardEnabled:t.enabled,isCheckmate:!1,isPromotionWindowVisible:!1,options:t,pieceAnimations:{},pieces:{},pieceStyle:t.pieceStyle,pieceThemes:r,pointer:{boardPosition:{x:0,y:0},down:!1,downInsideBoard:!1,event:new Event(``),insideBoard:!1,previousBoardPosition:{x:0,y:0},previousViewPosition:{x:0,y:0},rightDown:!1,secondaryDown:!1,viewPosition:{x:0,y:0}},promotionWindowAnimation:null,selectedPiece:null,squareSize:0,viewEl:document.createElement(`canvas`),viewSize:{width:Kb.Board.DefaultWidth,height:Kb.Board.DefaultHeight}}}function JM(e, _hh$temp968 ){ var t=_hh$temp968.item,n=_hh$temp968.animation,r=_hh$temp968.type,i=_hh$temp968.onEnd;  let _hh$temp969=e,a=_hh$temp969.animator; t.activeAnimation&&a.end(t.activeAnimation.animation),t.activeAnimation={animation:n,type:r},n.onEnd(()=>{i?.(n),t.activeAnimation=void 0})}function YM(e, _hh$temp970 ){ var t=_hh$temp970.piece,n=_hh$temp970.type,r=_hh$temp970.animation,i=_hh$temp970.onEnd;  let _hh$temp971=e,a=_hh$temp971.state,_hh$temp972=a,o=_hh$temp972.animator,s=_hh$temp972.pieceAnimations;  __get$(s,t.id) &&! __get$(s,t.id) .animation.ended&&o.end( __get$(s,t.id) .animation), __set$(s,t.id,{animation:r,type:n}) ,r.onEnd(e=>{i?.(e), __get$(s,t.id) && __get$(s,t.id) .animation===e&&delete s[t.id]})}function XM(e,t){ let _hh$temp973=e,n=_hh$temp973.animator,r=_hh$temp973.pieceAnimations; Object.keys(r).forEach(e=>{let i= __get$(r,e) ;t&&t!==i.type||(n.end(i.animation),delete r[e])})}function ZM(e,t){ let _hh$temp974=e,n=_hh$temp974.animator; t.activeAnimation&&n.end(t.activeAnimation.animation),t.activeAnimation=void 0}function QM(e,t){ let _hh$temp975=e,n=_hh$temp975.animator,r=_hh$temp975.pieceAnimations,i=__get$(r,t.id); !i||i.animation.ended||n.end(i.animation)}function $M(e,t){ let _hh$temp976=e,n=_hh$temp976.state,_hh$temp977=n,r=_hh$temp977.animator; if(t===tx.Move){ let _hh$temp978=n,e=_hh$temp978.pieceAnimations,t=0; return Object.values(e).forEach(e=>{ let _hh$temp979=e,n=_hh$temp979.animation,r=_hh$temp979.type; [CP.Piece.Animation.Type.Capture,CP.Piece.Animation.Type.Drop,CP.Piece.Animation.Type.Move,CP.Piece.Animation.Type.Restore].includes(r)&&n&&!n.ended&&t++}),t>0}return r.playingAnimationsCount()>0}function eN(e, _hh$temp980 ){ var t=_hh$temp980.piece,n=_hh$temp980.type;  let _hh$temp981=e,r=_hh$temp981.pieceAnimations; if(t){let e= __get$(r,t.id) ;return!(!e||e.animation.ended||n&&n!==e.type)}else if(n){let e=Object.values(r);for(let t=0;t<e.length;t++)if( __get$(e,t) .type===n)return!0;return!1}return!1}function tN(e,t){ let _hh$temp982=e,n=_hh$temp982.squareSize; return t.x>=0&&t.x<=n*8&&t.y>=0&&t.y<=n*8}function nN(e,t){ let _hh$temp983=e,n=_hh$temp983.state,r=_hh$temp983.methods; return fv(r.positionToFileRank(n,t))}function rN(e,t){let n=Math.floor(e.x),r=Math.floor(e.y),i={left:Math.floor(n/t)*t,top:Math.floor(r/t)*t},a={left:n-i.left,top:r-i.top};return{x:Math.floor(a.left/t*100),y:Math.floor(a.top/t*100)}}function iN(e,t){let n=document.createElement(`div`);n.innerHTML=e;let r=n.querySelector(`svg`);if(!r)return e;if(t.color&&(r.style.fill=t.color),t.opacity&&(r.style.opacity=String(t.opacity)),t.text){let e=r.querySelector(`text`);e&&(e.innerHTML=t.text.value,e.style.fontSize=`0.5rem`,e.style.fontFamily=`-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif`,t.text.color&&(e.style.fill=t.text.color))}return r.outerHTML}function aN(e,t){ let _hh$temp984=e,n=_hh$temp984.state,r=_hh$temp984.methods,i=On(t); return r.fileRankToPosition(n,i)}function oN(e,t){ let _hh$temp985=e,n=_hh$temp985.state,r=_hh$temp985.methods,i={id:pN(e),info:t,obj:r.createPieceObj(n,t)},a=aN(e,t.square); return n.assetsLoaded&&r.updatePieceVisuals(n,i),r.setPiecePosition(i,a),r.addPiece(n,i), __set$(n.pieces,t.square,i) ,i}function sN(e,t,n=!1){ let _hh$temp986=e,r=_hh$temp986.state,i=_hh$temp986.methods,_hh$temp987=t.options,a=_hh$temp987.pieceStyle,o=_hh$temp987.themeAssets; r.pieceStyle=a,r.options.themeAssets=o,i.updatePiecesStyle(r,n).then(()=>{r.assetsLoaded&&CN(e)})}function cN(e,t){var n; let _hh$temp988=e,r=_hh$temp988.state,i=_hh$temp988.methods,a=_hh$temp988.animationMethods,o=null; if(t.toSquare?o=aN(e,t.toSquare):t.coords&&(o=i.getBoardPosition(r,t.coords)),!o)return;let s=fN(r,t.square);s&&(eN(r,{piece:s,type:CP.Piece.Animation.Type.Drag})||QM(r,s),i.setPiecePosition(s,o),!r.selectedPiece&&a.dragPiece&&YM(e,{animation:a.dragPiece(r,s),type:CP.Piece.Animation.Type.Drag,piece:s}),r.selectedPiece=s,(n=i.onPieceDrag)==null||n.call(i,r,s))}function lN(e,t){var n; let _hh$temp989=e,r=_hh$temp989.state,i=_hh$temp989.methods,a=_hh$temp989.animationMethods,_hh$temp990=r,o=_hh$temp990.selectedPiece; if(!o)return;QM(r,o);let s=aN(e,t);a.dropPiece&&t===o.info.square&&YM(e,{animation:a.dropPiece(r,{piece:o,to:s}),type:CP.Piece.Animation.Type.Drop,piece:o,onEnd:( _hh$temp991 )=>{ var n=_hh$temp991.forcedEnd; n||!a.attackKing||o.info.square===t||r.attackedKing&&!eN(r,{piece:r.attackedKing,type:CP.Piece.Animation.Type.KingAttack})&&YM(e,{animation:a.attackKing(r,{piece:r.attackedKing}),type:CP.Piece.Animation.Type.KingAttack,piece:r.attackedKing})}}),i.setPiecePosition(o,s),(n=i.onPieceDrop)==null||n.call(i,r,o),r.selectedPiece=null}function uN(e,t){let n=fv(t);return n?fN(e,n):null}function dN(e,t){ let _hh$temp992=e,n=_hh$temp992.state,r=_hh$temp992.methods; return uN(n,r.positionToFileRank(n,t))}function fN(e,t){return Object.values(e.pieces).find(e=>e.info.square===t)||null}function pN(e){return++e.lastPieceId}function mN(e){ let _hh$temp993=e,t=_hh$temp993.state; return Object.keys(t.pieces).reduce((e,n)=>( __set$(e,n,{color:__get$(t.pieces,n).info.color,type:__get$(t.pieces,n).info.type}) ,e),{})}function hN(e,t){ let _hh$temp994=e,n=_hh$temp994.state,r=_hh$temp994.animationMethods; if(t&&r.attackKing){let i=fN(n,t);if(!i)return;YM(e,{animation:r.attackKing(n,{piece:i,illegalMove:!0}),type:CP.Piece.Animation.Type.KingAttack,piece:i})}}function gN(e, _hh$temp995 ){ var t=_hh$temp995.piecesInfo,n=_hh$temp995.reloadAll; var r; let _hh$temp996=e,i=_hh$temp996.state,a=_hh$temp996.methods; XM(i),n?Object.values(i.pieces).forEach(t=>{bN(e,{square:t.info.square})}):Object.values(i.pieces).forEach(n=>{let r=n.info,i=r.square,a=t.isDefined(i)?t.get(i):null;(!a||r.type!==a.type||r.color!==a.color)&&bN(e,{square:i})}),t.keys().filter(e=>! __get$(i.pieces,e) ).forEach(n=>{oN(e,t.get(n))}),(r=a.onPiecesLoaded)==null||r.call(a,i)}function _N(e){return!e||!e.san?!1:[`#`].includes(e.san.slice(-1))}function vN(e, _hh$temp997 ){ var t=_hh$temp997.move,n=_hh$temp997.attackedKingSquare;  let _hh$temp998=e,r=_hh$temp998.state,_hh$temp999=r,i=_hh$temp999.pieces; if(XM(r),t.drop){oN(e,{color:t.color,square:yr(t),type:t.drop});return}if(r.attackedKing=n? __get$(i,n) :null,r.isCheckmate=_N(t),t.EPCapturedSquare?bN(e,{captured:!0,square:t.EPCapturedSquare,fromDrop:t.userGeneratedDrop}):t.captured&&bN(e,{captured:!0,square:t.to,fromDrop:t.userGeneratedDrop}),yN(e,[t,t.rookMove].filter(Boolean)),t.promotion){let n= __get$(i,t.to) ;xN(e,{piece:n,type:t.promotion})}}function yN(e,t){ let _hh$temp1000=e,n=_hh$temp1000.state,r=_hh$temp1000.methods,i=_hh$temp1000.animationMethods,_hh$temp1001=n,a=_hh$temp1001.attackedKing,o=_hh$temp1001.pieces,s=_hh$temp1001.pointer,c=$r(t[0]),l=Qr(t[0]),u={}; if(!c&&t.length===2){let e= __get$(o,t[0].from) ,n= __get$(o,t[1].from) ;e.info.type===J.Piece.Types.King&&n.info.type===J.Piece.Types.Rook&&(c=!0)}t.forEach(t=>{var d;let f=yr(t);if(!f)return;let p= __get$(o,t.from) ,m=aN(e,t.from),h=aN(e,f),g=null,_=CP.Piece.Animation.Type.Move;t.userGeneratedDrop&&i.dropPiece?(r.setPiecePosition(p,s.boardPosition),g=i.dropPiece(n,{capturing:l,piece:p,to:h}),_=CP.Piece.Animation.Type.Drop):!t.userGeneratedDrop&&t.animate&&t.from!==f&&(g=i.movePiece(n,{capturing:l,castling:c,from:m,piece:p,to:h})),g?YM(e,{animation:g,type:_,piece:p,onEnd:( _hh$temp1002 )=>{ var o=_hh$temp1002.forcedEnd; var s;(s=r.onPieceMoved)==null||s.call(r,n,{piece:p,square:f}),!(o||!i.attackKing)&&t.san&&a&&!eN(n,{piece:a,type:CP.Piece.Animation.Type.KingAttack})&&YM(e,{animation:i.attackKing(n,{piece:a}),type:CP.Piece.Animation.Type.KingAttack,piece:a})}}):(r.setPiecePosition(p,h),(d=r.onPieceMoved)==null||d.call(r,n,{piece:p,square:f})),!a&&eN(n,{type:CP.Piece.Animation.Type.KingAttack})&&XM(n,CP.Piece.Animation.Type.KingAttack),t.from!==f&&(p.info.square=f, __set$(u,t.from,p) )}),Object.keys(u).forEach(e=>{let t= __get$(u,e) ,n= __get$(o,e) ; __set$(o,t.info.square,t) ,t.info.type===n.info.type&&t.info.color===n.info.color&&delete o[e]})}function bN(e, _hh$temp1003 ){ var t=_hh$temp1003.captured,n=_hh$temp1003.fromDrop,r=_hh$temp1003.square;  let _hh$temp1004=e,i=_hh$temp1004.state,a=_hh$temp1004.methods,o=_hh$temp1004.animationMethods,_hh$temp1005=i,s=_hh$temp1005.pieces,c=__get$(i.pieces,r); c&&(QM(i,c),t&&o.capturePiece?YM(e,{animation:o.capturePiece(i,{fromDrop:n,piece:c}),type:CP.Piece.Animation.Type.Capture,piece:c,onEnd:()=>a.removePiece(i,c)}):a.removePiece(i,c),delete s[r],i.selectedPiece===c&&(i.selectedPiece=null))}function xN(e, _hh$temp1006 ){ var t=_hh$temp1006.piece,n=_hh$temp1006.type;  let _hh$temp1007=e,r=_hh$temp1007.state,i=_hh$temp1007.methods; n&&(t.info.type=n),i.updatePieceVisuals(r,t)}function SN(e, _hh$temp1008 ){ var t=_hh$temp1008.move,n=_hh$temp1008.attackedKingSquare;  let _hh$temp1009=e,r=_hh$temp1009.state,i=_hh$temp1009.animationMethods,_hh$temp1010=r,a=_hh$temp1010.pieces,_hh$temp1011=pv(t),o=_hh$temp1011.movedPieces,s=_hh$temp1011.restoredPiece,c=_hh$temp1011.promotedSquare; if(XM(r),t.drop){bN(e,{square:t.to});return}if(r.attackedKing=n? __get$(a,n) :null,r.isCheckmate=_N(t),yN(e,o),s){let t=oN(e,s);i.restorePiece&&YM(e,{animation:i.restorePiece(r,t),type:CP.Piece.Animation.Type.Restore,piece:t})}if(c){let t= __get$(a,c) ;xN(e,{piece:t,type:J.Piece.Types.Pawn})}}function CN(e){var t; let _hh$temp1012=e,n=_hh$temp1012.state,r=_hh$temp1012.methods; Object.values(n.pieces).forEach(e=>{r.updatePieceVisuals(n,e)}),(t=r.onPiecesVisualsChanged)==null||t.call(r,n)}function wN(e){ let _hh$temp1013=e,t=_hh$temp1013.state,n=_hh$temp1013.methods; n.addAnalysisOverlay(t)}function TN(e,t){ let _hh$temp1014=e,n=_hh$temp1014.state,r=_hh$temp1014.methods,_hh$temp1015=n.options,i=_hh$temp1015.coordinates,a=_hh$temp1015.flipped,_hh$temp1016=t.options,o=_hh$temp1016.boardStyle,s=_hh$temp1016.themeAssets; n.boardStyle=o,n.options.themeAssets=s,r.updateBoardStyle(n),r.updateBoardCoordinates(n,{colorUpdate:!0,flipped:a,position:i})}function EN(e,t){ let _hh$temp1017=e,n=_hh$temp1017.state,r=_hh$temp1017.methods,_hh$temp1018=n,i=_hh$temp1018.animator; n.fadeSetupAnimation&&i.end(n.fadeSetupAnimation),t!==0&&(n.fadeSetupAnimation=r.fadeInAllPieces(n,t),n.fadeSetupAnimation.onEnd(()=>n.fadeSetupAnimation=null))}function DN(e,t){ let _hh$temp1019=e,n=_hh$temp1019.state,r=_hh$temp1019.methods; n.isBoardFlipped!==t&&(n.isBoardFlipped=t,r.flipBoard(n,t))}function ON(e,t){ let _hh$temp1020=e,n=_hh$temp1020.state; n.isBoardEnabled=t}function kN(e){ let _hh$temp1021=e,t=_hh$temp1021.boardThemes,n=_hh$temp1021.boardStyle,r=_hh$temp1021.options; return r.themeAssets?r.themeAssets.board.config.lightSquareCoordinateHex: __get$(t,n) ?.[0]||Kb.Board.DefaultDarkSquareColor}function AN(e){ let _hh$temp1022=e,t=_hh$temp1022.boardThemes,n=_hh$temp1022.boardStyle,r=_hh$temp1022.options; return r.themeAssets?r.themeAssets.board.config.darkSquareCoordinateHex: __get$(t,n) ?.[1]||Kb.Board.DefaultLightSquareColor}function jN(e){ let _hh$temp1023=e,t=_hh$temp1023.state,n=_hh$temp1023.methods; n.removeAnalysisOverlay(t)}function MN(e){ let _hh$temp1024=e,t=_hh$temp1024.state,n=_hh$temp1024.methods,_hh$temp1025=t.containerEl.getBoundingClientRect(),r=_hh$temp1025.width,i=_hh$temp1025.height; t.viewSize.width=r||Kb.Board.DefaultWidth,t.viewSize.height=i||Kb.Board.DefaultHeight,n.updateViewSize(t,t.viewSize)}function NN(e, _hh$temp1026 ){ var t=_hh$temp1026.position,n=_hh$temp1026.flipped;  let _hh$temp1027=e,r=_hh$temp1027.state,i=_hh$temp1027.methods; i.updateBoardCoordinates(r,{flipped:n,position:t})}function PN(e,t){ let _hh$temp1028=e,n=_hh$temp1028.state,r=_hh$temp1028.methods,_hh$temp1029=n,i=_hh$temp1029.options; t.forEach(e=>{ let _hh$temp1030=e,t=_hh$temp1030.data,a=_hh$temp1030.key,_hh$temp1031=t,o=_hh$temp1031.color,s=_hh$temp1031.from,c=_hh$temp1031.opacity,l=_hh$temp1031.to;  __get$(n.arrows,a) &&(r.removeArrow(n, __get$(n.arrows,a) ),delete n.arrows[a]);let u=On(s),d=On(l),f=Math.abs(u.file-d.file),p=Math.abs(u.rank-d.rank),m=f===1&&p===2||f===2&&p===1,h=mv(o,i.arrowColors),g={color:mp(h),from:u,isKnight:m,to:d,opacity:c||hp(h)},_={info:g,obj:r.createArrowObj(n,g)};r.addArrow(n,_), __set$(n.arrows,a,_) })}function FN(e,t){ let _hh$temp1032=e,n=_hh$temp1032.state,r=_hh$temp1032.methods; t.forEach(e=>{ let _hh$temp1033=e,t=_hh$temp1033.key; r.removeArrow(n, __get$(n.arrows,t) ),delete n.arrows[t]})}function IN(e,t){ let _hh$temp1034=e,n=_hh$temp1034.state,r=_hh$temp1034.methods,i=_hh$temp1034.animationMethods,_hh$temp1035=n,a=_hh$temp1035.highlights; t.forEach(t=>{var o; let _hh$temp1036=t.data,s=_hh$temp1036.color,c=_hh$temp1036.opacity,l=_hh$temp1036.square,u=_hh$temp1036.turn,d=_hh$temp1036.type;  __get$(a,l) &&(r.removeHighlight(n, __get$(a,l) ),delete a[l]);let f={color:s||J.Highlight.Defaults.Color,opacity:c,position:aN(e,l),square:l,turn:u,type:d},p={info:f,obj:i.createHighlightObj?.call(i,n,f)||r.createHighlightObj(n,f)};r.addHighlight(n,p),(o=i.showHighlight)==null||o.call(i,n,p), __set$(a,l,p) })}function LN(e,t){t.forEach(t=>{ let _hh$temp1037=t,_hh$temp1037$data=_hh$temp1037.data,n=_hh$temp1037$data.square; RN(e,{blinkInfo:t,square:n})})}function RN(e, _hh$temp1038 ){ var t=_hh$temp1038.blinkInfo,n=_hh$temp1038.square;  let _hh$temp1039=e,r=_hh$temp1039.state,i=_hh$temp1039.methods,a=_hh$temp1039.animationMethods,_hh$temp1040=r,o=_hh$temp1040.blinkingHighlights,_hh$temp1041=t.data,s=_hh$temp1041.color,c=_hh$temp1041.opacity,l=_hh$temp1041.interval,u=_hh$temp1041.times;  __get$(o,n) &&(i.removeHighlight(r, __get$(o,n) ),delete o[n]);let d={color:s||J.Highlight.Defaults.Color,opacity:c,position:aN(e,n),square:n},f={info:d,obj:i.createHighlightObj(r,d)};i.addHighlight(r,f),a.blinkHighlight(r,{interval:l,highlight:f,times:u}).onEnd(()=>{i.removeHighlight(r,f),delete o[n]}), __set$(o,n,f) ,r.options.test&&(d.testBlinkInfo={interval:l,times:u})}function zN(e){ let _hh$temp1042=e,t=_hh$temp1042.state,n=_hh$temp1042.methods,r=_hh$temp1042.animationMethods; r.hideHoverSquare?r.hideHoverSquare(t):n.hideHoverSquare(t)}function BN(e,t){ let _hh$temp1043=e,n=_hh$temp1043.state,r=_hh$temp1043.methods,i=_hh$temp1043.animationMethods,_hh$temp1044=n,a=_hh$temp1044.highlights; t.forEach(e=>{ let _hh$temp1045=e.data,t=_hh$temp1045.square,o=__get$(a,t); i.hideHighlight?i.hideHighlight(n,o).onEnd(()=>{r.removeHighlight(n,o)}):r.removeHighlight(n,o),delete a[t]})}function VN(e,t){var n; let _hh$temp1046=e,r=_hh$temp1046.state,i=_hh$temp1046.methods,a=_hh$temp1046.animationMethods,o=aN(e,t); a.showHoverSquare?(n=a.showHoverSquare)==null||n.call(a,r,o):i.showHoverSquare(r,o)}function HN(e, _hh$temp1047 ){ var t=_hh$temp1047.context,n=_hh$temp1047.squares,r=_hh$temp1047.type;  let _hh$temp1048=e,i=_hh$temp1048.state,a=_hh$temp1048.methods,o=_hh$temp1048.animationMethods,_hh$temp1049=i,s=_hh$temp1049.hints; n.forEach(n=>{let c={color:Kb.MoveHint.Color,opacity:Kb.MoveHint.Opacity,position:aN(e,n),square:n,turn:t.api.getTurn(),type:r},l={info:c,obj:c.type===CP.Hint.Type.Capture?o.createCaptureHintObj?.call(o,i,c)||a.createCaptureHintObj(i,c):o.createMoveHintObj?.call(o,i,c)||a.createMoveHintObj(i,c),activeAnimation:void 0};a.addHint(i,l),o.showHint&&JM(i,{item:l,type:CP.ItemAnimation.Type.Show,animation:o.showHint(i,l)}), __set$(s,n,l) })}function UN(e,t){ let _hh$temp1050=e,n=_hh$temp1050.state,r=_hh$temp1050.methods,i=_hh$temp1050.animationMethods,_hh$temp1051=n,a=_hh$temp1051.hints; t.forEach(e=>{let t= __get$(a,e) ;i.hideHint?JM(n,{item:t,type:CP.ItemAnimation.Type.Hide,animation:i.hideHint(n,t),onEnd:()=>{r.removeHint(n,t)}}):r.removeHint(n,t),delete a[e]})}function WN(e,t){let n=fv(t);return n?KN(e,n):null}function GN(e,t){ let _hh$temp1052=e,n=_hh$temp1052.state,r=_hh$temp1052.methods; return WN(n,r.positionToFileRank(n,t))}function KN(e,t){return Object.values(e.hints).find(e=>e.info.square===t)??null}function qN(e){ let _hh$temp1053=e,t=_hh$temp1053.state,n=_hh$temp1053.methods,r=_hh$temp1053.animationMethods; t.promotionWindowAnimation&&=(t.animator.end(t.promotionWindowAnimation),null),r.hidePromotionWindow?(t.promotionWindowAnimation=r.hidePromotionWindow(t),t.promotionWindowAnimation.onEnd(()=>{n.closePromotionWindow(t),t.promotionWindowAnimation=null})):n.closePromotionWindow(t),t.isPromotionWindowVisible=!1}function JN(e, _hh$temp1054 ){ var t=_hh$temp1054.promotionMove,n=_hh$temp1054.context;  let _hh$temp1055=e,r=_hh$temp1055.state,i=_hh$temp1055.methods,a=_hh$temp1055.animationMethods; r.promotionWindowAnimation&&=(r.animator.end(r.promotionWindowAnimation),null),i.openPromotionWindow(r,t).then(e=>{r.isPromotionWindowVisible&&(e?n.run(Zt(K.BoardEvents.PromotionPiecePointerdown,{piece:e})):n.run(Zt(K.BoardEvents.PromotionAreaClosePointerdown)))}),a.showPromotionWindow&&(r.promotionWindowAnimation=a.showPromotionWindow(r),r.promotionWindowAnimation.onEnd(()=>r.promotionWindowAnimation=null)),r.isPromotionWindowVisible=!0}function YN(e,t){ let _hh$temp1056=e,n=_hh$temp1056.state,r=_hh$temp1056.methods,_hh$temp1057=n,i=_hh$temp1057.customItems; t.forEach(t=>{ let _hh$temp1058=t.data,a=_hh$temp1058.color,o=_hh$temp1058.frame,s=_hh$temp1058.image,c=_hh$temp1058.opacity,l=_hh$temp1058.square,u=_hh$temp1058.text,d=_hh$temp1058.type,f=_hh$temp1058.visualOrder,p={color:a,image:s,frame:o,opacity:c,position:aN(e,l),square:l,text:u,type:d,visualOrder:f},m={info:p,obj:r.createCustomItemObj(n,p)}; r.addCustomItem(n,m), __set$(i,l,m) })}function XN(e,t){ let _hh$temp1059=e,n=_hh$temp1059.state,r=_hh$temp1059.methods,i=_hh$temp1059.animationMethods,_hh$temp1060=n,a=_hh$temp1060.customItems; t.forEach(e=>{ let _hh$temp1061=e,_hh$temp1061$data=_hh$temp1061.data,t=_hh$temp1061$data.square,o=__get$(a,t); o&&(i.hideCustomItem&&!o.info.frame?.imageAnimated?i.hideCustomItem(n,o).onEnd(()=>{r.removeCustomItem(n,o)}):r.removeCustomItem(n,o)),delete a[t]})}function ZN(e,t){ let _hh$temp1062=e,n=_hh$temp1062.state,r=_hh$temp1062.methods,_hh$temp1063=n,i=_hh$temp1063.effects; t.forEach(t=>{ let _hh$temp1064=t.data,a=_hh$temp1064.square,o=_hh$temp1064.type,s={position:aN(e,a),square:a,type:o},c={info:s,obj:r.createEffectObj(n,s)}; r.addEffect(n,c), __set$(i,a,c) })}function QN(e,t){ let _hh$temp1065=e,n=_hh$temp1065.state,r=_hh$temp1065.methods,_hh$temp1066=n,i=_hh$temp1066.effects; t.forEach(e=>{ let _hh$temp1067=e.data,t=_hh$temp1067.square; r.removeEffect(n, __get$(i,t) ),delete i[t]})}function $N(e){let t=vP(e);return{addAnalysisOverlay:()=>wN(t),addArrows:e=>PN(t,e),addCaptureHints:(e,n)=>{HN(t,{context:n,squares:e,type:CP.Hint.Type.Capture})},addCustomItems:e=>YN(t,e),addEffects:e=>ZN(t,e),addMoveHints:(e,n)=>{HN(t,{context:n,squares:e,type:CP.Hint.Type.Move})},addHighlights:e=>{IN(t,e)},animationComplete:e=>e&&Promise.resolve(),areAssetsLoaded:()=>t.state.assetsLoaded,blinkHighlights:e=>{LN(t,e)},closePromotionWindow:()=>qN(t),createRenderer:$N,destroy:()=>dP(t),dragPiece:e=>cN(t,e),dropPiece:e=>lN(t,e),...e.emitter,extendRenderer:()=>{},fadeSetup:e=>EN(t,e.options.fadeSetup),flipBoard:e=>DN(t,e),getCoordsFromSquare:e=>fP(t,e),getPieces:()=>mN(t),getPieceStyles:t.methods.getPieceStyles,getPointerPosition: _hh$temp1068=>{var e=_hh$temp1068.event;return pP(t,e);} ,getRendererOptions:()=>e,getBoardContainerAspectRatio:()=>mP(t),getWebGLCanvas:()=>hP(t),handleWebGLContextLost:()=>gP(t),hideHoverSquare:()=>zN(t),illegalMove:e=>hN(t,e),isAnimating:e=>$M(t,e),loadPieces:( _hh$temp1069 )=>{ var e=_hh$temp1069.pieces,n=_hh$temp1069.reloadAll; gN(t,{piecesInfo:e,reloadAll:n})},makeMove:(e,n)=>{vN(t,{attackedKingSquare:n.api.isCheck()||void 0,move:e})},name:e.name,openPromotionWindow:(e,n)=>{JN(t,{context:n,promotionMove:e})},removeAnalysisOverlay:()=>jN(t),removeArrows:e=>FN(t,e),removeCustomItems:e=>{XN(t,e)},removeEffects:e=>QN(t,e),removeHints:e=>UN(t,e),removePiece:e=>bN(t,{square:e}),removeHighlights:e=>BN(t,e),resize:()=>MN(t),setBoardEnabled:e=>ON(t,e),setCoordinates:e=>NN(t,e),showHoverSquare:e=>VN(t,e),undoMove:(e,n)=>{SN(t,{attackedKingSquare:n.api.isCheck()||void 0,move:e})},updateBoardImage:e=>{TN(t,e)},updatePieceBaseImage:(e,n=!1)=>{sN(t,e,n)}}}function eP(e,t){ let n=t.getBoundingClientRect(),_hh$temp1070=pf(e),r=_hh$temp1070.x,i=_hh$temp1070.y; return{boardRect:n,x:r-n.left,y:i-n.top}}function tP(e,t){var n; let _hh$temp1071=e,r=_hh$temp1071.state,i=_hh$temp1071.methods,_hh$temp1072=r,a=_hh$temp1072.containerEl,o=_hh$temp1072.pointer,s=eP(t,a); o.event=t,o.viewPosition=i.normalizePointer(r,s),o.boardPosition=i.getBoardPosition(r,o.viewPosition),o.insideBoard=tN(r,o.boardPosition),(n=i.onMouseDoubleClick)==null||n.call(i,r),o.previousViewPosition=o.viewPosition,o.previousBoardPosition=o.boardPosition}function nP(e,t){ let _hh$temp1073=e,n=_hh$temp1073.state,r=_hh$temp1073.methods,_hh$temp1074=n,i=_hh$temp1074.containerEl,a=_hh$temp1074.pointer,o=eP(t,i); a.event=t,a.viewPosition=r.normalizePointer(n,o),a.boardPosition=r.getBoardPosition(n,a.viewPosition),a.insideBoard=tN(n,a.boardPosition);let s=r.onMouseWheel?.call(r,n,t.deltaY);a.previousViewPosition=a.viewPosition,a.previousBoardPosition=a.boardPosition,s&&(t.preventDefault(),t.stopImmediatePropagation())}function rP(e){return y_(e)?!1:e.which>1}function iP(e,t){var n; let _hh$temp1075=e,r=_hh$temp1075.state,i=_hh$temp1075.methods,_hh$temp1076=r,a=_hh$temp1076.animatedOverPiece,o=_hh$temp1076.containerEl,s=_hh$temp1076.pointer,c=eP(t,o); s.event=t;let l=b_(t);!r.isBoardEnabled&&!l||(s.viewPosition=i.normalizePointer(r,c),s.boardPosition=i.getBoardPosition(r,s.viewPosition),s.down=!0,s.secondaryDown=rP(t),s.rightDown=l,s.insideBoard=tN(r,s.boardPosition),s.downInsideBoard=s.insideBoard,(n=i.onPointerDown)==null||n.call(i,r),a&&(QM(r,a),r.animatedOverPiece=null),s.previousViewPosition=s.viewPosition,s.previousBoardPosition=s.boardPosition)}function aP(e,t){var n; let _hh$temp1077=e,r=_hh$temp1077.state,i=_hh$temp1077.methods,a=_hh$temp1077.animationMethods,_hh$temp1078=r,o=_hh$temp1078.containerEl,s=_hh$temp1078.pointer,c=eP(t,o); s.event=t,s.previousViewPosition=s.viewPosition,s.previousBoardPosition=s.boardPosition,s.viewPosition=i.normalizePointer(r,c),s.boardPosition=i.getBoardPosition(r,s.viewPosition),s.insideBoard=tN(r,s.boardPosition),(n=i.onPointerMove)==null||n.call(i,r),r.isBoardEnabled&&(a.pieceOver&&oP(e,s),a.hintOver&&sP(e,s))}function oP(e,t){ let _hh$temp1079=e,n=_hh$temp1079.state,r=_hh$temp1079.animationMethods,_hh$temp1080=n,i=_hh$temp1080.animatedOverPiece,a=_hh$temp1080.selectedPiece,o=dN(e,t.boardPosition); if(i&&i!==o&&eN(n,{piece:i,type:CP.Piece.Animation.Type.Over})&&(QM(n,i),r.pieceOut&&YM(e,{animation:r.pieceOut(n,i),type:CP.Piece.Animation.Type.Out,piece:i}),n.animatedOverPiece=null),!(a&&a===o)&&o&&!eN(n,{piece:o})){if(nN(e,t.previousBoardPosition)===nN(e,t.boardPosition))return;n.animatedOverPiece=o,r.pieceOver&&YM(e,{animation:r.pieceOver(n,{piece:o,pointer:t}),type:CP.Piece.Animation.Type.Over,piece:o,onEnd:()=>n.animatedOverPiece=null})}}function sP(e,t){ let _hh$temp1081=e,n=_hh$temp1081.state,r=_hh$temp1081.animationMethods,_hh$temp1082=n,i=_hh$temp1082.animatedOverHint,a=GN(e,t.boardPosition); i&&i!==a&&(ZM(n,i),r.hintOut&&JM(n,{item:i,type:CP.ItemAnimation.Type.Out,animation:r.hintOut(n,i)}),n.animatedOverHint=null),a&&r.hintOver&&a.activeAnimation?.type!==CP.ItemAnimation.Type.Over&&(JM(n,{item:a,type:CP.ItemAnimation.Type.Over,animation:r.hintOver(n,a),onEnd:()=>n.animatedOverHint=null}),n.animatedOverHint=a)}function cP(e,t){var n; let _hh$temp1083=e,r=_hh$temp1083.state,i=_hh$temp1083.methods,_hh$temp1084=r,a=_hh$temp1084.containerEl,o=_hh$temp1084.pointer,s=eP(t,a); o.event=t,o.viewPosition=i.normalizePointer(r,s),o.boardPosition=i.getBoardPosition(r,o.viewPosition),o.down=!1,o.downInsideBoard=!1,o.secondaryDown=!1,o.rightDown=!1,o.insideBoard=tN(r,o.boardPosition),(n=i.onPointerUp)==null||n.call(i,r),o.previousViewPosition=o.viewPosition,o.previousBoardPosition=o.boardPosition}function lP(e){ let _hh$temp1085=e,t=_hh$temp1085.eventListeners,n=_hh$temp1085.state,r=_hh$temp1085.methods,_hh$temp1086=n,i=_hh$temp1086.containerEl; t.pointerDown=t=>iP(e,t),t.pointerMove=t=>aP(e,t),t.pointerUp=t=>cP(e,t),i.addEventListener(mC,t.pointerDown),document.addEventListener(hC,t.pointerMove),document.addEventListener(gC,t.pointerUp),r.onMouseDoubleClick&&(t.doubleClick=t=>tP(e,t),i.addEventListener(`dblclick`,t.doubleClick)),r.onMouseWheel&&(t.wheel=t=>nP(e,t),i.addEventListener(`wheel`,t.wheel))}function uP(e){ let _hh$temp1087=e,t=_hh$temp1087.eventListeners,n=_hh$temp1087.state,_hh$temp1088=n,r=_hh$temp1088.containerEl; t.pointerDown&&r.removeEventListener(mC,t.pointerDown),t.pointerMove&&document.removeEventListener(hC,t.pointerMove),t.pointerUp&&document.removeEventListener(gC,t.pointerUp),t.doubleClick&&r.removeEventListener(`dblclick`,t.doubleClick),t.wheel&&r.removeEventListener(`wheel`,t.wheel)}function dP(e){var t; let _hh$temp1089=e,n=_hh$temp1089.className,r=_hh$temp1089.frameRequestId,i=_hh$temp1089.state,a=_hh$temp1089.methods,_hh$temp1090=i,o=_hh$temp1090.animator,s=_hh$temp1090.containerEl,c=_hh$temp1090.viewEl; i.destroyed=!0,o.endAll(),r&&cancelAnimationFrame(r),a.destroy(i),uP(e),(t=c.parentNode)==null||t.removeChild(c),s.classList.remove(n)}function fP(e,t){ let _hh$temp1091=e,n=_hh$temp1091.state,r=_hh$temp1091.methods,i=On(t),a=r.fileRankToPosition(n,i); return r.getViewPosition(n,a)}function pP(e,t){ let _hh$temp1092=e,n=_hh$temp1092.state,r=_hh$temp1092.methods,_hh$temp1093=n,i=_hh$temp1093.containerEl,a=eP(t,i),o=r.normalizePointer(n,a),s=r.getBoardPosition(n,o),c=r.positionToNearestSquare(n,s); return{coords:o,coordsInsideBoard:r.getViewPosition(n,c),coordsInsideSquare:rN(s,n.squareSize),square:nN(e,s),squareInsideBoard:nN(e,c)}}function mP(e){return e.methods.getViewAspectRatio()}function hP(e){return e.state.viewEl}function gP(e){ let _hh$temp1094=e,t=_hh$temp1094.state,n=_hh$temp1094.methods,_hh$temp1095=t,r=_hh$temp1095.viewEl,i=r.cloneNode(); r.replaceWith(i),t.viewEl=i,n.onWebGLContextLost(t)}function _P(e){return  __call$(Object,"assign",[window,e,{JCE:Ve}]) ,e}function vP(e){var t; let _hh$temp1096=e,n=_hh$temp1096.animationMethods,r=_hh$temp1096.boardThemes,i=_hh$temp1096.className,a=_hh$temp1096.containerEl,o=_hh$temp1096.options,s=_hh$temp1096.methods,c=_hh$temp1096.name,l=_hh$temp1096.pieceThemes,u=_hh$temp1096.testElement,d=s.createState(qM(a,{boardThemes:r,options:o,pieceThemes:l})),f={animationMethods:n,className:i,eventListeners:{},frameRequestId:0,lastPieceId:0,methods:s,name:c,state:d}; return s.init(d),(t=n.init)==null||t.call(n,d),d.hoverSquare=n.createHoverSquareObj?n.createHoverSquareObj(d):s.createHoverSquareObj(d),bP(f).then(()=>{e.emitter.emit(K.InstanceEvents.WebGLAssetsInitialized,{type:K.InstanceEvents.WebGLAssetsInitialized})}),lP(f),a.classList.add(i),p(performance.now()),o.test&&yP(d,u),f;function p(e){f.frameRequestId=requestAnimationFrame(p),xP(f,e)}}function yP(e,t){An(e.containerEl,{[sx.Element]:t||cx.Board}),t===cx.SiblingBoard?_P({webglSiblingBoardState:e}):_P({webglBoardState:e})}function bP(e){ let _hh$temp1097=e,t=_hh$temp1097.state,n=_hh$temp1097.methods,r=_hh$temp1097.animationMethods; return Promise.all([n.loadAssets(t),r.loadAssets?.call(r,t)]).then(()=>{t.destroyed||(t.assetsLoaded=!0,CN(e),t.containerEl.appendChild(t.viewEl))})}function xP(e,t){ let _hh$temp1098=e,n=_hh$temp1098.state,r=_hh$temp1098.methods; n.animator.update(t),r.render(n,t)}function SP(e){return  new URLSearchParams(__get$(window,"location").search) .get(`useLocalAssets`)?`${ __call$(__get$(__get$(window,"location"),"href"),"replace",[__get$(window,"location").search,``]) }/${bC.webglDataUrlDev}/${e}`: __get$(window,bC.webglAssetPaths) && __get$(__get$(window,bC.webglAssetPaths),e) ? __get$(__get$(window,bC.webglAssetPaths),e) :`${bC.webglDataUrl}/${e}`}var CP,wP=e((()=>{ZO(),bt(),(e=>{e.PixelRatio=window.devicePixelRatio||1,(e=>{(e=>{(e=>{e.Capture=`Capture`,e.Drag=`Drag`,e.Drop=`Drop`,e.KingAttack=`KingAttack`,e.Move=`Move`,e.Restore=`Restore`,e.Out=`Out`,e.Over=`Over`})(e.Type||={})})(e.Animation||={})})(e.Piece||={}),(e=>{(e=>{e.Move=`move`,e.Capture=`capture`})(e.Type||={})})(e.Hint||={}),(e=>{(e=>{e.Show=`show`,e.Hide=`hide`,e.Out=`out`,e.Over=`over`})(e.Type||={})})(e.ItemAnimation||={})})(CP||={})})),TP,EP,DP,OP,kP,AP,jP,MP=e((()=>{ZO(),TP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,EP=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,DP=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`,OP=function(e){function t(t,n,r){t===void 0&&(t=4),n===void 0&&(n=3),r===void 0&&(r=!1),e.call(this,TP,r?DP:EP),this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new hE,this.pixelSize=1,this._clamp=r,this._kernels=null,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=n)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={kernels:{configurable:!0},clamp:{configurable:!0},pixelSize:{configurable:!0},quality:{configurable:!0},blur:{configurable:!0}};return t.prototype.apply=function(e,t,n,r){var i=this.pixelSize.x/t._frame.width,a=this.pixelSize.y/t._frame.height,o;if(this._quality===1||this._blur===0)o=this._kernels[0]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*a,e.applyFilter(this,t,n,r);else{for(var s=e.getFilterTexture(),c=t,l=s,u,d=this._quality-1,f=0;f<d;f++)o= __get$(this._kernels,f) +.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*a,e.applyFilter(this,c,l,!0),u=c,c=l,l=u;o= __get$(this._kernels,d) +.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*a,e.applyFilter(this,c,n,r),e.returnFilterTexture(s)}},t.prototype._generateKernels=function(){var e=this._blur,t=this._quality,n=[e];if(e>0)for(var r=e,i=e/t,a=1;a<t;a++)r-=i,n.push(r);this._kernels=n},n.kernels.get=function(){return this._kernels},n.kernels.set=function(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max.apply(Math,e)):(this._kernels=[0],this._quality=1)},n.clamp.get=function(){return this._clamp},n.pixelSize.set=function(e){typeof e==`number`?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof hE?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)},n.pixelSize.get=function(){return this._pixelSize},n.quality.get=function(){return this._quality},n.quality.set=function(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()},n.blur.get=function(){return this._blur},n.blur.set=function(e){this._blur=e,this._generateKernels()},Object.defineProperties(t.prototype,n),t}(uO),kP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,AP=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,jP=function(e){function t(t){t&&t.constructor!==Object&&(console.warn(`DropShadowFilter now uses options instead of (rotation, distance, blur, color, alpha)`),t={rotation:t},arguments[1]!==void 0&&(t.distance=arguments[1]),arguments[2]!==void 0&&(t.blur=arguments[2]),arguments[3]!==void 0&&(t.color=arguments[3]),arguments[4]!==void 0&&(t.alpha=arguments[4])),t= __call$(Object,"assign",[{rotation:45,distance:5,color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:hT.RESOLUTION},t]) ,e.call(this);var n=t.kernels,r=t.blur,i=t.quality,a=t.pixelSize,o=t.resolution;this._tintFilter=new e(kP,AP),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=new hE,this._tintFilter.resolution=o,this._blurFilter=n?new OP(n):new OP(r,i),this.pixelSize=a,this.resolution=o;var s=t.shadowOnly,c=t.rotation,l=t.distance,u=t.alpha,d=t.color;this.shadowOnly=s,this.rotation=c,this.distance=l,this.alpha=u,this.color=d,this._updatePadding()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={resolution:{configurable:!0},distance:{configurable:!0},rotation:{configurable:!0},alpha:{configurable:!0},color:{configurable:!0},kernels:{configurable:!0},blur:{configurable:!0},quality:{configurable:!0},pixelSize:{configurable:!0}};return t.prototype.apply=function(e,t,n,r){var i=e.getFilterTexture();this._tintFilter.apply(e,t,i,!0),this._blurFilter.apply(e,i,n,r),this.shadowOnly!==!0&&e.applyFilter(this,t,n,!1),e.returnFilterTexture(i)},t.prototype._updatePadding=function(){this.padding=this.distance+this.blur*2},t.prototype._updateShift=function(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))},n.resolution.get=function(){return this._resolution},n.resolution.set=function(e){this._resolution=e,this._tintFilter&&(this._tintFilter.resolution=e),this._blurFilter&&(this._blurFilter.resolution=e)},n.distance.get=function(){return this._distance},n.distance.set=function(e){this._distance=e,this._updatePadding(),this._updateShift()},n.rotation.get=function(){return this.angle/yE},n.rotation.set=function(e){this.angle=e*yE,this._updateShift()},n.alpha.get=function(){return this._tintFilter.uniforms.alpha},n.alpha.set=function(e){this._tintFilter.uniforms.alpha=e},n.color.get=function(){return fy(this._tintFilter.uniforms.color)},n.color.set=function(e){ly(e,this._tintFilter.uniforms.color)},n.kernels.get=function(){return this._blurFilter.kernels},n.kernels.set=function(e){this._blurFilter.kernels=e},n.blur.get=function(){return this._blurFilter.blur},n.blur.set=function(e){this._blurFilter.blur=e,this._updatePadding()},n.quality.get=function(){return this._blurFilter.quality},n.quality.set=function(e){this._blurFilter.quality=e},n.pixelSize.get=function(){return this._blurFilter.pixelSize},n.pixelSize.set=function(e){this._blurFilter.pixelSize=e},Object.defineProperties(t.prototype,n),t}(uO)}));function NP( _hh$temp1099 ){ var _hh$temp1099$autoDestroy=_hh$temp1099.autoDestroy,e=_hh$temp1099$autoDestroy===void 0?!0:_hh$temp1099$autoDestroy,_hh$temp1099$autoPlay=_hh$temp1099.autoPlay,t=_hh$temp1099$autoPlay===void 0?!0:_hh$temp1099$autoPlay,_hh$temp1099$loop=_hh$temp1099.loop,n=_hh$temp1099$loop===void 0?!1:_hh$temp1099$loop,r=_hh$temp1099.svgMarkup,_hh$temp1099$svgVars=_hh$temp1099.svgVars,i=_hh$temp1099$svgVars===void 0?{}:_hh$temp1099$svgVars; let a=LP(r,i),o=new GM([dD.EMPTY]);return o.anchor.set(.5,.5),o.pivot.set(.5,.5),BP(a,!0).then(r=>{let i=o.width,a=o.height,s=o.playing;o.textures=PP(r),o.width=i,o.height=a,o.loop=n,o.onComplete=()=>{e&&o.destroy()},(t||s)&&o.play()}),o}function PP(e,t=24){let n=[],r=e.height,i=Math.ceil(e.width/e.height),a=1e3/t;for(let t=0;t<i;t++){let i=t*r,o=i+r>e.width?e.width-i:r;n.push({texture:new dD(e.baseTexture,new jE(i,0,o,r)),time:a})}return n}function FP(e){let t={};return  new Promise(n=>{if(e.length===0){n(t);return;}let r=0;e.forEach(i=>{fetch(i.url).then(a=>{a.ok?a.text().then(a=>{__set$(t,i.name,a),r++,r===e.length&&n(t);}):(__set$(t,i.name,``),r++,r===e.length&&n(t));});});}) }function IP(e,t){return  new Promise(n=>{if(__get$(fE,e)){let r=__get$(fE,e);n(RP(r,t));}else{let r=new Fj();r.add(e).load(()=>{let i=__get$(r.resources,e).texture.baseTexture,a=RP(i,t);r.destroy(),n(a);});}}) }function LP(e,t){let n=e;return Object.keys(t).forEach(e=>{n= __call$(n,"replace",[RegExp(`{{${e}}}`,`g`),__get$(t,e)]) }),n}function RP(e,t){let n=new jE(0,0,e.width,e.height);if(t){ let _hh$temp1100=t,e=_hh$temp1100.xRatio,r=_hh$temp1100.yRatio,i=_hh$temp1100.widthRatio,a=_hh$temp1100.heightRatio,o=_hh$temp1100.cropRatio; n.x=e*n.width,n.y=r*n.height,n.width*=i,n.height*=a,o&&(n.x+=(n.width-n.width*o)/2,n.y+=(n.height-n.height*o)/2,n.width*=o,n.height*=o)}return new dD(e,n)}function zP(e,t=!1){let n=document.createElement(`img`);return n.src=`data:image/svg+xml;utf8,${encodeURIComponent(e)}`,t||(n.width=Kb.SVG.ImageSize,n.height=Kb.SVG.ImageSize),dD.from(n)}function BP(e,t=!1){return new Promise(n=>{let r=document.createElement(`img`);r.src=`data:image/svg+xml;utf8,${encodeURIComponent(e)}`,r.onload=()=>{t||(r.width=Kb.SVG.ImageSize,r.height=Kb.SVG.ImageSize),n(dD.from(r))}})}function VP(e, _hh$temp1101 ){ var _hh$temp1101$autoDestroy=_hh$temp1101.autoDestroy,t=_hh$temp1101$autoDestroy===void 0?!0:_hh$temp1101$autoDestroy,_hh$temp1101$autoPlay=_hh$temp1101.autoPlay,n=_hh$temp1101$autoPlay===void 0?!0:_hh$temp1101$autoPlay,r=_hh$temp1101.svgMarkup,_hh$temp1101$svgVars=_hh$temp1101.svgVars,i=_hh$temp1101$svgVars===void 0?{}:_hh$temp1101$svgVars; return BP(LP(r,i),!0).then(r=>{let i=e.width,a=e.height,o=e.playing;e.textures=PP(r),e.width=i,e.height=a,e.onComplete=()=>{t&&e.destroy()},(n||o)&&e.play()}),e}function HP(e){return{...e,options:Ht(e.options),analysisOverlay:null,boardCoordinates:null,boardObj:new fM,boardOffset:{x:0,y:0},extraTextures:{},flipCoordinates:!0,fadeInOverlay:null,piecesTextures:{},promotionHandler:()=>{},promotionWindow:null,renderer:UP(e.viewEl),scene:new RE,svgAssets:{}}}function UP(e){return new RO({antialias:!1,autoDensity:!0,resolution:CP.PixelRatio,transparent:!0,view:e})}function WP(e){ let _hh$temp1102=e,t=_hh$temp1102.scene,n=_hh$temp1102.renderer; GP(e),t.destroy({baseTexture:!0,children:!0,texture:!0}),n.destroy()}function GP(e){ let _hh$temp1103=e,t=_hh$temp1103.boardTexture,n=_hh$temp1103.piecesTextures,r=_hh$temp1103.extraTextures; t?.destroy(!0),Object.values(n).forEach(e=>e.destroy(!0)),Object.values(r).forEach(e=>e.destroy(!0))}function KP(e,t){ let _hh$temp1104=e,n=_hh$temp1104.boardOffset,r=_hh$temp1104.isBoardFlipped,i=_hh$temp1104.squareSize; return r?{x:i*(8-t.file)+i*.5+n.x,y:i*(t.rank-1)+i*.5+n.y}:{x:i*(t.file-1)+i*.5+n.x,y:i*(8-t.rank)+i*.5+n.y}}function qP(e,t){return t}function JP(e,t){return t}function YP(){return 1}function XP(e,t){e.scene.addChild(t.obj)}function ZP(e,t){ let _hh$temp1105=e,n=_hh$temp1105.squareSize,_hh$temp1106=t,r=_hh$temp1106.color,i=_hh$temp1106.opacity,a=_hh$temp1106.isKnight,o=KP(e,t.from),s=KP(e,t.to),c=hv({from:o,to:s}),l=_v({from:o,to:s}),u=QP({isKnight:a,length:c,squareSize:n}),d=a?vv({from:o,slope:l,to:s}):gv({from:o,to:s}),f=Qw.includes(l)?-1:1,p=new lM(); return p.beginFill(16777215),p.drawPolygon(u),p.pivot=new hE(n/2,n/2),p.angle=d,p.scale.x*=f,p.position.x=o.x,p.position.y=o.y,p.alpha=i,p.tint=dy(r),p.zIndex=gI.ObjectsRenderOrder.Arrow,p}function QP( _hh$temp1107 ){ var e=_hh$temp1107.length,t=_hh$temp1107.squareSize,n=_hh$temp1107.isKnight; let r=t*.5,i=t*8,a=i*Zw.WIDTH*.01*.5,o=i*Zw.HEAD_HEIGHT*.01,s=i*Zw.HEAD_WIDTH*.01*.5,c=i*Zw.TAIL_PADDING*.01,l=r-c;return n?[r-a,r+c,r+a,r+c,r+a,t*2+r-a,t+l,t*2+r-a,t+l,t*2+r-s,t+l+o,t*2+r,t+l,t*2+r+s,t+l,t*2+r+a,r-a,t*2+r+a]:[r-a,r+c,r+a,r+c,r+a,e+l,r+s,e+l,r,e+l+o,r-s,e+l,r-a,e+l]}function $P(e){ let _hh$temp1108=e,t=_hh$temp1108.arrows; Object.values(t).forEach(t=>{let n=t.info;eF(e,t),t.obj=ZP(e,n),XP(e,t)})}function eF(e,t){e.scene.removeChild(t.obj)}function tF(e,t){e.scene.addChild(t.obj)}function nF(e,t){ let _hh$temp1109=e,n=_hh$temp1109.squareSize,_hh$temp1110=t,r=_hh$temp1110.position,i=_hh$temp1110.type,a=_hh$temp1110.image,o=_hh$temp1110.frame,s=_hh$temp1110.opacity,c=_hh$temp1110.visualOrder,l=1,u=new GM([new dD(new ZE())]); if(a)u.texture=dD.from(a.url),a.percentOfSquare&&(l=a.percentOfSquare*.01);else if(o){let e=o.imageAnimated?void 0:{xRatio:o.positionRatioX,yRatio:o.positionRatioY,widthRatio:o.widthRatio,heightRatio:o.heightRatio,cropRatio:Kb.CustomItem.FrameCropRatio};IP(o.imageURL,e).then(e=>{o.imageAnimated?(u.textures=PP(e),u.width=n,u.height=n):u.texture=e}),u.filters=[new jP({alpha:gI.CustomItem.Frame.Shadow.Opacity,blur:gI.CustomItem.Frame.Shadow.Blur,rotation:gI.CustomItem.Frame.Shadow.Rotation,distance:n*gI.CustomItem.Frame.Shadow.DistanceRatio,resolution:CP.PixelRatio})]}else{let n=iN( __get$(lx,i) ,t);if(u.texture=zP(n),e.options.test){let e=document.createElement(`div`);e.innerHTML=n,t.testSVG=e.querySelector(`svg`)}}return u.loop=!1,u.width=n*l,u.height=n*l,u.anchor.set(.5,.5),u.pivot.set(.5,.5),u.position.x=r.x,u.position.y=r.y,a&&s?u.alpha=s:o?u.alpha=1:u.alpha=Kb.CustomItem.Opacity,u.zIndex=gI.ObjectsRenderOrder.CustomItem,c&&(c.target===_b.Targets.Arrows?u.zIndex=gI.ObjectsRenderOrder.Arrow:c.target===_b.Targets.Effects?u.zIndex=gI.ObjectsRenderOrder.Effect:c.target===_b.Targets.Pieces&&(u.zIndex=gI.ObjectsRenderOrder.Piece),u.zIndex=c.position===_b.Positions.Above?u.zIndex+=1:--u.zIndex),u}function rF(e){ let _hh$temp1111=e,t=_hh$temp1111.customItems,n=_hh$temp1111.squareSize; Object.values(t).forEach(t=>{let r=KP(e,On(t.info.square));t.info.position=r,t.obj.width=n,t.obj.height=n,t.obj.position.x=r.x,t.obj.position.y=r.y})}function iF(e,t){t.info.frame?.imageAnimated?(t.obj.onComplete=()=>{e.scene.removeChild(t.obj)},t.obj.play()):e.scene.removeChild(t.obj)}function aF(e,t){e.scene.addChild(t.obj)}function oF(e,t){ let _hh$temp1112=e,n=_hh$temp1112.squareSize,_hh$temp1113=t,r=_hh$temp1113.position,i=_hh$temp1113.type,a=new fM(zP(Ln({path:__get$(Yx,i),size:`100%`,viewBox:`0 0 19 19`}))); return a.anchor.set(.5,.5),a.pivot.set(.5,.5),a.width=n*Kb.Effect.SizeRatio,a.height=n*Kb.Effect.SizeRatio,a.zIndex=gI.ObjectsRenderOrder.Effect,lF(e,{effect:{info:t,obj:a},position:r}),a}function sF(e){ let _hh$temp1114=e,t=_hh$temp1114.effects,n=_hh$temp1114.squareSize; Object.values(t).forEach(t=>{let r=KP(e,On(t.info.square));t.obj.width=n*Kb.Effect.SizeRatio,t.obj.height=n*Kb.Effect.SizeRatio,lF(e,{effect:t,position:r})})}function cF(e,t){e.scene.removeChild(t?.obj)}function lF(e, _hh$temp1115 ){ var t=_hh$temp1115.effect,n=_hh$temp1115.position;  let _hh$temp1116=e,r=_hh$temp1116.isBoardFlipped,i=_hh$temp1116.squareSize,_hh$temp1117=t,a=_hh$temp1117.info,o=_hh$temp1117.obj; a.position=n,o.position.x=n.x+i*Kb.Effect.OffsetRatio,o.position.y=n.y-i*Kb.Effect.OffsetRatio;let s=Bn(a.square,r);s.right&&(o.position.x-=i*gI.Effect.TuckRatio),s.top&&(o.position.y+=i*gI.Effect.TuckRatio)}function uF(e,t){e.scene.addChildAt(t.obj,e.scene.children.length-1)}function dF(e, _hh$temp1118 ){ var t=_hh$temp1118.squareSize,_hh$temp1118$outerRadiusRatio=_hh$temp1118.outerRadiusRatio,n=_hh$temp1118$outerRadiusRatio===void 0?Kb.CaptureHint.OuterRadiusRatio:_hh$temp1118$outerRadiusRatio,_hh$temp1118$innerRadiusRatio=_hh$temp1118.innerRadiusRatio,r=_hh$temp1118$innerRadiusRatio===void 0?Kb.CaptureHint.InnerRadiusRatio:_hh$temp1118$innerRadiusRatio; e.clear(),e.beginFill(16777215),e.drawCircle(0,0,t*n),e.beginHole(),e.drawCircle(0,0,t*r),e.endHole(),e.beginFill(0,0),e.drawRect(-t*.5,-t*.5,t,t)}function fF(e,t){ let _hh$temp1119=e,n=_hh$temp1119.squareSize,_hh$temp1120=t,r=_hh$temp1120.color,i=_hh$temp1120.opacity,a=_hh$temp1120.position,o=new lM(); return dF(o,{squareSize:n}),o.position.x=a.x,o.position.y=a.y,o.alpha=i,o.tint=dy(r),o}function pF(e,t){ let _hh$temp1121=e,n=_hh$temp1121.squareSize,_hh$temp1122=t,r=_hh$temp1122.color,i=_hh$temp1122.opacity,a=_hh$temp1122.position,o=new lM(); return o.beginFill(16777215),o.drawCircle(0,0,n*Kb.MoveHint.RadiusRatio),o.beginFill(0,0),o.drawRect(-n*.5,-n*.5,n,n),o.position.x=a.x,o.position.y=a.y,o.alpha=i,o.tint=dy(r),o}function mF(e,t=1){Object.values(e.hints).forEach(n=>{let r=KP(e,On(n.info.square));n.info.position=r,n.obj.width*=t,n.obj.height*=t,n.obj.position.x=r.x,n.obj.position.y=r.y})}function hF(e,t){e.scene.removeChild(t.obj)}function gF(e,t){ let _hh$temp1123=e,n=_hh$temp1123.scene,r=_hh$temp1123.fadeInOverlay; r?n.addChildAt(t.obj,n.getChildIndex(r)):n.addChild(t.obj),xF(e)&&AF(e,t)}function _F(e){ let _hh$temp1124=e,t=_hh$temp1124.squareSize,n=new fM(); return n.width=t,n.height=t,n.anchor.set(.5,.5),n.pivot.set(.5,.5),n.zIndex=gI.ObjectsRenderOrder.Piece,n}function vF(e){e.obj.zIndex=gI.ObjectsRenderOrder.ElevatedPiece}function yF(e,t){ let _hh$temp1125=e,n=_hh$temp1125.animator,r=_hh$temp1125.scene,i=_hh$temp1125.boardObj; e.fadeInOverlay&&=(r.removeChild(e.fadeInOverlay),null);let a=new fM(i.texture);return a.width=i.width,a.height=i.height,a.position.x=i.position.x,a.position.y=i.position.y,r.addChildAt(a,r.children.length),e.fadeInOverlay=a,n.play({duration:t,keyframes:{0:{alpha:1},100:{alpha:0}},target:a,onEnd:()=>{e.fadeInOverlay&&r.removeChild(e.fadeInOverlay),e.fadeInOverlay=null}})}function bF(e,t){return uN(e,ZF(e,t))}function xF(e){ let _hh$temp1126=e,t=_hh$temp1126.pieceStyle,n=_hh$temp1126.pieceThemes,r=_hh$temp1126.options; return!!(r.themeAssets?r.themeAssets.config.perspective===qb.Perspective.PSEUDO_3D: __get$(n,t) ?.isPseudo3d)}function SF(e,t){xF(e)&&AF(e,t),t.obj.zIndex=gI.ObjectsRenderOrder.Piece}function CF(e, _hh$temp1127 ){ var t=_hh$temp1127.piece,n=_hh$temp1127.square; jF(e,{piece:t,square:n}),MF(e,t),xF(e)&&AF(e,t),t.obj.zIndex=gI.ObjectsRenderOrder.Piece}function wF(e){xF(e)&&DF(e)}function TF(e){ let _hh$temp1128=e,t=_hh$temp1128.boardOffset,n=_hh$temp1128.piecesTextures,r=_hh$temp1128.squareSize,i=_hh$temp1128.viewSize,a=t.y; if(xF(e)){let e=n.wk.orig;t.y=r*(e.height/e.width)-r}else t.y=0;t.y!==a&&qF(e,i)}function EF(e){Object.values(e.pieces).forEach(t=>{MF(e,t),jF(e,{piece:t})})}function DF(e){Object.values(e.pieces).forEach(t=>{AF(e,t)})}function OF(e,t){e.scene.removeChild(t.obj)}function kF(e,t){e.obj.x=t.x,e.obj.y=t.y}function AF(e,t){ let _hh$temp1129=e,n=_hh$temp1129.pieces,r=_hh$temp1129.isBoardFlipped,i=On(t.info.square).file,a=[],o=t.obj.parent.getChildIndex(t.obj); for(let e=1;e<=8;e++){let t= __get$(n,fv({file:i,rank:e})) ;if(t){let e=t.obj.parent.getChildIndex(t.obj);a.push(t),o<e&&(o=e)}}r||a.reverse(),a.forEach(e=>e.obj.parent.addChildAt(e.obj,o))}function jF(e, _hh$temp1130 ){ var t=_hh$temp1130.piece,n=_hh$temp1130.square; kF(t,KP(e,On(n||t.info.square)))}function MF(e,t){ let _hh$temp1131=e,n=_hh$temp1131.squareSize; if(t.obj.width=n,xF(e)){let e=t.obj.texture.orig,r=n*(e.height/e.width),i=(r-n/2)/r;t.obj.height=r,t.obj.anchor.y=i,t.obj.pivot.y=i}else t.obj.height=n,t.obj.anchor.y=.5,t.obj.pivot.y=.5}function NF(e,t){let n=`${Hp(t.info.color)}${t.info.type}`;t.obj.texture= __get$(e.piecesTextures,n) ,MF(e,t)}function PF(e,t){e.scene.addChildAt(t.obj,1)}function FF(e,t){ let _hh$temp1132=e,n=_hh$temp1132.squareSize,_hh$temp1133=t,r=_hh$temp1133.color,i=_hh$temp1133.opacity,a=_hh$temp1133.position,o=n*.5,s=new lM(); return s.beginFill(16777215),s.drawRect(-o,-o,n,n),s.position.x=a.x,s.position.y=a.y,s.alpha=i,s.tint=dy(r),s}function IF(e){ let _hh$temp1134=e,t=_hh$temp1134.scene,n=_hh$temp1134.squareSize,r=new fM(); return r.anchor=new hE(.5,.5),r.width=n*gI.HoverSquare.SizeRatio,r.height=n*gI.HoverSquare.SizeRatio,r.visible=!1,t.addChild(r),r}function LF(e){ let _hh$temp1135=e,t=_hh$temp1135.hoverSquare; t&&(t.visible=!1)}function RF(e,t=1){ let _hh$temp1136=e,n=_hh$temp1136.highlights,r=_hh$temp1136.hoverSquare; r&&(r.width*=t,r.height*=t),Object.values(n).forEach(n=>{let r=KP(e,On(n.info.square));n.info.position=r,n.obj.width*=t,n.obj.height*=t,n.obj.position.x=r.x,n.obj.position.y=r.y})}function zF(e,t){e.scene.removeChild(t.obj)}function BF(e,t){ let _hh$temp1137=e,n=_hh$temp1137.hoverSquare; n&&(n.visible=!0,n.position.x=t.x,n.position.y=t.y)}function VF(e){ let _hh$temp1138=e,t=_hh$temp1138.scene,n=_hh$temp1138.boardObj; if(e.analysisOverlay)return;let r=new lM;r.beginFill(16777215,Kb.AnalysisOverlay.Opacity),r.drawRect(0,0,n.width,n.height),r.position.x=n.position.x,t.addChildAt(r,t.getChildIndex(n)+1),e.analysisOverlay=r}function HF(e){EF(e),DF(e),RF(e),mF(e),rF(e),sF(e),$P(e)}function UF(e){ let _hh$temp1139=e,t=_hh$temp1139.scene; e.analysisOverlay&&t.removeChild(e.analysisOverlay),e.analysisOverlay=null}function WF(e, _hh$temp1140 ){ var t=_hh$temp1140.position,n=_hh$temp1140.flipped,r=_hh$temp1140.refreshOnly;  let _hh$temp1141=e,i=_hh$temp1141.scene,a=_hh$temp1141.viewSize,o=_hh$temp1141.boardOffset,s=t===Qb.CoordinatesPositions.Outside; if((s||o.x>0)&&!r){qF(e,a);return}e.boardCoordinates&&=(i.removeChild(e.boardCoordinates),null),t!==Qb.CoordinatesPositions.Off&&(e.boardCoordinates=GF(e,{flipped:n,outside:s}),i.addChildAt(e.boardCoordinates,1))}function GF(e, _hh$temp1142 ){ var t=_hh$temp1142.flipped,n=_hh$temp1142.outside;  let _hh$temp1143=e,r=_hh$temp1143.squareSize,i=_hh$temp1143.boardOffset,a=new RE(),o=dy(kN(e)),s=dy(AN(e)),c=r*gI.BoardCoordinates.Inside.LeftMarginRatio,l=r*gI.BoardCoordinates.Inside.RightMarginRatio,u=r*gI.BoardCoordinates.Inside.TopMarginRatio,d=r*gI.BoardCoordinates.Inside.BottomMarginRatio,f=new gM({fill:16777215,fontSize:r*gI.BoardCoordinates.Inside.SizeRatio,fontWeight:`bold`}); a.width=r*8,a.height=r*8;let p=[`a`,`b`,`c`,`d`,`e`,`f`,`g`,`h`],m=[`1`,`2`,`3`,`4`,`5`,`6`,`7`,`8`];return t?p.reverse():m.reverse(),p.forEach((e,t)=>{let c=new xM(e,f);c.anchor=new hE(.5,.5),n?(c.position.x=r*(t+1)+i.x-r*.5,c.position.y=r*8+i.y+i.x*.45,c.alpha=gI.BoardCoordinates.Outside.Opacity,c.tint=gI.BoardCoordinates.Outside.Color):(c.position.x=r*(t+1)+i.x-l,c.position.y=r*8+i.y-d,c.tint=t%2?o:s),a.addChild(c)}),m.forEach((e,t)=>{let l=new xM(e,f);l.anchor=new hE(.5,.5),n?(l.position.x=i.x*.5,l.position.y=r*t+i.y+r*.5,l.alpha=gI.BoardCoordinates.Outside.Opacity,l.tint=gI.BoardCoordinates.Outside.Color):(l.position.x=i.x+c,l.position.y=r*t+i.y+u,l.tint=t%2?s:o),a.addChild(l)}),a}function KF(e){ let _hh$temp1144=e,t=_hh$temp1144.boardObj,n=_hh$temp1144.boardOffset,r=_hh$temp1144.squareSize,i=_hh$temp1144.analysisOverlay,a=_hh$temp1144.fadeInOverlay; t.width=r*8,t.height=t.width,t.position.x=n.x,t.position.y=n.y,i&&(i.width=t.width,i.height=t.height,i.position.x=t.position.x,i.position.y=t.position.y),a&&(a.width=t.width,a.height=t.height,a.position.x=t.position.x,a.position.y=t.position.y)}function qF(e,t){ let _hh$temp1145=t,n=_hh$temp1145.height,r=_hh$temp1145.width,_hh$temp1146=e,i=_hh$temp1146.boardOffset,a=_hh$temp1146.options,o=_hh$temp1146.renderer,s=a.coordinates===Qb.CoordinatesPositions.Outside,c=r*gI.BoardCoordinates.Outside.PaddingRatio,l=e.squareSize; i.x=s?c:0;let u=r-i.x-i.y;xF(e)&&(i.x=(r-u)/2),e.squareSize=u/8;let d=l?e.squareSize/l:1;o.resize(r,n),KF(e),WF(e,{flipped:a.flipped,position:a.coordinates,refreshOnly:!0}),EF(e),RF(e,d),mF(e,d),rF(e),sF(e),$P(e)}function JF(e){ let _hh$temp1147=e,t=_hh$temp1147.boardObj,n=_hh$temp1147.scene,r=_hh$temp1147.viewSize; n.sortableChildren=!0,n.addChild(t),qF(e,r)}function YF(e,t){return t}function XF(e){ let _hh$temp1148=e,t=_hh$temp1148.viewSize,n=_hh$temp1148.viewEl,r=UP(n); r.resize(t.width,t.height),e.renderer=r}function ZF(e,t){ let _hh$temp1149=e,n=_hh$temp1149.boardOffset,r=_hh$temp1149.isBoardFlipped,i=_hh$temp1149.squareSize,a=Math.ceil((t.x-n.x)/ i),o=Math.ceil((i*8-(t.y-n.y))/ i); return r&&(a=9-a,o=9-o),{file:a,rank:o}}function QF(e,t){ let _hh$temp1150=e,n=_hh$temp1150.boardOffset,r=_hh$temp1150.squareSize,i=.01,a=r*8; return{x:Kd(t.x,{min:n.x+i,max:a+n.x-i}),y:Kd(t.y,{min:n.y+i,max:a+n.y-i})}}function $F(e){e.renderer.render(e.scene)}function eI(e){ let _hh$temp1151=e,t=_hh$temp1151.start,n=_hh$temp1151.end,r=_hh$temp1151.width,i=_hh$temp1151.texture,a=_hh$temp1151.opacity,o=[new hE(n.x,n.y),new hE(t.x,t.y)],s=new BM(new WM(r,o,0),new UM(i)); return s.alpha=a??1,{obj:s,start:o[1],end:o[0]}}function tI(e){e.obj.destroy({children:!0})}function nI(e, _hh$temp1152 ){ var t=_hh$temp1152.start,n=_hh$temp1152.end,r=_hh$temp1152.opacity; t&&e.start.set(t.x,t.y),n&&e.end.set(n.x,n.y),r!==void 0&&(e.obj.alpha=r),e.obj.geometry.update()}function rI(e,t){let n=new lM,r=e-t;return n.beginFill(16777215),n.drawRect(-e/2,-e/2,e,e),n.beginHole(),n.drawRect(-r/2,-r/2,r,r),n}function iI(e){return new Promise(t=>{Promise.all([aI(e),sI(e),oI(e)]).then(()=>t())})}function aI(e){return  new Promise(t=>{let _hh$temp1153=e,n=_hh$temp1153.boardStyle,r=_hh$temp1153.boardThemes,i=_hh$temp1153.options,a=__get$(r,n)??Xb.green,o=`board`,s=i.themeAssets?i.themeAssets.board.assets.background:dv(a[2],256,i),c=new Fj();ZE.removeFromCache(o),dD.removeFromCache(o),c.add(o,s).load(()=>{e.destroyed||(e.boardTexture&&e.boardTexture.destroy(!0),e.boardTexture=__get$(c.resources,o).texture,e.boardObj.texture=e.boardTexture,c.destroy(),t());});}) }function oI(e){return  new Promise(t=>{let _hh$temp1154=e,n=_hh$temp1154.extraTextures,r=_hh$temp1154.hoverSquare,i=SP(`two-d`),a=new Fj();a.add([{name:`hoverSquare`,url:`${i}/hover-square.png`}]).load(()=>{e.destroyed||(n.hoverSquare=a.resources.hoverSquare.texture,r&&(r.texture=n.hoverSquare),a.destroy(),t());});}) }function sI(e,t=!1){return  new Promise(n=>{let _hh$temp1155=e,r=_hh$temp1155.pieceStyle,i=_hh$temp1155.pieceThemes,a=_hh$temp1155.options,o=[`wp`,`wn`,`wb`,`wr`,`wq`,`wk`,`bp`,`bn`,`bb`,`br`,`bq`,`bk`],s=It((__get$(i,r)??Zb.neo).path,256,a),c=new Fj(),l=o.map(e=>{ZE.removeFromCache(e),dD.removeFromCache(e);let n=a.themeAssets?__get$(a.themeAssets.pieces.assets,e):`${s}/${e}.png`;return t?{name:e,url:`${__get$(Wb,e)}`}:{name:e,url:n};});c.add(l).load(()=>{e.destroyed||(o.forEach(t=>{__get$(e.piecesTextures,t)&&__get$(e.piecesTextures,t).destroy(!0),__get$(c.resources,t)?.texture?.baseTexture&&(__get$(c.resources,t).texture.baseTexture.mipmap=0),__set$(e.piecesTextures,t,__get$(c.resources,t).texture);}),c.destroy(),n());});}) }function cI(e){e.promotionWindow&&e.scene.removeChild(e.promotionWindow),e.promotionWindow=null}function lI(e, _hh$temp1156 ){ var t=_hh$temp1156.color,n=_hh$temp1156.squareOffset,r=_hh$temp1156.top;  let _hh$temp1157=e,i=_hh$temp1157.scene,a=_hh$temp1157.squareSize,o=_hh$temp1157.boardOffset,s=a*gI.PromotionWindow.CloseButton.HeightRatio,c=[J.Piece.Types.Queen,J.Piece.Types.Knight,J.Piece.Types.Rook,J.Piece.Types.Bishop]; r||c.reverse();let l=uI(),u=fI(a,s),d=pI(e),f=dI(e,{color:t,pieceTypes:c});l.addChild(u),l.addChild(d),l.addChild(f),l.position.x=a*n+o.x,r?(d.position.y=a*4,f.position.y=0,l.position.y=o.y):(d.position.y=0,f.position.y=s,l.position.y=a*4-s+o.y),l.zIndex=gI.ObjectsRenderOrder.PromotionWindow,i.addChild(l),e.promotionWindow&&e.scene.removeChild(e.promotionWindow),e.promotionWindow=l}function uI(){let e=new RE;return e.filters=[new jP({alpha:gI.PromotionWindow.Shadow.Opacity,blur:gI.PromotionWindow.Shadow.Blur,distance:gI.PromotionWindow.Shadow.Distance,resolution:CP.PixelRatio})],e}function dI(e, _hh$temp1158 ){ var t=_hh$temp1158.color,n=_hh$temp1158.pieceTypes;  let _hh$temp1159=e,r=_hh$temp1159.piecesTextures,i=_hh$temp1159.squareSize,a=new RE(); return a.name=gI.PromotionWindow.PiecesContainerName,n.forEach((e,n)=>{let o= __get$(r,`${t}${e}`) ,s=o?.orig,c=new fM(o);c.width=i,c.height=i*(s?.height/s?.width),c.anchor.y=1,c.position.y=i*(n+1),c.cursor=`pointer`,c.name=e,a.addChild(c)}),a}function fI(e,t){let n=new lM;return n.beginFill(gI.PromotionWindow.Style.BackgroundColor),n.drawRoundedRect(0,0,e,e*4+t,gI.PromotionWindow.Style.CornersRadius),n}function pI(e){ let _hh$temp1160=e,t=_hh$temp1160.squareSize,n=new lM(),r=t*gI.PromotionWindow.CloseButton.HeightRatio; n.cursor=`pointer`,n.beginFill(gI.PromotionWindow.CloseButton.BackgroundColor),n.drawRoundedRect(0,0,t,r,gI.PromotionWindow.Style.CornersRadius);let i=new xM(gI.PromotionWindow.CloseButton.IconText,new gM({fill:gI.PromotionWindow.CloseButton.ForegroundColor,fontFamily:gI.PromotionWindow.CloseButton.IconFontFamily,fontSize:r*gI.PromotionWindow.CloseButton.IconSizeRatio}));return i.anchor=new hE(.5,.5),i.position.x=t*.5,i.position.y=r*.45,n.addChild(i),n}function mI(e,t){ let _hh$temp1161=e,n=_hh$temp1161.isBoardFlipped,r=_hh$temp1161.viewEl,_hh$temp1162=On(t.to),i=_hh$temp1162.file,a=_hh$temp1162.rank,o=Hp(t.color),s=n?8-i:i-1,c=n?a===1:a===8,l=new Promise(t=>{e.promotionHandler=t;}); return lI(e,{color:o,squareOffset:s,top:c}),r.addEventListener(mC,u),l;function u(t){ let _hh$temp1163=e,n=_hh$temp1163.isPromotionWindowVisible,i=_hh$temp1163.promotionWindow,a=_hh$temp1163.promotionHandler,o=YF(e,eP(t,r)); n&&i&&(a(hI(i,o)),t.stopPropagation()),r.removeEventListener(mC,u)}}function hI(e,t){let n=e.getChildByName(gI.PromotionWindow.PiecesContainerName),r;return[J.Piece.Types.Queen,J.Piece.Types.Knight,J.Piece.Types.Rook,J.Piece.Types.Bishop].forEach(e=>{let i=n.getChildByName(e).getBounds(!0);t.x>i.x&&t.x<i.x+i.width&&t.y>i.y&&t.y<i.y+i.height&&(r=e)}),r}var gI,_I,vI,yI=e((()=>{KM(),ZO(),wP(),bt(),MP(),(e=>{(e=>{e.Board=`board-webgl-2d`,e.PieceDrag=`piece-dragging`,e.PieceHover=`piece-hover`})(e.CssClasses||={}),(e=>{ __set$(e,e.Piece=1,`Piece`) , __set$(e,e.CustomItem=2,`CustomItem`) , __set$(e,e.Arrow=3,`Arrow`) , __set$(e,e.Effect=4,`Effect`) , __set$(e,e.ElevatedVfx=9,`ElevatedVfx`) , __set$(e,e.ElevatedPiece=10,`ElevatedPiece`) , __set$(e,e.PromotionWindow=11,`PromotionWindow`) })(e.ObjectsRenderOrder||={}),(e=>{ __set$(e,e.SizeRatio=2,`SizeRatio`) })(e.HoverSquare||={}),(e=>{(e=>{(e=>{ __set$(e,e.Opacity=.3,`Opacity`) , __set$(e,e.Blur=0,`Blur`) , __set$(e,e.Rotation=90,`Rotation`) , __set$(e,e.DistanceRatio=.03,`DistanceRatio`) })(e.Shadow||={})})(e.Frame||={})})(e.CustomItem||={}),(e=>{ __set$(e,e.TuckRatio=.165,`TuckRatio`) })(e.Effect||={}),(e=>{(e=>{ __set$(e,e.SizeRatio=.23,`SizeRatio`) , __set$(e,e.LeftMarginRatio=.13,`LeftMarginRatio`) , __set$(e,e.RightMarginRatio=.13,`RightMarginRatio`) , __set$(e,e.TopMarginRatio=.18,`TopMarginRatio`) , __set$(e,e.BottomMarginRatio=.17,`BottomMarginRatio`) })(e.Inside||={}),(e=>{ __set$(e,e.Color=16777215,`Color`) , __set$(e,e.Opacity=.5,`Opacity`) , __set$(e,e.PaddingRatio=.035,`PaddingRatio`) })(e.Outside||={})})(e.BoardCoordinates||={}),(e=>{e.PiecesContainerName=`piecesContainer`,(e=>{ __set$(e,e.CornersRadius=3,`CornersRadius`) , __set$(e,e.BackgroundColor=16777215,`BackgroundColor`) })(e.Style||={}),(e=>{ __set$(e,e.Opacity=.45,`Opacity`) , __set$(e,e.Blur=3,`Blur`) , __set$(e,e.Distance=4,`Distance`) })(e.Shadow||={}),(e=>{ __set$(e,e.HeightRatio=.5,`HeightRatio`) , __set$(e,e.IconSizeRatio=.65,`IconSizeRatio`) ,e.IconFontFamily=`Chess V3`,e.IconText=`B`, __set$(e,e.ForegroundColor=9210504,`ForegroundColor`) , __set$(e,e.BackgroundColor=15856113,`BackgroundColor`) })(e.CloseButton||={})})(e.PromotionWindow||={})})(gI||={}),(e=>{(e=>{e.ForWhite=`#38DCFF`,e.ForBlack=`#FF5252`})(e.AccentColors||={}),(e=>{ __set$(e,e.CheckDuration=600,`CheckDuration`) , __set$(e,e.SVGEffectScale=1.1875,`SVGEffectScale`) })(e.AttackedKing||={}),(e=>{e.Duration=250})(e.CustomItem||={}),(e=>{ __set$(e,e.Duration=150,`Duration`) })(e.Highlight||={}),(e=>{ __set$(e,e.BorderWidthRatio=.05,`BorderWidthRatio`) })(e.MoveHighlight||={}),(e=>{ __set$(e,e.Duration=300,`Duration`) })(e.Hint||={}),(e=>{ __set$(e,e.BorderWidthRatio=.05,`BorderWidthRatio`) })(e.HoverSquare||={}),(e=>{(e=>{ __set$(e,e.Duration=500,`Duration`) , __set$(e,e.Scale=1.1,`Scale`) })(e.Pulse||={}),(e=>{ __set$(e,e.Blur=.8,`Blur`) , __set$(e,e.Opacity=.4,`Opacity`) , __set$(e,e.SizeRatio=.08,`SizeRatio`) })(e.Shadow||={})})(e.PieceDrag||={}),(e=>{(e=>{ __set$(e,e.Duration=40,`Duration`) })(e.General||={})})(e.PieceDrop||={}),(e=>{(e=>{ __set$(e,e.Duration=400,`Duration`) , __set$(e,e.Scale=1.1,`Scale`) })(e.General||={}),(e=>{ __set$(e,e.WidthRatio=.55,`WidthRatio`) , __set$(e,e.StartOffsetRatio=.35,`StartOffsetRatio`) })(e.Trail||={})})(e.PieceMove||={}),(e=>{e.ArcRatio=.5})(e.RookMove||={}),(e=>{ __set$(e,e.Duration=150,`Duration`) , __set$(e,e.DelayRatio=.3,`DelayRatio`) })(e.PieceCapture||={})})(_I||={}),(e=>{(e=>{e.CheckDuration=600,e.CheckmateDuration=800,e.HighlightedSquareColor=`#ff0000`})(e.AttackedKing||={});let t;(e=>{e.Scale=1.1,e.DragStrength=100,e.MaxRotation=10,e.RotationSpeed=20,(e=>{ __set$(e,e.Blur=.8,`Blur`) , __set$(e,e.Opacity=.3,`Opacity`) , __set$(e,e.SizeRatio=.08,`SizeRatio`) })(e.Shadow||={})})(t=e.PieceDrag||={}),(e=>{(e=>{ __set$(e,e.Duration=20,`Duration`) })(e.General||={}),(e=>{ __set$(e,e.Duration=1e3,`Duration`) , __set$(e,e.CaptureDuration=1e3,`CaptureDuration`) , __set$(e,e.Color=0,`Color`) , __set$(e,e.Opacity=.125,`Opacity`) })(e.AfterDropEffect||={})})(e.PieceDrop||={}),(e=>{e.Duration=300,e.Scale=t.Scale,(e=>{ __set$(e,e.Blur=.8,`Blur`) , __set$(e,e.Opacity=.3,`Opacity`) , __set$(e,e.SizeRatio=.08,`SizeRatio`) })(e.Shadow||={}),(e=>{ __set$(e,e.WidthRatio=.8,`WidthRatio`) , __set$(e,e.StartOffsetRatio=.35,`StartOffsetRatio`) })(e.Trail||={})})(e.PieceMove||={}),(e=>{e.ArcRatio=.5})(e.RookMove||={}),(e=>{ __set$(e,e.Duration=150,`Duration`) , __set$(e,e.DelayRatio=.3,`DelayRatio`) })(e.PieceCapture||={}),(e=>{ __set$(e,e.Duration=150,`Duration`) })(e.PieceRestore||={}),(e=>{ __set$(e,e.Duration=50,`Duration`) , __set$(e,e.SquareOutlineRatio=.06,`SquareOutlineRatio`) })(e.PieceOver||={}),(e=>{ __set$(e,e.Duration=50,`Duration`) })(e.PieceOut||={}),(e=>{e.Duration=250})(e.CustomItem||={}),(e=>{e.Duration=150})(e.Highlight||={}),(e=>{e.Duration=80,e.CaptureInitialSizeRatio=.4})(e.Hint||={}),(e=>{ __set$(e,e.Duration=100,`Duration`) , __set$(e,e.GrowRatio=1.5,`GrowRatio`) })(e.HintOver||={}),(e=>{ __set$(e,e.Duration=100,`Duration`) })(e.HintOut||={}),(e=>{ __set$(e,e.Duration=150,`Duration`) })(e.PromotionWindow||={})})(vI||={})}));function bI(e, _hh$temp1164 ){ var t=_hh$temp1164.piece,n=_hh$temp1164.illegalMove;  let _hh$temp1165=e,r=_hh$temp1165.scene,i=_hh$temp1165.svgAssets,a=_hh$temp1165.squareSize,o=NP({svgMarkup:i.kingCheck}); if(t.info.square){let n=KP(e,On(t.info.square));o.x=n.x,o.y=n.y}else o.x=t.obj.x,o.y=t.obj.y;return o.width=a*_I.AttackedKing.SVGEffectScale,o.height=a*_I.AttackedKing.SVGEffectScale,o.zIndex=gI.ObjectsRenderOrder.ElevatedVfx,r.addChild(o),e.animator.play({duration:_I.AttackedKing.CheckDuration,easing:vn,keepAlive:!0,keyframes:{0:{width:t.obj.width,height:t.obj.height},10:{width:t.obj.width*1.1,height:t.obj.height*1.1},100:{width:t.obj.width,height:t.obj.height}},onUpdate:e=>{ let _hh$temp1166=e.animatedProps,r=_hh$temp1166.width,i=_hh$temp1166.height; !n&&!e.keptAlive&&(t.obj.width=r,t.obj.height=i)},onEnd:()=>{o.playing&&o.destroy()}})}function xI(e, _hh$temp1167 ){ var t=_hh$temp1167.highlight,n=_hh$temp1167.interval,r=_hh$temp1167.times; return e.animator.play({duration:n,easing:_n,keyframes:{0:{alpha:0},50:{alpha:1},100:{alpha:0}},repeat:r,target:t.obj})}function SI(e, _hh$temp1168 ){ var t=_hh$temp1168.piece,n=_hh$temp1168.fromDrop;  let _hh$temp1169=e,r=_hh$temp1169.scene,i=_hh$temp1169.svgAssets,a=_hh$temp1169.squareSize,o=_I.PieceCapture.DelayRatio*(n?_I.PieceDrop.General.Duration:_I.PieceMove.General.Duration); return e.animator.play({delay:o,duration:_I.PieceCapture.Duration,keyframes:{0:{alpha:t.obj.alpha,width:t.obj.width,height:t.obj.height},100:{alpha:0,width:0,height:0}},target:t.obj,onStart:()=>{let e=NP({svgMarkup:i.pieceCapture});e.x=t.obj.x,e.y=t.obj.y,e.width=a,e.height=a,r.addChild(e)}})}function CI(e,t){ let _hh$temp1170=t,n=_hh$temp1170.position,_hh$temp1171=e,r=_hh$temp1171.squareSize,i=_hh$temp1171.svgAssets,a=NP({autoPlay:!1,autoDestroy:!1,svgMarkup:i.captureHintShow}); return a.x=n.x,a.y=n.y,a.width=r,a.height=r,a}function wI(e,t){return t.type===`move`?EI(e,t):TI(e,t)}function TI(e,t){return FF(e,t)}function EI(e,t){ let _hh$temp1172=t,n=_hh$temp1172.position,_hh$temp1173=e,r=_hh$temp1173.squareSize,i=r*.5,a=r*_I.MoveHighlight.BorderWidthRatio,o=new lM(); return o.lineStyle(a,16777215,1,0),o.drawRect(-i,-i,r,r),o.tint=t.turn===J.ColorsAsNumbers.White?dy(_I.AccentColors.ForWhite):dy(_I.AccentColors.ForBlack),o.x=n.x,o.y=n.y,o}function DI(e){ let _hh$temp1174=e,t=_hh$temp1174.scene,n=_hh$temp1174.squareSize,r=n*.5,i=n*_I.HoverSquare.BorderWidthRatio,a=new lM(); return a.lineStyle(i,16777215,1,0),a.drawRect(-r,-r,n,n),a.tint=dy(_I.AccentColors.ForWhite),a.visible=!1,t.addChild(a),a}function OI(e,t){ let _hh$temp1175=t,n=_hh$temp1175.position,_hh$temp1176=e,r=_hh$temp1176.squareSize,i=_hh$temp1176.svgAssets,a=NP({autoPlay:!1,autoDestroy:!1,svgMarkup:i.moveHintShow}); return a.x=n.x,a.y=n.y,a.width=r,a.height=r,a}function kI(e,t){ let _hh$temp1177=e,n=_hh$temp1177.squareSize,r=_hh$temp1177.scene,i=_hh$temp1177.svgAssets; vF(t);let a=NP({svgMarkup:i.pieceGrab,autoDestroy:!1,svgVars:{color:t.info.color===J.ColorsAsNumbers.White?_I.AccentColors.ForWhite:_I.AccentColors.ForBlack}});return a.x=t.obj.x,a.y=t.obj.y,a.width=n*1.75,a.height=n*1.75,r.addChild(a),t.obj.filters=[new jP({alpha:_I.PieceDrag.Shadow.Opacity,blur:_I.PieceDrag.Shadow.Blur,distance:n*_I.PieceDrag.Shadow.SizeRatio,resolution:CP.PixelRatio})],e.animator.play({duration:_I.PieceDrag.Pulse.Duration,easing:hn,keyframes:{0:{height:t.obj.height,width:t.obj.width},50:{height:t.obj.height*_I.PieceDrag.Pulse.Scale,width:t.obj.width*_I.PieceDrag.Pulse.Scale},100:{height:t.obj.height,width:t.obj.width}},repeat:1/0,target:t.obj,onUpdate:()=>{a.x=t.obj.x,a.y=t.obj.y},onEnd:()=>{a.destroy(),delete t.obj.filters}})}function AI(e, _hh$temp1178 ){ var t=_hh$temp1178.piece,n=_hh$temp1178.to;  let _hh$temp1179=e,r=_hh$temp1179.squareSize,i=_hh$temp1179.scene,a=_hh$temp1179.svgAssets,o=t.obj,s=o.width/r,c=new jP({alpha:_I.PieceDrag.Shadow.Opacity,blur:_I.PieceDrag.Shadow.Blur,distance:r*_I.PieceDrag.Shadow.SizeRatio,resolution:CP.PixelRatio}); o.filters=[c],o.angle=0;let l=NP({svgMarkup:a.pieceRelease,svgVars:{color:t.info.color===J.ColorsAsNumbers.White?_I.AccentColors.ForWhite:_I.AccentColors.ForBlack}});return l.x=t.obj.x,l.y=t.obj.y,l.width=r*1.75,l.height=r*1.75,i.addChild(l),e.animator.play({data:{shadow:c,state:e,animatedSVG:l,fillColor:t.info.color===J.ColorsAsNumbers.White?_I.AccentColors.ForWhite:_I.AccentColors.ForBlack},duration:_I.PieceDrop.General.Duration,keyframes:{0:{height:o.height,shadowDistance:c.distance,width:o.width,x:o.x,y:o.y},100:{height:o.height/s,shadowDistance:0,width:o.width/s,x:n.x,y:n.y}},onEnd:MI,onUpdate:jI,target:o})}function jI(e){let t=e.params.target,n=e.data.shadow,r=e.data.animatedSVG;n.distance=e.animatedProps.shadowDistance,r.playing&&(r.x=t.x,r.y=t.y)}function MI(e){ let t=e.params.target,n=e.data.state,r=e.data.fillColor,_hh$temp1180=n,i=_hh$temp1180.assetsLoaded,a=_hh$temp1180.scene,o=_hh$temp1180.svgAssets,s=_hh$temp1180.squareSize; if(delete t.filters,e.forcedEnd||!i)return;let c=NP({svgMarkup:o.squareFill,svgVars:{color:r}});c.x=t.x,c.y=t.y,c.width=s,c.height=s,a.addChild(c)}function NI(e,t){return e.animator.play({duration:_I.CustomItem.Duration,keyframes:{0:{alpha:t.obj.alpha,width:t.obj.width,height:t.obj.height},100:{alpha:0,width:t.obj.width*2,height:t.obj.height*2}},target:t.obj})}function PI(e,t){return e.animator.play({duration:_I.Highlight.Duration,easing:mn,keyframes:{0:{alpha:t.obj.alpha},100:{alpha:0}},target:t.obj})}function FI(e,t){ let _hh$temp1181=e,n=_hh$temp1181.svgAssets; return VP(t.obj,{svgMarkup:t.info.type===CP.Hint.Type.Capture?n.captureHintHide:n.moveHintHide}),e.animator.play({duration:_I.Hint.Duration})}function II(e,t){ let _hh$temp1182=e,n=_hh$temp1182.svgAssets; return VP(t.obj,{autoDestroy:!1,svgMarkup:t.info.type===CP.Hint.Type.Capture?n.captureHintOver:n.moveHintOver}),t.obj.play(),e.animator.play({keepAlive:!0})}function LI(e,t){ let _hh$temp1183=e,n=_hh$temp1183.svgAssets; return VP(t.obj,{autoDestroy:!1,svgMarkup:t.info.type===CP.Hint.Type.Capture?n.captureHintOut:n.moveHintOut}),e.animator.play({duration:1})}function RI(e){ let t=SP(`two-d/arcade`),_hh$temp1184=e,n=_hh$temp1184.svgAssets,r=[{name:`pieceTrail`,url:`${t}/piece-trail.svg`},{name:`pieceGrab`,url:`${t}/piece-grab.svg`},{name:`pieceRelease`,url:`${t}/piece-release.svg`},{name:`pieceCapture`,url:`${t}/piece-capture.svg`},{name:`squareFill`,url:`${t}/square-fill.svg`},{name:`kingCheck`,url:`${t}/king-check.svg`},{name:`moveHintShow`,url:`${t}/move-hint-show.svg`},{name:`moveHintHide`,url:`${t}/move-hint-hide.svg`},{name:`moveHintOver`,url:`${t}/move-hint-over.svg`},{name:`moveHintOut`,url:`${t}/move-hint-out.svg`},{name:`captureHintShow`,url:`${t}/capture-hint-show.svg`},{name:`captureHintHide`,url:`${t}/capture-hint-hide.svg`},{name:`captureHintOver`,url:`${t}/capture-hint-over.svg`},{name:`captureHintOut`,url:`${t}/capture-hint-out.svg`}]; return r.forEach(e=>{ __set$(n,e.name,``) }), new Promise(t=>{FP(r).then(r=>{e.destroyed||(Object.keys(r).forEach(e=>{__set$(n,e,__get$(r,e));}),t());});}) }function zI(e, _hh$temp1185 ){ var t=_hh$temp1185.piece,n=_hh$temp1185.from,r=_hh$temp1185.to,i=_hh$temp1185.castling,a=_hh$temp1185.capturing;  let _hh$temp1186=e,o=_hh$temp1186.animator,s=_hh$temp1186.scene,c=_hh$temp1186.squareSize,l=_hh$temp1186.svgAssets,u=i&&t.info.type===J.Piece.Types.Rook; t.obj.angle=0,MF(e,t);let d=LP(l.pieceTrail,{color:t.info.color===J.ColorsAsNumbers.White?_I.AccentColors.ForWhite:_I.AccentColors.ForBlack}),f=eI({start:t.obj.position,end:new hE(n.x,n.y),texture:zP(d),width:c*_I.PieceMove.Trail.WidthRatio});s.addChild(f.obj);let p=u?VI(e,{capturing:a,from:n,pieceObj:t.obj,trail:f,to:r}):BI(e,{capturing:a,from:n,pieceObj:t.obj,trail:f,to:r});return vF(t),o.play(p)}function BI(e, _hh$temp1187 ){ var t=_hh$temp1187.pieceObj,n=_hh$temp1187.from,r=_hh$temp1187.to,i=_hh$temp1187.capturing,a=_hh$temp1187.trail;  let _hh$temp1188=e,o=_hh$temp1188.squareSize,s={data:{capturing:i,trail:a,trailStartOffset:n.x===r.x&&!xF(e)?o*_I.PieceMove.Trail.StartOffsetRatio:0,state:e},duration:_I.PieceMove.General.Duration,keyframes:{0:{height:t.height,width:t.width,x:n.x,y:n.y,trailEndX:n.x,trailEndY:n.y,trailOpacity:1},30:{height:t.height*_I.PieceMove.General.Scale,width:t.width*_I.PieceMove.General.Scale,trailEndX:n.x,trailEndY:n.y},60:{height:t.height,width:t.width,x:r.x,y:r.y,trailOpacity:1},100:{height:t.height,width:t.width,x:r.x,y:r.y,trailEndX:r.x,trailEndY:r.y,trailOpacity:0}},onEnd:UI,onUpdate:HI,target:t}; return n.x===r.x&&n.y<r.y&&(s.keyframes[50]={trailEndX:n.x,trailEndY:n.y}),s}function VI(e, _hh$temp1189 ){ var t=_hh$temp1189.pieceObj,n=_hh$temp1189.from,r=_hh$temp1189.to,i=_hh$temp1189.capturing,a=_hh$temp1189.trail; let o=BI(e,{capturing:i,from:n,pieceObj:t,to:r,trail:a}),s=o.keyframes[30],c=t.y>t.height,l=t.height*_I.RookMove.ArcRatio*(c?-1:1);return o.easing=hn,s.y=t.y+l,o}function HI(e){ let t=e.data.trail,n=e.data.trailStartOffset,_hh$temp1190=e.animatedProps,r=_hh$temp1190.x,i=_hh$temp1190.y,a=_hh$temp1190.trailEndX,o=_hh$temp1190.trailEndY,s=_hh$temp1190.trailOpacity; nI(t,{start:new hE(r,i+n),end:new hE(a,o+n),opacity:s})}function UI(e){let t=e.params.target,n=e.data.trail;delete t.filters,tI(n)}function WI(e,t){return e.animator.play({duration:_I.Highlight.Duration,easing:mn,keyframes:{0:{alpha:0},100:{alpha:t.obj.alpha}},target:t.obj})}function GI(e,t){ let _hh$temp1191=e,n=_hh$temp1191.selectedPiece,r=e.hoverSquare; r&&(r.visible=!0,r.position.x=t.x,r.position.y=t.y,n&&n.info.color===J.ColorsAsNumbers.Black?r.tint=dy(_I.AccentColors.ForBlack):r.tint=dy(_I.AccentColors.ForWhite))}function KI(e,t){return t.obj.play(),e.animator.play({duration:1})}function qI(e, _hh$temp1192 ){ var t=_hh$temp1192.piece,n=_hh$temp1192.illegalMove;  let _hh$temp1193=e,r=_hh$temp1193.scene,i=_hh$temp1193.isCheckmate,a=FF(e,{color:vI.AttackedKing.HighlightedSquareColor,opacity:0,position:t.obj.position,square:`a1`}); r.addChild(a);let o=e.animator.play(JI(e,a));return e.animator.play({duration:i?vI.AttackedKing.CheckmateDuration:vI.AttackedKing.CheckDuration,easing:i?bn:vn,keepAlive:i,keyframes:{0:{width:t.obj.width,height:t.obj.height},10:{width:t.obj.width*1.1,height:t.obj.height*1.1},100:{width:t.obj.width,height:t.obj.height}},onUpdate:r=>{ let _hh$temp1194=r.animatedProps,i=_hh$temp1194.width,o=_hh$temp1194.height; !n&&!r.keptAlive&&(t.obj.width=i,t.obj.height=o),a.position=t.obj.position,a.width=e.squareSize,a.height=e.squareSize},onEnd:()=>{e.animator.end(o),a.destroy()}})}function JI(e,t){ let _hh$temp1195=e,n=_hh$temp1195.isCheckmate; return n?{duration:vI.AttackedKing.CheckmateDuration,easing:pn,keyframes:{0:{alpha:0},50:{alpha:.75},100:{alpha:.75}},target:t}:{duration:vI.AttackedKing.CheckDuration,easing:vn,keyframes:{0:{alpha:0},10:{alpha:.75},100:{alpha:0}},target:t}}function YI(e, _hh$temp1196 ){ var t=_hh$temp1196.highlight,n=_hh$temp1196.interval,r=_hh$temp1196.times; return e.animator.play({duration:n,easing:_n,keyframes:{0:{alpha:0},50:{alpha:1},100:{alpha:0}},repeat:r,target:t.obj})}function XI(e, _hh$temp1197 ){ var t=_hh$temp1197.piece,n=_hh$temp1197.fromDrop; let r=vI.PieceCapture.DelayRatio*(n?vI.PieceDrop.General.Duration:vI.PieceMove.Duration);return e.animator.play({delay:r,duration:vI.PieceCapture.Duration,keyframes:{0:{alpha:t.obj.alpha,width:t.obj.width,height:t.obj.height},100:{alpha:0,width:0,height:0}},target:t.obj})}function ZI( _hh$temp1198 ){ var e=_hh$temp1198.from,t=_hh$temp1198.to,n=_hh$temp1198.alpha,_hh$temp1198$restrictAlpha=_hh$temp1198.restrictAlpha,r=_hh$temp1198$restrictAlpha===void 0?!0:_hh$temp1198$restrictAlpha; let i=r?Kd(n,{min:0,max:1}):n;return e*(1-i)+t*i}function QI(e,t){ let _hh$temp1199=e,n=_hh$temp1199.squareSize; return vF(t),t.obj.height*=vI.PieceDrag.Scale,t.obj.width*=vI.PieceDrag.Scale,t.obj.filters=[new jP({alpha:vI.PieceDrag.Shadow.Opacity,blur:vI.PieceDrag.Shadow.Blur,distance:n*vI.PieceDrag.Shadow.SizeRatio,resolution:CP.PixelRatio})],e.animator.play({data:{lastPositionX:t.obj.position.x,piece:t},onEnd:eL,onUpdate:$I})}function $I(e){ let t=e.data,n=t.piece,r=t.lastPositionX,_hh$temp1200=e.frameInfo,i=_hh$temp1200.deltaTime,a=n.obj.position.x,o=a-r,s=Kd(vI.PieceDrag.DragStrength*o*i,{max:vI.PieceDrag.MaxRotation,min:-vI.PieceDrag.MaxRotation}); n.obj.angle=ZI({from:n.obj.angle,to:s,alpha:vI.PieceDrag.RotationSpeed*i}),t.lastPositionX=a}function eL(e){let t=e.data.piece;t.obj.height/=vI.PieceDrag.Scale,t.obj.width/=vI.PieceDrag.Scale,delete t.obj.filters}function tL(e, _hh$temp1201 ){ var t=_hh$temp1201.duration,n=_hh$temp1201.position,r=_hh$temp1201.color,i=_hh$temp1201.opacity;  let _hh$temp1202=e,a=_hh$temp1202.animator,o=_hh$temp1202.scene,s=_hh$temp1202.squareSize,c=new lM(),l=new lM(); l.beginFill(0),l.drawRect(s*-.5,s*-.5,s,s),l.position=n,c.beginFill(r,i),c.drawCircle(0,0,s),c.scale.x=0,c.scale.y=0,c.position=n,c.mask=l,o.addChild(c),o.addChild(l),a.play({duration:t,keyframes:{0:{scale:.2,opacity:1},100:{scale:1,opacity:0}},easing:yn,onUpdate:e=>{ let _hh$temp1203=e,t=_hh$temp1203.animatedProps; c.scale.x=t.scale,c.scale.y=t.scale,c.alpha=t.opacity},onEnd:()=>{l.destroy(),c.destroy()}})}function nL(e, _hh$temp1204 ){ var t=_hh$temp1204.piece,n=_hh$temp1204.to,r=_hh$temp1204.capturing;  let _hh$temp1205=e,i=_hh$temp1205.squareSize,a=t.obj,o=new jP({alpha:vI.PieceDrag.Shadow.Opacity,blur:vI.PieceDrag.Shadow.Blur,distance:i*vI.PieceDrag.Shadow.SizeRatio,resolution:CP.PixelRatio}); return t.obj.height*=vI.PieceDrag.Scale,t.obj.width*=vI.PieceDrag.Scale,a.filters=[o],a.angle=0,e.animator.play({data:{capturing:r,shadow:o,state:e},duration:vI.PieceDrop.General.Duration,keyframes:{0:{height:a.height,shadowBlur:o.blur,shadowDistance:o.distance,shadowOpacity:o.alpha,width:a.width,x:a.x,y:a.y},100:{height:a.height/vI.PieceDrag.Scale,shadowBlur:0,shadowDistance:0,shadowOpacity:0,width:a.width/vI.PieceDrag.Scale,x:n.x,y:n.y}},onEnd:iL,onUpdate:rL,target:a})}function rL(e){ let t=e.data.shadow,_hh$temp1206=e.animatedProps,n=_hh$temp1206.shadowBlur,r=_hh$temp1206.shadowDistance,i=_hh$temp1206.shadowOpacity; t.blur=n,t.distance=r,t.alpha=i}function iL(e){ let t=e.params.target,n=e.data.state,_hh$temp1207=n,r=_hh$temp1207.assetsLoaded; delete t.filters,!(e.forcedEnd||!r)&&tL(n,{duration:vI.PieceDrop.AfterDropEffect.Duration,position:t.position,color:vI.PieceDrop.AfterDropEffect.Color,opacity:vI.PieceDrop.AfterDropEffect.Opacity})}function aL(e,t){return e.animator.play({duration:vI.CustomItem.Duration,keyframes:{0:{alpha:t.obj.alpha,width:t.obj.width,height:t.obj.height},100:{alpha:0,width:t.obj.width*2,height:t.obj.height*2}},target:t.obj})}function oL(e,t){return e.animator.play({duration:vI.Highlight.Duration,easing:mn,keyframes:{0:{alpha:t.obj.alpha},100:{alpha:0}},target:t.obj})}function sL(e,t){return e.animator.play({duration:vI.Hint.Duration,easing:mn,keyframes:{0:{height:t.obj.height,width:t.obj.width},100:{height:0,width:0}},target:t.obj})}function cL(e){return e.animator.play({duration:vI.PromotionWindow.Duration,keyframes:{0:{alpha:1},100:{alpha:0}},target:e.promotionWindow})}function lL(e,t){let n=t.info.type===CP.Hint.Type.Capture?dL(e,t):uL(e,t);return e.animator.play(n)}function uL(e,t){ let _hh$temp1208=e,n=_hh$temp1208.squareSize; return{duration:vI.HintOver.Duration,easing:yn,keepAlive:!0,keyframes:{0:{width:t.obj.width,height:t.obj.height},100:{width:n*vI.HintOver.GrowRatio,height:n*vI.HintOver.GrowRatio}},target:t.obj}}function dL(e,t){ let _hh$temp1209=e,n=_hh$temp1209.squareSize; return{duration:vI.HintOver.Duration,easing:yn,keepAlive:!0,keyframes:{0:{innerRadiusRatio:Kb.CaptureHint.InnerRadiusRatio},100:{innerRadiusRatio:.1}},onUpdate:e=>{ let _hh$temp1210=e.animatedProps,r=_hh$temp1210.innerRadiusRatio; dF(t.obj,{squareSize:n,innerRadiusRatio:r})}}}function fL(e,t){let n=t.info.type===CP.Hint.Type.Capture?mL(e,t):pL(e,t);return e.animator.play(n)}function pL(e,t){ let _hh$temp1211=e,n=_hh$temp1211.squareSize; return{duration:vI.HintOut.Duration,easing:yn,keyframes:{0:{width:t.obj.width,height:t.obj.height},100:{width:n,height:n}},target:t.obj}}function mL(e,t){ let _hh$temp1212=e,n=_hh$temp1212.squareSize; return{duration:vI.HintOut.Duration,easing:yn,keepAlive:!0,keyframes:{0:{innerRadiusRatio:.1},100:{innerRadiusRatio:Kb.CaptureHint.InnerRadiusRatio}},onUpdate:e=>{ let _hh$temp1213=e.animatedProps,r=_hh$temp1213.innerRadiusRatio; dF(t.obj,{squareSize:n,innerRadiusRatio:r})}}}function hL(e){return  new Promise(t=>{let _hh$temp1214=e,n=_hh$temp1214.extraTextures,r=SP(`two-d/natural`),i=new Fj(),a=[{name:`pieceTrail`,url:`${r}/piece-trail.png`},{name:`pieceTrailLong`,url:`${r}/piece-trail-long.png`}];a.forEach(e=>{__set$(n,e.name,new dD(new ZE()));}),i.add(a).load(()=>{e.destroyed||(a.forEach(e=>{__get$(n,e.name).baseTexture.setResource(__get$(i.resources,e.name).texture.baseTexture.resource);}),i.destroy(),t());});}) }function gL(e, _hh$temp1215 ){ var t=_hh$temp1215.piece,n=_hh$temp1215.from,r=_hh$temp1215.to,i=_hh$temp1215.castling,a=_hh$temp1215.capturing;  let _hh$temp1216=e,o=_hh$temp1216.animator,s=_hh$temp1216.scene,c=_hh$temp1216.squareSize,l=_hh$temp1216.extraTextures,u=i&&t.info.type===J.Piece.Types.Rook; t.obj.angle=0,MF(e,t),t.obj.filters=[new jP({alpha:vI.PieceMove.Shadow.Opacity,blur:vI.PieceMove.Shadow.Blur,distance:c*vI.PieceMove.Shadow.SizeRatio,resolution:CP.PixelRatio})];let d=eI({start:t.obj.position,end:new hE(n.x,n.y),texture:n.x===r.x&&n.y<r.y?l.pieceTrailLong:l.pieceTrail,width:c*vI.PieceMove.Trail.WidthRatio});s.addChild(d.obj);let f=u?vL(e,{capturing:a,from:n,pieceObj:t.obj,trail:d,to:r}):_L(e,{capturing:a,from:n,pieceObj:t.obj,trail:d,to:r});return vF(t),o.play(f)}function _L(e, _hh$temp1217 ){ var t=_hh$temp1217.pieceObj,n=_hh$temp1217.from,r=_hh$temp1217.to,i=_hh$temp1217.capturing,a=_hh$temp1217.trail;  let _hh$temp1218=e,o=_hh$temp1218.squareSize,s=t.filters[0]; return{data:{capturing:i,shadow:s,trail:a,trailStartOffset:n.x===r.x&&!xF(e)?o*vI.PieceMove.Trail.StartOffsetRatio:0,state:e},duration:vI.PieceMove.Duration,keyframes:{0:{height:t.height,width:t.width,x:n.x,y:n.y,trailEndX:n.x,trailEndY:n.y,trailOpacity:1,shadowBlur:0,shadowDistance:0,shadowOpacity:0},30:{height:t.height*vI.PieceMove.Scale,width:t.width*vI.PieceMove.Scale,trailEndX:n.x,trailEndY:n.y,shadowBlur:s.blur,shadowDistance:s.distance,shadowOpacity:s.alpha},60:{height:t.height,width:t.width,x:r.x,y:r.y,trailOpacity:1,shadowBlur:0,shadowDistance:0,shadowOpacity:0},100:{height:t.height,width:t.width,x:r.x,y:r.y,trailEndX:r.x,trailEndY:r.y,trailOpacity:0,shadowBlur:0,shadowDistance:0,shadowOpacity:0}},onEnd:bL,onUpdate:yL,target:t}}function vL(e, _hh$temp1219 ){ var t=_hh$temp1219.pieceObj,n=_hh$temp1219.from,r=_hh$temp1219.to,i=_hh$temp1219.capturing,a=_hh$temp1219.trail; let o=_L(e,{capturing:i,from:n,pieceObj:t,to:r,trail:a}),s=o.keyframes[30],c=t.y>t.height,l=t.height*vI.RookMove.ArcRatio*(c?-1:1);return o.easing=hn,s.y=t.y+l,o}function yL(e){ let t=e.data.shadow,n=e.data.trail,r=e.data.trailStartOffset,_hh$temp1220=e.animatedProps,i=_hh$temp1220.x,a=_hh$temp1220.y,o=_hh$temp1220.trailEndX,s=_hh$temp1220.trailEndY,c=_hh$temp1220.trailOpacity,l=_hh$temp1220.shadowBlur,u=_hh$temp1220.shadowDistance,d=_hh$temp1220.shadowOpacity; t.blur=l,t.distance=u,t.alpha=d,nI(n,{start:new hE(i,a+r),end:new hE(o,s+r),opacity:c})}function bL(e){let t=e.params.target,n=e.data.trail;delete t.filters,tI(n)}function xL(e,t){ let _hh$temp1221=e,n=_hh$temp1221.animator,r=_hh$temp1221.scene,i=_hh$temp1221.squareSize,a=rI(i,i*vI.PieceOver.SquareOutlineRatio); return a.x=t.obj.x,a.y=t.obj.y,r.addChild(a),n.play({duration:vI.PieceOut.Duration,easing:gn,keyframes:{0:{alpha:1},100:{alpha:0}},target:a,onEnd:()=>{a.destroy()}})}function SL(e, _hh$temp1222 ){ var t=_hh$temp1222.piece;  let _hh$temp1223=e,n=_hh$temp1223.animator,r=_hh$temp1223.scene,i=_hh$temp1223.squareSize,a=rI(i,i*vI.PieceOver.SquareOutlineRatio); return a.x=t.obj.x,a.y=t.obj.y,r.addChild(a),n.play({duration:vI.PieceOver.Duration,keepAlive:!0,easing:gn,keyframes:{0:{alpha:0},100:{alpha:1}},target:a,onEnd:()=>{a.destroy()}})}function CL(e,t){return t.obj.alpha=0,e.animator.play({duration:vI.PieceRestore.Duration,keyframes:{0:{alpha:0,width:0,height:0},100:{alpha:1,width:t.obj.width,height:t.obj.height}},target:t.obj})}function wL(e,t){return e.animator.play({duration:vI.Highlight.Duration,easing:mn,keyframes:{0:{alpha:0},100:{alpha:t.obj.alpha}},target:t.obj})}function TL(e,t){let n=0,r=0;return t.info.type===CP.Hint.Type.Capture&&(n=t.obj.width*vI.Hint.CaptureInitialSizeRatio,r=t.obj.height*vI.Hint.CaptureInitialSizeRatio),e.animator.play({duration:vI.Hint.Duration,easing:mn,keyframes:{0:{height:r,width:n},100:{height:t.obj.height,width:t.obj.width}},target:t.obj})}function EL(e){return e.animator.play({duration:vI.PromotionWindow.Duration,keyframes:{0:{alpha:0},100:{alpha:1}},target:e.promotionWindow})}function DL(e){ let _hh$temp1224=e,t=_hh$temp1224.containerEl,n=_hh$temp1224.isPromotionWindowVisible,r=_hh$temp1224.pointer; n||bF(e,r.boardPosition)&&t.classList.add(gI.CssClasses.PieceDrag)}function OL(e){ let _hh$temp1225=e,t=_hh$temp1225.containerEl,n=_hh$temp1225.isPromotionWindowVisible,r=_hh$temp1225.pointer,i=_hh$temp1225.selectedPiece; if(!e.isBoardEnabled||n)return;let a=bF(e,r.boardPosition);!i&&a?t.classList.add(gI.CssClasses.PieceHover):i||t.classList.remove(gI.CssClasses.PieceHover)}function kL(e){ let _hh$temp1226=e,t=_hh$temp1226.containerEl,n=_hh$temp1226.isPromotionWindowVisible,r=_hh$temp1226.options; !r.enabled||n||t.classList.remove(gI.CssClasses.PieceDrag)}function AL( _hh$temp1227 ){ var e=_hh$temp1227.el,_hh$temp1227$emitter=_hh$temp1227.emitter,t=_hh$temp1227$emitter===void 0?s():_hh$temp1227$emitter,n=_hh$temp1227.options,_hh$temp1227$boardStyles=_hh$temp1227.boardStyles,r=_hh$temp1227$boardStyles===void 0?Xb:_hh$temp1227$boardStyles,_hh$temp1227$pieceStyles=_hh$temp1227.pieceStyles,i=_hh$temp1227$pieceStyles===void 0?Zb:_hh$temp1227$pieceStyles,a=_hh$temp1227.testElement; let o=n.animationType===Qb.Animation.Types.Arcade?jL:ML,c={addAnalysisOverlay:VF,addArrow:XP,addCustomItem:tF,addEffect:aF,addHighlight:PF,addHint:uF,addPiece:gF,closePromotionWindow:cI,createArrowObj:ZP,createCaptureHintObj:fF,createCustomItemObj:nF,createEffectObj:oF,createHighlightObj:FF,createHoverSquareObj:IF,createMoveHintObj:pF,createPieceObj:_F,createState:HP,destroy:WP,fadeInAllPieces:yF,fileRankToPosition:KP,flipBoard:HF,getBoardPosition:qP,getPieceStyles:()=>i,getViewPosition:JP,getViewAspectRatio:YP,hideHoverSquare:LF,init:JF,loadAssets:iI,normalizePointer:YF,onPieceDrop:SF,onPieceMoved:CF,onPiecesLoaded:wF,onPiecesVisualsChanged:TF,onPointerDown:DL,onPointerMove:OL,onPointerUp:kL,onWebGLContextLost:XF,openPromotionWindow:mI,positionToFileRank:ZF,positionToNearestSquare:QF,removeAnalysisOverlay:UF,removeArrow:eF,removeCustomItem:iF,removeEffect:cF,removeHighlight:zF,removeHint:hF,removePiece:OF,render:$F,setPiecePosition:kF,showHoverSquare:BF,updateBoardCoordinates:WF,updateBoardStyle:aI,updatePiecesStyle:sI,updatePieceVisuals:NF,updateViewSize:qF};return $N({animationMethods:o,boardThemes:r,emitter:t,pieceThemes:i,className:gI.CssClasses.Board,containerEl:e,methods:c,name:nx.Types.WebGL2D,options:n,testElement:a})}var jL,ML,NL=e((()=>{yI(),KM(),ZO(),wP(),bt(),MP(),jL=Object.freeze(Object.defineProperty({__proto__:null,attackKing:bI,blinkHighlight:xI,capturePiece:SI,createCaptureHintObj:CI,createHighlightObj:wI,createHoverSquareObj:DI,createMoveHintObj:OI,dragPiece:kI,dropPiece:AI,hideCustomItem:NI,hideHighlight:PI,hideHint:FI,hintOut:LI,hintOver:II,loadAssets:RI,movePiece:zI,showHighlight:WI,showHint:KI,showHoverSquare:GI},Symbol.toStringTag,{value:`Module`})),ML=Object.freeze(Object.defineProperty({__proto__:null,attackKing:qI,blinkHighlight:YI,capturePiece:XI,dragPiece:QI,dropPiece:nL,hideCustomItem:aL,hideHighlight:oL,hideHint:sL,hidePromotionWindow:cL,hintOut:fL,hintOver:lL,loadAssets:hL,movePiece:gL,pieceOut:xL,pieceOver:SL,restorePiece:CL,showHighlight:wL,showHint:TL,showPromotionWindow:EL},Symbol.toStringTag,{value:`Module`}))}));function PL(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return( __get$(gW,e&255) + __get$(gW,e>>8&255) + __get$(gW,e>>16&255) + __get$(gW,e>>24&255) +`-`+ __get$(gW,t&255) + __get$(gW,t>>8&255) +`-`+ __get$(gW,t>>16&15|64) + __get$(gW,t>>24&255) +`-`+ __get$(gW,n&63|128) + __get$(gW,n>>8&255) +`-`+ __get$(gW,n>>16&255) + __get$(gW,n>>24&255) + __get$(gW,r&255) + __get$(gW,r>>8&255) + __get$(gW,r>>16&255) + __get$(gW,r>>24&255) ).toLowerCase()}function FL(e,t,n){return Math.max(t,Math.min(n,e))}function IL(e,t){return(e%t+t)%t}function LL(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)}function RL(e,t,n){return e===t?0:(n-e)/(t-e)}function zL(e,t,n){return(1-n)*e+n*t}function BL(e,t,n,r){return zL(e,t,1-Math.exp(-n*r))}function VL(e,t=1){return t-Math.abs(IL(e,t*2)-t)}function HL(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))}function UL(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(e*6-15)+10))}function WL(e,t){return e+Math.floor(Math.random()*(t-e+1))}function GL(e,t){return e+Math.random()*(t-e)}function KL(e){return e*(.5-Math.random())}function qL(e){e!==void 0&&(_W=e);let t=_W+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function JL(e){return e*vW}function YL(e){return e*yW}function XL(e){return(e&e-1)==0&&e!==0}function ZL(e){return 2**Math.ceil(Math.log(e)/Math.LN2)}function QL(e){return 2**Math.floor(Math.log(e)/Math.LN2)}function $L(e,t,n,r,i){let a=Math.cos,o=Math.sin,s=a(n/2),c=o(n/2),l=a((t+r)/2),u=o((t+r)/2),d=a((t-r)/2),f=o((t-r)/2),p=a((r-t)/2),m=o((r-t)/2);switch(i){case`XYX`:e.set(s*u,c*d,c*f,s*l);break;case`YZY`:e.set(c*f,s*u,c*d,s*l);break;case`ZXZ`:e.set(c*d,c*f,s*u,s*l);break;case`XZX`:e.set(s*u,c*m,c*p,s*l);break;case`YXY`:e.set(c*p,s*u,c*m,s*l);break;case`ZYZ`:e.set(c*m,c*p,s*u,s*l);break;default:console.warn(`THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: `+i)}}function eR(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw Error(`Invalid component type.`)}}function tR(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw Error(`Invalid component type.`)}}function nR(e){for(let t=e.length-1;t>=0;--t)if( __get$(e,t) >65535)return!0;return!1}function rR(e,t){return new SW[e](t)}function iR(e){return document.createElementNS(`http://www.w3.org/1999/xhtml`,e)}function aR(e){return e<.04045?e*.0773993808:(e*.9478672986+.0521327014)**2.4}function oR(e){return e<.0031308?e*12.92:1.055*e**.41666-.055}function sR(e,t,n){return n<0&&(n+=1),n>1&&--n,n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*6*(2/3-n):e}function cR(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}function lR(e){return typeof HTMLImageElement<`u`&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<`u`&&e instanceof HTMLCanvasElement||typeof ImageBitmap<`u`&&e instanceof ImageBitmap?jW.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn(`THREE.Texture: Unable to serialize Texture.`),{})}function uR(e,t,n,r,i){for(let a=0,o=e.length-3;a<=o;a+=3){iG.fromArray(e,a);let o=i.x*Math.abs(iG.x)+i.y*Math.abs(iG.y)+i.z*Math.abs(iG.z),s=t.dot(iG),c=n.dot(iG),l=r.dot(iG);if(Math.max(-Math.max(s,c,l),Math.min(s,c,l))>o)return!1}return!0}function dR(e,t,n,r,i,a,o,s){let c;if(c=t.side===yV?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side!==2,s),c===null)return null;VK.copy(s),VK.applyMatrix4(e.matrixWorld);let l=n.ray.origin.distanceTo(VK);return l<n.near||l>n.far?null:{distance:l,point:VK.clone(),object:e}}function fR(e,t,n,r,i,a,o,s,c,l,u,d){OK.fromBufferAttribute(i,l),kK.fromBufferAttribute(i,u),AK.fromBufferAttribute(i,d);let f=e.morphTargetInfluences;if(a&&f){PK.set(0,0,0),FK.set(0,0,0),IK.set(0,0,0);for(let e=0,t=a.length;e<t;e++){let t= __get$(f,e) ,n= __get$(a,e) ;t!==0&&(jK.fromBufferAttribute(n,l),MK.fromBufferAttribute(n,u),NK.fromBufferAttribute(n,d),o?(PK.addScaledVector(jK,t),FK.addScaledVector(MK,t),IK.addScaledVector(NK,t)):(PK.addScaledVector(jK.sub(OK),t),FK.addScaledVector(MK.sub(kK),t),IK.addScaledVector(NK.sub(AK),t)))}OK.add(PK),kK.add(FK),AK.add(IK)}e.isSkinnedMesh&&(e.boneTransform(l,OK),e.boneTransform(u,kK),e.boneTransform(d,AK));let p=dR(e,t,n,r,OK,kK,AK,BK);if(p){s&&(LK.fromBufferAttribute(s,l),RK.fromBufferAttribute(s,u),zK.fromBufferAttribute(s,d),p.uv=eK.getUV(BK,OK,kK,AK,LK,RK,zK,new Z)),c&&(LK.fromBufferAttribute(c,l),RK.fromBufferAttribute(c,u),zK.fromBufferAttribute(c,d),p.uv2=eK.getUV(BK,OK,kK,AK,LK,RK,zK,new Z));let e={a:l,b:u,c:d,normal:new Q,materialIndex:0};eK.getNormal(OK,kK,AK,e.normal),p.face=e}return p}function pR(e){let t={};for(let n in e)for(let r in  __set$(t,n,{}) , __get$(e,n) ){let i= __get$(__get$(e,n),r) ;i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)? __set$(__get$(t,n),r,i.clone()) :Array.isArray(i)? __set$(__get$(t,n),r,i.slice()) : __set$(__get$(t,n),r,i) }return t}function mR(e){let t={};for(let n=0;n<e.length;n++){let r=pR( __get$(e,n) );for(let e in r) __set$(t,e,__get$(r,e)) }return t}function hR(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){t!==!0&&n!==null&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function gR(e,t){let n=t.isWebGL2,r=new WeakMap;function i(t,r){let i=t.array,a=t.usage,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,i,a),t.onUploadCallback();let s;if(i instanceof Float32Array)s=5126;else if(i instanceof Uint16Array)if(t.isFloat16BufferAttribute)if(n)s=5131;else throw Error(`THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.`);else s=5123;else if(i instanceof Int16Array)s=5122;else if(i instanceof Uint32Array)s=5125;else if(i instanceof Int32Array)s=5124;else if(i instanceof Int8Array)s=5120;else if(i instanceof Uint8Array)s=5121;else if(i instanceof Uint8ClampedArray)s=5121;else throw Error(`THREE.WebGLAttributes: Unsupported buffer data format: `+i);return{buffer:o,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}function a(t,r,i){let a=r.array,o=r.updateRange;e.bindBuffer(i,t),o.count===-1?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}function o(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)}function s(t){t.isInterleavedBufferAttribute&&(t=t.data);let n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))}function c(e,t){if(e.isGLBufferAttribute){let t=r.get(e);(!t||t.version<e.version)&&r.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version});return}e.isInterleavedBufferAttribute&&(e=e.data);let n=r.get(e);n===void 0?r.set(e,i(e,t)):n.version<e.version&&(a(n.buffer,e,t),n.version=e.version)}return{get:o,remove:s,update:c}}function _R(e,t,n,r,i,a){let o=new kW(0),s=i===!0?0:1,c,l,u=null,d=0,f=null;function p(n,i){let a=!1,p=i.isScene===!0?i.background:null;p&&p.isTexture&&(p=t.get(p));let h=e.xr,g=h.getSession&&h.getSession();g&&g.environmentBlendMode===`additive`&&(p=null),p===null?m(o,s):p&&p.isColor&&(m(p,1),a=!0),(e.autoClear||a)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.mapping===fH)?(l===void 0&&(l=new HK(new UK(1,1,1),new qK({name:`BackgroundCubeMaterial`,uniforms:pR(dq.cube.uniforms),vertexShader:dq.cube.vertexShader,fragmentShader:dq.cube.fragmentShader,side:yV,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute(`normal`),l.geometry.deleteAttribute(`uv`),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,`envMap`,{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=p,l.material.uniforms.flipEnvMap.value=p.isCubeTexture&&p.isRenderTargetTexture===!1?-1:1,(u!==p||d!==p.version||f!==e.toneMapping)&&(l.material.needsUpdate=!0,u=p,d=p.version,f=e.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null)):p&&p.isTexture&&(c===void 0&&(c=new HK(new cq(2,2),new qK({name:`BackgroundMaterial`,uniforms:pR(dq.background.uniforms),vertexShader:dq.background.vertexShader,fragmentShader:dq.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute(`normal`),Object.defineProperty(c.material,`map`,{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=p,p.matrixAutoUpdate===!0&&p.updateMatrix(),c.material.uniforms.uvTransform.value.copy(p.matrix),(u!==p||d!==p.version||f!==e.toneMapping)&&(c.material.needsUpdate=!0,u=p,d=p.version,f=e.toneMapping),c.layers.enableAll(),n.unshift(c,c.geometry,c.material,0,0,null))}function m(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,a)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),s=t,m(o,s)},getClearAlpha:function(){return s},setClearAlpha:function(e){s=e,m(o,s)},render:p}}function vR(e,t,n,r){let i=e.getParameter(34921),a=r.isWebGL2?null:t.get(`OES_vertex_array_object`),o=r.isWebGL2||a!==null,s={},c=g(null),l=c,u=!1;function d(t,r,i,a,s){let c=!1;if(o){let e=h(a,i,r);l!==e&&(l=e,p(l.object)),c=_(t,a,i,s),c&&v(t,a,i,s)}else{let e=r.wireframe===!0;(l.geometry!==a.id||l.program!==i.id||l.wireframe!==e)&&(l.geometry=a.id,l.program=i.id,l.wireframe=e,c=!0)}s!==null&&n.update(s,34963),(c||u)&&(u=!1,w(t,r,i,a),s!==null&&e.bindBuffer(34963,n.get(s).buffer))}function f(){return r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()}function p(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function m(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function h(e,t,n){let r=n.wireframe===!0,i= __get$(s,e.id) ;i===void 0&&(i={}, __set$(s,e.id,i) );let a= __get$(i,t.id) ;a===void 0&&(a={}, __set$(i,t.id,a) );let o= __get$(a,r) ;return o===void 0&&(o=g(f()), __set$(a,r,o) ),o}function g(e){let t=[],n=[],r=[];for(let e=0;e<i;e++) __set$(t,e,0) , __set$(n,e,0) , __set$(r,e,0) ;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function _(e,t,n,r){let i=l.attributes,a=t.attributes,o=0,s=n.getAttributes();for(let t in s)if( __get$(__get$(s,t),"location") >=0){let n= __get$(i,t) ,r= __get$(a,t) ;if(r===void 0&&(t===`instanceMatrix`&&e.instanceMatrix&&(r=e.instanceMatrix),t===`instanceColor`&&e.instanceColor&&(r=e.instanceColor)),n===void 0||n.attribute!==r||r&&n.data!==r.data)return!0;o++}return l.attributesNum!==o||l.index!==r}function v(e,t,n,r){let i={},a=t.attributes,o=0,s=n.getAttributes();for(let t in s)if( __get$(__get$(s,t),"location") >=0){let n= __get$(a,t) ;n===void 0&&(t===`instanceMatrix`&&e.instanceMatrix&&(n=e.instanceMatrix),t===`instanceColor`&&e.instanceColor&&(n=e.instanceColor));let r={};r.attribute=n,n&&n.data&&(r.data=n.data), __set$(i,t,r) ,o++}l.attributes=i,l.attributesNum=o,l.index=r}function y(){let e=l.newAttributes;for(let t=0,n=e.length;t<n;t++) __set$(e,t,0) }function b(e){x(e,0)}function x(n,i){let a=l.newAttributes,o=l.enabledAttributes,s=l.attributeDivisors; __set$(a,n,1) , __get$(o,n) ===0&&(e.enableVertexAttribArray(n), __set$(o,n,1) ), __get$(s,n) !==i&&( __call$(r.isWebGL2?e:t.get(`ANGLE_instanced_arrays`),r.isWebGL2?`vertexAttribDivisor`:`vertexAttribDivisorANGLE`,[n,i]) , __set$(s,n,i) )}function S(){let t=l.newAttributes,n=l.enabledAttributes;for(let r=0,i=n.length;r<i;r++) __get$(n,r) !== __get$(t,r) &&(e.disableVertexAttribArray(r), __set$(n,r,0) )}function C(t,n,i,a,o,s){r.isWebGL2===!0&&(i===5124||i===5125)?e.vertexAttribIPointer(t,n,i,o,s):e.vertexAttribPointer(t,n,i,a,o,s)}function w(i,a,o,s){if(r.isWebGL2===!1&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&t.get(`ANGLE_instanced_arrays`)===null)return;y();let c=s.attributes,l=o.getAttributes(),u=a.defaultAttributeValues;for(let t in l){let r= __get$(l,t) ;if( __get$(r,"location") >=0){let a= __get$(c,t) ;if(a===void 0&&(t===`instanceMatrix`&&i.instanceMatrix&&(a=i.instanceMatrix),t===`instanceColor`&&i.instanceColor&&(a=i.instanceColor)),a!==void 0){let t=a.normalized,o=a.itemSize,c=n.get(a);if(c===void 0)continue;let l=c.buffer,u=c.type,d=c.bytesPerElement;if(a.isInterleavedBufferAttribute){let n=a.data,c=n.stride,f=a.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<r.locationSize;e++)x( __get$(r,"location") +e,n.meshPerAttribute);i.isInstancedMesh!==!0&&s._maxInstanceCount===void 0&&(s._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<r.locationSize;e++)b( __get$(r,"location") +e);e.bindBuffer(34962,l);for(let e=0;e<r.locationSize;e++)C( __get$(r,"location") +e,o/r.locationSize,u,t,c*d,(f+o/r.locationSize*e)*d)}else{if(a.isInstancedBufferAttribute){for(let e=0;e<r.locationSize;e++)x( __get$(r,"location") +e,a.meshPerAttribute);i.isInstancedMesh!==!0&&s._maxInstanceCount===void 0&&(s._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let e=0;e<r.locationSize;e++)b( __get$(r,"location") +e);e.bindBuffer(34962,l);for(let e=0;e<r.locationSize;e++)C( __get$(r,"location") +e,o/r.locationSize,u,t,o*d,o/r.locationSize*e*d)}}else if(u!==void 0){let n= __get$(u,t) ;if(n!==void 0)switch(n.length){case 2:e.vertexAttrib2fv( __get$(r,"location") ,n);break;case 3:e.vertexAttrib3fv( __get$(r,"location") ,n);break;case 4:e.vertexAttrib4fv( __get$(r,"location") ,n);break;default:e.vertexAttrib1fv( __get$(r,"location") ,n)}}}}S()}function T(){for(let e in O(),s){let t= __get$(s,e) ;for(let e in t){let n= __get$(t,e) ;for(let e in n)m( __get$(n,e) .object),delete n[e];delete t[e]}delete s[e]}}function E(e){if( __get$(s,e.id) ===void 0)return;let t= __get$(s,e.id) ;for(let e in t){let n= __get$(t,e) ;for(let e in n)m( __get$(n,e) .object),delete n[e];delete t[e]}delete s[e.id]}function D(e){for(let t in s){let n= __get$(s,t) ;if( __get$(n,e.id) ===void 0)continue;let r= __get$(n,e.id) ;for(let e in r)m( __get$(r,e) .object),delete r[e];delete n[e.id]}}function O(){k(),u=!0,l!==c&&(l=c,p(l.object))}function k(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:d,reset:O,resetDefaultState:k,dispose:T,releaseStatesOfGeometry:E,releaseStatesOfProgram:D,initAttributes:y,enableAttribute:b,disableUnusedAttributes:S}}function yR(e,t,n,r){let i=r.isWebGL2,a;function o(e){a=e}function s(t,r){e.drawArrays(a,t,r),n.update(r,a,1)}function c(r,o,s){if(s===0)return;let c,l;if(i)c=e,l=`drawArraysInstanced`;else if(c=t.get(`ANGLE_instanced_arrays`),l=`drawArraysInstancedANGLE`,c===null){console.error(`THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.`);return} __call$(c,l,[a,r,o,s]) ,n.update(o,a,s)}this.setMode=o,this.render=s,this.renderInstances=c}function bR(e,t,n){let r;function i(){if(r!==void 0)return r;if(t.has(`EXT_texture_filter_anisotropic`)===!0){let n=t.get(`EXT_texture_filter_anisotropic`);r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(t){if(t===`highp`){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return`highp`;t=`mediump`}return t===`mediump`&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?`mediump`:`lowp`}let o=typeof WebGL2RenderingContext<`u`&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<`u`&&e instanceof WebGL2ComputeRenderingContext,s=n.precision===void 0?`highp`:n.precision,c=a(s);c!==s&&(console.warn(`THREE.WebGLRenderer:`,s,`not supported, using`,c,`instead.`),s=c);let l=o||t.has(`WEBGL_draw_buffers`),u=n.logarithmicDepthBuffer===!0,d=e.getParameter(34930),f=e.getParameter(35660),p=e.getParameter(3379),m=e.getParameter(34076),h=e.getParameter(34921),g=e.getParameter(36347),_=e.getParameter(36348),v=e.getParameter(36349),y=f>0,b=o||t.has(`OES_texture_float`),x=y&&b,S=o?e.getParameter(36183):0;return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:i,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:f,maxTextureSize:p,maxCubemapSize:m,maxAttributes:h,maxVertexUniforms:g,maxVaryings:_,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:x,maxSamples:S}}function xR(e){let t=this,n=null,r=0,i=!1,a=!1,o=new iq,s=new xW,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){let o=e.length!==0||t||r!==0||i;return i=t,n=u(e,a,0),r=e.length,o},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1,l()},this.setState=function(t,o,s){let d=t.clippingPlanes,f=t.clipIntersection,p=t.clipShadows,m=e.get(t);if(!i||d===null||d.length===0||a&&!p)a?u(null):l();else{let e=a?0:r,t=e*4,i=m.clippingState||null;c.value=i,i=u(d,o,t,s);for(let e=0;e!==t;++e) __set$(i,e,__get$(n,e)) ;m.clippingState=i,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=e}};function l(){c.value!==n&&(c.value=n,c.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function u(e,n,r,i){let a=e===null?0:e.length,l=null;if(a!==0){if(l=c.value,i!==!0||l===null){let t=r+a*4,i=n.matrixWorldInverse;s.getNormalMatrix(i),(l===null||l.length<t)&&(l=new Float32Array(t));for(let t=0,n=r;t!==a;++t,n+=4)o.copy( __get$(e,t) ).applyMatrix4(i,s),o.normal.toArray(l,n), __set$(l,n+3,o.constant) }c.value=l,c.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,l}}function SR(e){let t=new WeakMap;function n(e,t){return t===uH?e.mapping=cH:t===dH&&(e.mapping=lH),e}function r(r){if(r&&r.isTexture&&r.isRenderTargetTexture===!1){let a=r.mapping;if(a===uH||a===dH)if(t.has(r)){let e=t.get(r).texture;return n(e,r.mapping)}else{let a=r.image;if(a&&a.height>0){let o=new eq(a.height/2);return o.fromEquirectangularTexture(e,r),t.set(r,o),r.addEventListener(`dispose`,i),n(o.texture,r.mapping)}else return null}}return r}function i(e){let n=e.target;n.removeEventListener(`dispose`,i);let r=t.get(n);r!==void 0&&(t.delete(n),r.dispose())}function a(){t=new WeakMap}return{get:r,dispose:a}}function CR(e){let t=[],n=[],r=[],i=e,a=e-pq+1+mq.length;for(let o=0;o<a;o++){let a=2**i;n.push(a);let s=1/a;o>e-pq?s= __get$(mq,o-e+pq-1) :o===0&&(s=0),r.push(s);let c=1/(a-2),l=-c,u=1+c,d=[l,l,u,l,u,u,l,l,u,u,l,u],f=new Float32Array(108),p=new Float32Array(72),m=new Float32Array(36);for(let e=0;e<6;e++){let t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];f.set(r,18*e),p.set(d,12*e);let i=[e,e,e,e,e,e];m.set(i,6*e)}let h=new wK;h.setAttribute(`position`,new oK(f,3)),h.setAttribute(`uv`,new oK(p,2)),h.setAttribute(`faceIndex`,new oK(m,1)),t.push(h),i>pq&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}function wR(e,t,n){let r=new IW(e,t,n);return r.texture.mapping=fH,r.texture.name=`PMREM.cubeUv`,r.scissorTest=!0,r}function TR(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function ER(e,t,n){let r=new Float32Array(hq),i=new Q(0,1,0);return new qK({name:`SphericalGaussianBlur`,defines:{n:hq,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:kR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:SV,depthTest:!1,depthWrite:!1})}function DR(){return new qK({name:`EquirectangularToCubeUV`,uniforms:{envMap:{value:null}},vertexShader:kR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:SV,depthTest:!1,depthWrite:!1})}function OR(){return new qK({name:`CubemapToCubeUV`,uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:kR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:SV,depthTest:!1,depthWrite:!1})}function kR(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function AR(e){let t=new WeakMap,n=null;function r(r){if(r&&r.isTexture){let o=r.mapping,s=o===uH||o===dH,c=o===cH||o===lH;if(s||c)if(r.isRenderTargetTexture&&r.needsPMREMUpdate===!0){r.needsPMREMUpdate=!1;let i=t.get(r);return n===null&&(n=new Sq(e)),i=s?n.fromEquirectangular(r,i):n.fromCubemap(r,i),t.set(r,i),i.texture}else if(t.has(r))return t.get(r).texture;else{let o=r.image;if(s&&o&&o.height>0||c&&o&&i(o)){n===null&&(n=new Sq(e));let i=s?n.fromEquirectangular(r):n.fromCubemap(r);return t.set(r,i),r.addEventListener(`dispose`,a),i.texture}else return null}}return r}function i(e){let t=0;for(let n=0;n<6;n++) __get$(e,n) !==void 0&&t++;return t===6}function a(e){let n=e.target;n.removeEventListener(`dispose`,a);let r=t.get(n);r!==void 0&&(t.delete(n),r.dispose())}function o(){t=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:o}}function jR(e){let t={};function n(n){if( __get$(t,n) !==void 0)return  __get$(t,n) ;let r;switch(n){case`WEBGL_depth_texture`:r=e.getExtension(`WEBGL_depth_texture`)||e.getExtension(`MOZ_WEBGL_depth_texture`)||e.getExtension(`WEBKIT_WEBGL_depth_texture`);break;case`EXT_texture_filter_anisotropic`:r=e.getExtension(`EXT_texture_filter_anisotropic`)||e.getExtension(`MOZ_EXT_texture_filter_anisotropic`)||e.getExtension(`WEBKIT_EXT_texture_filter_anisotropic`);break;case`WEBGL_compressed_texture_s3tc`:r=e.getExtension(`WEBGL_compressed_texture_s3tc`)||e.getExtension(`MOZ_WEBGL_compressed_texture_s3tc`)||e.getExtension(`WEBKIT_WEBGL_compressed_texture_s3tc`);break;case`WEBGL_compressed_texture_pvrtc`:r=e.getExtension(`WEBGL_compressed_texture_pvrtc`)||e.getExtension(`WEBKIT_WEBGL_compressed_texture_pvrtc`);break;default:r=e.getExtension(n)}return  __set$(t,n,r) ,r}return{has:function(e){return n(e)!==null},init:function(e){e.isWebGL2?n(`EXT_color_buffer_float`):(n(`WEBGL_depth_texture`),n(`OES_texture_float`),n(`OES_texture_half_float`),n(`OES_texture_half_float_linear`),n(`OES_standard_derivatives`),n(`OES_element_index_uint`),n(`OES_vertex_array_object`),n(`ANGLE_instanced_arrays`)),n(`OES_texture_float_linear`),n(`EXT_color_buffer_half_float`),n(`WEBGL_multisampled_render_to_texture`)},get:function(e){let t=n(e);return t===null&&console.warn(`THREE.WebGLRenderer: `+e+` extension not supported.`),t}}}function MR(e,t,n,r){let i={},a=new WeakMap;function o(e){let s=e.target;for(let e in s.index!==null&&t.remove(s.index),s.attributes)t.remove( __get$(s.attributes,e) );s.removeEventListener(`dispose`,o),delete i[s.id];let c=a.get(s);c&&(t.remove(c),a.delete(s)),r.releaseStatesOfGeometry(s),s.isInstancedBufferGeometry===!0&&delete s._maxInstanceCount,n.memory.geometries--}function s(e,t){return  __get$(i,t.id) ===!0?t:(t.addEventListener(`dispose`,o), __set$(i,t.id,!0) ,n.memory.geometries++,t)}function c(e){let n=e.attributes;for(let e in n)t.update( __get$(n,e) ,34962);let r=e.morphAttributes;for(let e in r){let n= __get$(r,e) ;for(let e=0,r=n.length;e<r;e++)t.update( __get$(n,e) ,34962)}}function l(e){let n=[],r=e.index,i=e.attributes.position,o=0;if(r!==null){let e=r.array;o=r.version;for(let t=0,r=e.length;t<r;t+=3){let r= __get$(e,t+0) ,i= __get$(e,t+1) ,a= __get$(e,t+2) ;n.push(r,i,i,a,a,r)}}else{let e=i.array;o=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){let e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}let s=new(nR(n)?pK:dK)(n,1);s.version=o;let c=a.get(e);c&&t.remove(c),a.set(e,s)}function u(e){let t=a.get(e);if(t){let n=e.index;n!==null&&t.version<n.version&&l(e)}else l(e);return a.get(e)}return{get:s,update:c,getWireframeAttribute:u}}function NR(e,t,n,r){let i=r.isWebGL2,a;function o(e){a=e}let s,c;function l(e){s=e.type,c=e.bytesPerElement}function u(t,r){e.drawElements(a,r,s,t*c),n.update(r,a,1)}function d(r,o,l){if(l===0)return;let u,d;if(i)u=e,d=`drawElementsInstanced`;else if(u=t.get(`ANGLE_instanced_arrays`),d=`drawElementsInstancedANGLE`,u===null){console.error(`THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.`);return} __call$(u,d,[a,o,s,r*c,l]) ,n.update(o,a,l)}this.setMode=o,this.setIndex=l,this.render=u,this.renderInstances=d}function PR(e){let t={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(e,t,r){switch(n.calls++,t){case 4:n.triangles+=r*(e/3);break;case 1:n.lines+=r*(e/2);break;case 3:n.lines+=r*(e-1);break;case 2:n.lines+=r*e;break;case 0:n.points+=r*e;break;default:console.error(`THREE.WebGLInfo: Unknown draw mode:`,t);break}}function i(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:t,render:n,programs:null,autoReset:!0,reset:i,update:r}}function FR(e,t){return e[0]-t[0]}function IR(e,t){return Math.abs(t[1])-Math.abs(e[1])}function LR(e,t){let n=1,r=t.isInterleavedBufferAttribute?t.data.array:t.array;r instanceof Int8Array?n=127:r instanceof Int16Array?n=32767:r instanceof Int32Array?n=2147483647:console.error(`THREE.WebGLMorphtargets: Unsupported morph attribute data type: `,r),e.divideScalar(n)}function RR(e,t,n){let r={},i=new Float32Array(8),a=new WeakMap,o=new FW,s=[];for(let e=0;e<8;e++) __set$(s,e,[e,0]) ;function c(c,l,u,d){let f=c.morphTargetInfluences;if(t.isWebGL2===!0){let r=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,i=r===void 0?0:r.length,s=a.get(l);if(s===void 0||s.count!==i){let e=function(){_.dispose(),a.delete(l),l.removeEventListener(`dispose`,e)};s!==void 0&&s.texture.dispose();let n=l.morphAttributes.position!==void 0,r=l.morphAttributes.normal!==void 0,c=l.morphAttributes.color!==void 0,u=l.morphAttributes.position||[],d=l.morphAttributes.normal||[],f=l.morphAttributes.color||[],p=0;n===!0&&(p=1),r===!0&&(p=2),c===!0&&(p=3);let m=l.attributes.position.count*p,h=1;m>t.maxTextureSize&&(h=Math.ceil(m/t.maxTextureSize),m=t.maxTextureSize);let g=new Float32Array(m*h*4*i),_=new LW(g,m,h,i);_.type=MH,_.needsUpdate=!0;let v=p*4;for(let e=0;e<i;e++){let t= __get$(u,e) ,i= __get$(d,e) ,a= __get$(f,e) ,s=m*h*4*e;for(let e=0;e<t.count;e++){let l=e*v;n===!0&&(o.fromBufferAttribute(t,e),t.normalized===!0&&LR(o,t), __set$(g,s+l+0,o.x) , __set$(g,s+l+1,o.y) , __set$(g,s+l+2,o.z) , __set$(g,s+l+3,0) ),r===!0&&(o.fromBufferAttribute(i,e),i.normalized===!0&&LR(o,i), __set$(g,s+l+4,o.x) , __set$(g,s+l+5,o.y) , __set$(g,s+l+6,o.z) , __set$(g,s+l+7,0) ),c===!0&&(o.fromBufferAttribute(a,e),a.normalized===!0&&LR(o,a), __set$(g,s+l+8,o.x) , __set$(g,s+l+9,o.y) , __set$(g,s+l+10,o.z) , __set$(g,s+l+11,a.itemSize===4?o.w:1) )}}s={count:i,texture:_,size:new Z(m,h)},a.set(l,s),l.addEventListener(`dispose`,e)}let c=0;for(let e=0;e<f.length;e++)c+= __get$(f,e) ;let u=l.morphTargetsRelative?1:1-c;d.getUniforms().setValue(e,`morphTargetBaseInfluence`,u),d.getUniforms().setValue(e,`morphTargetInfluences`,f),d.getUniforms().setValue(e,`morphTargetsTexture`,s.texture,n),d.getUniforms().setValue(e,`morphTargetsTextureSize`,s.size)}else{let t=f===void 0?0:f.length,n= __get$(r,l.id) ;if(n===void 0||n.length!==t){n=[];for(let e=0;e<t;e++) __set$(n,e,[e,0]) ; __set$(r,l.id,n) }for(let e=0;e<t;e++){let t= __get$(n,e) ;t[0]=e,t[1]= __get$(f,e) }n.sort(IR);for(let e=0;e<8;e++)e<t&& __get$(n,e) [1]?( __get$(s,e) [0]= __get$(n,e) [0], __get$(s,e) [1]= __get$(n,e) [1]):( __get$(s,e) [0]=2**53-1, __get$(s,e) [1]=0);s.sort(FR);let a=l.morphAttributes.position,o=l.morphAttributes.normal,c=0;for(let e=0;e<8;e++){let t= __get$(s,e) ,n=t[0],r=t[1];n!==2**53-1&&r?(a&&l.getAttribute(`morphTarget`+e)!== __get$(a,n) &&l.setAttribute(`morphTarget`+e, __get$(a,n) ),o&&l.getAttribute(`morphNormal`+e)!== __get$(o,n) &&l.setAttribute(`morphNormal`+e, __get$(o,n) ), __set$(i,e,r) ,c+=r):(a&&l.hasAttribute(`morphTarget`+e)===!0&&l.deleteAttribute(`morphTarget`+e),o&&l.hasAttribute(`morphNormal`+e)===!0&&l.deleteAttribute(`morphNormal`+e), __set$(i,e,0) )}let u=l.morphTargetsRelative?1:1-c;d.getUniforms().setValue(e,`morphTargetBaseInfluence`,u),d.getUniforms().setValue(e,`morphTargetInfluences`,i)}}return{update:c}}function zR(e,t,n,r){let i=new WeakMap;function a(e){let a=r.render.frame,o=e.geometry,c=t.get(e,o);return i.get(c)!==a&&(t.update(c),i.set(c,a)),e.isInstancedMesh&&(e.hasEventListener(`dispose`,s)===!1&&e.addEventListener(`dispose`,s),n.update(e.instanceMatrix,34962),e.instanceColor!==null&&n.update(e.instanceColor,34962)),c}function o(){i=new WeakMap}function s(e){let t=e.target;t.removeEventListener(`dispose`,s),n.remove(t.instanceMatrix),t.instanceColor!==null&&n.remove(t.instanceColor)}return{update:a,dispose:o}}function BR(e,t,n){let r=e[0];if(r<=0||r>0)return e;let i=t*n,a= __get$(Dq,i) ;if(a===void 0&&(a=new Float32Array(i), __set$(Dq,i,a) ),t!==0){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n, __get$(e,r) .toArray(a,i)}return a}function VR(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if( __get$(e,n) !== __get$(t,n) )return!1;return!0}function HR(e,t){for(let n=0,r=t.length;n<r;n++) __set$(e,n,__get$(t,n)) }function UR(e,t){let n= __get$(Oq,t) ;n===void 0&&(n=new Int32Array(t), __set$(Oq,t,n) );for(let r=0;r!==t;++r) __set$(n,r,e.allocateTextureUnit()) ;return n}function WR(e,t){let n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function GR(e,t){let n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(VR(n,t))return;e.uniform2fv(this.addr,t),HR(n,t)}}function KR(e,t){let n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(t.r!==void 0)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(VR(n,t))return;e.uniform3fv(this.addr,t),HR(n,t)}}function qR(e,t){let n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(VR(n,t))return;e.uniform4fv(this.addr,t),HR(n,t)}}function JR(e,t){let n=this.cache,r=t.elements;if(r===void 0){if(VR(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),HR(n,t)}else{if(VR(n,r))return;jq.set(r),e.uniformMatrix2fv(this.addr,!1,jq),HR(n,r)}}function YR(e,t){let n=this.cache,r=t.elements;if(r===void 0){if(VR(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),HR(n,t)}else{if(VR(n,r))return;Aq.set(r),e.uniformMatrix3fv(this.addr,!1,Aq),HR(n,r)}}function XR(e,t){let n=this.cache,r=t.elements;if(r===void 0){if(VR(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),HR(n,t)}else{if(VR(n,r))return;kq.set(r),e.uniformMatrix4fv(this.addr,!1,kq),HR(n,r)}}function ZR(e,t){let n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function QR(e,t){let n=this.cache;VR(n,t)||(e.uniform2iv(this.addr,t),HR(n,t))}function $R(e,t){let n=this.cache;VR(n,t)||(e.uniform3iv(this.addr,t),HR(n,t))}function ez(e,t){let n=this.cache;VR(n,t)||(e.uniform4iv(this.addr,t),HR(n,t))}function tz(e,t){let n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function nz(e,t){let n=this.cache;VR(n,t)||(e.uniform2uiv(this.addr,t),HR(n,t))}function rz(e,t){let n=this.cache;VR(n,t)||(e.uniform3uiv(this.addr,t),HR(n,t))}function iz(e,t){let n=this.cache;VR(n,t)||(e.uniform4uiv(this.addr,t),HR(n,t))}function az(e,t,n){let r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||Cq,i)}function oz(e,t,n){let r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Tq,i)}function sz(e,t,n){let r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||Eq,i)}function cz(e,t,n){let r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||wq,i)}function lz(e){switch(e){case 5126:return WR;case 35664:return GR;case 35665:return KR;case 35666:return qR;case 35674:return JR;case 35675:return YR;case 35676:return XR;case 5124:case 35670:return ZR;case 35667:case 35671:return QR;case 35668:case 35672:return $R;case 35669:case 35673:return ez;case 5125:return tz;case 36294:return nz;case 36295:return rz;case 36296:return iz;case 35678:case 36198:case 36298:case 36306:case 35682:return az;case 35679:case 36299:case 36307:return oz;case 35680:case 36300:case 36308:case 36293:return sz;case 36289:case 36303:case 36311:case 36292:return cz}}function uz(e,t){e.uniform1fv(this.addr,t)}function dz(e,t){let n=BR(t,this.size,2);e.uniform2fv(this.addr,n)}function fz(e,t){let n=BR(t,this.size,3);e.uniform3fv(this.addr,n)}function pz(e,t){let n=BR(t,this.size,4);e.uniform4fv(this.addr,n)}function mz(e,t){let n=BR(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function hz(e,t){let n=BR(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function gz(e,t){let n=BR(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function _z(e,t){e.uniform1iv(this.addr,t)}function vz(e,t){e.uniform2iv(this.addr,t)}function yz(e,t){e.uniform3iv(this.addr,t)}function bz(e,t){e.uniform4iv(this.addr,t)}function xz(e,t){e.uniform1uiv(this.addr,t)}function Sz(e,t){e.uniform2uiv(this.addr,t)}function Cz(e,t){e.uniform3uiv(this.addr,t)}function wz(e,t){e.uniform4uiv(this.addr,t)}function Tz(e,t,n){let r=t.length,i=UR(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.setTexture2D( __get$(t,e) ||Cq, __get$(i,e) )}function Ez(e,t,n){let r=t.length,i=UR(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.setTexture3D( __get$(t,e) ||Tq, __get$(i,e) )}function Dz(e,t,n){let r=t.length,i=UR(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.setTextureCube( __get$(t,e) ||Eq, __get$(i,e) )}function Oz(e,t,n){let r=t.length,i=UR(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.setTexture2DArray( __get$(t,e) ||wq, __get$(i,e) )}function kz(e){switch(e){case 5126:return uz;case 35664:return dz;case 35665:return fz;case 35666:return pz;case 35674:return mz;case 35675:return hz;case 35676:return gz;case 5124:case 35670:return _z;case 35667:case 35671:return vz;case 35668:case 35672:return yz;case 35669:case 35673:return bz;case 5125:return xz;case 36294:return Sz;case 36295:return Cz;case 36296:return wz;case 35678:case 36198:case 36298:case 36306:case 35682:return Tz;case 35679:case 36299:case 36307:return Ez;case 35680:case 36300:case 36308:case 36293:return Dz;case 36289:case 36303:case 36311:case 36292:return Oz}}function Az(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=lz(t.type)}function jz(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=kz(t.type)}function Mz(e){this.id=e,this.seq=[],this.map={}}function Nz(e,t){e.seq.push(t), __set$(e.map,t.id,t) }function Pz(e,t,n){let r=e.name,i=r.length;for(Mq.lastIndex=0;;){let a=Mq.exec(r),o=Mq.lastIndex,s=a[1],c=a[2]===`]`,l=a[3];if(c&&(s|=0),l===void 0||l===`[`&&o+2===i){Nz(n,l===void 0?new Az(s,e,t):new jz(s,e,t));break}else{let e= __get$(n.map,s) ;e===void 0&&(e=new Mz(s),Nz(n,e)),n=e}}}function Fz(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){let n=e.getActiveUniform(t,r);Pz(n,e.getUniformLocation(t,n.name),this)}}function Iz(e,t,n){let r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}function Lz(e,t){let n=e.split(`
`),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let e=i;e<a;e++)r.push(e+1+`: `+ __get$(n,e) );return r.join(`
`)}function Rz(e){switch(e){case NU:return[`Linear`,`( value )`];case PU:return[`sRGB`,`( value )`];default:return console.warn(`THREE.WebGLProgram: Unsupported encoding:`,e),[`Linear`,`( value )`]}}function zz(e,t,n){let r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();if(r&&i===``)return``;let a=/ERROR: 0:(\d+)/.exec(i);if(a){let r=parseInt(a[0]);return n.toUpperCase()+`

`+i+`

`+Lz(e.getShaderSource(t),r)}else return i}function Bz(e,t){let n=Rz(t);return`vec4 `+e+`( vec4 value ) { return LinearTo`+n[0]+n[1]+`; }`}function Vz(e,t){let n;switch(t){case nH:n=`Linear`;break;case rH:n=`Reinhard`;break;case iH:n=`OptimizedCineon`;break;case aH:n=`ACESFilmic`;break;case oH:n=`Custom`;break;default:console.warn(`THREE.WebGLProgram: Unsupported toneMapping:`,t),n=`Linear`}return`vec3 `+e+`( vec3 color ) { return `+n+`ToneMapping( color ); }`}function Hz(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID===`physical`?`#extension GL_OES_standard_derivatives : enable`:``,(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?`#extension GL_EXT_frag_depth : enable`:``,e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?`#extension GL_EXT_draw_buffers : require`:``,(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?`#extension GL_EXT_shader_texture_lod : enable`:``].filter(Gz).join(`
`)}function Uz(e){let t=[];for(let n in e){let r= __get$(e,n) ;r!==!1&&t.push(`#define `+n+` `+r)}return t.join(`
`)}function Wz(e,t){let n={},r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){let r=e.getActiveAttrib(t,i),a=r.name,o=1;r.type===35674&&(o=2),r.type===35675&&(o=3),r.type===35676&&(o=4), __set$(n,a,{type:r.type,location:e.getAttribLocation(t,a),locationSize:o}) }return n}function Gz(e){return e!==``}function Kz(e,t){return  __call$(__call$(__call$(__call$(__call$(__call$(__call$(__call$(e,"replace",[/NUM_DIR_LIGHTS/g,t.numDirLights]),"replace",[/NUM_SPOT_LIGHTS/g,t.numSpotLights]),"replace",[/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights]),"replace",[/NUM_POINT_LIGHTS/g,t.numPointLights]),"replace",[/NUM_HEMI_LIGHTS/g,t.numHemiLights]),"replace",[/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows]),"replace",[/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows]),"replace",[/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows]) }function qz(e,t){return  __call$(__call$(e,"replace",[/NUM_CLIPPING_PLANES/g,t.numClippingPlanes]),"replace",[/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection]) }function Jz(e){return  __call$(e,"replace",[Pq,Yz]) }function Yz(e,t){let n= __get$(lq,t) ;if(n===void 0)throw Error(`Can not resolve #include <`+t+`>`);return Jz(n)}function Xz(e){return  __call$(__call$(e,"replace",[Iq,Qz]),"replace",[Fq,Zz]) }function Zz(e,t,n,r){return console.warn(`WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead.`),Qz(e,t,n,r)}function Qz(e,t,n,r){let i=``;for(let e=parseInt(t);e<parseInt(n);e++)i+= __call$(__call$(r,"replace",[/\[\s*i\s*\]/g,`[ `+e+` ]`]),"replace",[/UNROLLED_LOOP_INDEX/g,e]) ;return i}function $z(e){let t=`precision `+e.precision+` float;
precision `+e.precision+` int;`;return e.precision===`highp`?t+=`
#define HIGH_PRECISION`:e.precision===`mediump`?t+=`
#define MEDIUM_PRECISION`:e.precision===`lowp`&&(t+=`
#define LOW_PRECISION`),t}function eB(e){let t=`SHADOWMAP_TYPE_BASIC`;return e.shadowMapType===gV?t=`SHADOWMAP_TYPE_PCF`:e.shadowMapType===_V?t=`SHADOWMAP_TYPE_PCF_SOFT`:e.shadowMapType===vV&&(t=`SHADOWMAP_TYPE_VSM`),t}function tB(e){let t=`ENVMAP_TYPE_CUBE`;if(e.envMap)switch(e.envMapMode){case cH:case lH:t=`ENVMAP_TYPE_CUBE`;break;case fH:t=`ENVMAP_TYPE_CUBE_UV`;break}return t}function nB(e){let t=`ENVMAP_MODE_REFLECTION`;if(e.envMap)switch(e.envMapMode){case lH:t=`ENVMAP_MODE_REFRACTION`;break}return t}function rB(e){let t=`ENVMAP_BLENDING_NONE`;if(e.envMap)switch(e.combine){case QV:t=`ENVMAP_BLENDING_MULTIPLY`;break;case $V:t=`ENVMAP_BLENDING_MIX`;break;case eH:t=`ENVMAP_BLENDING_ADD`;break}return t}function iB(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(2**n,112)),texelHeight:r,maxMip:n}}function aB(e,t,n,r){let i=e.getContext(),a=n.defines,o=n.vertexShader,s=n.fragmentShader,c=eB(n),l=tB(n),u=nB(n),d=rB(n),f=iB(n),p=n.isWebGL2?``:Hz(n),m=Uz(a),h=i.createProgram(),g,_,v=n.glslVersion?`#version `+n.glslVersion+`
`:``;n.isRawShaderMaterial?(g=[m].filter(Gz).join(`
`),g.length>0&&(g+=`
`),_=[p,m].filter(Gz).join(`
`),_.length>0&&(_+=`
`)):(g=[$z(n),`#define SHADER_NAME `+n.shaderName,m,n.instancing?`#define USE_INSTANCING`:``,n.instancingColor?`#define USE_INSTANCING_COLOR`:``,n.supportsVertexTextures?`#define VERTEX_TEXTURES`:``,n.useFog&&n.fog?`#define USE_FOG`:``,n.useFog&&n.fogExp2?`#define FOG_EXP2`:``,n.map?`#define USE_MAP`:``,n.envMap?`#define USE_ENVMAP`:``,n.envMap?`#define `+u:``,n.lightMap?`#define USE_LIGHTMAP`:``,n.aoMap?`#define USE_AOMAP`:``,n.emissiveMap?`#define USE_EMISSIVEMAP`:``,n.bumpMap?`#define USE_BUMPMAP`:``,n.normalMap?`#define USE_NORMALMAP`:``,n.normalMap&&n.objectSpaceNormalMap?`#define OBJECTSPACE_NORMALMAP`:``,n.normalMap&&n.tangentSpaceNormalMap?`#define TANGENTSPACE_NORMALMAP`:``,n.clearcoatMap?`#define USE_CLEARCOATMAP`:``,n.clearcoatRoughnessMap?`#define USE_CLEARCOAT_ROUGHNESSMAP`:``,n.clearcoatNormalMap?`#define USE_CLEARCOAT_NORMALMAP`:``,n.displacementMap&&n.supportsVertexTextures?`#define USE_DISPLACEMENTMAP`:``,n.specularMap?`#define USE_SPECULARMAP`:``,n.specularIntensityMap?`#define USE_SPECULARINTENSITYMAP`:``,n.specularColorMap?`#define USE_SPECULARCOLORMAP`:``,n.roughnessMap?`#define USE_ROUGHNESSMAP`:``,n.metalnessMap?`#define USE_METALNESSMAP`:``,n.alphaMap?`#define USE_ALPHAMAP`:``,n.transmission?`#define USE_TRANSMISSION`:``,n.transmissionMap?`#define USE_TRANSMISSIONMAP`:``,n.thicknessMap?`#define USE_THICKNESSMAP`:``,n.sheenColorMap?`#define USE_SHEENCOLORMAP`:``,n.sheenRoughnessMap?`#define USE_SHEENROUGHNESSMAP`:``,n.vertexTangents?`#define USE_TANGENT`:``,n.vertexColors?`#define USE_COLOR`:``,n.vertexAlphas?`#define USE_COLOR_ALPHA`:``,n.vertexUvs?`#define USE_UV`:``,n.uvsVertexOnly?`#define UVS_VERTEX_ONLY`:``,n.flatShading?`#define FLAT_SHADED`:``,n.skinning?`#define USE_SKINNING`:``,n.morphTargets?`#define USE_MORPHTARGETS`:``,n.morphNormals&&n.flatShading===!1?`#define USE_MORPHNORMALS`:``,n.morphColors&&n.isWebGL2?`#define USE_MORPHCOLORS`:``,n.morphTargetsCount>0&&n.isWebGL2?`#define MORPHTARGETS_TEXTURE`:``,n.morphTargetsCount>0&&n.isWebGL2?`#define MORPHTARGETS_TEXTURE_STRIDE `+n.morphTextureStride:``,n.morphTargetsCount>0&&n.isWebGL2?`#define MORPHTARGETS_COUNT `+n.morphTargetsCount:``,n.doubleSided?`#define DOUBLE_SIDED`:``,n.flipSided?`#define FLIP_SIDED`:``,n.shadowMapEnabled?`#define USE_SHADOWMAP`:``,n.shadowMapEnabled?`#define `+c:``,n.sizeAttenuation?`#define USE_SIZEATTENUATION`:``,n.logarithmicDepthBuffer?`#define USE_LOGDEPTHBUF`:``,n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?`#define USE_LOGDEPTHBUF_EXT`:``,`uniform mat4 modelMatrix;`,`uniform mat4 modelViewMatrix;`,`uniform mat4 projectionMatrix;`,`uniform mat4 viewMatrix;`,`uniform mat3 normalMatrix;`,`uniform vec3 cameraPosition;`,`uniform bool isOrthographic;`,`#ifdef USE_INSTANCING`,`	attribute mat4 instanceMatrix;`,`#endif`,`#ifdef USE_INSTANCING_COLOR`,`	attribute vec3 instanceColor;`,`#endif`,`attribute vec3 position;`,`attribute vec3 normal;`,`attribute vec2 uv;`,`#ifdef USE_TANGENT`,`	attribute vec4 tangent;`,`#endif`,`#if defined( USE_COLOR_ALPHA )`,`	attribute vec4 color;`,`#elif defined( USE_COLOR )`,`	attribute vec3 color;`,`#endif`,`#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )`,`	attribute vec3 morphTarget0;`,`	attribute vec3 morphTarget1;`,`	attribute vec3 morphTarget2;`,`	attribute vec3 morphTarget3;`,`	#ifdef USE_MORPHNORMALS`,`		attribute vec3 morphNormal0;`,`		attribute vec3 morphNormal1;`,`		attribute vec3 morphNormal2;`,`		attribute vec3 morphNormal3;`,`	#else`,`		attribute vec3 morphTarget4;`,`		attribute vec3 morphTarget5;`,`		attribute vec3 morphTarget6;`,`		attribute vec3 morphTarget7;`,`	#endif`,`#endif`,`#ifdef USE_SKINNING`,`	attribute vec4 skinIndex;`,`	attribute vec4 skinWeight;`,`#endif`,`
`].filter(Gz).join(`
`),_=[p,$z(n),`#define SHADER_NAME `+n.shaderName,m,n.useFog&&n.fog?`#define USE_FOG`:``,n.useFog&&n.fogExp2?`#define FOG_EXP2`:``,n.map?`#define USE_MAP`:``,n.matcap?`#define USE_MATCAP`:``,n.envMap?`#define USE_ENVMAP`:``,n.envMap?`#define `+l:``,n.envMap?`#define `+u:``,n.envMap?`#define `+d:``,f?`#define CUBEUV_TEXEL_WIDTH `+f.texelWidth:``,f?`#define CUBEUV_TEXEL_HEIGHT `+f.texelHeight:``,f?`#define CUBEUV_MAX_MIP `+f.maxMip+`.0`:``,n.lightMap?`#define USE_LIGHTMAP`:``,n.aoMap?`#define USE_AOMAP`:``,n.emissiveMap?`#define USE_EMISSIVEMAP`:``,n.bumpMap?`#define USE_BUMPMAP`:``,n.normalMap?`#define USE_NORMALMAP`:``,n.normalMap&&n.objectSpaceNormalMap?`#define OBJECTSPACE_NORMALMAP`:``,n.normalMap&&n.tangentSpaceNormalMap?`#define TANGENTSPACE_NORMALMAP`:``,n.clearcoat?`#define USE_CLEARCOAT`:``,n.clearcoatMap?`#define USE_CLEARCOATMAP`:``,n.clearcoatRoughnessMap?`#define USE_CLEARCOAT_ROUGHNESSMAP`:``,n.clearcoatNormalMap?`#define USE_CLEARCOAT_NORMALMAP`:``,n.specularMap?`#define USE_SPECULARMAP`:``,n.specularIntensityMap?`#define USE_SPECULARINTENSITYMAP`:``,n.specularColorMap?`#define USE_SPECULARCOLORMAP`:``,n.roughnessMap?`#define USE_ROUGHNESSMAP`:``,n.metalnessMap?`#define USE_METALNESSMAP`:``,n.alphaMap?`#define USE_ALPHAMAP`:``,n.alphaTest?`#define USE_ALPHATEST`:``,n.sheen?`#define USE_SHEEN`:``,n.sheenColorMap?`#define USE_SHEENCOLORMAP`:``,n.sheenRoughnessMap?`#define USE_SHEENROUGHNESSMAP`:``,n.transmission?`#define USE_TRANSMISSION`:``,n.transmissionMap?`#define USE_TRANSMISSIONMAP`:``,n.thicknessMap?`#define USE_THICKNESSMAP`:``,n.decodeVideoTexture?`#define DECODE_VIDEO_TEXTURE`:``,n.vertexTangents?`#define USE_TANGENT`:``,n.vertexColors||n.instancingColor?`#define USE_COLOR`:``,n.vertexAlphas?`#define USE_COLOR_ALPHA`:``,n.vertexUvs?`#define USE_UV`:``,n.uvsVertexOnly?`#define UVS_VERTEX_ONLY`:``,n.gradientMap?`#define USE_GRADIENTMAP`:``,n.flatShading?`#define FLAT_SHADED`:``,n.doubleSided?`#define DOUBLE_SIDED`:``,n.flipSided?`#define FLIP_SIDED`:``,n.shadowMapEnabled?`#define USE_SHADOWMAP`:``,n.shadowMapEnabled?`#define `+c:``,n.premultipliedAlpha?`#define PREMULTIPLIED_ALPHA`:``,n.physicallyCorrectLights?`#define PHYSICALLY_CORRECT_LIGHTS`:``,n.logarithmicDepthBuffer?`#define USE_LOGDEPTHBUF`:``,n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?`#define USE_LOGDEPTHBUF_EXT`:``,`uniform mat4 viewMatrix;`,`uniform vec3 cameraPosition;`,`uniform bool isOrthographic;`,n.toneMapping===tH?``:`#define TONE_MAPPING`,n.toneMapping===tH?``:lq.tonemapping_pars_fragment,n.toneMapping===tH?``:Vz(`toneMapping`,n.toneMapping),n.dithering?`#define DITHERING`:``,n.opaque?`#define OPAQUE`:``,lq.encodings_pars_fragment,Bz(`linearToOutputTexel`,n.outputEncoding),n.useDepthPacking?`#define DEPTH_PACKING `+n.depthPacking:``,`
`].filter(Gz).join(`
`)),o=Jz(o),o=Kz(o,n),o=qz(o,n),s=Jz(s),s=Kz(s,n),s=qz(s,n),o=Xz(o),s=Xz(s),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(v=`#version 300 es
`,g=[`precision mediump sampler2DArray;`,`#define attribute in`,`#define varying out`,`#define texture2D texture`].join(`
`)+`
`+g,_=[`#define varying in`,n.glslVersion===pW?``:`layout(location = 0) out highp vec4 pc_fragColor;`,n.glslVersion===pW?``:`#define gl_FragColor pc_fragColor`,`#define gl_FragDepthEXT gl_FragDepth`,`#define texture2D texture`,`#define textureCube texture`,`#define texture2DProj textureProj`,`#define texture2DLodEXT textureLod`,`#define texture2DProjLodEXT textureProjLod`,`#define textureCubeLodEXT textureLod`,`#define texture2DGradEXT textureGrad`,`#define texture2DProjGradEXT textureProjGrad`,`#define textureCubeGradEXT textureGrad`].join(`
`)+`
`+_);let y=v+g+o,b=v+_+s,x=Iz(i,35633,y),S=Iz(i,35632,b);if(i.attachShader(h,x),i.attachShader(h,S),n.index0AttributeName===void 0?n.morphTargets===!0&&i.bindAttribLocation(h,0,`position`):i.bindAttribLocation(h,0,n.index0AttributeName),i.linkProgram(h),e.debug.checkShaderErrors){let e=i.getProgramInfoLog(h).trim(),t=i.getShaderInfoLog(x).trim(),n=i.getShaderInfoLog(S).trim(),r=!0,a=!0;if(i.getProgramParameter(h,35714)===!1){r=!1;let t=zz(i,x,`vertex`),n=zz(i,S,`fragment`);console.error(`THREE.WebGLProgram: Shader Error `+i.getError()+` - VALIDATE_STATUS `+i.getProgramParameter(h,35715)+`

Program Info Log: `+e+`
`+t+`
`+n)}else e===``?(t===``||n===``)&&(a=!1):console.warn(`THREE.WebGLProgram: Program Info Log:`,e);a&&(this.diagnostics={runnable:r,programLog:e,vertexShader:{log:t,prefix:g},fragmentShader:{log:n,prefix:_}})}i.deleteShader(x),i.deleteShader(S);let C;this.getUniforms=function(){return C===void 0&&(C=new Fz(i,h)),C};let w;return this.getAttributes=function(){return w===void 0&&(w=Wz(i,h)),w},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(h),this.program=void 0},this.name=n.shaderName,this.id=Nq++,this.cacheKey=t,this.usedTimes=1,this.program=h,this.vertexShader=x,this.fragmentShader=S,this}function oB(e,t,n,r,i,a,o){let s=new kG,c=new Rq,l=[],u=i.isWebGL2,d=i.logarithmicDepthBuffer,f=i.vertexTextures,p=i.precision,m={MeshDepthMaterial:`depth`,MeshDistanceMaterial:`distanceRGBA`,MeshNormalMaterial:`normal`,MeshBasicMaterial:`basic`,MeshLambertMaterial:`lambert`,MeshPhongMaterial:`phong`,MeshToonMaterial:`toon`,MeshStandardMaterial:`physical`,MeshPhysicalMaterial:`physical`,MeshMatcapMaterial:`matcap`,LineBasicMaterial:`basic`,LineDashedMaterial:`dashed`,PointsMaterial:`points`,ShadowMaterial:`shadow`,SpriteMaterial:`sprite`};function h(a,s,l,h,g){let _=h.fog,v=g.geometry,y=a.isMeshStandardMaterial?h.environment:null,b=(a.isMeshStandardMaterial?n:t).get(a.envMap||y),x=b&&b.mapping===fH?b.image.height:null,S= __get$(m,a.type) ;a.precision!==null&&(p=i.getMaxPrecision(a.precision),p!==a.precision&&console.warn(`THREE.WebGLProgram.getParameters:`,a.precision,`not supported, using`,p,`instead.`));let C=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,w=C===void 0?0:C.length,T=0;v.morphAttributes.position!==void 0&&(T=1),v.morphAttributes.normal!==void 0&&(T=2),v.morphAttributes.color!==void 0&&(T=3);let E,D,O,k;if(S){let e= __get$(dq,S) ;E=e.vertexShader,D=e.fragmentShader}else E=a.vertexShader,D=a.fragmentShader,c.update(a),O=c.getVertexShaderID(a),k=c.getFragmentShaderID(a);let ee=e.getRenderTarget(),A=a.alphaTest>0,j=a.clearcoat>0;return{isWebGL2:u,shaderID:S,shaderName:a.type,vertexShader:E,fragmentShader:D,defines:a.defines,customVertexShaderID:O,customFragmentShaderID:k,isRawShaderMaterial:a.isRawShaderMaterial===!0,glslVersion:a.glslVersion,precision:p,instancing:g.isInstancedMesh===!0,instancingColor:g.isInstancedMesh===!0&&g.instanceColor!==null,supportsVertexTextures:f,outputEncoding:ee===null?e.outputEncoding:ee.isXRRenderTarget===!0?ee.texture.encoding:NU,map:!!a.map,matcap:!!a.matcap,envMap:!!b,envMapMode:b&&b.mapping,envMapCubeUVHeight:x,lightMap:!!a.lightMap,aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:a.normalMapType===LU,tangentSpaceNormalMap:a.normalMapType===0,decodeVideoTexture:!!a.map&&a.map.isVideoTexture===!0&&a.map.encoding===3001,clearcoat:j,clearcoatMap:j&&!!a.clearcoatMap,clearcoatRoughnessMap:j&&!!a.clearcoatRoughnessMap,clearcoatNormalMap:j&&!!a.clearcoatNormalMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,specularIntensityMap:!!a.specularIntensityMap,specularColorMap:!!a.specularColorMap,opaque:a.transparent===!1&&a.blending===CV,alphaMap:!!a.alphaMap,alphaTest:A,gradientMap:!!a.gradientMap,sheen:a.sheen>0,sheenColorMap:!!a.sheenColorMap,sheenRoughnessMap:!!a.sheenRoughnessMap,transmission:a.transmission>0,transmissionMap:!!a.transmissionMap,thicknessMap:!!a.thicknessMap,combine:a.combine,vertexTangents:!!a.normalMap&&!!v.attributes.tangent,vertexColors:a.vertexColors,vertexAlphas:a.vertexColors===!0&&!!v.attributes.color&&v.attributes.color.itemSize===4,vertexUvs:!!a.map||!!a.bumpMap||!!a.normalMap||!!a.specularMap||!!a.alphaMap||!!a.emissiveMap||!!a.roughnessMap||!!a.metalnessMap||!!a.clearcoatMap||!!a.clearcoatRoughnessMap||!!a.clearcoatNormalMap||!!a.displacementMap||!!a.transmissionMap||!!a.thicknessMap||!!a.specularIntensityMap||!!a.specularColorMap||!!a.sheenColorMap||!!a.sheenRoughnessMap,uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.transmission>0||a.transmissionMap||a.thicknessMap||a.specularIntensityMap||a.specularColorMap||a.sheen>0||a.sheenColorMap||a.sheenRoughnessMap)&&!!a.displacementMap,fog:!!_,useFog:a.fog===!0,fogExp2:_&&_.isFogExp2,flatShading:!!a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:d,skinning:g.isSkinnedMesh===!0,morphTargets:v.morphAttributes.position!==void 0,morphNormals:v.morphAttributes.normal!==void 0,morphColors:v.morphAttributes.color!==void 0,morphTargetsCount:w,morphTextureStride:T,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:tH,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===2,flipSided:a.side===yV,useDepthPacking:!!a.depthPacking,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has(`EXT_frag_depth`),rendererExtensionDrawBuffers:u||r.has(`WEBGL_draw_buffers`),rendererExtensionShaderTextureLod:u||r.has(`EXT_shader_texture_lod`),customProgramCacheKey:a.customProgramCacheKey()}}function g(t){let n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),t.defines!==void 0)for(let e in t.defines)n.push(e),n.push( __get$(t.defines,e) );return t.isRawShaderMaterial===!1&&(_(n,t),v(n,t),n.push(e.outputEncoding)),n.push(t.customProgramCacheKey),n.join()}function _(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}function v(e,t){s.disableAll(),t.isWebGL2&&s.enable(0),t.supportsVertexTextures&&s.enable(1),t.instancing&&s.enable(2),t.instancingColor&&s.enable(3),t.map&&s.enable(4),t.matcap&&s.enable(5),t.envMap&&s.enable(6),t.lightMap&&s.enable(7),t.aoMap&&s.enable(8),t.emissiveMap&&s.enable(9),t.bumpMap&&s.enable(10),t.normalMap&&s.enable(11),t.objectSpaceNormalMap&&s.enable(12),t.tangentSpaceNormalMap&&s.enable(13),t.clearcoat&&s.enable(14),t.clearcoatMap&&s.enable(15),t.clearcoatRoughnessMap&&s.enable(16),t.clearcoatNormalMap&&s.enable(17),t.displacementMap&&s.enable(18),t.specularMap&&s.enable(19),t.roughnessMap&&s.enable(20),t.metalnessMap&&s.enable(21),t.gradientMap&&s.enable(22),t.alphaMap&&s.enable(23),t.alphaTest&&s.enable(24),t.vertexColors&&s.enable(25),t.vertexAlphas&&s.enable(26),t.vertexUvs&&s.enable(27),t.vertexTangents&&s.enable(28),t.uvsVertexOnly&&s.enable(29),t.fog&&s.enable(30),e.push(s.mask),s.disableAll(),t.useFog&&s.enable(0),t.flatShading&&s.enable(1),t.logarithmicDepthBuffer&&s.enable(2),t.skinning&&s.enable(3),t.morphTargets&&s.enable(4),t.morphNormals&&s.enable(5),t.morphColors&&s.enable(6),t.premultipliedAlpha&&s.enable(7),t.shadowMapEnabled&&s.enable(8),t.physicallyCorrectLights&&s.enable(9),t.doubleSided&&s.enable(10),t.flipSided&&s.enable(11),t.useDepthPacking&&s.enable(12),t.dithering&&s.enable(13),t.specularIntensityMap&&s.enable(14),t.specularColorMap&&s.enable(15),t.transmission&&s.enable(16),t.transmissionMap&&s.enable(17),t.thicknessMap&&s.enable(18),t.sheen&&s.enable(19),t.sheenColorMap&&s.enable(20),t.sheenRoughnessMap&&s.enable(21),t.decodeVideoTexture&&s.enable(22),t.opaque&&s.enable(23),e.push(s.mask)}function y(e){let t= __get$(m,e.type) ,n;if(t){let e= __get$(dq,t) ;n=WK.clone(e.uniforms)}else n=e.uniforms;return n}function b(t,n){let r;for(let e=0,t=l.length;e<t;e++){let t= __get$(l,e) ;if(t.cacheKey===n){r=t,++r.usedTimes;break}}return r===void 0&&(r=new aB(e,n,t,a),l.push(r)),r}function x(e){if(--e.usedTimes===0){let t=l.indexOf(e); __set$(l,t,__get$(l,l.length-1)) ,l.pop(),e.destroy()}}function S(e){c.remove(e)}function C(){c.dispose()}return{getParameters:h,getProgramCacheKey:g,getUniforms:y,acquireProgram:b,releaseProgram:x,releaseShaderCache:S,programs:l,dispose:C}}function sB(){let e=new WeakMap;function t(t){let n=e.get(t);return n===void 0&&(n={},e.set(t,n)),n}function n(t){e.delete(t)}function r(t,n,r){ __set$(e.get(t),n,r) }function i(){e=new WeakMap}return{get:t,remove:n,update:r,dispose:i}}function cB(e,t){return e.groupOrder===t.groupOrder?e.renderOrder===t.renderOrder?e.material.id===t.material.id?e.z===t.z?e.id-t.id:e.z-t.z:e.material.id-t.material.id:e.renderOrder-t.renderOrder:e.groupOrder-t.groupOrder}function lB(e,t){return e.groupOrder===t.groupOrder?e.renderOrder===t.renderOrder?e.z===t.z?e.id-t.id:t.z-e.z:e.renderOrder-t.renderOrder:e.groupOrder-t.groupOrder}function uB(){let e=[],t=0,n=[],r=[],i=[];function a(){t=0,n.length=0,r.length=0,i.length=0}function o(n,r,i,a,o,s){let c= __get$(e,t) ;return c===void 0?(c={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s}, __set$(e,t,c) ):(c.id=n.id,c.object=n,c.geometry=r,c.material=i,c.groupOrder=a,c.renderOrder=n.renderOrder,c.z=o,c.group=s),t++,c}function s(e,t,a,s,c,l){let u=o(e,t,a,s,c,l);a.transmission>0?r.push(u):a.transparent===!0?i.push(u):n.push(u)}function c(e,t,a,s,c,l){let u=o(e,t,a,s,c,l);a.transmission>0?r.unshift(u):a.transparent===!0?i.unshift(u):n.unshift(u)}function l(e,t){n.length>1&&n.sort(e||cB),r.length>1&&r.sort(t||lB),i.length>1&&i.sort(t||lB)}function u(){for(let n=t,r=e.length;n<r;n++){let t= __get$(e,n) ;if(t.id===null)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}}return{opaque:n,transmissive:r,transparent:i,init:a,push:s,unshift:c,finish:u,sort:l}}function dB(){let e=new WeakMap;function t(t,n){let r;return e.has(t)===!1?(r=new uB,e.set(t,[r])):n>=e.get(t).length?(r=new uB,e.get(t).push(r)):r= __get$(e.get(t),n) ,r}function n(){e=new WeakMap}return{get:t,dispose:n}}function fB(){let e={};return{get:function(t){if( __get$(e,t.id) !==void 0)return  __get$(e,t.id) ;let n;switch(t.type){case`DirectionalLight`:n={direction:new Q,color:new kW};break;case`SpotLight`:n={position:new Q,direction:new Q,color:new kW,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case`PointLight`:n={position:new Q,color:new kW,distance:0,decay:0};break;case`HemisphereLight`:n={direction:new Q,skyColor:new kW,groundColor:new kW};break;case`RectAreaLight`:n={color:new kW,position:new Q,halfWidth:new Q,halfHeight:new Q};break}return  __set$(e,t.id,n) ,n}}}function pB(){let e={};return{get:function(t){if( __get$(e,t.id) !==void 0)return  __get$(e,t.id) ;let n;switch(t.type){case`DirectionalLight`:n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Z};break;case`SpotLight`:n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Z};break;case`PointLight`:n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Z,shadowCameraNear:1,shadowCameraFar:1e3};break}return  __set$(e,t.id,n) ,n}}}function _ee(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function vee(e,t){let n=new fB,r=pB(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)i.probe.push(new Q);let a=new Q,o=new vG,s=new vG;function c(a,o){let s=0,c=0,l=0;for(let e=0;e<9;e++) __get$(i.probe,e) .set(0,0,0);let u=0,d=0,f=0,p=0,m=0,h=0,g=0,_=0;a.sort(_ee);let v=o===!0?1:Math.PI;for(let e=0,t=a.length;e<t;e++){let t= __get$(a,e) ,o=t.color,y=t.intensity,b=t.distance,x=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)s+=o.r*y*v,c+=o.g*y*v,l+=o.b*y*v;else if(t.isLightProbe)for(let e=0;e<9;e++) __get$(i.probe,e) .addScaledVector( __get$(t.sh.coefficients,e) ,y);else if(t.isDirectionalLight){let e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*v),t.castShadow){let e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize, __set$(i.directionalShadow,u,n) , __set$(i.directionalShadowMap,u,x) , __set$(i.directionalShadowMatrix,u,t.shadow.matrix) ,h++} __set$(i.directional,u,e) ,u++}else if(t.isSpotLight){let e=n.get(t);if(e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(o).multiplyScalar(y*v),e.distance=b,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,t.castShadow){let e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize, __set$(i.spotShadow,f,n) , __set$(i.spotShadowMap,f,x) , __set$(i.spotShadowMatrix,f,t.shadow.matrix) ,_++} __set$(i.spot,f,e) ,f++}else if(t.isRectAreaLight){let e=n.get(t);e.color.copy(o).multiplyScalar(y),e.halfWidth.set(t.width*.5,0,0),e.halfHeight.set(0,t.height*.5,0), __set$(i.rectArea,p,e) ,p++}else if(t.isPointLight){let e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*v),e.distance=t.distance,e.decay=t.decay,t.castShadow){let e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far, __set$(i.pointShadow,d,n) , __set$(i.pointShadowMap,d,x) , __set$(i.pointShadowMatrix,d,t.shadow.matrix) ,g++} __set$(i.point,d,e) ,d++}else if(t.isHemisphereLight){let e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(y*v),e.groundColor.copy(t.groundColor).multiplyScalar(y*v), __set$(i.hemi,m,e) ,m++}}p>0&&(t.isWebGL2||e.has(`OES_texture_float_linear`)===!0?(i.rectAreaLTC1=uq.LTC_FLOAT_1,i.rectAreaLTC2=uq.LTC_FLOAT_2):e.has(`OES_texture_half_float_linear`)===!0?(i.rectAreaLTC1=uq.LTC_HALF_1,i.rectAreaLTC2=uq.LTC_HALF_2):console.error(`THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.`)),i.ambient[0]=s,i.ambient[1]=c,i.ambient[2]=l;let y=i.hash;(y.directionalLength!==u||y.pointLength!==d||y.spotLength!==f||y.rectAreaLength!==p||y.hemiLength!==m||y.numDirectionalShadows!==h||y.numPointShadows!==g||y.numSpotShadows!==_)&&(i.directional.length=u,i.spot.length=f,i.rectArea.length=p,i.point.length=d,i.hemi.length=m,i.directionalShadow.length=h,i.directionalShadowMap.length=h,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=_,i.spotShadowMap.length=_,i.directionalShadowMatrix.length=h,i.pointShadowMatrix.length=g,i.spotShadowMatrix.length=_,y.directionalLength=u,y.pointLength=d,y.spotLength=f,y.rectAreaLength=p,y.hemiLength=m,y.numDirectionalShadows=h,y.numPointShadows=g,y.numSpotShadows=_,i.version=Bq++)}function l(e,t){let n=0,r=0,c=0,l=0,u=0,d=t.matrixWorldInverse;for(let t=0,f=e.length;t<f;t++){let f= __get$(e,t) ;if(f.isDirectionalLight){let e= __get$(i.directional,n) ;e.direction.setFromMatrixPosition(f.matrixWorld),a.setFromMatrixPosition(f.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(d),n++}else if(f.isSpotLight){let e= __get$(i.spot,c) ;e.position.setFromMatrixPosition(f.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(f.matrixWorld),a.setFromMatrixPosition(f.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(d),c++}else if(f.isRectAreaLight){let e= __get$(i.rectArea,l) ;e.position.setFromMatrixPosition(f.matrixWorld),e.position.applyMatrix4(d),s.identity(),o.copy(f.matrixWorld),o.premultiply(d),s.extractRotation(o),e.halfWidth.set(f.width*.5,0,0),e.halfHeight.set(0,f.height*.5,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),l++}else if(f.isPointLight){let e= __get$(i.point,r) ;e.position.setFromMatrixPosition(f.matrixWorld),e.position.applyMatrix4(d),r++}else if(f.isHemisphereLight){let e= __get$(i.hemi,u) ;e.direction.setFromMatrixPosition(f.matrixWorld),e.direction.transformDirection(d),u++}}}return{setup:c,setupView:l,state:i}}function mB(e,t){let n=new vee(e,t),r=[],i=[];function a(){r.length=0,i.length=0}function o(e){r.push(e)}function s(e){i.push(e)}function c(e){n.setup(r,e)}function l(e){n.setupView(r,e)}return{init:a,state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:c,setupLightsView:l,pushLight:o,pushShadow:s}}function yee(e,t){let n=new WeakMap;function r(r,i=0){let a;return n.has(r)===!1?(a=new mB(e,t),n.set(r,[a])):i>=n.get(r).length?(a=new mB(e,t),n.get(r).push(a)):a= __get$(n.get(r),i) ,a}function i(){n=new WeakMap}return{get:r,dispose:i}}function hB(e,t,n){let r=new sq,i=new Z,a=new Z,o=new FW,s=new Vq({depthPacking:IU}),c=new Hq,l={},u=n.maxTextureSize,d={0:yV,1:0,2:2},f=new qK({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Z},radius:{value:4}},vertexShader:Uq,fragmentShader:Wq}),p=f.clone();p.defines.HORIZONTAL_PASS=1;let m=new wK;m.setAttribute(`position`,new oK(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let h=new HK(m,f),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=gV,this.render=function(t,n,s){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||t.length===0)return;let c=e.getRenderTarget(),l=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.state;f.setBlending(SV),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(let c=0,l=t.length;c<l;c++){let l= __get$(t,c) ,d=l.shadow;if(d===void 0){console.warn(`THREE.WebGLShadowMap:`,l,`has no shadow.`);continue}if(d.autoUpdate===!1&&d.needsUpdate===!1)continue;i.copy(d.mapSize);let p=d.getFrameExtents();if(i.multiply(p),a.copy(d.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(a.x=Math.floor(u/p.x),i.x=a.x*p.x,d.mapSize.x=a.x),i.y>u&&(a.y=Math.floor(u/p.y),i.y=a.y*p.y,d.mapSize.y=a.y)),d.map===null&&!d.isPointLightShadow&&this.type===vV&&(d.map=new IW(i.x,i.y),d.map.texture.name=l.name+`.shadowMap`,d.mapPass=new IW(i.x,i.y),d.camera.updateProjectionMatrix()),d.map===null){let e={minFilter:gH,magFilter:gH,format:zH};d.map=new IW(i.x,i.y,e),d.map.texture.name=l.name+`.shadowMap`,d.camera.updateProjectionMatrix()}e.setRenderTarget(d.map),e.clear();let m=d.getViewportCount();for(let e=0;e<m;e++){let t=d.getViewport(e);o.set(a.x*t.x,a.y*t.y,a.x*t.z,a.y*t.w),f.viewport(o),d.updateMatrices(l,e),r=d.getFrustum(),y(n,s,d.camera,l,this.type)}!d.isPointLightShadow&&this.type===vV&&_(d,s),d.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(c,l,d)};function _(n,r){let i=t.update(h);f.defines.VSM_SAMPLES!==n.blurSamples&&(f.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,f.needsUpdate=!0,p.needsUpdate=!0),f.uniforms.shadow_pass.value=n.map.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,f,h,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,p,h,null)}function v(t,n,r,i,a,o){let u=null,f=r.isPointLight===!0?t.customDistanceMaterial:t.customDepthMaterial;if(u=f===void 0?r.isPointLight===!0?c:s:f,e.localClippingEnabled&&n.clipShadows===!0&&n.clippingPlanes.length!==0||n.displacementMap&&n.displacementScale!==0||n.alphaMap&&n.alphaTest>0){let e=u.uuid,t=n.uuid,r= __get$(l,e) ;r===void 0&&(r={}, __set$(l,e,r) );let i= __get$(r,t) ;i===void 0&&(i=u.clone(), __set$(r,t,i) ),u=i}return u.visible=n.visible,u.wireframe=n.wireframe,o===vV?u.side=n.shadowSide===null?n.side:n.shadowSide:u.side=n.shadowSide===null? __get$(d,n.side) :n.shadowSide,u.alphaMap=n.alphaMap,u.alphaTest=n.alphaTest,u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.displacementMap=n.displacementMap,u.displacementScale=n.displacementScale,u.displacementBias=n.displacementBias,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,r.isPointLight===!0&&u.isMeshDistanceMaterial===!0&&(u.referencePosition.setFromMatrixPosition(r.matrixWorld),u.nearDistance=i,u.farDistance=a),u}function y(n,i,a,o,s){if(n.visible===!1)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===vV)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);let r=t.update(n),i=n.material;if(Array.isArray(i)){let t=r.groups;for(let c=0,l=t.length;c<l;c++){let l= __get$(t,c) ,u= __get$(i,l.materialIndex) ;if(u&&u.visible){let t=v(n,u,o,a.near,a.far,s);e.renderBufferDirect(a,null,r,t,n,l)}}}else if(i.visible){let t=v(n,i,o,a.near,a.far,s);e.renderBufferDirect(a,null,r,t,n,null)}}let c=n.children;for(let e=0,t=c.length;e<t;e++)y( __get$(c,e) ,i,a,o,s)}}function bee(e,t,n){let r=n.isWebGL2;function i(){let t=!1,n=new FW,r=null,i=new FW(0,0,0,0);return{setMask:function(n){r!==n&&!t&&(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){s===!0&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),i.equals(n)===!1&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}}function a(){let t=!1,n=null,r=null,i=null;return{setTest:function(e){e?ie(2929):L(2929)},setMask:function(r){n!==r&&!t&&(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case WV:e.depthFunc(512);break;case GV:e.depthFunc(519);break;case KV:e.depthFunc(513);break;case qV:e.depthFunc(515);break;case JV:e.depthFunc(514);break;case YV:e.depthFunc(518);break;case XV:e.depthFunc(516);break;case ZV:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}}function o(){let t=!1,n=null,r=null,i=null,a=null,o=null,s=null,c=null,l=null;return{setTest:function(e){t||(e?ie(2960):L(2960))},setMask:function(r){n!==r&&!t&&(e.stencilMask(r),n=r)},setFunc:function(t,n,o){(r!==t||i!==n||a!==o)&&(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){(o!==t||s!==n||c!==r)&&(e.stencilOp(t,n,r),o=t,s=n,c=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,c=null,l=null}}}let s=new i,c=new a,l=new o,u={},d={},f=new WeakMap,p=[],m=null,h=!1,g=null,_=null,v=null,y=null,b=null,x=null,S=null,C=!1,w=null,T=null,E=null,D=null,O=null,k=e.getParameter(35661),ee=!1,A=0,j=e.getParameter(7938);j.indexOf(`WebGL`)===-1?j.indexOf(`OpenGL ES`)!==-1&&(A=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),ee=A>=2):(A=parseFloat(/^WebGL (\d)/.exec(j)[1]),ee=A>=1);let M=null,N={},P=e.getParameter(3088),te=e.getParameter(2978),F=new FW().fromArray(P),ne=new FW().fromArray(te);function I(t,n,r){let i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<r;t++)e.texImage2D(n+t,0,6408,1,1,0,6408,5121,i);return a}let re={};re[3553]=I(3553,3553,1),re[34067]=I(34067,34069,6),s.setClear(0,0,0,1),c.setClear(1),l.setClear(0),ie(2929),c.setFunc(qV),de(!1),fe(fV),ie(2884),le(SV);function ie(t){ __get$(u,t) !==!0&&(e.enable(t), __set$(u,t,!0) )}function L(t){ __get$(u,t) !==!1&&(e.disable(t), __set$(u,t,!1) )}function R(t,n){return  __get$(d,t) ===n?!1:(e.bindFramebuffer(t,n), __set$(d,t,n) ,r&&(t===36009&&(d[36160]=n),t===36160&&(d[36009]=n)),!0)}function ae(r,i){let a=p,o=!1;if(r)if(a=f.get(i),a===void 0&&(a=[],f.set(i,a)),r.isWebGLMultipleRenderTargets){let e=r.texture;if(a.length!==e.length||a[0]!==36064){for(let t=0,n=e.length;t<n;t++) __set$(a,t,36064+t) ;a.length=e.length,o=!0}}else a[0]!==36064&&(a[0]=36064,o=!0);else a[0]!==1029&&(a[0]=1029,o=!0);o&&(n.isWebGL2?e.drawBuffers(a):t.get(`WEBGL_draw_buffers`).drawBuffersWEBGL(a))}function oe(t){return m===t?!1:(e.useProgram(t),m=t,!0)}let se={[OV]:32774,[kV]:32778,[AV]:32779};if(r) __set$(se,jV,32775) , __set$(se,MV,32776) ;else{let e=t.get(`EXT_blend_minmax`);e!==null&&( __set$(se,jV,e.MIN_EXT) , __set$(se,MV,e.MAX_EXT) )}let ce={[NV]:0,[PV]:1,[FV]:768,[LV]:770,[UV]:776,[VV]:774,[zV]:772,[IV]:769,[RV]:771,[HV]:775,[BV]:773};function le(t,n,r,i,a,o,s,c){if(t===SV){h===!0&&(L(3042),h=!1);return}if(h===!1&&(ie(3042),h=!0),t!==DV){if(t!==g||c!==C){if((_!==OV||b!==OV)&&(e.blendEquation(32774),_=OV,b=OV),c)switch(t){case CV:e.blendFuncSeparate(1,771,1,771);break;case wV:e.blendFunc(1,1);break;case TV:e.blendFuncSeparate(0,769,0,1);break;case EV:e.blendFuncSeparate(0,768,0,770);break;default:console.error(`THREE.WebGLState: Invalid blending: `,t);break}else switch(t){case CV:e.blendFuncSeparate(770,771,1,771);break;case wV:e.blendFunc(770,1);break;case TV:e.blendFuncSeparate(0,769,0,1);break;case EV:e.blendFunc(0,768);break;default:console.error(`THREE.WebGLState: Invalid blending: `,t);break}v=null,y=null,x=null,S=null,g=t,C=c}return}a||=n,o||=r,s||=i,(n!==_||a!==b)&&(e.blendEquationSeparate( __get$(se,n) , __get$(se,a) ),_=n,b=a),(r!==v||i!==y||o!==x||s!==S)&&(e.blendFuncSeparate( __get$(ce,r) , __get$(ce,i) , __get$(ce,o) , __get$(ce,s) ),v=r,y=i,x=o,S=s),g=t,C=null}function ue(e,t){e.side===2?L(2884):ie(2884);let n=e.side===yV;t&&(n=!n),de(n),e.blending===CV&&e.transparent===!1?le(SV):le(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),c.setFunc(e.depthFunc),c.setTest(e.depthTest),c.setMask(e.depthWrite),s.setMask(e.colorWrite);let r=e.stencilWrite;l.setTest(r),r&&(l.setMask(e.stencilWriteMask),l.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),l.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),me(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0?ie(32926):L(32926)}function de(t){w!==t&&(t?e.frontFace(2304):e.frontFace(2305),w=t)}function fe(t){t===dV?L(2884):(ie(2884),t!==T&&(t===fV?e.cullFace(1029):t===pV?e.cullFace(1028):e.cullFace(1032))),T=t}function pe(t){t!==E&&(ee&&e.lineWidth(t),E=t)}function me(t,n,r){t?(ie(32823),(D!==n||O!==r)&&(e.polygonOffset(n,r),D=n,O=r)):L(32823)}function z(e){e?ie(3089):L(3089)}function he(t){t===void 0&&(t=33984+k-1),M!==t&&(e.activeTexture(t),M=t)}function ge(t,n){M===null&&he();let r= __get$(N,M) ;r===void 0&&(r={type:void 0,texture:void 0}, __set$(N,M,r) ),(r.type!==t||r.texture!==n)&&(e.bindTexture(t,n|| __get$(re,t) ),r.type=t,r.texture=n)}function _e(){let t= __get$(N,M) ;t!==void 0&&t.type!==void 0&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)}function ve(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error(`THREE.WebGLState:`,e)}}function ye(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error(`THREE.WebGLState:`,e)}}function be(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error(`THREE.WebGLState:`,e)}}function xe(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error(`THREE.WebGLState:`,e)}}function Se(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error(`THREE.WebGLState:`,e)}}function B(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error(`THREE.WebGLState:`,e)}}function Ce(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error(`THREE.WebGLState:`,e)}}function we(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error(`THREE.WebGLState:`,e)}}function V(t){F.equals(t)===!1&&(e.scissor(t.x,t.y,t.z,t.w),F.copy(t))}function Te(t){ne.equals(t)===!1&&(e.viewport(t.x,t.y,t.z,t.w),ne.copy(t))}function Ee(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),r===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},M=null,N={},d={},f=new WeakMap,p=[],m=null,h=!1,g=null,_=null,v=null,y=null,b=null,x=null,S=null,C=!1,w=null,T=null,E=null,D=null,O=null,F.set(0,0,e.canvas.width,e.canvas.height),ne.set(0,0,e.canvas.width,e.canvas.height),s.reset(),c.reset(),l.reset()}return{buffers:{color:s,depth:c,stencil:l},enable:ie,disable:L,bindFramebuffer:R,drawBuffers:ae,useProgram:oe,setBlending:le,setMaterial:ue,setFlipSided:de,setCullFace:fe,setLineWidth:pe,setPolygonOffset:me,setScissorTest:z,activeTexture:he,bindTexture:ge,unbindTexture:_e,compressedTexImage2D:ve,texImage2D:Ce,texImage3D:we,texStorage2D:Se,texStorage3D:B,texSubImage2D:ye,texSubImage3D:be,compressedTexSubImage2D:xe,scissor:V,viewport:Te,reset:Ee}}function xee(e,t,n,r,i,a,o){let s=i.isWebGL2,c=i.maxTextures,l=i.maxCubemapSize,u=i.maxTextureSize,d=i.maxSamples,f=t.has(`WEBGL_multisampled_render_to_texture`)?t.get(`WEBGL_multisampled_render_to_texture`):null,p=/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap,h,g=new WeakMap,_=!1;try{_=typeof OffscreenCanvas<`u`&&new OffscreenCanvas(1,1).getContext(`2d`)!==null}catch{}function v(e,t){return _?new OffscreenCanvas(e,t):iR(`canvas`)}function y(e,t,n,r){let i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||t===!0)if(typeof HTMLImageElement<`u`&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<`u`&&e instanceof HTMLCanvasElement||typeof ImageBitmap<`u`&&e instanceof ImageBitmap){let r=t?QL:Math.floor,a=r(i*e.width),o=r(i*e.height);h===void 0&&(h=v(a,o));let s=n?v(a,o):h;return s.width=a,s.height=o,s.getContext(`2d`).drawImage(e,0,0,a,o),console.warn(`THREE.WebGLRenderer: Texture has been resized from (`+e.width+`x`+e.height+`) to (`+a+`x`+o+`).`),s}else return`data`in e&&console.warn(`THREE.WebGLRenderer: Image in DataTexture is too big (`+e.width+`x`+e.height+`).`),e;return e}function b(e){return XL(e.width)&&XL(e.height)}function x(e){return s?!1:e.wrapS!==1001||e.wrapT!==1001||e.minFilter!==1003&&e.minFilter!==1006}function S(e,t){return e.generateMipmaps&&t&&e.minFilter!==1003&&e.minFilter!==1006}function C(t){e.generateMipmap(t)}function w(n,r,i,a,o=!1){if(s===!1)return r;if(n!==null){if( __get$(e,n) !==void 0)return  __get$(e,n) ;console.warn(`THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '`+n+`'`)}let c=r;return r===6403&&(i===5126&&(c=33326),i===5131&&(c=33325),i===5121&&(c=33321)),r===33319&&(i===5126&&(c=33328),i===5131&&(c=33327),i===5121&&(c=33323)),r===6408&&(i===5126&&(c=34836),i===5131&&(c=34842),i===5121&&(c=a===3001&&o===!1?35907:32856),i===32819&&(c=32854),i===32820&&(c=32855)),(c===33325||c===33326||c===33327||c===33328||c===34842||c===34836)&&t.get(`EXT_color_buffer_float`),c}function T(e,t,n){return S(e,n)===!0||e.isFramebufferTexture&&e.minFilter!==1003&&e.minFilter!==1006?Math.log2(Math.max(t.width,t.height))+1:e.mipmaps!==void 0&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function E(e){return e===1003||e===1004||e===1005?9728:9729}function D(e){let t=e.target;t.removeEventListener(`dispose`,D),k(t),t.isVideoTexture&&m.delete(t)}function O(e){let t=e.target;t.removeEventListener(`dispose`,O),A(t)}function k(e){let t=r.get(e);if(t.__webglInit===void 0)return;let n=e.source,i=g.get(n);if(i){let r= __get$(i,t.__cacheKey) ;r.usedTimes--,r.usedTimes===0&&ee(e),Object.keys(i).length===0&&g.delete(n)}r.remove(e)}function ee(t){let n=r.get(t);e.deleteTexture(n.__webglTexture);let i=t.source,a=g.get(i);delete a[n.__cacheKey],o.memory.textures--}function A(t){let n=t.texture,i=r.get(t),a=r.get(n);if(a.__webglTexture!==void 0&&(e.deleteTexture(a.__webglTexture),o.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer( __get$(i.__webglFramebuffer,t) ),i.__webglDepthbuffer&&e.deleteRenderbuffer( __get$(i.__webglDepthbuffer,t) );else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);if(t.isWebGLMultipleRenderTargets)for(let t=0,i=n.length;t<i;t++){let i=r.get( __get$(n,t) );i.__webglTexture&&(e.deleteTexture(i.__webglTexture),o.memory.textures--),r.remove( __get$(n,t) )}r.remove(n),r.remove(t)}let j=0;function M(){j=0}function N(){let e=j;return e>=c&&console.warn(`THREE.WebGLTextures: Trying to use `+e+` texture units while this GPU supports only `+c),j+=1,e}function P(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}function te(e,t){let i=r.get(e);if(e.isVideoTexture&&ge(e),e.isRenderTargetTexture===!1&&e.version>0&&i.__version!==e.version){let n=e.image;if(n===null)console.warn(`THREE.WebGLRenderer: Texture marked for update but no image data found.`);else if(n.complete===!1)console.warn(`THREE.WebGLRenderer: Texture marked for update but image is incomplete`);else{ae(i,e,t);return}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function F(e,t){let i=r.get(e);if(e.version>0&&i.__version!==e.version){ae(i,e,t);return}n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture)}function ne(e,t){let i=r.get(e);if(e.version>0&&i.__version!==e.version){ae(i,e,t);return}n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture)}function I(e,t){let i=r.get(e);if(e.version>0&&i.__version!==e.version){oe(i,e,t);return}n.activeTexture(33984+t),n.bindTexture(34067,i.__webglTexture)}let re={[pH]:10497,[mH]:33071,[hH]:33648},ie={[gH]:9728,[_H]:9984,[yH]:9986,[xH]:9729,[SH]:9985,[wH]:9987};function L(n,a,o){if(o?(e.texParameteri(n,10242, __get$(re,a.wrapS) ),e.texParameteri(n,10243, __get$(re,a.wrapT) ),(n===32879||n===35866)&&e.texParameteri(n,32882, __get$(re,a.wrapR) ),e.texParameteri(n,10240, __get$(ie,a.magFilter) ),e.texParameteri(n,10241, __get$(ie,a.minFilter) )):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),(n===32879||n===35866)&&e.texParameteri(n,32882,33071),(a.wrapS!==1001||a.wrapT!==1001)&&console.warn(`THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.`),e.texParameteri(n,10240,E(a.magFilter)),e.texParameteri(n,10241,E(a.minFilter)),a.minFilter!==1003&&a.minFilter!==1006&&console.warn(`THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.`)),t.has(`EXT_texture_filter_anisotropic`)===!0){let o=t.get(`EXT_texture_filter_anisotropic`);if(a.type===MH&&t.has(`OES_texture_float_linear`)===!1||s===!1&&a.type===NH&&t.has(`OES_texture_half_float_linear`)===!1)return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function R(t,n){let r=!1;t.__webglInit===void 0&&(t.__webglInit=!0,n.addEventListener(`dispose`,D));let i=n.source,a=g.get(i);a===void 0&&(a={},g.set(i,a));let s=P(n);if(s!==t.__cacheKey){ __get$(a,s) ===void 0&&( __set$(a,s,{texture:e.createTexture(),usedTimes:0}) ,o.memory.textures++,r=!0), __get$(a,s) .usedTimes++;let i= __get$(a,t.__cacheKey) ;i!==void 0&&( __get$(a,t.__cacheKey) .usedTimes--,i.usedTimes===0&&ee(n)),t.__cacheKey=s,t.__webglTexture= __get$(a,s) .texture}return r}function ae(t,r,i){let o=3553;r.isDataArrayTexture&&(o=35866),r.isData3DTexture&&(o=32879);let c=R(t,r),l=r.source;if(n.activeTexture(33984+i),n.bindTexture(o,t.__webglTexture),l.version!==l.__currentVersion||c===!0){e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);let i=x(r)&&b(r.image)===!1,d=y(r.image,i,!1,u);d=_e(r,d);let f=b(d)||s,p=a.convert(r.format,r.encoding),m=a.convert(r.type),h=w(r.internalFormat,p,m,r.encoding,r.isVideoTexture);L(o,r,f);let g,_=r.mipmaps,v=s&&r.isVideoTexture!==!0,E=t.__version===void 0||c===!0,D=T(r,d,f);if(r.isDepthTexture)h=6402,s?h=r.type===MH?36012:r.type===jH?33190:r.type===IH?35056:33189:r.type===MH&&console.error(`WebGLRenderer: Floating point depth texture requires WebGL2.`),r.format===HH&&h===6402&&r.type!==kH&&r.type!==jH&&(console.warn(`THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.`),r.type=kH,m=a.convert(r.type)),r.format===UH&&h===6402&&(h=34041,r.type!==IH&&(console.warn(`THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.`),r.type=IH,m=a.convert(r.type))),E&&(v?n.texStorage2D(3553,1,h,d.width,d.height):n.texImage2D(3553,0,h,d.width,d.height,0,p,m,null));else if(r.isDataTexture)if(_.length>0&&f){v&&E&&n.texStorage2D(3553,D,h,_[0].width,_[0].height);for(let e=0,t=_.length;e<t;e++)g= __get$(_,e) ,v?n.texSubImage2D(3553,e,0,0,g.width,g.height,p,m,g.data):n.texImage2D(3553,e,h,g.width,g.height,0,p,m,g.data);r.generateMipmaps=!1}else v?(E&&n.texStorage2D(3553,D,h,d.width,d.height),n.texSubImage2D(3553,0,0,0,d.width,d.height,p,m,d.data)):n.texImage2D(3553,0,h,d.width,d.height,0,p,m,d.data);else if(r.isCompressedTexture){v&&E&&n.texStorage2D(3553,D,h,_[0].width,_[0].height);for(let e=0,t=_.length;e<t;e++)g= __get$(_,e) ,r.format===zH?v?n.texSubImage2D(3553,e,0,0,g.width,g.height,p,m,g.data):n.texImage2D(3553,e,h,g.width,g.height,0,p,m,g.data):p===null?console.warn(`THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()`):v?n.compressedTexSubImage2D(3553,e,0,0,g.width,g.height,p,g.data):n.compressedTexImage2D(3553,e,h,g.width,g.height,0,g.data)}else if(r.isDataArrayTexture)v?(E&&n.texStorage3D(35866,D,h,d.width,d.height,d.depth),n.texSubImage3D(35866,0,0,0,0,d.width,d.height,d.depth,p,m,d.data)):n.texImage3D(35866,0,h,d.width,d.height,d.depth,0,p,m,d.data);else if(r.isData3DTexture)v?(E&&n.texStorage3D(32879,D,h,d.width,d.height,d.depth),n.texSubImage3D(32879,0,0,0,0,d.width,d.height,d.depth,p,m,d.data)):n.texImage3D(32879,0,h,d.width,d.height,d.depth,0,p,m,d.data);else if(r.isFramebufferTexture){if(E)if(v)n.texStorage2D(3553,D,h,d.width,d.height);else{let e=d.width,t=d.height;for(let r=0;r<D;r++)n.texImage2D(3553,r,h,e,t,0,p,m,null),e>>=1,t>>=1}}else if(_.length>0&&f){v&&E&&n.texStorage2D(3553,D,h,_[0].width,_[0].height);for(let e=0,t=_.length;e<t;e++)g= __get$(_,e) ,v?n.texSubImage2D(3553,e,0,0,p,m,g):n.texImage2D(3553,e,h,p,m,g);r.generateMipmaps=!1}else v?(E&&n.texStorage2D(3553,D,h,d.width,d.height),n.texSubImage2D(3553,0,0,0,p,m,d)):n.texImage2D(3553,0,h,p,m,d);S(r,f)&&C(o),l.__currentVersion=l.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}function oe(t,r,i){if(r.image.length!==6)return;let o=R(t,r),c=r.source;if(n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),c.version!==c.__currentVersion||o===!0){e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);let i=r.isCompressedTexture||r.image[0].isCompressedTexture,o=r.image[0]&&r.image[0].isDataTexture,u=[];for(let e=0;e<6;e++)!i&&!o? __set$(u,e,y(__get$(r.image,e),!1,!0,l)) : __set$(u,e,o?__get$(r.image,e).image:__get$(r.image,e)) , __set$(u,e,_e(r,__get$(u,e))) ;let d=u[0],f=b(d)||s,p=a.convert(r.format,r.encoding),m=a.convert(r.type),h=w(r.internalFormat,p,m,r.encoding),g=s&&r.isVideoTexture!==!0,_=t.__version===void 0,v=T(r,d,f);L(34067,r,f);let x;if(i){g&&_&&n.texStorage2D(34067,v,h,d.width,d.height);for(let e=0;e<6;e++){x= __get$(u,e) .mipmaps;for(let t=0;t<x.length;t++){let i= __get$(x,t) ;r.format===zH?g?n.texSubImage2D(34069+e,t,0,0,i.width,i.height,p,m,i.data):n.texImage2D(34069+e,t,h,i.width,i.height,0,p,m,i.data):p===null?console.warn(`THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()`):g?n.compressedTexSubImage2D(34069+e,t,0,0,i.width,i.height,p,i.data):n.compressedTexImage2D(34069+e,t,h,i.width,i.height,0,i.data)}}}else{x=r.mipmaps,g&&_&&(x.length>0&&v++,n.texStorage2D(34067,v,h,u[0].width,u[0].height));for(let e=0;e<6;e++)if(o){g?n.texSubImage2D(34069+e,0,0,0, __get$(u,e) .width, __get$(u,e) .height,p,m, __get$(u,e) .data):n.texImage2D(34069+e,0,h, __get$(u,e) .width, __get$(u,e) .height,0,p,m, __get$(u,e) .data);for(let t=0;t<x.length;t++){let r= __get$(__get$(x,t).image,e) .image;g?n.texSubImage2D(34069+e,t+1,0,0,r.width,r.height,p,m,r.data):n.texImage2D(34069+e,t+1,h,r.width,r.height,0,p,m,r.data)}}else{g?n.texSubImage2D(34069+e,0,0,0,p,m, __get$(u,e) ):n.texImage2D(34069+e,0,h,p,m, __get$(u,e) );for(let t=0;t<x.length;t++){let r= __get$(x,t) ;g?n.texSubImage2D(34069+e,t+1,0,0,p,m, __get$(r.image,e) ):n.texImage2D(34069+e,t+1,h,p,m, __get$(r.image,e) )}}}S(r,f)&&C(34067),c.__currentVersion=c.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}function se(t,i,o,s,c){let l=a.convert(o.format,o.encoding),u=a.convert(o.type),d=w(o.internalFormat,l,u,o.encoding);r.get(i).__hasExternalTextures||(c===32879||c===35866?n.texImage3D(c,0,d,i.width,i.height,i.depth,0,l,u,null):n.texImage2D(c,0,d,i.width,i.height,0,l,u,null)),n.bindFramebuffer(36160,t),he(i)?f.framebufferTexture2DMultisampleEXT(36160,s,c,r.get(o).__webglTexture,0,z(i)):e.framebufferTexture2D(36160,s,c,r.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function ce(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r||he(n)){let t=n.depthTexture;t&&t.isDepthTexture&&(t.type===MH?i=36012:t.type===jH&&(i=33190));let r=z(n);he(n)?f.renderbufferStorageMultisampleEXT(36161,r,i,n.width,n.height):e.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){let i=z(n);r&&he(n)===!1?e.renderbufferStorageMultisample(36161,i,35056,n.width,n.height):he(n)?f.renderbufferStorageMultisampleEXT(36161,i,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{let t=n.isWebGLMultipleRenderTargets===!0?n.texture[0]:n.texture,i=a.convert(t.format,t.encoding),o=a.convert(t.type),s=w(t.internalFormat,i,o,t.encoding),c=z(n);r&&he(n)===!1?e.renderbufferStorageMultisample(36161,c,s,n.width,n.height):he(n)?f.renderbufferStorageMultisampleEXT(36161,c,s,n.width,n.height):e.renderbufferStorage(36161,s,n.width,n.height)}e.bindRenderbuffer(36161,null)}function le(t,i){if(i&&i.isWebGLCubeRenderTarget)throw Error(`Depth Texture with cube render targets is not supported`);if(n.bindFramebuffer(36160,t),!(i.depthTexture&&i.depthTexture.isDepthTexture))throw Error(`renderTarget.depthTexture must be an instance of THREE.DepthTexture`);(!r.get(i.depthTexture).__webglTexture||i.depthTexture.image.width!==i.width||i.depthTexture.image.height!==i.height)&&(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),te(i.depthTexture,0);let a=r.get(i.depthTexture).__webglTexture,o=z(i);if(i.depthTexture.format===HH)he(i)?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,a,0,o):e.framebufferTexture2D(36160,36096,3553,a,0);else if(i.depthTexture.format===UH)he(i)?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,a,0,o):e.framebufferTexture2D(36160,33306,3553,a,0);else throw Error(`Unknown depthTexture format`)}function ue(t){let i=r.get(t),a=t.isWebGLCubeRenderTarget===!0;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw Error(`target.depthTexture not supported in Cube render targets`);le(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(36160, __get$(i.__webglFramebuffer,r) ), __set$(i.__webglDepthbuffer,r,e.createRenderbuffer()) ,ce( __get$(i.__webglDepthbuffer,r) ,t,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),ce(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function de(e,t,n){let i=r.get(e);t!==void 0&&se(i.__webglFramebuffer,e,e.texture,36064,3553),n!==void 0&&ue(e)}function fe(t){let c=t.texture,l=r.get(t),u=r.get(c);t.addEventListener(`dispose`,O),t.isWebGLMultipleRenderTargets!==!0&&(u.__webglTexture===void 0&&(u.__webglTexture=e.createTexture()),u.__version=c.version,o.memory.textures++);let d=t.isWebGLCubeRenderTarget===!0,f=t.isWebGLMultipleRenderTargets===!0,p=b(t)||s;if(d){l.__webglFramebuffer=[];for(let t=0;t<6;t++) __set$(l.__webglFramebuffer,t,e.createFramebuffer()) }else if(l.__webglFramebuffer=e.createFramebuffer(),f)if(i.drawBuffers){let n=t.texture;for(let t=0,i=n.length;t<i;t++){let i=r.get( __get$(n,t) );i.__webglTexture===void 0&&(i.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn(`THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.`);else if(s&&t.samples>0&&he(t)===!1){l.__webglMultisampledFramebuffer=e.createFramebuffer(),l.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,l.__webglColorRenderbuffer);let r=a.convert(c.format,c.encoding),i=a.convert(c.type),o=w(c.internalFormat,r,i,c.encoding),s=z(t);e.renderbufferStorageMultisample(36161,s,o,t.width,t.height),n.bindFramebuffer(36160,l.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,l.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(l.__webglDepthRenderbuffer=e.createRenderbuffer(),ce(l.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}if(d){n.bindTexture(34067,u.__webglTexture),L(34067,c,p);for(let e=0;e<6;e++)se( __get$(l.__webglFramebuffer,e) ,t,c,36064,34069+e);S(c,p)&&C(34067),n.unbindTexture()}else if(f){let e=t.texture;for(let i=0,a=e.length;i<a;i++){let a= __get$(e,i) ,o=r.get(a);n.bindTexture(3553,o.__webglTexture),L(3553,a,p),se(l.__webglFramebuffer,t,a,36064+i,3553),S(a,p)&&C(3553)}n.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(s?e=t.isWebGL3DRenderTarget?32879:35866:console.error(`THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.`)),n.bindTexture(e,u.__webglTexture),L(e,c,p),se(l.__webglFramebuffer,t,c,36064,e),S(c,p)&&C(e),n.unbindTexture()}t.depthBuffer&&ue(t)}function pe(e){let t=b(e)||s,i=e.isWebGLMultipleRenderTargets===!0?e.texture:[e.texture];for(let a=0,o=i.length;a<o;a++){let o= __get$(i,a) ;if(S(o,t)){let t=e.isWebGLCubeRenderTarget?34067:3553,i=r.get(o).__webglTexture;n.bindTexture(t,i),C(t),n.unbindTexture()}}}function me(t){if(s&&t.samples>0&&he(t)===!1){let i=t.width,a=t.height,o=16384,s=[36064],c=t.stencilBuffer?33306:36096;t.depthBuffer&&s.push(c);let l=r.get(t),u=l.__ignoreDepthValues===void 0?!1:l.__ignoreDepthValues;u===!1&&(t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024)),n.bindFramebuffer(36008,l.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,l.__webglFramebuffer),u===!0&&(e.invalidateFramebuffer(36008,[c]),e.invalidateFramebuffer(36009,[c])),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728),p&&e.invalidateFramebuffer(36008,s),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,l.__webglMultisampledFramebuffer)}}function z(e){return Math.min(d,e.samples)}function he(e){let n=r.get(e);return s&&e.samples>0&&t.has(`WEBGL_multisampled_render_to_texture`)===!0&&n.__useRenderToTexture!==!1}function ge(e){let t=o.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}function _e(e,n){let r=e.encoding,i=e.format,a=e.type;return e.isCompressedTexture===!0||e.isVideoTexture===!0||e.format===mW||r!==NU&&(r===3001?s===!1?t.has(`EXT_sRGB`)===!0&&i===zH?(e.format=mW,e.minFilter=xH,e.generateMipmaps=!1):n=jW.sRGBToLinear(n):(i!==zH||a!==EH)&&console.warn(`THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType.`):console.error(`THREE.WebGLTextures: Unsupported texture encoding:`,r)),n}this.allocateTextureUnit=N,this.resetTextureUnits=M,this.setTexture2D=te,this.setTexture2DArray=F,this.setTexture3D=ne,this.setTextureCube=I,this.rebindTextures=de,this.setupRenderTarget=fe,this.updateRenderTargetMipmap=pe,this.updateMultisampleRenderTarget=me,this.setupDepthRenderbuffer=ue,this.setupFrameBufferTexture=se,this.useMultisampledRTT=he}function gB(e,t,n){let r=n.isWebGL2;function i(n,i=null){let a;if(n===EH)return 5121;if(n===PH)return 32819;if(n===FH)return 32820;if(n===DH)return 5120;if(n===OH)return 5122;if(n===kH)return 5123;if(n===AH)return 5124;if(n===jH)return 5125;if(n===MH)return 5126;if(n===NH)return r?5131:(a=t.get(`OES_texture_half_float`),a===null?null:a.HALF_FLOAT_OES);if(n===LH)return 6406;if(n===zH)return 6408;if(n===BH)return 6409;if(n===VH)return 6410;if(n===HH)return 6402;if(n===UH)return 34041;if(n===WH)return 6403;if(n===RH)return console.warn(`THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228`),6408;if(n===mW)return a=t.get(`EXT_sRGB`),a===null?null:a.SRGB_ALPHA_EXT;if(n===GH)return 36244;if(n===KH)return 33319;if(n===qH)return 33320;if(n===JH)return 36249;if(n===YH||n===XH||n===ZH||n===QH)if(i===3001)if(a=t.get(`WEBGL_compressed_texture_s3tc_srgb`),a!==null){if(n===YH)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===XH)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===ZH)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===QH)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get(`WEBGL_compressed_texture_s3tc`),a!==null){if(n===YH)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===XH)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===ZH)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===QH)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===$H||n===eU||n===tU||n===nU)if(a=t.get(`WEBGL_compressed_texture_pvrtc`),a!==null){if(n===$H)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===eU)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===tU)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===nU)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===rU)return a=t.get(`WEBGL_compressed_texture_etc1`),a===null?null:a.COMPRESSED_RGB_ETC1_WEBGL;if(n===iU||n===aU)if(a=t.get(`WEBGL_compressed_texture_etc`),a!==null){if(n===iU)return i===3001?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===aU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===oU||n===sU||n===cU||n===lU||n===uU||n===dU||n===fU||n===pU||n===mU||n===hU||n===gU||n===_U||n===vU||n===yU)if(a=t.get(`WEBGL_compressed_texture_astc`),a!==null){if(n===oU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===sU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===cU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===lU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===uU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===dU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===fU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===pU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===mU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===hU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===gU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===_U)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===vU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===yU)return i===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===bU)if(a=t.get(`EXT_texture_compression_bptc`),a!==null){if(n===bU)return i===3001?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return n===IH?r?34042:(a=t.get(`WEBGL_depth_texture`),a===null?null:a.UNSIGNED_INT_24_8_WEBGL): __get$(e,n) ===void 0?null: __get$(e,n) }return{convert:i}}function See(e,t){function n(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}function r(e,t,n,r,h){t.isMeshBasicMaterial||t.isMeshLambertMaterial?i(e,t):t.isMeshToonMaterial?(i(e,t),u(e,t)):t.isMeshPhongMaterial?(i(e,t),l(e,t)):t.isMeshStandardMaterial?(i(e,t),d(e,t),t.isMeshPhysicalMaterial&&f(e,t,h)):t.isMeshMatcapMaterial?(i(e,t),p(e,t)):t.isMeshDepthMaterial?i(e,t):t.isMeshDistanceMaterial?(i(e,t),m(e,t)):t.isMeshNormalMaterial?i(e,t):t.isLineBasicMaterial?(a(e,t),t.isLineDashedMaterial&&o(e,t)):t.isPointsMaterial?s(e,t,n,r):t.isSpriteMaterial?c(e,t):t.isShadowMaterial?(e.color.value.copy(t.color),e.opacity.value=t.opacity):t.isShaderMaterial&&(t.uniformsNeedUpdate=!1)}function i(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,r.side===yV&&(n.bumpScale.value*=-1)),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),r.side===yV&&n.normalScale.value.negate()),r.specularMap&&(n.specularMap.value=r.specularMap),r.alphaTest>0&&(n.alphaTest.value=r.alphaTest);let i=t.get(r).envMap;if(i&&(n.envMap.value=i,n.flipEnvMap.value=i.isCubeTexture&&i.isRenderTargetTexture===!1?-1:1,n.reflectivity.value=r.reflectivity,n.ior.value=r.ior,n.refractionRatio.value=r.refractionRatio),r.lightMap){n.lightMap.value=r.lightMap;let t=e.physicallyCorrectLights===!0?1:Math.PI;n.lightMapIntensity.value=r.lightMapIntensity*t}r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity);let a;r.map?a=r.map:r.specularMap?a=r.specularMap:r.displacementMap?a=r.displacementMap:r.normalMap?a=r.normalMap:r.bumpMap?a=r.bumpMap:r.roughnessMap?a=r.roughnessMap:r.metalnessMap?a=r.metalnessMap:r.alphaMap?a=r.alphaMap:r.emissiveMap?a=r.emissiveMap:r.clearcoatMap?a=r.clearcoatMap:r.clearcoatNormalMap?a=r.clearcoatNormalMap:r.clearcoatRoughnessMap?a=r.clearcoatRoughnessMap:r.specularIntensityMap?a=r.specularIntensityMap:r.specularColorMap?a=r.specularColorMap:r.transmissionMap?a=r.transmissionMap:r.thicknessMap?a=r.thicknessMap:r.sheenColorMap?a=r.sheenColorMap:r.sheenRoughnessMap&&(a=r.sheenRoughnessMap),a!==void 0&&(a.isWebGLRenderTarget&&(a=a.texture),a.matrixAutoUpdate===!0&&a.updateMatrix(),n.uvTransform.value.copy(a.matrix));let o;r.aoMap?o=r.aoMap:r.lightMap&&(o=r.lightMap),o!==void 0&&(o.isWebGLRenderTarget&&(o=o.texture),o.matrixAutoUpdate===!0&&o.updateMatrix(),n.uv2Transform.value.copy(o.matrix))}function a(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}function o(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function s(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=r*.5,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),i!==void 0&&(i.matrixAutoUpdate===!0&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}function c(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),n!==void 0&&(n.matrixAutoUpdate===!0&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function l(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}function u(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}function d(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}function f(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap)),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===yV&&e.clearcoatNormalScale.value.negate())),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}function p(e,t){t.matcap&&(e.matcap.value=t.matcap)}function m(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function Cee(){let e=iR(`canvas`);return e.style.display=`block`,e}function _B(e={}){let t=e.canvas===void 0?Cee():e.canvas,n=e.context===void 0?null:e.context,r=e.depth===void 0?!0:e.depth,i=e.stencil===void 0?!0:e.stencil,a=e.antialias===void 0?!1:e.antialias,o=e.premultipliedAlpha===void 0?!0:e.premultipliedAlpha,s=e.preserveDrawingBuffer===void 0?!1:e.preserveDrawingBuffer,c=e.powerPreference===void 0?`default`:e.powerPreference,l=e.failIfMajorPerformanceCaveat===void 0?!1:e.failIfMajorPerformanceCaveat,u;u=n===null?e.alpha===void 0?!1:e.alpha:n.getContextAttributes().alpha;let d=null,f=null,p=[],m=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=NU,this.physicallyCorrectLights=!1,this.toneMapping=tH,this.toneMappingExposure=1;let h=this,g=!1,_=0,v=0,y=null,b=-1,x=null,S=new FW,C=new FW,w=null,T=t.width,E=t.height,D=1,O=null,k=null,ee=new FW(0,0,T,E),A=new FW(0,0,T,E),j=!1,M=new sq,N=!1,P=!1,te=null,F=new vG,ne=new Z,I=new Q,re={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ie(){return y===null?D:1}let L=n;function R(e,n){for(let r=0;r<e.length;r++){let i= __get$(e,r) ,a=t.getContext(i,n);if(a!==null)return a}return null}try{let e={alpha:!0,depth:r,stencil:i,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:s,powerPreference:c,failIfMajorPerformanceCaveat:l};if(`setAttribute`in t&&t.setAttribute(`data-engine`,`three.js r${cV}`),t.addEventListener(`webglcontextlost`,De,!1),t.addEventListener(`webglcontextrestored`,Oe,!1),L===null){let t=[`webgl2`,`webgl`,`experimental-webgl`];if(h.isWebGL1Renderer===!0&&t.shift(),L=R(t,e),L===null)throw R(t)?Error(`Error creating WebGL context with your selected attributes.`):Error(`Error creating WebGL context.`)}L.getShaderPrecisionFormat===void 0&&(L.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error(`THREE.WebGLRenderer: `+e.message),e}let ae,oe,se,ce,le,ue,de,fe,pe,me,z,he,ge,_e,ve,ye,be,xe,Se,B,Ce,we,V;function Te(){ae=new jR(L),oe=new bR(L,ae,e),ae.init(oe),we=new gB(L,ae,oe),se=new bee(L,ae,oe),ce=new PR,le=new sB,ue=new xee(L,ae,se,le,oe,we,ce),de=new SR(h),fe=new AR(h),pe=new gR(L,oe),V=new vR(L,ae,pe,oe),me=new MR(L,pe,ce,V),z=new zR(L,me,pe,ce),Se=new RR(L,oe,ue),ye=new xR(le),he=new oB(h,de,fe,ae,oe,V,ye),ge=new See(h,le),_e=new dB,ve=new yee(ae,oe),xe=new _R(h,de,se,z,u,o),be=new hB(h,z,oe),B=new yR(L,ae,ce,oe),Ce=new NR(L,ae,ce,oe),ce.programs=he.programs,h.capabilities=oe,h.extensions=ae,h.properties=le,h.renderLists=_e,h.shadowMap=be,h.state=se,h.info=ce}Te();let Ee=new Xq(h,L);this.xr=Ee,this.getContext=function(){return L},this.getContextAttributes=function(){return L.getContextAttributes()},this.forceContextLoss=function(){let e=ae.get(`WEBGL_lose_context`);e&&e.loseContext()},this.forceContextRestore=function(){let e=ae.get(`WEBGL_lose_context`);e&&e.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function(e){e!==void 0&&(D=e,this.setSize(T,E,!1))},this.getSize=function(e){return e.set(T,E)},this.setSize=function(e,n,r){if(Ee.isPresenting){console.warn(`THREE.WebGLRenderer: Can't change size while VR device is presenting.`);return}T=e,E=n,t.width=Math.floor(e*D),t.height=Math.floor(n*D),r!==!1&&(t.style.width=e+`px`,t.style.height=n+`px`),this.setViewport(0,0,e,n)},this.getDrawingBufferSize=function(e){return e.set(T*D,E*D).floor()},this.setDrawingBufferSize=function(e,n,r){T=e,E=n,D=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(S)},this.getViewport=function(e){return e.copy(ee)},this.setViewport=function(e,t,n,r){e.isVector4?ee.set(e.x,e.y,e.z,e.w):ee.set(e,t,n,r),se.viewport(S.copy(ee).multiplyScalar(D).floor())},this.getScissor=function(e){return e.copy(A)},this.setScissor=function(e,t,n,r){e.isVector4?A.set(e.x,e.y,e.z,e.w):A.set(e,t,n,r),se.scissor(C.copy(A).multiplyScalar(D).floor())},this.getScissorTest=function(){return j},this.setScissorTest=function(e){se.setScissorTest(j=e)},this.setOpaqueSort=function(e){O=e},this.setTransparentSort=function(e){k=e},this.getClearColor=function(e){return e.copy(xe.getClearColor())},this.setClearColor=function(){xe.setClearColor.apply(xe,arguments)},this.getClearAlpha=function(){return xe.getClearAlpha()},this.setClearAlpha=function(){xe.setClearAlpha.apply(xe,arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;e&&(r|=16384),t&&(r|=256),n&&(r|=1024),L.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener(`webglcontextlost`,De,!1),t.removeEventListener(`webglcontextrestored`,Oe,!1),_e.dispose(),ve.dispose(),le.dispose(),de.dispose(),fe.dispose(),z.dispose(),V.dispose(),he.dispose(),Ee.dispose(),Ee.removeEventListener(`sessionstart`,Pe),Ee.removeEventListener(`sessionend`,Fe),te&&=(te.dispose(),null),Ie.stop()};function De(e){e.preventDefault(),console.log(`THREE.WebGLRenderer: Context Lost.`),g=!0}function Oe(){console.log(`THREE.WebGLRenderer: Context Restored.`),g=!1;let e=ce.autoReset,t=be.enabled,n=be.autoUpdate,r=be.needsUpdate,i=be.type;Te(),ce.autoReset=e,be.enabled=t,be.autoUpdate=n,be.needsUpdate=r,be.type=i}function ke(e){let t=e.target;t.removeEventListener(`dispose`,ke),Ae(t)}function Ae(e){je(e),le.remove(e)}function je(e){let t=le.get(e).programs;t!==void 0&&(t.forEach(function(e){he.releaseProgram(e)}),e.isShaderMaterial&&he.releaseShaderCache(e))}this.renderBufferDirect=function(e,t,n,r,i,a){t===null&&(t=re);let o=i.isMesh&&i.matrixWorld.determinant()<0,s=W(e,t,n,r,i);se.setMaterial(r,o);let c=n.index,l=n.attributes.position;if(c===null){if(l===void 0||l.count===0)return}else if(c.count===0)return;let u=1;r.wireframe===!0&&(c=me.getWireframeAttribute(n),u=2),V.setup(i,r,s,n,c);let d,f=B;c!==null&&(d=pe.get(c),f=Ce,f.setIndex(d));let p=c===null?l.count:c.count,m=n.drawRange.start*u,h=n.drawRange.count*u,g=a===null?0:a.start*u,_=a===null?1/0:a.count*u,v=Math.max(m,g),y=Math.min(p,m+h,g+_)-1,b=Math.max(0,y-v+1);if(b!==0){if(i.isMesh)r.wireframe===!0?(se.setLineWidth(r.wireframeLinewidth*ie()),f.setMode(1)):f.setMode(4);else if(i.isLine){let e=r.linewidth;e===void 0&&(e=1),se.setLineWidth(e*ie()),i.isLineSegments?f.setMode(1):i.isLineLoop?f.setMode(2):f.setMode(3)}else i.isPoints?f.setMode(0):i.isSprite&&f.setMode(4);if(i.isInstancedMesh)f.renderInstances(v,b,i.count);else if(n.isInstancedBufferGeometry){let e=Math.min(n.instanceCount,n._maxInstanceCount);f.renderInstances(v,b,e)}else f.render(v,b)}},this.compile=function(e,t){f=ve.get(e),f.init(),m.push(f),e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))}),f.setupLights(h.physicallyCorrectLights),e.traverse(function(t){let n=t.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++){let i= __get$(n,r) ;Ve(i,e,t)}else Ve(n,e,t)}),m.pop(),f=null};let Me=null;function Ne(e){Me&&Me(e)}function Pe(){Ie.stop()}function Fe(){Ie.start()}let Ie=new hR;Ie.setAnimationLoop(Ne),typeof self<`u`&&Ie.setContext(self),this.setAnimationLoop=function(e){Me=e,Ee.setAnimationLoop(e),e===null?Ie.stop():Ie.start()},Ee.addEventListener(`sessionstart`,Pe),Ee.addEventListener(`sessionend`,Fe),this.render=function(e,t){if(t!==void 0&&t.isCamera!==!0){console.error(`THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.`);return}if(g===!0)return;e.autoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.updateMatrixWorld(),Ee.enabled===!0&&Ee.isPresenting===!0&&(Ee.cameraAutoUpdate===!0&&Ee.updateCamera(t),t=Ee.getCamera()),e.isScene===!0&&e.onBeforeRender(h,e,t,y),f=ve.get(e,m.length),f.init(),m.push(f),F.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),M.setFromProjectionMatrix(F),P=this.localClippingEnabled,N=ye.init(this.clippingPlanes,P,t),d=_e.get(e,p.length),d.init(),p.push(d),Le(e,t,0,h.sortObjects),d.finish(),h.sortObjects===!0&&d.sort(O,k),N===!0&&ye.beginShadows();let n=f.state.shadowsArray;if(be.render(n,e,t),N===!0&&ye.endShadows(),this.info.autoReset===!0&&this.info.reset(),xe.render(d,e),f.setupLights(h.physicallyCorrectLights),t.isArrayCamera){let n=t.cameras;for(let t=0,r=n.length;t<r;t++){let r= __get$(n,t) ;Re(d,e,r,r.viewport)}}else Re(d,e,t);y!==null&&(ue.updateMultisampleRenderTarget(y),ue.updateRenderTargetMipmap(y)),e.isScene===!0&&e.onAfterRender(h,e,t),V.resetDefaultState(),b=-1,x=null,m.pop(),f=m.length>0? __get$(m,m.length-1) :null,p.pop(),d=p.length>0? __get$(p,p.length-1) :null};function Le(e,t,n,r){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)n=e.renderOrder;else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||M.intersectsSprite(e)){r&&I.setFromMatrixPosition(e.matrixWorld).applyMatrix4(F);let t=z.update(e),i=e.material;i.visible&&d.push(e,t,i,n,I.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==ce.render.frame&&(e.skeleton.update(),e.skeleton.frame=ce.render.frame),!e.frustumCulled||M.intersectsObject(e))){r&&I.setFromMatrixPosition(e.matrixWorld).applyMatrix4(F);let t=z.update(e),i=e.material;if(Array.isArray(i)){let r=t.groups;for(let a=0,o=r.length;a<o;a++){let o= __get$(r,a) ,s= __get$(i,o.materialIndex) ;s&&s.visible&&d.push(e,t,s,n,I.z,o)}}else i.visible&&d.push(e,t,i,n,I.z,null)}}let i=e.children;for(let e=0,a=i.length;e<a;e++)Le( __get$(i,e) ,t,n,r)}function Re(e,t,n,r){let i=e.opaque,a=e.transmissive,o=e.transparent;f.setupLightsView(n),a.length>0&&ze(i,t,n),r&&se.viewport(S.copy(r)),i.length>0&&H(i,t,n),a.length>0&&H(a,t,n),o.length>0&&H(o,t,n),se.buffers.depth.setTest(!0),se.buffers.depth.setMask(!0),se.buffers.color.setMask(!0),se.setPolygonOffset(!1)}function ze(e,t,n){let r=oe.isWebGL2;te===null&&(te=new IW(1,1,{generateMipmaps:!0,type:ae.has(`EXT_color_buffer_half_float`)?NH:EH,minFilter:wH,samples:r&&a===!0?4:0})),h.getDrawingBufferSize(ne),r?te.setSize(ne.x,ne.y):te.setSize(QL(ne.x),QL(ne.y));let i=h.getRenderTarget();h.setRenderTarget(te),h.clear();let o=h.toneMapping;h.toneMapping=tH,H(e,t,n),h.toneMapping=o,ue.updateMultisampleRenderTarget(te),ue.updateRenderTargetMipmap(te),h.setRenderTarget(i)}function H(e,t,n){let r=t.isScene===!0?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){let a= __get$(e,i) ,o=a.object,s=a.geometry,c=r===null?a.material:r,l=a.group;o.layers.test(n.layers)&&Be(o,t,n,s,c,l)}}function Be(e,t,n,r,i,a){e.onBeforeRender(h,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(h,t,n,r,e,a),i.transparent===!0&&i.side===2?(i.side=yV,i.needsUpdate=!0,h.renderBufferDirect(n,t,r,i,e,a),i.side=0,i.needsUpdate=!0,h.renderBufferDirect(n,t,r,i,e,a),i.side=2):h.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(h,t,n,r,i,a)}function Ve(e,t,n){t.isScene!==!0&&(t=re);let r=le.get(e),i=f.state.lights,a=f.state.shadowsArray,o=i.state.version,s=he.getParameters(e,i.state,a,t,n),c=he.getProgramCacheKey(s),l=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?fe:de).get(e.envMap||r.environment),l===void 0&&(e.addEventListener(`dispose`,ke),l=new Map,r.programs=l);let u=l.get(c);if(u!==void 0){if(r.currentProgram===u&&r.lightsStateVersion===o)return U(e,s),u}else s.uniforms=he.getUniforms(e),e.onBuild(n,s,h),e.onBeforeCompile(s,h),u=he.acquireProgram(s,c),l.set(c,u),r.uniforms=s.uniforms;let d=r.uniforms;(!e.isShaderMaterial&&!e.isRawShaderMaterial||e.clipping===!0)&&(d.clippingPlanes=ye.uniform),U(e,s),r.needsLights=He(e),r.lightsStateVersion=o,r.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.ltc_1.value=i.state.rectAreaLTC1,d.ltc_2.value=i.state.rectAreaLTC2,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotShadowMatrix.value=i.state.spotShadowMatrix,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix);let p=u.getUniforms(),m=Fz.seqWithValue(p.seq,d);return r.currentProgram=u,r.uniformsList=m,u}function U(e,t){let n=le.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}function W(e,t,n,r,i){t.isScene!==!0&&(t=re),ue.resetTextureUnits();let a=t.fog,o=r.isMeshStandardMaterial?t.environment:null,s=y===null?h.outputEncoding:y.isXRRenderTarget===!0?y.texture.encoding:NU,c=(r.isMeshStandardMaterial?fe:de).get(r.envMap||o),l=r.vertexColors===!0&&!!n.attributes.color&&n.attributes.color.itemSize===4,u=!!r.normalMap&&!!n.attributes.tangent,d=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,m=!!n.morphAttributes.color,g=r.toneMapped?h.toneMapping:tH,_=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=_===void 0?0:_.length,S=le.get(r),C=f.state.lights;if(N===!0&&(P===!0||e!==x)){let t=e===x&&r.id===b;ye.setState(r,e,t)}let w=!1;r.version===S.__version?S.needsLights&&S.lightsStateVersion!==C.state.version?w=!0:S.outputEncoding===s?i.isInstancedMesh&&S.instancing===!1||!i.isInstancedMesh&&S.instancing===!0||i.isSkinnedMesh&&S.skinning===!1||!i.isSkinnedMesh&&S.skinning===!0?w=!0:S.envMap===c?r.fog===!0&&S.fog!==a||S.numClippingPlanes!==void 0&&(S.numClippingPlanes!==ye.numPlanes||S.numIntersection!==ye.numIntersection)?w=!0:S.vertexAlphas===l&&S.vertexTangents===u&&S.morphTargets===d&&S.morphNormals===p&&S.morphColors===m&&S.toneMapping===g?oe.isWebGL2===!0&&S.morphTargetsCount!==v&&(w=!0):w=!0:w=!0:w=!0:(w=!0,S.__version=r.version);let T=S.currentProgram;w===!0&&(T=Ve(r,t,i));let O=!1,k=!1,ee=!1,A=T.getUniforms(),j=S.uniforms;if(se.useProgram(T.program)&&(O=!0,k=!0,ee=!0),r.id!==b&&(b=r.id,k=!0),O||x!==e){if(A.setValue(L,`projectionMatrix`,e.projectionMatrix),oe.logarithmicDepthBuffer&&A.setValue(L,`logDepthBufFC`,2/(Math.log(e.far+1)/Math.LN2)),x!==e&&(x=e,k=!0,ee=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){let t=A.map.cameraPosition;t!==void 0&&t.setValue(L,I.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&A.setValue(L,`isOrthographic`,e.isOrthographicCamera===!0),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&A.setValue(L,`viewMatrix`,e.matrixWorldInverse)}if(i.isSkinnedMesh){A.setOptional(L,i,`bindMatrix`),A.setOptional(L,i,`bindMatrixInverse`);let e=i.skeleton;e&&(oe.floatVertexTextures?(e.boneTexture===null&&e.computeBoneTexture(),A.setValue(L,`boneTexture`,e.boneTexture,ue),A.setValue(L,`boneTextureSize`,e.boneTextureSize)):console.warn(`THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required.`))}let M=n.morphAttributes;return(M.position!==void 0||M.normal!==void 0||M.color!==void 0&&oe.isWebGL2===!0)&&Se.update(i,n,r,T),(k||S.receiveShadow!==i.receiveShadow)&&(S.receiveShadow=i.receiveShadow,A.setValue(L,`receiveShadow`,i.receiveShadow)),k&&(A.setValue(L,`toneMappingExposure`,h.toneMappingExposure),S.needsLights&&G(j,ee),a&&r.fog===!0&&ge.refreshFogUniforms(j,a),ge.refreshMaterialUniforms(j,r,D,E,te),Fz.upload(L,S.uniformsList,j,ue)),r.isShaderMaterial&&r.uniformsNeedUpdate===!0&&(Fz.upload(L,S.uniformsList,j,ue),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&A.setValue(L,`center`,i.center),A.setValue(L,`modelViewMatrix`,i.modelViewMatrix),A.setValue(L,`normalMatrix`,i.normalMatrix),A.setValue(L,`modelMatrix`,i.matrixWorld),T}function G(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function He(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&e.lights===!0}this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(e,t,n){le.get(e.texture).__webglTexture=t,le.get(e.depthTexture).__webglTexture=n;let r=le.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=n===void 0,r.__autoAllocateDepthBuffer||ae.has(`WEBGL_multisampled_render_to_texture`)===!0&&(console.warn(`THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided`),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){let n=le.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=t===void 0},this.setRenderTarget=function(e,t=0,n=0){y=e,_=t,v=n;let r=!0;if(e){let t=le.get(e);t.__useDefaultFramebuffer===void 0?t.__webglFramebuffer===void 0?ue.setupRenderTarget(e):t.__hasExternalTextures&&ue.rebindTextures(e,le.get(e.texture).__webglTexture,le.get(e.depthTexture).__webglTexture):(se.bindFramebuffer(36160,null),r=!1)}let i=null,a=!1,o=!1;if(e){let n=e.texture;(n.isData3DTexture||n.isDataArrayTexture)&&(o=!0);let r=le.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i= __get$(r,t) ,a=!0):i=oe.isWebGL2&&e.samples>0&&ue.useMultisampledRTT(e)===!1?le.get(e).__webglMultisampledFramebuffer:r,S.copy(e.viewport),C.copy(e.scissor),w=e.scissorTest}else S.copy(ee).multiplyScalar(D).floor(),C.copy(A).multiplyScalar(D).floor(),w=j;if(se.bindFramebuffer(36160,i)&&oe.drawBuffers&&r&&se.drawBuffers(e,i),se.viewport(S),se.scissor(C),se.setScissorTest(w),a){let r=le.get(e.texture);L.framebufferTexture2D(36160,36064,34069+t,r.__webglTexture,n)}else if(o){let r=le.get(e.texture),i=t||0;L.framebufferTextureLayer(36160,36064,r.__webglTexture,n||0,i)}b=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(!(e&&e.isWebGLRenderTarget)){console.error(`THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.`);return}let s=le.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&o!==void 0&&(s= __get$(s,o) ),s){se.bindFramebuffer(36160,s);try{let o=e.texture,s=o.format,c=o.type;if(s!==zH&&we.convert(s)!==L.getParameter(35739)){console.error(`THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.`);return}let l=c===NH&&(ae.has(`EXT_color_buffer_half_float`)||oe.isWebGL2&&ae.has(`EXT_color_buffer_float`));if(c!==EH&&we.convert(c)!==L.getParameter(35738)&&!(c===MH&&(oe.isWebGL2||ae.has(`OES_texture_float`)||ae.has(`WEBGL_color_buffer_float`)))&&!l){console.error(`THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.`);return}t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&L.readPixels(t,n,r,i,we.convert(s),we.convert(c),a)}finally{let e=y===null?null:le.get(y).__webglFramebuffer;se.bindFramebuffer(36160,e)}}},this.copyFramebufferToTexture=function(e,t,n=0){if(t.isFramebufferTexture!==!0){console.error(`THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.`);return}let r=2**-n,i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r);ue.setTexture2D(t,0),L.copyTexSubImage2D(3553,n,0,0,e.x,e.y,i,a),se.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r=0){let i=t.image.width,a=t.image.height,o=we.convert(n.format),s=we.convert(n.type);ue.setTexture2D(n,0),L.pixelStorei(37440,n.flipY),L.pixelStorei(37441,n.premultiplyAlpha),L.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?L.texSubImage2D(3553,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?L.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):L.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),r===0&&n.generateMipmaps&&L.generateMipmap(3553),se.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r,i=0){if(h.isWebGL1Renderer){console.warn(`THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.`);return}let a=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,s=e.max.z-e.min.z+1,c=we.convert(r.format),l=we.convert(r.type),u;if(r.isData3DTexture)ue.setTexture3D(r,0),u=32879;else if(r.isDataArrayTexture)ue.setTexture2DArray(r,0),u=35866;else{console.warn(`THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.`);return}L.pixelStorei(37440,r.flipY),L.pixelStorei(37441,r.premultiplyAlpha),L.pixelStorei(3317,r.unpackAlignment);let d=L.getParameter(3314),f=L.getParameter(32878),p=L.getParameter(3316),m=L.getParameter(3315),g=L.getParameter(32877),_=n.isCompressedTexture?n.mipmaps[0]:n.image;L.pixelStorei(3314,_.width),L.pixelStorei(32878,_.height),L.pixelStorei(3316,e.min.x),L.pixelStorei(3315,e.min.y),L.pixelStorei(32877,e.min.z),n.isDataTexture||n.isData3DTexture?L.texSubImage3D(u,i,t.x,t.y,t.z,a,o,s,c,l,_.data):n.isCompressedTexture?(console.warn(`THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture.`),L.compressedTexSubImage3D(u,i,t.x,t.y,t.z,a,o,s,c,_.data)):L.texSubImage3D(u,i,t.x,t.y,t.z,a,o,s,c,l,_),L.pixelStorei(3314,d),L.pixelStorei(32878,f),L.pixelStorei(3316,p),L.pixelStorei(3315,m),L.pixelStorei(32877,g),i===0&&r.generateMipmaps&&L.generateMipmap(u),se.unbindTexture()},this.initTexture=function(e){ue.setTexture2D(e,0),se.unbindTexture()},this.resetState=function(){_=0,v=0,y=null,se.reset(),V.reset()},typeof __THREE_DEVTOOLS__<`u`&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent(`observe`,{detail:this}))}function vB(e,t,n,r,i,a){lJ.subVectors(e,n).addScalar(.5).multiply(r),i===void 0?uJ.copy(lJ):(uJ.x=a*lJ.x-i*lJ.y,uJ.y=i*lJ.x+a*lJ.y),e.copy(t),e.x+=uJ.x,e.y+=uJ.y,e.applyMatrix4(dJ)}function yB(e,t,n,r,i,a,o){let s=QJ.distanceSqToPoint(e);if(s<n){let n=new Q;QJ.closestPointToPoint(e,n),n.applyMatrix4(r);let c=i.ray.origin.distanceTo(n);if(c<i.near||c>i.far)return;a.push({distance:c,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,object:o})}}function bB(){let e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){let c=(t-e)/a-(n-e)/(a+o)+(n-t)/o,l=(n-t)/o-(r-t)/(o+s)+(r-n)/s;c*=o,l*=o,i(t,n,c,l)},calc:function(i){let a=i*i,o=a*i;return e+t*i+n*a+r*o}}}function xB(e,t,n,r,i){let a=(r-t)*.5,o=(i-n)*.5,s=e*e,c=e*s;return(2*n-2*r+a+o)*c+(-3*n+3*r-2*a-o)*s+a*e+n}function wee(e,t){let n=1-e;return n*n*t}function Tee(e,t){return 2*(1-e)*e*t}function Eee(e,t){return e*e*t}function SB(e,t,n,r){return wee(e,t)+Tee(e,n)+Eee(e,r)}function Dee(e,t){let n=1-e;return n*n*n*t}function Oee(e,t){let n=1-e;return 3*n*n*e*t}function kee(e,t){return 3*(1-e)*e*e*t}function Aee(e,t){return e*e*e*t}function CB(e,t,n,r,i){return Dee(e,t)+Oee(e,n)+kee(e,r)+Aee(e,i)}function wB(e,t,n,r,i){let a,o;if(i===VB(e,t,n,r)>0)for(a=t;a<n;a+=r)o=RB(a, __get$(e,a) , __get$(e,a+1) ,o);else for(a=n-r;a>=t;a-=r)o=RB(a, __get$(e,a) , __get$(e,a+1) ,o);return o&&AB(o,o.next)&&(zB(o),o=o.next),o}function TB(e,t){if(!e)return e;t||=e;let n=e,r;do if(r=!1,!n.steiner&&(AB(n,n.next)||kB(n.prev,n,n.next)===0)){if(zB(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function EB(e,t,n,r,i,a,o){if(!e)return;!o&&a&&Bee(e,r,i,a);let s=e,c,l;for(;e.prev!==e.next;){if(c=e.prev,l=e.next,a?Mee(e,r,i,a):jee(e)){t.push(c.i/n),t.push(e.i/n),t.push(l.i/n),zB(e),e=l.next,s=l.next;continue}if(e=l,e===s){o?o===1?(e=Nee(TB(e),t,n),EB(e,t,n,r,i,a,2)):o===2&&Pee(e,t,n,r,i,a):EB(TB(e),t,n,r,i,a,1);break}}}function jee(e){let t=e.prev,n=e,r=e.next;if(kB(t,n,r)>=0)return!1;let i=e.next.next;for(;i!==e.prev;){if(OB(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&kB(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Mee(e,t,n,r){let i=e.prev,a=e,o=e.next;if(kB(i,a,o)>=0)return!1;let s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,c=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,u=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,d=DB(s,c,t,n,r),f=DB(l,u,t,n,r),p=e.prevZ,m=e.nextZ;for(;p&&p.z>=d&&m&&m.z<=f;){if(p!==e.prev&&p!==e.next&&OB(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&kB(p.prev,p,p.next)>=0||(p=p.prevZ,m!==e.prev&&m!==e.next&&OB(i.x,i.y,a.x,a.y,o.x,o.y,m.x,m.y)&&kB(m.prev,m,m.next)>=0))return!1;m=m.nextZ}for(;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&OB(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&kB(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;m&&m.z<=f;){if(m!==e.prev&&m!==e.next&&OB(i.x,i.y,a.x,a.y,o.x,o.y,m.x,m.y)&&kB(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function Nee(e,t,n){let r=e;do{let i=r.prev,a=r.next.next;!AB(i,a)&&jB(i,r,r.next,a)&&FB(i,a)&&FB(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),zB(r),zB(r.next),r=e=a),r=r.next}while(r!==e);return TB(r)}function Pee(e,t,n,r,i,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&Uee(o,e)){let s=LB(o,e);o=TB(o,o.next),s=TB(s,s.next),EB(o,t,n,r,i,a),EB(s,t,n,r,i,a);return}e=e.next}o=o.next}while(o!==e)}function Fee(e,t,n,r){let i=[],a,o,s,c,l;for(a=0,o=t.length;a<o;a++)s= __get$(t,a) *r,c=a<o-1? __get$(t,a+1) *r:e.length,l=wB(e,s,c,r,!1),l===l.next&&(l.steiner=!0),i.push(Hee(l));for(i.sort(Iee),a=0;a<i.length;a++)Lee( __get$(i,a) ,n),n=TB(n,n.next);return n}function Iee(e,t){return e.x-t.x}function Lee(e,t){if(t=Ree(e,t),t){let n=LB(t,e);TB(t,t.next),TB(n,n.next)}}function Ree(e,t){let n=t,r=e.x,i=e.y,a=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){let e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>a){if(a=e,e===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!o)return null;if(r===a)return o;let s=o,c=o.x,l=o.y,u=1/0,d;n=o;do r>=n.x&&n.x>=c&&r!==n.x&&OB(i<l?r:a,i,c,l,i<l?a:r,i,n.x,n.y)&&(d=Math.abs(i-n.y)/(r-n.x),FB(n,e)&&(d<u||d===u&&(n.x>o.x||n.x===o.x&&zee(o,n)))&&(o=n,u=d)),n=n.next;while(n!==s);return o}function zee(e,t){return kB(e.prev,e,t.prev)<0&&kB(t.next,e,e.next)<0}function Bee(e,t,n,r){let i=e;do i.z===null&&(i.z=DB(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,Vee(i)}function Vee(e){let t,n,r,i,a,o,s,c,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ,r);t++);for(c=l;s>0||c>0&&r;)s!==0&&(c===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1);return e}function DB(e,t,n,r,i){return e=32767*(e-n)*i,t=32767*(t-r)*i,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Hee(e){let t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function OB(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Uee(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!PB(e,t)&&(FB(e,t)&&FB(t,e)&&IB(e,t)&&(kB(e.prev,e,t.prev)||kB(e,t.prev,t))||AB(e,t)&&kB(e.prev,e,e.next)>0&&kB(t.prev,t,t.next)>0)}function kB(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function AB(e,t){return e.x===t.x&&e.y===t.y}function jB(e,t,n,r){let i=NB(kB(e,t,n)),a=NB(kB(e,t,r)),o=NB(kB(n,r,e)),s=NB(kB(n,r,t));return!!(i!==a&&o!==s||i===0&&MB(e,n,t)||a===0&&MB(e,r,t)||o===0&&MB(n,e,r)||s===0&&MB(n,t,r))}function MB(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function NB(e){return e>0?1:e<0?-1:0}function PB(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&jB(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function FB(e,t){return kB(e.prev,e,e.next)<0?kB(e,t,e.next)>=0&&kB(e,e.prev,t)>=0:kB(e,t,e.prev)<0||kB(e,e.next,t)<0}function IB(e,t){let n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function LB(e,t){let n=new BB(e.i,e.x,e.y),r=new BB(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function RB(e,t,n,r){let i=new BB(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function zB(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function BB(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function VB(e,t,n,r){let i=0;for(let a=t,o=n-r;a<n;a+=r)i+=( __get$(e,o) - __get$(e,a) )*( __get$(e,a+1) + __get$(e,o+1) ),o=a;return i}function HB(e){let t=e.length;t>2&& __get$(e,t-1) .equals(e[0])&&e.pop()}function UB(e,t){for(let n=0;n<t.length;n++)e.push( __get$(t,n) .x),e.push( __get$(t,n) .y)}function WB(e,t,n){if(n.shapes=[],Array.isArray(e))for(let t=0,r=e.length;t<r;t++){let r= __get$(e,t) ;n.shapes.push(r.uuid)}else n.shapes.push(e.uuid);return t.extrudePath!==void 0&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function GB(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){let r= __get$(e,n) ;t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function KB(e,t,n){let r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return n.has(r)===!0||n.has(i)===!0?!1:(n.add(r),n.add(i),!0)}function qB(e){switch(e.toLowerCase()){case`scalar`:case`double`:case`float`:case`number`:case`integer`:return _X;case`vector`:case`vector2`:case`vector3`:case`vector4`:return xX;case`color`:return gX;case`quaternion`:return yX;case`bool`:case`boolean`:return hX;case`string`:return bX}throw Error(`THREE.KeyframeTrack: Unsupported typeName: `+e)}function JB(e){if(e.type===void 0)throw Error(`THREE.KeyframeTrack: track type undefined, can not parse`);let t=qB(e.type);if(e.times===void 0){let t=[],n=[];lX.flattenJSON(e.keys,t,n,`value`),e.times=t,e.values=n}return t.parse===void 0?new t(e.name,e.times,e.values,e.interpolation):t.parse(e)}function YB(){return(typeof performance>`u`?Date:performance).now()}function XB(e,t){return e.distance-t.distance}function ZB(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),r===!0){let r=e.children;for(let e=0,i=r.length;e<i;e++)ZB( __get$(r,e) ,t,n,!0)}}function QB(e){let t=[];e.isBone===!0&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,QB( __get$(e.children,n) ));return t}function $B(e,t,n,r,i,a,o){xQ.set(i,a,o).unproject(r);let s= __get$(t,e) ;if(s!==void 0){let e=n.getAttribute(`position`);for(let t=0,n=s.length;t<n;t++)e.setXYZ( __get$(s,t) ,xQ.x,xQ.y,xQ.z)}}function eV(e){return console.warn(`THREE.MeshFaceMaterial has been removed. Use an Array instead.`),e}function tV(e=[]){return console.warn(`THREE.MultiMaterial has been removed. Use an Array instead.`),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function nV(){console.error(`THREE.CanvasRenderer has been removed`)}function rV(){console.error(`THREE.JSONLoader has been removed.`)}function iV(){console.error(`THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js`)}function aV(){console.error(`THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js`)}function oV(){console.error(`THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js`)}function sV(){console.error(`THREE.ImmediateRenderObject has been removed.`)}var cV,lV,uV,dV,fV,pV,mV,hV,gV,_V,vV,yV,bV,xV,SV,CV,wV,TV,EV,DV,OV,kV,AV,jV,MV,NV,PV,FV,IV,LV,RV,zV,BV,VV,HV,UV,WV,GV,KV,qV,JV,YV,XV,ZV,QV,$V,eH,tH,nH,rH,iH,aH,oH,sH,cH,lH,uH,dH,fH,pH,mH,hH,gH,_H,vH,yH,bH,xH,SH,CH,wH,TH,EH,DH,OH,kH,AH,jH,MH,NH,PH,FH,IH,LH,RH,zH,BH,VH,HH,UH,WH,GH,KH,qH,JH,YH,XH,ZH,QH,$H,eU,tU,nU,rU,iU,aU,oU,sU,cU,lU,uU,dU,fU,pU,mU,hU,gU,_U,vU,yU,bU,xU,SU,CU,wU,TU,EU,DU,OU,kU,AU,jU,MU,NU,PU,FU,IU,LU,RU,zU,BU,VU,HU,UU,WU,GU,KU,qU,JU,YU,XU,ZU,QU,$U,eW,tW,nW,rW,iW,aW,oW,sW,cW,lW,uW,dW,fW,pW,mW,hW,gW,_W,vW,yW,bW,Z,xW,SW,CW,wW,TW,EW,DW,OW,kW,AW,jW,MW,NW,PW,FW,IW,LW,RW,zW,BW,VW,HW,Q,UW,WW,GW,KW,qW,JW,YW,XW,ZW,QW,$W,eG,tG,nG,rG,iG,aG,oG,sG,cG,lG,uG,dG,fG,pG,mG,hG,gG,_G,vG,yG,bG,xG,SG,CG,wG,TG,EG,DG,OG,kG,AG,jG,MG,NG,PG,FG,IG,LG,RG,zG,BG,VG,HG,UG,WG,GG,KG,qG,JG,YG,XG,ZG,QG,$G,eK,tK,nK,rK,iK,aK,oK,sK,cK,lK,uK,dK,fK,pK,mK,hK,gK,_K,vK,yK,bK,xK,SK,CK,wK,TK,EK,DK,OK,kK,AK,jK,MK,NK,PK,FK,IK,LK,RK,zK,BK,VK,HK,UK,WK,GK,KK,qK,JK,YK,XK,ZK,QK,$K,eq,tq,nq,rq,iq,aq,oq,sq,cq,lq,uq,dq,fq,pq,mq,hq,gq,_q,vq,yq,bq,xq,Sq,Cq,wq,Tq,Eq,Dq,Oq,kq,Aq,jq,Mq,Nq,Pq,Fq,Iq,Lq,Rq,zq,Bq,Vq,Hq,Uq,Wq,Gq,Kq,qq,Jq,Yq,Xq,Zq,Qq,$q,eJ,tJ,nJ,rJ,iJ,aJ,oJ,sJ,cJ,lJ,uJ,dJ,fJ,pJ,mJ,hJ,gJ,_J,vJ,yJ,bJ,xJ,SJ,CJ,wJ,TJ,EJ,DJ,OJ,kJ,AJ,jJ,MJ,NJ,PJ,FJ,IJ,LJ,RJ,zJ,BJ,VJ,HJ,UJ,WJ,GJ,KJ,qJ,JJ,YJ,XJ,ZJ,QJ,$J,eY,tY,nY,rY,iY,aY,oY,sY,cY,lY,uY,dY,fY,pY,mY,hY,gY,_Y,vY,yY,bY,xY,SY,CY,wY,TY,EY,DY,OY,kY,AY,jY,MY,NY,PY,FY,IY,LY,RY,zY,BY,VY,HY,UY,WY,GY,KY,qY,JY,YY,XY,ZY,QY,$Y,eX,tX,nX,rX,iX,aX,oX,sX,cX,lX,uX,dX,fX,pX,mX,hX,gX,_X,vX,yX,bX,xX,SX,CX,wX,TX,EX,DX,OX,kX,AX,jX,MX,NX,PX,FX,IX,LX,RX,zX,BX,VX,HX,UX,WX,GX,KX,qX,JX,YX,XX,ZX,QX,$X,eZ,tZ,nZ,rZ,iZ,aZ,oZ,sZ,cZ,lZ,uZ,dZ,fZ,pZ,mZ,hZ,gZ,_Z,vZ,yZ,bZ,xZ,SZ,CZ,wZ,TZ,EZ,DZ,OZ,kZ,AZ,jZ,MZ,NZ,PZ,FZ,IZ,LZ,RZ,zZ,BZ,VZ,HZ,UZ,WZ,GZ,KZ,qZ,JZ,YZ,XZ,ZZ,QZ,$Z,eQ,tQ,nQ,rQ,iQ,aQ,oQ,sQ,cQ,lQ,uQ,dQ,fQ,pQ,mQ,hQ,gQ,_Q,vQ,yQ,bQ,xQ,SQ,CQ,wQ,TQ,EQ,DQ,OQ,kQ,AQ,jQ,MQ,NQ,PQ,FQ,IQ,LQ,RQ,zQ,BQ,VQ,HQ,UQ,WQ,GQ,KQ,qQ,JQ,YQ,XQ,ZQ,QQ,$Q,e$,t$,n$,r$,i$,a$,o$,s$,c$,l$,u$,d$,f$,p$,m$,h$,g$,_$,v$,y$,b$,x$,S$,C$,w$,T$=e((()=>{cV=`140`,lV={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},uV={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},dV=0,fV=1,pV=2,mV=3,hV=0,gV=1,_V=2,vV=3,yV=1,bV=1,xV=2,SV=0,CV=1,wV=2,TV=3,EV=4,DV=5,OV=100,kV=101,AV=102,jV=103,MV=104,NV=200,PV=201,FV=202,IV=203,LV=204,RV=205,zV=206,BV=207,VV=208,HV=209,UV=210,WV=0,GV=1,KV=2,qV=3,JV=4,YV=5,XV=6,ZV=7,QV=0,$V=1,eH=2,tH=0,nH=1,rH=2,iH=3,aH=4,oH=5,sH=300,cH=301,lH=302,uH=303,dH=304,fH=306,pH=1e3,mH=1001,hH=1002,gH=1003,_H=1004,vH=1004,yH=1005,bH=1005,xH=1006,SH=1007,CH=1007,wH=1008,TH=1008,EH=1009,DH=1010,OH=1011,kH=1012,AH=1013,jH=1014,MH=1015,NH=1016,PH=1017,FH=1018,IH=1020,LH=1021,RH=1022,zH=1023,BH=1024,VH=1025,HH=1026,UH=1027,WH=1028,GH=1029,KH=1030,qH=1031,JH=1033,YH=33776,XH=33777,ZH=33778,QH=33779,$H=35840,eU=35841,tU=35842,nU=35843,rU=36196,iU=37492,aU=37496,oU=37808,sU=37809,cU=37810,lU=37811,uU=37812,dU=37813,fU=37814,pU=37815,mU=37816,hU=37817,gU=37818,_U=37819,vU=37820,yU=37821,bU=36492,xU=2200,SU=2201,CU=2202,wU=2300,TU=2301,EU=2302,DU=2400,OU=2401,kU=2402,AU=2500,jU=2501,MU=0,NU=3e3,PU=3001,FU=3200,IU=3201,LU=1,RU=``,zU=`srgb`,BU=`srgb-linear`,VU=0,HU=7680,UU=7681,WU=7682,GU=7683,KU=34055,qU=34056,JU=5386,YU=512,XU=513,ZU=514,QU=515,$U=516,eW=517,tW=518,nW=519,rW=35044,iW=35048,aW=35040,oW=35045,sW=35049,cW=35041,lW=35046,uW=35050,dW=35042,fW=`100`,pW=`300 es`,mW=1035,hW=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners; __get$(n,e) ===void 0&&( __set$(n,e,[]) ), __get$(n,e) .indexOf(t)===-1&& __get$(n,e) .push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let n=this._listeners;return  __get$(n,e) !==void 0&& __get$(n,e) .indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let n= __get$(this._listeners,e) ;if(n!==void 0){let e=n.indexOf(t);e!==-1&&n.splice(e,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t= __get$(this._listeners,e.type) ;if(t!==void 0){e.target=this;let n=t.slice(0);for(let t=0,r=n.length;t<r;t++) __get$(n,t) .call(this,e);e.target=null}}},gW=[];for(let e=0;e<256;e++) __set$(gW,e,(e<16?`0`:``)+e.toString(16)) ;_W=1234567,vW=Math.PI/180,yW=180/Math.PI,bW=Object.freeze({__proto__:null,DEG2RAD:vW,RAD2DEG:yW,generateUUID:PL,clamp:FL,euclideanModulo:IL,mapLinear:LL,inverseLerp:RL,lerp:zL,damp:BL,pingpong:VL,smoothstep:HL,smootherstep:UL,randInt:WL,randFloat:GL,randFloatSpread:KL,seededRandom:qL,degToRad:JL,radToDeg:YL,isPowerOfTwo:XL,ceilPowerOfTwo:ZL,floorPowerOfTwo:QL,setQuaternionFromProperEuler:$L,normalize:tR,denormalize:eR}),Z=class{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error(`index is out of range: `+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error(`index is out of range: `+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t===void 0?(this.x+=e.x,this.y+=e.y,this):(console.warn(`THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.`),this.addVectors(e,t))}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t===void 0?(this.x-=e.x,this.y-=e.y,this):(console.warn(`THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.`),this.subVectors(e,t))}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x= __get$(e,t) ,this.y= __get$(e,t+1) ,this}toArray(e=[],t=0){return  __set$(e,t,this.x) , __set$(e,t+1,this.y) ,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn(`THREE.Vector2: offset has been removed from .fromBufferAttribute().`),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Z.prototype.isVector2=!0,xW=class{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error(`THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.`)}set(e,t,n,r,i,a,o,s,c){let l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],c=n[1],l=n[4],u=n[7],d=n[2],f=n[5],p=n[8],m=r[0],h=r[3],g=r[6],_=r[1],v=r[4],y=r[7],b=r[2],x=r[5],S=r[8];return i[0]=a*m+o*_+s*b,i[3]=a*h+o*v+s*x,i[6]=a*g+o*y+s*S,i[1]=c*m+l*_+u*b,i[4]=c*h+l*v+u*x,i[7]=c*g+l*y+u*S,i[2]=d*m+f*_+p*b,i[5]=d*h+f*v+p*x,i[8]=d*g+f*y+p*S,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8];return t*a*l-t*o*c-n*i*l+n*o*s+r*i*c-r*a*s}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8],u=l*a-o*c,d=o*s-l*i,f=c*i-a*s,p=t*u+n*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let m=1/p;return e[0]=u*m,e[1]=(r*c-l*n)*m,e[2]=(o*n-r*a)*m,e[3]=d*m,e[4]=(l*t-r*s)*m,e[5]=(r*i-o*t)*m,e[6]=f*m,e[7]=(n*s-c*t)*m,e[8]=(a*t-n*i)*m,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,o){let s=Math.cos(i),c=Math.sin(i);return this.set(n*s,n*c,-n*(s*a+c*o)+a+e,-r*c,r*s,-r*(-c*a+s*o)+o+t,0,0,1),this}scale(e,t){let n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){let t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],c=r[4],l=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*c,r[6]=t*o+n*l,r[1]=-n*i+t*s,r[4]=-n*a+t*c,r[7]=-n*o+t*l,this}translate(e,t){let n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){let t=this.elements,n=e.elements;for(let e=0;e<9;e++)if( __get$(t,e) !== __get$(n,e) )return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++) __set$(this.elements,n,__get$(e,n+t)) ;return this}toArray(e=[],t=0){let n=this.elements;return  __set$(e,t,n[0]) , __set$(e,t+1,n[1]) , __set$(e,t+2,n[2]) , __set$(e,t+3,n[3]) , __set$(e,t+4,n[4]) , __set$(e,t+5,n[5]) , __set$(e,t+6,n[6]) , __set$(e,t+7,n[7]) , __set$(e,t+8,n[8]) ,e}clone(){return new this.constructor().fromArray(this.elements)}},xW.prototype.isMatrix3=!0,SW={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},CW={[zU]:{[BU]:aR},[BU]:{[zU]:oR}},wW={legacyMode:!0,get workingColorSpace(){return BU},set workingColorSpace(e){console.warn(`THREE.ColorManagement: .workingColorSpace is readonly.`)},convert:function(e,t,n){if(this.legacyMode||t===n||!t||!n)return e;if( __get$(CW,t) && __get$(__get$(CW,t),n) !==void 0){let r= __get$(__get$(CW,t),n) ;return e.r=r(e.r),e.g=r(e.g),e.b=r(e.b),e}throw Error(`Unsupported color space conversion.`)},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},TW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},EW={r:0,g:0,b:0},DW={h:0,s:0,l:0},OW={h:0,s:0,l:0},kW=class{constructor(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e==`number`?this.setHex(e):typeof e==`string`&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=zU){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,wW.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=BU){return this.r=e,this.g=t,this.b=n,wW.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=BU){if(e=IL(e,1),t=FL(t,0,1),n=FL(n,0,1),t===0)this.r=this.g=this.b=n;else{let r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=sR(i,r,e+1/3),this.g=sR(i,r,e),this.b=sR(i,r,e-1/3)}return wW.toWorkingColorSpace(this,r),this}setStyle(e,t=zU){function n(t){t!==void 0&&parseFloat(t)<1&&console.warn(`THREE.Color: Alpha component of `+e+` will be ignored.`)}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e,i=r[1],a=r[2];switch(i){case`rgb`:case`rgba`:if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,wW.toWorkingColorSpace(this,t),n(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,wW.toWorkingColorSpace(this,t),n(e[4]),this;break;case`hsl`:case`hsla`:if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let r=parseFloat(e[1])/360,i=parseInt(e[2],10)/100,a=parseInt(e[3],10)/100;return n(e[4]),this.setHSL(r,i,a,t)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let e=r[1],n=e.length;if(n===3)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,wW.toWorkingColorSpace(this,t),this;if(n===6)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,wW.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=zU){let n= __get$(TW,e.toLowerCase()) ;return n===void 0?console.warn(`THREE.Color: Unknown color `+e):this.setHex(n,t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=aR(e.r),this.g=aR(e.g),this.b=aR(e.b),this}copyLinearToSRGB(e){return this.r=oR(e.r),this.g=oR(e.g),this.b=oR(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=zU){return wW.fromWorkingColorSpace(cR(this,EW),e),FL(EW.r*255,0,255)<<16^FL(EW.g*255,0,255)<<8^FL(EW.b*255,0,255)<<0}getHexString(e=zU){return(`000000`+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=BU){wW.fromWorkingColorSpace(cR(this,EW),t);let n=EW.r,r=EW.g,i=EW.b,a=Math.max(n,r,i),o=Math.min(n,r,i),s,c,l=(o+a)/2;if(o===a)s=0,c=0;else{let e=a-o;switch(c=l<=.5?e/(a+o):e/(2-a-o),a){case n:s=(r-i)/e+(r<i?6:0);break;case r:s=(i-n)/e+2;break;case i:s=(n-r)/e+4;break}s/=6}return e.h=s,e.s=c,e.l=l,e}getRGB(e,t=BU){return wW.fromWorkingColorSpace(cR(this,EW),t),e.r=EW.r,e.g=EW.g,e.b=EW.b,e}getStyle(e=zU){return wW.fromWorkingColorSpace(cR(this,EW),e),e===zU?`rgb(${EW.r*255|0},${EW.g*255|0},${EW.b*255|0})`:`color(${e} ${EW.r} ${EW.g} ${EW.b})`}offsetHSL(e,t,n){return this.getHSL(DW),DW.h+=e,DW.s+=t,DW.l+=n,this.setHSL(DW.h,DW.s,DW.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(DW),e.getHSL(OW);let n=zL(DW.h,OW.h,t),r=zL(DW.s,OW.s,t),i=zL(DW.l,OW.l,t);return this.setHSL(n,r,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r= __get$(e,t) ,this.g= __get$(e,t+1) ,this.b= __get$(e,t+2) ,this}toArray(e=[],t=0){return  __set$(e,t,this.r) , __set$(e,t+1,this.g) , __set$(e,t+2,this.b) ,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},kW.NAMES=TW,kW.prototype.isColor=!0,kW.prototype.r=1,kW.prototype.g=1,kW.prototype.b=1,jW=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>`u`)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{AW===void 0&&(AW=iR(`canvas`)),AW.width=e.width,AW.height=e.height;let n=AW.getContext(`2d`);e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=AW}return t.width>2048||t.height>2048?(console.warn(`THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons`,e),t.toDataURL(`image/jpeg`,.6)):t.toDataURL(`image/png`)}static sRGBToLinear(e){if(typeof HTMLImageElement<`u`&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<`u`&&e instanceof HTMLCanvasElement||typeof ImageBitmap<`u`&&e instanceof ImageBitmap){let t=iR(`canvas`);t.width=e.width,t.height=e.height;let n=t.getContext(`2d`);n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++) __set$(i,e,aR(__get$(i,e)/255)*255) ;return n.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray? __set$(t,e,Math.floor(aR(__get$(t,e)/255)*255)) : __set$(t,e,aR(__get$(t,e))) ;return{data:t,width:e.width,height:e.height}}else return console.warn(`THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.`),e}},MW=class{constructor(e=null){this.uuid=PL(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e==`string`;if(!t&& __get$(e.images,this.uuid) !==void 0)return  __get$(e.images,this.uuid) ;let n={uuid:this.uuid,url:``},r=this.data;if(r!==null){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++) __get$(r,t) .isDataTexture?e.push(lR( __get$(r,t) .image)):e.push(lR( __get$(r,t) ))}else e=lR(r);n.url=e}return t||( __set$(e.images,this.uuid,n) ),n}},MW.prototype.isSource=!0,NW=0,PW=class e extends hW{constructor(t=e.DEFAULT_IMAGE,n=e.DEFAULT_MAPPING,r=mH,i=mH,a=xH,o=wH,s=zH,c=EH,l=1,u=NU){super(),Object.defineProperty(this,`id`,{value:NW++}),this.uuid=PL(),this.name=``,this.source=new MW(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=i,this.magFilter=a,this.minFilter=o,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=c,this.offset=new Z(0,0),this.repeat=new Z(1,1),this.center=new Z(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new xW,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e==`string`;if(!t&& __get$(e.textures,this.uuid) !==void 0)return  __get$(e.textures,this.uuid) ;let n={metadata:{version:4.5,type:`Texture`,generator:`Texture.toJSON`},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!==`{}`&&(n.userData=this.userData),t||( __set$(e.textures,this.uuid,n) ),n}dispose(){this.dispatchEvent({type:`dispose`})}transformUv(e){if(this.mapping!==sH)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case pH:e.x-=Math.floor(e.x);break;case mH:e.x=e.x<0?0:1;break;case hH:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x-=Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case pH:e.y-=Math.floor(e.y);break;case mH:e.y=e.y<0?0:1;break;case hH:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y-=Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}},PW.DEFAULT_IMAGE=null,PW.DEFAULT_MAPPING=sH,PW.prototype.isTexture=!0,FW=class{constructor(e=0,t=0,n=0,r=1){this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error(`index is out of range: `+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error(`index is out of range: `+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w===void 0?1:e.w,this}add(e,t){return t===void 0?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this):(console.warn(`THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.`),this.addVectors(e,t))}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t===void 0?(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this):(console.warn(`THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.`),this.subVectors(e,t))}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i,a=.01,o=.1,s=e.elements,c=s[0],l=s[4],u=s[8],d=s[1],f=s[5],p=s[9],m=s[2],h=s[6],g=s[10];if(Math.abs(l-d)<a&&Math.abs(u-m)<a&&Math.abs(p-h)<a){if(Math.abs(l+d)<o&&Math.abs(u+m)<o&&Math.abs(p+h)<o&&Math.abs(c+f+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;let e=(c+1)/2,s=(f+1)/2,_=(g+1)/2,v=(l+d)/4,y=(u+m)/4,b=(p+h)/4;return e>s&&e>_?e<a?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=v/n,i=y/n):s>_?s<a?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),n=v/r,i=b/r):_<a?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(_),n=y/i,r=b/i),this.set(n,r,i,t),this}let _=Math.sqrt((h-p)*(h-p)+(u-m)*(u-m)+(d-l)*(d-l));return Math.abs(_)<.001&&(_=1),this.x=(h-p)/_,this.y=(u-m)/_,this.z=(d-l)/_,this.w=Math.acos((c+f+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x= __get$(e,t) ,this.y= __get$(e,t+1) ,this.z= __get$(e,t+2) ,this.w= __get$(e,t+3) ,this}toArray(e=[],t=0){return  __set$(e,t,this.x) , __set$(e,t+1,this.y) , __set$(e,t+2,this.z) , __set$(e,t+3,this.w) ,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn(`THREE.Vector4: offset has been removed from .fromBufferAttribute().`),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},FW.prototype.isVector4=!0,IW=class extends hW{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new FW(0,0,e,t),this.scissorTest=!1,this.viewport=new FW(0,0,e,t),this.texture=new PW({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps===void 0?!1:n.generateMipmaps,this.texture.internalFormat=n.internalFormat===void 0?null:n.internalFormat,this.texture.minFilter=n.minFilter===void 0?xH:n.minFilter,this.depthBuffer=n.depthBuffer===void 0?!0:n.depthBuffer,this.stencilBuffer=n.stencilBuffer===void 0?!1:n.stencilBuffer,this.depthTexture=n.depthTexture===void 0?null:n.depthTexture,this.samples=n.samples===void 0?0:n.samples}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t= __call$(Object,"assign",[{},e.texture.image]) ;return this.texture.source=new MW(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:`dispose`})}},IW.prototype.isWebGLRenderTarget=!0,LW=class extends PW{constructor(e=null,t=1,n=1,r=1){super(null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=gH,this.minFilter=gH,this.wrapR=mH,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},LW.prototype.isDataArrayTexture=!0,RW=class extends IW{constructor(e,t,n){super(e,t),this.depth=n,this.texture=new LW(null,e,t,n),this.texture.isRenderTargetTexture=!0}},RW.prototype.isWebGLArrayRenderTarget=!0,zW=class extends PW{constructor(e=null,t=1,n=1,r=1){super(null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=gH,this.minFilter=gH,this.wrapR=mH,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},zW.prototype.isData3DTexture=!0,BW=class extends IW{constructor(e,t,n){super(e,t),this.depth=n,this.texture=new zW(null,e,t,n),this.texture.isRenderTargetTexture=!0}},BW.prototype.isWebGL3DRenderTarget=!0,VW=class extends IW{constructor(e,t,n,r={}){super(e,t,r);let i=this.texture;this.texture=[];for(let e=0;e<n;e++) __set$(this.texture,e,i.clone()) , __get$(this.texture,e) .isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.texture.length;r<i;r++) __get$(this.texture,r) .image.width=e, __get$(this.texture,r) .image.height=t, __get$(this.texture,r) .image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++) __set$(this.texture,t,__get$(e.texture,t).clone()) , __get$(this.texture,t) .isRenderTargetTexture=!0;return this}},VW.prototype.isWebGLMultipleRenderTargets=!0,HW=class{constructor(e=0,t=0,n=0,r=1){this._x=e,this._y=t,this._z=n,this._w=r}static slerp(e,t,n,r){return console.warn(`THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead.`),n.slerpQuaternions(e,t,r)}static slerpFlat(e,t,n,r,i,a,o){let s= __get$(n,r+0) ,c= __get$(n,r+1) ,l= __get$(n,r+2) ,u= __get$(n,r+3) ,d= __get$(i,a+0) ,f= __get$(i,a+1) ,p= __get$(i,a+2) ,m= __get$(i,a+3) ;if(o===0){ __set$(e,t+0,s) , __set$(e,t+1,c) , __set$(e,t+2,l) , __set$(e,t+3,u) ;return}if(o===1){ __set$(e,t+0,d) , __set$(e,t+1,f) , __set$(e,t+2,p) , __set$(e,t+3,m) ;return}if(u!==m||s!==d||c!==f||l!==p){let e=1-o,t=s*d+c*f+l*p+u*m,n=t>=0?1:-1,r=1-t*t;if(r>2**-52){let i=Math.sqrt(r),a=Math.atan2(i,t*n);e=Math.sin(e*a)/i,o=Math.sin(o*a)/i}let i=o*n;if(s=s*e+d*i,c=c*e+f*i,l=l*e+p*i,u=u*e+m*i,e===1-o){let e=1/Math.sqrt(s*s+c*c+l*l+u*u);s*=e,c*=e,l*=e,u*=e}} __set$(e,t,s) , __set$(e,t+1,c) , __set$(e,t+2,l) , __set$(e,t+3,u) }static multiplyQuaternionsFlat(e,t,n,r,i,a){let o= __get$(n,r) ,s= __get$(n,r+1) ,c= __get$(n,r+2) ,l= __get$(n,r+3) ,u= __get$(i,a) ,d= __get$(i,a+1) ,f= __get$(i,a+2) ,p= __get$(i,a+3) ;return  __set$(e,t,o*p+l*u+s*f-c*d) , __set$(e,t+1,s*p+l*d+c*u-o*f) , __set$(e,t+2,c*p+l*f+o*d-s*u) , __set$(e,t+3,l*p-o*u-s*d-c*f) ,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw Error(`THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.`);let n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,c=o(n/2),l=o(r/2),u=o(i/2),d=s(n/2),f=s(r/2),p=s(i/2);switch(a){case`XYZ`:this._x=d*l*u+c*f*p,this._y=c*f*u-d*l*p,this._z=c*l*p+d*f*u,this._w=c*l*u-d*f*p;break;case`YXZ`:this._x=d*l*u+c*f*p,this._y=c*f*u-d*l*p,this._z=c*l*p-d*f*u,this._w=c*l*u+d*f*p;break;case`ZXY`:this._x=d*l*u-c*f*p,this._y=c*f*u+d*l*p,this._z=c*l*p+d*f*u,this._w=c*l*u-d*f*p;break;case`ZYX`:this._x=d*l*u-c*f*p,this._y=c*f*u+d*l*p,this._z=c*l*p-d*f*u,this._w=c*l*u+d*f*p;break;case`YZX`:this._x=d*l*u+c*f*p,this._y=c*f*u+d*l*p,this._z=c*l*p-d*f*u,this._w=c*l*u-d*f*p;break;case`XZY`:this._x=d*l*u-c*f*p,this._y=c*f*u-d*l*p,this._z=c*l*p+d*f*u,this._w=c*l*u+d*f*p;break;default:console.warn(`THREE.Quaternion: .setFromEuler() encountered an unknown order: `+a)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],c=t[2],l=t[6],u=t[10],d=n+o+u;if(d>0){let e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(l-s)*e,this._y=(i-c)*e,this._z=(a-r)*e}else if(n>o&&n>u){let e=2*Math.sqrt(1+n-o-u);this._w=(l-s)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(i+c)/e}else if(o>u){let e=2*Math.sqrt(1+o-n-u);this._w=(i-c)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(s+l)/e}else{let e=2*Math.sqrt(1+u-n-o);this._w=(a-r)/e,this._x=(i+c)/e,this._y=(s+l)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<2**-52?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(FL(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(n===0)return this;let r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this._onChangeCallback(),this}multiply(e,t){return t===void 0?this.multiplyQuaternions(this,e):(console.warn(`THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.`),this.multiplyQuaternions(e,t))}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,c=t._z,l=t._w;return this._x=n*l+a*o+r*c-i*s,this._y=r*l+a*s+i*o-n*c,this._z=i*l+a*c+n*s-r*o,this._w=a*l-n*o-r*s-i*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;let s=1-o*o;if(s<=2**-52){let e=1-t;return this._w=e*a+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}let c=Math.sqrt(s),l=Math.atan2(c,o),u=Math.sin((1-t)*l)/c,d=Math.sin(t*l)/c;return this._w=a*u+this._w*d,this._x=n*u+this._x*d,this._y=r*u+this._y*d,this._z=i*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x= __get$(e,t) ,this._y= __get$(e,t+1) ,this._z= __get$(e,t+2) ,this._w= __get$(e,t+3) ,this._onChangeCallback(),this}toArray(e=[],t=0){return  __set$(e,t,this._x) , __set$(e,t+1,this._y) , __set$(e,t+2,this._z) , __set$(e,t+3,this._w) ,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},HW.prototype.isQuaternion=!0,Q=class{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error(`index is out of range: `+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error(`index is out of range: `+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t===void 0?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this):(console.warn(`THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.`),this.addVectors(e,t))}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t===void 0?(this.x-=e.x,this.y-=e.y,this.z-=e.z,this):(console.warn(`THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.`),this.subVectors(e,t))}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t===void 0?(this.x*=e.x,this.y*=e.y,this.z*=e.z,this):(console.warn(`THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.`),this.multiplyVectors(e,t))}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error(`THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.`),this.applyQuaternion(WW.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(WW.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){let t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,c=s*t+a*r-o*n,l=s*n+o*t-i*r,u=s*r+i*n-a*t,d=-i*t-a*n-o*r;return this.x=c*s+d*-i+l*-o-u*-a,this.y=l*s+d*-a+u*-i-c*-o,this.z=u*s+d*-o+c*-a-l*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return t===void 0?this.crossVectors(this,e):(console.warn(`THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.`),this.crossVectors(e,t))}crossVectors(e,t){let n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return UW.copy(this).projectOnVector(e),this.sub(UW)}reflect(e){return this.sub(UW.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(FL(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x= __get$(e,t) ,this.y= __get$(e,t+1) ,this.z= __get$(e,t+2) ,this}toArray(e=[],t=0){return  __set$(e,t,this.x) , __set$(e,t+1,this.y) , __set$(e,t+2,this.z) ,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn(`THREE.Vector3: offset has been removed from .fromBufferAttribute().`),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},Q.prototype.isVector3=!0,UW=new Q,WW=new HW,GW=class{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0;for(let s=0,c=e.length;s<c;s+=3){let c= __get$(e,s) ,l= __get$(e,s+1) ,u= __get$(e,s+2) ;c<t&&(t=c),l<n&&(n=l),u<r&&(r=u),c>i&&(i=c),l>a&&(a=l),u>o&&(o=u)}return this.min.set(t,n,r),this.max.set(i,a,o),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0;for(let s=0,c=e.count;s<c;s++){let c=e.getX(s),l=e.getY(s),u=e.getZ(s);c<t&&(t=c),l<n&&(n=l),u<r&&(r=u),c>i&&(i=c),l>a&&(a=l),u>o&&(o=u)}return this.min.set(t,n,r),this.max.set(i,a,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint( __get$(e,t) );return this}setFromCenterAndSize(e,t){let n=qW.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0)if(t&&n.attributes!=null&&n.attributes.position!==void 0){let t=n.attributes.position;for(let n=0,r=t.count;n<r;n++)qW.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(qW)}else n.boundingBox===null&&n.computeBoundingBox(),JW.copy(n.boundingBox),JW.applyMatrix4(e.matrixWorld),this.union(JW);let r=e.children;for(let e=0,n=r.length;e<n;e++)this.expandByObject( __get$(r,e) ,t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,qW),qW.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(tG),nG.subVectors(this.max,tG),YW.subVectors(e.a,tG),XW.subVectors(e.b,tG),ZW.subVectors(e.c,tG),QW.subVectors(XW,YW),$W.subVectors(ZW,XW),eG.subVectors(YW,ZW);let t=[0,-QW.z,QW.y,0,-$W.z,$W.y,0,-eG.z,eG.y,QW.z,0,-QW.x,$W.z,0,-$W.x,eG.z,0,-eG.x,-QW.y,QW.x,0,-$W.y,$W.x,0,-eG.y,eG.x,0];return!uR(t,YW,XW,ZW,nG)||(t=[1,0,0,0,1,0,0,0,1],!uR(t,YW,XW,ZW,nG))?!1:(rG.crossVectors(QW,$W),t=[rG.x,rG.y,rG.z],uR(t,YW,XW,ZW,nG))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qW.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(qW).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(KW[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),KW[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),KW[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),KW[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),KW[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),KW[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),KW[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),KW[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(KW),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},GW.prototype.isBox3=!0,KW=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],qW=new Q,JW=new GW,YW=new Q,XW=new Q,ZW=new Q,QW=new Q,$W=new Q,eG=new Q,tG=new Q,nG=new Q,rG=new Q,iG=new Q,aG=new GW,oG=new Q,sG=new Q,cG=new Q,lG=class{constructor(e=new Q,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;t===void 0?aG.setFromPoints(e).getCenter(n):n.copy(t);let r=0;for(let t=0,i=e.length;t<i;t++)r=Math.max(r,n.distanceToSquared( __get$(e,t) ));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){cG.subVectors(e,this.center);let t=cG.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),n=(e-this.radius)*.5;this.center.add(cG.multiplyScalar(n/e)),this.radius+=n}return this}union(e){return this.center.equals(e.center)===!0?sG.set(0,0,1).multiplyScalar(e.radius):sG.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(oG.copy(e.center).add(sG)),this.expandByPoint(oG.copy(e.center).sub(sG)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},uG=new Q,dG=new Q,fG=new Q,pG=new Q,mG=new Q,hG=new Q,gG=new Q,_G=class{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,uG)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=uG.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(uG.copy(this.direction).multiplyScalar(t).add(this.origin),uG.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){dG.copy(e).add(t).multiplyScalar(.5),fG.copy(t).sub(e).normalize(),pG.copy(this.origin).sub(dG);let i=e.distanceTo(t)*.5,a=-this.direction.dot(fG),o=pG.dot(this.direction),s=-pG.dot(fG),c=pG.lengthSq(),l=Math.abs(1-a*a),u,d,f,p;if(l>0)if(u=a*s-o,d=a*o-s,p=i*l,u>=0)if(d>=-p)if(d<=p){let e=1/l;u*=e,d*=e,f=u*(u+a*d+2*o)+d*(a*u+d+2*s)+c}else d=i,u=Math.max(0,-(a*d+o)),f=-u*u+d*(d+2*s)+c;else d=-i,u=Math.max(0,-(a*d+o)),f=-u*u+d*(d+2*s)+c;else d<=-p?(u=Math.max(0,-(-a*i+o)),d=u>0?-i:Math.min(Math.max(-i,-s),i),f=-u*u+d*(d+2*s)+c):d<=p?(u=0,d=Math.min(Math.max(-i,-s),i),f=d*(d+2*s)+c):(u=Math.max(0,-(a*i+o)),d=u>0?i:Math.min(Math.max(-i,-s),i),f=-u*u+d*(d+2*s)+c);else d=a>0?-i:i,u=Math.max(0,-(a*d+o)),f=-u*u+d*(d+2*s)+c;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(fG).multiplyScalar(d).add(dG),f}intersectSphere(e,t){uG.subVectors(e.center,this.origin);let n=uG.dot(this.direction),r=uG.dot(uG)-n*n,i=e.radius*e.radius;if(r>i)return null;let a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,o,s,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),l>=0?(i=(e.min.y-d.y)*l,a=(e.max.y-d.y)*l):(i=(e.max.y-d.y)*l,a=(e.min.y-d.y)*l),n>a||i>r||((i>n||n!==n)&&(n=i),(a<r||r!==r)&&(r=a),u>=0?(o=(e.min.z-d.z)*u,s=(e.max.z-d.z)*u):(o=(e.max.z-d.z)*u,s=(e.min.z-d.z)*u),n>s||o>r)||((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,uG)!==null}intersectTriangle(e,t,n,r,i){mG.subVectors(t,e),hG.subVectors(n,e),gG.crossVectors(mG,hG);let a=this.direction.dot(gG),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;pG.subVectors(this.origin,e);let s=o*this.direction.dot(hG.crossVectors(pG,hG));if(s<0)return null;let c=o*this.direction.dot(mG.cross(pG));if(c<0||s+c>a)return null;let l=-o*pG.dot(gG);return l<0?null:this.at(l/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},vG=class e{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error(`THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.`)}set(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h){let g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=c,g[6]=l,g[10]=u,g[14]=d,g[3]=f,g[7]=p,g[11]=m,g[15]=h,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new e().fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,r=1/yG.setFromMatrixColumn(e,0).length(),i=1/yG.setFromMatrixColumn(e,1).length(),a=1/yG.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error(`THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.`);let t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),c=Math.sin(r),l=Math.cos(i),u=Math.sin(i);if(e.order===`XYZ`){let e=a*l,n=a*u,r=o*l,i=o*u;t[0]=s*l,t[4]=-s*u,t[8]=c,t[1]=n+r*c,t[5]=e-i*c,t[9]=-o*s,t[2]=i-e*c,t[6]=r+n*c,t[10]=a*s}else if(e.order===`YXZ`){let e=s*l,n=s*u,r=c*l,i=c*u;t[0]=e+i*o,t[4]=r*o-n,t[8]=a*c,t[1]=a*u,t[5]=a*l,t[9]=-o,t[2]=n*o-r,t[6]=i+e*o,t[10]=a*s}else if(e.order===`ZXY`){let e=s*l,n=s*u,r=c*l,i=c*u;t[0]=e-i*o,t[4]=-a*u,t[8]=r+n*o,t[1]=n+r*o,t[5]=a*l,t[9]=i-e*o,t[2]=-a*c,t[6]=o,t[10]=a*s}else if(e.order===`ZYX`){let e=a*l,n=a*u,r=o*l,i=o*u;t[0]=s*l,t[4]=r*c-n,t[8]=e*c+i,t[1]=s*u,t[5]=i*c+e,t[9]=n*c-r,t[2]=-c,t[6]=o*s,t[10]=a*s}else if(e.order===`YZX`){let e=a*s,n=a*c,r=o*s,i=o*c;t[0]=s*l,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=a*l,t[9]=-o*l,t[2]=-c*l,t[6]=n*u+r,t[10]=e-i*u}else if(e.order===`XZY`){let e=a*s,n=a*c,r=o*s,i=o*c;t[0]=s*l,t[4]=-u,t[8]=c*l,t[1]=e*u+i,t[5]=a*l,t[9]=n*u-r,t[2]=r*u-n,t[6]=o*l,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(xG,e,SG)}lookAt(e,t,n){let r=this.elements;return TG.subVectors(e,t),TG.lengthSq()===0&&(TG.z=1),TG.normalize(),CG.crossVectors(n,TG),CG.lengthSq()===0&&(Math.abs(n.z)===1?TG.x+=1e-4:TG.z+=1e-4,TG.normalize(),CG.crossVectors(n,TG)),CG.normalize(),wG.crossVectors(TG,CG),r[0]=CG.x,r[4]=wG.x,r[8]=TG.x,r[1]=CG.y,r[5]=wG.y,r[9]=TG.y,r[2]=CG.z,r[6]=wG.z,r[10]=TG.z,this}multiply(e,t){return t===void 0?this.multiplyMatrices(this,e):(console.warn(`THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.`),this.multiplyMatrices(e,t))}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],c=n[12],l=n[1],u=n[5],d=n[9],f=n[13],p=n[2],m=n[6],h=n[10],g=n[14],_=n[3],v=n[7],y=n[11],b=n[15],x=r[0],S=r[4],C=r[8],w=r[12],T=r[1],E=r[5],D=r[9],O=r[13],k=r[2],ee=r[6],A=r[10],j=r[14],M=r[3],N=r[7],P=r[11],te=r[15];return i[0]=a*x+o*T+s*k+c*M,i[4]=a*S+o*E+s*ee+c*N,i[8]=a*C+o*D+s*A+c*P,i[12]=a*w+o*O+s*j+c*te,i[1]=l*x+u*T+d*k+f*M,i[5]=l*S+u*E+d*ee+f*N,i[9]=l*C+u*D+d*A+f*P,i[13]=l*w+u*O+d*j+f*te,i[2]=p*x+m*T+h*k+g*M,i[6]=p*S+m*E+h*ee+g*N,i[10]=p*C+m*D+h*A+g*P,i[14]=p*w+m*O+h*j+g*te,i[3]=_*x+v*T+y*k+b*M,i[7]=_*S+v*E+y*ee+b*N,i[11]=_*C+v*D+y*A+b*P,i[15]=_*w+v*O+y*j+b*te,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],c=e[13],l=e[2],u=e[6],d=e[10],f=e[14],p=e[3],m=e[7],h=e[11],g=e[15];return p*(+i*s*u-r*c*u-i*o*d+n*c*d+r*o*f-n*s*f)+m*(+t*s*f-t*c*d+i*a*d-r*a*f+r*c*l-i*s*l)+h*(+t*c*u-t*o*f-i*a*u+n*a*f+i*o*l-n*c*l)+g*(-r*o*l-t*s*u+t*o*d+r*a*u-n*a*d+n*s*l)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8],u=e[9],d=e[10],f=e[11],p=e[12],m=e[13],h=e[14],g=e[15],_=u*h*c-m*d*c+m*s*f-o*h*f-u*s*g+o*d*g,v=p*d*c-l*h*c-p*s*f+a*h*f+l*s*g-a*d*g,y=l*m*c-p*u*c+p*o*f-a*m*f-l*o*g+a*u*g,b=p*u*s-l*m*s-p*o*d+a*m*d+l*o*h-a*u*h,x=t*_+n*v+r*y+i*b;if(x===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let S=1/x;return e[0]=_*S,e[1]=(m*d*i-u*h*i-m*r*f+n*h*f+u*r*g-n*d*g)*S,e[2]=(o*h*i-m*s*i+m*r*c-n*h*c-o*r*g+n*s*g)*S,e[3]=(u*s*i-o*d*i-u*r*c+n*d*c+o*r*f-n*s*f)*S,e[4]=v*S,e[5]=(l*h*i-p*d*i+p*r*f-t*h*f-l*r*g+t*d*g)*S,e[6]=(p*s*i-a*h*i-p*r*c+t*h*c+a*r*g-t*s*g)*S,e[7]=(a*d*i-l*s*i+l*r*c-t*d*c-a*r*f+t*s*f)*S,e[8]=y*S,e[9]=(p*u*i-l*m*i-p*n*f+t*m*f+l*n*g-t*u*g)*S,e[10]=(a*m*i-p*o*i+p*n*c-t*m*c-a*n*g+t*o*g)*S,e[11]=(l*o*i-a*u*i-l*n*c+t*u*c+a*n*f-t*o*f)*S,e[12]=b*S,e[13]=(l*m*r-p*u*r+p*n*d-t*m*d-l*n*h+t*u*h)*S,e[14]=(p*o*r-a*m*r-p*n*s+t*m*s+a*n*h-t*o*h)*S,e[15]=(a*u*r-l*o*r+l*n*s-t*u*s-a*n*d+t*o*d)*S,this}scale(e){let t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,c=i*a,l=i*o;return this.set(c*a+n,c*o-r*s,c*s+r*o,0,c*o+r*s,l*o+n,l*s-r*a,0,c*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){let r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,c=i+i,l=a+a,u=o+o,d=i*c,f=i*l,p=i*u,m=a*l,h=a*u,g=o*u,_=s*c,v=s*l,y=s*u,b=n.x,x=n.y,S=n.z;return r[0]=(1-(m+g))*b,r[1]=(f+y)*b,r[2]=(p-v)*b,r[3]=0,r[4]=(f-y)*x,r[5]=(1-(d+g))*x,r[6]=(h+_)*x,r[7]=0,r[8]=(p+v)*S,r[9]=(h-_)*S,r[10]=(1-(d+m))*S,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){let r=this.elements,i=yG.set(r[0],r[1],r[2]).length(),a=yG.set(r[4],r[5],r[6]).length(),o=yG.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],bG.copy(this);let s=1/i,c=1/a,l=1/o;return bG.elements[0]*=s,bG.elements[1]*=s,bG.elements[2]*=s,bG.elements[4]*=c,bG.elements[5]*=c,bG.elements[6]*=c,bG.elements[8]*=l,bG.elements[9]*=l,bG.elements[10]*=l,t.setFromRotationMatrix(bG),n.x=i,n.y=a,n.z=o,this}makePerspective(e,t,n,r,i,a){a===void 0&&console.warn(`THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.`);let o=this.elements,s=2*i/(t-e),c=2*i/(n-r),l=(t+e)/(t-e),u=(n+r)/(n-r),d=-(a+i)/(a-i),f=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=c,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,n,r,i,a){let o=this.elements,s=1/(t-e),c=1/(n-r),l=1/(a-i),u=(t+e)*s,d=(n+r)*c,f=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let e=0;e<16;e++)if( __get$(t,e) !== __get$(n,e) )return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++) __set$(this.elements,n,__get$(e,n+t)) ;return this}toArray(e=[],t=0){let n=this.elements;return  __set$(e,t,n[0]) , __set$(e,t+1,n[1]) , __set$(e,t+2,n[2]) , __set$(e,t+3,n[3]) , __set$(e,t+4,n[4]) , __set$(e,t+5,n[5]) , __set$(e,t+6,n[6]) , __set$(e,t+7,n[7]) , __set$(e,t+8,n[8]) , __set$(e,t+9,n[9]) , __set$(e,t+10,n[10]) , __set$(e,t+11,n[11]) , __set$(e,t+12,n[12]) , __set$(e,t+13,n[13]) , __set$(e,t+14,n[14]) , __set$(e,t+15,n[15]) ,e}},vG.prototype.isMatrix4=!0,yG=new Q,bG=new vG,xG=new Q(0,0,0),SG=new Q(1,1,1),CG=new Q,wG=new Q,TG=new Q,EG=new vG,DG=new HW,OG=class e{constructor(t=0,n=0,r=0,i=e.DefaultOrder){this._x=t,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){let r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],c=r[5],l=r[9],u=r[2],d=r[6],f=r[10];switch(t){case`XYZ`:this._y=Math.asin(FL(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(d,c),this._z=0);break;case`YXZ`:this._x=Math.asin(-FL(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(s,c)):(this._y=Math.atan2(-u,i),this._z=0);break;case`ZXY`:this._x=Math.asin(FL(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(s,i));break;case`ZYX`:this._y=Math.asin(-FL(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,c));break;case`YZX`:this._z=Math.asin(FL(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,f));break;case`XZY`:this._z=Math.asin(-FL(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-l,f),this._y=0);break;default:console.warn(`THREE.Euler: .setFromRotationMatrix() encountered an unknown order: `+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return EG.makeRotationFromQuaternion(e),this.setFromRotationMatrix(EG,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return DG.setFromEuler(this),this.setFromQuaternion(DG,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return  __set$(e,t,this._x) , __set$(e,t+1,this._y) , __set$(e,t+2,this._z) , __set$(e,t+3,this._order) ,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}},OG.prototype.isEuler=!0,OG.DefaultOrder=`XYZ`,OG.RotationOrders=[`XYZ`,`YZX`,`ZXY`,`XZY`,`YXZ`,`ZYX`],kG=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!=0}},AG=0,jG=new Q,MG=new HW,NG=new vG,PG=new Q,FG=new Q,IG=new Q,LG=new HW,RG=new Q(1,0,0),zG=new Q(0,1,0),BG=new Q(0,0,1),VG={type:`added`},HG={type:`removed`},UG=class e extends hW{constructor(){super(),Object.defineProperty(this,`id`,{value:AG++}),this.uuid=PL(),this.name=``,this.type=`Object3D`,this.parent=null,this.children=[],this.up=e.DefaultUp.clone();let t=new Q,n=new OG,r=new HW,i=new Q(1,1,1);function a(){r.setFromEuler(n,!1)}function o(){n.setFromQuaternion(r,void 0,!1)}n._onChange(a),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new vG},normalMatrix:{value:new xW}}),this.matrix=new vG,this.matrixWorld=new vG,this.matrixAutoUpdate=e.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new kG,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return MG.setFromAxisAngle(e,t),this.quaternion.multiply(MG),this}rotateOnWorldAxis(e,t){return MG.setFromAxisAngle(e,t),this.quaternion.premultiply(MG),this}rotateX(e){return this.rotateOnAxis(RG,e)}rotateY(e){return this.rotateOnAxis(zG,e)}rotateZ(e){return this.rotateOnAxis(BG,e)}translateOnAxis(e,t){return jG.copy(e).applyQuaternion(this.quaternion),this.position.add(jG.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(RG,e)}translateY(e){return this.translateOnAxis(zG,e)}translateZ(e){return this.translateOnAxis(BG,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(NG.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?PG.copy(e):PG.set(e,t,n);let r=this.parent;this.updateWorldMatrix(!0,!1),FG.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?NG.lookAt(FG,PG,this.up):NG.lookAt(PG,FG,this.up),this.quaternion.setFromRotationMatrix(NG),r&&(NG.extractRotation(r.matrixWorld),MG.setFromRotationMatrix(NG),this.quaternion.premultiply(MG.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add( __get$(arguments,e) );return this}return e===this?(console.error(`THREE.Object3D.add: object can't be added as a child of itself.`,e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(VG)):console.error(`THREE.Object3D.add: object not an instance of THREE.Object3D.`,e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove( __get$(arguments,e) );return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(HG)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t= __get$(this.children,e) ;t.parent=null,t.dispatchEvent(HG)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),NG.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),NG.multiply(e.parent.matrixWorld)),e.applyMatrix4(NG),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty(`id`,e)}getObjectByName(e){return this.getObjectByProperty(`name`,e)}getObjectByProperty(e,t){if( __get$(this,e) ===t)return this;for(let n=0,r=this.children.length;n<r;n++){let r= __get$(this.children,n) .getObjectByProperty(e,t);if(r!==void 0)return r}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(FG,e,IG),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(FG,LG,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let n=0,r=t.length;n<r;n++) __get$(t,n) .traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let n=0,r=t.length;n<r;n++) __get$(t,n) .traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let n=0,r=t.length;n<r;n++) __get$(t,n) .updateMatrixWorld(e)}updateWorldMatrix(e,t){let n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let e=this.children;for(let t=0,n=e.length;t<n;t++) __get$(e,t) .updateWorldMatrix(!1,!0)}}toJSON(e){let t=e===void 0||typeof e==`string`,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:`Object`,generator:`Object3D.toJSON`});let r={};r.uuid=this.uuid,r.type=this.type,this.name!==``&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!==`{}`&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type=`InstancedMesh`,r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function i(t,n){return  __get$(t,n.uuid) ===void 0&&( __set$(t,n.uuid,n.toJSON(e)) ),n.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);let t=this.geometry.parameters;if(t!==void 0&&t.shapes!==void 0){let n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){let r= __get$(n,t) ;i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials, __get$(this.material,n) ));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push( __get$(this.children,t) .toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){let n= __get$(this.animations,t) ;r.animations.push(i(e.animations,n))}}if(t){let t=a(e.geometries),r=a(e.materials),i=a(e.textures),o=a(e.images),s=a(e.shapes),c=a(e.skeletons),l=a(e.animations),u=a(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),o.length>0&&(n.images=o),s.length>0&&(n.shapes=s),c.length>0&&(n.skeletons=c),l.length>0&&(n.animations=l),u.length>0&&(n.nodes=u)}return n.object=r,n;function a(e){let t=[];for(let n in e){let r= __get$(e,n) ;delete r.metadata,t.push(r)}return t}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let t=0;t<e.children.length;t++){let n= __get$(e.children,t) ;this.add(n.clone())}return this}},UG.DefaultUp=new Q(0,1,0),UG.DefaultMatrixAutoUpdate=!0,UG.prototype.isObject3D=!0,WG=new Q,GG=new Q,KG=new Q,qG=new Q,JG=new Q,YG=new Q,XG=new Q,ZG=new Q,QG=new Q,$G=new Q,eK=class e{constructor(e=new Q,t=new Q,n=new Q){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),WG.subVectors(e,t),r.cross(WG);let i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){WG.subVectors(r,t),GG.subVectors(n,t),KG.subVectors(e,t);let a=WG.dot(WG),o=WG.dot(GG),s=WG.dot(KG),c=GG.dot(GG),l=GG.dot(KG),u=a*c-o*o;if(u===0)return i.set(-2,-1,-1);let d=1/u,f=(c*s-o*l)*d,p=(a*l-o*s)*d;return i.set(1-f-p,p,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,qG),qG.x>=0&&qG.y>=0&&qG.x+qG.y<=1}static getUV(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,qG),s.set(0,0),s.addScaledVector(i,qG.x),s.addScaledVector(a,qG.y),s.addScaledVector(o,qG.z),s}static isFrontFacing(e,t,n,r){return WG.subVectors(n,t),GG.subVectors(e,t),WG.cross(GG).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy( __get$(e,t) ),this.b.copy( __get$(e,n) ),this.c.copy( __get$(e,r) ),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return WG.subVectors(this.c,this.b),GG.subVectors(this.a,this.b),WG.cross(GG).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return e.getNormal(this.a,this.b,this.c,t)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}getUV(t,n,r,i,a){return e.getUV(t,this.a,this.b,this.c,n,r,i,a)}containsPoint(t){return e.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return e.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,r=this.b,i=this.c,a,o;JG.subVectors(r,n),YG.subVectors(i,n),ZG.subVectors(e,n);let s=JG.dot(ZG),c=YG.dot(ZG);if(s<=0&&c<=0)return t.copy(n);QG.subVectors(e,r);let l=JG.dot(QG),u=YG.dot(QG);if(l>=0&&u<=l)return t.copy(r);let d=s*u-l*c;if(d<=0&&s>=0&&l<=0)return a=s/(s-l),t.copy(n).addScaledVector(JG,a);$G.subVectors(e,i);let f=JG.dot($G),p=YG.dot($G);if(p>=0&&f<=p)return t.copy(i);let m=f*c-s*p;if(m<=0&&c>=0&&p<=0)return o=c/(c-p),t.copy(n).addScaledVector(YG,o);let h=l*p-f*u;if(h<=0&&u-l>=0&&f-p>=0)return XG.subVectors(i,r),o=(u-l)/(u-l+(f-p)),t.copy(r).addScaledVector(XG,o);let g=1/(h+m+d);return a=m*g,o=d*g,t.copy(n).addScaledVector(JG,a).addScaledVector(YG,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},tK=0,nK=class extends hW{constructor(){super(),Object.defineProperty(this,`id`,{value:tK++}),this.uuid=PL(),this.name=``,this.type=`Material`,this.blending=CV,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=LV,this.blendDst=RV,this.blendEquation=OV,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=qV,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=nW,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=HU,this.stencilZFail=HU,this.stencilZPass=HU,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let n= __get$(e,t) ;if(n===void 0){console.warn(`THREE.Material: '`+t+`' parameter is undefined.`);continue}if(t===`shading`){console.warn(`THREE.`+this.type+`: .shading has been removed. Use the boolean .flatShading instead.`),this.flatShading=n===bV;continue}let r= __get$(this,t) ;if(r===void 0){console.warn(`THREE.`+this.type+`: '`+t+`' is not a property of this material.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n): __set$(this,t,n) }}toJSON(e){let t=e===void 0||typeof e==`string`;t&&(e={textures:{},images:{}});let n={metadata:{version:4.5,type:`Material`,generator:`Material.toJSON`}};n.uuid=this.uuid,n.type=this.type,this.name!==``&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==CV&&(n.blending=this.blending),this.side!==0&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!==`round`&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!==`round`&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),JSON.stringify(this.userData)!==`{}`&&(n.userData=this.userData);function r(e){let t=[];for(let n in e){let r= __get$(e,n) ;delete r.metadata,t.push(r)}return t}if(t){let t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(t!==null){let e=t.length;n=Array(e);for(let r=0;r!==e;++r) __set$(n,r,__get$(t,r).clone()) }return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:`dispose`})}set needsUpdate(e){e===!0&&this.version++}},nK.prototype.isMaterial=!0,nK.fromType=function(){return null},rK=class extends nK{constructor(e){super(),this.type=`MeshBasicMaterial`,this.color=new kW(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=QV,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=`round`,this.wireframeLinejoin=`round`,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},rK.prototype.isMeshBasicMaterial=!0,iK=new Q,aK=new Z,oK=class{constructor(e,t,n){if(Array.isArray(e))throw TypeError(`THREE.BufferAttribute: array should be a Typed Array.`);this.name=``,this.array=e,this.itemSize=t,this.count=e===void 0?0:e.length/t,this.normalized=n===!0,this.usage=rW,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++) __set$(this.array,e+r,__get$(t.array,n+r)) ;return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){let t=this.array,n=0;for(let r=0,i=e.length;r<i;r++){let i= __get$(e,r) ;i===void 0&&(console.warn(`THREE.BufferAttribute.copyColorsArray(): color is undefined`,r),i=new kW), __set$(t,n++,i.r) , __set$(t,n++,i.g) , __set$(t,n++,i.b) }return this}copyVector2sArray(e){let t=this.array,n=0;for(let r=0,i=e.length;r<i;r++){let i= __get$(e,r) ;i===void 0&&(console.warn(`THREE.BufferAttribute.copyVector2sArray(): vector is undefined`,r),i=new Z), __set$(t,n++,i.x) , __set$(t,n++,i.y) }return this}copyVector3sArray(e){let t=this.array,n=0;for(let r=0,i=e.length;r<i;r++){let i= __get$(e,r) ;i===void 0&&(console.warn(`THREE.BufferAttribute.copyVector3sArray(): vector is undefined`,r),i=new Q), __set$(t,n++,i.x) , __set$(t,n++,i.y) , __set$(t,n++,i.z) }return this}copyVector4sArray(e){let t=this.array,n=0;for(let r=0,i=e.length;r<i;r++){let i= __get$(e,r) ;i===void 0&&(console.warn(`THREE.BufferAttribute.copyVector4sArray(): vector is undefined`,r),i=new FW), __set$(t,n++,i.x) , __set$(t,n++,i.y) , __set$(t,n++,i.z) , __set$(t,n++,i.w) }return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)aK.fromBufferAttribute(this,t),aK.applyMatrix3(e),this.setXY(t,aK.x,aK.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)iK.fromBufferAttribute(this,t),iK.applyMatrix3(e),this.setXYZ(t,iK.x,iK.y,iK.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)iK.fromBufferAttribute(this,t),iK.applyMatrix4(e),this.setXYZ(t,iK.x,iK.y,iK.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)iK.fromBufferAttribute(this,t),iK.applyNormalMatrix(e),this.setXYZ(t,iK.x,iK.y,iK.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)iK.fromBufferAttribute(this,t),iK.transformDirection(e),this.setXYZ(t,iK.x,iK.y,iK.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return  __get$(this.array,e*this.itemSize) }setX(e,t){return  __set$(this.array,e*this.itemSize,t) ,this}getY(e){return  __get$(this.array,e*this.itemSize+1) }setY(e,t){return  __set$(this.array,e*this.itemSize+1,t) ,this}getZ(e){return  __get$(this.array,e*this.itemSize+2) }setZ(e,t){return  __set$(this.array,e*this.itemSize+2,t) ,this}getW(e){return  __get$(this.array,e*this.itemSize+3) }setW(e,t){return  __set$(this.array,e*this.itemSize+3,t) ,this}setXY(e,t,n){return e*=this.itemSize, __set$(this.array,e+0,t) , __set$(this.array,e+1,n) ,this}setXYZ(e,t,n,r){return e*=this.itemSize, __set$(this.array,e+0,t) , __set$(this.array,e+1,n) , __set$(this.array,e+2,r) ,this}setXYZW(e,t,n,r,i){return e*=this.itemSize, __set$(this.array,e+0,t) , __set$(this.array,e+1,n) , __set$(this.array,e+2,r) , __set$(this.array,e+3,i) ,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==``&&(e.name=this.name),this.usage!==rW&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}},oK.prototype.isBufferAttribute=!0,sK=class extends oK{constructor(e,t,n){super(new Int8Array(e),t,n)}},cK=class extends oK{constructor(e,t,n){super(new Uint8Array(e),t,n)}},lK=class extends oK{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}},uK=class extends oK{constructor(e,t,n){super(new Int16Array(e),t,n)}},dK=class extends oK{constructor(e,t,n){super(new Uint16Array(e),t,n)}},fK=class extends oK{constructor(e,t,n){super(new Int32Array(e),t,n)}},pK=class extends oK{constructor(e,t,n){super(new Uint32Array(e),t,n)}},mK=class extends oK{constructor(e,t,n){super(new Uint16Array(e),t,n)}},mK.prototype.isFloat16BufferAttribute=!0,hK=class extends oK{constructor(e,t,n){super(new Float32Array(e),t,n)}},gK=class extends oK{constructor(e,t,n){super(new Float64Array(e),t,n)}},_K=0,vK=new vG,yK=new UG,bK=new Q,xK=new GW,SK=new GW,CK=new Q,wK=class e extends hW{constructor(){super(),Object.defineProperty(this,`id`,{value:_K++}),this.uuid=PL(),this.name=``,this.type=`BufferGeometry`,this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(nR(e)?pK:dK)(e,1):this.index=e,this}getAttribute(e){return  __get$(this.attributes,e) }setAttribute(e,t){return  __set$(this.attributes,e,t) ,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return  __get$(this.attributes,e) !==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let t=new xW().getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return vK.makeRotationFromQuaternion(e),this.applyMatrix4(vK),this}rotateX(e){return vK.makeRotationX(e),this.applyMatrix4(vK),this}rotateY(e){return vK.makeRotationY(e),this.applyMatrix4(vK),this}rotateZ(e){return vK.makeRotationZ(e),this.applyMatrix4(vK),this}translate(e,t,n){return vK.makeTranslation(e,t,n),this.applyMatrix4(vK),this}scale(e,t,n){return vK.makeScale(e,t,n),this.applyMatrix4(vK),this}lookAt(e){return yK.lookAt(e),yK.updateMatrix(),this.applyMatrix4(yK.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bK).negate(),this.translate(bK.x,bK.y,bK.z),this}setFromPoints(e){let t=[];for(let n=0,r=e.length;n<r;n++){let r= __get$(e,n) ;t.push(r.x,r.y,r.z||0)}return this.setAttribute(`position`,new hK(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new GW);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error(`THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".`,this),this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){let n= __get$(t,e) ;xK.setFromBufferAttribute(n),this.morphTargetsRelative?(CK.addVectors(this.boundingBox.min,xK.min),this.boundingBox.expandByPoint(CK),CK.addVectors(this.boundingBox.max,xK.max),this.boundingBox.expandByPoint(CK)):(this.boundingBox.expandByPoint(xK.min),this.boundingBox.expandByPoint(xK.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error(`THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.`,this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new lG);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error(`THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".`,this),this.boundingSphere.set(new Q,1/0);return}if(e){let n=this.boundingSphere.center;if(xK.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){let n= __get$(t,e) ;SK.setFromBufferAttribute(n),this.morphTargetsRelative?(CK.addVectors(xK.min,SK.min),xK.expandByPoint(CK),CK.addVectors(xK.max,SK.max),xK.expandByPoint(CK)):(xK.expandByPoint(SK.min),xK.expandByPoint(SK.max))}xK.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)CK.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(CK));if(t)for(let i=0,a=t.length;i<a;i++){let a= __get$(t,i) ,o=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)CK.fromBufferAttribute(a,t),o&&(bK.fromBufferAttribute(e,t),CK.add(bK)),r=Math.max(r,n.distanceToSquared(CK))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error(`THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.`,this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error(`THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)`);return}let n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,o=r.length/3;this.hasAttribute(`tangent`)===!1&&this.setAttribute(`tangent`,new oK(new Float32Array(4*o),4));let s=this.getAttribute(`tangent`).array,c=[],l=[];for(let e=0;e<o;e++) __set$(c,e,new Q()) , __set$(l,e,new Q()) ;let u=new Q,d=new Q,f=new Q,p=new Z,m=new Z,h=new Z,g=new Q,_=new Q;function v(e,t,n){u.fromArray(r,e*3),d.fromArray(r,t*3),f.fromArray(r,n*3),p.fromArray(a,e*2),m.fromArray(a,t*2),h.fromArray(a,n*2),d.sub(u),f.sub(u),m.sub(p),h.sub(p);let i=1/(m.x*h.y-h.x*m.y);isFinite(i)&&(g.copy(d).multiplyScalar(h.y).addScaledVector(f,-m.y).multiplyScalar(i),_.copy(f).multiplyScalar(m.x).addScaledVector(d,-h.x).multiplyScalar(i), __get$(c,e) .add(g), __get$(c,t) .add(g), __get$(c,n) .add(g), __get$(l,e) .add(_), __get$(l,t) .add(_), __get$(l,n) .add(_))}let y=this.groups;y.length===0&&(y=[{start:0,count:n.length}]);for(let e=0,t=y.length;e<t;++e){let t= __get$(y,e) ,r=t.start,i=t.count;for(let e=r,t=r+i;e<t;e+=3)v( __get$(n,e+0) , __get$(n,e+1) , __get$(n,e+2) )}let b=new Q,x=new Q,S=new Q,C=new Q;function w(e){S.fromArray(i,e*3),C.copy(S);let t= __get$(c,e) ;b.copy(t),b.sub(S.multiplyScalar(S.dot(t))).normalize(),x.crossVectors(C,t);let n=x.dot( __get$(l,e) )<0?-1:1; __set$(s,e*4,b.x) , __set$(s,e*4+1,b.y) , __set$(s,e*4+2,b.z) , __set$(s,e*4+3,n) }for(let e=0,t=y.length;e<t;++e){let t= __get$(y,e) ,r=t.start,i=t.count;for(let e=r,t=r+i;e<t;e+=3)w( __get$(n,e+0) ),w( __get$(n,e+1) ),w( __get$(n,e+2) )}}computeVertexNormals(){let e=this.index,t=this.getAttribute(`position`);if(t!==void 0){let n=this.getAttribute(`normal`);if(n===void 0)n=new oK(new Float32Array(t.count*3),3),this.setAttribute(`normal`,n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);let r=new Q,i=new Q,a=new Q,o=new Q,s=new Q,c=new Q,l=new Q,u=new Q;if(e)for(let d=0,f=e.count;d<f;d+=3){let f=e.getX(d+0),p=e.getX(d+1),m=e.getX(d+2);r.fromBufferAttribute(t,f),i.fromBufferAttribute(t,p),a.fromBufferAttribute(t,m),l.subVectors(a,i),u.subVectors(r,i),l.cross(u),o.fromBufferAttribute(n,f),s.fromBufferAttribute(n,p),c.fromBufferAttribute(n,m),o.add(l),s.add(l),c.add(l),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(p,s.x,s.y,s.z),n.setXYZ(m,c.x,c.y,c.z)}else for(let e=0,o=t.count;e<o;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),l.subVectors(a,i),u.subVectors(r,i),l.cross(u),n.setXYZ(e+0,l.x,l.y,l.z),n.setXYZ(e+1,l.x,l.y,l.z),n.setXYZ(e+2,l.x,l.y,l.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error(`THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.`,e);return}t===void 0&&(t=0,console.warn(`THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.`));let n=this.attributes;for(let r in n){if( __get$(e.attributes,r) ===void 0)continue;let i= __get$(n,r) .array,a= __get$(e.attributes,r) ,o=a.array,s=a.itemSize*t,c=Math.min(o.length,i.length-s);for(let e=0,t=s;e<c;e++,t++) __set$(i,t,__get$(o,e)) }return this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)CK.fromBufferAttribute(e,t),CK.normalize(),e.setXYZ(t,CK.x,CK.y,CK.z)}toNonIndexed(){function t(e,t){let n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0;for(let i=0,c=t.length;i<c;i++){o=e.isInterleavedBufferAttribute? __get$(t,i) *e.data.stride+e.offset: __get$(t,i) *r;for(let e=0;e<r;e++) __set$(a,s++,__get$(n,o++)) }return new oK(a,r,i)}if(this.index===null)return console.warn(`THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.`),this;let n=new e,r=this.index.array,i=this.attributes;for(let e in i){let a= __get$(i,e) ,o=t(a,r);n.setAttribute(e,o)}let a=this.morphAttributes;for(let e in a){let i=[],o= __get$(a,e) ;for(let e=0,n=o.length;e<n;e++){let n= __get$(o,e) ,a=t(n,r);i.push(a)} __set$(n.morphAttributes,e,i) }n.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let e=0,t=o.length;e<t;e++){let t= __get$(o,e) ;n.addGroup(t.start,t.count,t.materialIndex)}return n}toJSON(){let e={metadata:{version:4.5,type:`BufferGeometry`,generator:`BufferGeometry.toJSON`}};if(e.uuid=this.uuid,e.type=this.type,this.name!==``&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let t=this.parameters;for(let n in t) __get$(t,n) !==void 0&&( __set$(e,n,__get$(t,n)) );return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let t in n){let r= __get$(n,t) ; __set$(e.data.attributes,t,r.toJSON(e.data)) }let r={},i=!1;for(let t in this.morphAttributes){let n= __get$(this.morphAttributes,t) ,a=[];for(let t=0,r=n.length;t<r;t++){let r= __get$(n,t) ;a.push(r.toJSON(e.data))}a.length>0&&( __set$(r,t,a) ,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone(t));let r=e.attributes;for(let e in r){let n= __get$(r,e) ;this.setAttribute(e,n.clone(t))}let i=e.morphAttributes;for(let e in i){let n=[],r= __get$(i,e) ;for(let e=0,i=r.length;e<i;e++)n.push( __get$(r,e) .clone(t)); __set$(this.morphAttributes,e,n) }this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let e=0,t=a.length;e<t;e++){let t= __get$(a,e) ;this.addGroup(t.start,t.count,t.materialIndex)}let o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());let s=e.boundingSphere;return s!==null&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters= __call$(Object,"assign",[{},e.parameters]) ),this}dispose(){this.dispatchEvent({type:`dispose`})}},wK.prototype.isBufferGeometry=!0,TK=new vG,EK=new _G,DK=new lG,OK=new Q,kK=new Q,AK=new Q,jK=new Q,MK=new Q,NK=new Q,PK=new Q,FK=new Q,IK=new Q,LK=new Z,RK=new Z,zK=new Z,BK=new Q,VK=new Q,HK=class extends UG{constructor(e=new wK,t=new rK){super(),this.type=`Mesh`,this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary= __call$(Object,"assign",[{},e.morphTargetDictionary]) ),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,n=Object.keys(t);if(n.length>0){let e= __get$(t,n[0]) ;if(e!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){let n= __get$(e,t) .name||String(t);this.morphTargetInfluences.push(0), __set$(this.morphTargetDictionary,n,t) }}}}else{let t=e.morphTargets;t!==void 0&&t.length>0&&console.error(`THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.`)}}raycast(e,t){let n=this.geometry,r=this.material,i=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),DK.copy(n.boundingSphere),DK.applyMatrix4(i),e.ray.intersectsSphere(DK)===!1)||(TK.copy(i).invert(),EK.copy(e.ray).applyMatrix4(TK),n.boundingBox!==null&&EK.intersectsBox(n.boundingBox)===!1))return;let a;if(n.isBufferGeometry){let i=n.index,o=n.attributes.position,s=n.morphAttributes.position,c=n.morphTargetsRelative,l=n.attributes.uv,u=n.attributes.uv2,d=n.groups,f=n.drawRange;if(i!==null)if(Array.isArray(r))for(let n=0,p=d.length;n<p;n++){let p= __get$(d,n) ,m= __get$(r,p.materialIndex) ,h=Math.max(p.start,f.start),g=Math.min(i.count,Math.min(p.start+p.count,f.start+f.count));for(let n=h,r=g;n<r;n+=3){let r=i.getX(n),d=i.getX(n+1),f=i.getX(n+2);a=fR(this,m,e,EK,o,s,c,l,u,r,d,f),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=p.materialIndex,t.push(a))}}else{let n=Math.max(0,f.start),d=Math.min(i.count,f.start+f.count);for(let f=n,p=d;f<p;f+=3){let n=i.getX(f),d=i.getX(f+1),p=i.getX(f+2);a=fR(this,r,e,EK,o,s,c,l,u,n,d,p),a&&(a.faceIndex=Math.floor(f/3),t.push(a))}}else if(o!==void 0)if(Array.isArray(r))for(let n=0,i=d.length;n<i;n++){let i= __get$(d,n) ,p= __get$(r,i.materialIndex) ,m=Math.max(i.start,f.start),h=Math.min(o.count,Math.min(i.start+i.count,f.start+f.count));for(let n=m,r=h;n<r;n+=3){let r=n,d=n+1,f=n+2;a=fR(this,p,e,EK,o,s,c,l,u,r,d,f),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=i.materialIndex,t.push(a))}}else{let n=Math.max(0,f.start),i=Math.min(o.count,f.start+f.count);for(let d=n,f=i;d<f;d+=3){let n=d,i=d+1,f=d+2;a=fR(this,r,e,EK,o,s,c,l,u,n,i,f),a&&(a.faceIndex=Math.floor(d/3),t.push(a))}}}else n.isGeometry&&console.error(`THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.`)}},HK.prototype.isMesh=!0,UK=class e extends wK{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type=`BoxGeometry`,this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};let o=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);let s=[],c=[],l=[],u=[],d=0,f=0;p(`z`,`y`,`x`,-1,-1,n,t,e,a,i,0),p(`z`,`y`,`x`,1,-1,n,t,-e,a,i,1),p(`x`,`z`,`y`,1,1,e,n,t,r,a,2),p(`x`,`z`,`y`,1,-1,e,n,-t,r,a,3),p(`x`,`y`,`z`,1,-1,e,t,n,r,i,4),p(`x`,`y`,`z`,-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.setAttribute(`position`,new hK(c,3)),this.setAttribute(`normal`,new hK(l,3)),this.setAttribute(`uv`,new hK(u,2));function p(e,t,n,r,i,a,p,m,h,g,_){let v=a/h,y=p/g,b=a/2,x=p/2,S=m/2,C=h+1,w=g+1,T=0,E=0,D=new Q;for(let a=0;a<w;a++){let o=a*y-x;for(let s=0;s<C;s++) __set$(D,e,(s*v-b)*r) , __set$(D,t,o*i) , __set$(D,n,S) ,c.push(D.x,D.y,D.z), __set$(D,e,0) , __set$(D,t,0) , __set$(D,n,m>0?1:-1) ,l.push(D.x,D.y,D.z),u.push(s/h),u.push(1-a/g),T+=1}for(let e=0;e<g;e++)for(let t=0;t<h;t++){let n=d+t+C*e,r=d+t+C*(e+1),i=d+(t+1)+C*(e+1),a=d+(t+1)+C*e;s.push(n,r,a),s.push(r,i,a),E+=6}o.addGroup(f,E,_),f+=E,d+=T}}static fromJSON(t){return new e(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}},WK={clone:pR,merge:mR},GK=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,KK=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,qK=class extends nK{constructor(e){super(),this.type=`ShaderMaterial`,this.defines={},this.uniforms={},this.vertexShader=GK,this.fragmentShader=KK,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error(`THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.`),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=pR(e.uniforms),this.defines= __call$(Object,"assign",[{},e.defines]) ,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions= __call$(Object,"assign",[{},e.extensions]) ,this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);for(let n in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){let r= __get$(this.uniforms,n) .value;r&&r.isTexture? __set$(t.uniforms,n,{type:`t`,value:r.toJSON(e).uuid}) :r&&r.isColor? __set$(t.uniforms,n,{type:`c`,value:r.getHex()}) :r&&r.isVector2? __set$(t.uniforms,n,{type:`v2`,value:r.toArray()}) :r&&r.isVector3? __set$(t.uniforms,n,{type:`v3`,value:r.toArray()}) :r&&r.isVector4? __set$(t.uniforms,n,{type:`v4`,value:r.toArray()}) :r&&r.isMatrix3? __set$(t.uniforms,n,{type:`m3`,value:r.toArray()}) :r&&r.isMatrix4? __set$(t.uniforms,n,{type:`m4`,value:r.toArray()}) : __set$(t.uniforms,n,{value:r}) }Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let n={};for(let e in this.extensions) __get$(this.extensions,e) ===!0&&( __set$(n,e,!0) );return Object.keys(n).length>0&&(t.extensions=n),t}},qK.prototype.isShaderMaterial=!0,JK=class extends UG{constructor(){super(),this.type=`Camera`,this.matrixWorldInverse=new vG,this.projectionMatrix=new vG,this.projectionMatrixInverse=new vG}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},JK.prototype.isCamera=!0,YK=class extends JK{constructor(e=50,t=1,n=.1,r=2e3){super(),this.type=`PerspectiveCamera`,this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null: __call$(Object,"assign",[{},e.view]) ,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=yW*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(vW*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return yW*2*Math.atan(Math.tan(vW*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(vW*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(this.view!==null&&this.view.enabled){let e=a.fullWidth,o=a.fullHeight;i+=a.offsetX*r/e,t-=a.offsetY*n/o,r*=a.width/e,n*=a.height/o}let o=this.filmOffset;o!==0&&(i+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view= __call$(Object,"assign",[{},this.view]) ),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},YK.prototype.isPerspectiveCamera=!0,XK=90,ZK=1,QK=class extends UG{constructor(e,t,n){if(super(),this.type=`CubeCamera`,n.isWebGLCubeRenderTarget!==!0){console.error(`THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.`);return}this.renderTarget=n;let r=new YK(XK,ZK,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Q(1,0,0)),this.add(r);let i=new YK(XK,ZK,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Q(-1,0,0)),this.add(i);let a=new YK(XK,ZK,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new Q(0,1,0)),this.add(a);let o=new YK(XK,ZK,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new Q(0,-1,0)),this.add(o);let s=new YK(XK,ZK,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Q(0,0,1)),this.add(s);let c=new YK(XK,ZK,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new Q(0,0,-1)),this.add(c)}update(e,t){this.parent===null&&this.updateMatrixWorld(); let n=this.renderTarget,_hh$temp1228=__arrayFrom$(this.children),r=_hh$temp1228[0],i=_hh$temp1228[1],a=_hh$temp1228[2],o=_hh$temp1228[3],s=_hh$temp1228[4],c=_hh$temp1228[5],l=e.getRenderTarget(),u=e.toneMapping,d=e.xr.enabled; e.toneMapping=tH,e.xr.enabled=!1;let f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,s),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(l),e.toneMapping=u,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}},$K=class extends PW{constructor(e,t,n,r,i,a,o,s,c,l){e=e===void 0?[]:e,t=t===void 0?cH:t,super(e,t,n,r,i,a,o,s,c,l),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},$K.prototype.isCubeTexture=!0,eq=class extends IW{constructor(e,t={}){super(e,e,t);let n={width:e,height:e,depth:1};this.texture=new $K([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps===void 0?!1:t.generateMipmaps,this.texture.minFilter=t.minFilter===void 0?xH:t.minFilter}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new UK(5,5,5),i=new qK({name:`CubemapFromEquirect`,uniforms:pR(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:yV,blending:SV});i.uniforms.tEquirect.value=t;let a=new HK(r,i),o=t.minFilter;return t.minFilter===1008&&(t.minFilter=xH),new QK(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,r){let i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(i)}},eq.prototype.isWebGLCubeRenderTarget=!0,tq=new Q,nq=new Q,rq=new xW,iq=class{constructor(e=new Q(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let r=tq.subVectors(n,t).cross(nq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let n=e.delta(tq),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||rq.getNormalMatrix(e),r=this.coplanarPoint(tq).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},iq.prototype.isPlane=!0,aq=new lG,oq=new Q,sq=class{constructor(e=new iq,t=new iq,n=new iq,r=new iq,i=new iq,a=new iq){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){let o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}copy(e){let t=this.planes;for(let n=0;n<6;n++) __get$(t,n) .copy( __get$(e.planes,n) );return this}setFromProjectionMatrix(e){let t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],c=n[5],l=n[6],u=n[7],d=n[8],f=n[9],p=n[10],m=n[11],h=n[12],g=n[13],_=n[14],v=n[15];return t[0].setComponents(o-r,u-s,m-d,v-h).normalize(),t[1].setComponents(o+r,u+s,m+d,v+h).normalize(),t[2].setComponents(o+i,u+c,m+f,v+g).normalize(),t[3].setComponents(o-i,u-c,m-f,v-g).normalize(),t[4].setComponents(o-a,u-l,m-p,v-_).normalize(),t[5].setComponents(o+a,u+l,m+p,v+_).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),aq.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(aq)}intersectsSprite(e){return aq.center.set(0,0,0),aq.radius=.7071067811865476,aq.applyMatrix4(e.matrixWorld),this.intersectsSphere(aq)}intersectsSphere(e){let t=this.planes,n=e.center,r=-e.radius;for(let e=0;e<6;e++)if( __get$(t,e) .distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let r= __get$(t,n) ;if(oq.x=r.normal.x>0?e.max.x:e.min.x,oq.y=r.normal.y>0?e.max.y:e.min.y,oq.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(oq)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if( __get$(t,n) .distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},cq=class e extends wK{constructor(e=1,t=1,n=1,r=1){super(),this.type=`PlaneGeometry`,this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};let i=e/2,a=t/2,o=Math.floor(n),s=Math.floor(r),c=o+1,l=s+1,u=e/o,d=t/s,f=[],p=[],m=[],h=[];for(let e=0;e<l;e++){let t=e*d-a;for(let n=0;n<c;n++){let r=n*u-i;p.push(r,-t,0),m.push(0,0,1),h.push(n/o),h.push(1-e/s)}}for(let e=0;e<s;e++)for(let t=0;t<o;t++){let n=t+c*e,r=t+c*(e+1),i=t+1+c*(e+1),a=t+1+c*e;f.push(n,r,a),f.push(r,i,a)}this.setIndex(f),this.setAttribute(`position`,new hK(p,3)),this.setAttribute(`normal`,new hK(m,3)),this.setAttribute(`uv`,new hK(h,2))}static fromJSON(t){return new e(t.width,t.height,t.widthSegments,t.heightSegments)}},lq={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment:`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:`vec3 transformed = vec3( position );`,beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:`gl_FragColor = linearToOutputTexel( gl_FragColor );`,encodings_pars_fragment:`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex:`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment:`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex:`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex:`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,output_fragment:`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`},uq={common:{diffuse:{value:new kW(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new xW},uv2Transform:{value:new xW},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Z(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new kW(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new kW(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new xW}},sprite:{diffuse:{value:new kW(16777215)},opacity:{value:1},center:{value:new Z(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new xW}}},dq={basic:{uniforms:mR([uq.common,uq.specularmap,uq.envmap,uq.aomap,uq.lightmap,uq.fog]),vertexShader:lq.meshbasic_vert,fragmentShader:lq.meshbasic_frag},lambert:{uniforms:mR([uq.common,uq.specularmap,uq.envmap,uq.aomap,uq.lightmap,uq.emissivemap,uq.fog,uq.lights,{emissive:{value:new kW(0)}}]),vertexShader:lq.meshlambert_vert,fragmentShader:lq.meshlambert_frag},phong:{uniforms:mR([uq.common,uq.specularmap,uq.envmap,uq.aomap,uq.lightmap,uq.emissivemap,uq.bumpmap,uq.normalmap,uq.displacementmap,uq.fog,uq.lights,{emissive:{value:new kW(0)},specular:{value:new kW(1118481)},shininess:{value:30}}]),vertexShader:lq.meshphong_vert,fragmentShader:lq.meshphong_frag},standard:{uniforms:mR([uq.common,uq.envmap,uq.aomap,uq.lightmap,uq.emissivemap,uq.bumpmap,uq.normalmap,uq.displacementmap,uq.roughnessmap,uq.metalnessmap,uq.fog,uq.lights,{emissive:{value:new kW(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:lq.meshphysical_vert,fragmentShader:lq.meshphysical_frag},toon:{uniforms:mR([uq.common,uq.aomap,uq.lightmap,uq.emissivemap,uq.bumpmap,uq.normalmap,uq.displacementmap,uq.gradientmap,uq.fog,uq.lights,{emissive:{value:new kW(0)}}]),vertexShader:lq.meshtoon_vert,fragmentShader:lq.meshtoon_frag},matcap:{uniforms:mR([uq.common,uq.bumpmap,uq.normalmap,uq.displacementmap,uq.fog,{matcap:{value:null}}]),vertexShader:lq.meshmatcap_vert,fragmentShader:lq.meshmatcap_frag},points:{uniforms:mR([uq.points,uq.fog]),vertexShader:lq.points_vert,fragmentShader:lq.points_frag},dashed:{uniforms:mR([uq.common,uq.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:lq.linedashed_vert,fragmentShader:lq.linedashed_frag},depth:{uniforms:mR([uq.common,uq.displacementmap]),vertexShader:lq.depth_vert,fragmentShader:lq.depth_frag},normal:{uniforms:mR([uq.common,uq.bumpmap,uq.normalmap,uq.displacementmap,{opacity:{value:1}}]),vertexShader:lq.meshnormal_vert,fragmentShader:lq.meshnormal_frag},sprite:{uniforms:mR([uq.sprite,uq.fog]),vertexShader:lq.sprite_vert,fragmentShader:lq.sprite_frag},background:{uniforms:{uvTransform:{value:new xW},t2D:{value:null}},vertexShader:lq.background_vert,fragmentShader:lq.background_frag},cube:{uniforms:mR([uq.envmap,{opacity:{value:1}}]),vertexShader:lq.cube_vert,fragmentShader:lq.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:lq.equirect_vert,fragmentShader:lq.equirect_frag},distanceRGBA:{uniforms:mR([uq.common,uq.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:lq.distanceRGBA_vert,fragmentShader:lq.distanceRGBA_frag},shadow:{uniforms:mR([uq.lights,uq.fog,{color:{value:new kW(0)},opacity:{value:1}}]),vertexShader:lq.shadow_vert,fragmentShader:lq.shadow_frag}},dq.physical={uniforms:mR([dq.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Z(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new kW(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Z},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new kW(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new kW(1,1,1)},specularColorMap:{value:null}}]),vertexShader:lq.meshphysical_vert,fragmentShader:lq.meshphysical_frag},fq=class extends JK{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.type=`OrthographicCamera`,this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null: __call$(Object,"assign",[{},e.view]) ,this}setViewOffset(e,t,n,r,i,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(this.view!==null&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,o-=t*this.view.offsetY,s=o-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view= __call$(Object,"assign",[{},this.view]) ),t}},fq.prototype.isOrthographicCamera=!0,pq=4,mq=[.125,.215,.35,.446,.526,.582],hq=20,gq=new fq,_q=new kW,vq=null,yq=(1+Math.sqrt(5))/2,bq=1/yq,xq=[new Q(1,1,1),new Q(-1,1,1),new Q(1,1,-1),new Q(-1,1,-1),new Q(0,yq,bq),new Q(0,yq,-bq),new Q(bq,0,yq),new Q(-bq,0,yq),new Q(yq,bq,0),new Q(-yq,bq,0)],Sq=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){vq=this._renderer.getRenderTarget(),this._setSize(256);let i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=OR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=DR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=2**this._lodMax}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++) __get$(this._lodPlanes,e) .dispose()}_cleanup(e){this._renderer.setRenderTarget(vq),e.scissorTest=!1,TR(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===cH||e.mapping===lH?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),vq=this._renderer.getRenderTarget();let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:xH,minFilter:xH,generateMipmaps:!1,type:NH,format:zH,encoding:NU,depthBuffer:!1},r=wR(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){ var _hh$temp1230; this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=wR(e,t,n); let _hh$temp1229=this,r=_hh$temp1229._lodMax; ( _hh$temp1230=CR(r),this._sizeLods=_hh$temp1230.sizeLods,this._lodPlanes=_hh$temp1230.lodPlanes,this._sigmas=_hh$temp1230.sigmas,_hh$temp1230 ),this._blurMaterial=ER(r,e,t)}return r}_compileMaterial(e){let t=new HK(this._lodPlanes[0],e);this._renderer.compile(t,gq)}_sceneToCubeUV(e,t,n,r){let i=new YK(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,c=s.autoClear,l=s.toneMapping;s.getClearColor(_q),s.toneMapping=tH,s.autoClear=!1;let u=new rK({name:`PMREM.Background`,side:yV,depthWrite:!1,depthTest:!1}),d=new HK(new UK,u),f=!1,p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,f=!0):(u.color.copy(_q),f=!0);for(let t=0;t<6;t++){let n=t%3;n===0?(i.up.set(0, __get$(a,t) ,0),i.lookAt( __get$(o,t) ,0,0)):n===1?(i.up.set(0,0, __get$(a,t) ),i.lookAt(0, __get$(o,t) ,0)):(i.up.set(0, __get$(a,t) ,0),i.lookAt(0,0, __get$(o,t) ));let c=this._cubeSize;TR(r,n*c,t>2?c:0,c,c),s.setRenderTarget(r),f&&s.render(d,i),s.render(e,i)}d.geometry.dispose(),d.material.dispose(),s.toneMapping=l,s.autoClear=c,e.background=p}_textureToCubeUV(e,t){let n=this._renderer,r=e.mapping===cH||e.mapping===lH;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=OR()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=DR());let i=r?this._cubemapMaterial:this._equirectMaterial,a=new HK(this._lodPlanes[0],i),o=i.uniforms;o.envMap.value=e;let s=this._cubeSize;TR(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(a,gq)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let t=1;t<this._lodPlanes.length;t++){let n=Math.sqrt( __get$(this._sigmas,t) * __get$(this._sigmas,t) - __get$(this._sigmas,t-1) * __get$(this._sigmas,t-1) ),r= __get$(xq,(t-1)%xq.length) ;this._blur(e,t-1,t,n,r)}t.autoClear=n}_blur(e,t,n,r,i){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,`latitudinal`,i),this._halfBlur(a,e,n,n,r,`longitudinal`,i)}_halfBlur(e,t,n,r,i,a,o){let s=this._renderer,c=this._blurMaterial;a!==`latitudinal`&&a!==`longitudinal`&&console.error(`blur direction must be either latitudinal or longitudinal!`);let l= new HK(__get$(this._lodPlanes,r),c) ,u=c.uniforms,d= __get$(this._sizeLods,n) -1,f=isFinite(i)?Math.PI/(2*d):2*Math.PI/(2*hq-1),p=i/f,m=isFinite(i)?1+Math.floor(3*p):hq;m>hq&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${hq}`);let h=[],g=0;for(let e=0;e<hq;++e){let t=e/p,n=Math.exp(-t*t/2);h.push(n),e===0?g+=n:e<m&&(g+=2*n)}for(let e=0;e<h.length;e++) __set$(h,e,__get$(h,e)/g) ;u.envMap.value=e.texture,u.samples.value=m,u.weights.value=h,u.latitudinal.value=a===`latitudinal`,o&&(u.poleAxis.value=o); let _hh$temp1231=this,_=_hh$temp1231._lodMax; u.dTheta.value=f,u.mipInt.value=_-n;let v= __get$(this._sizeLods,r) ;TR(t,3*v*(r>_-pq?r-_+pq:0),4*(this._cubeSize-v),3*v,2*v),s.setRenderTarget(t),s.render(l,gq)}},Cq=new PW,wq=new LW,Tq=new zW,Eq=new $K,Dq=[],Oq=[],kq=new Float32Array(16),Aq=new Float32Array(9),jq=new Float32Array(4),Mz.prototype.setValue=function(e,t,n){let r=this.seq;for(let i=0,a=r.length;i!==a;++i){let a= __get$(r,i) ;a.setValue(e, __get$(t,a.id) ,n)}},Mq=/(\w+)(\])?(\[|\.)?/g,Fz.prototype.setValue=function(e,t,n,r){let i= __get$(this.map,t) ;i!==void 0&&i.setValue(e,n,r)},Fz.prototype.setOptional=function(e,t,n){let r= __get$(t,n) ;r!==void 0&&this.setValue(e,n,r)},Fz.upload=function(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){let a= __get$(t,i) ,o= __get$(n,a.id) ;o.needsUpdate!==!1&&a.setValue(e,o.value,r)}},Fz.seqWithValue=function(e,t){let n=[];for(let r=0,i=e.length;r!==i;++r){let i= __get$(e,r) ;i.id in t&&n.push(i)}return n},Nq=0,Pq=/^[ \t]*#include +<([\w\d./]+)>/gm,Fq=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Iq=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g,Lq=0,Rq=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(i)===!1&&(a.add(i),i.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let e of t)e.usedTimes--,e.usedTimes===0&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){let t=this.shaderCache;if(t.has(e)===!1){let n=new zq(e);t.set(e,n)}return t.get(e)}},zq=class{constructor(e){this.id=Lq++,this.code=e,this.usedTimes=0}},Bq=0,Vq=class extends nK{constructor(e){super(),this.type=`MeshDepthMaterial`,this.depthPacking=FU,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Vq.prototype.isMeshDepthMaterial=!0,Hq=class extends nK{constructor(e){super(),this.type=`MeshDistanceMaterial`,this.referencePosition=new Q,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Hq.prototype.isMeshDistanceMaterial=!0,Uq=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Wq=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,Gq=class extends YK{constructor(e=[]){super(),this.cameras=e}},Gq.prototype.isArrayCamera=!0,Kq=class extends UG{constructor(){super(),this.type=`Group`}},Kq.prototype.isGroup=!0,qq={type:`move`},Jq=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Kq,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Kq,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Kq,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:`disconnected`,data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null,o=this._targetRay,s=this._grip,c=this._hand;if(e&&t.session.visibilityState!==`visible-blurred`)if(o!==null&&(r=t.getPose(e.targetRaySpace,n),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(qq))),c&&e.hand){a=!0;for(let r of e.hand.values()){let e=t.getJointPose(r,n);if( __get$(c.joints,r.jointName) ===void 0){let e=new Kq;e.matrixAutoUpdate=!1,e.visible=!1, __set$(c.joints,r.jointName,e) ,c.add(e)}let i= __get$(c.joints,r.jointName) ;e!==null&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=e.radius),i.visible=e!==null}let r= __get$(c.joints,`index-finger-tip`) ,i= __get$(c.joints,`thumb-tip`) ,o=r.position.distanceTo(i.position),s=.02,l=.005;c.inputState.pinching&&o>s+l?(c.inputState.pinching=!1,this.dispatchEvent({type:`pinchend`,handedness:e.handedness,target:this})):!c.inputState.pinching&&o<=s-l&&(c.inputState.pinching=!0,this.dispatchEvent({type:`pinchstart`,handedness:e.handedness,target:this}))}else s!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1));return o!==null&&(o.visible=r!==null),s!==null&&(s.visible=i!==null),c!==null&&(c.visible=a!==null),this}},Yq=class extends PW{constructor(e,t,n,r,i,a,o,s,c,l){if(l=l===void 0?HH:l,l!==HH&&l!==UH)throw Error(`DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat`);n===void 0&&l===HH&&(n=kH),n===void 0&&l===UH&&(n=IH),super(null,r,i,a,o,s,l,n,c),this.image={width:e,height:t},this.magFilter=o===void 0?gH:o,this.minFilter=s===void 0?gH:s,this.flipY=!1,this.generateMipmaps=!1}},Yq.prototype.isDepthTexture=!0,Xq=class extends hW{constructor(e,t){super();let n=this,r=null,i=1,a=null,o=`local-floor`,s=null,c=null,l=null,u=null,d=null,f=null,p=t.getContextAttributes(),m=null,h=null,g=[],_=new Map,v=new YK;v.layers.enable(1),v.viewport=new FW;let y=new YK;y.layers.enable(2),y.viewport=new FW;let b=[v,y],x=new Gq;x.layers.enable(1),x.layers.enable(2);let S=null,C=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t= __get$(g,e) ;return t===void 0&&(t=new Jq, __set$(g,e,t) ),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t= __get$(g,e) ;return t===void 0&&(t=new Jq, __set$(g,e,t) ),t.getGripSpace()},this.getHand=function(e){let t= __get$(g,e) ;return t===void 0&&(t=new Jq, __set$(g,e,t) ),t.getHandSpace()};function w(e){let t=_.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function T(){_.forEach(function(e,t){e.disconnect(t)}),_.clear(),S=null,C=null,e.setRenderTarget(m),d=null,u=null,l=null,r=null,h=null,M.stop(),n.isPresenting=!1,n.dispatchEvent({type:`sessionend`})}this.setFramebufferScaleFactor=function(e){i=e,n.isPresenting===!0&&console.warn(`THREE.WebXRManager: Cannot change framebuffer scale while presenting.`)},this.setReferenceSpaceType=function(e){o=e,n.isPresenting===!0&&console.warn(`THREE.WebXRManager: Cannot change reference space type while presenting.`)},this.getReferenceSpace=function(){return s||a},this.setReferenceSpace=function(e){s=e},this.getBaseLayer=function(){return u===null?d:u},this.getBinding=function(){return l},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(s){if(r=s,r!==null){if(m=e.getRenderTarget(),r.addEventListener(`select`,w),r.addEventListener(`selectstart`,w),r.addEventListener(`selectend`,w),r.addEventListener(`squeeze`,w),r.addEventListener(`squeezestart`,w),r.addEventListener(`squeezeend`,w),r.addEventListener(`end`,T),r.addEventListener(`inputsourceschange`,E),p.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let n={antialias:r.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:d}),h=new IW(d.framebufferWidth,d.framebufferHeight,{format:zH,type:EH,encoding:e.outputEncoding})}else{let n=null,a=null,o=null;p.depth&&(o=p.stencil?35056:33190,n=p.stencil?UH:HH,a=p.stencil?IH:kH);let s={colorFormat:e.outputEncoding===3001?35907:32856,depthFormat:o,scaleFactor:i};l=new XRWebGLBinding(r,t),u=l.createProjectionLayer(s),r.updateRenderState({layers:[u]}),h=new IW(u.textureWidth,u.textureHeight,{format:zH,type:EH,depthTexture:new Yq(u.textureWidth,u.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});let c=e.properties.get(h);c.__ignoreDepthValues=u.ignoreDepthValues}h.isXRRenderTarget=!0,this.setFoveation(1),a=await r.requestReferenceSpace(o),M.setContext(r),M.start(),n.isPresenting=!0,n.dispatchEvent({type:`sessionstart`})}};function E(e){let t=r.inputSources;for(let e=0;e<t.length;e++){let n= __get$(t,e) .handedness===`right`?1:0;_.set( __get$(t,e) , __get$(g,n) )}for(let t=0;t<e.removed.length;t++){let n= __get$(e.removed,t) ,r=_.get(n);r&&(r.dispatchEvent({type:`disconnected`,data:n}),_.delete(n))}for(let t=0;t<e.added.length;t++){let n= __get$(e.added,t) ,r=_.get(n);r&&r.dispatchEvent({type:`connected`,data:n})}}let D=new Q,O=new Q;function k(e,t,n){D.setFromMatrixPosition(t.matrixWorld),O.setFromMatrixPosition(n.matrixWorld);let r=D.distanceTo(O),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),c=(i[9]+1)/i[5],l=(i[9]-1)/i[5],u=(i[8]-1)/i[0],d=(a[8]+1)/a[0],f=o*u,p=o*d,m=r/(-u+d),h=m*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(h),e.translateZ(m),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();let g=o+m,_=s+m,v=f-h,y=p+(r-h),b=c*s/_*g,x=l*s/_*g;e.projectionMatrix.makePerspective(v,y,b,x,g,_)}function ee(e,t){t===null?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(r===null)return;x.near=y.near=v.near=e.near,x.far=y.far=v.far=e.far,(S!==x.near||C!==x.far)&&(r.updateRenderState({depthNear:x.near,depthFar:x.far}),S=x.near,C=x.far);let t=e.parent,n=x.cameras;ee(x,t);for(let e=0;e<n.length;e++)ee( __get$(n,e) ,t);x.matrixWorld.decompose(x.position,x.quaternion,x.scale),e.position.copy(x.position),e.quaternion.copy(x.quaternion),e.scale.copy(x.scale),e.matrix.copy(x.matrix),e.matrixWorld.copy(x.matrixWorld);let i=e.children;for(let e=0,t=i.length;e<t;e++) __get$(i,e) .updateMatrixWorld(!0);n.length===2?k(x,v,y):x.projectionMatrix.copy(v.projectionMatrix)},this.getCamera=function(){return x},this.getFoveation=function(){if(u!==null)return u.fixedFoveation;if(d!==null)return d.fixedFoveation},this.setFoveation=function(e){u!==null&&(u.fixedFoveation=e),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=e)};let A=null;function j(t,n){if(c=n.getViewerPose(s||a),f=n,c!==null){let t=c.views;d!==null&&(e.setRenderTargetFramebuffer(h,d.framebuffer),e.setRenderTarget(h));let n=!1;t.length!==x.cameras.length&&(x.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){let i= __get$(t,r) ,a=null;if(d!==null)a=d.getViewport(i);else{let t=l.getViewSubImage(u,i);a=t.viewport,r===0&&(e.setRenderTargetTextures(h,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(h))}let o= __get$(b,r) ;o.matrix.fromArray(i.transform.matrix),o.projectionMatrix.fromArray(i.projectionMatrix),o.viewport.set(a.x,a.y,a.width,a.height),r===0&&x.matrix.copy(o.matrix),n===!0&&x.cameras.push(o)}}let i=r.inputSources;for(let e=0;e<g.length;e++){let t= __get$(i,e) ,r=_.get(t);r!==void 0&&r.update(t,n,s||a)}A&&A(t,n),f=null}let M=new hR;M.setAnimationLoop(j),this.setAnimationLoop=function(e){A=e},this.dispose=function(){}}},_B.prototype.isWebGLRenderer=!0,Zq=class extends _B{},Zq.prototype.isWebGL1Renderer=!0,Qq=class e{constructor(e,t=25e-5){this.name=``,this.color=new kW(e),this.density=t}clone(){return new e(this.color,this.density)}toJSON(){return{type:`FogExp2`,color:this.color.getHex(),density:this.density}}},Qq.prototype.isFogExp2=!0,$q=class e{constructor(e,t=1,n=1e3){this.name=``,this.color=new kW(e),this.near=t,this.far=n}clone(){return new e(this.color,this.near,this.far)}toJSON(){return{type:`Fog`,color:this.color.getHex(),near:this.near,far:this.far}}},$q.prototype.isFog=!0,eJ=class extends UG{constructor(){super(),this.type=`Scene`,this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<`u`&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent(`observe`,{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}},eJ.prototype.isScene=!0,tJ=class{constructor(e,t){this.array=e,this.stride=t,this.count=e===void 0?0:e.length/t,this.usage=rW,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=PL()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++) __set$(this.array,e+r,__get$(t.array,n+r)) ;return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=PL()), __get$(e.arrayBuffers,this.array.buffer._uuid) ===void 0&&( __set$(e.arrayBuffers,this.array.buffer._uuid,this.array.slice(0).buffer) );let t= new this.array.constructor(__get$(e.arrayBuffers,this.array.buffer._uuid)) ,n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=PL()), __get$(e.arrayBuffers,this.array.buffer._uuid) ===void 0&&( __set$(e.arrayBuffers,this.array.buffer._uuid,Array.prototype.slice.call(new Uint32Array(this.array.buffer))) ),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},tJ.prototype.isInterleavedBuffer=!0,nJ=new Q,rJ=class e{constructor(e,t,n,r=!1){this.name=``,this.data=e,this.itemSize=t,this.offset=n,this.normalized=r===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)nJ.fromBufferAttribute(this,t),nJ.applyMatrix4(e),this.setXYZ(t,nJ.x,nJ.y,nJ.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)nJ.fromBufferAttribute(this,t),nJ.applyNormalMatrix(e),this.setXYZ(t,nJ.x,nJ.y,nJ.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)nJ.fromBufferAttribute(this,t),nJ.transformDirection(e),this.setXYZ(t,nJ.x,nJ.y,nJ.z);return this}setX(e,t){return  __set$(this.data.array,e*this.data.stride+this.offset,t) ,this}setY(e,t){return  __set$(this.data.array,e*this.data.stride+this.offset+1,t) ,this}setZ(e,t){return  __set$(this.data.array,e*this.data.stride+this.offset+2,t) ,this}setW(e,t){return  __set$(this.data.array,e*this.data.stride+this.offset+3,t) ,this}getX(e){return  __get$(this.data.array,e*this.data.stride+this.offset) }getY(e){return  __get$(this.data.array,e*this.data.stride+this.offset+1) }getZ(e){return  __get$(this.data.array,e*this.data.stride+this.offset+2) }getW(e){return  __get$(this.data.array,e*this.data.stride+this.offset+3) }setXY(e,t,n){return e=e*this.data.stride+this.offset, __set$(this.data.array,e+0,t) , __set$(this.data.array,e+1,n) ,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset, __set$(this.data.array,e+0,t) , __set$(this.data.array,e+1,n) , __set$(this.data.array,e+2,r) ,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset, __set$(this.data.array,e+0,t) , __set$(this.data.array,e+1,n) , __set$(this.data.array,e+2,r) , __set$(this.data.array,e+3,i) ,this}clone(t){if(t===void 0){console.log(`THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.`);let e=[];for(let t=0;t<this.count;t++){let n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push( __get$(this.data.array,n+t) )}return new oK(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}), __get$(t.interleavedBuffers,this.data.uuid) ===void 0&&( __set$(t.interleavedBuffers,this.data.uuid,this.data.clone(t)) ), new e(__get$(t.interleavedBuffers,this.data.uuid),this.itemSize,this.offset,this.normalized) }toJSON(e){if(e===void 0){console.log(`THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.`);let e=[];for(let t=0;t<this.count;t++){let n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push( __get$(this.data.array,n+t) )}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}), __get$(e.interleavedBuffers,this.data.uuid) ===void 0&&( __set$(e.interleavedBuffers,this.data.uuid,this.data.toJSON(e)) ),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},rJ.prototype.isInterleavedBufferAttribute=!0,iJ=class extends nK{constructor(e){super(),this.type=`SpriteMaterial`,this.color=new kW(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},iJ.prototype.isSpriteMaterial=!0,oJ=new Q,sJ=new Q,cJ=new Q,lJ=new Z,uJ=new Z,dJ=new vG,fJ=new Q,pJ=new Q,mJ=new Q,hJ=new Z,gJ=new Z,_J=new Z,vJ=class extends UG{constructor(e){if(super(),this.type=`Sprite`,aJ===void 0){aJ=new wK;let e=new tJ(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);aJ.setIndex([0,1,2,0,2,3]),aJ.setAttribute(`position`,new rJ(e,3,0,!1)),aJ.setAttribute(`uv`,new rJ(e,2,3,!1))}this.geometry=aJ,this.material=e===void 0?new iJ:e,this.center=new Z(.5,.5)}raycast(e,t){e.camera===null&&console.error(`THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.`),sJ.setFromMatrixScale(this.matrixWorld),dJ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),cJ.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&sJ.multiplyScalar(-cJ.z);let n=this.material.rotation,r,i;n!==0&&(i=Math.cos(n),r=Math.sin(n));let a=this.center;vB(fJ.set(-.5,-.5,0),cJ,a,sJ,r,i),vB(pJ.set(.5,-.5,0),cJ,a,sJ,r,i),vB(mJ.set(.5,.5,0),cJ,a,sJ,r,i),hJ.set(0,0),gJ.set(1,0),_J.set(1,1);let o=e.ray.intersectTriangle(fJ,pJ,mJ,!1,oJ);if(o===null&&(vB(pJ.set(-.5,.5,0),cJ,a,sJ,r,i),gJ.set(0,1),o=e.ray.intersectTriangle(fJ,mJ,pJ,!1,oJ),o===null))return;let s=e.ray.origin.distanceTo(oJ);s<e.near||s>e.far||t.push({distance:s,point:oJ.clone(),uv:eK.getUV(oJ,fJ,pJ,mJ,hJ,gJ,_J,new Z),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}},vJ.prototype.isSprite=!0,yJ=new Q,bJ=new Q,xJ=class extends UG{constructor(){super(),this._currentLevel=0,this.type=`LOD`,Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let e=0,n=t.length;e<n;e++){let n= __get$(t,e) ;this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);let n=this.levels,r;for(r=0;r<n.length&&!(t< __get$(n,r) .distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r&&!(e< __get$(t,n) .distance);n++);return  __get$(t,n-1) .object}return null}raycast(e,t){if(this.levels.length>0){yJ.setFromMatrixPosition(this.matrixWorld);let n=e.ray.origin.distanceTo(yJ);this.getObjectForDistance(n).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){yJ.setFromMatrixPosition(e.matrixWorld),bJ.setFromMatrixPosition(this.matrixWorld);let n=yJ.distanceTo(bJ)/e.zoom;t[0].object.visible=!0;let r,i;for(r=1,i=t.length;r<i&&n>= __get$(t,r) .distance;r++) __get$(t,r-1) .object.visible=!1, __get$(t,r) .object.visible=!0;for(this._currentLevel=r-1;r<i;r++) __get$(t,r) .object.visible=!1}}toJSON(e){let t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];let n=this.levels;for(let e=0,r=n.length;e<r;e++){let r= __get$(n,e) ;t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}},SJ=new Q,CJ=new FW,wJ=new FW,TJ=new Q,EJ=new vG,DJ=class extends HK{constructor(e,t){super(e,t),this.type=`SkinnedMesh`,this.bindMode=`attached`,this.bindMatrix=new vG,this.bindMatrixInverse=new vG}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new FW,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);let r=1/e.manhattanLength();r===1/0?e.set(1,0,0,0):e.multiplyScalar(r),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===`attached`?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===`detached`?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn(`THREE.SkinnedMesh: Unrecognized bindMode: `+this.bindMode)}boneTransform(e,t){let n=this.skeleton,r=this.geometry;CJ.fromBufferAttribute(r.attributes.skinIndex,e),wJ.fromBufferAttribute(r.attributes.skinWeight,e),SJ.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){let r=wJ.getComponent(e);if(r!==0){let i=CJ.getComponent(e);EJ.multiplyMatrices( __get$(n.bones,i) .matrixWorld, __get$(n.boneInverses,i) ),t.addScaledVector(TJ.copy(SJ).applyMatrix4(EJ),r)}}return t.applyMatrix4(this.bindMatrixInverse)}},DJ.prototype.isSkinnedMesh=!0,OJ=class extends UG{constructor(){super(),this.type=`Bone`}},OJ.prototype.isBone=!0,kJ=class extends PW{constructor(e=null,t=1,n=1,r,i,a,o,s,c=gH,l=gH,u,d){super(null,a,o,s,c,l,r,i,u,d),this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},kJ.prototype.isDataTexture=!0,AJ=new vG,jJ=new vG,MJ=class e{constructor(e=[],t=[]){this.uuid=PL(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn(`THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.`),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new vG)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new vG; __get$(this.bones,e) &&t.copy( __get$(this.bones,e) .matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t= __get$(this.bones,e) ;t&&t.matrixWorld.copy( __get$(this.boneInverses,e) ).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t= __get$(this.bones,e) ;t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let r=0,i=e.length;r<i;r++){let i= __get$(e,r) ? __get$(e,r) .matrixWorld:jJ;AJ.multiplyMatrices(i, __get$(t,r) ),AJ.toArray(n,r*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new e(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=ZL(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new kJ(t,e,e,zH,MH);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let n= __get$(this.bones,t) ;if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){let r= __get$(e.bones,n) ,i= __get$(t,r) ;i===void 0&&(console.warn(`THREE.Skeleton: No bone found with UUID:`,r),i=new OJ),this.bones.push(i),this.boneInverses.push(new vG().fromArray( __get$(e.boneInverses,n) ))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:`Skeleton`,generator:`Skeleton.toJSON`},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){let i= __get$(t,r) ;e.bones.push(i.uuid);let a= __get$(n,r) ;e.boneInverses.push(a.toArray())}return e}},NJ=class extends oK{constructor(e,t,n,r=1){typeof n==`number`&&(r=n,n=!1,console.error(`THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.`)),super(e,t,n),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},NJ.prototype.isInstancedBufferAttribute=!0,PJ=new vG,FJ=new vG,IJ=[],LJ=new HK,RJ=class extends HK{constructor(e,t,n){super(e,t),this.instanceMatrix=new NJ(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let n=this.matrixWorld,r=this.count;if(LJ.geometry=this.geometry,LJ.material=this.material,LJ.material!==void 0)for(let i=0;i<r;i++){this.getMatrixAt(i,PJ),FJ.multiplyMatrices(n,PJ),LJ.matrixWorld=FJ,LJ.raycast(e,IJ);for(let e=0,n=IJ.length;e<n;e++){let n= __get$(IJ,e) ;n.instanceId=i,n.object=this,t.push(n)}IJ.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new NJ(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:`dispose`})}},RJ.prototype.isInstancedMesh=!0,zJ=class extends nK{constructor(e){super(),this.type=`LineBasicMaterial`,this.color=new kW(16777215),this.linewidth=1,this.linecap=`round`,this.linejoin=`round`,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},zJ.prototype.isLineBasicMaterial=!0,BJ=new Q,VJ=new Q,HJ=new vG,UJ=new _G,WJ=new lG,GJ=class extends UG{constructor(e=new wK,t=new zJ){super(),this.type=`Line`,this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.isBufferGeometry)if(e.index===null){let t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)BJ.fromBufferAttribute(t,e-1),VJ.fromBufferAttribute(t,e), __set$(n,e,__get$(n,e-1)) , __set$(n,e,__get$(n,e)+BJ.distanceTo(VJ)) ;e.setAttribute(`lineDistance`,new hK(n,1))}else console.warn(`THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.`);else e.isGeometry&&console.error(`THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.`);return this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),WJ.copy(n.boundingSphere),WJ.applyMatrix4(r),WJ.radius+=i,e.ray.intersectsSphere(WJ)===!1)return;HJ.copy(r).invert(),UJ.copy(e.ray).applyMatrix4(HJ);let o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,c=new Q,l=new Q,u=new Q,d=new Q,f=this.isLineSegments?2:1;if(n.isBufferGeometry){let r=n.index,i=n.attributes.position;if(r!==null){let n=Math.max(0,a.start),o=Math.min(r.count,a.start+a.count);for(let a=n,p=o-1;a<p;a+=f){let n=r.getX(a),o=r.getX(a+1);if(c.fromBufferAttribute(i,n),l.fromBufferAttribute(i,o),UJ.distanceSqToSegment(c,l,d,u)>s)continue;d.applyMatrix4(this.matrixWorld);let f=e.ray.origin.distanceTo(d);f<e.near||f>e.far||t.push({distance:f,point:u.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this})}}else{let n=Math.max(0,a.start),r=Math.min(i.count,a.start+a.count);for(let a=n,o=r-1;a<o;a+=f){if(c.fromBufferAttribute(i,a),l.fromBufferAttribute(i,a+1),UJ.distanceSqToSegment(c,l,d,u)>s)continue;d.applyMatrix4(this.matrixWorld);let n=e.ray.origin.distanceTo(d);n<e.near||n>e.far||t.push({distance:n,point:u.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error(`THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.`)}updateMorphTargets(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,n=Object.keys(t);if(n.length>0){let e= __get$(t,n[0]) ;if(e!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){let n= __get$(e,t) .name||String(t);this.morphTargetInfluences.push(0), __set$(this.morphTargetDictionary,n,t) }}}}else{let t=e.morphTargets;t!==void 0&&t.length>0&&console.error(`THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.`)}}},GJ.prototype.isLine=!0,KJ=new Q,qJ=new Q,JJ=class extends GJ{constructor(e,t){super(e,t),this.type=`LineSegments`}computeLineDistances(){let e=this.geometry;if(e.isBufferGeometry)if(e.index===null){let t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)KJ.fromBufferAttribute(t,e),qJ.fromBufferAttribute(t,e+1), __set$(n,e,e===0?0:__get$(n,e-1)) , __set$(n,e+1,__get$(n,e)+KJ.distanceTo(qJ)) ;e.setAttribute(`lineDistance`,new hK(n,1))}else console.warn(`THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.`);else e.isGeometry&&console.error(`THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.`);return this}},JJ.prototype.isLineSegments=!0,YJ=class extends GJ{constructor(e,t){super(e,t),this.type=`LineLoop`}},YJ.prototype.isLineLoop=!0,XJ=class extends nK{constructor(e){super(),this.type=`PointsMaterial`,this.color=new kW(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},XJ.prototype.isPointsMaterial=!0,ZJ=new vG,QJ=new _G,$J=new lG,eY=new Q,tY=class extends UG{constructor(e=new wK,t=new XJ){super(),this.type=`Points`,this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),$J.copy(n.boundingSphere),$J.applyMatrix4(r),$J.radius+=i,e.ray.intersectsSphere($J)===!1)return;ZJ.copy(r).invert(),QJ.copy(e.ray).applyMatrix4(ZJ);let o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o;if(n.isBufferGeometry){let i=n.index,o=n.attributes.position;if(i!==null){let n=Math.max(0,a.start),c=Math.min(i.count,a.start+a.count);for(let a=n,l=c;a<l;a++){let n=i.getX(a);eY.fromBufferAttribute(o,n),yB(eY,n,s,r,e,t,this)}}else{let n=Math.max(0,a.start),i=Math.min(o.count,a.start+a.count);for(let a=n,c=i;a<c;a++)eY.fromBufferAttribute(o,a),yB(eY,a,s,r,e,t,this)}}else console.error(`THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.`)}updateMorphTargets(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,n=Object.keys(t);if(n.length>0){let e= __get$(t,n[0]) ;if(e!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){let n= __get$(e,t) .name||String(t);this.morphTargetInfluences.push(0), __set$(this.morphTargetDictionary,n,t) }}}}else{let t=e.morphTargets;t!==void 0&&t.length>0&&console.error(`THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.`)}}},tY.prototype.isPoints=!0,nY=class extends PW{constructor(e,t,n,r,i,a,o,s,c){super(e,t,n,r,i,a,o,s,c),this.minFilter=a===void 0?xH:a,this.magFilter=i===void 0?xH:i,this.generateMipmaps=!1;let l=this;function u(){l.needsUpdate=!0,e.requestVideoFrameCallback(u)}`requestVideoFrameCallback`in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!(`requestVideoFrameCallback`in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},nY.prototype.isVideoTexture=!0,rY=class extends PW{constructor(e,t,n){super({width:e,height:t}),this.format=n,this.magFilter=gH,this.minFilter=gH,this.generateMipmaps=!1,this.needsUpdate=!0}},rY.prototype.isFramebufferTexture=!0,iY=class extends PW{constructor(e,t,n,r,i,a,o,s,c,l,u,d){super(null,a,o,s,c,l,r,i,u,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}},iY.prototype.isCompressedTexture=!0,aY=class extends PW{constructor(e,t,n,r,i,a,o,s,c){super(e,t,n,r,i,a,o,s,c),this.needsUpdate=!0}},aY.prototype.isCanvasTexture=!0,oY=class{constructor(){this.type=`Curve`,this.arcLengthDivisions=200}getPoint(){return console.warn(`THREE.Curve: .getPoint() not implemented.`),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return  __get$(e,e.length-1) }getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n=this.getLengths(),r=0,i=n.length,a;a=t||e* __get$(n,i-1) ;let o=0,s=i-1,c;for(;o<=s;)if(r=Math.floor(o+(s-o)/2),c= __get$(n,r) -a,c<0)o=r+1;else if(c>0)s=r-1;else{s=r;break}if(r=s, __get$(n,r) ===a)return r/(i-1);let l= __get$(n,r) ,u= __get$(n,r+1) -l,d=(a-l)/u;return(r+d)/(i-1)}getTangent(e,t){let n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);let a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new Z:new Q);return s.copy(o).sub(a).normalize(),s}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new Q,r=[],i=[],a=[],o=new Q,s=new vG;for(let t=0;t<=e;t++){let n=t/e; __set$(r,t,this.getTangentAt(n,new Q())) }i[0]=new Q,a[0]=new Q;let c=Number.MAX_VALUE,l=Math.abs(r[0].x),u=Math.abs(r[0].y),d=Math.abs(r[0].z);l<=c&&(c=l,n.set(1,0,0)),u<=c&&(c=u,n.set(0,1,0)),d<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(let t=1;t<=e;t++){if( __set$(i,t,__get$(i,t-1).clone()) , __set$(a,t,__get$(a,t-1).clone()) ,o.crossVectors( __get$(r,t-1) , __get$(r,t) ),o.length()>2**-52){o.normalize();let e=Math.acos(FL( __get$(r,t-1) .dot( __get$(r,t) ),-1,1)); __get$(i,t) .applyMatrix4(s.makeRotationAxis(o,e))} __get$(a,t) .crossVectors( __get$(r,t) , __get$(i,t) )}if(t===!0){let t=Math.acos(FL(i[0].dot( __get$(i,e) ),-1,1));t/=e,r[0].dot(o.crossVectors(i[0], __get$(i,e) ))>0&&(t=-t);for(let n=1;n<=e;n++) __get$(i,n) .applyMatrix4(s.makeRotationAxis( __get$(r,n) ,t*n)), __get$(a,n) .crossVectors( __get$(r,n) , __get$(i,n) )}return{tangents:r,normals:i,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:`Curve`,generator:`Curve.toJSON`}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},sY=class extends oY{constructor(e=0,t=0,n=1,r=1,i=0,a=Math.PI*2,o=!1,s=0){super(),this.type=`EllipseCurve`,this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}getPoint(e,t){let n=t||new Z,r=Math.PI*2,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<2**-52;for(;i<0;)i+=r;for(;i>r;)i-=r;i<2**-52&&(i=a?0:r),this.aClockwise===!0&&!a&&(i===r?i=-r:i-=r);let o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=s-this.aX,r=c-this.aY;s=n*e-r*t+this.aX,c=n*t+r*e+this.aY}return n.set(s,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},sY.prototype.isEllipseCurve=!0,cY=class extends sY{constructor(e,t,n,r,i,a){super(e,t,n,n,r,i,a),this.type=`ArcCurve`}},cY.prototype.isArcCurve=!0,lY=new Q,uY=new bB,dY=new bB,fY=new bB,pY=class extends oY{constructor(e=[],t=!1,n=`centripetal`,r=.5){super(),this.type=`CatmullRomCurve3`,this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Q){let n=t,r=this.points,i=r.length,a=(i-(this.closed?0:1))*e,o=Math.floor(a),s=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/i)+1)*i:s===0&&o===i-1&&(o=i-2,s=1);let c,l;this.closed||o>0?c= __get$(r,(o-1)%i) :(lY.subVectors(r[0],r[1]).add(r[0]),c=lY);let u= __get$(r,o%i) ,d= __get$(r,(o+1)%i) ;if(this.closed||o+2<i?l= __get$(r,(o+2)%i) :(lY.subVectors( __get$(r,i-1) , __get$(r,i-2) ).add( __get$(r,i-1) ),l=lY),this.curveType===`centripetal`||this.curveType===`chordal`){let e=this.curveType===`chordal`?.5:.25,t=c.distanceToSquared(u)**+e,n=u.distanceToSquared(d)**+e,r=d.distanceToSquared(l)**+e;n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),uY.initNonuniformCatmullRom(c.x,u.x,d.x,l.x,t,n,r),dY.initNonuniformCatmullRom(c.y,u.y,d.y,l.y,t,n,r),fY.initNonuniformCatmullRom(c.z,u.z,d.z,l.z,t,n,r)}else this.curveType===`catmullrom`&&(uY.initCatmullRom(c.x,u.x,d.x,l.x,this.tension),dY.initCatmullRom(c.y,u.y,d.y,l.y,this.tension),fY.initCatmullRom(c.z,u.z,d.z,l.z,this.tension));return n.set(uY.calc(s),dY.calc(s),fY.calc(s)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n= __get$(e.points,t) ;this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let n= __get$(this.points,t) ;e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n= __get$(e.points,t) ;this.points.push(new Q().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},pY.prototype.isCatmullRomCurve3=!0,mY=class extends oY{constructor(e=new Z,t=new Z,n=new Z,r=new Z){super(),this.type=`CubicBezierCurve`,this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Z){let n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(CB(e,r.x,i.x,a.x,o.x),CB(e,r.y,i.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},mY.prototype.isCubicBezierCurve=!0,hY=class extends oY{constructor(e=new Q,t=new Q,n=new Q,r=new Q){super(),this.type=`CubicBezierCurve3`,this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Q){let n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(CB(e,r.x,i.x,a.x,o.x),CB(e,r.y,i.y,a.y,o.y),CB(e,r.z,i.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},hY.prototype.isCubicBezierCurve3=!0,gY=class extends oY{constructor(e=new Z,t=new Z){super(),this.type=`LineCurve`,this.v1=e,this.v2=t}getPoint(e,t=new Z){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let n=t||new Z;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},gY.prototype.isLineCurve=!0,_Y=class extends oY{constructor(e=new Q,t=new Q){super(),this.type=`LineCurve3`,this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new Q){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},vY=class extends oY{constructor(e=new Z,t=new Z,n=new Z){super(),this.type=`QuadraticBezierCurve`,this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Z){let n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(SB(e,r.x,i.x,a.x),SB(e,r.y,i.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},vY.prototype.isQuadraticBezierCurve=!0,yY=class extends oY{constructor(e=new Q,t=new Q,n=new Q){super(),this.type=`QuadraticBezierCurve3`,this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Q){let n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(SB(e,r.x,i.x,a.x),SB(e,r.y,i.y,a.y),SB(e,r.z,i.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},yY.prototype.isQuadraticBezierCurve3=!0,bY=class extends oY{constructor(e=[]){super(),this.type=`SplineCurve`,this.points=e}getPoint(e,t=new Z){let n=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s= __get$(r,a===0?a:a-1) ,c= __get$(r,a) ,l= __get$(r,a>r.length-2?r.length-1:a+1) ,u= __get$(r,a>r.length-3?r.length-1:a+2) ;return n.set(xB(o,s.x,c.x,l.x,u.x),xB(o,s.y,c.y,l.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n= __get$(e.points,t) ;this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let n= __get$(this.points,t) ;e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n= __get$(e.points,t) ;this.points.push(new Z().fromArray(n))}return this}},bY.prototype.isSplineCurve=!0,xY=Object.freeze({__proto__:null,ArcCurve:cY,CatmullRomCurve3:pY,CubicBezierCurve:mY,CubicBezierCurve3:hY,EllipseCurve:sY,LineCurve:gY,LineCurve3:_Y,QuadraticBezierCurve:vY,QuadraticBezierCurve3:yY,SplineCurve:bY}),SY=class extends oY{constructor(){super(),this.type=`CurvePath`,this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t= __get$(this.curves,this.curves.length-1) .getPoint(1);e.equals(t)||this.curves.push(new gY(t,e))}getPoint(e,t){let n=e*this.getLength(),r=this.getCurveLengths(),i=0;for(;i<r.length;){if( __get$(r,i) >=n){let e= __get$(r,i) -n,a= __get$(this.curves,i) ,o=a.getLength(),s=o===0?0:1-e/o;return a.getPointAt(s,t)}i++}return null}getLength(){let e=this.getCurveLengths();return  __get$(e,e.length-1) }updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,r=this.curves.length;n<r;n++)t+= __get$(this.curves,n) .getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],n;for(let r=0,i=this.curves;r<i.length;r++){let a= __get$(i,r) ,o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o);for(let e=0;e<s.length;e++){let r= __get$(s,e) ;n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&! __get$(t,t.length-1) .equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let n= __get$(e.curves,t) ;this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let n= __get$(this.curves,t) ;e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let n= __get$(e.curves,t) ;this.curves.push(new xY[n.type]().fromJSON(n))}return this}},CY=class extends SY{constructor(e){super(),this.type=`Path`,this.currentPoint=new Z,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo( __get$(e,t) .x, __get$(e,t) .y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new gY(this.currentPoint.clone(),new Z(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){let i=new vY(this.currentPoint.clone(),new Z(e,t),new Z(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,a){let o=new mY(this.currentPoint.clone(),new Z(e,t),new Z(n,r),new Z(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}splineThru(e){let t=new bY([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy( __get$(e,e.length-1) ),this}arc(e,t,n,r,i,a){let o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}absarc(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}ellipse(e,t,n,r,i,a,o,s){let c=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(e+c,t+l,n,r,i,a,o,s),this}absellipse(e,t,n,r,i,a,o,s){let c=new sY(e,t,n,r,i,a,o,s);if(this.curves.length>0){let e=c.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(c);let l=c.getPoint(1);return this.currentPoint.copy(l),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},wY=class e extends wK{constructor(e=[new Z(0,.5),new Z(.5,0),new Z(0,-.5)],t=12,n=0,r=Math.PI*2){super(),this.type=`LatheGeometry`,this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=FL(r,0,Math.PI*2);let i=[],a=[],o=[],s=[],c=[],l=1/t,u=new Q,d=new Z,f=new Q,p=new Q,m=new Q,h=0,g=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:h= __get$(e,t+1) .x- __get$(e,t) .x,g= __get$(e,t+1) .y- __get$(e,t) .y,f.x=g*1,f.y=-h,f.z=g*0,m.copy(f),f.normalize(),s.push(f.x,f.y,f.z);break;case e.length-1:s.push(m.x,m.y,m.z);break;default:h= __get$(e,t+1) .x- __get$(e,t) .x,g= __get$(e,t+1) .y- __get$(e,t) .y,f.x=g*1,f.y=-h,f.z=g*0,p.copy(f),f.x+=m.x,f.y+=m.y,f.z+=m.z,f.normalize(),s.push(f.x,f.y,f.z),m.copy(p)}for(let i=0;i<=t;i++){let f=n+i*l*r,p=Math.sin(f),m=Math.cos(f);for(let n=0;n<=e.length-1;n++){u.x= __get$(e,n) .x*p,u.y= __get$(e,n) .y,u.z= __get$(e,n) .x*m,a.push(u.x,u.y,u.z),d.x=i/t,d.y=n/(e.length-1),o.push(d.x,d.y);let r= __get$(s,3*n+0) *p,l= __get$(s,3*n+1) ,f= __get$(s,3*n+0) *m;c.push(r,l,f)}}for(let n=0;n<t;n++)for(let t=0;t<e.length-1;t++){let r=t+n*e.length,a=r,o=r+e.length,s=r+e.length+1,c=r+1;i.push(a,o,c),i.push(s,c,o)}this.setIndex(i),this.setAttribute(`position`,new hK(a,3)),this.setAttribute(`uv`,new hK(o,2)),this.setAttribute(`normal`,new hK(c,3))}static fromJSON(t){return new e(t.points,t.segments,t.phiStart,t.phiLength)}},TY=class e extends wY{constructor(e=1,t=1,n=4,r=8){let i=new CY;i.absarc(0,-t/2,e,Math.PI*1.5,0),i.absarc(0,t/2,e,0,Math.PI*.5),super(i.getPoints(n),r),this.type=`CapsuleGeometry`,this.parameters={radius:e,height:t,capSegments:n,radialSegments:r}}static fromJSON(t){return new e(t.radius,t.length,t.capSegments,t.radialSegments)}},EY=class e extends wK{constructor(e=1,t=8,n=0,r=Math.PI*2){super(),this.type=`CircleGeometry`,this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);let i=[],a=[],o=[],s=[],c=new Q,l=new Z;a.push(0,0,0),o.push(0,0,1),s.push(.5,.5);for(let i=0,u=3;i<=t;i++,u+=3){let d=n+i/t*r;c.x=e*Math.cos(d),c.y=e*Math.sin(d),a.push(c.x,c.y,c.z),o.push(0,0,1),l.x=( __get$(a,u) /e+1)/2,l.y=( __get$(a,u+1) /e+1)/2,s.push(l.x,l.y)}for(let e=1;e<=t;e++)i.push(e,e+1,0);this.setIndex(i),this.setAttribute(`position`,new hK(a,3)),this.setAttribute(`normal`,new hK(o,3)),this.setAttribute(`uv`,new hK(s,2))}static fromJSON(t){return new e(t.radius,t.segments,t.thetaStart,t.thetaLength)}},DY=class e extends wK{constructor(e=1,t=1,n=1,r=8,i=1,a=!1,o=0,s=Math.PI*2){super(),this.type=`CylinderGeometry`,this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};let c=this;r=Math.floor(r),i=Math.floor(i);let l=[],u=[],d=[],f=[],p=0,m=[],h=n/2,g=0;_(),a===!1&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(l),this.setAttribute(`position`,new hK(u,3)),this.setAttribute(`normal`,new hK(d,3)),this.setAttribute(`uv`,new hK(f,2));function _(){let a=new Q,_=new Q,v=0,y=(t-e)/n;for(let c=0;c<=i;c++){let l=[],g=c/i,v=g*(t-e)+e;for(let e=0;e<=r;e++){let t=e/r,i=t*s+o,c=Math.sin(i),m=Math.cos(i);_.x=v*c,_.y=-g*n+h,_.z=v*m,u.push(_.x,_.y,_.z),a.set(c,y,m).normalize(),d.push(a.x,a.y,a.z),f.push(t,1-g),l.push(p++)}m.push(l)}for(let e=0;e<r;e++)for(let t=0;t<i;t++){let n= __get$(__get$(m,t),e) ,r= __get$(__get$(m,t+1),e) ,i= __get$(__get$(m,t+1),e+1) ,a= __get$(__get$(m,t),e+1) ;l.push(n,r,a),l.push(r,i,a),v+=6}c.addGroup(g,v,0),g+=v}function v(n){let i=p,a=new Z,m=new Q,_=0,v=n===!0?e:t,y=n===!0?1:-1;for(let e=1;e<=r;e++)u.push(0,h*y,0),d.push(0,y,0),f.push(.5,.5),p++;let b=p;for(let e=0;e<=r;e++){let t=e/r*s+o,n=Math.cos(t),i=Math.sin(t);m.x=v*i,m.y=h*y,m.z=v*n,u.push(m.x,m.y,m.z),d.push(0,y,0),a.x=n*.5+.5,a.y=i*.5*y+.5,f.push(a.x,a.y),p++}for(let e=0;e<r;e++){let t=i+e,r=b+e;n===!0?l.push(r,r+1,t):l.push(r+1,r,t),_+=3}c.addGroup(g,_,n===!0?1:2),g+=_}}static fromJSON(t){return new e(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},OY=class e extends DY{constructor(e=1,t=1,n=8,r=1,i=!1,a=0,o=Math.PI*2){super(0,e,t,n,r,i,a,o),this.type=`ConeGeometry`,this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}static fromJSON(t){return new e(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},kY=class e extends wK{constructor(e=[],t=[],n=1,r=0){super(),this.type=`PolyhedronGeometry`,this.parameters={vertices:e,indices:t,radius:n,detail:r};let i=[],a=[];o(r),c(n),l(),this.setAttribute(`position`,new hK(i,3)),this.setAttribute(`normal`,new hK(i.slice(),3)),this.setAttribute(`uv`,new hK(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function o(e){let n=new Q,r=new Q,i=new Q;for(let a=0;a<t.length;a+=3)f( __get$(t,a+0) ,n),f( __get$(t,a+1) ,r),f( __get$(t,a+2) ,i),s(n,r,i,e)}function s(e,t,n,r){let i=r+1,a=[];for(let r=0;r<=i;r++){ __set$(a,r,[]) ;let o=e.clone().lerp(n,r/i),s=t.clone().lerp(n,r/i),c=i-r;for(let e=0;e<=c;e++)e===0&&r===i? __set$(__get$(a,r),e,o) : __set$(__get$(a,r),e,o.clone().lerp(s,e/c)) }for(let e=0;e<i;e++)for(let t=0;t<2*(i-e)-1;t++){let n=Math.floor(t/2);t%2==0?(d( __get$(__get$(a,e),n+1) ),d( __get$(__get$(a,e+1),n) ),d( __get$(__get$(a,e),n) )):(d( __get$(__get$(a,e),n+1) ),d( __get$(__get$(a,e+1),n+1) ),d( __get$(__get$(a,e+1),n) ))}}function c(e){let t=new Q;for(let n=0;n<i.length;n+=3)t.x= __get$(i,n+0) ,t.y= __get$(i,n+1) ,t.z= __get$(i,n+2) ,t.normalize().multiplyScalar(e), __set$(i,n+0,t.x) , __set$(i,n+1,t.y) , __set$(i,n+2,t.z) }function l(){let e=new Q;for(let t=0;t<i.length;t+=3){e.x= __get$(i,t+0) ,e.y= __get$(i,t+1) ,e.z= __get$(i,t+2) ;let n=h(e)/2/Math.PI+.5,r=g(e)/Math.PI+.5;a.push(n,1-r)}p(),u()}function u(){for(let e=0;e<a.length;e+=6){let t= __get$(a,e+0) ,n= __get$(a,e+2) ,r= __get$(a,e+4) ;Math.max(t,n,r)>.9&&Math.min(t,n,r)<.1&&(t<.2&&( __set$(a,e+0,__get$(a,e+0)+1) ),n<.2&&( __set$(a,e+2,__get$(a,e+2)+1) ),r<.2&&( __set$(a,e+4,__get$(a,e+4)+1) ))}}function d(e){i.push(e.x,e.y,e.z)}function f(t,n){let r=t*3;n.x= __get$(e,r+0) ,n.y= __get$(e,r+1) ,n.z= __get$(e,r+2) }function p(){let e=new Q,t=new Q,n=new Q,r=new Q,o=new Z,s=new Z,c=new Z;for(let l=0,u=0;l<i.length;l+=9,u+=6){e.set( __get$(i,l+0) , __get$(i,l+1) , __get$(i,l+2) ),t.set( __get$(i,l+3) , __get$(i,l+4) , __get$(i,l+5) ),n.set( __get$(i,l+6) , __get$(i,l+7) , __get$(i,l+8) ),o.set( __get$(a,u+0) , __get$(a,u+1) ),s.set( __get$(a,u+2) , __get$(a,u+3) ),c.set( __get$(a,u+4) , __get$(a,u+5) ),r.copy(e).add(t).add(n).divideScalar(3);let d=h(r);m(o,u+0,e,d),m(s,u+2,t,d),m(c,u+4,n,d)}}function m(e,t,n,r){r<0&&e.x===1&&( __set$(a,t,e.x-1) ),n.x===0&&n.z===0&&( __set$(a,t,r/2/Math.PI+.5) )}function h(e){return Math.atan2(e.z,-e.x)}function g(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}}static fromJSON(t){return new e(t.vertices,t.indices,t.radius,t.details)}},AY=class e extends kY{constructor(e=1,t=0){let n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];super(i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type=`DodecahedronGeometry`,this.parameters={radius:e,detail:t}}static fromJSON(t){return new e(t.radius,t.detail)}},jY=new Q,MY=new Q,NY=new Q,PY=new eK,FY=class extends wK{constructor(e=null,t=1){if(super(),this.type=`EdgesGeometry`,this.parameters={geometry:e,thresholdAngle:t},e!==null){let n=10**4,r=Math.cos(vW*t),i=e.getIndex(),a=e.getAttribute(`position`),o=i?i.count:a.count,s=[0,0,0],c=[`a`,`b`,`c`],l=[,,,],u={},d=[];for(let e=0;e<o;e+=3){i?(s[0]=i.getX(e),s[1]=i.getX(e+1),s[2]=i.getX(e+2)):(s[0]=e,s[1]=e+1,s[2]=e+2); let _hh$temp1232=PY,t=_hh$temp1232.a,o=_hh$temp1232.b,f=_hh$temp1232.c; if(t.fromBufferAttribute(a,s[0]),o.fromBufferAttribute(a,s[1]),f.fromBufferAttribute(a,s[2]),PY.getNormal(NY),l[0]=`${Math.round(t.x*n)},${Math.round(t.y*n)},${Math.round(t.z*n)}`,l[1]=`${Math.round(o.x*n)},${Math.round(o.y*n)},${Math.round(o.z*n)}`,l[2]=`${Math.round(f.x*n)},${Math.round(f.y*n)},${Math.round(f.z*n)}`,!(l[0]===l[1]||l[1]===l[2]||l[2]===l[0]))for(let e=0;e<3;e++){let t=(e+1)%3,n= __get$(l,e) ,i= __get$(l,t) ,a= __get$(PY,__get$(c,e)) ,o= __get$(PY,__get$(c,t)) ,f=`${n}_${i}`,p=`${i}_${n}`;p in u&& __get$(u,p) ?(NY.dot( __get$(u,p) .normal)<=r&&(d.push(a.x,a.y,a.z),d.push(o.x,o.y,o.z)), __set$(u,p,null) ):f in u||( __set$(u,f,{index0:__get$(s,e),index1:__get$(s,t),normal:NY.clone()}) )}}for(let e in u)if( __get$(u,e) ){ let _hh$temp1233=__get$(u,e),t=_hh$temp1233.index0,n=_hh$temp1233.index1; jY.fromBufferAttribute(a,t),MY.fromBufferAttribute(a,n),d.push(jY.x,jY.y,jY.z),d.push(MY.x,MY.y,MY.z)}this.setAttribute(`position`,new hK(d,3))}}},IY=class extends CY{constructor(e){super(e),this.uuid=PL(),this.type=`Shape`,this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,r=this.holes.length;n<r;n++) __set$(t,n,__get$(this.holes,n).getPoints(e)) ;return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let n= __get$(e.holes,t) ;this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let n= __get$(this.holes,t) ;e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let n= __get$(e.holes,t) ;this.holes.push(new CY().fromJSON(n))}return this}},LY={triangulate:function(e,t,n=2){let r=t&&t.length,i=r?t[0]*n:e.length,a=wB(e,0,i,n,!0),o=[];if(!a||a.next===a.prev)return o;let s,c,l,u,d,f,p;if(r&&(a=Fee(e,t,a,n)),e.length>80*n){s=l=e[0],c=u=e[1];for(let t=n;t<i;t+=n)d= __get$(e,t) ,f= __get$(e,t+1) ,d<s&&(s=d),f<c&&(c=f),d>l&&(l=d),f>u&&(u=f);p=Math.max(l-s,u-c),p=p===0?0:1/p}return EB(a,o,n,s,c,p),o}},RY=class e{static area(e){let t=e.length,n=0;for(let r=t-1,i=0;i<t;r=i++)n+= __get$(e,r) .x* __get$(e,i) .y- __get$(e,i) .x* __get$(e,r) .y;return n*.5}static isClockWise(t){return e.area(t)<0}static triangulateShape(e,t){let n=[],r=[],i=[];HB(e),UB(n,e);let a=e.length;t.forEach(HB);for(let e=0;e<t.length;e++)r.push(a),a+= __get$(t,e) .length,UB(n, __get$(t,e) );let o=LY.triangulate(n,r);for(let e=0;e<o.length;e+=3)i.push(o.slice(e,e+3));return i}},zY=class e extends wK{constructor(e=new IY([new Z(.5,.5),new Z(-.5,.5),new Z(-.5,-.5),new Z(.5,-.5)]),t={}){super(),this.type=`ExtrudeGeometry`,this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let n=this,r=[],i=[];for(let t=0,n=e.length;t<n;t++){let n= __get$(e,t) ;a(n)}this.setAttribute(`position`,new hK(r,3)),this.setAttribute(`uv`,new hK(i,2)),this.computeVertexNormals();function a(e){let a=[],o=t.curveSegments===void 0?12:t.curveSegments,s=t.steps===void 0?1:t.steps,c=t.depth===void 0?1:t.depth,l=t.bevelEnabled===void 0?!0:t.bevelEnabled,u=t.bevelThickness===void 0?.2:t.bevelThickness,d=t.bevelSize===void 0?u-.1:t.bevelSize,f=t.bevelOffset===void 0?0:t.bevelOffset,p=t.bevelSegments===void 0?3:t.bevelSegments,m=t.extrudePath,h=t.UVGenerator===void 0?BY:t.UVGenerator;t.amount!==void 0&&(console.warn(`THREE.ExtrudeBufferGeometry: amount has been renamed to depth.`),c=t.amount);let g,_=!1,v,y,b,x;m&&(g=m.getSpacedPoints(s),_=!0,l=!1,v=m.computeFrenetFrames(s,!1),y=new Q,b=new Q,x=new Q),l||(p=0,u=0,d=0,f=0);let S=e.extractPoints(o),C=S.shape,w=S.holes;if(!RY.isClockWise(C)){C=C.reverse();for(let e=0,t=w.length;e<t;e++){let t= __get$(w,e) ;RY.isClockWise(t)&&( __set$(w,e,t.reverse()) )}}let T=RY.triangulateShape(C,w),E=C;for(let e=0,t=w.length;e<t;e++){let t= __get$(w,e) ;C=C.concat(t)}function D(e,t,n){return t||console.error(`THREE.ExtrudeGeometry: vec does not exist`),t.clone().multiplyScalar(n).add(e)}let O=C.length,k=T.length;function ee(e,t,n){let r,i,a,o=e.x-t.x,s=e.y-t.y,c=n.x-e.x,l=n.y-e.y,u=o*o+s*s,d=o*l-s*c;if(Math.abs(d)>2**-52){let d=Math.sqrt(u),f=Math.sqrt(c*c+l*l),p=t.x-s/d,m=t.y+o/d,h=n.x-l/f,g=n.y+c/f,_=((h-p)*l-(g-m)*c)/(o*l-s*c);r=p+o*_-e.x,i=m+s*_-e.y;let v=r*r+i*i;if(v<=2)return new Z(r,i);a=Math.sqrt(v/2)}else{let e=!1;o>2**-52?c>2**-52&&(e=!0):o<-(2**-52)?c<-(2**-52)&&(e=!0):Math.sign(s)===Math.sign(l)&&(e=!0),e?(r=-s,i=o,a=Math.sqrt(u)):(r=o,i=s,a=Math.sqrt(u/2))}return new Z(r/a,i/a)}let A=[];for(let e=0,t=E.length,n=t-1,r=e+1;e<t;e++,n++,r++)n===t&&(n=0),r===t&&(r=0), __set$(A,e,ee(__get$(E,e),__get$(E,n),__get$(E,r))) ;let j=[],M,N=A.concat();for(let e=0,t=w.length;e<t;e++){let t= __get$(w,e) ;M=[];for(let e=0,n=t.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0), __set$(M,e,ee(__get$(t,e),__get$(t,r),__get$(t,i))) ;j.push(M),N=N.concat(M)}for(let e=0;e<p;e++){let t=e/p,n=u*Math.cos(t*Math.PI/2),r=d*Math.sin(t*Math.PI/2)+f;for(let e=0,t=E.length;e<t;e++){let t=D( __get$(E,e) , __get$(A,e) ,r);I(t.x,t.y,-n)}for(let e=0,t=w.length;e<t;e++){let t= __get$(w,e) ;M= __get$(j,e) ;for(let e=0,i=t.length;e<i;e++){let i=D( __get$(t,e) , __get$(M,e) ,r);I(i.x,i.y,-n)}}}let P=d+f;for(let e=0;e<O;e++){let t=l?D( __get$(C,e) , __get$(N,e) ,P): __get$(C,e) ;_?(b.copy(v.normals[0]).multiplyScalar(t.x),y.copy(v.binormals[0]).multiplyScalar(t.y),x.copy(g[0]).add(b).add(y),I(x.x,x.y,x.z)):I(t.x,t.y,0)}for(let e=1;e<=s;e++)for(let t=0;t<O;t++){let n=l?D( __get$(C,t) , __get$(N,t) ,P): __get$(C,t) ;_?(b.copy( __get$(v.normals,e) ).multiplyScalar(n.x),y.copy( __get$(v.binormals,e) ).multiplyScalar(n.y),x.copy( __get$(g,e) ).add(b).add(y),I(x.x,x.y,x.z)):I(n.x,n.y,c/s*e)}for(let e=p-1;e>=0;e--){let t=e/p,n=u*Math.cos(t*Math.PI/2),r=d*Math.sin(t*Math.PI/2)+f;for(let e=0,t=E.length;e<t;e++){let t=D( __get$(E,e) , __get$(A,e) ,r);I(t.x,t.y,c+n)}for(let e=0,t=w.length;e<t;e++){let t= __get$(w,e) ;M= __get$(j,e) ;for(let e=0,i=t.length;e<i;e++){let i=D( __get$(t,e) , __get$(M,e) ,r);_?I(i.x,i.y+ __get$(g,s-1) .y, __get$(g,s-1) .x+n):I(i.x,i.y,c+n)}}}te(),F();function te(){let e=r.length/3;if(l){let e=0,t=O*e;for(let e=0;e<k;e++){let n= __get$(T,e) ;re(n[2]+t,n[1]+t,n[0]+t)}e=s+p*2,t=O*e;for(let e=0;e<k;e++){let n= __get$(T,e) ;re(n[0]+t,n[1]+t,n[2]+t)}}else{for(let e=0;e<k;e++){let t= __get$(T,e) ;re(t[2],t[1],t[0])}for(let e=0;e<k;e++){let t= __get$(T,e) ;re(t[0]+O*s,t[1]+O*s,t[2]+O*s)}}n.addGroup(e,r.length/3-e,0)}function F(){let e=r.length/3,t=0;ne(E,t),t+=E.length;for(let e=0,n=w.length;e<n;e++){let n= __get$(w,e) ;ne(n,t),t+=n.length}n.addGroup(e,r.length/3-e,1)}function ne(e,t){let n=e.length;for(;--n>=0;){let r=n,i=n-1;i<0&&(i=e.length-1);for(let e=0,n=s+p*2;e<n;e++){let n=O*e,a=O*(e+1);ie(t+r+n,t+i+n,t+i+a,t+r+a)}}}function I(e,t,n){a.push(e),a.push(t),a.push(n)}function re(e,t,i){L(e),L(t),L(i);let a=r.length/3,o=h.generateTopUV(n,r,a-3,a-2,a-1);R(o[0]),R(o[1]),R(o[2])}function ie(e,t,i,a){L(e),L(t),L(a),L(t),L(i),L(a);let o=r.length/3,s=h.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);R(s[0]),R(s[1]),R(s[3]),R(s[1]),R(s[2]),R(s[3])}function L(e){r.push( __get$(a,e*3+0) ),r.push( __get$(a,e*3+1) ),r.push( __get$(a,e*3+2) )}function R(e){i.push(e.x),i.push(e.y)}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return WB(t,n,e)}static fromJSON(t,n){let r=[];for(let e=0,i=t.shapes.length;e<i;e++){let i= __get$(n,__get$(t.shapes,e)) ;r.push(i)}let i=t.options.extrudePath;return i!==void 0&&(t.options.extrudePath=new xY[i.type]().fromJSON(i)),new e(r,t.options)}},BY={generateTopUV:function(e,t,n,r,i){let a= __get$(t,n*3) ,o= __get$(t,n*3+1) ,s= __get$(t,r*3) ,c= __get$(t,r*3+1) ,l= __get$(t,i*3) ,u= __get$(t,i*3+1) ;return[new Z(a,o),new Z(s,c),new Z(l,u)]},generateSideWallUV:function(e,t,n,r,i,a){let o= __get$(t,n*3) ,s= __get$(t,n*3+1) ,c= __get$(t,n*3+2) ,l= __get$(t,r*3) ,u= __get$(t,r*3+1) ,d= __get$(t,r*3+2) ,f= __get$(t,i*3) ,p= __get$(t,i*3+1) ,m= __get$(t,i*3+2) ,h= __get$(t,a*3) ,g= __get$(t,a*3+1) ,_= __get$(t,a*3+2) ;return Math.abs(s-u)<Math.abs(o-l)?[new Z(o,1-c),new Z(l,1-d),new Z(f,1-m),new Z(h,1-_)]:[new Z(s,1-c),new Z(u,1-d),new Z(p,1-m),new Z(g,1-_)]}},VY=class e extends kY{constructor(e=1,t=0){let n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];super(r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type=`IcosahedronGeometry`,this.parameters={radius:e,detail:t}}static fromJSON(t){return new e(t.radius,t.detail)}},HY=class e extends kY{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type=`OctahedronGeometry`,this.parameters={radius:e,detail:t}}static fromJSON(t){return new e(t.radius,t.detail)}},UY=class e extends wK{constructor(e=.5,t=1,n=8,r=1,i=0,a=Math.PI*2){super(),this.type=`RingGeometry`,this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},n=Math.max(3,n),r=Math.max(1,r);let o=[],s=[],c=[],l=[],u=e,d=(t-e)/r,f=new Q,p=new Z;for(let e=0;e<=r;e++){for(let e=0;e<=n;e++){let r=i+e/n*a;f.x=u*Math.cos(r),f.y=u*Math.sin(r),s.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/t+1)/2,p.y=(f.y/t+1)/2,l.push(p.x,p.y)}u+=d}for(let e=0;e<r;e++){let t=e*(n+1);for(let e=0;e<n;e++){let r=e+t,i=r,a=r+n+1,s=r+n+2,c=r+1;o.push(i,a,c),o.push(a,s,c)}}this.setIndex(o),this.setAttribute(`position`,new hK(s,3)),this.setAttribute(`normal`,new hK(c,3)),this.setAttribute(`uv`,new hK(l,2))}static fromJSON(t){return new e(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}},WY=class e extends wK{constructor(e=new IY([new Z(0,.5),new Z(-.5,-.5),new Z(.5,-.5)]),t=12){super(),this.type=`ShapeGeometry`,this.parameters={shapes:e,curveSegments:t};let n=[],r=[],i=[],a=[],o=0,s=0;if(Array.isArray(e)===!1)c(e);else for(let t=0;t<e.length;t++)c( __get$(e,t) ),this.addGroup(o,s,t),o+=s,s=0;this.setIndex(n),this.setAttribute(`position`,new hK(r,3)),this.setAttribute(`normal`,new hK(i,3)),this.setAttribute(`uv`,new hK(a,2));function c(e){let o=r.length/3,c=e.extractPoints(t),l=c.shape,u=c.holes;RY.isClockWise(l)===!1&&(l=l.reverse());for(let e=0,t=u.length;e<t;e++){let t= __get$(u,e) ;RY.isClockWise(t)===!0&&( __set$(u,e,t.reverse()) )}let d=RY.triangulateShape(l,u);for(let e=0,t=u.length;e<t;e++){let t= __get$(u,e) ;l=l.concat(t)}for(let e=0,t=l.length;e<t;e++){let t= __get$(l,e) ;r.push(t.x,t.y,0),i.push(0,0,1),a.push(t.x,t.y)}for(let e=0,t=d.length;e<t;e++){let t= __get$(d,e) ,r=t[0]+o,i=t[1]+o,a=t[2]+o;n.push(r,i,a),s+=3}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return GB(t,e)}static fromJSON(t,n){let r=[];for(let e=0,i=t.shapes.length;e<i;e++){let i= __get$(n,__get$(t.shapes,e)) ;r.push(i)}return new e(r,t.curveSegments)}},GY=class e extends wK{constructor(e=1,t=32,n=16,r=0,i=Math.PI*2,a=0,o=Math.PI){super(),this.type=`SphereGeometry`,this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));let s=Math.min(a+o,Math.PI),c=0,l=[],u=new Q,d=new Q,f=[],p=[],m=[],h=[];for(let f=0;f<=n;f++){let g=[],_=f/n,v=0;f==0&&a==0?v=.5/t:f==n&&s==Math.PI&&(v=-.5/t);for(let n=0;n<=t;n++){let s=n/t;u.x=-e*Math.cos(r+s*i)*Math.sin(a+_*o),u.y=e*Math.cos(a+_*o),u.z=e*Math.sin(r+s*i)*Math.sin(a+_*o),p.push(u.x,u.y,u.z),d.copy(u).normalize(),m.push(d.x,d.y,d.z),h.push(s+v,1-_),g.push(c++)}l.push(g)}for(let e=0;e<n;e++)for(let r=0;r<t;r++){let t= __get$(__get$(l,e),r+1) ,i= __get$(__get$(l,e),r) ,o= __get$(__get$(l,e+1),r) ,c= __get$(__get$(l,e+1),r+1) ;(e!==0||a>0)&&f.push(t,i,c),(e!==n-1||s<Math.PI)&&f.push(i,o,c)}this.setIndex(f),this.setAttribute(`position`,new hK(p,3)),this.setAttribute(`normal`,new hK(m,3)),this.setAttribute(`uv`,new hK(h,2))}static fromJSON(t){return new e(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}},KY=class e extends kY{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type=`TetrahedronGeometry`,this.parameters={radius:e,detail:t}}static fromJSON(t){return new e(t.radius,t.detail)}},qY=class e extends wK{constructor(e=1,t=.4,n=8,r=6,i=Math.PI*2){super(),this.type=`TorusGeometry`,this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);let a=[],o=[],s=[],c=[],l=new Q,u=new Q,d=new Q;for(let a=0;a<=n;a++)for(let f=0;f<=r;f++){let p=f/r*i,m=a/n*Math.PI*2;u.x=(e+t*Math.cos(m))*Math.cos(p),u.y=(e+t*Math.cos(m))*Math.sin(p),u.z=t*Math.sin(m),o.push(u.x,u.y,u.z),l.x=e*Math.cos(p),l.y=e*Math.sin(p),d.subVectors(u,l).normalize(),s.push(d.x,d.y,d.z),c.push(f/r),c.push(a/n)}for(let e=1;e<=n;e++)for(let t=1;t<=r;t++){let n=(r+1)*e+t-1,i=(r+1)*(e-1)+t-1,o=(r+1)*(e-1)+t,s=(r+1)*e+t;a.push(n,i,s),a.push(i,o,s)}this.setIndex(a),this.setAttribute(`position`,new hK(o,3)),this.setAttribute(`normal`,new hK(s,3)),this.setAttribute(`uv`,new hK(c,2))}static fromJSON(t){return new e(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}},JY=class e extends wK{constructor(e=1,t=.4,n=64,r=8,i=2,a=3){super(),this.type=`TorusKnotGeometry`,this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},n=Math.floor(n),r=Math.floor(r);let o=[],s=[],c=[],l=[],u=new Q,d=new Q,f=new Q,p=new Q,m=new Q,h=new Q,g=new Q;for(let o=0;o<=n;++o){let v=o/n*i*Math.PI*2;_(v,i,a,e,f),_(v+.01,i,a,e,p),h.subVectors(p,f),g.addVectors(p,f),m.crossVectors(h,g),g.crossVectors(m,h),m.normalize(),g.normalize();for(let e=0;e<=r;++e){let i=e/r*Math.PI*2,a=-t*Math.cos(i),p=t*Math.sin(i);u.x=f.x+(a*g.x+p*m.x),u.y=f.y+(a*g.y+p*m.y),u.z=f.z+(a*g.z+p*m.z),s.push(u.x,u.y,u.z),d.subVectors(u,f).normalize(),c.push(d.x,d.y,d.z),l.push(o/n),l.push(e/r)}}for(let e=1;e<=n;e++)for(let t=1;t<=r;t++){let n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),a=(r+1)*e+t,s=(r+1)*(e-1)+t;o.push(n,i,s),o.push(i,a,s)}this.setIndex(o),this.setAttribute(`position`,new hK(s,3)),this.setAttribute(`normal`,new hK(c,3)),this.setAttribute(`uv`,new hK(l,2));function _(e,t,n,r,i){let a=Math.cos(e),o=Math.sin(e),s=n/t*e,c=Math.cos(s);i.x=r*(2+c)*.5*a,i.y=r*(2+c)*o*.5,i.z=r*Math.sin(s)*.5}}static fromJSON(t){return new e(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}},YY=class e extends wK{constructor(e=new yY(new Q(-1,-1,0),new Q(-1,1,0),new Q(1,1,0)),t=64,n=1,r=8,i=!1){super(),this.type=`TubeGeometry`,this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};let a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;let o=new Q,s=new Q,c=new Z,l=new Q,u=[],d=[],f=[],p=[];m(),this.setIndex(p),this.setAttribute(`position`,new hK(u,3)),this.setAttribute(`normal`,new hK(d,3)),this.setAttribute(`uv`,new hK(f,2));function m(){for(let e=0;e<t;e++)h(e);h(i===!1?t:0),_(),g()}function h(i){l=e.getPointAt(i/t,l);let c= __get$(a.normals,i) ,f= __get$(a.binormals,i) ;for(let e=0;e<=r;e++){let t=e/r*Math.PI*2,i=Math.sin(t),a=-Math.cos(t);s.x=a*c.x+i*f.x,s.y=a*c.y+i*f.y,s.z=a*c.z+i*f.z,s.normalize(),d.push(s.x,s.y,s.z),o.x=l.x+n*s.x,o.y=l.y+n*s.y,o.z=l.z+n*s.z,u.push(o.x,o.y,o.z)}}function g(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){let n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),a=(r+1)*e+t,o=(r+1)*(e-1)+t;p.push(n,i,o),p.push(i,a,o)}}function _(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)c.x=e/t,c.y=n/r,f.push(c.x,c.y)}}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(t){return new e(new xY[t.path.type]().fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}},XY=class extends wK{constructor(e=null){if(super(),this.type=`WireframeGeometry`,this.parameters={geometry:e},e!==null){let t=[],n=new Set,r=new Q,i=new Q;if(e.index!==null){let a=e.attributes.position,o=e.index,s=e.groups;s.length===0&&(s=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,c=s.length;e<c;++e){let c= __get$(s,e) ,l=c.start,u=c.count;for(let e=l,s=l+u;e<s;e+=3)for(let s=0;s<3;s++){let c=o.getX(e+s),l=o.getX(e+(s+1)%3);r.fromBufferAttribute(a,c),i.fromBufferAttribute(a,l),KB(r,i,n)===!0&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{let a=e.attributes.position;for(let e=0,o=a.count/3;e<o;e++)for(let o=0;o<3;o++){let s=3*e+o,c=3*e+(o+1)%3;r.fromBufferAttribute(a,s),i.fromBufferAttribute(a,c),KB(r,i,n)===!0&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute(`position`,new hK(t,3))}}},ZY=Object.freeze({__proto__:null,BoxGeometry:UK,BoxBufferGeometry:UK,CapsuleGeometry:TY,CapsuleBufferGeometry:TY,CircleGeometry:EY,CircleBufferGeometry:EY,ConeGeometry:OY,ConeBufferGeometry:OY,CylinderGeometry:DY,CylinderBufferGeometry:DY,DodecahedronGeometry:AY,DodecahedronBufferGeometry:AY,EdgesGeometry:FY,ExtrudeGeometry:zY,ExtrudeBufferGeometry:zY,IcosahedronGeometry:VY,IcosahedronBufferGeometry:VY,LatheGeometry:wY,LatheBufferGeometry:wY,OctahedronGeometry:HY,OctahedronBufferGeometry:HY,PlaneGeometry:cq,PlaneBufferGeometry:cq,PolyhedronGeometry:kY,PolyhedronBufferGeometry:kY,RingGeometry:UY,RingBufferGeometry:UY,ShapeGeometry:WY,ShapeBufferGeometry:WY,SphereGeometry:GY,SphereBufferGeometry:GY,TetrahedronGeometry:KY,TetrahedronBufferGeometry:KY,TorusGeometry:qY,TorusBufferGeometry:qY,TorusKnotGeometry:JY,TorusKnotBufferGeometry:JY,TubeGeometry:YY,TubeBufferGeometry:YY,WireframeGeometry:XY}),QY=class extends nK{constructor(e){super(),this.type=`ShadowMaterial`,this.color=new kW(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}},QY.prototype.isShadowMaterial=!0,$Y=class extends qK{constructor(e){super(e),this.type=`RawShaderMaterial`}},$Y.prototype.isRawShaderMaterial=!0,eX=class extends nK{constructor(e){super(),this.defines={STANDARD:``},this.type=`MeshStandardMaterial`,this.color=new kW(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kW(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=`round`,this.wireframeLinejoin=`round`,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:``},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},eX.prototype.isMeshStandardMaterial=!0,tX=class extends eX{constructor(e){super(),this.defines={STANDARD:``,PHYSICAL:``},this.type=`MeshPhysicalMaterial`,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Z(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,`reflectivity`,{get:function(){return FL(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new kW(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new kW(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new kW(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:``,PHYSICAL:``},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},tX.prototype.isMeshPhysicalMaterial=!0,nX=class extends nK{constructor(e){super(),this.type=`MeshPhongMaterial`,this.color=new kW(16777215),this.specular=new kW(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kW(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=QV,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=`round`,this.wireframeLinejoin=`round`,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},nX.prototype.isMeshPhongMaterial=!0,rX=class extends nK{constructor(e){super(),this.defines={TOON:``},this.type=`MeshToonMaterial`,this.color=new kW(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kW(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=`round`,this.wireframeLinejoin=`round`,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},rX.prototype.isMeshToonMaterial=!0,iX=class extends nK{constructor(e){super(),this.type=`MeshNormalMaterial`,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},iX.prototype.isMeshNormalMaterial=!0,aX=class extends nK{constructor(e){super(),this.type=`MeshLambertMaterial`,this.color=new kW(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kW(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=QV,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=`round`,this.wireframeLinejoin=`round`,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},aX.prototype.isMeshLambertMaterial=!0,oX=class extends nK{constructor(e){super(),this.defines={MATCAP:``},this.type=`MeshMatcapMaterial`,this.color=new kW(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:``},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}},oX.prototype.isMeshMatcapMaterial=!0,sX=class extends zJ{constructor(e){super(),this.type=`LineDashedMaterial`,this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}},sX.prototype.isLineDashedMaterial=!0,cX={ShadowMaterial:QY,SpriteMaterial:iJ,RawShaderMaterial:$Y,ShaderMaterial:qK,PointsMaterial:XJ,MeshPhysicalMaterial:tX,MeshStandardMaterial:eX,MeshPhongMaterial:nX,MeshToonMaterial:rX,MeshNormalMaterial:iX,MeshLambertMaterial:aX,MeshDepthMaterial:Vq,MeshDistanceMaterial:Hq,MeshBasicMaterial:rK,MeshMatcapMaterial:oX,LineDashedMaterial:sX,LineBasicMaterial:zJ,Material:nK},nK.fromType=function(e){return new cX[e]},lX={arraySlice:function(e,t,n){return lX.isTypedArray(e)?new e.constructor(e.subarray(t,n===void 0?e.length:n)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT==`number`?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function t(t,n){return  __get$(e,t) - __get$(e,n) }let n=e.length,r=Array(n);for(let e=0;e!==n;++e) __set$(r,e,e) ;return r.sort(t),r},sortedArray:function(e,t,n){let r=e.length,i=new e.constructor(r);for(let a=0,o=0;o!==r;++a){let r= __get$(n,a) *t;for(let n=0;n!==t;++n) __set$(i,o++,__get$(e,r+n)) }return i},flattenJSON:function(e,t,n,r){let i=1,a=e[0];for(;a!==void 0&& __get$(a,r) ===void 0;)a= __get$(e,i++) ;if(a===void 0)return;let o= __get$(a,r) ;if(o!==void 0)if(Array.isArray(o))do o= __get$(a,r) ,o!==void 0&&(t.push(a.time),n.push.apply(n,o)),a= __get$(e,i++) ;while(a!==void 0);else if(o.toArray!==void 0)do o= __get$(a,r) ,o!==void 0&&(t.push(a.time),o.toArray(n,n.length)),a= __get$(e,i++) ;while(a!==void 0);else do o= __get$(a,r) ,o!==void 0&&(t.push(a.time),n.push(o)),a= __get$(e,i++) ;while(a!==void 0)},subclip:function(e,t,n,r,i=30){let a=e.clone();a.name=t;let o=[];for(let e=0;e<a.tracks.length;++e){let t= __get$(a.tracks,e) ,s=t.getValueSize(),c=[],l=[];for(let e=0;e<t.times.length;++e){let a= __get$(t.times,e) *i;if(!(a<n||a>=r)){c.push( __get$(t.times,e) );for(let n=0;n<s;++n)l.push( __get$(t.values,e*s+n) )}}c.length!==0&&(t.times=lX.convertArray(c,t.times.constructor),t.values=lX.convertArray(l,t.values.constructor),o.push(t))}a.tracks=o;let s=1/0;for(let e=0;e<a.tracks.length;++e)s> __get$(a.tracks,e) .times[0]&&(s= __get$(a.tracks,e) .times[0]);for(let e=0;e<a.tracks.length;++e) __get$(a.tracks,e) .shift(-1*s);return a.resetDuration(),a},makeClipAdditive:function(e,t=0,n=e,r=30){r<=0&&(r=30);let i=n.tracks.length,a=t/r;for(let t=0;t<i;++t){let r= __get$(n.tracks,t) ,i=r.ValueTypeName;if(i===`bool`||i===`string`)continue;let o=e.tracks.find(function(e){return e.name===r.name&&e.ValueTypeName===i});if(o===void 0)continue;let s=0,c=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=c/3);let l=0,u=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=u/3);let d=r.times.length-1,f;if(a<=r.times[0]){let e=s,t=c-s;f=lX.arraySlice(r.values,e,t)}else if(a>= __get$(r.times,d) ){let e=d*c+s,t=e+c-s;f=lX.arraySlice(r.values,e,t)}else{let e=r.createInterpolant(),t=s,n=c-s;e.evaluate(a),f=lX.arraySlice(e.resultBuffer,t,n)}i===`quaternion`&&new HW().fromArray(f).normalize().conjugate().toArray(f);let p=o.times.length;for(let e=0;e<p;++e){let t=e*u+l;if(i===`quaternion`)HW.multiplyQuaternionsFlat(o.values,t,f,0,o.values,t);else{let e=u-l*2;for(let n=0;n<e;++n)o.values[t+n]-= __get$(f,n) }}}return e.blendMode=jU,e}},uX=class{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r===void 0?new t.constructor(n):r,this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,r= __get$(t,n) ,i= __get$(t,n-1) ;validate_interval:{seek:{let a;linear_scan:{forward_scan:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<i)break forward_scan;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,r= __get$(t,++n) ,e<r)break seek}a=t.length;break linear_scan}if(!(e>=i)){let o=t[1];e<o&&(n=2,i=o);for(let a=n-2;;){if(i===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===a)break;if(r=i,i= __get$(t,--n-1) ,e>=i)break seek}a=n,n=0;break linear_scan}break validate_interval}for(;n<a;){let r=n+a>>>1;e< __get$(t,r) ?a=r:n=r+1}if(r= __get$(t,n) ,i= __get$(t,n-1) ,i===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(r===void 0)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let e=0;e!==r;++e) __set$(t,e,__get$(n,i+e)) ;return t}interpolate_(){throw Error(`call to abstract method`)}intervalChanged_(){}},uX.prototype.beforeStart_=uX.prototype.copySampleValue_,uX.prototype.afterEnd_=uX.prototype.copySampleValue_,dX=class extends uX{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:DU,endingEnd:DU}}intervalChanged_(e,t,n){let r=this.parameterPositions,i=e-2,a=e+1,o= __get$(r,i) ,s= __get$(r,a) ;if(o===void 0)switch(this.getSettings_().endingStart){case OU:i=e,o=2*t-n;break;case kU:i=r.length-2,o=t+ __get$(r,i) - __get$(r,i+1) ;break;default:i=e,o=n}if(s===void 0)switch(this.getSettings_().endingEnd){case OU:a=e,s=2*n-t;break;case kU:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}let c=(n-t)*.5,l=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l}interpolate_(e,t,n,r){let i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=s-o,l=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(n-t)/(r-t),m=p*p,h=m*p,g=-d*h+2*d*m-d*p,_=(1+d)*h+(-1.5-2*d)*m+(-.5+d)*p+1,v=(-1-f)*h+(1.5+f)*m+.5*p,y=f*h-f*m;for(let e=0;e!==o;++e) __set$(i,e,g*__get$(a,l+e)+_*__get$(a,c+e)+v*__get$(a,s+e)+y*__get$(a,u+e)) ;return i}},fX=class extends uX{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=s-o,l=(n-t)/(r-t),u=1-l;for(let e=0;e!==o;++e) __set$(i,e,__get$(a,c+e)*u+__get$(a,s+e)*l) ;return i}},pX=class extends uX{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}},mX=class{constructor(e,t,n,r){if(e===void 0)throw Error(`THREE.KeyframeTrack: track name is undefined`);if(t===void 0||t.length===0)throw Error(`THREE.KeyframeTrack: no keyframes in track named `+e);this.name=e,this.times=lX.convertArray(t,this.TimeBufferType),this.values=lX.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:lX.convertArray(e.times,Array),values:lX.convertArray(e.values,Array)};let t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new pX(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new fX(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new dX(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case wU:t=this.InterpolantFactoryMethodDiscrete;break;case TU:t=this.InterpolantFactoryMethodLinear;break;case EU:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let t=`unsupported interpolation for `+this.ValueTypeName+` keyframe track named `+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t);return console.warn(`THREE.KeyframeTrack:`,t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return wU;case this.InterpolantFactoryMethodLinear:return TU;case this.InterpolantFactoryMethodSmooth:return EU}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let n=0,r=t.length;n!==r;++n) __set$(t,n,__get$(t,n)+e) }return this}scale(e){if(e!==1){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){let n=this.times,r=n.length,i=0,a=r-1;for(;i!==r&& __get$(n,i) <e;)++i;for(;a!==-1&& __get$(n,a) >t;)--a;if(++a,i!==0||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);let e=this.getValueSize();this.times=lX.arraySlice(n,i,a),this.values=lX.arraySlice(this.values,i*e,a*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error(`THREE.KeyframeTrack: Invalid value size in track.`,this),e=!1);let n=this.times,r=this.values,i=n.length;i===0&&(console.error(`THREE.KeyframeTrack: Track is empty.`,this),e=!1);let a=null;for(let t=0;t!==i;t++){let r= __get$(n,t) ;if(typeof r==`number`&&isNaN(r)){console.error(`THREE.KeyframeTrack: Time is not a valid number.`,this,t,r),e=!1;break}if(a!==null&&a>r){console.error(`THREE.KeyframeTrack: Out of order keys.`,this,t,r,a),e=!1;break}a=r}if(r!==void 0&&lX.isTypedArray(r))for(let t=0,n=r.length;t!==n;++t){let n= __get$(r,t) ;if(isNaN(n)){console.error(`THREE.KeyframeTrack: Value is not a valid number.`,this,t,n),e=!1;break}}return e}optimize(){let e=lX.arraySlice(this.times),t=lX.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===EU,i=e.length-1,a=1;for(let o=1;o<i;++o){let i=!1,s= __get$(e,o) ;if(s!== __get$(e,o+1) &&(o!==1||s!==e[0]))if(r)i=!0;else{let e=o*n,r=e-n,a=e+n;for(let o=0;o!==n;++o){let n= __get$(t,e+o) ;if(n!== __get$(t,r+o) ||n!== __get$(t,a+o) ){i=!0;break}}}if(i){if(o!==a){ __set$(e,a,__get$(e,o)) ;let r=o*n,i=a*n;for(let e=0;e!==n;++e) __set$(t,i+e,__get$(t,r+e)) }++a}}if(i>0){ __set$(e,a,__get$(e,i)) ;for(let e=i*n,r=a*n,o=0;o!==n;++o) __set$(t,r+o,__get$(t,e+o)) ;++a}return a===e.length?(this.times=e,this.values=t):(this.times=lX.arraySlice(e,0,a),this.values=lX.arraySlice(t,0,a*n)),this}clone(){let e=lX.arraySlice(this.times,0),t=lX.arraySlice(this.values,0),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}},mX.prototype.TimeBufferType=Float32Array,mX.prototype.ValueBufferType=Float32Array,mX.prototype.DefaultInterpolation=TU,hX=class extends mX{},hX.prototype.ValueTypeName=`bool`,hX.prototype.ValueBufferType=Array,hX.prototype.DefaultInterpolation=wU,hX.prototype.InterpolantFactoryMethodLinear=void 0,hX.prototype.InterpolantFactoryMethodSmooth=void 0,gX=class extends mX{},gX.prototype.ValueTypeName=`color`,_X=class extends mX{},_X.prototype.ValueTypeName=`number`,vX=class extends uX{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),c=e*o;for(let e=c+o;c!==e;c+=4)HW.slerpFlat(i,0,a,c-o,a,c,s);return i}},yX=class extends mX{InterpolantFactoryMethodLinear(e){return new vX(this.times,this.values,this.getValueSize(),e)}},yX.prototype.ValueTypeName=`quaternion`,yX.prototype.DefaultInterpolation=TU,yX.prototype.InterpolantFactoryMethodSmooth=void 0,bX=class extends mX{},bX.prototype.ValueTypeName=`string`,bX.prototype.ValueBufferType=Array,bX.prototype.DefaultInterpolation=wU,bX.prototype.InterpolantFactoryMethodLinear=void 0,bX.prototype.InterpolantFactoryMethodSmooth=void 0,xX=class extends mX{},xX.prototype.ValueTypeName=`vector`,SX=class{constructor(e,t=-1,n,r=AU){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=PL(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,r=1/(e.fps||1);for(let e=0,i=n.length;e!==i;++e)t.push(JB( __get$(n,e) ).scale(r));let i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){let t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,r=n.length;e!==r;++e)t.push(mX.toJSON( __get$(n,e) ));return r}static CreateFromMorphTargetSequence(e,t,n,r){let i=t.length,a=[];for(let e=0;e<i;e++){let o=[],s=[];o.push((e+i-1)%i,e,(e+1)%i),s.push(0,1,0);let c=lX.getKeyframeOrder(o);o=lX.sortedArray(o,1,c),s=lX.sortedArray(s,1,c),!r&&o[0]===0&&(o.push(i),s.push(s[0])),a.push( new _X(`.morphTargetInfluences[`+__get$(t,e).name+`]`,o,s) .scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<n.length;e++)if( __get$(n,e) .name===t)return  __get$(n,e) ;return null}static CreateClipsFromMorphTargetSequences(e,t,n){let r={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){let n= __get$(e,t) ,a=n.name.match(i);if(a&&a.length>1){let e=a[1],t= __get$(r,e) ;t||( __set$(r,e,t=[]) ),t.push(n)}}let a=[];for(let e in r)a.push(this.CreateFromMorphTargetSequence(e, __get$(r,e) ,t,n));return a}static parseAnimation(e,t){if(!e)return console.error(`THREE.AnimationClip: No animation in JSONLoader data.`),null;let n=function(e,t,n,r,i){if(n.length!==0){let a=[],o=[];lX.flattenJSON(n,a,o,r),a.length!==0&&i.push(new e(t,a,o))}},r=[],i=e.name||`default`,a=e.fps||30,o=e.blendMode,s=e.length||-1,c=e.hierarchy||[];for(let e=0;e<c.length;e++){let i= __get$(c,e) .keys;if(!(!i||i.length===0))if(i[0].morphTargets){let e={},t;for(t=0;t<i.length;t++)if( __get$(i,t) .morphTargets)for(let n=0;n< __get$(i,t) .morphTargets.length;n++) __set$(e,__get$(__get$(i,t).morphTargets,n),-1) ;for(let n in e){let e=[],a=[];for(let r=0;r!== __get$(i,t) .morphTargets.length;++r){let r= __get$(i,t) ;e.push(r.time),a.push(r.morphTarget===n?1:0)}r.push(new _X(`.morphTargetInfluence[`+n+`]`,e,a))}s=e.length*a}else{let a=`.bones[`+ __get$(t,e) .name+`]`;n(xX,a+`.position`,i,`pos`,r),n(yX,a+`.quaternion`,i,`rot`,r),n(xX,a+`.scale`,i,`scl`,r)}}return r.length===0?null:new this(i,s,r,o)}resetDuration(){let e=this.tracks,t=0;for(let n=0,r=e.length;n!==r;++n){let e= __get$(this.tracks,n) ;t=Math.max(t, __get$(e.times,e.times.length-1) )}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++) __get$(this.tracks,e) .trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e&&= __get$(this.tracks,t) .validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++) __get$(this.tracks,e) .optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push( __get$(this.tracks,t) .clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}},CX={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&( __set$(this.files,e,t) )},get:function(e){if(this.enabled!==!1)return  __get$(this.files,e) },remove:function(e){delete this.files[e]},clear:function(){this.files={}}},wX=class{constructor(e,t,n){let r=this,i=!1,a=0,o=0,s,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,i===!1&&r.onStart!==void 0&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,r.onProgress!==void 0&&r.onProgress(e,a,o),a===o&&(i=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(e){r.onError!==void 0&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return c.push(e,t),this},this.removeHandler=function(e){let t=c.indexOf(e);return t!==-1&&c.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=c.length;t<n;t+=2){let n= __get$(c,t) ,r= __get$(c,t+1) ;if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}},TX=new wX,EX=class{constructor(e){this.manager=e===void 0?TX:e,this.crossOrigin=`anonymous`,this.withCredentials=!1,this.path=``,this.resourcePath=``,this.requestHeader={}}load(){}loadAsync(e,t){let n=this;return new Promise(function(r,i){n.load(e,r,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},DX={},OX=class extends EX{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e=``),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let i=CX.get(e);if(i!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if( __get$(DX,e) !==void 0){ __get$(DX,e) .push({onLoad:t,onProgress:n,onError:r});return} __set$(DX,e,[]) , __get$(DX,e) .push({onLoad:t,onProgress:n,onError:r});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?`include`:`same-origin`}),o=this.mimeType,s=this.responseType;fetch(a).then(t=>{if(t.status===200||t.status===0){if(t.status===0&&console.warn(`THREE.FileLoader: HTTP Status 0 received.`),typeof ReadableStream>`u`||t.body===void 0||t.body.getReader===void 0)return t;let n= __get$(DX,e) ,r=t.body.getReader(),i=t.headers.get(`Content-Length`),a=i?parseInt(i):0,o=a!==0,s=0,c= new ReadableStream({start(e){t();function t(){r.read().then(_hh$temp1234=>{var r=_hh$temp1234.done,i=_hh$temp1234.value;if(r)e.close();else{s+=i.byteLength;let r=new ProgressEvent(`progress`,{lengthComputable:o,loaded:s,total:a});for(let e=0,t=n.length;e<t;e++){let t=__get$(n,e);t.onProgress&&t.onProgress(r);}e.enqueue(i),t();}});}}}) ;return new Response(c)}else throw Error(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`)}).then(e=>{switch(s){case`arraybuffer`:return e.arrayBuffer();case`blob`:return e.blob();case`document`:return e.text().then(e=>new DOMParser().parseFromString(e,o));case`json`:return e.json();default:if(o===void 0)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(o),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{CX.add(e,t);let n= __get$(DX,e) ;delete DX[e];for(let e=0,r=n.length;e<r;e++){let r= __get$(n,e) ;r.onLoad&&r.onLoad(t)}}).catch(t=>{let n= __get$(DX,e) ;if(n===void 0)throw this.manager.itemError(e),t;delete DX[e];for(let e=0,r=n.length;e<r;e++){let r= __get$(n,e) ;r.onError&&r.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},kX=class extends EX{constructor(e){super(e)}load(e,t,n,r){let i=this,a=new OX(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}},n,r)}parse(e){let t=[];for(let n=0;n<e.length;n++){let r=SX.parse( __get$(e,n) );t.push(r)}return t}},AX=class extends EX{constructor(e){super(e)}load(e,t,n,r){let i=this,a=[],o=new iY,s=new OX(this.manager);s.setPath(this.path),s.setResponseType(`arraybuffer`),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);let c=0;function l(l){s.load( __get$(e,l) ,function(e){let n=i.parse(e,!0); __set$(a,l,{width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps}) ,c+=1,c===6&&(n.mipmapCount===1&&(o.minFilter=xH),o.image=a,o.format=n.format,o.needsUpdate=!0,t&&t(o))},n,r)}if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)l(t);else s.load(e,function(e){let n=i.parse(e,!0);if(n.isCubemap){let e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){ __set$(a,t,{mipmaps:[]}) ;for(let e=0;e<n.mipmapCount;e++) __get$(a,t) .mipmaps.push( __get$(n.mipmaps,t*n.mipmapCount+e) ), __get$(a,t) .format=n.format, __get$(a,t) .width=n.width, __get$(a,t) .height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;n.mipmapCount===1&&(o.minFilter=xH),o.format=n.format,o.needsUpdate=!0,t&&t(o)},n,r);return o}},jX=class extends EX{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,a=CX.get(e);if(a!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;let o=iR(`img`);function s(){l(),CX.add(e,this),t&&t(this),i.manager.itemEnd(e)}function c(t){l(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function l(){o.removeEventListener(`load`,s,!1),o.removeEventListener(`error`,c,!1)}return o.addEventListener(`load`,s,!1),o.addEventListener(`error`,c,!1),e.slice(0,5)!==`data:`&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}},MX=class extends EX{constructor(e){super(e)}load(e,t,n,r){let i=new $K,a=new jX(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function s(n){a.load( __get$(e,n) ,function(e){ __set$(i.images,n,e) ,o++,o===6&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(let t=0;t<e.length;++t)s(t);return i}},NX=class extends EX{constructor(e){super(e)}load(e,t,n,r){let i=this,a=new kJ,o=new OX(this.manager);return o.setResponseType(`arraybuffer`),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,function(e){let n=i.parse(e);n&&(n.image===void 0?n.data!==void 0&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data):a.image=n.image,a.wrapS=n.wrapS===void 0?mH:n.wrapS,a.wrapT=n.wrapT===void 0?mH:n.wrapT,a.magFilter=n.magFilter===void 0?xH:n.magFilter,a.minFilter=n.minFilter===void 0?xH:n.minFilter,a.anisotropy=n.anisotropy===void 0?1:n.anisotropy,n.encoding!==void 0&&(a.encoding=n.encoding),n.flipY!==void 0&&(a.flipY=n.flipY),n.format!==void 0&&(a.format=n.format),n.type!==void 0&&(a.type=n.type),n.mipmaps!==void 0&&(a.mipmaps=n.mipmaps,a.minFilter=wH),n.mipmapCount===1&&(a.minFilter=xH),n.generateMipmaps!==void 0&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n))},n,r),a}},PX=class extends EX{constructor(e){super(e)}load(e,t,n,r){let i=new PW,a=new jX(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){i.image=e,i.needsUpdate=!0,t!==void 0&&t(i)},n,r),i}},FX=class extends UG{constructor(e,t=1){super(),this.type=`Light`,this.color=new kW(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},FX.prototype.isLight=!0,IX=class extends FX{constructor(e,t,n){super(e,n),this.type=`HemisphereLight`,this.position.copy(UG.DefaultUp),this.updateMatrix(),this.groundColor=new kW(t)}copy(e){return FX.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}},IX.prototype.isHemisphereLight=!0,LX=new vG,RX=new Q,zX=new Q,BX=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Z(512,512),this.map=null,this.mapPass=null,this.matrix=new vG,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sq,this._frameExtents=new Z(1,1),this._viewportCount=1,this._viewports=[new FW(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;RX.setFromMatrixPosition(e.matrixWorld),t.position.copy(RX),zX.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(zX),t.updateMatrixWorld(),LX.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(LX),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return  __get$(this._viewports,e) }getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},VX=class extends BX{constructor(){super(new YK(50,1,.5,500)),this.focus=1}updateMatrices(e){let t=this.camera,n=yW*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;(n!==t.fov||r!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},VX.prototype.isSpotLightShadow=!0,HX=class extends FX{constructor(e,t,n=0,r=Math.PI/3,i=0,a=1){super(e,t),this.type=`SpotLight`,this.position.copy(UG.DefaultUp),this.updateMatrix(),this.target=new UG,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.shadow=new VX}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},HX.prototype.isSpotLight=!0,UX=new vG,WX=new Q,GX=new Q,KX=class extends BX{constructor(){super(new YK(90,1,.5,500)),this._frameExtents=new Z(4,2),this._viewportCount=6,this._viewports=[new FW(2,1,1,1),new FW(0,1,1,1),new FW(3,1,1,1),new FW(1,1,1,1),new FW(3,0,1,1),new FW(1,0,1,1)],this._cubeDirections=[new Q(1,0,0),new Q(-1,0,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,1,0),new Q(0,-1,0)],this._cubeUps=[new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,0,1),new Q(0,0,-1)]}updateMatrices(e,t=0){let n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),WX.setFromMatrixPosition(e.matrixWorld),n.position.copy(WX),GX.copy(n.position),GX.add( __get$(this._cubeDirections,t) ),n.up.copy( __get$(this._cubeUps,t) ),n.lookAt(GX),n.updateMatrixWorld(),r.makeTranslation(-WX.x,-WX.y,-WX.z),UX.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(UX)}},KX.prototype.isPointLightShadow=!0,qX=class extends FX{constructor(e,t,n=0,r=1){super(e,t),this.type=`PointLight`,this.distance=n,this.decay=r,this.shadow=new KX}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},qX.prototype.isPointLight=!0,JX=class extends BX{constructor(){super(new fq(-5,5,5,-5,.5,500))}},JX.prototype.isDirectionalLightShadow=!0,YX=class extends FX{constructor(e,t){super(e,t),this.type=`DirectionalLight`,this.position.copy(UG.DefaultUp),this.updateMatrix(),this.target=new UG,this.shadow=new JX}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},YX.prototype.isDirectionalLight=!0,XX=class extends FX{constructor(e,t){super(e,t),this.type=`AmbientLight`}},XX.prototype.isAmbientLight=!0,ZX=class extends FX{constructor(e,t,n=10,r=10){super(e,t),this.type=`RectAreaLight`,this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}},ZX.prototype.isRectAreaLight=!0,QX=class{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Q)}set(e){for(let t=0;t<9;t++) __get$(this.coefficients,t) .copy( __get$(e,t) );return this}zero(){for(let e=0;e<9;e++) __get$(this.coefficients,e) .set(0,0,0);return this}getAt(e,t){let n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*r)),t.addScaledVector(a[5],1.092548*(r*i)),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],1.092548*(n*i)),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){let n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*r),t.addScaledVector(a[2],2*.511664*i),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*r),t.addScaledVector(a[5],2*.429043*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],2*.429043*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++) __get$(this.coefficients,t) .add( __get$(e.coefficients,t) );return this}addScaledSH(e,t){for(let n=0;n<9;n++) __get$(this.coefficients,n) .addScaledVector( __get$(e.coefficients,n) ,t);return this}scale(e){for(let t=0;t<9;t++) __get$(this.coefficients,t) .multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++) __get$(this.coefficients,n) .lerp( __get$(e.coefficients,n) ,t);return this}equals(e){for(let t=0;t<9;t++)if(! __get$(this.coefficients,t) .equals( __get$(e.coefficients,t) ))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let n=this.coefficients;for(let r=0;r<9;r++) __get$(n,r) .fromArray(e,t+r*3);return this}toArray(e=[],t=0){let n=this.coefficients;for(let r=0;r<9;r++) __get$(n,r) .toArray(e,t+r*3);return e}static getBasisAt(e,t){let n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}},QX.prototype.isSphericalHarmonics3=!0,$X=class extends FX{constructor(e=new QX,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}},$X.prototype.isLightProbe=!0,eZ=class extends EX{constructor(e){super(e),this.textures={}}load(e,t,n,r){let i=this,a=new OX(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}},n,r)}parse(e){let t=this.textures;function n(e){return  __get$(t,e) ===void 0&&console.warn(`THREE.MaterialLoader: Undefined texture`,e), __get$(t,e) }let r=nK.fromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new kW().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors==`number`?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(let t in e.uniforms){let i= __get$(e.uniforms,t) ;switch( __set$(r.uniforms,t,{}) ,i.type){case`t`: __get$(r.uniforms,t) .value=n(i.value);break;case`c`: __get$(r.uniforms,t) .value=new kW().setHex(i.value);break;case`v2`: __get$(r.uniforms,t) .value=new Z().fromArray(i.value);break;case`v3`: __get$(r.uniforms,t) .value=new Q().fromArray(i.value);break;case`v4`: __get$(r.uniforms,t) .value=new FW().fromArray(i.value);break;case`m3`: __get$(r.uniforms,t) .value=new xW().fromArray(i.value);break;case`m4`: __get$(r.uniforms,t) .value=new vG().fromArray(i.value);break;default: __get$(r.uniforms,t) .value=i.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(let t in e.extensions) __set$(r.extensions,t,__get$(e.extensions,t)) ;if(e.shading!==void 0&&(r.flatShading=e.shading===1),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let t=e.normalScale;Array.isArray(t)===!1&&(t=[t,t]),r.normalScale=new Z().fromArray(t)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Z().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}},tZ=class{static decodeText(e){if(typeof TextDecoder<`u`)return new TextDecoder().decode(e);let t=``;for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode( __get$(e,n) );try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf(`/`);return t===-1?`./`:e.slice(0,t+1)}static resolveURL(e,t){return typeof e!=`string`||e===``?``:(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t= __call$(t,"replace",[/(^https?:\/\/[^\/]+).*/i,`$1`]) ),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}},nZ=class extends wK{constructor(){super(),this.type=`InstancedBufferGeometry`,this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){let e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},nZ.prototype.isInstancedBufferGeometry=!0,rZ=class extends EX{constructor(e){super(e)}load(e,t,n,r){let i=this,a=new OX(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}},n,r)}parse(e){let t={},n={};function r(e,n){if( __get$(t,n) !==void 0)return  __get$(t,n) ;let r= __get$(e.interleavedBuffers,n) ,a=i(e,r.buffer),o=new tJ(rR(r.type,a),r.stride);return o.uuid=r.uuid, __set$(t,n,o) ,o}function i(e,t){if( __get$(n,t) !==void 0)return  __get$(n,t) ;let r= __get$(e.arrayBuffers,t) ,i=new Uint32Array(r).buffer;return  __set$(n,t,i) ,i}let a=e.isInstancedBufferGeometry?new nZ:new wK,o=e.data.index;if(o!==void 0){let e=rR(o.type,o.array);a.setIndex(new oK(e,1))}let s=e.data.attributes;for(let t in s){let n= __get$(s,t) ,i;if(n.isInterleavedBufferAttribute)i=new rJ(r(e.data,n.data),n.itemSize,n.offset,n.normalized);else{let e=rR(n.type,n.array);i=new(n.isInstancedBufferAttribute?NJ:oK)(e,n.itemSize,n.normalized)}n.name!==void 0&&(i.name=n.name),n.usage!==void 0&&i.setUsage(n.usage),n.updateRange!==void 0&&(i.updateRange.offset=n.updateRange.offset,i.updateRange.count=n.updateRange.count),a.setAttribute(t,i)}let c=e.data.morphAttributes;if(c)for(let t in c){let n= __get$(c,t) ,i=[];for(let t=0,a=n.length;t<a;t++){let a= __get$(n,t) ,o;o=a.isInterleavedBufferAttribute?new rJ(r(e.data,a.data),a.itemSize,a.offset,a.normalized):new oK(rR(a.type,a.array),a.itemSize,a.normalized),a.name!==void 0&&(o.name=a.name),i.push(o)} __set$(a.morphAttributes,t,i) }e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);let l=e.data.groups||e.data.drawcalls||e.data.offsets;if(l!==void 0)for(let e=0,t=l.length;e!==t;++e){let t= __get$(l,e) ;a.addGroup(t.start,t.count,t.materialIndex)}let u=e.data.boundingSphere;if(u!==void 0){let e=new Q;u.center!==void 0&&e.fromArray(u.center),a.boundingSphere=new lG(e,u.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}},iZ=class extends EX{constructor(e){super(e)}load(e,t,n,r){let i=this,a=this.path===``?tZ.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;let o=new OX(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(n){let a=null;try{a=JSON.parse(n)}catch(t){r!==void 0&&r(t),console.error(`THREE:ObjectLoader: Can't parse `+e+`.`,t.message);return}let o=a.metadata;if(o===void 0||o.type===void 0||o.type.toLowerCase()===`geometry`){console.error(`THREE.ObjectLoader: Can't load `+e);return}i.parse(a,t)},n,r)}async loadAsync(e,t){let n=this,r=this.path===``?tZ.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;let i=new OX(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);let a=await i.loadAsync(e,t),o=JSON.parse(a),s=o.metadata;if(s===void 0||s.type===void 0||s.type.toLowerCase()===`geometry`)throw Error(`THREE.ObjectLoader: Can't load `+e);return await n.parseAsync(o)}parse(e,t){let n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){t!==void 0&&t(c)}),o=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,i,s,o,n),l=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,l),t!==void 0){let e=!1;for(let t in a)if( __get$(a,t) instanceof HTMLImageElement){e=!0;break}e===!1&&t(c)}return c}async parseAsync(e){let t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o,a,t),c=this.parseSkeletons(e.skeletons,s);return this.bindSkeletons(s,c),s}parseShapes(e){let t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){let r=new IY().fromJSON( __get$(e,n) ); __set$(t,r.uuid,r) }return t}parseSkeletons(e,t){let n={},r={};if(t.traverse(function(e){e.isBone&&( __set$(r,e.uuid,e) )}),e!==void 0)for(let t=0,i=e.length;t<i;t++){let i=new MJ().fromJSON( __get$(e,t) ,r); __set$(n,i.uuid,i) }return n}parseGeometries(e,t){let n={};if(e!==void 0){let r=new rZ;for(let i=0,a=e.length;i<a;i++){let a,o= __get$(e,i) ;switch(o.type){case`BufferGeometry`:case`InstancedBufferGeometry`:a=r.parse(o);break;case`Geometry`:console.error(`THREE.ObjectLoader: The legacy Geometry type is no longer supported.`);break;default:o.type in ZY?a= __get$(ZY,o.type) .fromJSON(o,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${o.type}"`)}a.uuid=o.uuid,o.name!==void 0&&(a.name=o.name),a.isBufferGeometry===!0&&o.userData!==void 0&&(a.userData=o.userData), __set$(n,o.uuid,a) }}return n}parseMaterials(e,t){let n={},r={};if(e!==void 0){let i=new eZ;i.setTextures(t);for(let t=0,a=e.length;t<a;t++){let a= __get$(e,t) ;if(a.type===`MultiMaterial`){let e=[];for(let t=0;t<a.materials.length;t++){let r= __get$(a.materials,t) ; __get$(n,r.uuid) ===void 0&&( __set$(n,r.uuid,i.parse(r)) ),e.push( __get$(n,r.uuid) )} __set$(r,a.uuid,e) }else  __get$(n,a.uuid) ===void 0&&( __set$(n,a.uuid,i.parse(a)) ), __set$(r,a.uuid,__get$(n,a.uuid)) }}return r}parseAnimations(e){let t={};if(e!==void 0)for(let n=0;n<e.length;n++){let r= __get$(e,n) ,i=SX.parse(r); __set$(t,i.uuid,i) }return t}parseImages(e,t){let n=this,r={},i;function a(e){return n.manager.itemStart(e),i.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}function o(e){if(typeof e==`string`){let t=e;return a(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}else if(e.data)return{data:rR(e.type,e.data),width:e.width,height:e.height};else return null}if(e!==void 0&&e.length>0){i=new jX(new wX(t)),i.setCrossOrigin(this.crossOrigin);for(let t=0,n=e.length;t<n;t++){let n= __get$(e,t) ,i=n.url;if(Array.isArray(i)){let e=[];for(let t=0,n=i.length;t<n;t++){let n= __get$(i,t) ,r=o(n);r!==null&&(r instanceof HTMLImageElement?e.push(r):e.push(new kJ(r.data,r.width,r.height)))} __set$(r,n.uuid,new MW(e)) }else{let e=o(n.url); __set$(r,n.uuid,new MW(e)) }}}return r}async parseImagesAsync(e){let t=this,n={},r;async function i(e){if(typeof e==`string`){let n=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await r.loadAsync(i)}else if(e.data)return{data:rR(e.type,e.data),width:e.width,height:e.height};else return null}if(e!==void 0&&e.length>0){r=new jX(this.manager),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){let r= __get$(e,t) ,a=r.url;if(Array.isArray(a)){let e=[];for(let t=0,n=a.length;t<n;t++){let n= __get$(a,t) ,r=await i(n);r!==null&&(r instanceof HTMLImageElement?e.push(r):e.push(new kJ(r.data,r.width,r.height)))} __set$(n,r.uuid,new MW(e)) }else{let e=await i(r.url); __set$(n,r.uuid,new MW(e)) }}}return n}parseTextures(e,t){function n(e,t){return typeof e==`number`?e:(console.warn(`THREE.ObjectLoader.parseTexture: Constant should be in numeric form.`,e), __get$(t,e) )}let r={};if(e!==void 0)for(let i=0,a=e.length;i<a;i++){let a= __get$(e,i) ;a.image===void 0&&console.warn(`THREE.ObjectLoader: No "image" specified for`,a.uuid), __get$(t,a.image) ===void 0&&console.warn(`THREE.ObjectLoader: Undefined image`,a.image);let o= __get$(t,a.image) ,s=o.data,c;Array.isArray(s)?(c=new $K,s.length===6&&(c.needsUpdate=!0)):(c=s&&s.data?new kJ:new PW,s&&(c.needsUpdate=!0)),c.source=o,c.uuid=a.uuid,a.name!==void 0&&(c.name=a.name),a.mapping!==void 0&&(c.mapping=n(a.mapping,aZ)),a.offset!==void 0&&c.offset.fromArray(a.offset),a.repeat!==void 0&&c.repeat.fromArray(a.repeat),a.center!==void 0&&c.center.fromArray(a.center),a.rotation!==void 0&&(c.rotation=a.rotation),a.wrap!==void 0&&(c.wrapS=n(a.wrap[0],oZ),c.wrapT=n(a.wrap[1],oZ)),a.format!==void 0&&(c.format=a.format),a.type!==void 0&&(c.type=a.type),a.encoding!==void 0&&(c.encoding=a.encoding),a.minFilter!==void 0&&(c.minFilter=n(a.minFilter,sZ)),a.magFilter!==void 0&&(c.magFilter=n(a.magFilter,sZ)),a.anisotropy!==void 0&&(c.anisotropy=a.anisotropy),a.flipY!==void 0&&(c.flipY=a.flipY),a.premultiplyAlpha!==void 0&&(c.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(c.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(c.userData=a.userData), __set$(r,a.uuid,c) }return r}parseObject(e,t,n,r,i){let a;function o(e){return  __get$(t,e) ===void 0&&console.warn(`THREE.ObjectLoader: Undefined geometry`,e), __get$(t,e) }function s(e){if(e!==void 0){if(Array.isArray(e)){let t=[];for(let r=0,i=e.length;r<i;r++){let i= __get$(e,r) ; __get$(n,i) ===void 0&&console.warn(`THREE.ObjectLoader: Undefined material`,i),t.push( __get$(n,i) )}return t}return  __get$(n,e) ===void 0&&console.warn(`THREE.ObjectLoader: Undefined material`,e), __get$(n,e) }}function c(e){return  __get$(r,e) ===void 0&&console.warn(`THREE.ObjectLoader: Undefined texture`,e), __get$(r,e) }let l,u;switch(e.type){case`Scene`:a=new eJ,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new kW(e.background):a.background=c(e.background)),e.environment!==void 0&&(a.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type===`Fog`?a.fog=new $q(e.fog.color,e.fog.near,e.fog.far):e.fog.type===`FogExp2`&&(a.fog=new Qq(e.fog.color,e.fog.density)));break;case`PerspectiveCamera`:a=new YK(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view= __call$(Object,"assign",[{},e.view]) );break;case`OrthographicCamera`:a=new fq(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view= __call$(Object,"assign",[{},e.view]) );break;case`AmbientLight`:a=new XX(e.color,e.intensity);break;case`DirectionalLight`:a=new YX(e.color,e.intensity);break;case`PointLight`:a=new qX(e.color,e.intensity,e.distance,e.decay);break;case`RectAreaLight`:a=new ZX(e.color,e.intensity,e.width,e.height);break;case`SpotLight`:a=new HX(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case`HemisphereLight`:a=new IX(e.color,e.groundColor,e.intensity);break;case`LightProbe`:a=new $X().fromJSON(e);break;case`SkinnedMesh`:l=o(e.geometry),u=s(e.material),a=new DJ(l,u),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case`Mesh`:l=o(e.geometry),u=s(e.material),a=new HK(l,u);break;case`InstancedMesh`:l=o(e.geometry),u=s(e.material);let t=e.count,n=e.instanceMatrix,r=e.instanceColor;a=new RJ(l,u,t),a.instanceMatrix=new NJ(new Float32Array(n.array),16),r!==void 0&&(a.instanceColor=new NJ(new Float32Array(r.array),r.itemSize));break;case`LOD`:a=new xJ;break;case`Line`:a=new GJ(o(e.geometry),s(e.material));break;case`LineLoop`:a=new YJ(o(e.geometry),s(e.material));break;case`LineSegments`:a=new JJ(o(e.geometry),s(e.material));break;case`PointCloud`:case`Points`:a=new tY(o(e.geometry),s(e.material));break;case`Sprite`:a=new vJ(s(e.material));break;case`Group`:a=new Kq;break;case`Bone`:a=new OJ;break;default:a=new UG}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix===void 0?(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)):(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){let o=e.children;for(let e=0;e<o.length;e++)a.add(this.parseObject( __get$(o,e) ,t,n,r,i))}if(e.animations!==void 0){let t=e.animations;for(let e=0;e<t.length;e++){let n= __get$(t,e) ;a.animations.push( __get$(i,n) )}}if(e.type===`LOD`){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);let t=e.levels;for(let e=0;e<t.length;e++){let n= __get$(t,e) ,r=a.getObjectByProperty(`uuid`,n.object);r!==void 0&&a.addLevel(r,n.distance)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(e){if(e.isSkinnedMesh===!0&&e.skeleton!==void 0){let n= __get$(t,e.skeleton) ;n===void 0?console.warn(`THREE.ObjectLoader: No skeleton found with UUID:`,e.skeleton):e.bind(n,e.bindMatrix)}})}setTexturePath(e){return console.warn(`THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().`),this.setResourcePath(e)}},aZ={UVMapping:sH,CubeReflectionMapping:cH,CubeRefractionMapping:lH,EquirectangularReflectionMapping:uH,EquirectangularRefractionMapping:dH,CubeUVReflectionMapping:fH},oZ={RepeatWrapping:pH,ClampToEdgeWrapping:mH,MirroredRepeatWrapping:hH},sZ={NearestFilter:gH,NearestMipmapNearestFilter:_H,NearestMipmapLinearFilter:yH,LinearFilter:xH,LinearMipmapNearestFilter:SH,LinearMipmapLinearFilter:wH},cZ=class extends EX{constructor(e){super(e),typeof createImageBitmap>`u`&&console.warn(`THREE.ImageBitmapLoader: createImageBitmap() not supported.`),typeof fetch>`u`&&console.warn(`THREE.ImageBitmapLoader: fetch() not supported.`),this.options={premultiplyAlpha:`none`}}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=``),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,a=CX.get(e);if(a!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;let o={};o.credentials=this.crossOrigin===`anonymous`?`same-origin`:`include`,o.headers=this.requestHeader,fetch(e,o).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e, __call$(Object,"assign",[i.options,{colorSpaceConversion:`none`}]) )}).then(function(n){CX.add(e,n),t&&t(n),i.manager.itemEnd(e)}).catch(function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)}},cZ.prototype.isImageBitmapLoader=!0,uZ={getContext:function(){return lZ===void 0&&(lZ=new(window.AudioContext||window.webkitAudioContext)),lZ},setContext:function(e){lZ=e}},dZ=class extends EX{constructor(e){super(e)}load(e,t,n,r){let i=this,a=new OX(this.manager);a.setResponseType(`arraybuffer`),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(n){try{let e=n.slice(0);uZ.getContext().decodeAudioData(e,function(e){t(e)})}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}},n,r)}},fZ=class extends $X{constructor(e,t,n=1){super(void 0,n);let r=new kW().set(e),i=new kW().set(t),a=new Q(r.r,r.g,r.b),o=new Q(i.r,i.g,i.b),s=Math.sqrt(Math.PI),c=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(c)}},fZ.prototype.isHemisphereLightProbe=!0,pZ=class extends $X{constructor(e,t=1){super(void 0,t);let n=new kW().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}},pZ.prototype.isAmbientLightProbe=!0,mZ=new vG,hZ=new vG,gZ=new vG,_Z=class{constructor(){this.type=`StereoCamera`,this.aspect=1,this.eyeSep=.064,this.cameraL=new YK,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new YK,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){let t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,gZ.copy(e.projectionMatrix);let n=t.eyeSep/2,r=n*t.near/t.focus,i=t.near*Math.tan(vW*t.fov*.5)/t.zoom,a,o;hZ.elements[12]=-n,mZ.elements[12]=n,a=-i*t.aspect+r,o=i*t.aspect+r,gZ.elements[0]=2*t.near/(o-a),gZ.elements[8]=(o+a)/(o-a),this.cameraL.projectionMatrix.copy(gZ),a=-i*t.aspect-r,o=i*t.aspect-r,gZ.elements[0]=2*t.near/(o-a),gZ.elements[8]=(o+a)/(o-a),this.cameraR.projectionMatrix.copy(gZ)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(hZ),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(mZ)}},vZ=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=YB(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=YB();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}},yZ=new Q,bZ=new HW,xZ=new Q,SZ=new Q,CZ=class extends UG{constructor(){super(),this.type=`AudioListener`,this.context=uZ.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new vZ}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter===null?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);let t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(yZ,bZ,xZ),SZ.set(0,0,-1).applyQuaternion(bZ),t.positionX){let e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(yZ.x,e),t.positionY.linearRampToValueAtTime(yZ.y,e),t.positionZ.linearRampToValueAtTime(yZ.z,e),t.forwardX.linearRampToValueAtTime(SZ.x,e),t.forwardY.linearRampToValueAtTime(SZ.y,e),t.forwardZ.linearRampToValueAtTime(SZ.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(yZ.x,yZ.y,yZ.z),t.setOrientation(SZ.x,SZ.y,SZ.z,n.x,n.y,n.z)}},wZ=class extends UG{constructor(e){super(),this.type=`Audio`,this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType=`empty`,this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType=`audioNode`,this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType=`mediaNode`,this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType=`mediaStreamNode`,this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType=`buffer`,this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn(`THREE.Audio: Audio is already playing.`);return}if(this.hasPlaybackControl===!1){console.warn(`THREE.Audio: this Audio has no playback control.`);return}this._startedAt=this.context.currentTime+e;let t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn(`THREE.Audio: this Audio has no playback control.`);return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn(`THREE.Audio: this Audio has no playback control.`);return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++) __get$(this.filters,e-1) .connect( __get$(this.filters,e) ); __get$(this.filters,this.filters.length-1) .connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++) __get$(this.filters,e-1) .disconnect( __get$(this.filters,e) ); __get$(this.filters,this.filters.length-1) .disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||=[],this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn(`THREE.Audio: this Audio has no playback control.`);return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn(`THREE.Audio: this Audio has no playback control.`),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn(`THREE.Audio: this Audio has no playback control.`);return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},TZ=new Q,EZ=new HW,DZ=new Q,OZ=new Q,kZ=class extends wZ{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel=`HRTF`,this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(TZ,EZ,DZ),OZ.set(0,0,1).applyQuaternion(EZ);let t=this.panner;if(t.positionX){let e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(TZ.x,e),t.positionY.linearRampToValueAtTime(TZ.y,e),t.positionZ.linearRampToValueAtTime(TZ.z,e),t.orientationX.linearRampToValueAtTime(OZ.x,e),t.orientationY.linearRampToValueAtTime(OZ.y,e),t.orientationZ.linearRampToValueAtTime(OZ.z,e)}else t.setPosition(TZ.x,TZ.y,TZ.z),t.setOrientation(OZ.x,OZ.y,OZ.z)}},AZ=class{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+= __get$(t,n) ;return e/t.length}},jZ=class{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,i,a;switch(t){case`quaternion`:r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case`string`:case`bool`:r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=Array(n*5);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(a===0){for(let e=0;e!==r;++e) __set$(n,i+e,__get$(n,e)) ;a=t}else{a+=t;let e=t/a;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){let e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let e=t,i=t+t;e!==i;++e)if( __get$(n,e) !== __get$(n,e+t) ){o.setValue(n,r);break}}saveOriginalState(){let e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let e=n,i=r;e!==i;++e) __set$(t,e,__get$(t,r+e%n)) ;this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++) __set$(this.buffer,n,0) }_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(), __set$(this.buffer,this._addIndex*this.valueSize+3,1) }_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++) __set$(this.buffer,t+n,__get$(this.buffer,e+n)) }_select(e,t,n,r,i){if(r>=.5)for(let r=0;r!==i;++r) __set$(e,t+r,__get$(e,n+r)) }_slerp(e,t,n,r){HW.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){let a=this._workIndex*i;HW.multiplyQuaternionsFlat(e,a,e,t,e,n),HW.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,i){let a=1-r;for(let o=0;o!==i;++o){let i=t+o; __set$(e,i,__get$(e,i)*a+__get$(e,n+o)*r) }}_lerpAdditive(e,t,n,r,i){for(let a=0;a!==i;++a){let i=t+a; __set$(e,i,__get$(e,i)+__get$(e,n+a)*r) }}},MZ=`\\[\\]\\.:\\/`,NZ=RegExp(`[`+MZ+`]`,`g`),PZ=`[^`+MZ+`]`,FZ=`[^`+ __call$(MZ,"replace",[`\\.`,``]) +`]`,IZ= __call$(`((?:WC+[\\/:])*)`,"replace",[`WC`,PZ]) ,LZ= __call$(`(WCOD+)?`,"replace",[`WCOD`,FZ]) ,RZ= __call$(`(?:\\.(WC+)(?:\\[(.+)\\])?)?`,"replace",[`WC`,PZ]) ,zZ= __call$(`\\.(WC+)(?:\\[(.+)\\])?`,"replace",[`WC`,PZ]) ,BZ=RegExp(`^`+IZ+LZ+RZ+zZ+`$`),VZ=[`material`,`materials`,`bones`],HZ=class{constructor(e,t,n){let r=n||UZ.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,r= __get$(this._bindings,n) ;r!==void 0&&r.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r) __get$(n,r) .setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t) __get$(e,t) .bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t) __get$(e,t) .unbind()}},UZ=class e{constructor(t,n,r){this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}static sanitizeNodeName(e){return  __call$(__call$(e,"replace",[/\s/g,`_`]),"replace",[NZ,``]) }static parseTrackName(e){let t=BZ.exec(e);if(t===null)throw Error(`PropertyBinding: Cannot parse trackName: `+e);let n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(`.`);if(r!==void 0&&r!==-1){let e=n.nodeName.substring(r+1);VZ.indexOf(e)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(n.propertyName===null||n.propertyName.length===0)throw Error(`PropertyBinding: can not parse propertyName from trackName: `+e);return n}static findNode(e,t){if(t===void 0||t===``||t===`.`||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){let n=function(e){for(let r=0;r<e.length;r++){let i= __get$(e,r) ;if(i.name===t||i.uuid===t)return i;let a=n(i.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){ __set$(e,t,__get$(this.targetObject,this.propertyName)) }_getValue_array(e,t){let n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r) __set$(e,t++,__get$(n,r)) }_getValue_arrayElement(e,t){ __set$(e,t,__get$(this.resolvedProperty,this.propertyIndex)) }_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){ __set$(this.targetObject,this.propertyName,__get$(e,t)) }_setValue_direct_setNeedsUpdate(e,t){ __set$(this.targetObject,this.propertyName,__get$(e,t)) ,this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){ __set$(this.targetObject,this.propertyName,__get$(e,t)) ,this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r) __set$(n,r,__get$(e,t++)) }_setValue_array_setNeedsUpdate(e,t){let n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r) __set$(n,r,__get$(e,t++)) ;this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r) __set$(n,r,__get$(e,t++)) ;this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){ __set$(this.resolvedProperty,this.propertyIndex,__get$(e,t)) }_setValue_arrayElement_setNeedsUpdate(e,t){ __set$(this.resolvedProperty,this.propertyIndex,__get$(e,t)) ,this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){ __set$(this.resolvedProperty,this.propertyIndex,__get$(e,t)) ,this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,a=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error(`THREE.PropertyBinding: Trying to update node for track: `+this.path+` but it wasn't found.`);return}if(r){let e=n.objectIndex;switch(r){case`materials`:if(!t.material){console.error(`THREE.PropertyBinding: Can not bind to material as node does not have a material.`,this);return}if(!t.material.materials){console.error(`THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.`,this);return}t=t.material.materials;break;case`bones`:if(!t.skeleton){console.error(`THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.`,this);return}t=t.skeleton.bones;for(let n=0;n<t.length;n++)if( __get$(t,n) .name===e){e=n;break}break;default:if( __get$(t,r) ===void 0){console.error(`THREE.PropertyBinding: Can not bind to objectName of node undefined.`,this);return}t= __get$(t,r) }if(e!==void 0){if( __get$(t,e) ===void 0){console.error(`THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.`,this,t);return}t= __get$(t,e) }}let o= __get$(t,i) ;if(o===void 0){let e=n.nodeName;console.error(`THREE.PropertyBinding: Trying to update property for track: `+e+`.`+i+` but it wasn't found.`,t);return}let s=this.Versioning.None;this.targetObject=t,t.needsUpdate===void 0?t.matrixWorldNeedsUpdate!==void 0&&(s=this.Versioning.MatrixWorldNeedsUpdate):s=this.Versioning.NeedsUpdate;let c=this.BindingType.Direct;if(a!==void 0){if(i===`morphTargetInfluences`){if(!t.geometry){console.error(`THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.`,this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error(`THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.`,this);return} __get$(t.morphTargetDictionary,a) !==void 0&&(a= __get$(t.morphTargetDictionary,a) )}else{console.error(`THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.`,this);return}}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue= __get$(this.GetterByBindingType,c) ,this.setValue= __get$(__get$(this.SetterByBindingTypeAndVersioning,c),s) }unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},UZ.Composite=HZ,UZ.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},UZ.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},UZ.prototype.GetterByBindingType=[UZ.prototype._getValue_direct,UZ.prototype._getValue_array,UZ.prototype._getValue_arrayElement,UZ.prototype._getValue_toArray],UZ.prototype.SetterByBindingTypeAndVersioning=[[UZ.prototype._setValue_direct,UZ.prototype._setValue_direct_setNeedsUpdate,UZ.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[UZ.prototype._setValue_array,UZ.prototype._setValue_array_setNeedsUpdate,UZ.prototype._setValue_array_setMatrixWorldNeedsUpdate],[UZ.prototype._setValue_arrayElement,UZ.prototype._setValue_arrayElement_setNeedsUpdate,UZ.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[UZ.prototype._setValue_fromArray,UZ.prototype._setValue_fromArray_setNeedsUpdate,UZ.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],WZ=class{constructor(){this.uuid=PL(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let t=0,n=arguments.length;t!==n;++t) __set$(e,__get$(arguments,t).uuid,t) ;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){let e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length,o,s=e.length,c=this.nCachedObjects_;for(let l=0,u=arguments.length;l!==u;++l){let u= __get$(arguments,l) ,d=u.uuid,f= __get$(t,d) ;if(f===void 0){f=s++, __set$(t,d,f) ,e.push(u);for(let e=0,t=a;e!==t;++e) __get$(i,e) .push( new UZ(u,__get$(n,e),__get$(r,e)) )}else if(f<c){o= __get$(e,f) ;let s=--c,l= __get$(e,s) ; __set$(t,l.uuid,f) , __set$(e,f,l) , __set$(t,d,s) , __set$(e,s,u) ;for(let e=0,t=a;e!==t;++e){let t= __get$(i,e) ,a= __get$(t,s) ,o= __get$(t,f) ; __set$(t,f,a) ,o===void 0&&(o= new UZ(u,__get$(n,e),__get$(r,e)) ), __set$(t,s,o) }}else  __get$(e,f) !==o&&console.error(`THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.`)}this.nCachedObjects_=c}remove(){let e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){let o= __get$(arguments,a) ,s=o.uuid,c= __get$(t,s) ;if(c!==void 0&&c>=i){let a=i++,l= __get$(e,a) ; __set$(t,l.uuid,c) , __set$(e,c,l) , __set$(t,s,a) , __set$(e,a,o) ;for(let e=0,t=r;e!==t;++e){let t= __get$(n,e) ,r= __get$(t,a) ,i= __get$(t,c) ; __set$(t,c,r) , __set$(t,a,i) }}}this.nCachedObjects_=i}uncache(){let e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=e.length;for(let o=0,s=arguments.length;o!==s;++o){let s= __get$(arguments,o) .uuid,c= __get$(t,s) ;if(c!==void 0)if(delete t[s],c<i){let o=--i,s= __get$(e,o) ,l=--a,u= __get$(e,l) ; __set$(t,s.uuid,c) , __set$(e,c,s) , __set$(t,u.uuid,o) , __set$(e,o,u) ,e.pop();for(let e=0,t=r;e!==t;++e){let t= __get$(n,e) ,r= __get$(t,o) ,i= __get$(t,l) ; __set$(t,c,r) , __set$(t,o,i) ,t.pop()}}else{let i=--a,o= __get$(e,i) ;i>0&&( __set$(t,o.uuid,c) ), __set$(e,c,o) ,e.pop();for(let e=0,t=r;e!==t;++e){let t= __get$(n,e) ; __set$(t,c,__get$(t,i)) ,t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){let n=this._bindingsIndicesByPath,r= __get$(n,e) ,i=this._bindings;if(r!==void 0)return  __get$(i,r) ;let a=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=Array(c);r=i.length, __set$(n,e,r) ,a.push(e),o.push(t),i.push(u);for(let n=l,r=s.length;n!==r;++n){let r= __get$(s,n) ; __set$(u,n,new UZ(r,e,t)) }return u}unsubscribe_(e){let t=this._bindingsIndicesByPath,n= __get$(t,e) ;if(n!==void 0){let r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s= __get$(a,o) ,c= __get$(e,o) ; __set$(t,c,n) , __set$(a,n,s) ,a.pop(), __set$(i,n,__get$(i,o)) ,i.pop(), __set$(r,n,__get$(r,o)) ,r.pop()}}},WZ.prototype.isAnimationObjectGroup=!0,GZ=class{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;let i=t.tracks,a=i.length,o=Array(a),s={endingStart:DU,endingEnd:DU};for(let e=0;e!==a;++e){let t= __get$(i,e) .createInterpolant(null); __set$(o,e,t) ,t.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=SU,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){let n=this._clip.duration,r=e._clip.duration,i=r/n,a=n/r;e.warp(1,i,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){let r=this._mixer,i=r.time,a=this.timeScale,o=this._timeScaleInterpolant;o===null&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);let s=o.parameterPositions,c=o.sampleValues;return s[0]=i,s[1]=i+n,c[0]=e/a,c[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}let i=this._startTime;if(i!==null){let r=(e-i)*n;if(r<0||n===0)return;this._startTime=null,t=n*r}t*=this._updateTimeScale(e);let a=this._updateTime(t),o=this._updateWeight(e);if(o>0){let e=this._interpolants,t=this._propertyBindings;switch(this.blendMode){case jU:for(let n=0,r=e.length;n!==r;++n) __get$(e,n) .evaluate(a), __get$(t,n) .accumulateAdditive(o);break;case AU:default:for(let n=0,i=e.length;n!==i;++n) __get$(e,n) .evaluate(a), __get$(t,n) .accumulate(r,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let n=this._weightInterpolant;if(n!==null){let r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let n=this._timeScaleInterpolant;if(n!==null){let r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,a=n===CU;if(e===0)return i===-1?r:a&&(i&1)==1?t-r:r;if(n===xU){i===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));handle_stop:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break handle_stop}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:`finished`,action:this,direction:e<0?-1:1})}}else{if(i===-1&&(e>=0?(i=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){let n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);let o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:`finished`,action:this,direction:e>0?1:-1});else{if(o===1){let t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:`loop`,action:this,loopDelta:n})}}else this.time=r;if(a&&(i&1)==1)return t-r}return r}_setEndings(e,t,n){let r=this._interpolantSettings;n?(r.endingStart=OU,r.endingEnd=OU):(e?r.endingStart=this.zeroSlopeAtStart?OU:DU:r.endingStart=kU,t?r.endingEnd=this.zeroSlopeAtEnd?OU:DU:r.endingEnd=kU)}_scheduleFading(e,t,n){let r=this._mixer,i=r.time,a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);let o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}},KZ=class extends hW{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l= __get$(c,s) ;l===void 0&&(l={}, __set$(c,s,l) );for(let e=0;e!==i;++e){let i= __get$(r,e) ,c=i.name,u= __get$(l,c) ;if(u!==void 0)++u.referenceCount, __set$(a,e,u) ;else{if(u= __get$(a,e) ,u!==void 0){u._cacheIndex===null&&(++u.referenceCount,this._addInactiveBinding(u,s,c));continue}let r=t&& __get$(t._propertyBindings,e) .binding.parsedPath;u=new jZ(UZ.create(n,c,r),i.ValueTypeName,i.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,s,c), __set$(a,e,u) } __get$(o,e) .resultBuffer=u.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r= __get$(this._actionsByClip,n) ;this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}let t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){let n= __get$(t,e) ;n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){let n= __get$(t,e) ;--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){let r=this._actions,i=this._actionsByClip,a= __get$(i,t) ;if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0, __set$(i,t,a) ;else{let t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e), __set$(a.actionByRoot,n,e) }_removeInactiveAction(e){let t=this._actions,n= __get$(t,t.length-1) ,r=e._cacheIndex;n._cacheIndex=r, __set$(t,r,n) ,t.pop(),e._cacheIndex=null;let i=e._clip.uuid,a=this._actionsByClip,o= __get$(a,i) ,s=o.knownActions,c= __get$(s,s.length-1) ,l=e._byClipCacheIndex;c._byClipCacheIndex=l, __set$(s,l,c) ,s.pop(),e._byClipCacheIndex=null;let u=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],s.length===0&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){let n= __get$(t,e) ;--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i= __get$(t,r) ;e._cacheIndex=r, __set$(t,r,e) ,i._cacheIndex=n, __set$(t,n,i) }_takeBackAction(e){let t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i= __get$(t,r) ;e._cacheIndex=r, __set$(t,r,e) ,i._cacheIndex=n, __set$(t,n,i) }_addInactiveBinding(e,t,n){let r=this._bindingsByRootAndName,i=this._bindings,a= __get$(r,t) ;a===void 0&&(a={}, __set$(r,t,a) ), __set$(a,n,e) ,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){let t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o= __get$(a,r) ,s= __get$(t,t.length-1) ,c=e._cacheIndex;s._cacheIndex=c, __set$(t,c,s) ,t.pop(),delete o[i],Object.keys(o).length===0&&delete a[r]}_lendBinding(e){let t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i= __get$(t,r) ;e._cacheIndex=r, __set$(t,r,e) ,i._cacheIndex=n, __set$(t,n,i) }_takeBackBinding(e){let t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i= __get$(t,r) ;e._cacheIndex=r, __set$(t,r,e) ,i._cacheIndex=n, __set$(t,n,i) }_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n= __get$(e,t) ;return n===void 0&&(n=new fX(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t, __set$(e,t,n) ),n}_takeBackControlInterpolant(e){let t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i= __get$(t,r) ;e.__cacheIndex=r, __set$(t,r,e) ,i.__cacheIndex=n, __set$(t,n,i) }clipAction(e,t,n){let r=t||this._root,i=r.uuid,a=typeof e==`string`?SX.findByName(r,e):e,o=a===null?e:a.uuid,s= __get$(this._actionsByClip,o) ,c=null;if(n===void 0&&(n=a===null?AU:a.blendMode),s!==void 0){let e= __get$(s.actionByRoot,i) ;if(e!==void 0&&e.blendMode===n)return e;c=s.knownActions[0],a===null&&(a=c._clip)}if(a===null)return null;let l=new GZ(this,a,t,n);return this._bindAction(l,c),this._addInactiveAction(l,o,i),l}existingAction(e,t){let n=t||this._root,r=n.uuid,i=typeof e==`string`?SX.findByName(n,e):e,a=i?i.uuid:e,o= __get$(this._actionsByClip,a) ;return o===void 0?null: __get$(o.actionByRoot,r) ||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n) __get$(e,n) .stop();return this}update(e){e*=this.timeScale;let t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let o=0;o!==n;++o) __get$(t,o) ._update(r,e,i,a);let o=this._bindings,s=this._nActiveBindings;for(let e=0;e!==s;++e) __get$(o,e) .apply(a);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++) __get$(this._actions,e) .time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,n=e.uuid,r=this._actionsByClip,i= __get$(r,n) ;if(i!==void 0){let e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){let r= __get$(e,n) ;this._deactivateAction(r);let i=r._cacheIndex,a= __get$(t,t.length-1) ;r._cacheIndex=null,r._byClipCacheIndex=null,a._cacheIndex=i, __set$(t,i,a) ,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){let t=e.uuid,n=this._actionsByClip;for(let e in n){let r= __get$(__get$(n,e).actionByRoot,t) ;r!==void 0&&(this._deactivateAction(r),this._removeInactiveAction(r))}let r= __get$(this._bindingsByRootAndName,t) ;if(r!==void 0)for(let e in r){let t= __get$(r,e) ;t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){let n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}},KZ.prototype._controlInterpolantsResultBuffer=new Float32Array(1),qZ=class e{constructor(e){typeof e==`string`&&(console.warn(`THREE.Uniform: Type parameter is no longer needed.`),e=arguments[1]),this.value=e}clone(){return new e(this.value.clone===void 0?this.value:this.value.clone())}},JZ=class extends tJ{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){let t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){let t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}},JZ.prototype.isInstancedInterleavedBuffer=!0,YZ=class{constructor(e,t,n,r,i){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},YZ.prototype.isGLBufferAttribute=!0,XZ=class{constructor(e,t,n=0,r=1/0){this.ray=new _G(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new kG,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error(`THREE.Raycaster: Unsupported camera type: `+t.type)}intersectObject(e,t=!0,n=[]){return ZB(e,this,n,t),n.sort(XB),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)ZB( __get$(e,r) ,this,n,t);return n.sort(XB),n}},ZZ=class{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){let e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(FL(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},QZ=class{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}},$Z=new Z,eQ=class{constructor(e=new Z(1/0,1/0),t=new Z(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint( __get$(e,t) );return this}setFromCenterAndSize(e,t){let n=$Z.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return $Z.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},eQ.prototype.isBox2=!0,tQ=new Q,nQ=new Q,rQ=class{constructor(e=new Q,t=new Q){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){tQ.subVectors(e,this.start),nQ.subVectors(this.end,this.start);let n=nQ.dot(nQ),r=nQ.dot(tQ)/n;return t&&(r=FL(r,0,1)),r}closestPointToPoint(e,t,n){let r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},iQ=new Q,aQ=class extends UG{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;let n=new wK,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1;e<32;e++,t++){let n=e/32*Math.PI*2,i=t/32*Math.PI*2;r.push(Math.cos(n),Math.sin(n),1,Math.cos(i),Math.sin(i),1)}n.setAttribute(`position`,new hK(r,3)),this.cone=new JJ(n,new zJ({fog:!1,toneMapped:!1})),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),iQ.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(iQ),this.color===void 0?this.cone.material.color.copy(this.light.color):this.cone.material.color.set(this.color)}},oQ=new Q,sQ=new vG,cQ=new vG,lQ=class extends JJ{constructor(e){let t=QB(e),n=new wK,r=[],i=[],a=new kW(0,0,1),o=new kW(0,1,0);for(let e=0;e<t.length;e++){let n= __get$(t,e) ;n.parent&&n.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.setAttribute(`position`,new hK(r,3)),n.setAttribute(`color`,new hK(i,3));let s=new zJ({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,s),this.type=`SkeletonHelper`,this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){let t=this.bones,n=this.geometry,r=n.getAttribute(`position`);cQ.copy(this.root.matrixWorld).invert();for(let e=0,n=0;e<t.length;e++){let i= __get$(t,e) ;i.parent&&i.parent.isBone&&(sQ.multiplyMatrices(cQ,i.matrixWorld),oQ.setFromMatrixPosition(sQ),r.setXYZ(n,oQ.x,oQ.y,oQ.z),sQ.multiplyMatrices(cQ,i.parent.matrixWorld),oQ.setFromMatrixPosition(sQ),r.setXYZ(n+1,oQ.x,oQ.y,oQ.z),n+=2)}n.getAttribute(`position`).needsUpdate=!0,super.updateMatrixWorld(e)}},uQ=class extends HK{constructor(e,t,n){let r=new GY(t,4,2),i=new rK({wireframe:!0,fog:!1,toneMapped:!1});super(r,i),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type=`PointLightHelper`,this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color===void 0?this.material.color.copy(this.light.color):this.material.color.set(this.color)}},dQ=new Q,fQ=new kW,pQ=new kW,mQ=class extends UG{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;let r=new HY(t);r.rotateY(Math.PI*.5),this.material=new rK({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);let i=r.getAttribute(`position`),a=new Float32Array(i.count*3);r.setAttribute(`color`,new oK(a,3)),this.add(new HK(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{let t=e.geometry.getAttribute(`color`);fQ.copy(this.light.color),pQ.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){let r=e<n/2?fQ:pQ;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(dQ.setFromMatrixPosition(this.light.matrixWorld).negate())}},hQ=class extends JJ{constructor(e=10,t=10,n=4473924,r=8947848){n=new kW(n),r=new kW(r);let i=t/2,a=e/t,o=e/2,s=[],c=[];for(let e=0,l=0,u=-o;e<=t;e++,u+=a){s.push(-o,0,u,o,0,u),s.push(u,0,-o,u,0,o);let t=e===i?n:r;t.toArray(c,l),l+=3,t.toArray(c,l),l+=3,t.toArray(c,l),l+=3,t.toArray(c,l),l+=3}let l=new wK;l.setAttribute(`position`,new hK(s,3)),l.setAttribute(`color`,new hK(c,3));let u=new zJ({vertexColors:!0,toneMapped:!1});super(l,u),this.type=`GridHelper`}},gQ=class extends JJ{constructor(e=10,t=16,n=8,r=64,i=4473924,a=8947848){i=new kW(i),a=new kW(a);let o=[],s=[];for(let n=0;n<=t;n++){let r=n/t*(Math.PI*2),c=Math.sin(r)*e,l=Math.cos(r)*e;o.push(0,0,0),o.push(c,0,l);let u=n&1?i:a;s.push(u.r,u.g,u.b),s.push(u.r,u.g,u.b)}for(let t=0;t<=n;t++){let c=t&1?i:a,l=e-e/n*t;for(let e=0;e<r;e++){let t=e/r*(Math.PI*2),n=Math.sin(t)*l,i=Math.cos(t)*l;o.push(n,0,i),s.push(c.r,c.g,c.b),t=(e+1)/r*(Math.PI*2),n=Math.sin(t)*l,i=Math.cos(t)*l,o.push(n,0,i),s.push(c.r,c.g,c.b)}}let c=new wK;c.setAttribute(`position`,new hK(o,3)),c.setAttribute(`color`,new hK(s,3));let l=new zJ({vertexColors:!0,toneMapped:!1});super(c,l),this.type=`PolarGridHelper`}},_Q=new Q,vQ=new Q,yQ=new Q,bQ=class extends UG{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,t===void 0&&(t=1);let r=new wK;r.setAttribute(`position`,new hK([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let i=new zJ({fog:!1,toneMapped:!1});this.lightPlane=new GJ(r,i),this.add(this.lightPlane),r=new wK,r.setAttribute(`position`,new hK([0,0,0,0,0,1],3)),this.targetLine=new GJ(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){_Q.setFromMatrixPosition(this.light.matrixWorld),vQ.setFromMatrixPosition(this.light.target.matrixWorld),yQ.subVectors(vQ,_Q),this.lightPlane.lookAt(vQ),this.color===void 0?(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)):(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)),this.targetLine.lookAt(vQ),this.targetLine.scale.z=yQ.length()}},xQ=new Q,SQ=new JK,CQ=class extends JJ{constructor(e){let t=new wK,n=new zJ({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={},o=new kW(16755200),s=new kW(16711680),c=new kW(43775),l=new kW(16777215),u=new kW(3355443);d(`n1`,`n2`,o),d(`n2`,`n4`,o),d(`n4`,`n3`,o),d(`n3`,`n1`,o),d(`f1`,`f2`,o),d(`f2`,`f4`,o),d(`f4`,`f3`,o),d(`f3`,`f1`,o),d(`n1`,`f1`,o),d(`n2`,`f2`,o),d(`n3`,`f3`,o),d(`n4`,`f4`,o),d(`p`,`n1`,s),d(`p`,`n2`,s),d(`p`,`n3`,s),d(`p`,`n4`,s),d(`u1`,`u2`,c),d(`u2`,`u3`,c),d(`u3`,`u1`,c),d(`c`,`t`,l),d(`p`,`c`,u),d(`cn1`,`cn2`,u),d(`cn3`,`cn4`,u),d(`cf1`,`cf2`,u),d(`cf3`,`cf4`,u);function d(e,t,n){f(e,n),f(t,n)}function f(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b), __get$(a,e) ===void 0&&( __set$(a,e,[]) ), __get$(a,e) .push(r.length/3-1)}t.setAttribute(`position`,new hK(r,3)),t.setAttribute(`color`,new hK(i,3)),super(t,n),this.type=`CameraHelper`,this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}update(){let e=this.geometry,t=this.pointMap;SQ.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$B(`c`,t,e,SQ,0,0,-1),$B(`t`,t,e,SQ,0,0,1),$B(`n1`,t,e,SQ,-1,-1,-1),$B(`n2`,t,e,SQ,1,-1,-1),$B(`n3`,t,e,SQ,-1,1,-1),$B(`n4`,t,e,SQ,1,1,-1),$B(`f1`,t,e,SQ,-1,-1,1),$B(`f2`,t,e,SQ,1,-1,1),$B(`f3`,t,e,SQ,-1,1,1),$B(`f4`,t,e,SQ,1,1,1),$B(`u1`,t,e,SQ,1*.7,1*1.1,-1),$B(`u2`,t,e,SQ,-1*.7,1*1.1,-1),$B(`u3`,t,e,SQ,0,2,-1),$B(`cf1`,t,e,SQ,-1,0,1),$B(`cf2`,t,e,SQ,1,0,1),$B(`cf3`,t,e,SQ,0,-1,1),$B(`cf4`,t,e,SQ,0,1,1),$B(`cn1`,t,e,SQ,-1,0,-1),$B(`cn2`,t,e,SQ,1,0,-1),$B(`cn3`,t,e,SQ,0,-1,-1),$B(`cn4`,t,e,SQ,0,1,-1),e.getAttribute(`position`).needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},wQ=new GW,TQ=class extends JJ{constructor(e,t=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new wK;i.setIndex(new oK(n,1)),i.setAttribute(`position`,new oK(r,3)),super(i,new zJ({color:t,toneMapped:!1})),this.object=e,this.type=`BoxHelper`,this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn(`THREE.BoxHelper: .update() has no longer arguments.`),this.object!==void 0&&wQ.setFromObject(this.object),wQ.isEmpty())return;let t=wQ.min,n=wQ.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return JJ.prototype.copy.call(this,e),this.object=e.object,this}},EQ=class extends JJ{constructor(e,t=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],i=new wK;i.setIndex(new oK(n,1)),i.setAttribute(`position`,new hK(r,3)),super(i,new zJ({color:t,toneMapped:!1})),this.box=e,this.type=`Box3Helper`,this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}},DQ=class extends GJ{constructor(e,t=1,n=16776960){let r=n,i=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],a=new wK;a.setAttribute(`position`,new hK(i,3)),a.computeBoundingSphere(),super(a,new zJ({color:r,toneMapped:!1})),this.type=`PlaneHelper`,this.plane=e,this.size=t;let o=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],s=new wK;s.setAttribute(`position`,new hK(o,3)),s.computeBoundingSphere(),this.add(new HK(s,new rK({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?yV:0,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}},OQ=new Q,jQ=class extends UG{constructor(e=new Q(0,0,1),t=new Q(0,0,0),n=1,r=16776960,i=n*.2,a=i*.2){super(),this.type=`ArrowHelper`,kQ===void 0&&(kQ=new wK,kQ.setAttribute(`position`,new hK([0,0,0,0,1,0],3)),AQ=new DY(0,.5,1,5,1),AQ.translate(0,-.5,0)),this.position.copy(t),this.line=new GJ(kQ,new zJ({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new HK(AQ,new rK({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{OQ.set(e.z,0,-e.x).normalize();let t=Math.acos(e.y);this.quaternion.setFromAxisAngle(OQ,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}},MQ=class extends JJ{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new wK;r.setAttribute(`position`,new hK(t,3)),r.setAttribute(`color`,new hK(n,3));let i=new zJ({vertexColors:!0,toneMapped:!1});super(r,i),this.type=`AxesHelper`}setColors(e,t,n){let r=new kW,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},NQ=class{constructor(){this.type=`ShapePath`,this.color=new kW,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new CY,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(e){let t=[];for(let n=0,r=e.length;n<r;n++){let r= __get$(e,n) ,i=new IY;i.curves=r.curves,t.push(i)}return t}function r(e,t){let n=t.length,r=!1;for(let i=n-1,a=0;a<n;i=a++){let n= __get$(t,i) ,o= __get$(t,a) ,s=o.x-n.x,c=o.y-n.y;if(Math.abs(c)>2**-52){if(c<0&&(n= __get$(t,a) ,s=-s,o= __get$(t,i) ,c=-c),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{let t=c*(e.x-n.x)-s*(e.y-n.y);if(t===0)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return r}let i=RY.isClockWise,a=this.subPaths;if(a.length===0)return[];if(t===!0)return n(a);let o,s,c,l=[];if(a.length===1)return s=a[0],c=new IY,c.curves=s.curves,l.push(c),l;let u=!i(a[0].getPoints());u=e?!u:u;let d=[],f=[],p=[],m=0,h; __set$(f,m,void 0) , __set$(p,m,[]) ;for(let t=0,n=a.length;t<n;t++)s= __get$(a,t) ,h=s.getPoints(),o=i(h),o=e?!o:o,o?(!u&& __get$(f,m) &&m++, __set$(f,m,{s:new IY(),p:h}) , __get$(f,m) .s.curves=s.curves,u&&m++, __set$(p,m,[]) ): __get$(p,m) .push({h:s,p:h[0]});if(!f[0])return n(a);if(f.length>1){let e=!1,t=0;for(let e=0,t=f.length;e<t;e++) __set$(d,e,[]) ;for(let n=0,i=f.length;n<i;n++){let i= __get$(p,n) ;for(let a=0;a<i.length;a++){let o= __get$(i,a) ,s=!0;for(let i=0;i<f.length;i++)r(o.p, __get$(f,i) .p)&&(n!==i&&t++,s?(s=!1, __get$(d,i) .push(o)):e=!0);s&& __get$(d,n) .push(o)}}t>0&&e===!1&&(p=d)}let g;for(let e=0,t=f.length;e<t;e++){c= __get$(f,e) .s,l.push(c),g= __get$(p,e) ;for(let e=0,t=g.length;e<t;e++)c.holes.push( __get$(g,e) .h)}return l}},PQ=class{static toHalfFloat(e){Math.abs(e)>65504&&console.warn(`THREE.DataUtils.toHalfFloat(): Value out of range.`),e=FL(e,-65504,65504),IQ[0]=e;let t=LQ[0],n=t>>23&511;return  __get$(RQ,n) +((t&8388607)>> __get$(zQ,n) )}static fromHalfFloat(e){let t=e>>10;return LQ[0]= __get$(BQ,__get$(HQ,t)+(e&1023)) + __get$(VQ,t) ,IQ[0]}},FQ=new ArrayBuffer(4),IQ=new Float32Array(FQ),LQ=new Uint32Array(FQ),RQ=new Uint32Array(512),zQ=new Uint32Array(512);for(let e=0;e<256;++e){let t=e-127;t<-27?( __set$(RQ,e,0) , __set$(RQ,e|256,32768) , __set$(zQ,e,24) , __set$(zQ,e|256,24) ):t<-14?( __set$(RQ,e,1024>>-t-14) , __set$(RQ,e|256,1024>>-t-14|32768) , __set$(zQ,e,-t-1) , __set$(zQ,e|256,-t-1) ):t<=15?( __set$(RQ,e,t+15<<10) , __set$(RQ,e|256,t+15<<10|32768) , __set$(zQ,e,13) , __set$(zQ,e|256,13) ):t<128?( __set$(RQ,e,31744) , __set$(RQ,e|256,64512) , __set$(zQ,e,24) , __set$(zQ,e|256,24) ):( __set$(RQ,e,31744) , __set$(RQ,e|256,64512) , __set$(zQ,e,13) , __set$(zQ,e|256,13) )}BQ=new Uint32Array(2048),VQ=new Uint32Array(64),HQ=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,n=0;for(;!(t&8388608);)t<<=1,n-=8388608;t&=-8388609,n+=947912704, __set$(BQ,e,t|n) }for(let e=1024;e<2048;++e) __set$(BQ,e,939524096+(e-1024<<13)) ;for(let e=1;e<31;++e) __set$(VQ,e,e<<23) ;VQ[31]=1199570944,VQ[32]=2147483648;for(let e=33;e<63;++e) __set$(VQ,e,2147483648+(e-32<<23)) ;VQ[63]=3347054592;for(let e=1;e<64;++e)e!==32&&( __set$(HQ,e,1024) );UQ=0,WQ=1,GQ=0,KQ=1,qQ=2,JQ=class extends tY{constructor(e,t){console.warn(`THREE.PointCloud has been renamed to THREE.Points.`),super(e,t)}},YQ=class extends vJ{constructor(e){console.warn(`THREE.Particle has been renamed to THREE.Sprite.`),super(e)}},XQ=class extends tY{constructor(e,t){console.warn(`THREE.ParticleSystem has been renamed to THREE.Points.`),super(e,t)}},ZQ=class extends XJ{constructor(e){console.warn(`THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.`),super(e)}},QQ=class extends XJ{constructor(e){console.warn(`THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.`),super(e)}},$Q=class extends XJ{constructor(e){console.warn(`THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.`),super(e)}},e$=class extends Q{constructor(e,t,n){console.warn(`THREE.Vertex has been removed. Use THREE.Vector3 instead.`),super(e,t,n)}},t$=class extends oK{constructor(e,t){console.warn(`THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead.`),super(e,t),this.setUsage(iW)}},n$=class extends sK{constructor(e,t){console.warn(`THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.`),super(e,t)}},r$=class extends cK{constructor(e,t){console.warn(`THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.`),super(e,t)}},i$=class extends lK{constructor(e,t){console.warn(`THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.`),super(e,t)}},a$=class extends uK{constructor(e,t){console.warn(`THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.`),super(e,t)}},o$=class extends dK{constructor(e,t){console.warn(`THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.`),super(e,t)}},s$=class extends fK{constructor(e,t){console.warn(`THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.`),super(e,t)}},c$=class extends pK{constructor(e,t){console.warn(`THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.`),super(e,t)}},l$=class extends hK{constructor(e,t){console.warn(`THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.`),super(e,t)}},u$=class extends gK{constructor(e,t){console.warn(`THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.`),super(e,t)}},oY.create=function(e,t){return console.log(`THREE.Curve.create() has been deprecated`),e.prototype=Object.create(oY.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},CY.prototype.fromPoints=function(e){return console.warn(`THREE.Path: .fromPoints() has been renamed to .setFromPoints().`),this.setFromPoints(e)},d$=class extends MQ{constructor(e){console.warn(`THREE.AxisHelper has been renamed to THREE.AxesHelper.`),super(e)}},f$=class extends TQ{constructor(e,t){console.warn(`THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.`),super(e,t)}},p$=class extends JJ{constructor(e,t){console.warn(`THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.`),super(new FY(e.geometry),new zJ({color:t===void 0?16777215:t}))}},hQ.prototype.setColors=function(){console.error(`THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.`)},lQ.prototype.update=function(){console.error(`THREE.SkeletonHelper: update() no longer needs to be called.`)},m$=class extends JJ{constructor(e,t){console.warn(`THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.`),super(new XY(e.geometry),new zJ({color:t===void 0?16777215:t}))}},EX.prototype.extractUrlBase=function(e){return console.warn(`THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.`),tZ.extractUrlBase(e)},EX.Handlers={add:function(){console.error(`THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.`)},get:function(){console.error(`THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.`)}},h$=class extends OX{constructor(e){console.warn(`THREE.XHRLoader has been renamed to THREE.FileLoader.`),super(e)}},g$=class extends NX{constructor(e){console.warn(`THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.`),super(e)}},eQ.prototype.center=function(e){return console.warn(`THREE.Box2: .center() has been renamed to .getCenter().`),this.getCenter(e)},eQ.prototype.empty=function(){return console.warn(`THREE.Box2: .empty() has been renamed to .isEmpty().`),this.isEmpty()},eQ.prototype.isIntersectionBox=function(e){return console.warn(`THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().`),this.intersectsBox(e)},eQ.prototype.size=function(e){return console.warn(`THREE.Box2: .size() has been renamed to .getSize().`),this.getSize(e)},GW.prototype.center=function(e){return console.warn(`THREE.Box3: .center() has been renamed to .getCenter().`),this.getCenter(e)},GW.prototype.empty=function(){return console.warn(`THREE.Box3: .empty() has been renamed to .isEmpty().`),this.isEmpty()},GW.prototype.isIntersectionBox=function(e){return console.warn(`THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().`),this.intersectsBox(e)},GW.prototype.isIntersectionSphere=function(e){return console.warn(`THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().`),this.intersectsSphere(e)},GW.prototype.size=function(e){return console.warn(`THREE.Box3: .size() has been renamed to .getSize().`),this.getSize(e)},OG.prototype.toVector3=function(){console.error(`THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead`)},lG.prototype.empty=function(){return console.warn(`THREE.Sphere: .empty() has been renamed to .isEmpty().`),this.isEmpty()},sq.prototype.setFromMatrix=function(e){return console.warn(`THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix().`),this.setFromProjectionMatrix(e)},rQ.prototype.center=function(e){return console.warn(`THREE.Line3: .center() has been renamed to .getCenter().`),this.getCenter(e)},xW.prototype.flattenToArrayOffset=function(e,t){return console.warn(`THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.`),this.toArray(e,t)},xW.prototype.multiplyVector3=function(e){return console.warn(`THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.`),e.applyMatrix3(this)},xW.prototype.multiplyVector3Array=function(){console.error(`THREE.Matrix3: .multiplyVector3Array() has been removed.`)},xW.prototype.applyToBufferAttribute=function(e){return console.warn(`THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead.`),e.applyMatrix3(this)},xW.prototype.applyToVector3Array=function(){console.error(`THREE.Matrix3: .applyToVector3Array() has been removed.`)},xW.prototype.getInverse=function(e){return console.warn(`THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.`),this.copy(e).invert()},vG.prototype.extractPosition=function(e){return console.warn(`THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().`),this.copyPosition(e)},vG.prototype.flattenToArrayOffset=function(e,t){return console.warn(`THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.`),this.toArray(e,t)},vG.prototype.getPosition=function(){return console.warn(`THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.`),new Q().setFromMatrixColumn(this,3)},vG.prototype.setRotationFromQuaternion=function(e){return console.warn(`THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().`),this.makeRotationFromQuaternion(e)},vG.prototype.multiplyToArray=function(){console.warn(`THREE.Matrix4: .multiplyToArray() has been removed.`)},vG.prototype.multiplyVector3=function(e){return console.warn(`THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.`),e.applyMatrix4(this)},vG.prototype.multiplyVector4=function(e){return console.warn(`THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.`),e.applyMatrix4(this)},vG.prototype.multiplyVector3Array=function(){console.error(`THREE.Matrix4: .multiplyVector3Array() has been removed.`)},vG.prototype.rotateAxis=function(e){console.warn(`THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.`),e.transformDirection(this)},vG.prototype.crossVector=function(e){return console.warn(`THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.`),e.applyMatrix4(this)},vG.prototype.translate=function(){console.error(`THREE.Matrix4: .translate() has been removed.`)},vG.prototype.rotateX=function(){console.error(`THREE.Matrix4: .rotateX() has been removed.`)},vG.prototype.rotateY=function(){console.error(`THREE.Matrix4: .rotateY() has been removed.`)},vG.prototype.rotateZ=function(){console.error(`THREE.Matrix4: .rotateZ() has been removed.`)},vG.prototype.rotateByAxis=function(){console.error(`THREE.Matrix4: .rotateByAxis() has been removed.`)},vG.prototype.applyToBufferAttribute=function(e){return console.warn(`THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead.`),e.applyMatrix4(this)},vG.prototype.applyToVector3Array=function(){console.error(`THREE.Matrix4: .applyToVector3Array() has been removed.`)},vG.prototype.makeFrustum=function(e,t,n,r,i,a){return console.warn(`THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.`),this.makePerspective(e,t,r,n,i,a)},vG.prototype.getInverse=function(e){return console.warn(`THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.`),this.copy(e).invert()},iq.prototype.isIntersectionLine=function(e){return console.warn(`THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().`),this.intersectsLine(e)},HW.prototype.multiplyVector3=function(e){return console.warn(`THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.`),e.applyQuaternion(this)},HW.prototype.inverse=function(){return console.warn(`THREE.Quaternion: .inverse() has been renamed to invert().`),this.invert()},_G.prototype.isIntersectionBox=function(e){return console.warn(`THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().`),this.intersectsBox(e)},_G.prototype.isIntersectionPlane=function(e){return console.warn(`THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().`),this.intersectsPlane(e)},_G.prototype.isIntersectionSphere=function(e){return console.warn(`THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().`),this.intersectsSphere(e)},eK.prototype.area=function(){return console.warn(`THREE.Triangle: .area() has been renamed to .getArea().`),this.getArea()},eK.prototype.barycoordFromPoint=function(e,t){return console.warn(`THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().`),this.getBarycoord(e,t)},eK.prototype.midpoint=function(e){return console.warn(`THREE.Triangle: .midpoint() has been renamed to .getMidpoint().`),this.getMidpoint(e)},eK.prototypenormal=function(e){return console.warn(`THREE.Triangle: .normal() has been renamed to .getNormal().`),this.getNormal(e)},eK.prototype.plane=function(e){return console.warn(`THREE.Triangle: .plane() has been renamed to .getPlane().`),this.getPlane(e)},eK.barycoordFromPoint=function(e,t,n,r,i){return console.warn(`THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().`),eK.getBarycoord(e,t,n,r,i)},eK.normal=function(e,t,n,r){return console.warn(`THREE.Triangle: .normal() has been renamed to .getNormal().`),eK.getNormal(e,t,n,r)},IY.prototype.extractAllPoints=function(e){return console.warn(`THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.`),this.extractPoints(e)},IY.prototype.extrude=function(e){return console.warn(`THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.`),new zY(this,e)},IY.prototype.makeGeometry=function(e){return console.warn(`THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.`),new WY(this,e)},Z.prototype.fromAttribute=function(e,t,n){return console.warn(`THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().`),this.fromBufferAttribute(e,t,n)},Z.prototype.distanceToManhattan=function(e){return console.warn(`THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().`),this.manhattanDistanceTo(e)},Z.prototype.lengthManhattan=function(){return console.warn(`THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().`),this.manhattanLength()},Q.prototype.setEulerFromRotationMatrix=function(){console.error(`THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.`)},Q.prototype.setEulerFromQuaternion=function(){console.error(`THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.`)},Q.prototype.getPositionFromMatrix=function(e){return console.warn(`THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().`),this.setFromMatrixPosition(e)},Q.prototype.getScaleFromMatrix=function(e){return console.warn(`THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().`),this.setFromMatrixScale(e)},Q.prototype.getColumnFromMatrix=function(e,t){return console.warn(`THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().`),this.setFromMatrixColumn(t,e)},Q.prototype.applyProjection=function(e){return console.warn(`THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.`),this.applyMatrix4(e)},Q.prototype.fromAttribute=function(e,t,n){return console.warn(`THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().`),this.fromBufferAttribute(e,t,n)},Q.prototype.distanceToManhattan=function(e){return console.warn(`THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().`),this.manhattanDistanceTo(e)},Q.prototype.lengthManhattan=function(){return console.warn(`THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().`),this.manhattanLength()},FW.prototype.fromAttribute=function(e,t,n){return console.warn(`THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().`),this.fromBufferAttribute(e,t,n)},FW.prototype.lengthManhattan=function(){return console.warn(`THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().`),this.manhattanLength()},UG.prototype.getChildByName=function(e){return console.warn(`THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().`),this.getObjectByName(e)},UG.prototype.renderDepth=function(){console.warn(`THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.`)},UG.prototype.translate=function(e,t){return console.warn(`THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.`),this.translateOnAxis(t,e)},UG.prototype.getWorldRotation=function(){console.error(`THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.`)},UG.prototype.applyMatrix=function(e){return console.warn(`THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4().`),this.applyMatrix4(e)},Object.defineProperties(UG.prototype,{eulerOrder:{get:function(){return console.warn(`THREE.Object3D: .eulerOrder is now .rotation.order.`),this.rotation.order},set:function(e){console.warn(`THREE.Object3D: .eulerOrder is now .rotation.order.`),this.rotation.order=e}},useQuaternion:{get:function(){console.warn(`THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.`)},set:function(){console.warn(`THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.`)}}}),HK.prototype.setDrawMode=function(){console.error(`THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.`)},Object.defineProperties(HK.prototype,{drawMode:{get:function(){return console.error(`THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode.`),MU},set:function(){console.error(`THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.`)}}}),DJ.prototype.initBones=function(){console.error(`THREE.SkinnedMesh: initBones() has been removed.`)},YK.prototype.setLens=function(e,t){console.warn(`THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.`),t!==void 0&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(FX.prototype,{onlyShadow:{set:function(){console.warn(`THREE.Light: .onlyShadow has been removed.`)}},shadowCameraFov:{set:function(e){console.warn(`THREE.Light: .shadowCameraFov is now .shadow.camera.fov.`),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn(`THREE.Light: .shadowCameraLeft is now .shadow.camera.left.`),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn(`THREE.Light: .shadowCameraRight is now .shadow.camera.right.`),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn(`THREE.Light: .shadowCameraTop is now .shadow.camera.top.`),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn(`THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.`),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn(`THREE.Light: .shadowCameraNear is now .shadow.camera.near.`),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn(`THREE.Light: .shadowCameraFar is now .shadow.camera.far.`),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn(`THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.`)}},shadowBias:{set:function(e){console.warn(`THREE.Light: .shadowBias is now .shadow.bias.`),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn(`THREE.Light: .shadowDarkness has been removed.`)}},shadowMapWidth:{set:function(e){console.warn(`THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.`),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn(`THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.`),this.shadow.mapSize.height=e}}}),Object.defineProperties(oK.prototype,{length:{get:function(){return console.warn(`THREE.BufferAttribute: .length has been deprecated. Use .count instead.`),this.array.length}},dynamic:{get:function(){return console.warn(`THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.`),this.usage===iW},set:function(){console.warn(`THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.`),this.setUsage(iW)}}}),oK.prototype.setDynamic=function(e){return console.warn(`THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead.`),this.setUsage(e===!0?iW:rW),this},oK.prototype.copyIndicesArray=function(){console.error(`THREE.BufferAttribute: .copyIndicesArray() has been removed.`)},oK.prototype.setArray=function(){console.error(`THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers`)},wK.prototype.addIndex=function(e){console.warn(`THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().`),this.setIndex(e)},wK.prototype.addAttribute=function(e,t){return console.warn(`THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute().`),!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)?(console.warn(`THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).`),this.setAttribute(e,new oK(arguments[1],arguments[2]))):e===`index`?(console.warn(`THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.`),this.setIndex(t),this):this.setAttribute(e,t)},wK.prototype.addDrawCall=function(e,t,n){n!==void 0&&console.warn(`THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.`),console.warn(`THREE.BufferGeometry: .addDrawCall() is now .addGroup().`),this.addGroup(e,t)},wK.prototype.clearDrawCalls=function(){console.warn(`THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().`),this.clearGroups()},wK.prototype.computeOffsets=function(){console.warn(`THREE.BufferGeometry: .computeOffsets() has been removed.`)},wK.prototype.removeAttribute=function(e){return console.warn(`THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute().`),this.deleteAttribute(e)},wK.prototype.applyMatrix=function(e){return console.warn(`THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4().`),this.applyMatrix4(e)},Object.defineProperties(wK.prototype,{drawcalls:{get:function(){return console.error(`THREE.BufferGeometry: .drawcalls has been renamed to .groups.`),this.groups}},offsets:{get:function(){return console.warn(`THREE.BufferGeometry: .offsets has been renamed to .groups.`),this.groups}}}),tJ.prototype.setDynamic=function(e){return console.warn(`THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead.`),this.setUsage(e===!0?iW:rW),this},tJ.prototype.setArray=function(){console.error(`THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers`)},zY.prototype.getArrays=function(){console.error(`THREE.ExtrudeGeometry: .getArrays() has been removed.`)},zY.prototype.addShapeList=function(){console.error(`THREE.ExtrudeGeometry: .addShapeList() has been removed.`)},zY.prototype.addShape=function(){console.error(`THREE.ExtrudeGeometry: .addShape() has been removed.`)},eJ.prototype.dispose=function(){console.error(`THREE.Scene: .dispose() has been removed.`)},qZ.prototype.onUpdate=function(){return console.warn(`THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.`),this},Object.defineProperties(nK.prototype,{wrapAround:{get:function(){console.warn(`THREE.Material: .wrapAround has been removed.`)},set:function(){console.warn(`THREE.Material: .wrapAround has been removed.`)}},overdraw:{get:function(){console.warn(`THREE.Material: .overdraw has been removed.`)},set:function(){console.warn(`THREE.Material: .overdraw has been removed.`)}},wrapRGB:{get:function(){return console.warn(`THREE.Material: .wrapRGB has been removed.`),new kW}},shading:{get:function(){console.error(`THREE.`+this.type+`: .shading has been removed. Use the boolean .flatShading instead.`)},set:function(e){console.warn(`THREE.`+this.type+`: .shading has been removed. Use the boolean .flatShading instead.`),this.flatShading=e===bV}},stencilMask:{get:function(){return console.warn(`THREE.`+this.type+`: .stencilMask has been removed. Use .stencilFuncMask instead.`),this.stencilFuncMask},set:function(e){console.warn(`THREE.`+this.type+`: .stencilMask has been removed. Use .stencilFuncMask instead.`),this.stencilFuncMask=e}},vertexTangents:{get:function(){console.warn(`THREE.`+this.type+`: .vertexTangents has been removed.`)},set:function(){console.warn(`THREE.`+this.type+`: .vertexTangents has been removed.`)}}}),Object.defineProperties(qK.prototype,{derivatives:{get:function(){return console.warn(`THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.`),this.extensions.derivatives},set:function(e){console.warn(`THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.`),this.extensions.derivatives=e}}}),_B.prototype.clearTarget=function(e,t,n,r){console.warn(`THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.`),this.setRenderTarget(e),this.clear(t,n,r)},_B.prototype.animate=function(e){console.warn(`THREE.WebGLRenderer: .animate() is now .setAnimationLoop().`),this.setAnimationLoop(e)},_B.prototype.getCurrentRenderTarget=function(){return console.warn(`THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().`),this.getRenderTarget()},_B.prototype.getMaxAnisotropy=function(){return console.warn(`THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().`),this.capabilities.getMaxAnisotropy()},_B.prototype.getPrecision=function(){return console.warn(`THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.`),this.capabilities.precision},_B.prototype.resetGLState=function(){return console.warn(`THREE.WebGLRenderer: .resetGLState() is now .state.reset().`),this.state.reset()},_B.prototype.supportsFloatTextures=function(){return console.warn(`THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).`),this.extensions.get(`OES_texture_float`)},_B.prototype.supportsHalfFloatTextures=function(){return console.warn(`THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).`),this.extensions.get(`OES_texture_half_float`)},_B.prototype.supportsStandardDerivatives=function(){return console.warn(`THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).`),this.extensions.get(`OES_standard_derivatives`)},_B.prototype.supportsCompressedTextureS3TC=function(){return console.warn(`THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).`),this.extensions.get(`WEBGL_compressed_texture_s3tc`)},_B.prototype.supportsCompressedTexturePVRTC=function(){return console.warn(`THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).`),this.extensions.get(`WEBGL_compressed_texture_pvrtc`)},_B.prototype.supportsBlendMinMax=function(){return console.warn(`THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).`),this.extensions.get(`EXT_blend_minmax`)},_B.prototype.supportsVertexTextures=function(){return console.warn(`THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.`),this.capabilities.vertexTextures},_B.prototype.supportsInstancedArrays=function(){return console.warn(`THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).`),this.extensions.get(`ANGLE_instanced_arrays`)},_B.prototype.enableScissorTest=function(e){console.warn(`THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().`),this.setScissorTest(e)},_B.prototype.initMaterial=function(){console.warn(`THREE.WebGLRenderer: .initMaterial() has been removed.`)},_B.prototype.addPrePlugin=function(){console.warn(`THREE.WebGLRenderer: .addPrePlugin() has been removed.`)},_B.prototype.addPostPlugin=function(){console.warn(`THREE.WebGLRenderer: .addPostPlugin() has been removed.`)},_B.prototype.updateShadowMap=function(){console.warn(`THREE.WebGLRenderer: .updateShadowMap() has been removed.`)},_B.prototype.setFaceCulling=function(){console.warn(`THREE.WebGLRenderer: .setFaceCulling() has been removed.`)},_B.prototype.allocTextureUnit=function(){console.warn(`THREE.WebGLRenderer: .allocTextureUnit() has been removed.`)},_B.prototype.setTexture=function(){console.warn(`THREE.WebGLRenderer: .setTexture() has been removed.`)},_B.prototype.setTexture2D=function(){console.warn(`THREE.WebGLRenderer: .setTexture2D() has been removed.`)},_B.prototype.setTextureCube=function(){console.warn(`THREE.WebGLRenderer: .setTextureCube() has been removed.`)},_B.prototype.getActiveMipMapLevel=function(){return console.warn(`THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel().`),this.getActiveMipmapLevel()},Object.defineProperties(_B.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn(`THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.`),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn(`THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.`),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn(`THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.`)},set:function(){console.warn(`THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.`)}},context:{get:function(){return console.warn(`THREE.WebGLRenderer: .context has been removed. Use .getContext() instead.`),this.getContext()}},vr:{get:function(){return console.warn(`THREE.WebGLRenderer: .vr has been renamed to .xr`),this.xr}},gammaInput:{get:function(){return console.warn(`THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.`),!1},set:function(){console.warn(`THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.`)}},gammaOutput:{get:function(){return console.warn(`THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.`),!1},set:function(e){console.warn(`THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.`),this.outputEncoding=e===!0?PU:NU}},toneMappingWhitePoint:{get:function(){return console.warn(`THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.`),1},set:function(){console.warn(`THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.`)}},gammaFactor:{get:function(){return console.warn(`THREE.WebGLRenderer: .gammaFactor has been removed.`),2},set:function(){console.warn(`THREE.WebGLRenderer: .gammaFactor has been removed.`)}}}),Object.defineProperties(hB.prototype,{cullFace:{get:function(){console.warn(`THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.`)},set:function(){console.warn(`THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.`)}},renderReverseSided:{get:function(){console.warn(`THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.`)},set:function(){console.warn(`THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.`)}},renderSingleSided:{get:function(){console.warn(`THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.`)},set:function(){console.warn(`THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.`)}}}),_$=class extends eq{constructor(e,t,n){console.warn(`THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options ).`),super(e,n)}},Object.defineProperties(IW.prototype,{wrapS:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.`),this.texture.wrapS},set:function(e){console.warn(`THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.`),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.`),this.texture.wrapT},set:function(e){console.warn(`THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.`),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.`),this.texture.magFilter},set:function(e){console.warn(`THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.`),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.`),this.texture.minFilter},set:function(e){console.warn(`THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.`),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.`),this.texture.anisotropy},set:function(e){console.warn(`THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.`),this.texture.anisotropy=e}},offset:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .offset is now .texture.offset.`),this.texture.offset},set:function(e){console.warn(`THREE.WebGLRenderTarget: .offset is now .texture.offset.`),this.texture.offset=e}},repeat:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .repeat is now .texture.repeat.`),this.texture.repeat},set:function(e){console.warn(`THREE.WebGLRenderTarget: .repeat is now .texture.repeat.`),this.texture.repeat=e}},format:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .format is now .texture.format.`),this.texture.format},set:function(e){console.warn(`THREE.WebGLRenderTarget: .format is now .texture.format.`),this.texture.format=e}},type:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .type is now .texture.type.`),this.texture.type},set:function(e){console.warn(`THREE.WebGLRenderTarget: .type is now .texture.type.`),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn(`THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.`),this.texture.generateMipmaps},set:function(e){console.warn(`THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.`),this.texture.generateMipmaps=e}}}),wZ.prototype.load=function(e){console.warn(`THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.`);let t=this;return new dZ().load(e,function(e){t.setBuffer(e)}),this},AZ.prototype.getData=function(){return console.warn(`THREE.AudioAnalyser: .getData() is now .getFrequencyData().`),this.getFrequencyData()},QK.prototype.updateCubeMap=function(e,t){return console.warn(`THREE.CubeCamera: .updateCubeMap() is now .update().`),this.update(e,t)},QK.prototype.clear=function(e,t,n,r){return console.warn(`THREE.CubeCamera: .clear() is now .renderTarget.clear().`),this.renderTarget.clear(e,t,n,r)},jW.crossOrigin=void 0,jW.loadTexture=function(e,t,n,r){console.warn(`THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.`);let i=new PX;i.setCrossOrigin(this.crossOrigin);let a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},jW.loadTextureCube=function(e,t,n,r){console.warn(`THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.`);let i=new MX;i.setCrossOrigin(this.crossOrigin);let a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},jW.loadCompressedTexture=function(){console.error(`THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.`)},jW.loadCompressedTextureCube=function(){console.error(`THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.`)},v$={createMultiMaterialObject:function(){console.error(`THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js`)},detach:function(){console.error(`THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js`)},attach:function(){console.error(`THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js`)}},y$=class extends wK{constructor(){console.error(`THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js`),super()}},b$=class extends wK{constructor(){console.error(`THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js`),super()}},x$=class extends IW{constructor(e,t,n){console.error(`THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.`),super(e,t,n),this.samples=4}},S$=class extends LW{constructor(e,t,n,r){console.warn(`THREE.DataTexture2DArray has been renamed to DataArrayTexture.`),super(e,t,n,r)}},C$=class extends zW{constructor(e,t,n,r){console.warn(`THREE.DataTexture3D has been renamed to Data3DTexture.`),super(e,t,n,r)}},typeof __THREE_DEVTOOLS__<`u`&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent(`register`,{detail:{revision:cV}})),typeof window<`u`&&(window.__THREE__?console.warn(`WARNING: Multiple instances of Three.js being imported.`):window.__THREE__=cV),w$=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:aH,AddEquation:OV,AddOperation:eH,AdditiveAnimationBlendMode:jU,AdditiveBlending:wV,AlphaFormat:LH,AlwaysDepth:GV,AlwaysStencilFunc:nW,AmbientLight:XX,AmbientLightProbe:pZ,AnimationClip:SX,AnimationLoader:kX,AnimationMixer:KZ,AnimationObjectGroup:WZ,AnimationUtils:lX,ArcCurve:cY,ArrayCamera:Gq,ArrowHelper:jQ,Audio:wZ,AudioAnalyser:AZ,AudioContext:uZ,AudioListener:CZ,AudioLoader:dZ,AxesHelper:MQ,AxisHelper:d$,BackSide:yV,BasicDepthPacking:FU,BasicShadowMap:hV,BinaryTextureLoader:g$,Bone:OJ,BooleanKeyframeTrack:hX,BoundingBoxHelper:f$,Box2:eQ,Box3:GW,Box3Helper:EQ,BoxBufferGeometry:UK,BoxGeometry:UK,BoxHelper:TQ,BufferAttribute:oK,BufferGeometry:wK,BufferGeometryLoader:rZ,ByteType:DH,Cache:CX,Camera:JK,CameraHelper:CQ,CanvasRenderer:nV,CanvasTexture:aY,CapsuleBufferGeometry:TY,CapsuleGeometry:TY,CatmullRomCurve3:pY,CineonToneMapping:iH,CircleBufferGeometry:EY,CircleGeometry:EY,ClampToEdgeWrapping:mH,Clock:vZ,Color:kW,ColorKeyframeTrack:gX,ColorManagement:wW,CompressedTexture:iY,CompressedTextureLoader:AX,ConeBufferGeometry:OY,ConeGeometry:OY,CubeCamera:QK,CubeReflectionMapping:cH,CubeRefractionMapping:lH,CubeTexture:$K,CubeTextureLoader:MX,CubeUVReflectionMapping:fH,CubicBezierCurve:mY,CubicBezierCurve3:hY,CubicInterpolant:dX,CullFaceBack:fV,CullFaceFront:pV,CullFaceFrontBack:mV,CullFaceNone:dV,Curve:oY,CurvePath:SY,CustomBlending:DV,CustomToneMapping:oH,CylinderBufferGeometry:DY,CylinderGeometry:DY,Cylindrical:QZ,Data3DTexture:zW,DataArrayTexture:LW,DataTexture:kJ,DataTexture2DArray:S$,DataTexture3D:C$,DataTextureLoader:NX,DataUtils:PQ,DecrementStencilOp:GU,DecrementWrapStencilOp:qU,DefaultLoadingManager:TX,DepthFormat:HH,DepthStencilFormat:UH,DepthTexture:Yq,DirectionalLight:YX,DirectionalLightHelper:bQ,DiscreteInterpolant:pX,DodecahedronBufferGeometry:AY,DodecahedronGeometry:AY,DoubleSide:2,DstAlphaFactor:zV,DstColorFactor:VV,DynamicBufferAttribute:t$,DynamicCopyUsage:uW,DynamicDrawUsage:iW,DynamicReadUsage:sW,EdgesGeometry:FY,EdgesHelper:p$,EllipseCurve:sY,EqualDepth:JV,EqualStencilFunc:ZU,EquirectangularReflectionMapping:uH,EquirectangularRefractionMapping:dH,Euler:OG,EventDispatcher:hW,ExtrudeBufferGeometry:zY,ExtrudeGeometry:zY,FaceColors:KQ,FileLoader:OX,FlatShading:bV,Float16BufferAttribute:mK,Float32Attribute:l$,Float32BufferAttribute:hK,Float64Attribute:u$,Float64BufferAttribute:gK,FloatType:MH,Fog:$q,FogExp2:Qq,Font:oV,FontLoader:aV,FramebufferTexture:rY,FrontSide:0,Frustum:sq,GLBufferAttribute:YZ,GLSL1:fW,GLSL3:pW,GreaterDepth:XV,GreaterEqualDepth:YV,GreaterEqualStencilFunc:tW,GreaterStencilFunc:$U,GridHelper:hQ,Group:Kq,HalfFloatType:NH,HemisphereLight:IX,HemisphereLightHelper:mQ,HemisphereLightProbe:fZ,IcosahedronBufferGeometry:VY,IcosahedronGeometry:VY,ImageBitmapLoader:cZ,ImageLoader:jX,ImageUtils:jW,ImmediateRenderObject:sV,IncrementStencilOp:WU,IncrementWrapStencilOp:KU,InstancedBufferAttribute:NJ,InstancedBufferGeometry:nZ,InstancedInterleavedBuffer:JZ,InstancedMesh:RJ,Int16Attribute:a$,Int16BufferAttribute:uK,Int32Attribute:s$,Int32BufferAttribute:fK,Int8Attribute:n$,Int8BufferAttribute:sK,IntType:AH,InterleavedBuffer:tJ,InterleavedBufferAttribute:rJ,Interpolant:uX,InterpolateDiscrete:wU,InterpolateLinear:TU,InterpolateSmooth:EU,InvertStencilOp:JU,JSONLoader:rV,KeepStencilOp:HU,KeyframeTrack:mX,LOD:xJ,LatheBufferGeometry:wY,LatheGeometry:wY,Layers:kG,LensFlare:iV,LessDepth:KV,LessEqualDepth:qV,LessEqualStencilFunc:QU,LessStencilFunc:XU,Light:FX,LightProbe:$X,Line:GJ,Line3:rQ,LineBasicMaterial:zJ,LineCurve:gY,LineCurve3:_Y,LineDashedMaterial:sX,LineLoop:YJ,LinePieces:WQ,LineSegments:JJ,LineStrip:UQ,LinearEncoding:NU,LinearFilter:xH,LinearInterpolant:fX,LinearMipMapLinearFilter:TH,LinearMipMapNearestFilter:CH,LinearMipmapLinearFilter:wH,LinearMipmapNearestFilter:SH,LinearSRGBColorSpace:BU,LinearToneMapping:nH,Loader:EX,LoaderUtils:tZ,LoadingManager:wX,LoopOnce:xU,LoopPingPong:CU,LoopRepeat:SU,LuminanceAlphaFormat:VH,LuminanceFormat:BH,MOUSE:lV,Material:nK,MaterialLoader:eZ,Math:bW,MathUtils:bW,Matrix3:xW,Matrix4:vG,MaxEquation:MV,Mesh:HK,MeshBasicMaterial:rK,MeshDepthMaterial:Vq,MeshDistanceMaterial:Hq,MeshFaceMaterial:eV,MeshLambertMaterial:aX,MeshMatcapMaterial:oX,MeshNormalMaterial:iX,MeshPhongMaterial:nX,MeshPhysicalMaterial:tX,MeshStandardMaterial:eX,MeshToonMaterial:rX,MinEquation:jV,MirroredRepeatWrapping:hH,MixOperation:$V,MultiMaterial:tV,MultiplyBlending:EV,MultiplyOperation:QV,NearestFilter:gH,NearestMipMapLinearFilter:bH,NearestMipMapNearestFilter:vH,NearestMipmapLinearFilter:yH,NearestMipmapNearestFilter:_H,NeverDepth:WV,NeverStencilFunc:YU,NoBlending:SV,NoColorSpace:RU,NoColors:GQ,NoToneMapping:tH,NormalAnimationBlendMode:AU,NormalBlending:CV,NotEqualDepth:ZV,NotEqualStencilFunc:eW,NumberKeyframeTrack:_X,Object3D:UG,ObjectLoader:iZ,ObjectSpaceNormalMap:LU,OctahedronBufferGeometry:HY,OctahedronGeometry:HY,OneFactor:PV,OneMinusDstAlphaFactor:BV,OneMinusDstColorFactor:HV,OneMinusSrcAlphaFactor:RV,OneMinusSrcColorFactor:IV,OrthographicCamera:fq,PCFShadowMap:gV,PCFSoftShadowMap:_V,PMREMGenerator:Sq,ParametricGeometry:y$,Particle:YQ,ParticleBasicMaterial:QQ,ParticleSystem:XQ,ParticleSystemMaterial:$Q,Path:CY,PerspectiveCamera:YK,Plane:iq,PlaneBufferGeometry:cq,PlaneGeometry:cq,PlaneHelper:DQ,PointCloud:JQ,PointCloudMaterial:ZQ,PointLight:qX,PointLightHelper:uQ,Points:tY,PointsMaterial:XJ,PolarGridHelper:gQ,PolyhedronBufferGeometry:kY,PolyhedronGeometry:kY,PositionalAudio:kZ,PropertyBinding:UZ,PropertyMixer:jZ,QuadraticBezierCurve:vY,QuadraticBezierCurve3:yY,Quaternion:HW,QuaternionKeyframeTrack:yX,QuaternionLinearInterpolant:vX,REVISION:cV,RGBADepthPacking:IU,RGBAFormat:zH,RGBAIntegerFormat:JH,RGBA_ASTC_10x10_Format:_U,RGBA_ASTC_10x5_Format:mU,RGBA_ASTC_10x6_Format:hU,RGBA_ASTC_10x8_Format:gU,RGBA_ASTC_12x10_Format:vU,RGBA_ASTC_12x12_Format:yU,RGBA_ASTC_4x4_Format:oU,RGBA_ASTC_5x4_Format:sU,RGBA_ASTC_5x5_Format:cU,RGBA_ASTC_6x5_Format:lU,RGBA_ASTC_6x6_Format:uU,RGBA_ASTC_8x5_Format:dU,RGBA_ASTC_8x6_Format:fU,RGBA_ASTC_8x8_Format:pU,RGBA_BPTC_Format:bU,RGBA_ETC2_EAC_Format:aU,RGBA_PVRTC_2BPPV1_Format:nU,RGBA_PVRTC_4BPPV1_Format:tU,RGBA_S3TC_DXT1_Format:XH,RGBA_S3TC_DXT3_Format:ZH,RGBA_S3TC_DXT5_Format:QH,RGBFormat:RH,RGB_ETC1_Format:rU,RGB_ETC2_Format:iU,RGB_PVRTC_2BPPV1_Format:eU,RGB_PVRTC_4BPPV1_Format:$H,RGB_S3TC_DXT1_Format:YH,RGFormat:KH,RGIntegerFormat:qH,RawShaderMaterial:$Y,Ray:_G,Raycaster:XZ,RectAreaLight:ZX,RedFormat:WH,RedIntegerFormat:GH,ReinhardToneMapping:rH,RepeatWrapping:pH,ReplaceStencilOp:UU,ReverseSubtractEquation:AV,RingBufferGeometry:UY,RingGeometry:UY,SRGBColorSpace:zU,Scene:eJ,SceneUtils:v$,ShaderChunk:lq,ShaderLib:dq,ShaderMaterial:qK,ShadowMaterial:QY,Shape:IY,ShapeBufferGeometry:WY,ShapeGeometry:WY,ShapePath:NQ,ShapeUtils:RY,ShortType:OH,Skeleton:MJ,SkeletonHelper:lQ,SkinnedMesh:DJ,SmoothShading:xV,Source:MW,Sphere:lG,SphereBufferGeometry:GY,SphereGeometry:GY,Spherical:ZZ,SphericalHarmonics3:QX,SplineCurve:bY,SpotLight:HX,SpotLightHelper:aQ,Sprite:vJ,SpriteMaterial:iJ,SrcAlphaFactor:LV,SrcAlphaSaturateFactor:UV,SrcColorFactor:FV,StaticCopyUsage:lW,StaticDrawUsage:rW,StaticReadUsage:oW,StereoCamera:_Z,StreamCopyUsage:dW,StreamDrawUsage:aW,StreamReadUsage:cW,StringKeyframeTrack:bX,SubtractEquation:kV,SubtractiveBlending:TV,TOUCH:uV,TangentSpaceNormalMap:0,TetrahedronBufferGeometry:KY,TetrahedronGeometry:KY,TextGeometry:b$,Texture:PW,TextureLoader:PX,TorusBufferGeometry:qY,TorusGeometry:qY,TorusKnotBufferGeometry:JY,TorusKnotGeometry:JY,Triangle:eK,TriangleFanDrawMode:2,TriangleStripDrawMode:1,TrianglesDrawMode:MU,TubeBufferGeometry:YY,TubeGeometry:YY,UVMapping:sH,Uint16Attribute:o$,Uint16BufferAttribute:dK,Uint32Attribute:c$,Uint32BufferAttribute:pK,Uint8Attribute:r$,Uint8BufferAttribute:cK,Uint8ClampedAttribute:i$,Uint8ClampedBufferAttribute:lK,Uniform:qZ,UniformsLib:uq,UniformsUtils:WK,UnsignedByteType:EH,UnsignedInt248Type:IH,UnsignedIntType:jH,UnsignedShort4444Type:PH,UnsignedShort5551Type:FH,UnsignedShortType:kH,VSMShadowMap:vV,Vector2:Z,Vector3:Q,Vector4:FW,VectorKeyframeTrack:xX,Vertex:e$,VertexColors:qQ,VideoTexture:nY,WebGL1Renderer:Zq,WebGL3DRenderTarget:BW,WebGLArrayRenderTarget:RW,WebGLCubeRenderTarget:eq,WebGLMultipleRenderTargets:VW,WebGLMultisampleRenderTarget:x$,WebGLRenderTarget:IW,WebGLRenderTargetCube:_$,WebGLRenderer:_B,WebGLUtils:gB,WireframeGeometry:XY,WireframeHelper:m$,WrapAroundEnding:kU,XHRLoader:h$,ZeroCurvatureEnding:DU,ZeroFactor:NV,ZeroSlopeEnding:OU,ZeroStencilOp:VU,_SRGBAFormat:mW,sRGBEncoding:PU},Symbol.toStringTag,{value:`Module`}))}));function E$(e, _hh$temp1235 ){ var t=_hh$temp1235.highlight,n=_hh$temp1235.interval,r=_hh$temp1235.times; return e.animator.play({duration:n,easing:_n,keyframes:{0:{opacity:0},50:{opacity:1},100:{opacity:0}},repeat:r,target:t.obj.material})}function D$(e,t){return new Promise(n=>{e.animator.play({duration:$1.Camera.Distance.Duration,keyframes:{0:{distance:e.distance},100:{distance:t}},easing:hn,onUpdate:t=>{e.distance=t.animatedProps.distance},onEnd:()=>n()})})}function O$(e,t){return e.animator.play({data:{itemObj:t.obj},duration:$1.CustomItem.Duration,keyframes:{0:{opacity:t.obj.material.opacity,scale:1},100:{opacity:0,scale:2}},onUpdate:k$})}function k$(e){ let _hh$temp1236=e,t=_hh$temp1236.animatedProps,n=_hh$temp1236.data,r=n.itemObj,i=t.opacity,a=t.scale; r.scale.x=a,r.scale.y=a,r.scale.z=a,r.material.opacity=i}function A$(e,t){return e.animator.play({duration:$1.Highlight.Duration,easing:mn,keyframes:{0:{opacity:t.obj.material.opacity},100:{opacity:0}},target:t.obj.material})}function j$(e,t){return e.animator.play({duration:$1.Hint.Duration,easing:mn,keyframes:{0:{x:1,y:1},100:{x:1e-4,y:1e-4}},target:t.obj.scale})}function M$(e, _hh$temp1237 ){ var t=_hh$temp1237.piece,n=_hh$temp1237.from,r=_hh$temp1237.to; return e.animator.play({duration:$1.PieceMove.Duration,easing:mn,keyframes:{0:{x:n.x,z:n.y},100:{x:r.x,z:r.y}},target:t.obj.position})}function N$(){let e=localStorage.getItem(X.CacheKeys.CameraSettings);return(e?JSON.parse(e):null)||{distance:X.Camera.Distance,horizontalPanning:X.Camera.HorizontalPanning,panAngle:X.Camera.PanAngle,target:{x:X.Square.Size*4,y:0,z:X.Square.Size*4},tiltAngle:X.Camera.TiltAngle,verticalPanning:X.Camera.VerticalPanning}}function P$(e){let t=N$();return{animations:{panning:null,rotation:null},animator:e.animator,camera:new YK(35,1,1,2e3),distance:t.distance,horizontalPanning:t.horizontalPanning,isPanning:!1,isRotating:!1,panAngle:t.panAngle,panAngleFlipped:0,target:new Q(t.target.x,0,t.target.z),tiltAngle:t.tiltAngle,verticalPanning:t.verticalPanning}}function F$( _hh$temp1238 ){ var e=_hh$temp1238.state,t=_hh$temp1238.isFlipped; t&&(e.panAngle+=360),V$({panAngle:e.panAngle,state:e,tiltAngle:e.tiltAngle}),z$({panH:e.horizontalPanning,panV:e.verticalPanning,state:e})}function I$(e,t){let n=L$({cameraPosition:e.camera.position,cameraTarget:e.target,panDistance:t});e.camera.position.add(n),e.target.add(n),e.horizontalPanning=t}function L$( _hh$temp1239 ){ var e=_hh$temp1239.cameraPosition,t=_hh$temp1239.cameraTarget,n=_hh$temp1239.panDistance; let r=t.clone().sub(e).clone().cross(UG.DefaultUp).normalize().clone().multiplyScalar(n);return new Q(r.x,0,r.z)}function R$(e,t){e.target.y+=t,e.camera.lookAt(e.target),e.verticalPanning=t}function z$( _hh$temp1240 ){ var e=_hh$temp1240.state,t=_hh$temp1240.panH,n=_hh$temp1240.panV; I$(e,t),R$(e,n)}function B$( _hh$temp1241 ){ var e=_hh$temp1241.state,t=_hh$temp1241.isFlipped,n=_hh$temp1241.animation; e.horizontalPanning=X.Camera.HorizontalPanning,e.verticalPanning=X.Camera.VerticalPanning,e.target.x=X.Square.Size*4,e.target.z=X.Square.Size*4,e.target.y=X.Camera.VerticalPanning,V$(t?{animation:n,panAngle:X.Camera.PanAngle+360,state:e,tiltAngle:X.Camera.TiltAngle}:{animation:n,panAngle:X.Camera.PanAngle,state:e,tiltAngle:X.Camera.TiltAngle}),n?n.changeCameraDistance(e,X.Camera.Distance):e.distance=X.Camera.Distance,U$({isFlipped:t,state:e,useDefault:!0})}function V$( _hh$temp1242 ){ var e=_hh$temp1242.state,t=_hh$temp1242.panAngle,n=_hh$temp1242.tiltAngle,r=_hh$temp1242.animation; return r?r.rotateCamera({panAngle:t,state:e,tiltAngle:n}):new Promise(r=>{let i=Math.min(180,Math.max(0,n)),a=H$({distance:e.distance,panAngle:t,target:e.target,tiltAngle:i});e.camera.position.copy(a),e.camera.lookAt(e.target),e.panAngle=t,e.tiltAngle=i,r()})}function H$( _hh$temp1243 ){ var e=_hh$temp1243.distance,t=_hh$temp1243.target,n=_hh$temp1243.panAngle,r=_hh$temp1243.tiltAngle; return new Q(e*Math.sin(n*Math.PI/360)*Math.cos(r*Math.PI/360)+t.x,e*Math.sin(r*Math.PI/360),e*Math.cos(n*Math.PI/360)*Math.cos(r*Math.PI/360)+t.z)}function U$( _hh$temp1244 ){ var e=_hh$temp1244.state,t=_hh$temp1244.isFlipped,n=_hh$temp1244.useDefault; let r={distance:e.distance,horizontalPanning:e.horizontalPanning,panAngle:t?e.panAngle-360:e.panAngle,target:{x:e.target.x,y:e.target.y,z:e.target.z},tiltAngle:e.tiltAngle,verticalPanning:e.verticalPanning};n&&(r={distance:X.Camera.Distance,horizontalPanning:X.Camera.HorizontalPanning,panAngle:X.Camera.PanAngle,target:{x:e.target.x,y:0,z:e.target.z},tiltAngle:X.Camera.TiltAngle,verticalPanning:X.Camera.VerticalPanning}),localStorage.setItem(X.CacheKeys.CameraSettings,JSON.stringify(r))}function W$( _hh$temp1245 ){ var e=_hh$temp1245.state,t=_hh$temp1245.panAngle,n=_hh$temp1245.tiltAngle; return  new Promise(r=>{e.animations.rotation&&(e.animations.rotation.stop(),e.animations.rotation=null),e.animations.rotation=e.animator.play({duration:$1.Camera.Rotation.Duration,easing:hn,keyframes:{0:{pan:e.panAngle,tilt:e.tiltAngle},100:{pan:t,tilt:n}},onUpdate:t=>{let _hh$temp1246=t,n=_hh$temp1246.animatedProps;V$({state:e,panAngle:n.pan,tiltAngle:n.tilt});},onEnd:()=>{e.animations.rotation=null,r();}});}) }function G$(e,t){return e.animator.play({duration:$1.Highlight.Duration,easing:mn,keyframes:{0:{opacity:0},100:{opacity:t.obj.material.opacity}},target:t.obj.material})}function K$(e,t){return e.animator.play({duration:$1.Hint.Duration,easing:mn,keyframes:{0:{x:1e-4,y:1e-4},100:{x:1,y:1}},target:t.obj.scale})}function q$(e){return{...e,options:Ut(e.options),analysisOverlay:null,animation:e0,boardModel:null,boardNotationPlane:null,cameraState:P$(e),captureHintGeom:new UY(X.Square.Size*Kb.CaptureHint.InnerRadiusRatio,X.Square.Size*Kb.CaptureHint.OuterRadiusRatio,25,1),customItemGeom:new cq(X.Square.Size,X.Square.Size,1,1),groundModel:null,highlightGeom:new cq(X.Square.Size,X.Square.Size,1,1),isBoardFlipping:!1,isPromotionWindowInitialized:!1,lights:{},materials:{},moveHintGeom:new EY(X.Square.Size*Kb.MoveHint.RadiusRatio,16),overlappedPiece:null,piecesGeom:{},pieceStyle:X.PieceStyles.Default,promotionHandler:()=>{},renderer:J$(e.viewEl),scene:new eJ,shadowMaterials:{},squareSize:X.Square.Size}}function J$(e){return new _B({alpha:!0,antialias:!0,canvas:e})}function Y$(e){var t,n; let _hh$temp1247=e,r=_hh$temp1247.containerEl,i=_hh$temp1247.renderer,a=_hh$temp1247.scene; X$(a),Z$(e),Q$(e),i.dispose();let o=r.querySelector(`.${X.CssClasses.PromotionWindow}`),s=r.querySelector(`.${X.CssClasses.StatisticsPanel}`);(t=o?.parentNode)==null||t.removeChild(o),(n=s?.parentNode)==null||n.removeChild(s)}function X$(e){for(;e.children.length>0;)X$(e.children[0]),e.remove(e.children[0]);e instanceof HK&&(e.geometry&&e.geometry.dispose(),e.material&&$$(e.material))}function Z$(e){ let _hh$temp1248=e,t=_hh$temp1248.boardModel,n=_hh$temp1248.boardNotationPlane,r=_hh$temp1248.groundModel,i=_hh$temp1248.hoverSquare,a=_hh$temp1248.piecesGeom,o=_hh$temp1248.highlightGeom,s=_hh$temp1248.moveHintGeom,c=_hh$temp1248.captureHintGeom,l=_hh$temp1248.customItemGeom; t&&(t.geometry.dispose(),$$(t.material)),n&&(n.geometry.dispose(),$$(n.material)),r&&(r.geometry.dispose(),$$(r.material)),i&&(i.geometry.dispose(),$$(i.material)),Object.keys(a).forEach(e=> __get$(a,e) .dispose()),o.dispose(),s.dispose(),c.dispose(),l.dispose()}function Q$(e){ let _hh$temp1249=e,t=_hh$temp1249.materials,n=_hh$temp1249.shadowMaterials; Object.keys(t).forEach(e=>$$( __get$(t,e) )),Object.keys(n).forEach(e=>$$( __get$(n,e) ))}function $$(e){if(e instanceof Array){e.forEach(e=>$$(e));return}Object.keys(e).forEach(t=>{ __get$(e,t) &&typeof  __get$(e,t) .dispose==`function`&& __get$(e,t) .dispose()}),e.dispose()}function e1(e,t){ let _hh$temp1250=e,n=_hh$temp1250.squareSize; return{x:n*(t.file-1)+n*.5,y:n*(8-t.rank)+n*.5}}function t1(e,t){ let _hh$temp1251=e,n=_hh$temp1251.cameraState,r=_hh$temp1251.viewEl,_hh$temp1252=n,i=_hh$temp1252.camera,a=new Q(t.x/r.width*2-1,-(t.y/r.height)*2+1,1); a.unproject(i);let o=i.position,s=a.y/(a.y-o.y);return{x:a.x+(o.x-a.x)*s,y:a.z+(o.z-a.z)*s}}function n1(e,t){ let _hh$temp1253=e,n=_hh$temp1253.cameraState,r=_hh$temp1253.viewEl,_hh$temp1254=n,i=_hh$temp1254.camera,a=new Q(t.x,0,t.y),o=r.width/2,s=r.height/2; return a.project(i),a.x=a.x*o+o,a.y=-a.y*s+s,{x:a.x,y:a.y}}function r1(){return 1.33}function i1(e, _hh$temp1255 ){ var t=_hh$temp1255.animator,_hh$temp1255$frameRate=_hh$temp1255.frameRate,n=_hh$temp1255$frameRate===void 0?24:_hh$temp1255$frameRate,r=_hh$temp1255.onEnd; let i=e.image,a=Math.ceil(i.width/i.height),o=1/a,s=1/a,c=t.play({duration:a/n*1e3,data:{currentFrame:1},onUpdate:()=>{ let _hh$temp1256=c,t=_hh$temp1256.data,n=_hh$temp1256.frameInfo; s*t.currentFrame<n.elapsedInterval&&(e.offset.x=o*t.currentFrame,t.currentFrame++)},onEnd:r})}function a1( _hh$temp1257 ){ var e=_hh$temp1257.type,t=_hh$temp1257.options,n=_hh$temp1257.texture,r=_hh$temp1257.textureFlip; let i= __get$(w$,e) ,a=new i;return t&& __call$(Object,"assign",[a,t]) ,n&&(a.map=n,a.map.flipY=r||!1),a}function o1(e,t){return Object.values(t).find(t=>t.info.square===e)||null}function s1(e,t){let n=Wee(e);return n?o1(n,t):null}function c1(e, _hh$temp1258 ={}){ var _hh$temp1258$transparent=_hh$temp1258.transparent,t=_hh$temp1258$transparent===void 0?!1:_hh$temp1258$transparent; return new Promise(n=>{l1(e,{transparent:t}).then(e=>{let t=e.image,r=Math.ceil(t.width/t.height);e.repeat.x=1/r,n(e)})})}function l1(e, _hh$temp1259 ={}){ var t=_hh$temp1259.frame,_hh$temp1259$transparent=_hh$temp1259.transparent,n=_hh$temp1259$transparent===void 0?!1:_hh$temp1259$transparent; return  new Promise(r=>{new PX().load(e,e=>{if(t){let _hh$temp1260=t,n=_hh$temp1260.xRatio,r=_hh$temp1260.yRatio,i=_hh$temp1260.widthRatio,a=_hh$temp1260.heightRatio,o=_hh$temp1260.cropRatio;e.offset.x=n,e.offset.y=1-r-a,e.repeat.x=i,e.repeat.y=a,o&&(e.offset.x+=(i-i*o)/2,e.offset.y+=(a-a*o)/2,e.repeat.x*=o,e.repeat.y*=o);}n&&(e.minFilter=gH),r(e);});}) }function u1( _hh$temp1261 ){ var e=_hh$temp1261.axis,t=_hh$temp1261.degrees,n=_hh$temp1261.object; let r=t*Math.PI/180;n.rotateOnAxis(e,r)}function d1(e){e&&(e.onerror=function(){ __set$(this,`test-failed`,!0) })}function f1(e,t=!0){let n=document.createElement(`img`);n.src=`data:image/svg+xml;utf8,${encodeURIComponent(e)}`,n.width=Kb.SVG.ImageSize,n.height=Kb.SVG.ImageSize,d1(n);let r=new PW(n);return t&&(r.minFilter=gH),r.needsUpdate=!0,r}function Wee(e){return fv({file:Math.ceil(e.x/X.Square.Size),rank:Math.ceil((X.Square.Size*8-e.z)/X.Square.Size)})}function p1(e){ let _hh$temp1262=e,t=_hh$temp1262.scene,n=_hh$temp1262.squareSize; if(e.analysisOverlay)return;let r=new HK(new cq(X.Board.Size,X.Board.Size,1,1),new rK({color:16777215,opacity:Kb.AnalysisOverlay.Opacity,transparent:!0,depthWrite:!1}));r.position.set(n*4,0,n*4),r.renderOrder=X.ObjectsRenderOrder.AnalysisOverlay,u1({axis:new Q(1,0,0),degrees:-90,object:r}),t.add(r),e.analysisOverlay=r}function m1(e){e.boardNotationPlane=new HK(new cq(X.Board.Size,X.Board.Size,1,1)),e.boardNotationPlane.position.set(X.Square.Size*4,0,X.Square.Size*4),e.boardNotationPlane.renderOrder=X.ObjectsRenderOrder.NotationPlane,e.options.coordinates===Qb.CoordinatesPositions.Off&&(e.boardNotationPlane.visible=!1),u1({axis:new Q(1,0,0),degrees:-90,object:e.boardNotationPlane}),e.scene.add(e.boardNotationPlane)}function h1(e){e.groundModel=new HK(new cq(110,110,1,1)),e.groundModel.position.set(X.Square.Size*4,-2,X.Square.Size*4),u1({axis:new Q(1,0,0),degrees:-90,object:e.groundModel}),e.scene.add(e.groundModel)}function g1(e,t){e.scene.add(t.obj)}function _1(e,t){ let _hh$temp1263=e,n=_hh$temp1263.squareSize,_hh$temp1264=t,r=_hh$temp1264.position,i=_hh$temp1264.type,a=new rK({depthTest:!1,depthWrite:!1,transparent:!0,map:f1(Ln({path:__get$(Yx,i),size:`100%`,viewBox:`0 0 19 19`}))}),o=n*Kb.Effect.SizeRatio,s=new HK(new cq(o,o,1,1),a); return s.renderOrder=X.ObjectsRenderOrder.Effect,y1(e,{effectObj:s,position:r}),u1({axis:new Q(1,0,0),degrees:-90,object:s}),s}function v1(e,t){e.scene.remove(t.obj)}function y1(e, _hh$temp1265 ){ var t=_hh$temp1265.effectObj,n=_hh$temp1265.position;  let _hh$temp1266=e,r=_hh$temp1266.squareSize,i=_hh$temp1266.isBoardFlipped,a=i?-1:1,o=r*Kb.Effect.OffsetRatio*a; t.position.set(n.x+o,X.Effect.PositionY,n.y-o),t.scale.x=i?-1:1,t.scale.y=i?-1:1}function b1(e,t){let n=e.isBoardFlipped?360:-360;e.cameraState.panAngleFlipped=e.isBoardFlipping?e.cameraState.panAngleFlipped+n:e.cameraState.panAngle+n,e.isBoardFlipped=t,e.isBoardFlipping=!0,V$({animation:e.animation,panAngle:e.cameraState.panAngleFlipped,state:e.cameraState,tiltAngle:e.cameraState.tiltAngle}).then(()=>{e.isBoardFlipping=!1}),Object.values(e.effects).forEach(t=>{y1(e,{effectObj:t.obj,position:t.info.position})})}function x1(e){ let _hh$temp1267=e,t=_hh$temp1267.scene; e.analysisOverlay&&t.remove(e.analysisOverlay),e.analysisOverlay=null}function S1(e, _hh$temp1268 ){ var t=_hh$temp1268.position; e.boardNotationPlane&&(e.boardNotationPlane.visible=t!==Qb.CoordinatesPositions.Off)}function C1(e){return  new Promise(t=>{let _hh$temp1269=e,n=_hh$temp1269.boardThemes,r=_hh$temp1269.boardStyle,_hh$temp1269$options=_hh$temp1269.options,i=_hh$temp1269$options.themeAssets,a=new PX(),o=(__get$(n,r)??Xb.green)[2],s=i?.board?.assets?.background||SP(`three-d/board/textures/board_${o}.jpg`),c=i?.board?.assets?.coordinates||SP(`three-d/board/textures/board_${o}_notation.png`);a.load(s,n=>{n.flipY=!1,e.materials.board.map=n,a.load(c,n=>{e.materials.boardNotation.map=n,t();});});}) }function w1(e){e.lights.topLight=new qX,e.lights.topLight.intensity=.65,e.lights.topLight.position.set(X.Square.Size*4,150,X.Square.Size*4),e.lights.whiteSideLight=new YX,e.lights.whiteSideLight.intensity=.45,e.lights.whiteSideLight.position.set(X.Square.Size*4,100,X.Square.Size*4+200),e.lights.whiteSideLight.target.position.set(X.Square.Size*4,0,X.Square.Size*4),e.lights.blackSideLight=new YX,e.lights.blackSideLight.intensity=.45,e.lights.blackSideLight.position.set(X.Square.Size*4,100,X.Square.Size*4-200),e.lights.blackSideLight.target.position.set(X.Square.Size*4,0,X.Square.Size*4),e.lights.movingLight=new qX(16379337),e.lights.movingLight.position.set(0,10,0),e.lights.movingLight.intensity=.25,e.lights.movingLight.distance=500,e.scene.add(e.lights.topLight),e.scene.add(e.lights.whiteSideLight),e.scene.add(e.lights.blackSideLight),e.scene.add(e.lights.movingLight)}function T1(e){return`${e}_promotionWindow3D`}function E1(e){return`${T1(e)}_closeButton`}function D1(e,t){return`${T1(e)}_${ja(t)}`}function O1(e){if(e.promotionWindowEl=document.createElement(`div`),e.promotionWindowEl.className=X.CssClasses.PromotionWindow,e.promotionWindowEl.innerHTML=k1(e),e.options.test){An(e.promotionWindowEl,{[sx.Element]:cx.PromotionWindow}),An(e.promotionWindowEl.getElementsByClassName(`close-button`)[0],{[sx.Element]:cx.PromotionCloseButton});for(let t of e.promotionWindowEl.getElementsByClassName(`promotion-piece`))An(t,{[sx.Element]:cx.PromotionPiece,[sx.Type]:t.getAttribute(`data-pieceType`)})}e.containerEl.appendChild(e.promotionWindowEl)}function k1(e){return`
    ${A1(e,J.ColorsAsNumbers.White)}
    ${A1(e,J.ColorsAsNumbers.Black)}
    <i
      id="${E1(e.boardId)}"
      class="close-button icon-font-chess x"></i>
  `}function A1(e,t){let n=[{name:`queen`,type:`q`},{name:`knight`,type:`n`},{name:`rook`,type:`r`},{name:`bishop`,type:`b`}],r=`<div id="${`${D1(e.boardId,t)}`}" style="display: none;">`;return n.forEach(n=>{r+=j1({color:t,piece:n,pieceStyle:e.pieceStyle,themeAssets:e.options.themeAssets})}),r+=`</div>`,r}function j1( _hh$temp1270 ){ var e=_hh$temp1270.color,t=_hh$temp1270.piece,n=_hh$temp1270.pieceStyle,r=_hh$temp1270.themeAssets; let i=ja(e),a= __get$(r?.pieces?.assets,`${i[0]}${t.type}Promotion`,true) ||SP(`three-d/pieces/${n}/${t.name}_promotion_${i}.jpg`);return`<img class="promotion-piece" data-pieceType="${t.type}" src="${a}" />`}function M1(e){e.renderer.setPixelRatio(CP.PixelRatio),e.scene.add(e.cameraState.camera),F$({isFlipped:e.isBoardFlipped,state:e.cameraState}),w1(e),m1(e),h1(e),O1(e)}function N1(e,t){return t.x*=CP.PixelRatio,t.y*=CP.PixelRatio,t}function P1(e){ let _hh$temp1271=e,t=_hh$temp1271.viewSize,n=_hh$temp1271.viewEl,r=J$(n); r.setSize(t.width,t.height),e.renderer=r}function F1(e,t){ let _hh$temp1272=e,n=_hh$temp1272.squareSize; return{file:Math.ceil(t.x/n),rank:Math.ceil((n*8-t.y)/n)}}function I1(e,t){ let _hh$temp1273=e,n=_hh$temp1273.squareSize,r=.01,i=n*8; return{x:Kd(t.x,{min:r,max:i-r}),y:Kd(t.y,{min:r,max:i-r})}}function L1(e){e.lights.movingLight.position.x=e.cameraState.camera.position.x,e.lights.movingLight.position.z=e.cameraState.camera.position.z,e.renderer.render(e.scene,e.cameraState.camera)}function R1(e,t){ let _hh$temp1274=t,n=_hh$temp1274.height,r=_hh$temp1274.width,_hh$temp1275=e,i=_hh$temp1275.cameraState,a=_hh$temp1275.renderer; i.camera.aspect=r/n,i.camera.updateProjectionMatrix(),a.setSize(r,n)}function z1(e,t){e.scene.add(t.obj)}function B1(){let e=new UG,t=new HK,n=V1();return u1({axis:new Q(1,0,0),degrees:90,object:t}),e.add(t),e.add(n),e}function V1(){let e=new HK(new cq(X.Square.Size,X.Square.Size,1,1));return u1({axis:new Q(1,0,0),degrees:-90,object:e}),e.renderOrder=X.ObjectsRenderOrder.PieceShadow,e}function H1(e,t){ let _hh$temp1276=e,n=_hh$temp1276.animator,r=_hh$temp1276.materials,i=_hh$temp1276.shadowMaterials,a=r.whitePiece.transparent,o=r.blackPiece.transparent; return r.whitePiece.transparent=!0,r.blackPiece.transparent=!0,n.play({duration:t,keyframes:{0:{whitePieceOpacity:0,blackPieceOpacity:0,bishopShadowOpacity:0,kingShadowOpacity:0,knightShadowOpacity:0,pawnShadowOpacity:0,queenShadowOpacity:0,rookShadowOpacity:0},100:{whitePieceOpacity:r.whitePiece.opacity,blackPieceOpacity:r.blackPiece.opacity,bishopShadowOpacity:i.bishop.opacity,kingShadowOpacity:i.king.opacity,knightShadowOpacity:i.knight.opacity,pawnShadowOpacity:i.pawn.opacity,queenShadowOpacity:i.queen.opacity,rookShadowOpacity:i.rook.opacity}},onUpdate:( _hh$temp1277 )=>{ var e=_hh$temp1277.animatedProps; r.whitePiece.opacity=e.whitePieceOpacity,r.blackPiece.opacity=e.blackPieceOpacity,i.bishop.opacity=e.bishopShadowOpacity,i.king.opacity=e.kingShadowOpacity,i.knight.opacity=e.knightShadowOpacity,i.pawn.opacity=e.pawnShadowOpacity,i.queen.opacity=e.queenShadowOpacity,i.rook.opacity=e.rookShadowOpacity},onEnd:()=>{r.whitePiece.transparent=a,r.blackPiece.transparent=o}})}function U1(e,t){return uN(e,F1(e,t))}function W1( _hh$temp1278 ){ var e=_hh$temp1278.materials,t=_hh$temp1278.piece,n=_hh$temp1278.shouldFade; let r=t.obj.children[0];if(t.obj.children[1].visible=!n,n){t.info.color===J.ColorsAsNumbers.White?r.material=e.whitePieceOverlapped:r.material=e.blackPieceOverlapped;return}r.material===e.whitePieceOverlapped?r.material=e.whitePiece:r.material===e.blackPieceOverlapped&&(r.material=e.blackPiece)}function G1(e,t){t.obj.children.length&&(t.obj.children[0].position.y=1),K1(e,t)}function K1(e,t){e.overlappedPiece&&W1({materials:e.materials,piece:e.overlappedPiece,shouldFade:!1}),e.overlappedPiece=s1(t.obj.position,e.pieces),e.overlappedPiece&&e.selectedPiece&&e.overlappedPiece.obj!==e.selectedPiece.obj&&W1({materials:e.materials,piece:e.overlappedPiece,shouldFade:!0})}function q1(e,t){t.obj.children.length&&(t.obj.children[0].position.y=0),J1(e)}function J1(e){e.overlappedPiece&&=(W1({materials:e.materials,piece:e.overlappedPiece,shouldFade:!1}),null)}function Y1(e,t){e.scene.remove(t.obj)}function X1(e,t){e.obj.position.x=t.x,e.obj.position.z=t.y,e.obj.position.y=.01}function Z1(e){return e.pieceStyle=X.PieceStyles.Default,new Promise(e=>e())}function Q1(e,t){ let _hh$temp1279=e,n=_hh$temp1279.piecesGeom,r=_hh$temp1279.materials,i=_hh$temp1279.shadowMaterials,a=t.obj.children[0],o=t.obj.children[1]; a.geometry= __get$(n,__get$(J.Piece.Names,t.info.type)) ,a.material=t.info.color===J.ColorsAsNumbers.White?r.whitePiece:r.blackPiece,o.material= __get$(i,__get$(J.Piece.Names,t.info.type)) ,t.info.type===J.Piece.Types.Knight?a.rotation.z=bW.degToRad(t.info.color===J.ColorsAsNumbers.Black?-90:90):a.rotation.z=0}var $1,e0,t0,n0,r0=e((()=>{ZO(),T$(),wP(),bt(),(e=>{(e=>{(e=>{ __set$(e,e.Duration=700,`Duration`) })(e.Rotation||={}),(e=>{ __set$(e,e.Duration=700,`Duration`) })(e.Distance||={})})(e.Camera||={}),(e=>{e.Duration=250})(e.PieceMove||={}),(e=>{e.Duration=250})(e.CustomItem||={}),(e=>{e.Duration=150})(e.Highlight||={}),(e=>{e.Duration=80})(e.Hint||={})})($1||={}),e0=Object.freeze(Object.defineProperty({__proto__:null,blinkHighlight:E$,changeCameraDistance:D$,hideCustomItem:O$,hideHighlight:A$,hideHint:j$,movePiece:M$,rotateCamera:W$,showHighlight:G$,showHint:K$},Symbol.toStringTag,{value:`Module`})),t0=(e=>( __set$(e,e.Board=0,`Board`) , __set$(e,e.Piece=1,`Piece`) ,e))(t0||{}),(e=>{(e=>{e.Basic=`MeshBasicMaterial`,e.Lambert=`MeshLambertMaterial`,e.Phong=`MeshPhongMaterial`})(e.Type||={})})(n0||={})}));function i0(e){return{board:a1({texture:e.board,type:n0.Type.Lambert}),boardNotation:a1({options:{transparent:!0,depthWrite:!1},texture:e.boardNotation,textureFlip:!0,type:n0.Type.Lambert}),squareOver:a1({options:{color:new kW(16777215)},type:n0.Type.Lambert}),squareSelected:a1({options:{color:new kW(1534597),opacity:.6,transparent:!0},type:n0.Type.Lambert})}}function a0(e){return{blackPiece:a1({options:{shininess:40},texture:e.pieceBlack,type:n0.Type.Phong}),blackPieceCaptured:a1({options:{transparent:!0},texture:e.pieceBlack,type:n0.Type.Phong}),blackPieceOverlapped:a1({options:{opacity:.5,transparent:!0},texture:e.pieceBlack,type:n0.Type.Phong}),whitePiece:a1({options:{shininess:30},texture:e.pieceWhite,type:n0.Type.Phong}),whitePieceCaptured:a1({options:{transparent:!0},texture:e.pieceWhite,type:n0.Type.Phong}),whitePieceOverlapped:a1({options:{opacity:.5,transparent:!0},texture:e.pieceWhite,type:n0.Type.Phong})}}function o0(e){return{bishop:a1({options:{depthWrite:!1,transparent:!0},texture:e.bishopShadow,type:n0.Type.Basic}),ground:a1({options:{transparent:!0},texture:e.boardShadow,type:n0.Type.Basic}),king:a1({options:{depthWrite:!1,transparent:!0},texture:e.kingShadow,type:n0.Type.Basic}),knight:a1({options:{depthWrite:!1,transparent:!0},texture:e.knightShadow,type:n0.Type.Basic}),pawn:a1({options:{depthWrite:!1,transparent:!0},texture:e.pawnShadow,type:n0.Type.Basic}),queen:a1({options:{depthWrite:!1,transparent:!0},texture:e.queenShadow,type:n0.Type.Basic}),rook:a1({options:{depthWrite:!1,transparent:!0},texture:e.rookShadow,type:n0.Type.Basic})}}function s0(e,t){ __call$(Object,"assign",[e.materials,i0(t)]) , __call$(Object,"assign",[e.materials,a0(t)]) , __call$(Object,"assign",[e.shadowMaterials,o0(t)]) }function c0(){let e={};return{get:function(t){return  __get$(e,t) },add:function(t,n){ __set$(e,t,n) },remove:function(t){delete e[t]},removeAll:function(){e={}}}}function l0(e){return e.DefaultMaterial===void 0&&(e.DefaultMaterial=new eX({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),e.DefaultMaterial}function u0(e,t,n){for(let r in n.extensions) __get$(e,r) ===void 0&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{}, __set$(t.userData.gltfExtensions,r,__get$(n.extensions,r)) )}function d0(e,t){t.extras!==void 0&&(typeof t.extras==`object`? __call$(Object,"assign",[e.userData,t.extras]) :console.warn(`THREE.GLTFLoader: Ignoring primitive type .extras, `+t.extras))}function f0(e,t,n){let r=!1,i=!1,a=!1;for(let e=0,n=t.length;e<n;e++){let n= __get$(t,e) ;if(n.POSITION!==void 0&&(r=!0),n.NORMAL!==void 0&&(i=!0),n.COLOR_0!==void 0&&(a=!0),r&&i&&a)break}if(!r&&!i&&!a)return Promise.resolve(e);let o=[],s=[],c=[];for(let l=0,u=t.length;l<u;l++){let u= __get$(t,l) ;if(r){let t=u.POSITION===void 0?e.attributes.position:n.getDependency(`accessor`,u.POSITION);o.push(t)}if(i){let t=u.NORMAL===void 0?e.attributes.normal:n.getDependency(`accessor`,u.NORMAL);s.push(t)}if(a){let t=u.COLOR_0===void 0?e.attributes.color:n.getDependency(`accessor`,u.COLOR_0);c.push(t)}}return Promise.all([Promise.all(o),Promise.all(s),Promise.all(c)]).then(function(t){let n=t[0],o=t[1],s=t[2];return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=o),a&&(e.morphAttributes.color=s),e.morphTargetsRelative=!0,e})}function p0(e,t){if(e.updateMorphTargets(),t.weights!==void 0)for(let n=0,r=t.weights.length;n<r;n++) __set$(e.morphTargetInfluences,n,__get$(t.weights,n)) ;if(t.extras&&Array.isArray(t.extras.targetNames)){let n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++) __set$(e.morphTargetDictionary,__get$(n,t),t) }else console.warn(`THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.`)}}function m0(e){let t=e.extensions&& __get$(e.extensions,r2.KHR_DRACO_MESH_COMPRESSION) ,n;return n=t?`draco:`+t.bufferView+`:`+t.indices+`:`+h0(t.attributes):e.indices+`:`+h0(e.attributes)+`:`+e.mode,n}function h0(e){let t=``,n=Object.keys(e).sort();for(let r=0,i=n.length;r<i;r++)t+= __get$(n,r) +`:`+ __get$(e,__get$(n,r)) +`;`;return t}function g0(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error(`THREE.GLTFLoader: Unsupported normalized accessor component type.`)}}function _0(e){return e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0?`image/jpeg`:e.search(/\.webp($|\?)/i)>0||e.search(/^data\:image\/webp/)===0?`image/webp`:`image/png`}function v0(e,t,n,r){let i= __get$(n.nodes,e) ;return r.getDependency(`node`,e).then(function(e){if(i.skin===void 0)return e;let t;return r.getDependency(`skin`,i.skin).then(function(e){t=e;let n=[];for(let e=0,i=t.joints.length;e<i;e++)n.push(r.getDependency(`node`, __get$(t.joints,e) ));return Promise.all(n)}).then(function(n){return e.traverse(function(e){if(!e.isMesh)return;let r=[],i=[];for(let e=0,a=n.length;e<a;e++){let a= __get$(n,e) ;if(a){r.push(a);let n=new vG;t.inverseBindMatrices!==void 0&&n.fromArray(t.inverseBindMatrices.array,e*16),i.push(n)}else console.warn(`THREE.GLTFLoader: Joint "%s" could not be found.`, __get$(t.joints,e) )}e.bind(new MJ(r,i),e.matrixWorld)}),e})}).then(function(e){t.add(e);let a=[];if(i.children){let t=i.children;for(let i=0,o=t.length;i<o;i++){let o= __get$(t,i) ;a.push(v0(o,e,n,r))}}return Promise.all(a)})}function y0(e,t,n){let r=t.attributes,i=new GW;if(r.POSITION!==void 0){let e= __get$(n.json.accessors,r.POSITION) ,t=e.min,a=e.max;if(t!==void 0&&a!==void 0){if(i.set(new Q(t[0],t[1],t[2]),new Q(a[0],a[1],a[2])),e.normalized){let t=g0( __get$(k2,e.componentType) );i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}else{console.warn(`THREE.GLTFLoader: Missing min/max properties for accessor POSITION.`);return}}else return;let a=t.targets;if(a!==void 0){let e=new Q,t=new Q;for(let r=0,i=a.length;r<i;r++){let i= __get$(a,r) ;if(i.POSITION!==void 0){let r= __get$(n.json.accessors,i.POSITION) ,a=r.min,o=r.max;if(a!==void 0&&o!==void 0){if(t.setX(Math.max(Math.abs(a[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(a[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2]))),r.normalized){let e=g0( __get$(k2,r.componentType) );t.multiplyScalar(e)}e.max(t)}else console.warn(`THREE.GLTFLoader: Missing min/max properties for accessor POSITION.`)}}i.expandByVector(e)}e.boundingBox=i;let o=new lG;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=o}function b0(e,t,n){let r=t.attributes,i=[];function a(t,r){return n.getDependency(`accessor`,t).then(function(t){e.setAttribute(r,t)})}for(let t in r){let n= __get$(N2,t) ||t.toLowerCase();n in e.attributes||i.push(a( __get$(r,t) ,n))}if(t.indices!==void 0&&!e.index){let r=n.getDependency(`accessor`,t.indices).then(function(t){e.setIndex(t)});i.push(r)}return d0(e,t),y0(e,t,n),Promise.all(i).then(function(){return t.targets===void 0?e:f0(e,t.targets,n)})}function x0(e,t){let n=e.getIndex();if(n===null){let t=[],r=e.getAttribute(`position`);if(r!==void 0){for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}else return console.error(`THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.`),e}let r=n.count-2,i=[];if(t===2)for(let e=1;e<=r;e++)i.push(n.getX(0)),i.push(n.getX(e)),i.push(n.getX(e+1));else for(let e=0;e<r;e++)e%2==0?(i.push(n.getX(e)),i.push(n.getX(e+1)),i.push(n.getX(e+2))):(i.push(n.getX(e+2)),i.push(n.getX(e+1)),i.push(n.getX(e)));i.length/3!==r&&console.error(`THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.`);let a=e.clone();return a.setIndex(i),a}function S0(e,t){return[{name:`board`,type:t0.Board,url:t?.board.assets.boardModel||SP(`three-d/board/board.glb`)},{name:`king`,type:t0.Piece,url:t?.pieces.assets.kModel||SP(`three-d/pieces/${e}/king.glb`)},{name:`queen`,type:t0.Piece,url:t?.pieces.assets.qModel||SP(`three-d/pieces/${e}/queen.glb`)},{name:`rook`,type:t0.Piece,url:t?.pieces.assets.rModel||SP(`three-d/pieces/${e}/rook.glb`)},{name:`bishop`,type:t0.Piece,url:t?.pieces.assets.bModel||SP(`three-d/pieces/${e}/bishop.glb`)},{name:`knight`,type:t0.Piece,url:t?.pieces.assets.nModel||SP(`three-d/pieces/${e}/knight.glb`)},{name:`pawn`,type:t0.Piece,url:t?.pieces.assets.pModel||SP(`three-d/pieces/${e}/pawn.glb`)}]}function C0(e){return  new Promise(t=>{let _hh$temp1280=e,n=_hh$temp1280.lights,r=_hh$temp1280.materials,i=_hh$temp1280.piecesGeom,a=_hh$temp1280.scene,_hh$temp1280$options=_hh$temp1280.options,o=_hh$temp1280$options.themeAssets,s=_hh$temp1280.pieceStyle,c=0,l=S0(s,o);l.forEach(o=>{new n2().load(o.url,s=>{if(e.destroyed)return;c+=1;let u=s.scene.children[0].geometry;if(o.type===t0.Board){let t=new HK(u,r.board);u1({axis:new Q(1,0,0),degrees:90,object:t}),t.position.x=X.Square.Size*4,t.position.z=X.Square.Size*4,n.whiteSideLight.target=t,n.blackSideLight.target=t,a.add(t),e.boardModel=t;}else o.type===t0.Piece&&__set$(i,o.name,u);c===l.length&&t();});});}) }function w0(e,t,n){return[{name:`board`,url:n?.board.assets.background||SP(`three-d/board/textures/board_${e}.jpg`)},{name:`boardNotation`,url:n?.board.assets.coordinates||SP(`three-d/board/textures/board_${e}_notation.png`)},{name:`pieceWhite`,url:n?.pieces.assets.lightTexture||SP(`three-d/pieces/${t}/textures/piece_white.jpg`)},{name:`pieceBlack`,url:n?.pieces.assets.darkTexture||SP(`three-d/pieces/${t}/textures/piece_black.jpg`)},{name:`boardShadow`,url:n?.board.assets.boardShadow||SP(`three-d/board/textures/board_shadow.png`)},{name:`kingShadow`,url:n?.pieces.assets.kShadow||SP(`three-d/pieces/${t}/textures/king_shadow.png`)},{name:`queenShadow`,url:n?.pieces.assets.qShadow||SP(`three-d/pieces/${t}/textures/queen_shadow.png`)},{name:`rookShadow`,url:n?.pieces.assets.rShadow||SP(`three-d/pieces/${t}/textures/rook_shadow.png`)},{name:`bishopShadow`,url:n?.pieces.assets.bShadow||SP(`three-d/pieces/${t}/textures/bishop_shadow.png`)},{name:`knightShadow`,url:n?.pieces.assets.nShadow||SP(`three-d/pieces/${t}/textures/knight_shadow.png`)},{name:`pawnShadow`,url:n?.pieces.assets.pShadow||SP(`three-d/pieces/${t}/textures/pawn_shadow.png`)}]}function T0(e){ let _hh$temp1281=e,t=_hh$temp1281.boardThemes,n=_hh$temp1281.boardStyle,_hh$temp1281$options=_hh$temp1281.options,r=_hh$temp1281$options.themeAssets,i={},a=w0((__get$(t,n)??Xb.green)[2],e.pieceStyle,r),o=new PX(),s=[]; return a.forEach(e=>{s.push( new Promise(t=>{__set$(i,e.name,o.load(e.url,t));}) )}),new Promise(e=>Promise.all(s).then(()=>{e(i)}))}function E0(e){return new Promise(t=>{T0(e).then(n=>{e.destroyed||(s0(e,n),e.boardNotationPlane.material=e.materials.boardNotation,e.groundModel.material=e.shadowMaterials.ground,e.hoverSquare.material=e.materials.squareOver,C0(e).then(()=>{t()}))})})}function D0(e,t){e.scene.add(t.obj)}function O0(e,t){ let _hh$temp1282=t,n=_hh$temp1282.color,r=_hh$temp1282.opacity,i=_hh$temp1282.isKnight,a=e1(e,t.from),o=e1(e,t.to),s=hv({from:a,to:o}),c=_v({from:a,to:o}),l=Qw.includes(c)?-1:1,u=i?vv({from:a,slope:c,to:o}):gv({from:a,to:o}),d=new HK(new WY(k0(s,i)),new aX({color:new kW(n),depthTest:!1,depthWrite:!1,opacity:r,transparent:!0})); return d.position.x=a.x,d.position.y=X.Arrow.PositionY,d.position.z=a.y,d.scale.x*=l,d.renderOrder=X.ObjectsRenderOrder.Arrow,u1({axis:new Q(1,0,0),degrees:-90,object:d}),u1({axis:new Q(0,0,1),degrees:-u,object:d}),d}function k0(e,t){let n=X.Square.Size,r=n*8,i=r*Zw.WIDTH*.01*.5,a=r*Zw.HEAD_HEIGHT*.01,o=r*Zw.HEAD_WIDTH*.01*.5,s=r*Zw.TAIL_PADDING*.01,c=new IY;return t?c.moveTo(-i,-s).lineTo(i,-s).lineTo(i,i-n*2).lineTo(n-a,i-n*2).lineTo(n-a,o-n*2).lineTo(n,-n*2).lineTo(n-a,-(n*2+o)).lineTo(n-a,-(n*2+i)).lineTo(-i,-(n*2+i)):c.moveTo(i,-s).lineTo(-i,-s).lineTo(-i,-e+a).lineTo(-o,-e+a).lineTo(0,-e).lineTo(o,-e+a).lineTo(i,-e+a),c}function A0(e,t){e.scene.remove(t.obj),t.obj.geometry.dispose()}function j0(e,t){e.scene.add(t.obj)}function M0(e,t){ let _hh$temp1283=e,n=_hh$temp1283.highlightGeom,_hh$temp1284=t,r=_hh$temp1284.color,i=_hh$temp1284.opacity,a=_hh$temp1284.position,o=new rK({color:r,opacity:i}); o.transparent=!0,o.depthWrite=!1;let s=new HK(n,o);return u1({axis:new Q(1,0,0),degrees:-90,object:s}),s.renderOrder=X.ObjectsRenderOrder.HighligtedSquare,s.position.set(a.x,.005,a.y),s}function N0(e){let t=new IY,n=new CY,r=X.Square.HalfSize,i=X.Square.HalfSize-X.Square.OverBorderSize;t.moveTo(-r,-r),t.lineTo(r,-r),t.lineTo(r,r),t.lineTo(-r,r),t.lineTo(-r,-r),n.moveTo(-i,-i),n.lineTo(i,-i),n.lineTo(i,i),n.lineTo(-i,i),n.lineTo(-i,-i),t.holes.push(n);let a=new HK(new WY(t));return a.position.set(X.Square.Size,X.Square.InvisibleY,X.Square.Size),a.renderOrder=X.ObjectsRenderOrder.OverSquare,u1({axis:new Q(1,0,0),degrees:-90,object:a}),e.scene.add(a),a}function P0(e){ let _hh$temp1285=e,t=_hh$temp1285.hoverSquare; t&&(t.position.x=X.Square.Size,t.position.y=X.Square.InvisibleY,t.position.z=X.Square.Size)}function F0(e,t){e.scene.remove(t.obj)}function I0(e,t){ let _hh$temp1286=e,n=_hh$temp1286.hoverSquare; n&&(n.position.x=t.x,n.position.y=X.Square.VisibleY,n.position.z=t.y)}function L0(e,t){e.scene.add(t.obj)}function R0(e,t){ let _hh$temp1287=e,n=_hh$temp1287.captureHintGeom,_hh$temp1288=t,r=_hh$temp1288.color,i=_hh$temp1288.opacity,a=_hh$temp1288.position,o=new rK({color:r,opacity:i}); o.transparent=!0,o.depthWrite=!1;let s=new HK(n,o);return s.renderOrder=X.ObjectsRenderOrder.Hint,u1({axis:new Q(1,0,0),degrees:-90,object:s}),s.position.set(a.x,.005,a.y),s}function z0(e,t){ let _hh$temp1289=e,n=_hh$temp1289.moveHintGeom,_hh$temp1290=t,r=_hh$temp1290.color,i=_hh$temp1290.opacity,a=_hh$temp1290.position,o=new rK({color:r,opacity:i}); o.transparent=!0,o.depthWrite=!1;let s=new HK(n,o);return s.renderOrder=X.ObjectsRenderOrder.Hint,u1({axis:new Q(1,0,0),degrees:-90,object:s}),s.position.set(a.x,.005,a.y),s}function B0(e,t){e.scene.remove(t.obj)}function V0(e){if(!e.promotionWindowEl)throw new LC({code:RC.ElementNotFound,message:`Promotion window does not exist.`});e.promotionWindowEl.style.display=`none`}function H0(e){let t=document.getElementById(`${E1(e.boardId)}`);if(!e.promotionWindowEl)throw new LC({code:RC.ElementNotFound,message:`Promotion window does not exist.`});if(!t)throw new LC({code:RC.ElementNotFound,message:`Promotion window close button does not exist.`});e.promotionWindowEl.addEventListener(mC,t=>{t.preventDefault(),t.stopPropagation();let n=t.target.getAttribute(`data-pieceType`);return n&&e.promotionHandler(n),!1}),t.addEventListener(mC,t=>(t.preventDefault(),t.stopPropagation(),e.promotionHandler(),!1)),e.isPromotionWindowInitialized=!0}function U0(e,t){if(!e.promotionWindowEl)throw new LC({code:RC.ElementNotFound,message:`Promotion window does not exist.`});e.isPromotionWindowInitialized||H0(e);let n=document.getElementById(`${D1(e.boardId,J.ColorsAsNumbers.White)}`),r=document.getElementById(`${D1(e.boardId,J.ColorsAsNumbers.Black)}`);if(!n)throw new LC({code:RC.ElementNotFound,message:`White pieces container for promotion window does not exist.`});if(!r)throw new LC({code:RC.ElementNotFound,message:`Black pieces container for promotion window does not exist.`});return t.color===J.ColorsAsNumbers.White?(r.style.display=`none`,n.style.display=`block`):(r.style.display=`block`,n.style.display=`none`),e.promotionWindowEl.style.display=`block`,new Promise(t=>e.promotionHandler=t)}function W0(e){ let _hh$temp1291=e,t=_hh$temp1291.animation,n=_hh$temp1291.cameraState,r=_hh$temp1291.isPromotionWindowVisible,i=_hh$temp1291.options,a=_hh$temp1291.pointer; !i.enabled||r||a.insideBoard||B$({animation:t,isFlipped:i.flipped,state:n})}function G0(e,t){ let _hh$temp1292=e,n=_hh$temp1292.cameraState,r=_hh$temp1292.isPromotionWindowVisible,i=_hh$temp1292.options,a=_hh$temp1292.pointer,o=_hh$temp1292.viewEl; if(r||a.event.target!==o)return!1;if(t>0){if(n.distance>X.Camera.DistanceMax)return!0;n.distance+=X.Camera.ZoomIncrement}else{if(n.distance<X.Camera.DistanceMin)return!0;n.distance-=X.Camera.ZoomIncrement}return V$({panAngle:n.panAngle,state:n,tiltAngle:n.tiltAngle}),U$({isFlipped:i.flipped,state:n}),!0}function K0(e){ let _hh$temp1293=e,t=_hh$temp1293.containerEl,n=_hh$temp1293.isPromotionWindowVisible,r=_hh$temp1293.pointer; n||U1(e,r.boardPosition)&&t.classList.add(X.CssClasses.PieceDrag)}function q0(e){ let _hh$temp1294=e,t=_hh$temp1294.containerEl,n=_hh$temp1294.isPromotionWindowVisible,r=_hh$temp1294.pointer,i=_hh$temp1294.selectedPiece; n||(J0(e),e.isBoardEnabled&&(!i&&U1(e,r.boardPosition)?t.classList.add(X.CssClasses.PieceHover):i||t.classList.remove(X.CssClasses.PieceHover)))}function J0(e){ let _hh$temp1295=e,t=_hh$temp1295.pointer; !t.down||t.downInsideBoard||(t.rightDown?Y0(e):t.secondaryDown&&X0(e))}function Y0(e){ let _hh$temp1296=e,t=_hh$temp1296.cameraState,n=_hh$temp1296.pointer,_hh$temp1297=n,r=_hh$temp1297.viewPosition,i=_hh$temp1297.previousViewPosition; V$({panAngle:t.panAngle-(r.x-i.x)*.6,state:t,tiltAngle:t.tiltAngle+(r.y-i.y)*.6}),t.isRotating=!0}function X0(e){ let _hh$temp1298=e,t=_hh$temp1298.cameraState,n=_hh$temp1298.pointer,_hh$temp1299=n,r=_hh$temp1299.viewPosition,i=_hh$temp1299.previousViewPosition; z$({panH:(r.x-i.x)*.1*-1,panV:(r.y-i.y)*.1,state:t}),t.isPanning=!0}function Z0(e){ let _hh$temp1300=e,t=_hh$temp1300.cameraState,n=_hh$temp1300.containerEl,r=_hh$temp1300.isPromotionWindowVisible,i=_hh$temp1300.options; !i.enabled||r||((t.isRotating||t.isPanning)&&(t.isRotating=!1,t.isPanning=!1,U$({isFlipped:i.flipped,state:t})),n.classList.remove(X.CssClasses.PieceDrag))}function Q0(e,t){e.scene.add(t.obj)}function $0(e,t){ let _hh$temp1301=e,n=_hh$temp1301.customItemGeom,_hh$temp1302=t,r=_hh$temp1302.position,i=_hh$temp1302.type,a=_hh$temp1302.image,o=_hh$temp1302.frame,s=_hh$temp1302.opacity,c=_hh$temp1302.visualOrder,l=new rK({opacity:a&&s?s:Kb.CustomItem.Opacity,depthWrite:!1,depthTest:i!==J.Node.Marking.CustomItem.Types.TextBox,transparent:!0}),u=1; if(a)l.map=new PX().load(a.url,e=>{d1(e.image)}),a.percentOfSquare&&(u=a.percentOfSquare*.01);else if(o)o.imageAnimated?c1(o.imageURL,{transparent:!0}).then(e=>{d1(e.image),l.map=e,l.needsUpdate=!0}):l1(o.imageURL,{frame:{xRatio:o.positionRatioX,yRatio:o.positionRatioY,widthRatio:o.widthRatio,heightRatio:o.heightRatio,cropRatio:Kb.CustomItem.FrameCropRatio},transparent:!0}).then(e=>{d1(e.image),l.map=e,l.needsUpdate=!0}),l.opacity=1;else{let n=iN( __get$(lx,i) ,t);if(l.map=f1(n),e.options.test){let e=document.createElement(`div`);e.innerHTML=n,t.testSVG=e.querySelector(`svg`)}}let d=new HK(n,l);return d.scale.x*=u,d.scale.y*=u,d.position.set(r.x,X.CustomItem.PositionY,r.y),d.renderOrder=X.ObjectsRenderOrder.CustomItem,c&&(c.target===_b.Targets.Arrows?d.renderOrder=X.ObjectsRenderOrder.Arrow:c.target===_b.Targets.Effects&&(d.renderOrder=X.ObjectsRenderOrder.Effect),d.renderOrder=c.position===_b.Positions.Above?d.renderOrder+=1:--d.renderOrder),u1({axis:new Q(1,0,0),degrees:-90,object:d}),d}function e2(e,t){let n=t.obj.material,r=n.map;t.info.frame?.imageAnimated&&r?(n.depthTest=!1,t.obj.renderOrder=X.ObjectsRenderOrder.Highest,i1(r,{animator:e.animator,onEnd:()=>{e.scene.remove(t.obj)}})):e.scene.remove(t.obj)}function t2( _hh$temp1303 ){ var e=_hh$temp1303.el,_hh$temp1303$emitter=_hh$temp1303.emitter,t=_hh$temp1303$emitter===void 0?s():_hh$temp1303$emitter,n=_hh$temp1303.options,_hh$temp1303$boardStyles=_hh$temp1303.boardStyles,r=_hh$temp1303$boardStyles===void 0?Xb:_hh$temp1303$boardStyles,_hh$temp1303$pieceStyles=_hh$temp1303.pieceStyles,i=_hh$temp1303$pieceStyles===void 0?Zb:_hh$temp1303$pieceStyles,a=_hh$temp1303.testElement; let o=e0,c={addAnalysisOverlay:p1,addArrow:D0,addCustomItem:Q0,addEffect:g1,addHighlight:j0,addHint:L0,addPiece:z1,closePromotionWindow:V0,createArrowObj:O0,createCaptureHintObj:R0,createCustomItemObj:$0,createEffectObj:_1,createHighlightObj:M0,createHoverSquareObj:N0,createMoveHintObj:z0,createPieceObj:B1,createState:q$,destroy:Y$,fadeInAllPieces:H1,fileRankToPosition:e1,flipBoard:b1,getBoardPosition:t1,getViewPosition:n1,getViewAspectRatio:r1,hideHoverSquare:P0,init:M1,loadAssets:E0,normalizePointer:N1,onMouseDoubleClick:W0,onMouseWheel:G0,onPieceDrag:G1,onPieceDrop:q1,onPointerDown:K0,onPointerMove:q0,onPointerUp:Z0,onWebGLContextLost:P1,openPromotionWindow:U0,positionToFileRank:F1,positionToNearestSquare:I1,removeAnalysisOverlay:x1,removeArrow:A0,removeCustomItem:e2,removeEffect:v1,removeHighlight:F0,removeHint:B0,removePiece:Y1,render:L1,setPiecePosition:X1,showHoverSquare:I0,updateBoardCoordinates:S1,updateBoardStyle:C1,updatePiecesStyle:Z1,updatePieceVisuals:Q1,updateViewSize:R1};return $N({animationMethods:o,boardThemes:r,emitter:t,pieceThemes:i,className:X.CssClasses.Board,containerEl:e,methods:c,name:nx.Types.WebGL3D,options:n,testElement:a})}var n2,r2,i2,a2,o2,s2,c2,l2,u2,d2,f2,p2,m2,h2,g2,_2,v2,y2,b2,x2,S2,C2,w2,T2,E2,D2,O2,k2,A2,j2,M2,N2,P2,F2,I2,L2,R2=e((()=>{r0(),ZO(),wP(),bt(),T$(),n2=class extends EX{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new s2(e)}),this.register(function(e){return new p2(e)}),this.register(function(e){return new m2(e)}),this.register(function(e){return new c2(e)}),this.register(function(e){return new l2(e)}),this.register(function(e){return new u2(e)}),this.register(function(e){return new d2(e)}),this.register(function(e){return new o2(e)}),this.register(function(e){return new f2(e)}),this.register(function(e){return new i2(e)}),this.register(function(e){return new h2(e)})}load(e,t,n,r){let i=this,a;a=this.resourcePath===``?this.path===``?tZ.extractUrlBase(e):this.path:this.resourcePath,this.manager.itemStart(e);let o=function(t){r?r(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},s=new OX(this.manager);s.setPath(this.path),s.setResponseType(`arraybuffer`),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(n){try{i.parse(n,a,function(n){t(n),i.manager.itemEnd(e)},o)}catch(e){o(e)}},n,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error(`THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".`)}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let i,a={},o={};if(typeof e==`string`)i=e;else if(tZ.decodeText(new Uint8Array(e,0,4))===g2){try{ __set$(a,r2.KHR_BINARY_GLTF,new y2(e)) }catch(e){r&&r(e);return}i= __get$(a,r2.KHR_BINARY_GLTF) .content}else i=tZ.decodeText(new Uint8Array(e));let s=JSON.parse(i);if(s.asset===void 0||s.asset.version[0]<2){r&&r(Error(`THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.`));return}let c=new L2(s,{path:t||this.resourcePath||``,crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t= __call$(this.pluginCallbacks,e,[c]) ; __set$(o,t.name,t) , __set$(a,t.name,!0) }if(s.extensionsUsed)for(let e=0;e<s.extensionsUsed.length;++e){let t= __get$(s.extensionsUsed,e) ,n=s.extensionsRequired||[];switch(t){case r2.KHR_MATERIALS_UNLIT: __set$(a,t,new a2()) ;break;case r2.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: __set$(a,t,new C2()) ;break;case r2.KHR_DRACO_MESH_COMPRESSION: __set$(a,t,new b2(s,this.dracoLoader)) ;break;case r2.KHR_TEXTURE_TRANSFORM: __set$(a,t,new x2()) ;break;case r2.KHR_MESH_QUANTIZATION: __set$(a,t,new w2()) ;break;default:n.indexOf(t)>=0&& __get$(o,t) ===void 0&&console.warn(`THREE.GLTFLoader: Unknown extension "`+t+`".`)}}c.setExtensions(a),c.setPlugins(o),c.parse(n,r)}parseAsync(e,t){let n=this;return new Promise(function(r,i){n.parse(e,t,r,i)})}},r2={KHR_BINARY_GLTF:`KHR_binary_glTF`,KHR_DRACO_MESH_COMPRESSION:`KHR_draco_mesh_compression`,KHR_LIGHTS_PUNCTUAL:`KHR_lights_punctual`,KHR_MATERIALS_CLEARCOAT:`KHR_materials_clearcoat`,KHR_MATERIALS_IOR:`KHR_materials_ior`,KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:`KHR_materials_pbrSpecularGlossiness`,KHR_MATERIALS_SHEEN:`KHR_materials_sheen`,KHR_MATERIALS_SPECULAR:`KHR_materials_specular`,KHR_MATERIALS_TRANSMISSION:`KHR_materials_transmission`,KHR_MATERIALS_UNLIT:`KHR_materials_unlit`,KHR_MATERIALS_VOLUME:`KHR_materials_volume`,KHR_TEXTURE_BASISU:`KHR_texture_basisu`,KHR_TEXTURE_TRANSFORM:`KHR_texture_transform`,KHR_MESH_QUANTIZATION:`KHR_mesh_quantization`,KHR_MATERIALS_EMISSIVE_STRENGTH:`KHR_materials_emissive_strength`,EXT_TEXTURE_WEBP:`EXT_texture_webp`,EXT_MESHOPT_COMPRESSION:`EXT_meshopt_compression`},i2=class{constructor(e){this.parser=e,this.name=r2.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){let r= __get$(t,n) ;r.extensions&& __get$(r.extensions,this.name) && __get$(r.extensions,this.name) .light!==void 0&&e._addNodeRef(this.cache, __get$(r.extensions,this.name) .light)}}_loadLight(e){let t=this.parser,n=`light:`+e,r=t.cache.get(n);if(r)return r;let i=t.json,a= __get$(((i.extensions&&__get$(i.extensions,this.name))||{}).lights||[],e) ,o,s=new kW(16777215);a.color!==void 0&&s.fromArray(a.color);let c=a.range===void 0?0:a.range;switch(a.type){case`directional`:o=new YX(s),o.target.position.set(0,0,-1),o.add(o.target);break;case`point`:o=new qX(s),o.distance=c;break;case`spot`:o=new HX(s),o.distance=c,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle===void 0?0:a.spot.innerConeAngle,a.spot.outerConeAngle=a.spot.outerConeAngle===void 0?Math.PI/4:a.spot.outerConeAngle,o.angle=a.spot.outerConeAngle,o.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw Error(`THREE.GLTFLoader: Unexpected light type: `+a.type)}return o.position.set(0,0,0),o.decay=2,a.intensity!==void 0&&(o.intensity=a.intensity),o.name=t.createUniqueName(a.name||`light_`+e),r=Promise.resolve(o),t.cache.add(n,r),r}createNodeAttachment(e){let t=this,n=this.parser,r= __get$(n.json.nodes,e) ,i=(r.extensions&& __get$(r.extensions,this.name) ||{}).light;return i===void 0?null:this._loadLight(i).then(function(e){return n._getNodeRef(t.cache,i,e)})}},a2=class{constructor(){this.name=r2.KHR_MATERIALS_UNLIT}getMaterialType(){return rK}extendParams(e,t,n){let r=[];e.color=new kW(1,1,1),e.opacity=1;let i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){let t=i.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}i.baseColorTexture!==void 0&&r.push(n.assignTexture(e,`map`,i.baseColorTexture,PU))}return Promise.all(r)}},o2=class{constructor(e){this.parser=e,this.name=r2.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let n= __get$(this.parser.json.materials,e) ;if(!n.extensions||! __get$(n.extensions,this.name) )return Promise.resolve();let r= __get$(n.extensions,this.name) .emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}},s2=class{constructor(e){this.parser=e,this.name=r2.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let t= __get$(this.parser.json.materials,e) ;return!t.extensions||! __get$(t.extensions,this.name) ?null:tX}extendMaterialParams(e,t){let n=this.parser,r= __get$(n.json.materials,e) ;if(!r.extensions||! __get$(r.extensions,this.name) )return Promise.resolve();let i=[],a= __get$(r.extensions,this.name) ;if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&i.push(n.assignTexture(t,`clearcoatMap`,a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&i.push(n.assignTexture(t,`clearcoatRoughnessMap`,a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(i.push(n.assignTexture(t,`clearcoatNormalMap`,a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){let e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Z(e,e)}return Promise.all(i)}},c2=class{constructor(e){this.parser=e,this.name=r2.KHR_MATERIALS_SHEEN}getMaterialType(e){let t= __get$(this.parser.json.materials,e) ;return!t.extensions||! __get$(t.extensions,this.name) ?null:tX}extendMaterialParams(e,t){let n=this.parser,r= __get$(n.json.materials,e) ;if(!r.extensions||! __get$(r.extensions,this.name) )return Promise.resolve();let i=[];t.sheenColor=new kW(0,0,0),t.sheenRoughness=0,t.sheen=1;let a= __get$(r.extensions,this.name) ;return a.sheenColorFactor!==void 0&&t.sheenColor.fromArray(a.sheenColorFactor),a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&i.push(n.assignTexture(t,`sheenColorMap`,a.sheenColorTexture,PU)),a.sheenRoughnessTexture!==void 0&&i.push(n.assignTexture(t,`sheenRoughnessMap`,a.sheenRoughnessTexture)),Promise.all(i)}},l2=class{constructor(e){this.parser=e,this.name=r2.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let t= __get$(this.parser.json.materials,e) ;return!t.extensions||! __get$(t.extensions,this.name) ?null:tX}extendMaterialParams(e,t){let n=this.parser,r= __get$(n.json.materials,e) ;if(!r.extensions||! __get$(r.extensions,this.name) )return Promise.resolve();let i=[],a= __get$(r.extensions,this.name) ;return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&i.push(n.assignTexture(t,`transmissionMap`,a.transmissionTexture)),Promise.all(i)}},u2=class{constructor(e){this.parser=e,this.name=r2.KHR_MATERIALS_VOLUME}getMaterialType(e){let t= __get$(this.parser.json.materials,e) ;return!t.extensions||! __get$(t.extensions,this.name) ?null:tX}extendMaterialParams(e,t){let n=this.parser,r= __get$(n.json.materials,e) ;if(!r.extensions||! __get$(r.extensions,this.name) )return Promise.resolve();let i=[],a= __get$(r.extensions,this.name) ;t.thickness=a.thicknessFactor===void 0?0:a.thicknessFactor,a.thicknessTexture!==void 0&&i.push(n.assignTexture(t,`thicknessMap`,a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||0;let o=a.attenuationColor||[1,1,1];return t.attenuationColor=new kW(o[0],o[1],o[2]),Promise.all(i)}},d2=class{constructor(e){this.parser=e,this.name=r2.KHR_MATERIALS_IOR}getMaterialType(e){let t= __get$(this.parser.json.materials,e) ;return!t.extensions||! __get$(t.extensions,this.name) ?null:tX}extendMaterialParams(e,t){let n= __get$(this.parser.json.materials,e) ;if(!n.extensions||! __get$(n.extensions,this.name) )return Promise.resolve();let r= __get$(n.extensions,this.name) ;return t.ior=r.ior===void 0?1.5:r.ior,Promise.resolve()}},f2=class{constructor(e){this.parser=e,this.name=r2.KHR_MATERIALS_SPECULAR}getMaterialType(e){let t= __get$(this.parser.json.materials,e) ;return!t.extensions||! __get$(t.extensions,this.name) ?null:tX}extendMaterialParams(e,t){let n=this.parser,r= __get$(n.json.materials,e) ;if(!r.extensions||! __get$(r.extensions,this.name) )return Promise.resolve();let i=[],a= __get$(r.extensions,this.name) ;t.specularIntensity=a.specularFactor===void 0?1:a.specularFactor,a.specularTexture!==void 0&&i.push(n.assignTexture(t,`specularIntensityMap`,a.specularTexture));let o=a.specularColorFactor||[1,1,1];return t.specularColor=new kW(o[0],o[1],o[2]),a.specularColorTexture!==void 0&&i.push(n.assignTexture(t,`specularColorMap`,a.specularColorTexture,PU)),Promise.all(i)}},p2=class{constructor(e){this.parser=e,this.name=r2.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,n=t.json,r= __get$(n.textures,e) ;if(!r.extensions||! __get$(r.extensions,this.name) )return null;let i= __get$(r.extensions,this.name) ,a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw Error(`THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures`);return null}return t.loadTextureImage(e,i.source,a)}},m2=class{constructor(e){this.parser=e,this.name=r2.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,n=this.parser,r=n.json,i= __get$(r.textures,e) ;if(!i.extensions||! __get$(i.extensions,t) )return null;let a= __get$(i.extensions,t) ,o= __get$(r.images,a.source) ,s=n.textureLoader;if(o.uri){let e=n.options.manager.getHandler(o.uri);e!==null&&(s=e)}return this.detectSupport().then(function(i){if(i)return n.loadTextureImage(e,a.source,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw Error(`THREE.GLTFLoader: WebP required by asset but unsupported.`);return n.loadTexture(e)})}detectSupport(){return this.isSupported||=new Promise(function(e){let t=new Image;t.src=`data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA`,t.onload=t.onerror=function(){e(t.height===1)}}),this.isSupported}},h2=class{constructor(e){this.name=r2.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,n= __get$(t.bufferViews,e) ;if(n.extensions&& __get$(n.extensions,this.name) ){let e= __get$(n.extensions,this.name) ,r=this.parser.getDependency(`buffer`,e.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw Error(`THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files`);return null}return Promise.all([r,i.ready]).then(function(t){let n=e.byteOffset||0,r=e.byteLength||0,a=e.count,o=e.byteStride,s=new ArrayBuffer(a*o),c=new Uint8Array(t[0],n,r);return i.decodeGltfBuffer(new Uint8Array(s),a,o,c,e.mode,e.filter),s})}else return null}},g2=`glTF`,_2=12,v2={JSON:1313821514,BIN:5130562},y2=class{constructor(e){this.name=r2.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,_2);if(this.header={magic:tZ.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==g2)throw Error(`THREE.GLTFLoader: Unsupported glTF-Binary header.`);if(this.header.version<2)throw Error(`THREE.GLTFLoader: Legacy binary file detected.`);let n=this.header.length-_2,r=new DataView(e,_2),i=0;for(;i<n;){let t=r.getUint32(i,!0);i+=4;let n=r.getUint32(i,!0);if(i+=4,n===v2.JSON){let n=new Uint8Array(e,_2+i,t);this.content=tZ.decodeText(n)}else if(n===v2.BIN){let n=_2+i;this.body=e.slice(n,n+t)}i+=t}if(this.content===null)throw Error(`THREE.GLTFLoader: JSON content not found.`)}},b2=class{constructor(e,t){if(!t)throw Error(`THREE.GLTFLoader: No DRACOLoader instance provided.`);this.name=r2.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let n=this.json,r=this.dracoLoader,i= __get$(e.extensions,this.name) .bufferView,a= __get$(e.extensions,this.name) .attributes,o={},s={},c={};for(let e in a){let t= __get$(N2,e) ||e.toLowerCase(); __set$(o,t,__get$(a,e)) }for(let t in e.attributes){let r= __get$(N2,t) ||t.toLowerCase();if( __get$(a,t) !==void 0){let i= __get$(n.accessors,__get$(e.attributes,t)) ; __set$(c,r,__get$(k2,i.componentType)) , __set$(s,r,i.normalized===!0) }}return t.getDependency(`bufferView`,i).then(function(e){return  new Promise(function(t){r.decodeDracoFile(e,function(e){for(let t in e.attributes){let n=__get$(e.attributes,t),r=__get$(s,t);r!==void 0&&(n.normalized=r);}t(e);},o,c);}) })}},x2=class{constructor(){this.name=r2.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn(`THREE.GLTFLoader: Custom UV sets in "`+this.name+`" extension not yet supported.`),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0?e:(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e)}},S2=class extends eX{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;let t=[`#ifdef USE_SPECULARMAP`,`	uniform sampler2D specularMap;`,`#endif`].join(`
`),n=[`#ifdef USE_GLOSSINESSMAP`,`	uniform sampler2D glossinessMap;`,`#endif`].join(`
`),r=[`vec3 specularFactor = specular;`,`#ifdef USE_SPECULARMAP`,`	vec4 texelSpecular = texture2D( specularMap, vUv );`,`	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture`,`	specularFactor *= texelSpecular.rgb;`,`#endif`].join(`
`),i=[`float glossinessFactor = glossiness;`,`#ifdef USE_GLOSSINESSMAP`,`	vec4 texelGlossiness = texture2D( glossinessMap, vUv );`,`	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture`,`	glossinessFactor *= texelGlossiness.a;`,`#endif`].join(`
`),a=[`PhysicalMaterial material;`,`material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );`,`vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );`,`float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );`,`material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.`,`material.roughness += geometryRoughness;`,`material.roughness = min( material.roughness, 1.0 );`,`material.specularColor = specularFactor;`].join(`
`),o={specular:{value:new kW().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=o,this.onBeforeCompile=function(e){for(let t in o) __set$(e.uniforms,t,__get$(o,t)) ;e.fragmentShader= __call$(__call$(__call$(__call$(__call$(__call$(__call$(e.fragmentShader,"replace",[`uniform float roughness;`,`uniform vec3 specular;`]),"replace",[`uniform float metalness;`,`uniform float glossiness;`]),"replace",[`#include <roughnessmap_pars_fragment>`,t]),"replace",[`#include <metalnessmap_pars_fragment>`,n]),"replace",[`#include <roughnessmap_fragment>`,r]),"replace",[`#include <metalnessmap_fragment>`,i]),"replace",[`#include <lights_physical_fragment>`,a]) },Object.defineProperties(this,{specular:{get:function(){return o.specular.value},set:function(e){o.specular.value=e}},specularMap:{get:function(){return o.specularMap.value},set:function(e){o.specularMap.value=e,e?this.defines.USE_SPECULARMAP=``:delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return o.glossiness.value},set:function(e){o.glossiness.value=e}},glossinessMap:{get:function(){return o.glossinessMap.value},set:function(e){o.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP=``,this.defines.USE_UV=``):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}},C2=class{constructor(){this.name=r2.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=[`color`,`map`,`lightMap`,`lightMapIntensity`,`aoMap`,`aoMapIntensity`,`emissive`,`emissiveIntensity`,`emissiveMap`,`bumpMap`,`bumpScale`,`normalMap`,`normalMapType`,`displacementMap`,`displacementScale`,`displacementBias`,`specularMap`,`specular`,`glossinessMap`,`glossiness`,`alphaMap`,`envMap`,`envMapIntensity`]}getMaterialType(){return S2}extendParams(e,t,n){let r= __get$(t.extensions,this.name) ;e.color=new kW(1,1,1),e.opacity=1;let i=[];if(Array.isArray(r.diffuseFactor)){let t=r.diffuseFactor;e.color.fromArray(t),e.opacity=t[3]}if(r.diffuseTexture!==void 0&&i.push(n.assignTexture(e,`map`,r.diffuseTexture,PU)),e.emissive=new kW(0,0,0),e.glossiness=r.glossinessFactor===void 0?1:r.glossinessFactor,e.specular=new kW(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),r.specularGlossinessTexture!==void 0){let t=r.specularGlossinessTexture;i.push(n.assignTexture(e,`glossinessMap`,t)),i.push(n.assignTexture(e,`specularMap`,t,PU))}return Promise.all(i)}createMaterial(e){let t=new S2(e);return t.fog=!0,t.color=e.color,t.map=e.map===void 0?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=e.aoMap===void 0?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=e.emissiveIntensity===void 0?1:e.emissiveIntensity,t.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,t.bumpMap=e.bumpMap===void 0?null:e.bumpMap,t.bumpScale=1,t.normalMap=e.normalMap===void 0?null:e.normalMap,t.normalMapType=0,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=e.specularMap===void 0?null:e.specularMap,t.specular=e.specular,t.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=e.envMap===void 0?null:e.envMap,t.envMapIntensity=1,t}},w2=class{constructor(){this.name=r2.KHR_MESH_QUANTIZATION}},T2=class extends uX{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r;for(let e=0;e!==r;e++) __set$(t,e,__get$(n,i+e)) ;return t}},T2.prototype.beforeStart_=T2.prototype.copySampleValue_,T2.prototype.afterEnd_=T2.prototype.copySampleValue_,T2.prototype.interpolate_=function(e,t,n,r){let i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=o*2,c=o*3,l=r-t,u=(n-t)/l,d=u*u,f=d*u,p=e*c,m=p-c,h=-2*f+3*d,g=f-d,_=1-h,v=g-d+u;for(let e=0;e!==o;e++){let t= __get$(a,m+e+o) ,n= __get$(a,m+e+s) *l,r= __get$(a,p+e+o) ,c= __get$(a,p+e) *l; __set$(i,e,_*t+v*n+h*r+g*c) }return i},E2=new HW,D2=class extends T2{interpolate_(e,t,n,r){let i=super.interpolate_(e,t,n,r);return E2.fromArray(i).normalize().toArray(i),i}},O2={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},k2={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},A2={9728:gH,9729:xH,9984:_H,9985:SH,9986:yH,9987:wH},j2={33071:mH,33648:hH,10497:pH},M2={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},N2={POSITION:`position`,NORMAL:`normal`,TANGENT:`tangent`,TEXCOORD_0:`uv`,TEXCOORD_1:`uv2`,COLOR_0:`color`,WEIGHTS_0:`skinWeight`,JOINTS_0:`skinIndex`},P2={scale:`scale`,translation:`position`,rotation:`quaternion`,weights:`morphTargetInfluences`},F2={CUBICSPLINE:void 0,LINEAR:TU,STEP:wU},I2={OPAQUE:`OPAQUE`,MASK:`MASK`,BLEND:`BLEND`},L2=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new c0,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf(`Firefox`)>-1,i=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;typeof createImageBitmap>`u`||n||r&&i<98?this.textureLoader=new PX(this.options.manager):this.textureLoader=new cZ(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new OX(this.options.manager),this.fileLoader.setResponseType(`arraybuffer`),this.options.crossOrigin===`use-credentials`&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([n.getDependencies(`scene`),n.getDependencies(`animation`),n.getDependencies(`camera`)])}).then(function(t){let a={scene: __get$(t[0],r.scene||0) ,scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};u0(i,a,r),d0(a,r),Promise.all(n._invokeAll(function(e){return e.afterRoot&&e.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let n=0,r=t.length;n<r;n++){let r= __get$(t,n) .joints;for(let t=0,n=r.length;t<n;t++) __get$(e,__get$(r,t)) .isBone=!0}for(let t=0,r=e.length;t<r;t++){let r= __get$(e,t) ;r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&( __get$(n,r.mesh) .isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&( __get$(e.refs,t) ===void 0&&( __set$(e.refs,t,__set$(e.uses,t,0)) ),e.refs[t]++)}_getNodeRef(e,t,n){if( __get$(e.refs,t) <=1)return n;let r=n.clone(),i=(e,t)=>{let n=this.associations.get(e);n!=null&&this.associations.set(t,n);for(let _hh$temp1304 of e.children.entries()) {let _hh$temp1305=__arrayFrom$(_hh$temp1304),n=_hh$temp1305[0],r=_hh$temp1305[1];i(r,__get$(t.children,n));} };return i(n,r),r.name+=`_instance_`+ e.uses[t]++,r}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){let r=e( __get$(t,n) );if(r)return r}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let n=[];for(let r=0;r<t.length;r++){let i=e( __get$(t,r) );i&&n.push(i)}return n}getDependency(e,t){let n=e+`:`+t,r=this.cache.get(n);if(!r){switch(e){case`scene`:r=this.loadScene(t);break;case`node`:r=this.loadNode(t);break;case`mesh`:r=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case`accessor`:r=this.loadAccessor(t);break;case`bufferView`:r=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case`buffer`:r=this.loadBuffer(t);break;case`material`:r=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case`texture`:r=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case`skin`:r=this.loadSkin(t);break;case`animation`:r=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case`camera`:r=this.loadCamera(t);break;default:throw Error(`Unknown type: `+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){let n=this,r= __get$(this.json,e+(e===`mesh`?`es`:`s`)) ||[];t=Promise.all(r.map(function(t,r){return n.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){let t= __get$(this.json.buffers,e) ,n=this.fileLoader;if(t.type&&t.type!==`arraybuffer`)throw Error(`THREE.GLTFLoader: `+t.type+` buffer type is not supported.`);if(t.uri===void 0&&e===0)return Promise.resolve( __get$(this.extensions,r2.KHR_BINARY_GLTF) .body);let r=this.options;return new Promise(function(e,i){n.load(tZ.resolveURL(t.uri,r.path),e,void 0,function(){i(Error(`THREE.GLTFLoader: Failed to load buffer "`+t.uri+`".`))})})}loadBufferView(e){let t= __get$(this.json.bufferViews,e) ;return this.getDependency(`buffer`,t.buffer).then(function(e){let n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)})}loadAccessor(e){let t=this,n=this.json,r= __get$(this.json.accessors,e) ;if(r.bufferView===void 0&&r.sparse===void 0)return Promise.resolve(null);let i=[];return r.bufferView===void 0?i.push(null):i.push(this.getDependency(`bufferView`,r.bufferView)),r.sparse!==void 0&&(i.push(this.getDependency(`bufferView`,r.sparse.indices.bufferView)),i.push(this.getDependency(`bufferView`,r.sparse.values.bufferView))),Promise.all(i).then(function(e){let i=e[0],a= __get$(M2,r.type) ,o= __get$(k2,r.componentType) ,s=o.BYTES_PER_ELEMENT,c=s*a,l=r.byteOffset||0,u=r.bufferView===void 0?void 0: __get$(n.bufferViews,r.bufferView) .byteStride,d=r.normalized===!0,f,p;if(u&&u!==c){let e=Math.floor(l/u),n=`InterleavedBuffer:`+r.bufferView+`:`+r.componentType+`:`+e+`:`+r.count,c=t.cache.get(n);c||(f=new o(i,e*u,r.count*u/s),c=new tJ(f,u/s),t.cache.add(n,c)),p=new rJ(c,a,l%u/s,d)}else f=i===null?new o(r.count*a):new o(i,l,r.count*a),p=new oK(f,a,d);if(r.sparse!==void 0){let t=M2.SCALAR,n= __get$(k2,r.sparse.indices.componentType) ,s=r.sparse.indices.byteOffset||0,c=r.sparse.values.byteOffset||0,l=new n(e[1],s,r.sparse.count*t),u=new o(e[2],c,r.sparse.count*a);i!==null&&(p=new oK(p.array.slice(),p.itemSize,p.normalized));for(let e=0,t=l.length;e<t;e++){let t= __get$(l,e) ;if(p.setX(t, __get$(u,e*a) ),a>=2&&p.setY(t, __get$(u,e*a+1) ),a>=3&&p.setZ(t, __get$(u,e*a+2) ),a>=4&&p.setW(t, __get$(u,e*a+3) ),a>=5)throw Error(`THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.`)}}return p})}loadTexture(e){let t=this.json,n=this.options,r= __get$(t.textures,e) .source,i= __get$(t.images,r) ,a=this.textureLoader;if(i.uri){let e=n.manager.getHandler(i.uri);e!==null&&(a=e)}return this.loadTextureImage(e,r,a)}loadTextureImage(e,t,n){let r=this,i=this.json,a= __get$(i.textures,e) ,o= __get$(i.images,t) ,s=(o.uri||o.bufferView)+`:`+a.sampler;if( __get$(this.textureCache,s) )return  __get$(this.textureCache,s) ;let c=this.loadImageSource(t,n).then(function(t){t.flipY=!1,a.name&&(t.name=a.name);let n= __get$(i.samplers||{},a.sampler) ||{};return t.magFilter= __get$(A2,n.magFilter) ||1006,t.minFilter= __get$(A2,n.minFilter) ||1008,t.wrapS= __get$(j2,n.wrapS) ||1e3,t.wrapT= __get$(j2,n.wrapT) ||1e3,r.associations.set(t,{textures:e}),t}).catch(function(){return null});return  __set$(this.textureCache,s,c) ,c}loadImageSource(e,t){let n=this,r=this.json,i=this.options;if( __get$(this.sourceCache,e) !==void 0)return  __get$(this.sourceCache,e) .then(e=>e.clone());let a= __get$(r.images,e) ,o=self.URL||self.webkitURL,s=a.uri||``,c=!1;if(a.bufferView!==void 0)s=n.getDependency(`bufferView`,a.bufferView).then(function(e){c=!0;let t=new Blob([e],{type:a.mimeType});return s=o.createObjectURL(t),s});else if(a.uri===void 0)throw Error(`THREE.GLTFLoader: Image `+e+` is missing URI and bufferView`);let l=Promise.resolve(s).then(function(e){return new Promise(function(n,r){let a=n;t.isImageBitmapLoader===!0&&(a=function(e){let t=new PW(e);t.needsUpdate=!0,n(t)}),t.load(tZ.resolveURL(e,i.path),a,void 0,r)})}).then(function(e){return c===!0&&o.revokeObjectURL(s),e.userData.mimeType=a.mimeType||_0(a.uri),e}).catch(function(e){throw console.error(`THREE.GLTFLoader: Couldn't load texture`,s),e});return  __set$(this.sourceCache,e,l) ,l}assignTexture(e,t,n,r){let i=this;return this.getDependency(`texture`,n.index).then(function(a){if(n.texCoord!==void 0&&n.texCoord!=0&&!(t===`aoMap`&&n.texCoord==1)&&console.warn(`THREE.GLTFLoader: Custom UV set `+n.texCoord+` for texture `+t+` not yet supported.`), __get$(i.extensions,r2.KHR_TEXTURE_TRANSFORM) ){let e=n.extensions===void 0?void 0: __get$(n.extensions,r2.KHR_TEXTURE_TRANSFORM) ;if(e){let t=i.associations.get(a);a= __get$(i.extensions,r2.KHR_TEXTURE_TRANSFORM) .extendTexture(a,e),i.associations.set(a,t)}}return r!==void 0&&(a.encoding=r), __set$(e,t,a) ,a})}assignFinalMaterial(e){let t=e.geometry,n=e.material,r=t.attributes.tangent===void 0,i=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){let e=`PointsMaterial:`+n.uuid,t=this.cache.get(e);t||(t=new XJ,nK.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){let e=`LineBasicMaterial:`+n.uuid,t=this.cache.get(e);t||(t=new zJ,nK.prototype.copy.call(t,n),t.color.copy(n.color),this.cache.add(e,t)),n=t}if(r||i||a){let e=`ClonedMaterial:`+n.uuid+`:`;n.isGLTFSpecularGlossinessMaterial&&(e+=`specular-glossiness:`),r&&(e+=`derivative-tangents:`),i&&(e+=`vertex-colors:`),a&&(e+=`flat-shading:`);let t=this.cache.get(e);t||(t=n.clone(),i&&(t.vertexColors=!0),a&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}n.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute(`uv2`,t.attributes.uv),e.material=n}getMaterialType(){return eX}loadMaterial(e){let t=this,n=this.json,r=this.extensions,i= __get$(n.materials,e) ,a,o={},s=i.extensions||{},c=[];if( __get$(s,r2.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS) ){let e= __get$(r,r2.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS) ;a=e.getMaterialType(),c.push(e.extendParams(o,i,t))}else if( __get$(s,r2.KHR_MATERIALS_UNLIT) ){let e= __get$(r,r2.KHR_MATERIALS_UNLIT) ;a=e.getMaterialType(),c.push(e.extendParams(o,i,t))}else{let n=i.pbrMetallicRoughness||{};if(o.color=new kW(1,1,1),o.opacity=1,Array.isArray(n.baseColorFactor)){let e=n.baseColorFactor;o.color.fromArray(e),o.opacity=e[3]}n.baseColorTexture!==void 0&&c.push(t.assignTexture(o,`map`,n.baseColorTexture,PU)),o.metalness=n.metallicFactor===void 0?1:n.metallicFactor,o.roughness=n.roughnessFactor===void 0?1:n.roughnessFactor,n.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(o,`metalnessMap`,n.metallicRoughnessTexture)),c.push(t.assignTexture(o,`roughnessMap`,n.metallicRoughnessTexture))),a=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)})))}i.doubleSided===!0&&(o.side=2);let l=i.alphaMode||I2.OPAQUE;if(l===I2.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,l===I2.MASK&&(o.alphaTest=i.alphaCutoff===void 0?.5:i.alphaCutoff)),i.normalTexture!==void 0&&a!==rK&&(c.push(t.assignTexture(o,`normalMap`,i.normalTexture)),o.normalScale=new Z(1,1),i.normalTexture.scale!==void 0)){let e=i.normalTexture.scale;o.normalScale.set(e,e)}return i.occlusionTexture!==void 0&&a!==rK&&(c.push(t.assignTexture(o,`aoMap`,i.occlusionTexture)),i.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=i.occlusionTexture.strength)),i.emissiveFactor!==void 0&&a!==rK&&(o.emissive=new kW().fromArray(i.emissiveFactor)),i.emissiveTexture!==void 0&&a!==rK&&c.push(t.assignTexture(o,`emissiveMap`,i.emissiveTexture,PU)),Promise.all(c).then(function(){let n;return n=a===S2? __get$(r,r2.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS) .createMaterial(o):new a(o),i.name&&(n.name=i.name),d0(n,i),t.associations.set(n,{materials:e}),i.extensions&&u0(r,n,i),n})}createUniqueName(e){let t=UZ.sanitizeNodeName(e||``),n=t;for(let e=1; __get$(this.nodeNamesUsed,n) ;++e)n=t+`_`+e;return  __set$(this.nodeNamesUsed,n,!0) ,n}loadGeometries(e){let t=this,n=this.extensions,r=this.primitiveCache;function i(e){return  __get$(n,r2.KHR_DRACO_MESH_COMPRESSION) .decodePrimitive(e,t).then(function(n){return b0(n,e,t)})}let a=[];for(let n=0,o=e.length;n<o;n++){let o= __get$(e,n) ,s=m0(o),c= __get$(r,s) ;if(c)a.push(c.promise);else{let e;e=o.extensions&& __get$(o.extensions,r2.KHR_DRACO_MESH_COMPRESSION) ?i(o):b0(new wK,o,t), __set$(r,s,{primitive:o,promise:e}) ,a.push(e)}}return Promise.all(a)}loadMesh(e){let t=this,n=this.json,r=this.extensions,i= __get$(n.meshes,e) ,a=i.primitives,o=[];for(let e=0,t=a.length;e<t;e++){let t= __get$(a,e) .material===void 0?l0(this.cache):this.getDependency(`material`, __get$(a,e) .material);o.push(t)}return o.push(t.loadGeometries(a)),Promise.all(o).then(function(n){let o=n.slice(0,n.length-1),s= __get$(n,n.length-1) ,c=[];for(let n=0,l=s.length;n<l;n++){let l= __get$(s,n) ,u= __get$(a,n) ,d,f= __get$(o,n) ;if(u.mode===O2.TRIANGLES||u.mode===O2.TRIANGLE_STRIP||u.mode===O2.TRIANGLE_FAN||u.mode===void 0)d=i.isSkinnedMesh===!0?new DJ(l,f):new HK(l,f),d.isSkinnedMesh===!0&&!d.geometry.attributes.skinWeight.normalized&&d.normalizeSkinWeights(),u.mode===O2.TRIANGLE_STRIP?d.geometry=x0(d.geometry,1):u.mode===O2.TRIANGLE_FAN&&(d.geometry=x0(d.geometry,2));else if(u.mode===O2.LINES)d=new JJ(l,f);else if(u.mode===O2.LINE_STRIP)d=new GJ(l,f);else if(u.mode===O2.LINE_LOOP)d=new YJ(l,f);else if(u.mode===O2.POINTS)d=new tY(l,f);else throw Error(`THREE.GLTFLoader: Primitive mode unsupported: `+u.mode);Object.keys(d.geometry.morphAttributes).length>0&&p0(d,i),d.name=t.createUniqueName(i.name||`mesh_`+e),d0(d,i),u.extensions&&u0(r,d,u),t.assignFinalMaterial(d),c.push(d)}for(let n=0,r=c.length;n<r;n++)t.associations.set( __get$(c,n) ,{meshes:e,primitives:n});if(c.length===1)return c[0];let l=new Kq;t.associations.set(l,{meshes:e});for(let e=0,t=c.length;e<t;e++)l.add( __get$(c,e) );return l})}loadCamera(e){let t,n= __get$(this.json.cameras,e) ,r= __get$(n,n.type) ;if(!r){console.warn(`THREE.GLTFLoader: Missing camera parameters.`);return}return n.type===`perspective`?t=new YK(bW.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type===`orthographic`&&(t=new fq(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),d0(t,n),Promise.resolve(t)}loadSkin(e){let t= __get$(this.json.skins,e) ,n={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(n):this.getDependency(`accessor`,t.inverseBindMatrices).then(function(e){return n.inverseBindMatrices=e,n})}loadAnimation(e){let t= __get$(this.json.animations,e) ,n=[],r=[],i=[],a=[],o=[];for(let e=0,s=t.channels.length;e<s;e++){let s= __get$(t.channels,e) ,c= __get$(t.samplers,s.sampler) ,l=s.target,u=l.node===void 0?l.id:l.node,d=t.parameters===void 0?c.input: __get$(t.parameters,c.input) ,f=t.parameters===void 0?c.output: __get$(t.parameters,c.output) ;n.push(this.getDependency(`node`,u)),r.push(this.getDependency(`accessor`,d)),i.push(this.getDependency(`accessor`,f)),a.push(c),o.push(l)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(o)]).then(function(n){let r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],c=[];for(let e=0,t=r.length;e<t;e++){let t= __get$(r,e) ,n= __get$(i,e) ,l= __get$(a,e) ,u= __get$(o,e) ,d= __get$(s,e) ;if(t===void 0)continue;t.updateMatrix(),t.matrixAutoUpdate=!0;let f;switch( __get$(P2,d.path) ){case P2.weights:f=_X;break;case P2.rotation:f=yX;break;case P2.position:case P2.scale:default:f=xX;break}let p=t.name?t.name:t.uuid,m=u.interpolation===void 0?TU: __get$(F2,u.interpolation) ,h=[]; __get$(P2,d.path) ===P2.weights?t.traverse(function(e){e.morphTargetInfluences&&h.push(e.name?e.name:e.uuid)}):h.push(p);let g=l.array;if(l.normalized){let e=g0(g.constructor),t=new Float32Array(g.length);for(let n=0,r=g.length;n<r;n++) __set$(t,n,__get$(g,n)*e) ;g=t}for(let e=0,t=h.length;e<t;e++){let t= new f(__get$(h,e)+`.`+__get$(P2,d.path),n.array,g,m) ;u.interpolation===`CUBICSPLINE`&&(t.createInterpolant=function(e){return new(this instanceof yX?D2:T2)(this.times,this.values,this.getValueSize()/3,e)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(t)}}return new SX(t.name?t.name:`animation_`+e,void 0,c)})}createNodeMesh(e){let t=this.json,n=this,r= __get$(t.nodes,e) ;return r.mesh===void 0?null:n.getDependency(`mesh`,r.mesh).then(function(e){let t=n._getNodeRef(n.meshCache,r.mesh,e);return r.weights!==void 0&&t.traverse(function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++) __set$(e.morphTargetInfluences,t,__get$(r.weights,t)) }),t})}loadNode(e){let t=this.json,n=this.extensions,r=this,i= __get$(t.nodes,e) ,a=i.name?r.createUniqueName(i.name):``;return function(){let t=[],n=r._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return n&&t.push(n),i.camera!==void 0&&t.push(r.getDependency(`camera`,i.camera).then(function(e){return r._getNodeRef(r.cameraCache,i.camera,e)})),r._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){t.push(e)}),Promise.all(t)}().then(function(t){let o;if(o=i.isBone===!0?new OJ:t.length>1?new Kq:t.length===1?t[0]:new UG,o!==t[0])for(let e=0,n=t.length;e<n;e++)o.add( __get$(t,e) );if(i.name&&(o.userData.name=i.name,o.name=a),d0(o,i),i.extensions&&u0(n,o,i),i.matrix!==void 0){let e=new vG;e.fromArray(i.matrix),o.applyMatrix4(e)}else i.translation!==void 0&&o.position.fromArray(i.translation),i.rotation!==void 0&&o.quaternion.fromArray(i.rotation),i.scale!==void 0&&o.scale.fromArray(i.scale);return r.associations.has(o)||r.associations.set(o,{}),r.associations.get(o).nodes=e,o})}loadScene(e){let t=this.json,n=this.extensions,r= __get$(this.json.scenes,e) ,i=this,a=new Kq;r.name&&(a.name=i.createUniqueName(r.name)),d0(a,r),r.extensions&&u0(n,a,r);let o=r.nodes||[],s=[];for(let e=0,n=o.length;e<n;e++)s.push(v0( __get$(o,e) ,a,t,i));return Promise.all(s).then(function(){return i.associations=(e=>{let t=new Map;for(let _hh$temp1306 of i.associations) {let _hh$temp1307=__arrayFrom$(_hh$temp1306),e=_hh$temp1307[0],n=_hh$temp1307[1];(e instanceof nK||e instanceof PW)&&t.set(e,n);} return e.traverse(e=>{let n=i.associations.get(e);n!=null&&t.set(e,n)}),t})(a),a})}}}));function z2(e,t){if(!(e instanceof t))throw TypeError(`Cannot call a class as a function`)}function B2(e,t){for(var n=0;n<t.length;n++){var r= __get$(t,n) ;r.enumerable=r.enumerable||!1,r.configurable=!0,`value`in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V2(e,t,n){return t&&B2(e.prototype,t),n&&B2(e,n),e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}var H2=`1.5.1`;function U2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function W2(e){for(var t=1;t<arguments.length;t++){var n= __get$(arguments,t) ==null?{}: __get$(arguments,t) ;t%2?U2(Object(n),!0).forEach(function(t){$(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U2(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function G2(e,t){switch(e){case K2.TRANSPORT_NOT_SUPPORTED:return W2({code:K2.TRANSPORT_NOT_SUPPORTED,message:`transport not supported`},t);case K2.MALFORMED_URL:return W2({code:K2.MALFORMED_URL,message:`malformed url`},t);case K2.UNAUTHENTICATED:return W2({code:K2.UNAUTHENTICATED,message:`unauthenticated`},t)}}var K2;(function(e){ __set$(e,e.TRANSPORT_NOT_SUPPORTED=1,`TRANSPORT_NOT_SUPPORTED`) , __set$(e,e.MALFORMED_URL=2,`MALFORMED_URL`) , __set$(e,e.UNAUTHENTICATED=3,`UNAUTHENTICATED`) })(K2||={});function q2(e){if(Array.isArray(e))return e}function J2(e,t){var n=e==null?null:typeof Symbol<`u`&& __get$(e,Symbol.iterator) || __get$(e,`@@iterator`) ;if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(e){a=!0,s=e}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function Y2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}function X2(e,t){if(e){if(typeof e==`string`)return Y2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`)return Array.from(e);if(n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y2(e,t)}}function Z2(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q2(e,t){return q2(e)||J2(e,t)||X2(e,t)||Z2()}var $2;(function(e){e.WEB_SOCKETS_NOT_SUPPORTED=`web_socket_not_supported`,e.WEB_SOCKET_ERROR=`web_socket_error`,e.CLIENT_OFFLINE=`client_offline`,e.WELCOME_TIMEOUT=`welcome_timeout`,e.WELCOME_EXPECTED=`welcome_expected`,e.WELCOME_INCONSISTENT=`welcome_inconsitent`,e.CORRUPTED_PACKET=`corrupted_packet`,e.CORRUPTED_OFFSET=`corrupted_offset`,e.CONNECTION_ERROR=`connection_error`,e.CONNECTION_CLOSED=`connection_closed`,e.KEEPALIVE_TIMEOUT=`keepalive_timeout`,e.CHANNEL_FAILURE=`channel_failure`,e.REGISTER_TIMEOUT=`register_timeout`,e.SUBSCRIBE_TIMEOUT=`subscribe_timeout`,e.UNSUBSCRIBE_TIMEOUT=`unsubscribe_timeout`})($2||={});function e4(e){return e===$2.WELCOME_EXPECTED||e===$2.WELCOME_INCONSISTENT||e===$2.CORRUPTED_OFFSET||e===$2.CORRUPTED_PACKET}var t4;(function(e){e.SUBSCRIBE=`1`,e.UNSUBSCRIBE=`2`,e.ACK=`3`,e.SUBSCRIBED=`5`,e.UNSUBSCRIBED=`6`,e.MESSAGE=`7`,e.POSITION=`8`})(t4||={});var n4;(function(e){e.OPEN=`0`,e.CLOSE=`1`,e.PING=`2`,e.PONG=`3`,e.MESSAGE=`4`,e.PRESENCE=`5`})(n4||={});var r4;(function(e){e.REGISTER=`1`,e.REGISTERED=`2`})(r4||={});var i4;(function(e){ __set$(e,e.OFFLINE=0,`OFFLINE`) , __set$(e,e.POOR=1,`POOR`) , __set$(e,e.OK=2,`OK`) , __set$(e,e.GOOD=3,`GOOD`) , __set$(e,e.EXCELLENT=4,`EXCELLENT`) })(i4||={});var a4=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},o4={exports:{}};(function(e,t){(function(t,n){e.exports=n(t)})(typeof self<`u`?self:typeof window<`u`?window:a4,function(t){t||={};var n=t.Base64,r=`2.6.4`,i=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`,a=function(e){for(var t={},n=0,r=e.length;n<r;n++) __set$(t,e.charAt(n),n) ;return t}(i),o=String.fromCharCode,s=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?o(192|t>>>6)+o(128|t&63):o(224|t>>>12&15)+o(128|t>>>6&63)+o(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return o(240|t>>>18&7)+o(128|t>>>12&63)+o(128|t>>>6&63)+o(128|t&63)}},c=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,l=function(e){return  __call$(e,"replace",[c,s]) },u=function(e){var t= __get$([0,2,1],e.length%3) ,n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[i.charAt(n>>>18),i.charAt(n>>>12&63),t>=2?`=`:i.charAt(n>>>6&63),t>=1?`=`:i.charAt(n&63)].join(``)},d=t.btoa&&typeof t.btoa==`function`?function(e){return t.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw RangeError(`The string contains invalid characters.`);return  __call$(e,"replace",[/[\s\S]{1,3}/g,u]) },f=function(e){return d(l(String(e)))},p=function(e){return  __call$(__call$(e,"replace",[/[+\/]/g,function(e){return e==`+`?`-`:`_`;}]),"replace",[/=/g,``]) },m=function(e,t){return t?p(f(e)):f(e)},h=function(e){return m(e,!0)},g;t.Uint8Array&&(g=function(e,t){for(var n=``,r=0,a=e.length;r<a;r+=3){var o= __get$(e,r) ,s= __get$(e,r+1) ,c= __get$(e,r+2) ,l=o<<16|s<<8|c;n+=i.charAt(l>>>18)+i.charAt(l>>>12&63)+(s===void 0?`=`:i.charAt(l>>>6&63))+(c===void 0?`=`:i.charAt(l&63))}return t?p(n):n});var _=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,v=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return o((t>>>10)+55296)+o((t&1023)+56320);case 3:return o((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return o((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},y=function(e){return  __call$(e,"replace",[_,v]) },b=function(e){var t=e.length,n=t%4,r=(t>0? __get$(a,e.charAt(0)) <<18:0)|(t>1? __get$(a,e.charAt(1)) <<12:0)|(t>2? __get$(a,e.charAt(2)) <<6:0)|(t>3? __get$(a,e.charAt(3)) :0),i=[o(r>>>16),o(r>>>8&255),o(r&255)];return i.length-= __get$([0,0,2,1],n) ,i.join(``)},x=t.atob&&typeof t.atob==`function`?function(e){return t.atob(e)}:function(e){return  __call$(e,"replace",[/\S{1,4}/g,b]) },S=function(e){return x( __call$(String(e),"replace",[/[^A-Za-z0-9\+\/]/g,``]) )},C=function(e){return y(x(e))},w=function(e){return  __call$(__call$(String(e),"replace",[/[-_]/g,function(e){return e==`-`?`+`:`/`;}]),"replace",[/[^A-Za-z0-9\+\/]/g,``]) },T=function(e){return C(w(e))},E;if(t.Uint8Array&&(E=function(e){return Uint8Array.from(S(w(e)),function(e){return e.charCodeAt(0)})}),t.Base64={VERSION:r,atob:S,btoa:d,fromBase64:T,toBase64:m,utob:l,encode:m,encodeURI:h,btou:y,decode:T,noConflict:function(){var e=t.Base64;return t.Base64=n,e},fromUint8Array:g,toUint8Array:E},typeof Object.defineProperty==`function`){var D=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,`fromBase64`,D(function(){return T(this)})),Object.defineProperty(String.prototype,`toBase64`,D(function(e){return m(this,e)})),Object.defineProperty(String.prototype,`toBase64URI`,D(function(){return m(this,!0)}))}}return t.Meteor&&(Base64=t.Base64),e.exports&&(e.exports.Base64=t.Base64),{Base64:t.Base64}})})(o4);function s4(e){"@babel/helpers - typeof";return s4=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e},s4(e)}var c4={};(function(e){var t=typeof Uint8Array<`u`&&typeof Uint16Array<`u`&&typeof Int32Array<`u`;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if(s4(r)!==`object`)throw TypeError(r+`must be non-object`);for(var i in r)n(r,i)&&( __set$(e,i,__get$(r,i)) )}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray){e.set(t.subarray(n,n+r),i);return}for(var a=0;a<r;a++) __set$(e,i+a,__get$(t,n+a)) },flattenChunks:function(e){var t,n,r=0,i,a,o;for(t=0,n=e.length;t<n;t++)r+= __get$(e,t) .length;for(o=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)a= __get$(e,t) ,o.set(a,i),i+=a.length;return o}},i={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++) __set$(e,i+a,__get$(t,n+a)) },flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array, __call$(e,"assign",[e,r]) ):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array, __call$(e,"assign",[e,i]) )},e.setTyped(t)})(c4);var l4={},u4={},d4={},f4=c4,p4=4,m4=0,h4=1,g4=2;function _4(e){for(var t=e.length;--t>=0;) __set$(e,t,0) }var v4=0,y4=1,b4=2,x4=3,S4=258,C4=29,w4=256,T4=w4+1+C4,E4=30,D4=19,O4=2*T4+1,k4=15,A4=16,j4=7,M4=256,N4=16,P4=17,F4=18,I4=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],L4=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R4=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z4=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],B4=512,V4=Array((T4+2)*2);_4(V4);var H4=Array(E4*2);_4(H4);var U4=Array(B4);_4(U4);var W4=Array(S4-x4+1);_4(W4);var G4=Array(C4);_4(G4);var K4=Array(E4);_4(K4);function q4(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}var J4,Y4,X4;function Z4(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function Q4(e){return e<256? __get$(U4,e) : __get$(U4,256+(e>>>7)) }function $4(e,t){ __set$(e.pending_buf,e.pending++,t&255) , __set$(e.pending_buf,e.pending++,t>>>8&255) }function e3(e,t,n){e.bi_valid>A4-n?(e.bi_buf|=t<<e.bi_valid&65535,$4(e,e.bi_buf),e.bi_buf=t>>A4-e.bi_valid,e.bi_valid+=n-A4):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function t3(e,t,n){e3(e, __get$(n,t*2) , __get$(n,t*2+1) )}function n3(e,t){var n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1}function r3(e){e.bi_valid===16?($4(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&( __set$(e.pending_buf,e.pending++,e.bi_buf&255) ,e.bi_buf>>=8,e.bi_valid-=8)}function i3(e,t){var n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,c=t.stat_desc.max_length,l,u,d,f,p,m,h=0;for(f=0;f<=k4;f++) __set$(e.bl_count,f,0) ;for( __set$(n,__get$(e.heap,e.heap_max)*2+1,0) ,l=e.heap_max+1;l<O4;l++)u= __get$(e.heap,l) ,f= __get$(n,__get$(n,u*2+1)*2+1) +1,f>c&&(f=c,h++), __set$(n,u*2+1,f) ,!(u>r)&&(e.bl_count[f]++,p=0,u>=s&&(p= __get$(o,u-s) ),m= __get$(n,u*2) ,e.opt_len+=m*(f+p),a&&(e.static_len+=m*( __get$(i,u*2+1) +p)));if(h!==0){do{for(f=c-1; __get$(e.bl_count,f) ===0;)f--;e.bl_count[f]--, __set$(e.bl_count,f+1,__get$(e.bl_count,f+1)+2) ,e.bl_count[c]--,h-=2}while(h>0);for(f=c;f!==0;f--)for(u= __get$(e.bl_count,f) ;u!==0;)d= __get$(e.heap,--l) ,!(d>r)&&( __get$(n,d*2+1) !==f&&(e.opt_len+=(f- __get$(n,d*2+1) )* __get$(n,d*2) , __set$(n,d*2+1,f) ),u--)}}function a3(e,t,n){var r=Array(k4+1),i=0,a,o;for(a=1;a<=k4;a++) __set$(r,a,i=i+__get$(n,a-1)<<1) ;for(o=0;o<=t;o++){var s= __get$(e,o*2+1) ;s!==0&&( __set$(e,o*2,n3(r[s]++,s)) )}}function o3(){var e,t,n,r,i,a=Array(k4+1);for(n=0,r=0;r<C4-1;r++)for( __set$(G4,r,n) ,e=0;e<1<< __get$(I4,r) ;e++) __set$(W4,n++,r) ;for( __set$(W4,n-1,r) ,i=0,r=0;r<16;r++)for( __set$(K4,r,i) ,e=0;e<1<< __get$(L4,r) ;e++) __set$(U4,i++,r) ;for(i>>=7;r<E4;r++)for( __set$(K4,r,i<<7) ,e=0;e<1<< __get$(L4,r) -7;e++) __set$(U4,256+i++,r) ;for(t=0;t<=k4;t++) __set$(a,t,0) ;for(e=0;e<=143;) __set$(V4,e*2+1,8) ,e++,a[8]++;for(;e<=255;) __set$(V4,e*2+1,9) ,e++,a[9]++;for(;e<=279;) __set$(V4,e*2+1,7) ,e++,a[7]++;for(;e<=287;) __set$(V4,e*2+1,8) ,e++,a[8]++;for(a3(V4,T4+1,a),e=0;e<E4;e++) __set$(H4,e*2+1,5) , __set$(H4,e*2,n3(e,5)) ;J4=new q4(V4,I4,w4+1,T4,k4),Y4=new q4(H4,L4,0,E4,k4),X4=new q4([],R4,0,D4,j4)}function s3(e){var t;for(t=0;t<T4;t++) __set$(e.dyn_ltree,t*2,0) ;for(t=0;t<E4;t++) __set$(e.dyn_dtree,t*2,0) ;for(t=0;t<D4;t++) __set$(e.bl_tree,t*2,0) ; __set$(e.dyn_ltree,M4*2,1) ,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function c3(e){e.bi_valid>8?$4(e,e.bi_buf):e.bi_valid>0&&( __set$(e.pending_buf,e.pending++,e.bi_buf) ),e.bi_buf=0,e.bi_valid=0}function l3(e,t,n,r){c3(e),r&&($4(e,n),$4(e,~n)),f4.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function u3(e,t,n,r){var i=t*2,a=n*2;return  __get$(e,i) < __get$(e,a) || __get$(e,i) === __get$(e,a) && __get$(r,t) <= __get$(r,n) }function d3(e,t,n){for(var r= __get$(e.heap,n) ,i=n<<1;i<=e.heap_len&&(i<e.heap_len&&u3(t, __get$(e.heap,i+1) , __get$(e.heap,i) ,e.depth)&&i++,!u3(t,r, __get$(e.heap,i) ,e.depth));) __set$(e.heap,n,__get$(e.heap,i)) ,n=i,i<<=1; __set$(e.heap,n,r) }function f3(e,t,n){var r,i,a=0,o,s;if(e.last_lit!==0)do r= __get$(e.pending_buf,e.d_buf+a*2) <<8| __get$(e.pending_buf,e.d_buf+a*2+1) ,i= __get$(e.pending_buf,e.l_buf+a) ,a++,r===0?t3(e,i,t):(o= __get$(W4,i) ,t3(e,o+w4+1,t),s= __get$(I4,o) ,s!==0&&(i-= __get$(G4,o) ,e3(e,i,s)),r--,o=Q4(r),t3(e,o,n),s= __get$(L4,o) ,s!==0&&(r-= __get$(K4,o) ,e3(e,r,s)));while(a<e.last_lit);t3(e,M4,t)}function p3(e,t){var n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems,o,s,c=-1,l;for(e.heap_len=0,e.heap_max=O4,o=0;o<a;o++) __get$(n,o*2) ===0? __set$(n,o*2+1,0) :( __set$(e.heap,++e.heap_len,c=o) , __set$(e.depth,o,0) );for(;e.heap_len<2;)l= __set$(e.heap,++e.heap_len,c<2?++c:0) , __set$(n,l*2,1) , __set$(e.depth,l,0) ,e.opt_len--,i&&(e.static_len-= __get$(r,l*2+1) );for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)d3(e,n,o);l=a;do o=e.heap[1],e.heap[1]= __get$(e.heap,e.heap_len--) ,d3(e,n,1),s=e.heap[1], __set$(e.heap,--e.heap_max,o) , __set$(e.heap,--e.heap_max,s) , __set$(n,l*2,__get$(n,o*2)+__get$(n,s*2)) , __set$(e.depth,l,(__get$(e.depth,o)>=__get$(e.depth,s)?__get$(e.depth,o):__get$(e.depth,s))+1) , __set$(n,o*2+1,__set$(n,s*2+1,l)) ,e.heap[1]=l++,d3(e,n,1);while(e.heap_len>=2); __set$(e.heap,--e.heap_max,e.heap[1]) ,i3(e,t),a3(n,c,e.bl_count)}function m3(e,t,n){var r,i=-1,a,o=t[1],s=0,c=7,l=4;for(o===0&&(c=138,l=3), __set$(t,(n+1)*2+1,65535) ,r=0;r<=n;r++)a=o,o= __get$(t,(r+1)*2+1) ,!(++s<c&&a===o)&&(s<l? __set$(e.bl_tree,a*2,__get$(e.bl_tree,a*2)+s) :a===0?s<=10?e.bl_tree[P4*2]++:e.bl_tree[F4*2]++:(a!==i&&e.bl_tree[a*2]++,e.bl_tree[N4*2]++),s=0,i=a,o===0?(c=138,l=3):a===o?(c=6,l=3):(c=7,l=4))}function h3(e,t,n){var r,i=-1,a,o=t[1],s=0,c=7,l=4;for(o===0&&(c=138,l=3),r=0;r<=n;r++)if(a=o,o= __get$(t,(r+1)*2+1) ,!(++s<c&&a===o)){if(s<l)do t3(e,a,e.bl_tree);while(--s!==0);else a===0?s<=10?(t3(e,P4,e.bl_tree),e3(e,s-3,3)):(t3(e,F4,e.bl_tree),e3(e,s-11,7)):(a!==i&&(t3(e,a,e.bl_tree),s--),t3(e,N4,e.bl_tree),e3(e,s-3,2));s=0,i=a,o===0?(c=138,l=3):a===o?(c=6,l=3):(c=7,l=4)}}function g3(e){var t;for(m3(e,e.dyn_ltree,e.l_desc.max_code),m3(e,e.dyn_dtree,e.d_desc.max_code),p3(e,e.bl_desc),t=D4-1;t>=3&& __get$(e.bl_tree,__get$(z4,t)*2+1) ===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t}function _3(e,t,n,r){var i;for(e3(e,t-257,5),e3(e,n-1,5),e3(e,r-4,4),i=0;i<r;i++)e3(e, __get$(e.bl_tree,__get$(z4,i)*2+1) ,3);h3(e,e.dyn_ltree,t-1),h3(e,e.dyn_dtree,n-1)}function v3(e){var t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&& __get$(e.dyn_ltree,n*2) !==0)return m4;if(e.dyn_ltree[18]!==0||e.dyn_ltree[20]!==0||e.dyn_ltree[26]!==0)return h4;for(n=32;n<w4;n++)if( __get$(e.dyn_ltree,n*2) !==0)return h4;return m4}var y3=!1;function b3(e){y3||=(o3(),!0),e.l_desc=new Z4(e.dyn_ltree,J4),e.d_desc=new Z4(e.dyn_dtree,Y4),e.bl_desc=new Z4(e.bl_tree,X4),e.bi_buf=0,e.bi_valid=0,s3(e)}function x3(e,t,n,r){e3(e,(v4<<1)+(r?1:0),3),l3(e,t,n,!0)}function S3(e){e3(e,y4<<1,3),t3(e,M4,V4),r3(e)}function C3(e,t,n,r){var i,a,o=0;e.level>0?(e.strm.data_type===g4&&(e.strm.data_type=v3(e)),p3(e,e.l_desc),p3(e,e.d_desc),o=g3(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&t!==-1?x3(e,t,n,r):e.strategy===p4||a===i?(e3(e,(y4<<1)+(r?1:0),3),f3(e,V4,H4)):(e3(e,(b4<<1)+(r?1:0),3),_3(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),f3(e,e.dyn_ltree,e.dyn_dtree)),s3(e),r&&c3(e)}function w3(e,t,n){return  __set$(e.pending_buf,e.d_buf+e.last_lit*2,t>>>8&255) , __set$(e.pending_buf,e.d_buf+e.last_lit*2+1,t&255) , __set$(e.pending_buf,e.l_buf+e.last_lit,n&255) ,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[( __get$(W4,n) +w4+1)*2]++,e.dyn_dtree[Q4(t)*2]++),e.last_lit===e.lit_bufsize-1}d4._tr_init=b3,d4._tr_stored_block=x3,d4._tr_flush_block=C3,d4._tr_tally=w3,d4._tr_align=S3;function T3(e,t,n,r){for(var i=e&65535|0,a=e>>>16&65535|0,o=0;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+ __get$(t,r++) |0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}var E3=T3;function D3(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1; __set$(t,n,e) }return t}var O3=D3();function k3(e,t,n,r){var i=O3,a=r+n;e^=-1;for(var o=r;o<a;o++)e=e>>>8^ __get$(i,(e^__get$(t,o))&255) ;return e^-1}var A3=k3,j3={2:`need dictionary`,1:`stream end`,0:``,"-1":`file error`,"-2":`stream error`,"-3":`data error`,"-4":`insufficient memory`,"-5":`buffer error`,"-6":`incompatible version`},M3=c4,N3=d4,P3=E3,F3=A3,I3=j3,L3=0,R3=1,z3=3,B3=4,V3=5,H3=0,U3=1,W3=-2,G3=-3,K3=-5,q3=-1,J3=1,Y3=2,X3=3,Z3=4,Q3=0,$3=2,e6=8,t6=9,n6=15,r6=8,i6=286,a6=30,o6=19,s6=2*i6+1,c6=15,l6=3,u6=258,d6=u6+l6+1,f6=32,p6=42,m6=69,h6=73,g6=91,_6=103,v6=113,y6=666,b6=1,x6=2,S6=3,C6=4,w6=3;function T6(e,t){return e.msg= __get$(I3,t) ,t}function E6(e){return(e<<1)-(e>4?9:0)}function D6(e){for(var t=e.length;--t>=0;) __set$(e,t,0) }function O6(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(M3.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))}function k6(e,t){N3._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,O6(e.strm)}function A6(e,t){ __set$(e.pending_buf,e.pending++,t) }function j6(e,t){ __set$(e.pending_buf,e.pending++,t>>>8&255) , __set$(e.pending_buf,e.pending++,t&255) }function M6(e,t,n,r){var i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,M3.arraySet(t,e.input,e.next_in,i,n),e.state.wrap===1?e.adler=P3(e.adler,t,i,n):e.state.wrap===2&&(e.adler=F3(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)}function N6(e,t){var n=e.max_chain_length,r=e.strstart,i,a,o=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-d6?e.strstart-(e.w_size-d6):0,l=e.window,u=e.w_mask,d=e.prev,f=e.strstart+u6,p= __get$(l,r+o-1) ,m= __get$(l,r+o) ;e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(i=t, __get$(l,i+o) !==m|| __get$(l,i+o-1) !==p|| __get$(l,i) !== __get$(l,r) || __get$(l,++i) !== __get$(l,r+1) )continue;r+=2,i++;do;while( __get$(l,++r) === __get$(l,++i) && __get$(l,++r) === __get$(l,++i) && __get$(l,++r) === __get$(l,++i) && __get$(l,++r) === __get$(l,++i) && __get$(l,++r) === __get$(l,++i) && __get$(l,++r) === __get$(l,++i) && __get$(l,++r) === __get$(l,++i) && __get$(l,++r) === __get$(l,++i) &&r<f);if(a=u6-(f-r),r=f-u6,a>o){if(e.match_start=t,o=a,a>=s)break;p= __get$(l,r+o-1) ,m= __get$(l,r+o) }}while((t= __get$(d,t&u) )>c&&--n!==0);return o<=e.lookahead?o:e.lookahead}function P6(e){var t=e.w_size,n,r,i,a,o;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-d6)){M3.arraySet(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,n=r;do i= __get$(e.head,--n) , __set$(e.head,n,i>=t?i-t:0) ;while(--r);r=t,n=r;do i= __get$(e.prev,--n) , __set$(e.prev,n,i>=t?i-t:0) ;while(--r);a+=t}if(e.strm.avail_in===0)break;if(r=M6(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=r,e.lookahead+e.insert>=l6)for(o=e.strstart-e.insert,e.ins_h= __get$(e.window,o) ,e.ins_h=(e.ins_h<<e.hash_shift^ __get$(e.window,o+1) )&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^ __get$(e.window,o+l6-1) )&e.hash_mask, __set$(e.prev,o&e.w_mask,__get$(e.head,e.ins_h)) , __set$(e.head,e.ins_h,o) ,o++,e.insert--,!(e.lookahead+e.insert<l6)););}while(e.lookahead<d6&&e.strm.avail_in!==0)}function F6(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(P6(e),e.lookahead===0&&t===L3)return b6;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((e.strstart===0||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,k6(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-d6&&(k6(e,!1),e.strm.avail_out===0))return b6}return e.insert=0,t===B3?(k6(e,!0),e.strm.avail_out===0?S6:C6):(e.strstart>e.block_start&&(k6(e,!1),e.strm.avail_out),b6)}function I6(e,t){for(var n,r;;){if(e.lookahead<d6){if(P6(e),e.lookahead<d6&&t===L3)return b6;if(e.lookahead===0)break}if(n=0,e.lookahead>=l6&&(e.ins_h=(e.ins_h<<e.hash_shift^ __get$(e.window,e.strstart+l6-1) )&e.hash_mask,n= __set$(e.prev,e.strstart&e.w_mask,__get$(e.head,e.ins_h)) , __set$(e.head,e.ins_h,e.strstart) ),n!==0&&e.strstart-n<=e.w_size-d6&&(e.match_length=N6(e,n)),e.match_length>=l6)if(r=N3._tr_tally(e,e.strstart-e.match_start,e.match_length-l6),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=l6){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^ __get$(e.window,e.strstart+l6-1) )&e.hash_mask,n= __set$(e.prev,e.strstart&e.w_mask,__get$(e.head,e.ins_h)) , __set$(e.head,e.ins_h,e.strstart) ;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h= __get$(e.window,e.strstart) ,e.ins_h=(e.ins_h<<e.hash_shift^ __get$(e.window,e.strstart+1) )&e.hash_mask;else r=N3._tr_tally(e,0, __get$(e.window,e.strstart) ),e.lookahead--,e.strstart++;if(r&&(k6(e,!1),e.strm.avail_out===0))return b6}return e.insert=e.strstart<l6-1?e.strstart:l6-1,t===B3?(k6(e,!0),e.strm.avail_out===0?S6:C6):e.last_lit&&(k6(e,!1),e.strm.avail_out===0)?b6:x6}function L6(e,t){for(var n,r,i;;){if(e.lookahead<d6){if(P6(e),e.lookahead<d6&&t===L3)return b6;if(e.lookahead===0)break}if(n=0,e.lookahead>=l6&&(e.ins_h=(e.ins_h<<e.hash_shift^ __get$(e.window,e.strstart+l6-1) )&e.hash_mask,n= __set$(e.prev,e.strstart&e.w_mask,__get$(e.head,e.ins_h)) , __set$(e.head,e.ins_h,e.strstart) ),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=l6-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-d6&&(e.match_length=N6(e,n),e.match_length<=5&&(e.strategy===J3||e.match_length===l6&&e.strstart-e.match_start>4096)&&(e.match_length=l6-1)),e.prev_length>=l6&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-l6,r=N3._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-l6),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^ __get$(e.window,e.strstart+l6-1) )&e.hash_mask,n= __set$(e.prev,e.strstart&e.w_mask,__get$(e.head,e.ins_h)) , __set$(e.head,e.ins_h,e.strstart) );while(--e.prev_length!==0);if(e.match_available=0,e.match_length=l6-1,e.strstart++,r&&(k6(e,!1),e.strm.avail_out===0))return b6}else if(e.match_available){if(r=N3._tr_tally(e,0, __get$(e.window,e.strstart-1) ),r&&k6(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return b6}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&=(r=N3._tr_tally(e,0, __get$(e.window,e.strstart-1) ),0),e.insert=e.strstart<l6-1?e.strstart:l6-1,t===B3?(k6(e,!0),e.strm.avail_out===0?S6:C6):e.last_lit&&(k6(e,!1),e.strm.avail_out===0)?b6:x6}function R6(e,t){for(var n,r,i,a,o=e.window;;){if(e.lookahead<=u6){if(P6(e),e.lookahead<=u6&&t===L3)return b6;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=l6&&e.strstart>0&&(i=e.strstart-1,r= __get$(o,i) ,r=== __get$(o,++i) &&r=== __get$(o,++i) &&r=== __get$(o,++i) )){a=e.strstart+u6;do;while(r=== __get$(o,++i) &&r=== __get$(o,++i) &&r=== __get$(o,++i) &&r=== __get$(o,++i) &&r=== __get$(o,++i) &&r=== __get$(o,++i) &&r=== __get$(o,++i) &&r=== __get$(o,++i) &&i<a);e.match_length=u6-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=l6?(n=N3._tr_tally(e,1,e.match_length-l6),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=N3._tr_tally(e,0, __get$(e.window,e.strstart) ),e.lookahead--,e.strstart++),n&&(k6(e,!1),e.strm.avail_out===0))return b6}return e.insert=0,t===B3?(k6(e,!0),e.strm.avail_out===0?S6:C6):e.last_lit&&(k6(e,!1),e.strm.avail_out===0)?b6:x6}function z6(e,t){for(var n;;){if(e.lookahead===0&&(P6(e),e.lookahead===0)){if(t===L3)return b6;break}if(e.match_length=0,n=N3._tr_tally(e,0, __get$(e.window,e.strstart) ),e.lookahead--,e.strstart++,n&&(k6(e,!1),e.strm.avail_out===0))return b6}return e.insert=0,t===B3?(k6(e,!0),e.strm.avail_out===0?S6:C6):e.last_lit&&(k6(e,!1),e.strm.avail_out===0)?b6:x6}function B6(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}var V6=[new B6(0,0,0,0,F6),new B6(4,4,8,4,I6),new B6(4,5,16,8,I6),new B6(4,6,32,32,I6),new B6(4,4,16,16,L6),new B6(8,16,32,32,L6),new B6(8,16,128,128,L6),new B6(8,32,128,256,L6),new B6(32,128,258,1024,L6),new B6(32,258,258,4096,L6)];function H6(e){e.window_size=2*e.w_size,D6(e.head),e.max_lazy_match= __get$(V6,e.level) .max_lazy,e.good_match= __get$(V6,e.level) .good_length,e.nice_match= __get$(V6,e.level) .nice_length,e.max_chain_length= __get$(V6,e.level) .max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=l6-1,e.match_available=0,e.ins_h=0}function U6(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=e6,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new M3.Buf16(s6*2),this.dyn_dtree=new M3.Buf16((2*a6+1)*2),this.bl_tree=new M3.Buf16((2*o6+1)*2),D6(this.dyn_ltree),D6(this.dyn_dtree),D6(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new M3.Buf16(c6+1),this.heap=new M3.Buf16(2*i6+1),D6(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new M3.Buf16(2*i6+1),D6(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function W6(e){var t;return!e||!e.state?T6(e,W3):(e.total_in=e.total_out=0,e.data_type=$3,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?p6:v6,e.adler=t.wrap===2?0:1,t.last_flush=L3,N3._tr_init(t),H3)}function G6(e){var t=W6(e);return t===H3&&H6(e.state),t}function K6(e,t){return!e||!e.state||e.state.wrap!==2?W3:(e.state.gzhead=t,H3)}function q6(e,t,n,r,i,a){if(!e)return W3;var o=1;if(t===q3&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>t6||n!==e6||r<8||r>15||t<0||t>9||a<0||a>Z3)return T6(e,W3);r===8&&(r=9);var s=new U6;return e.state=s,s.strm=e,s.wrap=o,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+l6-1)/l6),s.window=new M3.Buf8(s.w_size*2),s.head=new M3.Buf16(s.hash_size),s.prev=new M3.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new M3.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=a,s.method=n,G6(e)}function J6(e,t){return q6(e,t,e6,n6,r6,Q3)}function Y6(e,t){var n,r,i,a;if(!e||!e.state||t>V3||t<0)return e?T6(e,W3):W3;if(r=e.state,!e.output||!e.input&&e.avail_in!==0||r.status===y6&&t!==B3)return T6(e,e.avail_out===0?K3:W3);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===p6)if(r.wrap===2)e.adler=0,A6(r,31),A6(r,139),A6(r,8),r.gzhead?(A6(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),A6(r,r.gzhead.time&255),A6(r,r.gzhead.time>>8&255),A6(r,r.gzhead.time>>16&255),A6(r,r.gzhead.time>>24&255),A6(r,r.level===9?2:r.strategy>=Y3||r.level<2?4:0),A6(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(A6(r,r.gzhead.extra.length&255),A6(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=F3(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=m6):(A6(r,0),A6(r,0),A6(r,0),A6(r,0),A6(r,0),A6(r,r.level===9?2:r.strategy>=Y3||r.level<2?4:0),A6(r,w6),r.status=v6);else{var o=e6+(r.w_bits-8<<4)<<8,s=-1;s=r.strategy>=Y3||r.level<2?0:r.level<6?1:r.level===6?2:3,o|=s<<6,r.strstart!==0&&(o|=f6),o+=31-o%31,r.status=v6,j6(r,o),r.strstart!==0&&(j6(r,e.adler>>>16),j6(r,e.adler&65535)),e.adler=1}if(r.status===m6)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(r.gzhead.extra.length&65535)&&!(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=F3(e.adler,r.pending_buf,r.pending-i,i)),O6(e),i=r.pending,r.pending===r.pending_buf_size));)A6(r, __get$(r.gzhead.extra,r.gzindex) &255),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(e.adler=F3(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=h6)}else r.status=h6;if(r.status===h6)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=F3(e.adler,r.pending_buf,r.pending-i,i)),O6(e),i=r.pending,r.pending===r.pending_buf_size)){a=1;break}a=r.gzindex<r.gzhead.name.length?r.gzhead.name.charCodeAt(r.gzindex++)&255:0,A6(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>i&&(e.adler=F3(e.adler,r.pending_buf,r.pending-i,i)),a===0&&(r.gzindex=0,r.status=g6)}else r.status=g6;if(r.status===g6)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=F3(e.adler,r.pending_buf,r.pending-i,i)),O6(e),i=r.pending,r.pending===r.pending_buf_size)){a=1;break}a=r.gzindex<r.gzhead.comment.length?r.gzhead.comment.charCodeAt(r.gzindex++)&255:0,A6(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>i&&(e.adler=F3(e.adler,r.pending_buf,r.pending-i,i)),a===0&&(r.status=_6)}else r.status=_6;if(r.status===_6&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&O6(e),r.pending+2<=r.pending_buf_size&&(A6(r,e.adler&255),A6(r,e.adler>>8&255),e.adler=0,r.status=v6)):r.status=v6),r.pending!==0){if(O6(e),e.avail_out===0)return r.last_flush=-1,H3}else if(e.avail_in===0&&E6(t)<=E6(n)&&t!==B3)return T6(e,K3);if(r.status===y6&&e.avail_in!==0)return T6(e,K3);if(e.avail_in!==0||r.lookahead!==0||t!==L3&&r.status!==y6){var c=r.strategy===Y3?z6(r,t):r.strategy===X3?R6(r,t): __get$(V6,r.level) .func(r,t);if((c===S6||c===C6)&&(r.status=y6),c===b6||c===S6)return e.avail_out===0&&(r.last_flush=-1),H3;if(c===x6&&(t===R3?N3._tr_align(r):t!==V3&&(N3._tr_stored_block(r,0,0,!1),t===z3&&(D6(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),O6(e),e.avail_out===0))return r.last_flush=-1,H3}return t===B3?r.wrap<=0?U3:(r.wrap===2?(A6(r,e.adler&255),A6(r,e.adler>>8&255),A6(r,e.adler>>16&255),A6(r,e.adler>>24&255),A6(r,e.total_in&255),A6(r,e.total_in>>8&255),A6(r,e.total_in>>16&255),A6(r,e.total_in>>24&255)):(j6(r,e.adler>>>16),j6(r,e.adler&65535)),O6(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending===0?U3:H3):H3}function X6(e){var t;return!e||!e.state?W3:(t=e.state.status,t!==p6&&t!==m6&&t!==h6&&t!==g6&&t!==_6&&t!==v6&&t!==y6?T6(e,W3):(e.state=null,t===v6?T6(e,G3):H3))}function Z6(e,t){var n=t.length,r,i,a,o,s,c,l,u;if(!e||!e.state||(r=e.state,o=r.wrap,o===2||o===1&&r.status!==p6||r.lookahead))return W3;for(o===1&&(e.adler=P3(e.adler,t,n,0)),r.wrap=0,n>=r.w_size&&(o===0&&(D6(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new M3.Buf8(r.w_size),M3.arraySet(u,t,n-r.w_size,r.w_size,0),t=u,n=r.w_size),s=e.avail_in,c=e.next_in,l=e.input,e.avail_in=n,e.next_in=0,e.input=t,P6(r);r.lookahead>=l6;){i=r.strstart,a=r.lookahead-(l6-1);do r.ins_h=(r.ins_h<<r.hash_shift^ __get$(r.window,i+l6-1) )&r.hash_mask, __set$(r.prev,i&r.w_mask,__get$(r.head,r.ins_h)) , __set$(r.head,r.ins_h,i) ,i++;while(--a);r.strstart=i,r.lookahead=l6-1,P6(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=l6-1,r.match_available=0,e.next_in=c,e.input=l,e.avail_in=s,r.wrap=o,H3}u4.deflateInit=J6,u4.deflateInit2=q6,u4.deflateReset=G6,u4.deflateResetKeep=W6,u4.deflateSetHeader=K6,u4.deflate=Y6,u4.deflateEnd=X6,u4.deflateSetDictionary=Z6,u4.deflateInfo=`pako deflate (from Nodeca project)`;var Q6={},$6=c4,e8=!0,t8=!0;try{String.fromCharCode.apply(null,[0])}catch{e8=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{t8=!1}for(var n8=new $6.Buf8(256),r8=0;r8<256;r8++) __set$(n8,r8,r8>=252?6:r8>=248?5:r8>=240?4:r8>=224?3:r8>=192?2:1) ;n8[254]=n8[254]=1,Q6.string2buf=function(e){var t,n,r,i,a,o=e.length,s=0;for(i=0;i<o;i++)n=e.charCodeAt(i),(n&64512)==55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)==56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new $6.Buf8(s),a=0,i=0;a<s;i++)n=e.charCodeAt(i),(n&64512)==55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)==56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128? __set$(t,a++,n) :n<2048?( __set$(t,a++,192|n>>>6) , __set$(t,a++,128|n&63) ):n<65536?( __set$(t,a++,224|n>>>12) , __set$(t,a++,128|n>>>6&63) , __set$(t,a++,128|n&63) ):( __set$(t,a++,240|n>>>18) , __set$(t,a++,128|n>>>12&63) , __set$(t,a++,128|n>>>6&63) , __set$(t,a++,128|n&63) );return t};function i8(e,t){if(t<65534&&(e.subarray&&t8||!e.subarray&&e8))return String.fromCharCode.apply(null,$6.shrinkBuf(e,t));for(var n=``,r=0;r<t;r++)n+=String.fromCharCode( __get$(e,r) );return n}Q6.buf2binstring=function(e){return i8(e,e.length)},Q6.binstring2buf=function(e){for(var t=new $6.Buf8(e.length),n=0,r=t.length;n<r;n++) __set$(t,n,e.charCodeAt(n)) ;return t},Q6.buf2string=function(e,t){var n,r,i,a,o=t||e.length,s=Array(o*2);for(r=0,n=0;n<o;){if(i= __get$(e,n++) ,i<128){ __set$(s,r++,i) ;continue}if(a= __get$(n8,i) ,a>4){ __set$(s,r++,65533) ,n+=a-1;continue}for(i&=a===2?31:a===3?15:7;a>1&&n<o;)i=i<<6| __get$(e,n++) &63,a--;if(a>1){ __set$(s,r++,65533) ;continue}i<65536? __set$(s,r++,i) :(i-=65536, __set$(s,r++,55296|i>>10&1023) , __set$(s,r++,56320|i&1023) )}return i8(s,r)},Q6.utf8border=function(e,t){var n;for(t||=e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&( __get$(e,n) &192)==128;)n--;return n<0||n===0?t:n+ __get$(n8,__get$(e,n)) >t?n:t};function a8(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=``,this.state=null,this.data_type=2,this.adler=0}var o8=a8,s8=u4,c8=c4,l8=Q6,u8=j3,d8=o8,f8=Object.prototype.toString,p8=0,m8=4,h8=0,g8=1,_8=2,v8=-1,y8=0,b8=8;function x8(e){if(!(this instanceof x8))return new x8(e);this.options= __call$(c8,"assign",[{level:v8,method:b8,chunkSize:16384,windowBits:15,memLevel:8,strategy:y8,to:``},e||{}]) ;var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg=``,this.ended=!1,this.chunks=[],this.strm=new d8,this.strm.avail_out=0;var n=s8.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==h8)throw Error( __get$(u8,n) );if(t.header&&s8.deflateSetHeader(this.strm,t.header),t.dictionary){var r=typeof t.dictionary==`string`?l8.string2buf(t.dictionary):f8.call(t.dictionary)===`[object ArrayBuffer]`?new Uint8Array(t.dictionary):t.dictionary;if(n=s8.deflateSetDictionary(this.strm,r),n!==h8)throw Error( __get$(u8,n) );this._dict_set=!0}}x8.prototype.push=function(e,t){var n=this.strm,r=this.options.chunkSize,i,a;if(this.ended)return!1;a=t===~~t?t:t===!0?m8:p8,typeof e==`string`?n.input=l8.string2buf(e):f8.call(e)===`[object ArrayBuffer]`?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new c8.Buf8(r),n.next_out=0,n.avail_out=r),i=s8.deflate(n,a),i!==g8&&i!==h8)return this.onEnd(i),this.ended=!0,!1;(n.avail_out===0||n.avail_in===0&&(a===m8||a===_8))&&(this.options.to===`string`?this.onData(l8.buf2binstring(c8.shrinkBuf(n.output,n.next_out))):this.onData(c8.shrinkBuf(n.output,n.next_out)))}while((n.avail_in>0||n.avail_out===0)&&i!==g8);return a===m8?(i=s8.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===h8):a===_8?(this.onEnd(h8),n.avail_out=0,!0):!0},x8.prototype.onData=function(e){this.chunks.push(e)},x8.prototype.onEnd=function(e){e===h8&&(this.options.to===`string`?this.result=this.chunks.join(``):this.result=c8.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function S8(e,t){var n=new x8(t);if(n.push(e,!0),n.err)throw n.msg|| __get$(u8,n.err) ;return n.result}function C8(e,t){return t||={},t.raw=!0,S8(e,t)}function w8(e,t){return t||={},t.gzip=!0,S8(e,t)}l4.Deflate=x8,l4.deflate=S8,l4.deflateRaw=C8,l4.gzip=w8;var T8={},E8={},D8=30,O8=12,k8=function(e,t){var n=e.state,r=e.next_in,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,x,S,C,w,T=e.input,E;i=r+(e.avail_in-5),a=e.next_out,E=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),c=n.dmax,l=n.wsize,u=n.whave,d=n.wnext,f=n.window,p=n.hold,m=n.bits,h=n.lencode,g=n.distcode,_=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;top:do{m<15&&(p+= __get$(T,r++) <<m,m+=8,p+= __get$(T,r++) <<m,m+=8),y= __get$(h,p&_) ;dolen:for(;;){if(b=y>>>24,p>>>=b,m-=b,b=y>>>16&255,b===0) __set$(E,a++,y&65535) ;else if(b&16){x=y&65535,b&=15,b&&(m<b&&(p+= __get$(T,r++) <<m,m+=8),x+=p&(1<<b)-1,p>>>=b,m-=b),m<15&&(p+= __get$(T,r++) <<m,m+=8,p+= __get$(T,r++) <<m,m+=8),y= __get$(g,p&v) ;dodist:for(;;){if(b=y>>>24,p>>>=b,m-=b,b=y>>>16&255,b&16){if(S=y&65535,b&=15,m<b&&(p+= __get$(T,r++) <<m,m+=8,m<b&&(p+= __get$(T,r++) <<m,m+=8)),S+=p&(1<<b)-1,S>c){e.msg=`invalid distance too far back`,n.mode=D8;break top}if(p>>>=b,m-=b,b=a-o,S>b){if(b=S-b,b>u&&n.sane){e.msg=`invalid distance too far back`,n.mode=D8;break top}if(C=0,w=f,d===0){if(C+=l-b,b<x){x-=b;do  __set$(E,a++,__get$(f,C++)) ;while(--b);C=a-S,w=E}}else if(d<b){if(C+=l+d-b,b-=d,b<x){x-=b;do  __set$(E,a++,__get$(f,C++)) ;while(--b);if(C=0,d<x){b=d,x-=b;do  __set$(E,a++,__get$(f,C++)) ;while(--b);C=a-S,w=E}}}else if(C+=d-b,b<x){x-=b;do  __set$(E,a++,__get$(f,C++)) ;while(--b);C=a-S,w=E}for(;x>2;) __set$(E,a++,__get$(w,C++)) , __set$(E,a++,__get$(w,C++)) , __set$(E,a++,__get$(w,C++)) ,x-=3;x&&( __set$(E,a++,__get$(w,C++)) ,x>1&&( __set$(E,a++,__get$(w,C++)) ))}else{C=a-S;do  __set$(E,a++,__get$(E,C++)) , __set$(E,a++,__get$(E,C++)) , __set$(E,a++,__get$(E,C++)) ,x-=3;while(x>2);x&&( __set$(E,a++,__get$(E,C++)) ,x>1&&( __set$(E,a++,__get$(E,C++)) ))}}else if(b&64){e.msg=`invalid distance code`,n.mode=D8;break top}else{y= __get$(g,(y&65535)+(p&(1<<b)-1)) ;continue dodist}break}}else if(b&64)if(b&32){n.mode=O8;break top}else{e.msg=`invalid literal/length code`,n.mode=D8;break top}else{y= __get$(h,(y&65535)+(p&(1<<b)-1)) ;continue dolen}break}}while(r<i&&a<s);x=m>>3,r-=x,m-=x<<3,p&=(1<<m)-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=a<s?257+(s-a):257-(a-s),n.hold=p,n.bits=m},A8=c4,j8=15,M8=852,N8=592,P8=0,F8=1,I8=2,L8=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],R8=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],z8=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],B8=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],V8=function(e,t,n,r,i,a,o,s){var c=s.bits,l=0,u=0,d=0,f=0,p=0,m=0,h=0,g=0,_=0,v=0,y,b,x,S,C,w=null,T=0,E,D=new A8.Buf16(j8+1),O=new A8.Buf16(j8+1),k=null,ee=0,A,j,M;for(l=0;l<=j8;l++) __set$(D,l,0) ;for(u=0;u<r;u++)D[ __get$(t,n+u) ]++;for(p=c,f=j8;f>=1&& __get$(D,f) ===0;f--);if(p>f&&(p=f),f===0)return  __set$(i,a++,20971520) , __set$(i,a++,20971520) ,s.bits=1,0;for(d=1;d<f&& __get$(D,d) ===0;d++);for(p<d&&(p=d),g=1,l=1;l<=j8;l++)if(g<<=1,g-= __get$(D,l) ,g<0)return-1;if(g>0&&(e===P8||f!==1))return-1;for(O[1]=0,l=1;l<j8;l++) __set$(O,l+1,__get$(O,l)+__get$(D,l)) ;for(u=0;u<r;u++) __get$(t,n+u) !==0&&( __set$(o,O[__get$(t,n+u)]++,u) );if(e===P8?(w=k=o,E=19):e===F8?(w=L8,T-=257,k=R8,ee-=257,E=256):(w=z8,k=B8,E=-1),v=0,u=0,l=d,C=a,m=p,h=0,x=-1,_=1<<p,S=_-1,e===F8&&_>M8||e===I8&&_>N8)return 1;for(;;){A=l-h, __get$(o,u) <E?(j=0,M= __get$(o,u) ): __get$(o,u) >E?(j= __get$(k,ee+__get$(o,u)) ,M= __get$(w,T+__get$(o,u)) ):(j=96,M=0),y=1<<l-h,b=1<<m,d=b;do b-=y, __set$(i,C+(v>>h)+b,A<<24|j<<16|M|0) ;while(b!==0);for(y=1<<l-1;v&y;)y>>=1;if(y===0?v=0:(v&=y-1,v+=y),u++,--D[l]===0){if(l===f)break;l= __get$(t,n+__get$(o,u)) }if(l>p&&(v&S)!==x){for(h===0&&(h=p),C+=d,m=l-h,g=1<<m;m+h<f&&(g-= __get$(D,m+h) ,!(g<=0));)m++,g<<=1;if(_+=1<<m,e===F8&&_>M8||e===I8&&_>N8)return 1;x=v&S, __set$(i,x,p<<24|m<<16|C-a|0) }}return v!==0&&( __set$(i,C+v,l-h<<24|4194304) ),s.bits=p,0},H8=c4,U8=E3,W8=A3,G8=k8,K8=V8,q8=0,J8=1,Y8=2,X8=4,Z8=5,Q8=6,$8=0,e5=1,t5=2,n5=-2,r5=-3,i5=-4,a5=-5,o5=8,s5=1,c5=2,l5=3,u5=4,d5=5,f5=6,p5=7,m5=8,h5=9,g5=10,_5=11,v5=12,y5=13,b5=14,x5=15,S5=16,C5=17,w5=18,T5=19,E5=20,D5=21,O5=22,k5=23,A5=24,j5=25,M5=26,N5=27,P5=28,F5=29,I5=30,L5=31,R5=32,z5=852,B5=592,V5=15;function H5(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function U5(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new H8.Buf16(320),this.work=new H8.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function W5(e){var t;return!e||!e.state?n5:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=``,t.wrap&&(e.adler=t.wrap&1),t.mode=s5,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new H8.Buf32(z5),t.distcode=t.distdyn=new H8.Buf32(B5),t.sane=1,t.back=-1,$8)}function G5(e){var t;return!e||!e.state?n5:(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,W5(e))}function K5(e,t){var n,r;return!e||!e.state||(r=e.state,t<0?(n=0,t=-t):(n=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15))?n5:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,G5(e))}function q5(e,t){var n,r;return e?(r=new U5,e.state=r,r.window=null,n=K5(e,t),n!==$8&&(e.state=null),n):n5}function J5(e){return q5(e,V5)}var Y5=!0,X5,Z5;function Q5(e){if(Y5){var t;for(X5=new H8.Buf32(512),Z5=new H8.Buf32(32),t=0;t<144;) __set$(e.lens,t++,8) ;for(;t<256;) __set$(e.lens,t++,9) ;for(;t<280;) __set$(e.lens,t++,7) ;for(;t<288;) __set$(e.lens,t++,8) ;for(K8(J8,e.lens,0,288,X5,0,e.work,{bits:9}),t=0;t<32;) __set$(e.lens,t++,5) ;K8(Y8,e.lens,0,32,Z5,0,e.work,{bits:5}),Y5=!1}e.lencode=X5,e.lenbits=9,e.distcode=Z5,e.distbits=5}function $5(e,t,n,r){var i,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new H8.Buf8(a.wsize)),r>=a.wsize?(H8.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),H8.arraySet(a.window,t,n-r,i,a.wnext),r-=i,r?(H8.arraySet(a.window,t,n-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0}function e7(e,t){var n,r,i,a,o,s,c,l,u,d,f,p,m,h,g=0,_,v,y,b,x,S,C,w,T=new H8.Buf8(4),E,D,O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return n5;n=e.state,n.mode===v5&&(n.mode=y5),o=e.next_out,i=e.output,c=e.avail_out,a=e.next_in,r=e.input,s=e.avail_in,l=n.hold,u=n.bits,d=s,f=c,w=$8;inf_leave:for(;;)switch(n.mode){case s5:if(n.wrap===0){n.mode=y5;break}for(;u<16;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(n.wrap&2&&l===35615){n.check=0,T[0]=l&255,T[1]=l>>>8&255,n.check=W8(n.check,T,2,0),l=0,u=0,n.mode=c5;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg=`incorrect header check`,n.mode=I5;break}if((l&15)!==o5){e.msg=`unknown compression method`,n.mode=I5;break}if(l>>>=4,u-=4,C=(l&15)+8,n.wbits===0)n.wbits=C;else if(C>n.wbits){e.msg=`invalid window size`,n.mode=I5;break}n.dmax=1<<C,e.adler=n.check=1,n.mode=l&512?g5:v5,l=0,u=0;break;case c5:for(;u<16;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(n.flags=l,(n.flags&255)!==o5){e.msg=`unknown compression method`,n.mode=I5;break}if(n.flags&57344){e.msg=`unknown header flags set`,n.mode=I5;break}n.head&&(n.head.text=l>>8&1),n.flags&512&&(T[0]=l&255,T[1]=l>>>8&255,n.check=W8(n.check,T,2,0)),l=0,u=0,n.mode=l5;case l5:for(;u<32;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}n.head&&(n.head.time=l),n.flags&512&&(T[0]=l&255,T[1]=l>>>8&255,T[2]=l>>>16&255,T[3]=l>>>24&255,n.check=W8(n.check,T,4,0)),l=0,u=0,n.mode=u5;case u5:for(;u<16;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}n.head&&(n.head.xflags=l&255,n.head.os=l>>8),n.flags&512&&(T[0]=l&255,T[1]=l>>>8&255,n.check=W8(n.check,T,2,0)),l=0,u=0,n.mode=d5;case d5:if(n.flags&1024){for(;u<16;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),n.flags&512&&(T[0]=l&255,T[1]=l>>>8&255,n.check=W8(n.check,T,2,0)),l=0,u=0}else n.head&&(n.head.extra=null);n.mode=f5;case f5:if(n.flags&1024&&(p=n.length,p>s&&(p=s),p&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=Array(n.head.extra_len)),H8.arraySet(n.head.extra,r,a,p,C)),n.flags&512&&(n.check=W8(n.check,r,p,a)),s-=p,a+=p,n.length-=p),n.length))break inf_leave;n.length=0,n.mode=p5;case p5:if(n.flags&2048){if(s===0)break inf_leave;p=0;do C= __get$(r,a+p++) ,n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C));while(C&&p<s);if(n.flags&512&&(n.check=W8(n.check,r,p,a)),s-=p,a+=p,C)break inf_leave}else n.head&&(n.head.name=null);n.length=0,n.mode=m5;case m5:if(n.flags&4096){if(s===0)break inf_leave;p=0;do C= __get$(r,a+p++) ,n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C));while(C&&p<s);if(n.flags&512&&(n.check=W8(n.check,r,p,a)),s-=p,a+=p,C)break inf_leave}else n.head&&(n.head.comment=null);n.mode=h5;case h5:if(n.flags&512){for(;u<16;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(l!==(n.check&65535)){e.msg=`header crc mismatch`,n.mode=I5;break}l=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=v5;break;case g5:for(;u<32;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}e.adler=n.check=H5(l),l=0,u=0,n.mode=_5;case _5:if(n.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=l,n.bits=u,t5;e.adler=n.check=1,n.mode=v5;case v5:if(t===Z8||t===Q8)break inf_leave;case y5:if(n.last){l>>>=u&7,u-=u&7,n.mode=N5;break}for(;u<3;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}switch(n.last=l&1,l>>>=1,--u,l&3){case 0:n.mode=b5;break;case 1:if(Q5(n),n.mode=E5,t===Q8){l>>>=2,u-=2;break inf_leave}break;case 2:n.mode=C5;break;case 3:e.msg=`invalid block type`,n.mode=I5}l>>>=2,u-=2;break;case b5:for(l>>>=u&7,u-=u&7;u<32;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if((l&65535)!=(l>>>16^65535)){e.msg=`invalid stored block lengths`,n.mode=I5;break}if(n.length=l&65535,l=0,u=0,n.mode=x5,t===Q8)break inf_leave;case x5:n.mode=S5;case S5:if(p=n.length,p){if(p>s&&(p=s),p>c&&(p=c),p===0)break inf_leave;H8.arraySet(i,r,a,p,o),s-=p,a+=p,c-=p,o+=p,n.length-=p;break}n.mode=v5;break;case C5:for(;u<14;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(n.nlen=(l&31)+257,l>>>=5,u-=5,n.ndist=(l&31)+1,l>>>=5,u-=5,n.ncode=(l&15)+4,l>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg=`too many length or distance symbols`,n.mode=I5;break}n.have=0,n.mode=w5;case w5:for(;n.have<n.ncode;){for(;u<3;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8} __set$(n.lens,__get$(O,n.have++),l&7) ,l>>>=3,u-=3}for(;n.have<19;) __set$(n.lens,__get$(O,n.have++),0) ;if(n.lencode=n.lendyn,n.lenbits=7,E={bits:n.lenbits},w=K8(q8,n.lens,0,19,n.lencode,0,n.work,E),n.lenbits=E.bits,w){e.msg=`invalid code lengths set`,n.mode=I5;break}n.have=0,n.mode=T5;case T5:for(;n.have<n.nlen+n.ndist;){for(;g= __get$(n.lencode,l&(1<<n.lenbits)-1) ,_=g>>>24,v=g>>>16&255,y=g&65535,!(_<=u);){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(y<16)l>>>=_,u-=_, __set$(n.lens,n.have++,y) ;else{if(y===16){for(D=_+2;u<D;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(l>>>=_,u-=_,n.have===0){e.msg=`invalid bit length repeat`,n.mode=I5;break}C= __get$(n.lens,n.have-1) ,p=3+(l&3),l>>>=2,u-=2}else if(y===17){for(D=_+3;u<D;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}l>>>=_,u-=_,C=0,p=3+(l&7),l>>>=3,u-=3}else{for(D=_+7;u<D;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}l>>>=_,u-=_,C=0,p=11+(l&127),l>>>=7,u-=7}if(n.have+p>n.nlen+n.ndist){e.msg=`invalid bit length repeat`,n.mode=I5;break}for(;p--;) __set$(n.lens,n.have++,C) }}if(n.mode===I5)break;if(n.lens[256]===0){e.msg=`invalid code -- missing end-of-block`,n.mode=I5;break}if(n.lenbits=9,E={bits:n.lenbits},w=K8(J8,n.lens,0,n.nlen,n.lencode,0,n.work,E),n.lenbits=E.bits,w){e.msg=`invalid literal/lengths set`,n.mode=I5;break}if(n.distbits=6,n.distcode=n.distdyn,E={bits:n.distbits},w=K8(Y8,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,E),n.distbits=E.bits,w){e.msg=`invalid distances set`,n.mode=I5;break}if(n.mode=E5,t===Q8)break inf_leave;case E5:n.mode=D5;case D5:if(s>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=l,n.bits=u,G8(e,f),o=e.next_out,i=e.output,c=e.avail_out,a=e.next_in,r=e.input,s=e.avail_in,l=n.hold,u=n.bits,n.mode===v5&&(n.back=-1);break}for(n.back=0;g= __get$(n.lencode,l&(1<<n.lenbits)-1) ,_=g>>>24,v=g>>>16&255,y=g&65535,!(_<=u);){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(v&&!(v&240)){for(b=_,x=v,S=y;g= __get$(n.lencode,S+((l&(1<<b+x)-1)>>b)) ,_=g>>>24,v=g>>>16&255,y=g&65535,!(b+_<=u);){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}l>>>=b,u-=b,n.back+=b}if(l>>>=_,u-=_,n.back+=_,n.length=y,v===0){n.mode=M5;break}if(v&32){n.back=-1,n.mode=v5;break}if(v&64){e.msg=`invalid literal/length code`,n.mode=I5;break}n.extra=v&15,n.mode=O5;case O5:if(n.extra){for(D=n.extra;u<D;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=k5;case k5:for(;g= __get$(n.distcode,l&(1<<n.distbits)-1) ,_=g>>>24,v=g>>>16&255,y=g&65535,!(_<=u);){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(!(v&240)){for(b=_,x=v,S=y;g= __get$(n.distcode,S+((l&(1<<b+x)-1)>>b)) ,_=g>>>24,v=g>>>16&255,y=g&65535,!(b+_<=u);){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}l>>>=b,u-=b,n.back+=b}if(l>>>=_,u-=_,n.back+=_,v&64){e.msg=`invalid distance code`,n.mode=I5;break}n.offset=y,n.extra=v&15,n.mode=A5;case A5:if(n.extra){for(D=n.extra;u<D;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg=`invalid distance too far back`,n.mode=I5;break}n.mode=j5;case j5:if(c===0)break inf_leave;if(p=f-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg=`invalid distance too far back`,n.mode=I5;break}p>n.wnext?(p-=n.wnext,m=n.wsize-p):m=n.wnext-p,p>n.length&&(p=n.length),h=n.window}else h=i,m=o-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do  __set$(i,o++,__get$(h,m++)) ;while(--p);n.length===0&&(n.mode=D5);break;case M5:if(c===0)break inf_leave; __set$(i,o++,n.length) ,c--,n.mode=D5;break;case N5:if(n.wrap){for(;u<32;){if(s===0)break inf_leave;s--,l|= __get$(r,a++) <<u,u+=8}if(f-=c,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?W8(n.check,i,f,o-f):U8(n.check,i,f,o-f)),f=c,(n.flags?l:H5(l))!==n.check){e.msg=`incorrect data check`,n.mode=I5;break}l=0,u=0}n.mode=P5;case P5:if(n.wrap&&n.flags){for(;u<32;){if(s===0)break inf_leave;s--,l+= __get$(r,a++) <<u,u+=8}if(l!==(n.total&4294967295)){e.msg=`incorrect length check`,n.mode=I5;break}l=0,u=0}n.mode=F5;case F5:w=e5;break inf_leave;case I5:w=r5;break inf_leave;case L5:return i5;case R5:default:return n5}return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=l,n.bits=u,(n.wsize||f!==e.avail_out&&n.mode<I5&&(n.mode<N5||t!==X8))&&$5(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?W8(n.check,i,f,e.next_out-f):U8(n.check,i,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(n.mode===v5?128:0)+(n.mode===E5||n.mode===x5?256:0),(d===0&&f===0||t===X8)&&w===$8&&(w=a5),w}function t7(e){if(!e||!e.state)return n5;var t=e.state;return t.window&&=null,e.state=null,$8}function n7(e,t){var n;return!e||!e.state||(n=e.state,!(n.wrap&2))?n5:(n.head=t,t.done=!1,$8)}function r7(e,t){var n=t.length,r,i,a;return!e||!e.state||(r=e.state,r.wrap!==0&&r.mode!==_5)?n5:r.mode===_5&&(i=1,i=U8(i,t,n,0),i!==r.check)?r5:(a=$5(e,t,n,n),a?(r.mode=L5,i5):(r.havedict=1,$8))}E8.inflateReset=G5,E8.inflateReset2=K5,E8.inflateResetKeep=W5,E8.inflateInit=J5,E8.inflateInit2=q5,E8.inflate=e7,E8.inflateEnd=t7,E8.inflateGetHeader=n7,E8.inflateSetDictionary=r7,E8.inflateInfo=`pako inflate (from Nodeca project)`;var i7={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function a7(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=``,this.comment=``,this.hcrc=0,this.done=!1}var o7=a7,s7=E8,c7=c4,l7=Q6,u7=i7,d7=j3,f7=o8,p7=o7,m7=Object.prototype.toString;function h7(e){if(!(this instanceof h7))return new h7(e);this.options= __call$(c7,"assign",[{chunkSize:16384,windowBits:0,to:``},e||{}]) ;var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg=``,this.ended=!1,this.chunks=[],this.strm=new f7,this.strm.avail_out=0;var n=s7.inflateInit2(this.strm,t.windowBits);if(n!==u7.Z_OK||(this.header=new p7,s7.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary==`string`?t.dictionary=l7.string2buf(t.dictionary):m7.call(t.dictionary)===`[object ArrayBuffer]`&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=s7.inflateSetDictionary(this.strm,t.dictionary),n!==u7.Z_OK))))throw Error( __get$(d7,n) )}h7.prototype.push=function(e,t){var n=this.strm,r=this.options.chunkSize,i=this.options.dictionary,a,o,s,c,l,u=!1;if(this.ended)return!1;o=t===~~t?t:t===!0?u7.Z_FINISH:u7.Z_NO_FLUSH,typeof e==`string`?n.input=l7.binstring2buf(e):m7.call(e)===`[object ArrayBuffer]`?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new c7.Buf8(r),n.next_out=0,n.avail_out=r),a=s7.inflate(n,u7.Z_NO_FLUSH),a===u7.Z_NEED_DICT&&i&&(a=s7.inflateSetDictionary(this.strm,i)),a===u7.Z_BUF_ERROR&&u===!0&&(a=u7.Z_OK,u=!1),a!==u7.Z_STREAM_END&&a!==u7.Z_OK)return this.onEnd(a),this.ended=!0,!1;n.next_out&&(n.avail_out===0||a===u7.Z_STREAM_END||n.avail_in===0&&(o===u7.Z_FINISH||o===u7.Z_SYNC_FLUSH))&&(this.options.to===`string`?(s=l7.utf8border(n.output,n.next_out),c=n.next_out-s,l=l7.buf2string(n.output,s),n.next_out=c,n.avail_out=r-c,c&&c7.arraySet(n.output,n.output,s,c,0),this.onData(l)):this.onData(c7.shrinkBuf(n.output,n.next_out))),n.avail_in===0&&n.avail_out===0&&(u=!0)}while((n.avail_in>0||n.avail_out===0)&&a!==u7.Z_STREAM_END);return a===u7.Z_STREAM_END&&(o=u7.Z_FINISH),o===u7.Z_FINISH?(a=s7.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===u7.Z_OK):o===u7.Z_SYNC_FLUSH?(this.onEnd(u7.Z_OK),n.avail_out=0,!0):!0},h7.prototype.onData=function(e){this.chunks.push(e)},h7.prototype.onEnd=function(e){e===u7.Z_OK&&(this.options.to===`string`?this.result=this.chunks.join(``):this.result=c7.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function g7(e,t){var n=new h7(t);if(n.push(e,!0),n.err)throw n.msg|| __get$(d7,n.err) ;return n.result}function _7(e,t){return t||={},t.raw=!0,g7(e,t)}T8.Inflate=h7,T8.inflate=g7,T8.inflateRaw=_7,T8.ungzip=g7;var v7=c4.assign,y7=l4,b7=T8,x7=i7,S7={};v7(S7,y7,b7,x7);var C7=S7;function w7(e){var t=o4.exports.Base64.atob(e).split(``).map(function(e){return e.charCodeAt(0)}),n=new Uint8Array(t);return JSON.parse(C7.inflate(n,{to:`string`}))}function T7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E7(e){for(var t=1;t<arguments.length;t++){var n= __get$(arguments,t) ==null?{}: __get$(arguments,t) ;t%2?T7(Object(n),!0).forEach(function(t){$(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T7(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function D7(){return new Set}function O7(e){return new Set(e)}function k7(e){var t=[];return e&&e.forEach(function(e){return t.push(e)}),t}function A7(){return new Map}function j7(e){return Object.keys(e)}function M7(e){return Object.values(e)}function N7(e){return Object.entries(e)}function P7(e,t){var n=E7({},e);return t&&j7(e).forEach(function(e){ __get$(t,e) !==void 0&&( __set$(n,e,__get$(t,e)) )}),n}function F7(e,t,n){return String.prototype.startsWith.call(e,t,n)}function I7(e,t,n){return String.prototype.endsWith.call(e,t,n)}function L7(e,t){return L7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},L7(e,t)}function R7(){if(typeof Reflect>`u`||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy==`function`)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function z7(e,t,n){return z7=R7()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&L7(i,n.prototype),i},z7.apply(null,arguments)}function B7(e){if(Array.isArray(e))return Y2(e)}function V7(e){if(typeof Symbol<`u`&& __get$(e,Symbol.iterator) !=null|| __get$(e,`@@iterator`) !=null)return Array.from(e)}function H7(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U7(e){return B7(e)||V7(e)||X2(e)||H7()}var W7=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;z2(this,e),$(this,`enabled`,void 0),$(this,`prefix`,void 0),this.enabled=t,this.prefix=[...arguments].slice(1)}return V2(e,[{key:`isEnabled`,value:function(){return this.enabled}},{key:`setEnabled`,value:function(e){this.enabled=e}},{key:`log`,value:function(){if(this.enabled)try{var e,t=[...arguments];(e=console).log.apply(e,[`[PubSub]`].concat(U7(this.prefix),t))}catch{}}},{key:`error`,value:function(){if(this.enabled)try{var e,t=[...arguments];(e=console).error.apply(e,[`[PubSub]`].concat(U7(this.prefix),t))}catch{}}},{key:`create`,value:function(t){return z7(e,[this.enabled].concat(U7(this.prefix),[t]))}}])}(),G7=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new W7;z2(this,e),$(this,`connection`,void 0),$(this,`logger`,void 0),$(this,`timeout`,void 0),$(this,`timeoutMs`,void 0),this.connection=t,this.logger=n}return V2(e,[{key:`start`,value:function(e,t){this.timeoutMs=e,this.log(`Started: interval:${t}, timeout:${e}`),this.reset()}},{key:`handle`,value:function(e){this.reset(),F7(e,n4.PING)&&(this.log(`Ping Pong`),this.connection.send(n4.PONG))}},{key:`stop`,value:function(){this.clearTimeout()}},{key:`reset`,value:function(){var e=this;this.clearTimeout(),this.timeout=setTimeout(function(){e.log(`Timeout`),e.connection.onTimeout()},this.timeoutMs)}},{key:`clearTimeout`,value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){this.timeout&&=(clearTimeout(this.timeout),void 0)})},{key:`log`,value:function(){var e,t=[...arguments];(e=this.logger).log.apply(e,[`[Ping/Pong]`].concat(t))}}])}(),K7=1,q7=function(){function e(t,n,r,i,a){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:new W7;z2(this,e),$(this,`subscriptions`,void 0),$(this,`socket`,void 0),$(this,`defaultOptions`,void 0),$(this,`logger`,void 0),$(this,`closedByError`,void 0),$(this,`alive`,void 0),$(this,`welcomeTimeout`,void 0),$(this,`welcomRequestTimeout`,void 0),$(this,`options`,void 0),$(this,`pingPong`,void 0),$(this,`welcomeReceived`,void 0),$(this,`sessionId`,void 0),$(this,`sessionOffset`,void 0),$(this,`sessionOptions`,void 0),$(this,`timeoutMs`,void 0),$(this,`intervalMs`,void 0),this.subscriptions=t,this.socket=n,this.defaultOptions=r,this.logger=o,this.alive=!0,this.sessionId=i,this.sessionOffset=a,this.welcomeReceived=!1,this.options=r,this.setWelcomeTimeout(),this.log(`Created: options:`,this.options);var s=this.logger.create(`[Connection(`+this.socket.id()+`)]`);this.pingPong=new G7(this,s)}return V2(e,[{key:`getOptions`,value:function(){return this.options}},{key:`getSessionId`,value:function(){return this.sessionId}},{key:`getSessionOffset`,value:function(){return this.sessionOffset}},{key:`getSessionOptions`,value:function(){return this.sessionOptions}},{key:`getTimeoutMs`,value:function(){return this.timeoutMs}},{key:`getIntervalMs`,value:function(){return this.intervalMs}},{key:`send`,value:function(e){this.socket.send(e)}},{key:`onTimeout`,value:function(){this.log(`Timeout`),this.terminateByError($2.KEEPALIVE_TIMEOUT)}},{key:`onPacket`,value:function(e){try{if(this.alive)if(F7(e,n4.OPEN)){var t=JSON.parse(e.substring(1));return this.clearWelcomeTimeout(),this.onConnectionOpen(t),i4.OK}else{if(!this.welcomeReceived){this.terminateByError($2.WELCOME_EXPECTED);return}if(this.pingPong.handle(e),F7(e,n4.PING)&&e.length>1)return Q2(JSON.parse(e.substring(1)),1)[0];if(F7(e,n4.MESSAGE)){var n=e.slice(1,2),r=JSON.parse(e.substring(2));this.onSubscriptionMessage(n,r)}if(F7(e,n4.PRESENCE)&&e.slice(1,2)===r4.REGISTERED){var i=Q2(JSON.parse(e.substring(2)),3),a=i[0],o=i[1],s=i[2];this.setOffset(a)&&this.subscriptions.onRegistered(o,s)}}}catch{this.terminateByError($2.CORRUPTED_PACKET)}}},{key:`onClose`,value:function(){this.alive&&(this.terminateByError($2.CONNECTION_CLOSED),this.log(`Connection close`))}},{key:`onError`,value:function(e){this.alive&&(this.terminateByError(e),this.log(`Connection error`))}},{key:`subscribe`,value:function(e,t){this.log(`Subscribe: channel:${e}, position:${t}`);var n=n4.MESSAGE+t4.SUBSCRIBE;this.alive&&(t?this.send(`${n}["${e}", "${t}"]`):this.send(`${n}["${e}"]`))}},{key:`unsubscribe`,value:function(e){this.log(`Unsubscribe: channel:${e}`),this.send(`${n4.MESSAGE}${t4.UNSUBSCRIBE}["${e}"]`)}},{key:`register`,value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.log(`Register: capabilities:${e}, activities:`,t);var n=n4.PRESENCE+r4.REGISTER;if(this.alive){var r=JSON.stringify(e),i=JSON.stringify(t);this.send(`${n}[${r},${i}]`)}}},{key:`close`,value:function(e,t){this.terminate(!1,e,t)}},{key:`terminateByError`,value:function(e){this.terminate(this.welcomeReceived,e4(e),e)}},{key:`terminate`,value:function(e,t,n){this.alive&&(this.log(`Closing...`),this.alive=!1,this.closedByError=n,this.pingPong.stop(),this.clearWelcomeTimeout(),e&&this.welcomeReceived&&this.subscriptions.onDetach(),this.socket&&(t&&this.send(`1`),this.socket.close()),this.log(`Closed`))}},{key:`onConnectionOpen`,value:function(e){var t=Q2(e,4),n=t[0],r=t[1],i=t[2],a=t[3];if(!this.welcomeReceived)this.welcomeReceived=!0,this.log(`Connected`),this.log(`SessionId:`,n),this.sessionId!==n&&(this.sessionId=n,this.sessionOffset=0),this.handshake(n,r,i,a),this.subscriptions.onAttach(this);else if(this.sessionId===n)this.handshake(n,r,i,a),this.subscriptions.onUpdate(a);else{this.terminateByError($2.WELCOME_INCONSISTENT);return}}},{key:`handshake`,value:function(e,t,n,r){this.updateSessionOptions(r),this.restartPingPong(t,n)&&this.send(`0`+JSON.stringify([e,t,n]))}},{key:`onSubscriptionMessage`,value:function(e,t){var n=t[0],r=t[1],i=String(t[2]);if(this.setOffset(n)){if(e===t4.SUBSCRIBED&&this.subscriptions.onSubscribed(r,i),e===t4.UNSUBSCRIBED){var a=Number(t[2]),o=t[3]?Number(t[3]):void 0;this.subscriptions.onUnsubscribed(r,a,o)}if(e===t4.MESSAGE){var s=t[4]===K7?w7(t[3]):t[3];this.subscriptions.onMessage(r,i,s)}e===t4.POSITION&&this.subscriptions.onPosition(r,i)}}},{key:`setOffset`,value:function(e){return this.sessionOffset===void 0||e-this.sessionOffset!==1?(this.terminateByError($2.CORRUPTED_OFFSET),!1):(this.sendAck(e),this.sessionOffset=e,!0)}},{key:`sendAck`,value:function(e){this.log(`Ack: offset:${e}`),this.send(`${n4.MESSAGE}${t4.ACK}[${e}]`)}},{key:`setWelcomeTimeout`,value:function(){var e=this;this.options.welcomeRequestDelayMs<=0?this.send(`${n4.OPEN}`):this.welcomRequestTimeout=setTimeout(function(){e.welcomRequestTimeout=void 0,e.alive&&!e.welcomeReceived&&e.send(`${n4.OPEN}`)},this.options.welcomeRequestDelayMs),this.welcomeTimeout=setTimeout(function(){e.alive&&!e.welcomeReceived&&(e.log(`Welcome Timeout`),e.terminateByError($2.WELCOME_TIMEOUT))},this.options.welcomeMaxDelayMs)}},{key:`clearWelcomeTimeout`,value:function(){this.welcomRequestTimeout&&=(clearTimeout(this.welcomRequestTimeout),void 0),this.welcomeTimeout&&=(clearTimeout(this.welcomeTimeout),void 0)}},{key:`restartPingPong`,value:function(e,t){var n=1e3*e,r=1e3*t;return this.intervalMs!==n||this.timeoutMs!==r?(this.intervalMs=1e3*e,this.timeoutMs=1e3*t,this.log(`Ping Interval`,e,`Seconds`),this.log(`Ping Timeout:`,t,`Seconds`),this.pingPong.start(this.timeoutMs,this.intervalMs),!0):!1}},{key:`updateSessionOptions`,value:function(e){this.sessionOptions=e,this.options=P7(this.defaultOptions,e)}},{key:`log`,value:function(){var e,t=[...arguments];(e=this.logger).log.apply(e,[`[Connection(`+this.socket.id()+`)]`].concat(t))}}])}(),J7=function(){function e(t,n,r){z2(this,e),$(this,`subscriptions`,void 0),$(this,`options`,void 0),$(this,`logger`,void 0),this.subscriptions=t,this.options=n,this.logger=r}return V2(e,[{key:`create`,value:function(e,t,n){return new q7(this.subscriptions,e,this.options,t,n,this.logger)}}])}(),Y7=function(){function e(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new W7;z2(this,e),$(this,`listener`,void 0),$(this,`errorHandler`,void 0),$(this,`logger`,void 0),this.listener=t,this.errorHandler=n,this.logger=r}return V2(e,[{key:`onConnect`,value:function(e){var t=this;this.safe(function(){t.listener.onConnect&&t.listener.onConnect(e)},`Connected`)}},{key:`onAttach`,value:function(){var e=this;this.safe(function(){e.listener.onAttach&&e.listener.onAttach()},`Attached`)}},{key:`onDetach`,value:function(){var e=this;this.safe(function(){e.listener.onDetach&&e.listener.onDetach()},`Detached`)}},{key:`onFailure`,value:function(e){var t=this;this.safe(function(){t.listener.onFailure&&t.listener.onFailure(e)},`Failed`,e)}},{key:`safe`,value:function(e){var t=[...arguments].slice(1);this.log.apply(this,t);try{e()}catch(e){this.error(e),this.logError(`Listener callback failure: `,e)}}},{key:`error`,value:function(e){try{this.errorHandler&&this.errorHandler.error(e)}catch{}}},{key:`log`,value:function(){var e,t=[...arguments];(e=this.logger).log.apply(e,[`[Listener]`].concat(t))}},{key:`logError`,value:function(){var e,t=[...arguments];(e=this.logger).error.apply(e,[`[Listener]`].concat(t))}}])}(),X7=function(){function e(t,n){z2(this,e),$(this,`factory`,void 0),$(this,`logger`,void 0),this.factory=t,this.logger=n||new W7}return V2(e,[{key:`create`,value:function(e,t,n){var r=this,i=!0,a=this.factory(t);a.onopen=function(){i&&(r.log(e,`Open`),n.onOpen(e))},a.onmessage=function(t){i&&(r.log(e,`Received:`,t.data),n.onMessage(e,t.data))},a.onclose=function(t){i&&(i=!1,r.log(e,`Closed:`,t),n.onClose(e,t.code))},a.onerror=function(t){i&&(i=!1,r.log(e,`Failed:`,t),n.onError(e))};var o=this;return{id:function(){return e},send:function(t){if(i)try{o.log(e,`Send:`,t),a.send(t)}catch(t){o.log(e,`Send error`,t),i=!1,o.closeSocket(e,a),n.onClose(e)}},close:function(){i&&(o.log(e,`Close`),i=!1,o.closeSocket(e,a),n.onClose(e))}}}},{key:`closeSocket`,value:function(e,t){try{t.close()}catch(t){this.log(e,`Close error (ignored)`,t)}}},{key:`log`,value:function(e){var t,n=[...arguments].slice(1);(t=this.logger).log.apply(t,[`[Socket(`+e+`)]`].concat(n))}}])}();function Z7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Q7(e){for(var t=1;t<arguments.length;t++){var n= __get$(arguments,t) ==null?{}: __get$(arguments,t) ;t%2?Z7(Object(n),!0).forEach(function(t){$(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z7(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $7(e,t,n){switch(e){case 401:return Q7({code:e,message:`user not authenticated`,channel:t},n);case 403:return Q7({code:e,message:`channel access forbidden`,channel:t},n);case 404:return Q7({code:e,message:`channel not found`,channel:t},n);case 430:return Q7({code:e,message:`too many open channels`,channel:t},n);default:return Q7({code:e,message:`unknown problem`,channel:t},n)}}var e9=function(){function e(){z2(this,e),$(this,`capabilities`,D7()),$(this,`activities`,A7())}return V2(e,[{key:`add`,value:function(e){var t=this;e&&(e.capabilities&&e.capabilities.forEach(function(e){return t.capabilities.add(e)}),e.activities&&N7(e.activities).forEach(function(e){var n=Q2(e,2),r=n[0],i=n[1],a=t.getActivitySet(r);i&&i.forEach(function(e){return a.add(e)})}))}},{key:`get`,value:function(){return{capabilities:this.convertCapabilities(),activities:this.convertActivities()}}},{key:`convertCapabilities`,value:function(){if(this.capabilities.size!==0)return k7(this.capabilities)}},{key:`convertActivities`,value:function(){if(this.activities.size!==0){var e={};return this.activities.forEach(function(t,n){t&&( __set$(e,n,k7(t)) )}),e}}},{key:`getActivitySet`,value:function(e){var t=this.activities.get(e);return t===void 0&&(t=D7(),this.activities.set(e,t)),t}}])}(),t9=function(){function e(t,n,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new W7;z2(this,e),$(this,`subscriberId`,void 0),$(this,`subscriber`,void 0),$(this,`errorHandler`,void 0),$(this,`logger`,void 0),this.subscriberId=t,this.subscriber=n,this.errorHandler=r,this.logger=i}return V2(e,[{key:`onAttach`,value:function(e){var t=this;this.safe(function(){t.subscriber.onAttach&&t.subscriber.onAttach(e)},`Attached: continuation:${e}`)}},{key:`onDetach`,value:function(){var e=this;this.safe(function(){e.subscriber.onDetach&&e.subscriber.onDetach()},`Detached`)}},{key:`onMessage`,value:function(e){var t=this;this.safe(function(){t.subscriber.onMessage&&t.subscriber.onMessage(e)},`Message: `,e),this.log(`Message: `,e)}},{key:`onComplete`,value:function(){var e=this;this.safe(function(){e.subscriber.onComplete&&e.subscriber.onComplete()},`Completed`)}},{key:`onFailure`,value:function(e){var t=this;this.safe(function(){t.subscriber.onFailure&&t.subscriber.onFailure(e)},`Failed`,e)}},{key:`safe`,value:function(e){var t=[...arguments].slice(1);this.log.apply(this,t);try{e()}catch(e){this.error(e),this.logError(`Subscriber callback failure: `,e)}}},{key:`error`,value:function(e){try{this.errorHandler&&this.errorHandler.error(e)}catch{}}},{key:`log`,value:function(){var e,t=[...arguments];(e=this.logger).log.apply(e,[`[Subscriber(${this.subscriberId})]`].concat(t))}},{key:`logError`,value:function(){var e,t=[...arguments];(e=this.logger).error.apply(e,[`[Subscriber(${this.subscriberId})]`].concat(t))}}])}(),n9=function(){function e(t,n,r){z2(this,e),$(this,`callbackErrorHandler`,void 0),$(this,`logger`,void 0),$(this,`attached`,!1),$(this,`position`,void 0),$(this,`subscribers`,{}),this.callbackErrorHandler=n,this.logger=r?r.create(`[Subscription(${t})]`):new W7}return V2(e,[{key:`addSubscriber`,value:function(e,t,n){this.log(`Added: subscriberId:${e}, categories:`,n);var r=new t9(e,t,this.callbackErrorHandler,this.logger); __set$(this.subscribers,e,{subscriber:r,categories:n}) ,this.attached&&r.onAttach(!1)}},{key:`updateSubscriber`,value:function(e,t){this.log(`Updated: subscriberId:${e}, categories:${t}`), __get$(this.subscribers,e) &&( __get$(this.subscribers,e) .categories=t)}},{key:`removeSubscriber`,value:function(e){this.log(`Removed: subscriberId:${e}`),delete this.subscribers[e]}},{key:`setPosition`,value:function(e){this.position=e}},{key:`getPosition`,value:function(){return this.position}},{key:`isEmpty`,value:function(){return Object.keys(this.subscribers).length===0}},{key:`isAttached`,value:function(){return this.attached}},{key:`getCategories`,value:function(){var e=new e9;return M7(this.subscribers).forEach(function(t){e.add(t.categories)}),e.get()}},{key:`onAttach`,value:function(e){var t=!e||this.position===e;this.attached=!0,this.position=e||this.position,M7(this.subscribers).forEach(function(e){e.subscriber.onAttach(t)})}},{key:`onDetach`,value:function(){this.attached=!1,M7(this.subscribers).forEach(function(e){e.subscriber.onDetach()})}},{key:`onComplete`,value:function(){this.attached=!1,M7(this.subscribers).forEach(function(e){e.subscriber.onComplete()})}},{key:`onFailure`,value:function(e){this.attached=!1,M7(this.subscribers).forEach(function(t){t.subscriber.onFailure(e)})}},{key:`onMessage`,value:function(e,t){this.setPosition(e),M7(this.subscribers).forEach(function(e){e.subscriber.onMessage(t)})}},{key:`log`,value:function(){var e;(e=this.logger).log.apply(e,arguments)}}])}(),r9=function(){function e(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;z2(this,e),$(this,`listener`,void 0),$(this,`defaultOptions`,void 0),$(this,`capabilities`,void 0),$(this,`callbackErrorHandler`,void 0),$(this,`alive`,!0),$(this,`connection`,void 0),$(this,`sessionId`,void 0),$(this,`subscriptions`,{}),$(this,`waitingSubscribes`,{}),$(this,`pendingSubscribes`,{}),$(this,`pendingUnsubscribes`,{}),$(this,`options`,void 0),$(this,`subscriberIdGenerator`,0),$(this,`numberOfReconnections`,0),$(this,`categories`,{}),$(this,`confirmedCategories`,void 0),$(this,`sentCategories`,void 0),$(this,`registerTimeout`,void 0),$(this,`logger`,void 0),this.listener=t,this.defaultOptions=n,this.capabilities=r,this.callbackErrorHandler=i,this.confirmedCategories={},this.sentCategories={},this.options=n,this.logger=a?a.create(`[Subscriptions]`):new W7,this.log(`Created: options:`,this.options)}return V2(e,[{key:`close`,value:function(){this.log(`Closed`),this.alive=!1,this.cancelRegisterTimeout()}},{key:`isAttached`,value:function(){return this.connection!==void 0}},{key:`isAuthenticated`,value:function(){return this.isAttached()&&this.sessionId!==void 0&&F7(this.sessionId,`A`)}},{key:`getOptions`,value:function(){return this.options}},{key:`getSessionId`,value:function(){return this.sessionId}},{key:`getChannels`,value:function(){return Object.keys(this.subscriptions)}},{key:`getSubscription`,value:function(e){return  __get$(this.subscriptions,e) }},{key:`getWaitingSubscribes`,value:function(){return Object.keys(this.waitingSubscribes)}},{key:`getPendingSubscribes`,value:function(){return Object.keys(this.pendingSubscribes)}},{key:`getPendingUnsubscribes`,value:function(){return Object.keys(this.pendingUnsubscribes)}},{key:`getNumberOfReconnections`,value:function(){return this.numberOfReconnections}},{key:`subscribe`,value:function(e,t,n){var r=this,i=(++this.subscriberIdGenerator).toString();return this.log(`Subscriber added: channel:${e}`),this.addSubscriber(e,i,t,n),{close:function(){r.log(`Subscriber removed: channel:${e}`),r.removeSubscriber(e,i)},update:function(t){r.updateSubscriber(e,i,t)}}}},{key:`addCapabilities`,value:function(e){var t=this,n=(++this.subscriberIdGenerator).toString();return this.log(`Capabilities Added: id:${e}`), __set$(this.categories,n,{capabilities:e}) ,this.checkCategories(),{close:function(){t.log(`Capabilities Removed: id:${e}`),delete t.categories[n],t.checkCategories()}}}},{key:`addActivities`,value:function(e){var t=this,n=(++this.subscriberIdGenerator).toString();return this.log(`Activities Added: id:${e}`), __set$(this.categories,n,{activities:e}) ,this.checkCategories(),{close:function(){t.log(`Activities Removed: id:${e}`),delete t.categories[n],t.checkCategories()}}}},{key:`onAttach`,value:function(e){if(this.alive){this.connection=e;var t=this.connection.getSessionId();this.log(`Attached: sessionId:${t}`),this.options=P7(this.defaultOptions,this.connection.getSessionOptions()),this.sessionId===void 0?(this.sessionId=t,this.listener.onConnect(),this.checkCategories(),this.attachToNewSession()):(this.numberOfReconnections++,this.listener.onAttach(),this.sessionId===t?(this.attachToExistentSession(),this.categoriesEquals(this.confirmedCategories,this.sentCategories)||this.pushCategories()):(this.sessionId=t,this.attachToNewSession(),this.pushCategories()))}}},{key:`onUpdate`,value:function(e){this.alive&&(this.options=P7(this.defaultOptions,e))}},{key:`onDetach`,value:function(){this.alive&&(this.log(`Detached:`),this.listener.onDetach(),this.connection=void 0,this.getSubscriptions().forEach(function(e){return e.onDetach()}))}},{key:`onMessage`,value:function(e,t,n){if(this.alive){this.log(`Message: channel:${e}, position:${t}, message:`,n);var r= __get$(this.subscriptions,e) ;r&&r.onMessage(t,n)}}},{key:`onPosition`,value:function(e,t){if(this.alive){this.log(`Position: channelPattern:${e}, position:${t}`);var n=e,r=``,i=e.indexOf(`$`);i>-1&&(n=e.substring(0,i),r=e.substring(i+1)),N7(this.subscriptions).forEach(function(e){var i=Q2(e,2),a=i[0],o=i[1];F7(a,n)&&I7(a,r)&&o.setPosition(t)})}}},{key:`onSubscribed`,value:function(e,t){if(this.alive){this.log(`Subscribed: channel:${e}, position:${t}`);var n= __get$(this.subscriptions,e) ;n&&(delete this.pendingSubscribes[e],n.onAttach(t)),this.pushkWaitingSubscribes()}}},{key:`onUnsubscribed`,value:function(e,t,n){var r=this;if(this.alive){this.log(`Unsubscribed: channel:${e}, reason:${t}`),delete this.pendingUnsubscribes[e];var i= __get$(this.subscriptions,e) ;if(i)if(t>=500)i.onDetach(),this.sendError($2.CHANNEL_FAILURE),setTimeout(function(){r.sendSubscribe(e,i.getPosition())},n||this.options.subscribeRetryTimoutMs);else if(t>=400){var a=$7(t,e,{sessionId:this.sessionId});i.onFailure(a),this.removeSubscription(e)}else t===204&&(i.onComplete(),this.removeSubscription(e))}}},{key:`onRegistered`,value:function(e,t){this.alive&&(this.confirmedCategories={capabilities:e,activities:t},this.log(`Registered: categories:`,this.confirmedCategories),this.categoriesEquals(this.confirmedCategories,this.sentCategories)&&this.cancelRegisterTimeout())}},{key:`addSubscriber`,value:function(e,t,n,r){this.connection||this.log(`Connection is not ready yet`),this.hasSubscription(e)||(this.createSubscription(e),this.sendSubscribe(e)), __get$(this.subscriptions,e) .addSubscriber(t,n,r),this.categoriesNonEmpty(r)&&this.checkCategories()}},{key:`updateSubscriber`,value:function(e,t,n){var r= __get$(this.subscriptions,e) ;r&&(r.updateSubscriber(t,n),this.checkCategoriesNow())}},{key:`removeSubscriber`,value:function(e,t){var n= __get$(this.subscriptions,e) ;n&&(n.removeSubscriber(t),n.isEmpty()&&(this.removeSubscription(e),this.sendUnsubscribe(e),this.pushkWaitingSubscribes(),this.checkCategoriesNow()))}},{key:`getCategories`,value:function(){var e=new e9;return e.add({capabilities:this.capabilities}),M7(this.categories).forEach(function(t){return e.add(t)}),M7(this.subscriptions).forEach(function(t){e.add(t.getCategories())}),e.get()}},{key:`attachToExistentSession`,value:function(){var e=this;N7(this.subscriptions).forEach(function(t){var n=Q2(t,2),r=n[0],i=n[1]; __get$(e.pendingSubscribes,r) ?e.sendSubscribe(r,i.getPosition()):i.onAttach()})}},{key:`attachToNewSession`,value:function(){var e=this;this.waitingSubscribes={},this.pendingSubscribes={},this.pendingUnsubscribes={},N7(this.subscriptions).forEach(function(t){var n=Q2(t,2),r=n[0],i=n[1];return e.sendSubscribe(r,i.getPosition())})}},{key:`getSubscriptions`,value:function(){return M7(this.subscriptions)}},{key:`sendError`,value:function(e){this.connection&&e!==$2.CHANNEL_FAILURE&&this.closeConnection(!1,e)}},{key:`sendSubscribe`,value:function(e,t){var n=this,r=Date.now();if(!this.pendingSubscribes.hasOwnProperty(e)&&Object.keys(this.pendingSubscribes).length>=this.options.maxPendingRequests){ __set$(this.waitingSubscribes,e,r) ;return}this.log(`Subscribe: channel:${e}, position:${t}`),delete this.waitingSubscribes[e], __set$(this.pendingSubscribes,e,r) ,this.connection&&(t?this.connection.subscribe(e,t):this.connection.subscribe(e),setTimeout(function(){n.alive&& __get$(n.pendingSubscribes,e) ===r&&n.sendError($2.SUBSCRIBE_TIMEOUT)},this.options.responseMaxDelayMs))}},{key:`sendUnsubscribe`,value:function(e){var t=this;this.log(`Unsubscribe: channel:${e}`);var n=Date.now(); __set$(this.pendingUnsubscribes,e,n) ,this.connection&&(this.connection.unsubscribe(e),setTimeout(function(){t.alive&& __get$(t.pendingUnsubscribes,e) ===n&&(delete t.pendingUnsubscribes[e],t.sendError($2.UNSUBSCRIBE_TIMEOUT))},this.options.responseMaxDelayMs))}},{key:`sendRegister`,value:function(e){this.log(`Register: categories:`,e),this.connection&&(this.sentCategories=e,this.connection.register(e.capabilities,e.activities),this.startRegisterTimeout())}},{key:`startRegisterTimeout`,value:function(){var e=this;this.cancelRegisterTimeout(),this.registerTimeout=setTimeout(function(){e.alive&&!e.categoriesEquals(e.confirmedCategories,e.sentCategories)&&e.sendError($2.REGISTER_TIMEOUT)},this.options.responseMaxDelayMs)}},{key:`cancelRegisterTimeout`,value:function(){this.registerTimeout&&=(clearTimeout(this.registerTimeout),void 0)}},{key:`pushkWaitingSubscribes`,value:function(){if(Object.keys(this.waitingSubscribes).length>0){var e=Object.keys(this.waitingSubscribes)[0];this.sendSubscribe(e, __get$(this.subscriptions,e) .getPosition())}}},{key:`hasSubscription`,value:function(e){return  __get$(this.subscriptions,e) !==void 0}},{key:`createSubscription`,value:function(e){delete this.pendingUnsubscribes[e], __set$(this.subscriptions,e,new n9(e,this.callbackErrorHandler,this.logger)) }},{key:`removeSubscription`,value:function(e){delete this.subscriptions[e],delete this.waitingSubscribes[e],delete this.pendingSubscribes[e],this.checkCategoriesNow()}},{key:`pushCategories`,value:function(){this.sentCategories=void 0,this.sendRegister(this.getCategories())}},{key:`checkCategories`,value:function(){var e=this;this.options.registerDelayMs?setTimeout(function(){return e.checkCategoriesNow()},this.options.registerDelayMs):this.checkCategoriesNow()}},{key:`checkCategoriesNow`,value:function(){var e=this.getCategories();this.categoriesEquals(this.sentCategories,e)||this.sendRegister(e)}},{key:`categoriesNonEmpty`,value:function(e){return e&&(e.capabilities&&e.capabilities.length>0||e.activities&&j7(e.activities).length>0)}},{key:`categoriesEquals`,value:function(e,t){return this.capabilitiesEquals(e,t)&&this.activitiesEquals(e,t)}},{key:`capabilitiesEquals`,value:function(e,t){var n=e&&e.capabilities?e.capabilities:[],r=t&&t.capabilities?t.capabilities:[],i=O7(n),a=O7(r);return this.setEquals(i,a)}},{key:`activitiesEquals`,value:function(e,t){var n=this,r=e&&e.activities?e.activities:{},i=t&&t.activities?t.activities:{},a=j7(r),o=j7(i);if(a.length!==o.length)return!1;var s=!0,c=O7(o);return N7(r).forEach(function(e){var t=Q2(e,2),i=t[0],a=t[1];if(c.has(i)||(s=!1),s){var o=O7(a),l=O7( __get$(r,i) );n.setEquals(o,l)||(s=!1)}}),s}},{key:`setEquals`,value:function(e,t){if(e.size!==t.size)return!1;var n=!0;return e.forEach(function(e){t.has(e)||(n=!1)}),n}},{key:`closeConnection`,value:function(e,t){this.connection&&=(this.connection.close(e,t),void 0)}},{key:`log`,value:function(){var e;(e=this.logger).log.apply(e,arguments)}}])}(),i9={},a9={},o9={},s9={};Object.defineProperty(s9,`__esModule`,{value:!0});function c9(e,t){if(!e)throw Error(t?`assertion failed: `+t:`assertion failed`)}s9.assert=c9;function l9(){if(typeof self<`u`)return self;if(typeof window<`u`)return window;if(a4!==void 0)return a4;var e;try{e=Function(`return this`)()}catch{}return e}s9.getGlobal=l9,(function(e){Object.defineProperty(e,`__esModule`,{value:!0});var t=s9,n=function(){function e(){this.length=0,this._max=1e3,this._first=0}return e.prototype.push=function(e,t){return  __set$(this,this.length++,e) , __set$(this,this.length++,t) ,this.length<this._max},e.prototype.flush=function(){for(;this._first<this.length;){var e= __get$(this,this._first) ,t= __get$(this,this._first+1) ; __set$(this,this._first,__set$(this,this._first+1,void 0)) ,this._first+=2,e(t)}this.length=0,this._first=0},e.prototype.empty=function(){return this._first===this.length},e}(),r=function(){function e(e){this._ring=[new n],this._current=this._ring[0],this._pool=e}return e.prototype.enqueue=function(e,t){this._current||(this._current=this._pool.pop(),this._current||=new n,this._ring.push(this._current)),this._current.push(e,t)||(this._current=void 0)},e.prototype.flush=function(){for(;this._ring[0].flush(),this._ring.length!==1;)this._pool.push(this._ring.shift());this._current=this._ring[0]},e.prototype.empty=function(){return this._ring.length===1&&this._ring[0].empty()},e}();function i(e){typeof setImmediate==`function`?setImmediate(e):setTimeout(e,0)}var a=function(){function e(){var e=this;this._pool=[],this._mainRing=new r(this._pool),this._idleRing=new r(this._pool),this._flushing=!1,this._scheduled=!1,this._scheduler=void 0,this._flusher=function(){return e._scheduledFlush()}}return e.prototype.setScheduler=function(e){t.assert(e==null||typeof e==`function`),this._scheduler=e},e.prototype.enqueue=function(e,t){!this._flushing&&!this._scheduled&&this._schedule(),this._mainRing.enqueue(e,t)},e.prototype.enqueueIdle=function(e,t){!this._flushing&&!this._scheduled&&this._schedule(),this._idleRing.enqueue(e,t)},e.prototype.flush=function(){t.assert(!this._flushing,`cannot recursively flush`),this._flushing=!0;try{for(;this._mainRing.flush(),!this._idleRing.empty();){var e=this._mainRing;this._mainRing=this._idleRing,this._idleRing=e}}finally{this._flushing=!1,(!this._mainRing.empty()||!this._idleRing.empty())&&!this._scheduled&&this._schedule()}},e.prototype._schedule=function(){t.assert(!this._scheduled),(this._scheduler||i)(this._flusher),this._scheduled=!0},e.prototype._scheduledFlush=function(){this._scheduled=!1,this.flush()},e}();e.Async=a,e.async=new a,e.default=e.async})(o9);var u9={},d9={},Gee=a4&&a4.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&( __set$(e,n,__get$(t,n)) )},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(d9,`__esModule`,{value:!0}),d9.default=function(e){Gee(t,e);function t(t,n){var r=this.constructor,i=e.call(this,n)||this,a=!1;if(i.constructor!==r&&(Object.setPrototypeOf&&Object.setPrototypeOf(i,r.prototype),a=!0),`stack`in i||(a=!0),i.name=t,a)if(Error.captureStackTrace)Error.captureStackTrace(i,r);else{var o=Error(n);o.name=t;try{throw o}catch(e){i.stack=e.stack||String(e)}}return i}return t}(Error);var f9=a4&&a4.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&( __set$(e,n,__get$(t,n)) )},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(u9,`__esModule`,{value:!0});var Kee=d9,qee=s9,p9=function(e){f9(t,e);function t(t,n,r){var i=e.call(this,t,n+`: `+r)||this;i.reason=r;var a=i.reason&&s4(i.reason)===`object`&&i.reason.stack;return typeof a!=`string`&&(a=String(i.reason)),i.stack=i.name+`: `+a,i}return t}(Kee.default);u9.BaseUnhandledRejection=p9;var m9=function(e){f9(t,e);function t(t,n){var r=e.call(this,`UnhandledRejection`,`unhandled rejection`,t)||this;return r.trace=n,r}return t}(p9);u9.UnhandledRejection=m9;var h9=function(e){f9(t,e);function t(t){var n=e.call(this,`PossiblyUnhandledRejection`,`possibly unhandled rejection`,t.reason())||this;return n.promise=t,n}return t}(p9);u9.PossiblyUnhandledRejection=h9;function g9(e,t,n){var r=new PromiseRejectionEvent(e,{cancelable:!0,promise:!0,reason:t});Object.defineProperty(r,`promise`,{value:n});var i=qee.getGlobal();return!!(i.dispatchEvent&&!i.dispatchEvent(r))}function Jee(e,t){throw new m9(e,t)}u9.defaultUnhandledRejectionHandler=Jee;function Yee(e){var t=!0;if(typeof process<`u`&&typeof process.emit==`function`?process.emit(`unhandledRejection`,e.reason(),e)&&(t=!1):typeof PromiseRejectionEvent==`function`&&g9(`unhandledrejection`,e.reason(),e)&&(t=!1),t){var n=new h9(e);console.warn(n.stack)}}u9.defaultPossiblyUnhandledRejectionHandler=Yee;function Xee(e){typeof process<`u`&&typeof process.emit==`function`?process.emit(`rejectionHandled`,e):typeof PromiseRejectionEvent==`function`&&g9(`rejectionhandled`,e.reason(),e)}u9.defaultPossiblyUnhandledRejectionHandledHandler=Xee;var _9={},v9={};Object.defineProperty(v9,`__esModule`,{value:!0});var Zee=typeof Error.captureStackTrace==`function`;v9.default=function(){function e(t){t===void 0&&(t=e),Zee?Error.captureStackTrace(this,t):this.stack=`dummy
<no trace>`}return e.prototype.inspect=function(){var e=this.stack.split(`
`);return e.shift(),e.join(`
`)},e}(),Object.defineProperty(_9,`__esModule`,{value:!0});var Qee=v9;_9.default=function(){function e(t){t===void 0&&(t=e),this.stack=new Qee.default(t)}return e.prototype.setSource=function(t){t.sources?(this.sources=t.sources.concat(t.stack),this.sources.length>e.traceLimit&&(this.sources=this.sources.slice(0,e.traceLimit))):this.sources=[t.stack]},e.prototype.inspect=function(){var e=this.stack.inspect();if(this.sources)for(var t=this.sources.length-1;t>=0;t--)e+=`
  from previous:
`+ __get$(this.sources,t) .inspect();return e},e.traceLimit=10,e}(),Object.defineProperty(a9,`__esModule`,{value:!0});var y9=o9,b9=u9,x9=_9,S9=s9,C9,w9=!1,$ee;(function(e){ __set$(e,e.Pending=0,`Pending`) , __set$(e,e.Fulfilled=1,`Fulfilled`) , __set$(e,e.Rejected=2,`Rejected`) })($ee||={});var ete;(function(e){ __set$(e,e.RejectionHandled=1,`RejectionHandled`) , __set$(e,e.UnhandledRejectionNotified=2,`UnhandledRejectionNotified`) })(ete||={});function T9(e,t){}function E9(){}var D9={error:void 0};function O9(e){return e}var tte=new x9.default,k9,nte=0,A9=function(){function e(t){var n=this;if(this._id=nte++,this._state=0,this._result=void 0,this._handlers=void 0,this._flags=0,this._trace=void 0,C9&&C9(this,`construct`),w9&&(this._trace=new x9.default(e),k9&&this._setSource(k9)),t!==T9){if(typeof t!=`function`)throw TypeError(`Promise resolver is not a function`);var r=!1;try{t(function(e){r||(r=!0,n._resolve(e))},function(e){r||(r=!0,n._reject(O9(e)))})}catch(e){r||(r=!0,this._reject(O9(e)))}}}return e.prototype.then=function(e,t){if(C9&&C9(this,`then(`+s4(e)+`, `+s4(t)+`)`),this._state===1&&typeof e!=`function`||this._state===2&&typeof t!=`function`)return this;var n=new(Object.getPrototypeOf(this)).constructor(T9);return n._setSource(this),this._enqueue(e,t,n,void 0),n},e.prototype.done=function(e,t){if(C9&&C9(this,`done(`+s4(e)+`, `+s4(t)+`)`),!(this._state===1&&typeof e!=`function`)){var n=tte;w9&&(n=new x9.default,this._trace&&n.setSource(this._trace)),this._enqueue(e,t,void 0,n)}},e.prototype.catch=function(){if(arguments.length===1){var t=arguments[0];return this.then(void 0,t)}else{var n=arguments[0],r=arguments[1];return this.then(void 0,function(t){var i=!1;if(typeof n==`function`)i=n.prototype instanceof Error||n===Error?t instanceof n:n(t);else if(Array.isArray(n)){for(var a=0,o=n;a<o.length;a++)if(t instanceof  __get$(o,a) ){i=!0;break}}else throw TypeError(`invalid predicate to .catch(), got `+s4(n));return i?r(t):e.reject(t)})}},e.prototype.finally=function(e){var t=this,n=function(){return e(t)};return this.then(n,n).return(this)},e.prototype.isFulfilled=function(){return this._state===1},e.prototype.isRejected=function(){return this._state===2},e.prototype.isPending=function(){return this._state===0},e.prototype.value=function(){if(!this.isFulfilled())throw Error(`Promise is not fulfilled`);return this._result},e.prototype.reason=function(){if(!this.isRejected())throw Error(`Promise is not rejected`);return this._result},e.prototype.suppressUnhandledRejections=function(){this._setRejectionHandled()},e.prototype.inspect=function(){return this.toString()},e.prototype.toString=function(){var e;switch(this._state){case 0:e=`pending`;break;case 1:e=`fulfilled`;break;case 2:e=`rejected`;break;default:e=`unknown`}return`[Promise `+this._id+`: `+e+`]`},e.prototype.delay=function(t){return this.then(function(n){return new e(function(e){setTimeout(function(){return e(n)},t)})})},e.prototype.return=function(e){return e===void 0?this.then(E9):this.then(function(){return e})},e.prototype.throw=function(t){return this.then(function(){return e.reject(t)})},e.prototype._setSource=function(e){!this._trace||!e._trace||this._trace.setSource(e._trace)},e.prototype._resolve=function(t){if(S9.assert(this._state===0),!t){this._fulfill(t);return}if(this===t){this._reject(TypeError(`cannot resolve Promise to self`));return}if(t instanceof e){t._setSource(this),t._setRejectionHandled(),t._state===0?this._followPromise(t):t._state===1?this._fulfill(t._result):this._reject(t._result);return}if(s4(t)===`object`||typeof t==`function`){var n=this._tryGetThen(t);if(n===D9){this._reject(O9(D9.error));return}if(typeof n==`function`){this._followThenable(t,n);return}}this._fulfill(t)},e.prototype._tryGetThen=function(e){try{return e.then}catch(e){return D9.error=e,D9}},e.prototype._fulfill=function(e){S9.assert(this._state===0),C9&&C9(this,`_fulfill(`+s4(e)+`)`),this._state=1,this._result=e,this._flush()},e.prototype._reject=function(t){if(S9.assert(this._state===0),C9&&C9(this,`_reject(`+t+`)`),this._state=2,this._result=t,this._trace&&this._result instanceof Error&&!this._result.trace){var n=this._trace;this._result.trace=n;var r=this._result.stack;r&&Object.defineProperty(this._result,`stack`,{enumerable:!1,get:function(){return r+`
  from Promise at:
`+n.inspect()}})}this._flags&1||y9.default.enqueueIdle(e._unhandledRejectionChecker,this),this._flush()},e.prototype._setRejectionHandled=function(){!(this._flags&1)&&this._flags&2&&y9.default.enqueue(e._onPossiblyUnhandledRejectionHandledHandler,this),this._flags|=1,C9&&C9(this,`rejectionHandled`)},e.prototype._doCheckUnhandledRejection=function(){!(this._flags&1)&&!(this._flags&2)&&(this._flags|=2,y9.default.enqueue(e._onPossiblyUnhandledRejectionHandler,this))},e.prototype._followPromise=function(e){S9.assert(this._state===0),C9&&C9(this,`_follow([Promise `+e._id+`])`),e._enqueue(void 0,void 0,this,void 0)},e.prototype._followThenable=function(e,t){var n=this;S9.assert(this._state===0),C9&&C9(this,`_follow([Thenable])`);var r=!1;try{t.call(e,function(e){r||(r=!0,n._resolve(e))},function(e){r||(r=!0,n._reject(O9(e)))})}catch(e){r||(r=!0,this._reject(O9(e)))}},e.prototype._enqueue=function(t,n,r,i){var a={promise:this,onFulfilled:t,onRejected:n,slave:r,done:i};if(this._state!==0)y9.default.enqueue(e._unwrapper,a);else if(!this._handlers)this._handlers=[a];else{var o=this._handlers.length; __set$(this._handlers,o,a) }this._setRejectionHandled()},e.prototype._flush=function(){if(this._handlers){var t=0,n=this._handlers,r=n.length;for(this._handlers=void 0;t<r;)y9.default.enqueue(e._unwrapper, __get$(n,t++) )}},e.prototype._unwrap=function(t){var n=this._state===1?t.onFulfilled:t.onRejected;if(t.done){if(C9&&C9(this,`_unwrap()`),typeof n!=`function`){this._state===2&&e._onUnhandledRejectionHandler(this._result,t.done);return}S9.assert(!k9),k9=this;try{var r=n(this._result);r&&(r instanceof e?r:e.resolve(r)).done(),k9=void 0}catch(n){k9=void 0,e._onUnhandledRejectionHandler(n,t.done)}return}var i=t.slave;if(C9&&C9(this,`_unwrap(`+i._id+`)`),typeof n==`function`){S9.assert(!k9),k9=i;try{i._resolve(n(this._result))}catch(e){i._reject(O9(e))}k9=void 0}else this._state===1?i._fulfill(this._result):i._reject(this._result)},e.resolve=function(t){var n=new e(T9);return n._resolve(t),n},e.reject=function(t){var n=new e(T9);return n._reject(t),n},e.all=function(t){return  new e(function(n,r){if(S9.assert(Array.isArray(t),`thenables must be an Array`),t.length===0){n([]);return;}for(var i=Array(t.length),a=t.length,o=0;o<t.length;o++)s(__get$(t,o),o);function s(t,o){(t instanceof e?t:e.resolve(t)).done(function(e){__set$(i,o,e),a--,a===0&&n(i);},function(e){return r(e);});}}) },e.race=function(t){return  new e(function(n,r){S9.assert(Array.isArray(t),`thenables must be an Array`);for(var i=0,a=t;i<a.length;i++){var o=__get$(a,i),s=o instanceof e?o:e.resolve(o);e.resolve(s).done(n,r);}}) },e.defer=function(){var t,n;return{promise:new e(function(e,r){t=e,n=r}),reject:n,resolve:t}},e.delay=function(){if(arguments[1]===void 0){var t=arguments[0];return new e(function(e){setTimeout(e,t)})}return e.resolve(arguments[0]).delay(arguments[1])},e.onUnhandledRejection=function(t){if(t===!0)e._onUnhandledRejectionHandler=b9.defaultUnhandledRejectionHandler;else if(t===!1)e._onUnhandledRejectionHandler=E9;else if(typeof t!=`function`)throw TypeError(`invalid handler: boolean or function expected`);else e._onUnhandledRejectionHandler=t},e.onPossiblyUnhandledRejection=function(t){if(t===!0)e._onPossiblyUnhandledRejectionHandler=b9.defaultPossiblyUnhandledRejectionHandler;else if(t===!1)e._onPossiblyUnhandledRejectionHandler=E9;else if(typeof t!=`function`)throw TypeError(`invalid handler: boolean or function expected`);else e._onPossiblyUnhandledRejectionHandler=t},e.onPossiblyUnhandledRejectionHandled=function(t){if(t===!0)e._onPossiblyUnhandledRejectionHandledHandler=b9.defaultPossiblyUnhandledRejectionHandledHandler;else if(t===!1)e._onPossiblyUnhandledRejectionHandledHandler=E9;else if(typeof t!=`function`)throw TypeError(`invalid handler: boolean or function expected`);else e._onPossiblyUnhandledRejectionHandledHandler=t},e.setLongTraces=function(e){w9=e},e.setTracer=function(e){C9=typeof e==`function`?e:void 0},e.flush=function(){y9.default.flush()},e._unwrapper=function(e){e.promise._unwrap(e)},e._unhandledRejectionChecker=function(e){e._doCheckUnhandledRejection()},e}();a9.Promise=A9,A9.onUnhandledRejection(!0),A9.onPossiblyUnhandledRejection(!0),A9.onPossiblyUnhandledRejectionHandled(!0),a9.default=A9;var j9={};Object.defineProperty(j9,`__esModule`,{value:!0});var M9=a9,rte=s9;function ite(e){e===void 0&&(e=!1);var t=rte.getGlobal();return t?e||typeof t.Promise!=`function`?(t.Promise=M9.Promise,!0):t.Promise instanceof M9.Promise:!1}j9.default=ite,Object.defineProperty(i9,`__esModule`,{value:!0});var N9=a9,ate=i9.default=N9.default;i9.Promise=N9.Promise,i9.Trace=_9.default;var P9=u9;i9.UnhandledRejection=P9.UnhandledRejection,i9.PossiblyUnhandledRejection=P9.PossiblyUnhandledRejection,i9.UnhandledRejectionError=u9.UnhandledRejection,i9.polyfill=j9.default,i9.BaseError=d9.default;var ote=function(){function e(){z2(this,e)}return V2(e,[{key:`schedule`,value:function(e){return new ate(function(t){setTimeout(t,e)})}}])}(),F9={},I9={};Object.defineProperty(I9,`__esModule`,{value:!0}),I9.BaseEvent=function(){function e(){}return e.prototype.attach=function(e,t){return this._attach(e,t,!1)},e.prototype.once=function(e,t){return this._attach(e,t,!0)},e.prototype._attach=function(e,t,n){var r=this,i,a,o,s;if(typeof e==`function`)a=e,s=function(){return r.detach(a)};else if(!t&&typeof e.post==`function`)o=e,s=function(){return r.detach(o)};else{if(s4(e)!==`object`||e===void 0)throw Error(`Expect a function or object as first argument`);if(typeof t!=`function`)throw Error(`Expect a function as second argument`);i=e,a=t,s=function(){return r.detach(i,a)}}return this._listeners?this._listeners=this._listeners.slice():this._listeners=[],this._listeners.push({deleted:!1,boundTo:i,handler:a,event:o,once:n}),s},e.prototype.detach=function(){var e=[...arguments];this._detach.apply(this,e)},e.prototype._detach=function(){var e=[...arguments];if(!(!this._listeners||this._listeners.length===0)){var t,n,r;e.length>=1&&(typeof e[0]==`function`?n=e[0]:e.length===1&&typeof e[0].post==`function`?r=e[0]:t=e[0]),e.length>=2&&(n=e[1]),this._listeners=this._listeners.filter(function(e){return(n===void 0||e.handler===n)&&(r===void 0||e.event===r)&&(t===void 0||e.boundTo===t)?(e.deleted=!0,!1):!0}),this._listeners.length===0&&delete this._listeners}},e.prototype.post=function(e){throw Error(`abstract`)},e.prototype.listenerCount=function(){return this._listeners?this._listeners.length:0},e.prototype._call=function(e,t){this._listeners&&(e.deleted||(e.once&&(e.deleted=!0,this._listeners=this._listeners.filter(function(t){return t!==e}),this._listeners.length===0&&delete this._listeners),e.event?e.event.post.apply(e.event,t):e.handler&&e.handler.apply(s4(e.boundTo)===`object`?e.boundTo:this,t)))},e}();var L9={},R9=a4&&a4.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&( __set$(e,n,__get$(t,n)) )},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(L9,`__esModule`,{value:!0});var z9=function(e){R9(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;return t._recursion=0,t}return Object.defineProperty(t.prototype,`evtListenersChanged`,{get:function(){return this._listenersChanged||=new B9,this._listenersChanged},enumerable:!0,configurable:!0}),t.prototype.post=function(){var e=[...arguments];if(!(!this._listeners||this._listeners.length===0)){if(this._recursion++,typeof t.MAX_RECURSION_DEPTH==`number`&&Number.isInteger(t.MAX_RECURSION_DEPTH)&&t.MAX_RECURSION_DEPTH>0&&this._recursion>t.MAX_RECURSION_DEPTH)throw Error(`event fired recursively`);for(var n=this._listeners,r=0;r<n.length;++r){var i= __get$(n,r) ;this._call(i,e)}this._recursion--}},t.prototype._attach=function(t,n,r){var i,a,o=(i=this._listeners?.length,i??0),s=e.prototype._attach.call(this,t,n,r);return this.evtListenersChanged&&o!==(a=this._listeners?.length,a??0)&&this.evtListenersChanged.post(),s},t.prototype._detach=function(){var t=[...arguments],n,r,i=(n=this._listeners?.length,n??0),a=e.prototype._detach.apply(this,t);return this.evtListenersChanged&&i!==(r=this._listeners?.length,r??0)&&this.evtListenersChanged.post(),a},t.MAX_RECURSION_DEPTH=10,t}(I9.BaseEvent);L9.SyncEvent=z9;var B9=function(e){R9(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.post=function(){e.prototype.post.call(this,void 0)},t}(z9);L9.VoidSyncEvent=B9,L9.ErrorSyncEvent=function(e){R9(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.post=function(t){if(this.listenerCount()===0)throw Error(`error event posted while no listeners attached. Error: `+t.message);e.prototype.post.call(this,t)},t}(z9);var V9={},H9={};Object.defineProperty(H9,`__esModule`,{value:!0});var U9=L9;H9.default=function(){function e(){this.evtFilled=new U9.SyncEvent,this.evtDrained=new U9.SyncEvent,this._queue=[],this._flushing=!1}return e.global=function(){return e._instance||e.resetGlobal(),e._instance},e.resetGlobal=function(){e._instance=new e},e.prototype.empty=function(){return this._queue.length===0},e.prototype.add=function(e){this._queue.push(e),this._queue.length===1&&!this._flushing&&this.evtFilled.post(this)},e.prototype.flushOnce=function(){var e=this._queue.length===0,t=this._flushing;this._flushing=!0;try{var n=this._queue;this._queue=[];for(var r=0;r<n.length;++r) __call$(n,r,[]) }finally{this._flushing=t,!e&&!t&&this._queue.length===0&&this.evtDrained.post(this)}},e.prototype.flush=function(e){e===void 0&&(e=10);var t=this._queue.length===0,n=this._flushing;this._flushing=!0;try{for(var r=0;this._queue.length>0;){if(typeof e==`number`&&r>=e)throw this._queue=[],Error(`unable to flush the queue due to recursively added event. Clearing queue now`);this.flushOnce(),++r}}finally{this._flushing=n,!t&&!n&&this._queue.length===0&&this.evtDrained.post(this)}},e}();var W9=a4&&a4.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&( __set$(e,n,__get$(t,n)) )},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(V9,`__esModule`,{value:!0});var ste=I9,cte=H9,lte=L9,G9=function(e){W9(t,e);function t(t){t===void 0&&(t={});var n=e.call(this)||this;return n._queued=!1,n.options=t,typeof t.condensed==`boolean`?n._condensed=t.condensed:n._condensed=!1,s4(t.queue)===`object`&&t.queue!==null&&(n._queue=t.queue),n}return Object.defineProperty(t.prototype,`evtListenersChanged`,{get:function(){return this._listenersChanged||=new lte.VoidSyncEvent,this._listenersChanged},enumerable:!0,configurable:!0}),t.prototype.post=function(){for(var e=this,t=[],n=0;n<arguments.length;n++) __set$(t,n,__get$(arguments,n)) ;if(!(!this._listeners||this._listeners.length===0)){var r=this._queue?this._queue:cte.default.global();if(this._condensed){if(this._queuedData=t,this._queuedListeners=this._listeners,this._queued)return;this._queued=!0,r.add(function(){e._queued=!1;for(var t=e._queuedData,n=e._queuedListeners,r=0;r<n.length;++r){var i= __get$(n,r) ;e._call(i,t)}})}else{var i=this._listeners;r.add(function(){for(var n=0;n<i.length;++n){var r= __get$(i,n) ;e._call(r,t)}})}}},t.prototype._attach=function(t,n,r){var i,a,o=(i=this._listeners?.length,i??0),s=e.prototype._attach.call(this,t,n,r);return this.evtListenersChanged&&o!==(a=this._listeners?.length,a??0)&&this.evtListenersChanged.post(),s},t.prototype._detach=function(){var t=[...arguments],n,r,i=(n=this._listeners?.length,n??0),a=e.prototype._detach.apply(this,t);return this.evtListenersChanged&&i!==(r=this._listeners?.length,r??0)&&this.evtListenersChanged.post(),a},t}(ste.BaseEvent);V9.QueuedEvent=G9,V9.VoidQueuedEvent=function(e){W9(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.post=function(){e.prototype.post.call(this,void 0)},t}(G9),V9.ErrorQueuedEvent=function(e){W9(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.post=function(t){if(!this._listeners||this._listeners.length===0)throw Error(`error event posted while no listeners attached. Error: `+t.message);e.prototype.post.call(this,t)},t}(G9);var K9={},q9=a4&&a4.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&( __set$(e,n,__get$(t,n)) )},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(K9,`__esModule`,{value:!0});var ute=I9,dte=L9,J9=function(e){q9(t,e);function t(t){t===void 0&&(t={});var n=e.call(this)||this;return n._queued=!1,n.options=t,typeof t.condensed==`boolean`?n._condensed=t.condensed:n._condensed=!1,n}return Object.defineProperty(t.prototype,`evtListenersChanged`,{get:function(){return this._listenersChanged||=new dte.VoidSyncEvent,this._listenersChanged},enumerable:!0,configurable:!0}),t.defaultScheduler=function(e){typeof window<`u`?setTimeout(e,0):setImmediate(e)},t.setScheduler=function(e){t._scheduler=e},t.prototype.post=function(){for(var e=this,n=[],r=0;r<arguments.length;r++) __set$(n,r,__get$(arguments,r)) ;if(!(!this._listeners||this._listeners.length===0))if(this._condensed){if(this._queuedData=n,this._queuedListeners=this._listeners,this._queued)return;this._queued=!0,t._scheduler(function(){e._queued=!1;for(var t=e._queuedData,n=e._queuedListeners,r=0;r<n.length;++r){var i= __get$(n,r) ;e._call(i,t)}})}else{var i=this._listeners;t._scheduler(function(){for(var t=0;t<i.length;++t){var r= __get$(i,t) ;e._call(r,n)}})}},t.prototype._call=function(n,r){n.event&&n.event instanceof t?n.event._postDirect(r):e.prototype._call.call(this,n,r)},t.prototype._postDirect=function(e){if(!(!this._listeners||this._listeners.length===0))for(var t=this._listeners,n=0;n<t.length;++n){var r= __get$(t,n) ;this._call(r,e)}},t.prototype._attach=function(t,n,r){var i,a,o=(i=this._listeners?.length,i??0),s=e.prototype._attach.call(this,t,n,r);return this.evtListenersChanged&&o!==(a=this._listeners?.length,a??0)&&this.evtListenersChanged.post(),s},t.prototype._detach=function(){var t=[...arguments],n,r,i=(n=this._listeners?.length,n??0),a=e.prototype._detach.apply(this,t);return this.evtListenersChanged&&i!==(r=this._listeners?.length,r??0)&&this.evtListenersChanged.post(),a},t._scheduler=t.defaultScheduler,t}(ute.BaseEvent);K9.AsyncEvent=J9,K9.VoidAsyncEvent=function(e){q9(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.post=function(){e.prototype.post.call(this,void 0)},t}(J9),K9.ErrorAsyncEvent=function(e){q9(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.post=function(t){if(this.listenerCount()===0)throw Error(`error event posted while no listeners attached. Error: `+t.message);e.prototype.post.call(this,t)},t}(J9);var Y9={},X9={};Object.defineProperty(X9,`__esModule`,{value:!0});function fte(e,t){if(e===t)return!0;if(s4(e)!==s4(t))return!1;switch(s4(e)){case`boolean`:case`number`:case`string`:case`function`:case`symbol`:case`undefined`:return!1;case`object`:if(e===null||t===null)return!1;if(Array.isArray(e)||Array.isArray(t)){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if( __get$(e,n) !== __get$(t,n) )return!1;return!0}var r=[],i=[];for(var a in e)e.hasOwnProperty(a)&&r.push(a);for(var o in t)t.hasOwnProperty(o)&&i.push(o);if(r.sort(),i.sort(),r.join(`,`)!==i.join(`,`))return!1;for(var n=0;n<r.length;++n)if( __get$(e,__get$(r,n)) !== __get$(t,__get$(r,n)) )return!1;return!0;default:return!1}}X9.shallowEquals=fte,(function(e){var t=a4&&a4.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&( __set$(e,n,__get$(t,n)) )},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,`__esModule`,{value:!0});var n=X9,r=L9,i=K9,a=V9,o;(function(e){ __set$(e,e.Sync=0,`Sync`) , __set$(e,e.Async=1,`Async`) , __set$(e,e.Queued=2,`Queued`) })(o=e.EventType||={});var s=function(){function e(e){this._events=[],e&&e.monitorAttach&&(this.evtFirstAttached=new c,this.evtLastDetached=new c)}return Object.defineProperty(e.prototype,`evtListenersChanged`,{get:function(){return this._listenersChanged||=new r.VoidSyncEvent,this._listenersChanged},enumerable:!0,configurable:!0}),e.prototype.attach=function(){var e=[...arguments],t=o.Sync;e.length>0&&typeof e[0]==`number`&&(t=e.shift());var n=this,r,i,a;return typeof e[0]==`function`||e[0]&&s4(e[0])===`object`&&typeof e[0].post==`function`?(typeof e[0]==`function`?r=e[0]:a=e[0],i=e[1]):(n=e[0],r=e[1],i=e[2]),this._attach(t,n,r,a,i,!1)},e.prototype.once=function(){var e=[...arguments],t=o.Sync;e.length>0&&typeof e[0]==`number`&&(t=e.shift());var n=this,r,i,a;return typeof e[0]==`function`||e[0]&&s4(e[0])===`object`&&typeof e[0].post==`function`?(typeof e[0]==`function`?r=e[0]:a=e[0],i=e[1]):(n=e[0],r=e[1],i=e[2]),this._attach(t,n,r,a,i,!0)},e.prototype._attach=function(e,t,s,c,l,u){var d=this,f=this.evtFirstAttached?this.listenerCount():0,p;switch(e){case o.Sync:for(var m=0,h=this._events;m<h.length;m++){var g= __get$(h,m) ;g instanceof r.SyncEvent&&(p=g)}p||(p=new r.SyncEvent,this._events.push(p));break;case o.Async:for(var _=0,v=this._events;_<v.length;_++){var g= __get$(v,_) ;g instanceof i.AsyncEvent&&n.shallowEquals(g.options,l)&&(p=g)}p||(p=new i.AsyncEvent(l),this._events.push(p));break;case o.Queued:for(var y=0,b=this._events;y<b.length;y++){var g= __get$(b,y) ;g instanceof a.QueuedEvent&&n.shallowEquals(g.options,l)&&(p=g)}p||(p=new a.QueuedEvent(l),this._events.push(p));break;default:throw Error(`unknown EventType`)}var x=u?c?p.once(c):p.once(t,s):c?p.attach(c):p.attach(t,s);return this.evtFirstAttached&&f===0&&this.evtFirstAttached.post(),this.evtListenersChanged&&f!==this.listenerCount()&&this.evtListenersChanged.post(),function(){var e=d.evtLastDetached?d.listenerCount():0;x(),d.evtLastDetached&&e>0&&d.listenerCount()===0&&d.evtLastDetached.post(),d.evtListenersChanged&&e!==d.listenerCount()&&d.evtListenersChanged.post()}},e.prototype.attachSync=function(){var e=[...arguments];return e.unshift(o.Sync),this.attach.apply(this,e)},e.prototype.onceSync=function(){var e=[...arguments];return e.unshift(o.Sync),this.once.apply(this,e)},e.prototype.attachAsync=function(){var e=[...arguments];return e.unshift(o.Async),this.attach.apply(this,e)},e.prototype.onceAsync=function(){var e=[...arguments];return e.unshift(o.Async),this.once.apply(this,e)},e.prototype.attachQueued=function(){var e=[...arguments];return e.unshift(o.Queued),this.attach.apply(this,e)},e.prototype.onceQueued=function(){var e=[...arguments];return e.unshift(o.Queued),this.once.apply(this,e)},e.prototype.detach=function(){for(var e=[...arguments],t=this.listenerCount(),n=0;n<this._events.length;++n) __get$(this._events,n) .detach.apply( __get$(this._events,n) ,e);this.evtListenersChanged&&t!==this.listenerCount()&&this.evtListenersChanged.post(),this.evtLastDetached&&t>0&&this.listenerCount()===0&&this.evtLastDetached.post()},e.prototype.post=function(e){for(var t=[],n=0;n<this._events.length;++n)t.push( __get$(this._events,n) );for(var n=0;n<t.length;++n) __get$(t,n) .post(e)},e.prototype.listenerCount=function(){for(var e=0,t=0;t<this._events.length;++t)e+= __get$(this._events,t) .listenerCount();return e},e}();e.AnyEvent=s;var c=function(e){t(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.post=function(){e.prototype.post.call(this,void 0)},n}(s);e.VoidAnyEvent=c,e.ErrorAnyEvent=function(e){t(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.post=function(t){if(this.listenerCount()===0)throw Error(`error event posted while no listeners attached. Error: `+t.message);e.prototype.post.call(this,t)},n}(s)})(Y9),(function(e){function t(t){for(var n in t)e.hasOwnProperty(n)||( __set$(e,n,__get$(t,n)) )}Object.defineProperty(e,`__esModule`,{value:!0}),t(I9),t(L9),t(V9),t(K9),t(Y9);var n=H9;e.EventQueue=H9.default;function r(){return n.default.global()}e.queue=r;function i(){n.default.global().flushOnce()}e.flushOnce=i;function a(e){e===void 0&&(e=10),n.default.global().flush(e)}e.flush=a})(F9);var Z9;(function(e){e.UNAUTHENTICATED=4001})(Z9||={});var pte=function(){function e(t,n,r,i,a,o,s){var c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:new W7;z2(this,e),$(this,`connectionFactory`,void 0),$(this,`socketFactory`,void 0),$(this,`timer`,void 0),$(this,`url`,void 0),$(this,`params`,void 0),$(this,`defaultOptions`,void 0),$(this,`listener`,void 0),$(this,`logger`,void 0),$(this,`alive`,!0),$(this,`socketIdGenerator`,0),$(this,`numberOfConnectionAttempts`,0),$(this,`options`,void 0),$(this,`online`,!0),$(this,`quality`,i4.OFFLINE),$(this,`qualityEvent`,new F9.AsyncEvent),$(this,`socket`,void 0),$(this,`connection`,void 0),$(this,`sessionId`,void 0),$(this,`sessionOffset`,void 0),$(this,`previousConnectionError`,void 0),this.connectionFactory=t,this.socketFactory=n,this.timer=r,this.url=i,this.params=a,this.defaultOptions=o,this.listener=s,this.logger=c,this.options=o,this.log(`Created: options:`,this.options)}return V2(e,[{key:`getOptions`,value:function(){return this.options}},{key:`setOnline`,value:function(e){var t=this.online;this.online=e,!e&&t&&this.connection&&(this.closeConnection($2.CLIENT_OFFLINE),this.closeSocket()),!e&&t&&this.socket&&this.closeSocket(),e&&!t&&this.reconnect()}},{key:`getQuality`,value:function(){return this.quality}},{key:`addQualityListener`,value:function(e){var t=this;return this.qualityEvent.attach(e),{close:function(){t.qualityEvent.detach(e)}}}},{key:`getSocket`,value:function(){return this.socket}},{key:`getConnection`,value:function(){return this.connection}},{key:`getSessionId`,value:function(){return this.sessionId}},{key:`getSessionOffset`,value:function(){return this.sessionOffset}},{key:`connect`,value:function(){this.assertNotClosed();var e=this.buildUrl();this.numberOfConnectionAttempts++;var t=++this.socketIdGenerator;this.log(`#${this.numberOfConnectionAttempts} attempt to open ${e} as socket #${t}`),this.socket=this.socketFactory.create(t,e,this)}},{key:`onOpen`,value:function(e){this.isValidCallback(e)&&this.socket&&(this.connection=this.connectionFactory.create(this.socket,this.sessionId,this.sessionOffset),this.previousConnectionError=void 0,this.log(`WS Connected`))}},{key:`onClose`,value:function(e,t){this.isValidCallback(e)&&this.reset(void 0,t)}},{key:`onError`,value:function(e){this.isValidCallback(e)&&this.reset($2.CONNECTION_ERROR)}},{key:`onMessage`,value:function(e,t){this.isValidCallback(e)&&this.connection&&(this.numberOfConnectionAttempts=0,this.setQuality(this.connection.onPacket(t)))}},{key:`isClosed`,value:function(){return!this.alive}},{key:`close`,value:function(){this.alive&&(this.alive=!1,this.connection&&(this.connection.close(!0),this.connection=void 0,this.quality=i4.OFFLINE),this.closeSocket(),this.log(`Closed`))}},{key:`reset`,value:function(e,t){this.setQuality(i4.OFFLINE),this.closeConnection(e),this.closeSocket(),t===Z9.UNAUTHENTICATED?this.listener.onFailure(K2.UNAUTHENTICATED):this.scheduleReconnection()}},{key:`assertNotClosed`,value:function(){if(!this.alive)throw Error(`Transport already cosed`)}},{key:`buildUrl`,value:function(){var e=`${this.url}`,t=0;return Object.entries(this.params).forEach(function(n){var r=Q2(n,2),i=r[0],a=r[1];a&&(e+=t++?`&`:`?`,e+=i+`=`+a)}),this.sessionId&&(e+=`&sid=${this.sessionId}&offset=${this.sessionOffset}`),this.previousConnectionError&&(e+=`&disconnected_by=${this.previousConnectionError}`),e}},{key:`isValidCallback`,value:function(e){return!!(this.alive&&e===this.socketIdGenerator)}},{key:`scheduleReconnection`,value:function(){var e=this,t=this.numberOfConnectionAttempts,n=this.backOffDelayWithJitter(t);this.log(`Scheduling #`+(t+1)+` reconnection attempt in `+n+` millisec`),this.timer.schedule(n).then(function(){e.numberOfConnectionAttempts===t&&e.reconnect()})}},{key:`reconnect`,value:function(){if(this.alive&&this.socket==null)try{this.connect()}catch{this.scheduleReconnection()}}},{key:`backOffDelayWithJitter`,value:function(e){if(!this.online)return this.options.maxReconnectionDelayMs;var t=this.backOffDelay(e);return this.options.reconnectionJitter?Math.max(this.options.initialReconnectionDelayMs,Math.floor(Math.random()*t)):t}},{key:`backOffDelay`,value:function(e){if(e<16){var t=this.options.initialReconnectionDelayMs*this.options.reconnectionDelayPowBase**+e;return Math.min(t,this.options.maxReconnectionDelayMs)}return this.options.maxReconnectionDelayMs}},{key:`closeConnection`,value:function(e){if(this.connection){var t=this.connection.getSessionId();t&&(this.sessionId=t,this.sessionOffset=this.connection.getSessionOffset(),this.options=P7(this.defaultOptions,this.connection.getSessionOptions())),this.previousConnectionError=this.connection.closedByError,e?this.connection.onError(e):this.connection.onClose(),this.connection=void 0}}},{key:`closeSocket`,value:function(){if(this.socket){try{this.socket.close()}catch{this.log(`Socket close error: socketId=`+this.socketIdGenerator)}this.socket=void 0}}},{key:`setQuality`,value:function(e){e!=null&&e!==this.quality&&(this.quality=e,this.qualityEvent.post(e))}},{key:`log`,value:function(){var e,t=[...arguments];(e=this.logger).log.apply(e,[`[Transport]`].concat(t))}}])}(),mte=H2,hte=100,gte=3e4,Q9=1.5,_te=1e4,vte=250,yte=10,bte=1e4,xte=3e4,Ste=250,$9=function(){function e(t,n,r){var i=this;z2(this,e),$(this,`options`,void 0),$(this,`WS`,void 0),$(this,`id`,void 0),$(this,`subscriptions`,void 0),$(this,`listener`,void 0),$(this,`transport`,void 0),$(this,`logger`,void 0),this.options=t,this.WS=r,this.id=t.clientId?t.clientId:this.generateId(8);var a=this,o=this.options.uid?``+this.options.uid:void 0;this.logger=new W7(this.options.debug?this.options.debug:!1),this.listener=new Y7(n,this.options.callbackErrorHandler,this.logger),this.subscriptions=new r9({onConnect:function(){i.listener.onConnect(i.getOnConnectObject())},onAttach:function(){i.listener.onAttach()},onDetach:function(){i.listener.onDetach()}},this.subscriptionOptions(),this.options.capabilities,this.options.callbackErrorHandler,this.logger);var s=this.connectionOptions(),c=new J7(this.subscriptions,s,this.logger),l=new X7(function(e){return a.WS?new a.WS(e):new WebSocket(e)},this.logger),u=this.options.url,d={uid:o,token:this.options.token,client_type:`web`,client_version:e.version,client_id:this.id},f=window;f.context&&f.context.version&&(d.web_version=f.context.version);var p=this.transportOptions();this.transport=new pte(c,l,new ote,u,d,p,{onFailure:function(e){i.listener.onFailure(G2(e)),i.close()}},this.logger)}return V2(e,[{key:`getId`,value:function(){return this.id}},{key:`getLogger`,value:function(){return this.logger}},{key:`getState`,value:function(){return{transport:{isConnected:this.isAttached()}}}},{key:`setOnline`,value:function(e){this.transport.setOnline(e)}},{key:`getQuality`,value:function(){return this.transport.getQuality()}},{key:`addQualityListener`,value:function(e){return this.transport.addQualityListener(e)}},{key:`isAttached`,value:function(){return this.subscriptions.isAttached()}},{key:`isAuthenticated`,value:function(){return this.subscriptions.isAuthenticated()}},{key:`addCapabilities`,value:function(e){return this.subscriptions.addCapabilities(e)}},{key:`addActivities`,value:function(e){return this.subscriptions.addActivities(e)}},{key:`isClosed`,value:function(){return this.transport.isClosed()}},{key:`close`,value:function(){this.subscriptions.close(),this.transport.close()}},{key:`connect`,value:function(){if(!this.isWebSocketSupported())return this.listener.onFailure(G2(K2.TRANSPORT_NOT_SUPPORTED,{type:`websocket`})),this;try{this.transport.connect()}catch(e){this.logger.error(`Fatal transport error `,e),this.listener.onFailure(G2(K2.MALFORMED_URL,{error:e}))}return this}},{key:`subscribe`,value:function(e,t,n){return this.subscriptions.subscribe(e,t,n)}},{key:`transportOptions`,value:function(){var e={initialReconnectionDelayMs:hte,maxReconnectionDelayMs:gte,reconnectionDelayPowBase:Q9,reconnectionJitter:!0};return this.options.initialReconnectionDelayMs!==void 0&&(e.initialReconnectionDelayMs=this.options.initialReconnectionDelayMs),this.options.maxReconnectionDelayMs!==void 0&&(e.maxReconnectionDelayMs=this.options.maxReconnectionDelayMs),this.options.reconnectionDelayPowBase!==void 0&&Q9>=1.1&&Q9<=2&&(e.reconnectionDelayPowBase=this.options.reconnectionDelayPowBase),e}},{key:`connectionOptions`,value:function(){var e={welcomeMaxDelayMs:_te,welcomeRequestDelayMs:vte};return this.options.welcomeMaxDelayMs!==void 0&&(e.welcomeMaxDelayMs=this.options.welcomeMaxDelayMs),e}},{key:`subscriptionOptions`,value:function(){var e={maxPendingRequests:yte,responseMaxDelayMs:bte,subscribeRetryTimoutMs:xte,registerDelayMs:Ste};return this.options.maxPendingRequests!==void 0&&(e.maxPendingRequests=this.options.maxPendingRequests),this.options.responseMaxDelayMs!==void 0&&(e.responseMaxDelayMs=this.options.responseMaxDelayMs),this.options.subscribeRetryTimoutMs!==void 0&&(e.subscribeRetryTimoutMs=this.options.subscribeRetryTimoutMs),this.options.registerDelayMs!==void 0&&(e.registerDelayMs=this.options.registerDelayMs),e}},{key:`getOnConnectObject`,value:function(){var e=this;return{getId:function(){return e.getId()},isAttached:function(){return e.isAttached()},isAuthenticated:function(){return e.isAuthenticated()},getQuality:function(){return e.getQuality()},addQualityListener:function(t){return e.addQualityListener(t)},addCapabilities:function(t){return e.addCapabilities(t)},addActivities:function(t){return e.addActivities(t)},subscribe:function(t,n,r){return e.subscribe(t,n,r)}}}},{key:`isWebSocketSupported`,value:function(){try{return this.WS!==null||WebSocket!==null}catch{return!1}}},{key:`generateId`,value:function(e){for(var t=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`,n=``,r=0;r<e;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}}],[{key:`getVersion`,value:function(){return e.version}}])}();$($9,`version`,mte);var Cte={connect:function(e,t,n){return new $9(e,t,n).connect()}},wte=t(((e,t)=>{(function(){var e=function(){var e=[[2637767806,863464769],[720845184,95069639],[1155203408,610415943],[2618685246,1655139042],[1971536997,1218186377],[848342074,540017087],[263957791,1627660921],[3896152207,4076560586],[226391645,1484086288],[436746274,3467632685],[2516964848,3797861296],[3491888988,3510251221],[1086189917,1248276018],[18044180,1876255637],[1572111136,1190386149],[597658413,2146900428],[97624494,2243205793],[1738507407,1854916977],[1950989311,2149575947],[2098318769,3283594736],[2194108574,2015279052],[4079062812,2500884588],[856979699,2941369318],[1270058469,3877737539],[2858720366,3170717948],[2378012835,1387254795],[2278688587,2178388503],[435406673,3555273441],[3031118064,1655806655],[2063925420,1107589828],[3376753832,436852829],[615148625,1302492416],[1285502018,1963045959],[346460119,1016137793],[2803604355,1176288659],[55085973,2968618255],[1669016372,4287873088],[164740250,1037634196],[896886403,883023163],[1935551383,2764331555],[410153072,4055711755],[533441746,1505690343],[3541084098,3466290517],[3214426080,4267541060],[2675233103,1951705124],[1374411850,3115986997],[1552073989,3684348154],[4244110986,875606593],[844343081,3115990494],[2356462440,135999605],[3116133511,377238503],[2129956651,2197966368],[299173332,3276914047],[1701379241,745972291],[1306570996,254977976],[2530644806,214138461],[1122123979,1667800879],[1831591130,3801192033],[1116211970,920967505],[1594837592,2551651254],[972591349,2046373768],[2479207924,1935030411],[1675376029,2367888248],[3960916618,3935874422],[1398143232,3265801671],[133930885,1520005442],[1351827834,2829577566],[2076951437,2723839804],[435980918,2364847828],[1668970368,3738157273],[2185864314,3993911799],[2041407829,31969768],[346864372,2004703094],[4047877822,3437142421],[3669961416,538399484],[616810829,4190688246],[3144558884,4030272234],[216165387,2513010905],[2761740594,3216997572],[3919406634,4096014649],[669429112,2434161727],[2234904640,3111407601],[1421079802,1598085235],[1924213810,310373675],[4002762044,2067865415],[2592451728,2586110625],[1890340057,4031717877],[4189625662,2577429954],[2276713138,3049850801],[2741429688,3310307512],[2924122950,3426712818],[421576781,1193704381],[2277442246,3030264553],[153237420,595540057],[4278711886,4176286928],[2380848297,4030514510],[2618700582,1303682185],[3018992701,185284845],[957243316,1291916363],[1543415220,1898408169],[504378001,531073412],[2591337657,1692896435],[1333852064,903543556],[1661259930,188168388],[561112646,2197961224],[1536910315,2632972300],[1349168372,2307429186],[411152329,2745631190],[1694697476,1081411140],[3755185459,2631660711],[4019355068,4027326706],[2066937809,3761668332],[3120395808,3878773315],[94890149,2109283191],[3045629038,358812277],[1249184265,3465901047],[3477490924,2308583306],[4114113436,3875911716],[1014604031,1434513279],[3991324799,2222416029],[2040431088,1539915569],[2253613964,4081224332],[2547464012,1611168627],[2722521980,4281500978],[71289574,213969824],[2450408597,903689630],[1894451515,364024012],[1939968537,374938813],[1447259295,3785468557],[4021046128,1664847745],[3139524504,3562928047],[1173487682,4065269608],[2467266804,3907744866],[4284945151,3486998177],[2925674454,1953016432],[3710671816,1271453948],[2129465869,1422863833],[587093076,18243356],[3373793513,2411305257],[2156648078,1791034213],[3737413652,1534461430],[468575139,2935304962],[1129551363,3603256834],[2861996892,1763494778],[2826449619,2465197654],[1704209531,1014895022],[3738359347,3402630390],[569410928,4095796581],[3021312909,2108247612],[2444777957,2664129360],[282063667,3773661258],[682545472,3188439005],[3318488457,1917822038],[1447622272,4045023041],[757420137,4038580915],[2613420942,4146703316],[4012836163,150381244],[2938127093,3428591704],[1208226490,3086335530],[2935205706,1446903363],[430957978,3830532479],[1381578755,3757172800],[4109399782,1596778224],[288855589,1954372339],[3169178148,2256716053],[2644780093,3895892303],[107966643,1071681559],[1304747544,2607225372],[1359190711,1898207171],[3229237120,3273634996],[3027167685,3863637628],[3011615298,2883984519],[564135827,978463264],[770797430,362326607],[1983662611,1907583229],[4153656423,48268960],[3609759233,720080177],[3727911466,1270989899],[200708787,2366086947],[744508026,393422515],[1213261630,65757284],[3485747185,3845951003],[2958861301,1680248217],[2598470344,3163845864],[2767997908,4233451722],[3881113485,1492930166],[1773764017,2764062206],[4189435844,2898689174],[4234838742,1267095035],[2624081078,3302114327],[2395569449,390426320],[1728307101,690284926],[3309827454,1118258254],[2028172868,3888829086],[4271523049,909051386],[146617804,942892565],[2467685867,974297806],[2483428231,503635829],[3743260573,2018222096],[1002067894,2289153437],[3535252974,3738302271],[4154611160,1002664952],[3623154244,2349656961],[3646679180,3524329383],[862933752,4282853607],[2806008282,3272780913],[2734037942,3828874677],[1328176304,2137666995],[2278785213,2780788825],[381286368,1816476193],[2074232908,2316293454],[4087773386,3651330956],[967884669,3728964514],[4239349185,3213509668],[419231360,1463788948],[1275421624,2672384707],[1088456595,436245261],[2365565249,783696577],[1758083333,845223583],[2048846183,3530914274],[2635948261,124738415],[940630937,3069598626],[839474029,1253439921],[902477345,165479306],[2836079689,2681188273],[2007115168,2093139645],[1363041891,1282466609],[1130479818,1063857938],[3644959908,1260430427],[1385135238,46497915],[1386975934,3110156681],[2635987502,4233461619],[1915744629,4117939016],[487743653,285736599],[2049219159,3960249250],[69242857,3908563670],[1511066720,1488527520],[215590039,1703564952],[1459430344,4184955468],[676103291,2642967214],[83799035,3182827979],[1949179493,476101251],[2593534694,1493478716],[2283504289,995211746],[1349412676,3449243940],[2954378677,1878813305],[249149717,3329151870],[1578231917,1483986052],[4135085182,890874990],[461755528,3505523909],[3669622373,634949665],[219487622,2914465301],[2825233742,3703631897],[2479105382,2935590907],[2582097898,3187672881],[1221328648,1843341402],[2140891889,3958868911],[1482849818,345750049],[751922730,3178831411],[3546542069,4036458902],[216179596,877293293],[444615341,3117393729],[2424254530,494454238],[1344234989,3003337991],[929188581,2760877801],[2507911009,1879899982],[980166547,1311840394],[3566535507,1790747461],[143525013,2311336672],[4181962471,4273938872],[1815842366,862009811],[911175674,1179575598],[3591335374,3694215714],[1452686093,3393294272],[385158879,2447709103],[4011414929,1264623507],[1448477120,911094312],[3971299641,2289992053],[3133647265,2234591563],[3007628400,964409938],[1708345684,3673411261],[3031964479,2843021794],[3022128657,2480338599],[118850112,473449293],[2048127371,3202109429],[3158349745,382018770],[1505327237,3807570472],[2568424029,3272693060],[1866609495,3888556537],[844703982,1852802964],[3504617058,682636099],[1448882679,3733580327],[821387540,2215744532],[3631471417,311618895],[2077838877,2383929020],[3352949096,1688694420],[2491080787,3998672444],[3368630402,4182204255],[983299419,2837414346],[3651215291,1033373924],[265429091,3988955082],[3019003608,2896212153],[2955948456,3025235588],[903690197,2266253487],[3925215275,89402958],[3959093811,3609545561],[2455088053,223552128],[3115011301,2133669107],[1765081558,673805649],[3324795129,2111392191],[3443871631,432345706],[3152559950,3425427147],[3699649406,672784944],[3129545774,7668664],[2747044893,173040075],[3925243406,852328481],[164095314,3161868591],[2234471571,1302682825],[2164784335,105893718],[159995093,536831360],[599199451,425051327],[3274759746,1680930461],[1192619331,3903085578],[2832721114,3078660237],[91404660,4030521531],[3044880024,1578375623],[3906596030,754177855],[803516785,1894094672],[288455592,2030430096],[2143232492,2317305324],[388352703,3406060288],[2521731420,3588403719],[1043041227,4028028525],[3195290851,2468913324],[4166724431,3168683191],[1228226538,968516529],[500177583,3444787306],[533367442,4252082053],[4236023256,657816314],[413575568,3367198397],[3435884549,3334062733],[1004255532,1135705894],[2859513268,4170618274],[3914086821,1251487871],[3080761716,3489067886],[3571165255,699353261],[773372954,3648014952],[769693293,2939128604],[3116440923,507748478],[1687629160,3739431776],[2489486648,3502376324],[3686847158,2878383449],[3530767427,902211375],[2121652637,2493976397],[1827477891,930064171],[2549918411,4029725732],[2071415163,844118802],[2236083679,3088894868],[2040110303,4144562891],[3489536313,1133419300],[2190878435,2301466071],[2465915458,2448602097],[1675766804,2073834499],[3329799896,1613253148],[1483966600,1348836071],[159505618,2527621997],[2674227354,1695130688],[2683539437,1927873839],[3833196123,2570082188],[3891433165,759819981],[1455453349,2179602430],[1430583255,1957776111],[2067726741,4235143439],[303380021,2998980439],[2136024795,3126725799],[2054591852,1051702291],[1029141665,489794361],[2317027384,569642164],[2068461795,624418658],[2499875684,1830645251],[1302894490,4319401],[1002663431,2406815191],[1560941298,2060652753],[2141002286,515773223],[3661248027,475092913],[3705503008,2419919909],[914567990,3496539911],[3462935583,2039034761],[2878378006,2379243316],[1133857586,1390159333],[3023618742,2140726761],[282908558,944874642],[3686955701,1148723903],[2604456805,4163675010],[3061545110,377179268],[3218002352,76459088],[2836503392,916455101],[536836808,151306053],[2886925079,404221671],[2936593041,2011015485],[453815187,1852163908],[3042568989,82176306],[3279635891,4174836410],[3282689058,2360003049],[4088968807,1516570623],[2680453086,1322680794],[1731693966,3438253771],[1842894553,1294307894],[2736377365,2964642609],[121205621,521330014],[2324595870,3005710757],[3784465521,676493813],[1958759409,2030833406],[1306150933,1016370058],[2636541290,482366508],[1950415745,1695073534],[322077955,3746046623],[3602873262,3829181504],[1211684447,1861645455],[504701736,4080111082],[2407799203,1223857855],[1925743434,1498920209],[3617596327,845198428],[2498480299,3484773806],[2680229135,2560201696],[3731399221,1536412390],[2756509305,2924710846],[2635957500,3459716133],[1372762539,769635894],[802677945,3878474636],[1707760534,3075809808],[3714687192,2872792173],[1615679922,1606381794],[1940556374,1337437342],[445390489,731124040],[2864974375,64601760],[1984806574,2141516710],[513390958,1890172555],[744398315,1475299139],[982749166,852662657],[652663695,4260736510],[1184061125,82616221],[3363191899,147951756],[1064069880,1507328085],[2138882964,547595589],[2616926846,3186935246],[2298715513,3606862940],[2414381911,811477686],[2694745228,900437726],[4202576185,2201114451],[3602305260,3323446937],[3756663274,2658490339],[3061587876,2171079416],[3390977925,2850497765],[486312941,224925241],[3515712841,3510684394],[1322319486,2647200565],[3839619171,1148450258],[392296762,1154854654],[1401523788,957405781],[1934485528,527352730],[645968162,3131215255],[696971825,3361451947],[2038689491,1946699733],[1723966113,2785859721],[2652365974,1118037185],[3988018407,3134982149],[1354171594,3053634345],[1287854075,2631782435],[1723106141,2662328866],[563845090,1878819261],[639520332,171129501],[534957223,1696062352],[3612364282,2283204027],[3109494688,1304463816],[500957989,630925278],[3477030536,2149497258],[4109750364,281719363],[951472732,564407054],[922095147,2767874048],[3946156928,829677774],[2622281253,2086286851],[2936811901,850242186],[630086272,3340782667],[2340986210,1296336989],[4107355543,3865114709],[3560210278,3968418243],[3868847493,2967450637],[611513888,2083325060],[3265390517,3025776309],[2874106961,3424470508],[1668707698,2923258228],[2778598353,24320552],[292356118,3415510793],[754567370,86994591],[185141877,1621715171],[2884558258,3722473457],[1492107531,111281805],[3336927864,4225337056],[782994598,1021838039],[346133860,18281270],[2080909533,1649329040],[3612065399,3859901127],[2151962287,284556115],[3957975594,3745718727],[52533817,3998775856],[1232633839,397383972],[2716413964,3629253960],[1531307298,3836851439],[3030137657,2500401718],[3561556693,653345841],[313061910,2945718466],[2065276,3342140708],[410498334,1470588117],[2726640512,4051654894],[2570984935,758567696],[3008987264,3462702678],[623860175,228525243],[3527183895,1829844480],[467272850,3890501742],[568376656,650516927],[990477018,4035508558],[2366955227,817792110],[4183621538,989198068],[946958343,1639184195],[3395758993,3924097558],[1690887473,3220519765],[605184237,1255270525],[275515833,1926424610],[2142902612,283494960],[2021972412,1823828440],[105373677,3448326697],[1666662384,1042433908],[1338566998,261206307],[498685668,1344755577],[3101233780,3119109371],[2733370951,3808165089],[3656512268,3449289481],[4025308119,1607880299],[778896067,1612183167],[2846510368,3674754715],[3058428120,2991822529],[1892379383,3268787440],[2565895844,4154602030],[3213117192,98999135],[2495816991,116985075],[1040203361,1785041385],[3106252493,69316595],[1639829808,2087117568],[3213709576,3799911752],[604681594,2340981536],[4236730699,2938666503],[4009938384,1878897714],[2701667332,1725918218],[2182473079,1258184],[3550198211,2760750799],[657991062,875584532],[1640976276,3380476221],[460041378,2924352091],[1972323596,2287414795],[2510248061,1350206297],[2959337826,3762681165],[1625877874,3235902929],[2070189957,1429368735],[4245163299,1839731898],[2358312347,138364248],[275739390,2179122576],[2037777210,972544338],[2766930226,1984733259],[1933485829,4209310327],[3034118011,3286589799],[2653025529,62078937],[2641780289,2679545709],[3540781195,2787026415],[1569993599,3215949659],[441337890,3947723353],[1878946792,459505587],[3724105660,920173002],[1691411102,3934795955],[148741087,3647709027],[142506469,2776440083],[3811107376,3823285243],[472209891,252266174],[1913386482,1867329194],[2960608550,482740699],[1145005292,1513558421],[1091751784,1687823886],[3625186042,3086337482],[1712140887,940065262],[1504455800,1945702563],[3896940088,2003245591],[2478191531,4197739e3],[3233871270,250924495],[3404865229,1131917964],[1462204167,429621621],[1349259705,3641608989],[3627860584,2048468319],[1244251718,1513180369],[3979211282,371413143],[3043187861,4285699810],[581894202,3060983825],[1390895705,1811317301],[2599134010,3337406128],[2488233440,2436161462],[1816641224,2208816697],[1792034756,815866116],[2779893723,2695577703],[2084952115,2951772258],[1351806869,169269771],[2469979804,86740603],[1163545420,4264616949],[1795352113,2511146232],[1796715044,3134635815],[3521170642,1538900329],[3725363621,1455009392],[1342594643,1512127734],[2618386938,662157428],[2028859350,2494504685],[1841905045,648351336],[4002935891,4033319405],[850071259,1768358867],[979915719,3876018087],[830889197,1629549437],[1744763229,2455795856],[522919199,368499868],[3063822504,2522639205],[2861636095,407686388],[4097602344,1945259027],[4215946617,1251639506],[894485042,534122652],[924809191,1807237502],[1811585710,1589663609],[3439653887,1722232],[3810997538,105152714],[2677100683,4291805514],[77233985,102407776],[4239834691,2851274395],[148802076,2006440603],[2409138150,126301601],[3048474397,3217504870],[588133437,4221603123],[1139638106,263087485],[982032635,3165674595],[562514827,1294842959],[467575086,905357513],[1405117894,3370530088],[3813285157,242912619],[3601878331,1985076606],[1586505598,2092146221],[738488098,103663229],[2970334297,321718822],[1068097019,1742926233],[235518094,420804527],[283685722,4092504887],[2666392744,3799169331],[3569817788,1256762975],[2169728352,292617248],[2444571896,2239859206],[3967907832,1066404216],[420376911,2913277294],[3046293305,2956347747],[2311278792,2477686209],[2885955184,4172514290],[3030078181,2275536480],[4212469731,4280736393],[1046900335,1773022229],[995380926,1414273529],[3892683234,2429494358],[615726237,2127712535],[3880203074,2071130305],[176180504,3070850165],[1474506861,2283723599],[1256707747,1857412043],[764236850,359687368],[3521530334,511649419],[2318567964,3992868140],[128167623,2518992858],[2220129756,1042300052],[2567608573,1349636707],[441446694,384760969],[4143447316,829506048],[817912603,2738025500],[2368091832,357934982],[1187643061,1561463042],[3438021235,3030161697],[1318922279,895468690],[434876457,1130220303],[1180291767,1132759596],[2520707785,1798553137],[1962430872,2958700157],[1510954061,3534879512],[57831539,3269538993],[3354831405,3852135009],[891783098,2698494511],[2555636406,996018997],[2881342935,3982231648],[3473267445,2894952368],[1238029452,3958679326],[2051805420,559465638],[3655936674,1186951582],[330209165,167662935],[1929681327,2450868735],[1313566811,2458925988],[4283920930,3243182650],[1438004300,4185567150],[3093439067,89876832],[3401620219,3721579956],[3673745794,2682874719],[3053321309,825410712],[822915968,3681514755],[3900685126,561657358],[553823814,1857753416],[4166295066,983949325],[128359165,3426887194],[3300989119,3884968622],[4193552686,3647722552],[452189154,1569670618],[4122259632,3537825460],[2519387887,2821594244],[74333898,2940550377],[4032631446,2173999692],[2521268686,1934310532],[2620314688,2177785789],[1378755571,2455646622],[394133753,4231198609],[734399075,2800989170],[573292462,1634883078],[1214417373,3426576256],[2110224475,2399009920],[2331215665,3224086912],[531326186,698539511],[3839443603,583861850],[2644531398,2017784332],[616620850,3070237104],[590349237,2798642861],[3582377217,3317831670],[1582708616,1596570667],[2126148205,2358511947],[173450736,3219362418],[3616831144,1323437318],[2655785577,3131359031],[401600069,2967397952],[496349349,4244179910],[2479612086,2579650653],[1710903074,2049666425],[3589924952,690291925],[3266682943,1900485231],[1496318498,3025542656],[3459221058,3389461212],[2091479615,3140389256],[663040899,1207089672],[3323704225,1105530508],[353318429,2879253542],[2674540957,941987316],[1688550857,620657353],[338551967,4286217277],[204689992,2239736295],[178008789,3940832005],[3871613304,3300636974],[1911672356,2429684487],[4055679954,1974461722],[3878217928,1009991796],[2533095482,310920740],[2174833823,3596041637],[1604814460,2939543881],[1452830254,4092397851],[2441027029,4169690209],[3524103304,3372213855]],t=[[836181454,1689436944],[2776523577,3710710688],[4049974663,3750330768],[519497435,2979405513]],n=[[1892447193,197291556],[3793382197,3742120663],[3838936,2994760034],[479846099,1018728609],[3476112862,182272649],[3504620154,1427438450],[2009473484,2679350403],[1738755500,1129731339]],r=[4174784170,2938602761],i={p:0,P:1,n:2,N:3,b:4,B:5,r:6,R:7,q:8,Q:9,k:10,K:11},a=[];a[5]=1,a[6]=0,a[9]=3,a[10]=2,a[17]=5,a[18]=4,a[33]=7,a[34]=6,a[65]=9,a[66]=8,a[129]=11,a[130]=10;var o=[2,5,10,20,40,80,160,64],s=`nbrq`,c=[``,`0000000`,`000000`,`00000`,`0000`,`000`,`00`,`0`,``],l=16;function u(e){var t=e.toString(16);return  __get$(c,t.length) +t}function d(e){return u(e[0])+u(e[1])}function f(e){return[parseInt(e.substr(0,8),16),parseInt(e.substr(8),16)]}function p(a,s){var c,l,u=a.split(` `),f=u[0].split(`/`),p,m,h,g,_,v,y,b,x=u[1]===`w`,S=0,C,w,T=Number(x),E=T?3:4;for(p=7;p>=0;--p)for(m=0,h= __get$(f,p) ,_=h.length,g=0;g<_;g+=1)v= __get$(h,g) ,C= __get$(i,v) ,C>=0&&(y= __get$(e,64*C+8*(7-p)+m) ,c=(c^y[0])>>>0,l=(l^y[1])>>>0,C===T&&p===E&&(S|=1<<m)),m+=Number(v)||1;return u[2]!==`-`&&(b=u[2],b.indexOf(`K`)>-1&&(y=t[0],c=(c^y[0])>>>0,l=(l^y[1])>>>0),b.indexOf(`Q`)>-1&&(y=t[2],c=(c^y[0])>>>0,l=(l^y[1])>>>0),b.indexOf(`k`)>-1&&(y=t[1],c=(c^y[0])>>>0,l=(l^y[1])>>>0),b.indexOf(`q`)>-1&&(y=t[3],c=(c^y[0])>>>0,l=(l^y[1])>>>0)),u[3]&&u[3]!==`-`&&(w=u[3].charCodeAt(0)-97, __get$(o,w) &S&&(y= __get$(n,w) ,c=(c^y[0])>>>0,l=(l^y[1])>>>0)),x&&(c=(c^r[0])>>>0,l=(l^r[1])>>>0),s&&s===`hex`?d([c,l]):[c,l]}function m(e,t){var n=new XMLHttpRequest,r=e.toLowerCase().indexOf(`.json`)>-1;function i(){var e;if(n.status>=200&&n.status<300||n.status===304||n.status===0||n.status===1223)if(r)try{t(null,JSON.parse(n.response))}catch(e){t(e)}else e=new DataView(n.response),t(null,e);else t(Error(`Error code: `+n.status))}n.open(`GET`,e,!0),r||(n.responseType=`arraybuffer`),n.onload=i,n.onerror=i,n.send()}function h(e){var t,n={},r,i,a;function o(e,t){var n=r.getUint16(e+8),i=r.getUint16(e+10),a,o=n>>9&7,c=n>>6&7,l=n>>3&7,u=n&7,d=n>>12&7;return c===4&&t&&o===l&&t!==`-`&&(u===7&&(o===0&&t.indexOf(`K`)>-1||o===7&&t.indexOf(`k`)>-1)?--u:u===0&&(o===0&&t.indexOf(`Q`)>-1||o===7&&t.indexOf(`q`)>-1)&&(u+=2)),a=String.fromCharCode(c+97)+(o+1)+String.fromCharCode(u+97)+(l+1),d&&(a+= __get$(s,d-1) ),{move:a,weight:i}}function c(e){e.sort(function(e,t){return t.weight-e.weight})}function u(e){return typeof e==`string`&&(e={fen:e}),t(e)}function d(e){var t,n,r,i,a,o=0;if(e||={},t=e.moves||u(e),c(t),r=t.length,r){if(!e.type||r===1||e.type===`best`)return t[0].move;if(e.type===`random`){for(i=Math.floor(Math.random()*t.sum)+1,a=0;a<r-1&&(o+= __get$(t,a) .weight,!(i<=o));a+=1);return  __get$(t,a) .move}else if(e.type===`randomDisregardWeight`)return  __get$(t,Math.floor(Math.random()*r)) .move;else if(e.type===`worst`)return  __get$(t,r-1) .move;else return n=parseInt(e.type)||1,n<0&&(n=r+n+1),n<1?n=1:n>r&&(n=r), __get$(t,n-1) .move}}function m(e){var t=r.length||r.byteLength||0,n=e.offset||0,i,a=e.fen,s=e.chess960,c=e.checkAll,u,d=[],m=0,h,g,_;for(e.hash?(i=e.hash,typeof i==`string`&&(i=f(i))):i=p(a),!s&&a&&(_=a.split(` `)[2]),n=0;n<t;n+=l)if(r.getUint32(n)===i[0]&&r.getUint32(n+4)===i[1])h=o(n,_), __set$(d,d.length,h) ,m+=h.weight,u=!0;else if(u&&!c)break;if(d.sum=m,e.relative)for(g=d.length-1;g>=0;--g) __get$(d,g) .relative=Math.round( __get$(d,g) .weight/m*1e4);return d}function h(e){var t=[],n,r=e.b.length;for(n=0;n<r;++n)t.push({move: __get$(e.b,n) ,weight: __get$(e.w,n) });return t}function g(e){var t,r,a=0,o,s,c,l=e.fen,u;if(n.useFen)o= __call$(l,"replace",[/ \d+ \d+$/,``]) ,t= __get$(i,o) ,t||(s= __call$(o,"replace",[/[a-h][1-8]$/,`-`]) ,s!==o&&(t= __get$(i,s) ));else if(e.hash||=p(l,`hex`),t= __get$(i,e.hash) ,t){if(t[0]&&t[0].n&&(t=t[0]),t.n&&!t.b)return[];if(t.b)t=h(t);else if(!e.chess960&&l)for(u=l.split(` `)[2],r=t.length-1;r>=0;--r)c= __get$(t,r) .move.match(/e([18])([ah])\1/),c&&(c[2]===`h`&&(c[1]===`1`&&u.indexOf(`K`)>-1||c[1]===`8`&&u.indexOf(`k`)>-1)? __set$(t,r,{move:`e`+c[1]+`g`+c[1],weight:__get$(t,r).weight}) :c[2]===`a`&&(c[1]===`1`&&u.indexOf(`Q`)>-1||c[1]===`8`&&u.indexOf(`q`)>-1)&&( __set$(t,r,{move:`e`+c[1]+`c`+c[1],weight:__get$(t,r).weight}) ))}if(t)for(r=t.length-1;r>=0;--r)a+=Number( __get$(t,r) .weight);else t=[];return t.sum=a,t}if(n={query:u,pick:d},e.getUint32)t=m,r=e,n.buffer=r;else for(a in t=g,i=e,n.json=i,i){n.useFen=a.indexOf(` `)>-1;break}return n}function g(e,t){function n(e,n){var r;if(n&&(r=h(n)),t)return t(e,r);if(e)throw e;return r}m(e,n)}return{hash:p,loadBook:function(){var e={};return function(t,n){if( __get$(e,t) ){ __get$(e,t) .book?setTimeout(function(){n(null, __get$(e,t) .book)},0): __get$(e,t) .cbs.push(n);return} __set$(e,t,{cbs:[n]}) ,g(t,function(n,r){var i= __get$(e,t) .cbs;n?delete e[t]:( __get$(e,t) .book=r, __get$(e,t) .cbs=void 0),i.forEach(function(e){setTimeout(function(){e(n,r)},0)})})}}(),to64BitHex:d,zobristPiece:e,zobristCastle:t,zobristEnPassant:n,zobristTurn:r,zobristPieceValue:i,zobristPieceValueNumbers:a}}(),n=function(){var t={Chess:0,Chess960:1,Crazyhouse:2,"3-check":3,"King of the Hill":4,Bughouse:5,chess960:1,fischerandom:1,fischerrandom:1,fischer:1,chess9lx:1,960:1,crazyhouse:2,"three-check":3,threecheck:3,"3check":3,kingofthehill:4,koth:4,bughouse:5},n=[`Chess`,`Chess960`,`Crazyhouse`,`3-check`,`King of the Hill`,`Bughouse`],r={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},i,a,o,s,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0,u=0,d=0,f=-1,p=1,m=2,h=4,g=8,_=16,v=32,y=64,b=128,x=3,S=252,C=255,w=256,T=512,E=112,D=1,O=2,k=4,ee=3,A=7,j=14,M=21,N=127,P=`pnbrqkPNBRQK`,te=`rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1`,F=[];F[5]=[-16,-17,-15],F[6]=[16,17,15],F[8]=[-18,-33,-31,-14,18,33,31,14],F[16]=[-17,-15,17,15],F[32]=[-16,1,16,-1],F[64]=[-17,-16,-15,1,17,16,15,-1],F[128]=[-17,-16,-15,1,17,16,15,-1];var ne={P:5,p:6,N:9,n:10,B:17,b:18,R:33,r:34,Q:65,q:66,K:129,k:130},I={P:4,p:4,N:8,n:8,B:16,b:16,R:32,r:32,Q:64,q:64,K:128,k:128},re={5:`P`,6:`p`,9:`N`,10:`n`,17:`B`,18:`b`,33:`R`,34:`r`,65:`Q`,66:`q`,129:`K`,130:`k`},ie={9:`N`,10:`N`,17:`B`,18:`B`,33:`R`,34:`R`,65:`Q`,66:`Q`,129:`K`,130:`K`},L=[80,0,0,0,0,0,0,96,0,0,0,0,0,0,80,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,96,96,96,96,96,96,224,0,224,96,96,96,96,96,96,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,80,0,0,0,0,0,0,96,0,0,0,0,0,0,80],R=[336,80,80,0,0,0,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,360,508,252,0,252,508,360,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,0,0,0,80,80,336],ae=[336,80,80,0,0,0,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,360,508,252,0,252,508,488,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,96,0,0,80,80,336],oe=[336,80,80,0,0,96,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,488,508,252,0,252,508,360,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,0,0,0,80,80,336],se=[336,80,80,0,0,96,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,488,508,252,0,252,508,488,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,96,0,0,80,80,336],ce=[336,80,80,112,112,112,96,352,96,96,112,112,112,80,336,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,352,352,480,480,488,508,252,0,252,508,488,480,480,480,352,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,336,80,80,112,112,112,96,352,96,96,112,112,112,80,336],le=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,33,16,31,15,0,0,0,0,0,0,0,0,0,0,0,18,17,16,15,14,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,-14,-15,-16,-17,-18,0,0,0,0,0,0,0,0,0,0,0,-15,-31,-16,-33,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],ue=[0,5,8,11,14],de=[31,7,7,7,63],fe={P:0,p:0,N:5,n:5,B:8,b:8,R:11,r:11,Q:14,q:14},pe=[h,g,_,v,y],me=[``,`N`,`B`,`R`,`Q`],z={CAPTURE:1,BIG_PAWN:2,EP_CAPTURE:4,ANY_CAPTURE:5,PROMOTION:8,KSIDE_CASTLE:16,QSIDE_CASTLE:32,KQSIDE_CASTLE:48,DROP:64,DROP_OR_PROMOTE:72},he=[0,6,1],ge={K:119,Q:112,k:7,q:0,A:112,B:113,C:114,D:115,E:116,F:117,G:118,H:119,a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},_e=[`Event`,`Site`,`Date`,`Round`,`White`,`Black`,`Result`],ve=[`Event`,`Site`,`Date`,`Round`,`White`,`Black`,`Result`,`Variant`,`SetUp`,`FEN`,`WhiteA`,`WhiteB`,`BlackA`,`BlackB`];function ye(e){return e>>4}function be(e){return e&7}function xe(e){return String.fromCharCode(be(e)+97)+(8-ye(e))}function Se(e){return 3-e}function B(e,t){e[0]=(e[0]^t[0])>>>0,e[1]=(e[1]^t[1])>>>0}function Ce(e,t,n){return t<1?e:(t=typeof t==`number`?t:80, __call$(e,"replace",[RegExp(`(.{1,`+t+`})(?: |$|\r?
)`,`g`),`$1`+n]) .slice(0,-n.length))}function we(e){var t,n;return e=e.trim(),n=e.split(` `),t= __get$([``,` w - - 0 1`,` - - 0 1`,` - 0 1`,` 0 1`,` 1`],n.length) ,t&&e?e+=t:n[5]===`0`&&(n[5]=1,e=n.join(` `)),e}function V(e){var t=Math.floor(e%36e3/600),n=Math.floor(e%36e3%600)/10;return Math.floor(e/36e3)+`:`+(t<10?`0`:``)+t+`:`+(n<10?`0`:``)+n}function Te(e){var t=e.split(`:`);return(t[0]*3600+t[1]*60+t[2]*1)*10}function Ee(){e.zobristCheck=[[441249556,340005552],[1040760204,311043682],[1621584863,1749286446],[1006868636,1625552915],[1953853171,24921145],[161251506,1935545265]]}function De(e,n){var r=e.length,i,a=0,o=0,s=n&&(n===t.Crazyhouse||n===t.Bughouse),c;for(i=0;i<r;++i)if(c= __get$(e,i) ,+c!=+c)if(c===`/`){if(o!==8&&(e=e.substr(0,i)+(8-o)+e.substr(i),++i,++r),o=0,++a>7){if(!s&&i<r-1||!/^[pnbrq]{0,63}$/i.test(e.substr(i+1)))return!1;break}}else if( __get$(ne,c) ){if(++o>8)return!1}else if(c===`~`)(!s||!i||!/[nbrq]/i.test( __get$(e,i-1) ))&&(e=e.substr(0,i)+e.substr(i+1),--i,--r);else return!1;else o+=c*1,o>8&&(e=e.substr(0,i)+(c-(o-8))+e.substr(i+1),o=8);return e}function Oe(e,n){var r,i,a,o=/^(?:[A-H]{1,2}[a-h]{0,2}|[A-H]{0,2}[a-h]{1,2}|KQ?k?q?|Qk?q?|kq?|q|-)$/,s= __get$(t,n) ||n*1|| __get$(t,__call$(String(n),"replace",[/\s/g,``]).toLowerCase()) ,c=s===t.Crazyhouse||s===t.Bughouse,l,u,d,f=0,p=0,m,h=!0,g=``,_={0:0,7:0},v={0:0,7:0},y={0:`k`,7:`K`},b={0:`r`,7:`R`},x,S,C=s===t.Chess960,w,T,E,D,O,k,ee,A,j,M,N;if(!e)return 1;if(s===t.Bughouse&&(u=e.split(` | `),u.length===2))return d=Oe(u[0],n),d===0&&(d=Oe(u[1],n)),d;if(u=e.split(/\s+/),s=== __get$(t,`3-check`) &&u.length===7&&(l=u.pop(),!/^\+[0-3]\+[0-3]$/.test(l)||l===`+3+3`))return 14;if(u.length!==6)return 1;if(/\D|.{7,}|^0|^$/.test(u[5]))return 2;if(/\D|.{7,}|^0.|^$/.test(u[4]))return 3;if(!/^(?:-|[abcdefgh][36])$/.test(u[3]))return 4;if(w=u[2],C){if(!o.test(w))return 12}else if(!/^(?:KQ?k?q?|Qk?q?|kq?|q|-)$/.test(w)){if(n!==void 0||!o.test(w))return 5;C=!0}if(u[1]!==`w`&&u[1]!==`b`)return 6;if(c&&(u[0]= __call$(u[0],"replace",[/~(?=.*\/)/g,``]) ),i=u[0].split(`/`),c&&i.length===9&&(l=i.pop(),!/^[pnbrq]{0,63}$/i.test(l)))return 13;if(i.length!==8)return 7;if(u[3][1]===`3`&&u[1]===`w`||u[3][1]===`6`&&u[1]===`b`)return 11;for(u[3]!==`-`&&(p=u[3][1]===`3`?4:3,m=p===4?5:2,f=u[3].charCodeAt(0)-97,h=!1,g=p===4?`P`:`p`),r=0;r<i.length;++r){for(j=0,M=!1,N=0;N< __get$(i,r) .length;N++)if(a= __get$(__get$(i,r),N) ,+a==+a){if(M)return 8;j+=a*1,M=!0}else{if(P.indexOf(a)===-1)return 9;if(!h&&p===r&&f===j&&g===a&&(h=!0),m===r&&f===j)return 11;r%7==0&&(a=== __get$(y,r) ? __set$(v,r,1<<j) :a=== __get$(b,r) &&(_[r]|=1<<j)),++j,M=!1}if(j!==8)return 10}if(!h)return 11;if(w!==`-`){if(C){for(E={0:0,1:0,2:252,4:248,8:240,16:224,32:192,64:128,128:0},T={0:0,1:0,2:1,4:3,8:7,16:15,32:31,64:63,128:0},A={0:[0,0],7:[0,0]},r=w.length-1;r>=0;--r)if(k=w.charCodeAt(r),ee&&ee>k&&ee-k<8||(k===75?(O=7,D= __get$(_,O) & __get$(E,__get$(v,O)) ):k===81?(O=7,D= __get$(_,O) & __get$(T,__get$(v,O)) ):k===107?(O=0,D= __get$(_,O) & __get$(E,__get$(v,O)) ):k===113?(O=0,D= __get$(_,O) & __get$(T,__get$(v,O)) ):(O=k>=97?0:7,D=1<<k-(O?65:97),ee=k),!D||D&D-1)|| __get$(v,O) <2|| __get$(v,O) >64||(D& __get$(_,O) )!==D||++ __get$(A,O) [( __get$(v,O) <D)*1]>1)return 15}else if(x=(w.indexOf(`K`)>-1?128:0)|(w.indexOf(`Q`)>-1?1:0),x&&(v[7]!==16||(x&_[7])!==x)||(S=(w.indexOf(`k`)>-1?128:0)|(w.indexOf(`q`)>-1?1:0),S&&(v[0]!==16||(S&_[0])!==S)))return 15}return 0}function ke(e,t){var n=``,r=0,i,a,o=t?6:0;if(e)for(;r<5;){for(i=e>> __get$(ue,r) & __get$(de,r) ,a=0;a<i;++a)n+= __get$(P,r+o) ;++r}return n}function Ae(t,n){ __get$(n,p) &&B(t, __get$(e.zobristCheck,__get$(n,p)-1) ), __get$(n,m) &&B(t, __get$(e.zobristCheck,__get$(n,m)+2) )}function je(t,n){var r,i,a,o,s=0,c,l,u;for(r=1;r<3;++r){if(i= __get$(n,r) ,i)for(a=0;a<5;){for(c=s+a*63,o=i>> __get$(ue,a) & __get$(de,a) ,l=0;l<o;++l)u= __get$(e.zobristPiece,c++) ,B(t,[u[0]*31>>>0,u[1]*17>>>0]);++a}s=315}}function Me(t,n,r,i){( __get$(t,r+1) ===i|| __get$(t,r-1) ===i)&&B(n, __get$(e.zobristEnPassant,be(r)) )}function Ne(e,t){var n=[],r,i;for(r=0;r<120;++r)if(r&136&&(r+=8),i= __get$(e,r) ,i&&(i&t)===t){n.push(r);continue}return n}function Pe(e,t,n,r){var i;(a===0|| __get$(e,n+8) &O)&&(ye(n)%7==0?(i=r|z.PROMOTION|t<<A|n<<j, __set$(c,u++,i|4<<M) , __set$(c,u++,i|3<<M) , __set$(c,u++,i|2<<M) , __set$(c,u++,i|1<<M) ): __set$(c,u++,r|t<<A|n<<j) )}function Fe(e){switch(e){case 67:case 68:case 51:case 52:return!0}return!1}function Ie(e,t,n,r){var i=t+(n-t%8),a=n>t%8?1:-1,o,s,c;for(c=t+a;c!==i;c+=a)if( __get$(e,c) )return!1;if(o=r===p?a===1?118:114:a===1?6:2,s=o-a, __get$(e,o+8) || __get$(e,o) &&o!==t&&o!==i|| __get$(e,s) &&s!==t&&s!==i)return!1;if(o!==t){for(a=o>t?1:-1,c=t+a;c!==o;c+=a)if(c!==i&& __get$(e,c) || __get$(e,c+8) )return!1}return!0}var Le=function(){function e(n,r,i,a,o,s,c){var l=[],u=``,d=!0,f,h,g,_,v,y,b= __get$(r,i) ,x=b.length,S,C,w=``;if(b.commands)for(_ in b.commands)(!s||s.indexOf(_)>-1)&&(w+=`[%`+_+` `+ __get$(b.commands,_) +`]`);for(b.initComment&&!c&&(w=(w+` `+ __call$(b.initComment,"replace",[/(\"|\}|\%|\\)/g,`\\$1`]) ).trim()),w&&l.push(`{`+w+`}`),h=0;h<x;++h){if(f= __get$(b,h) ,y=f.color===p,u=``,w=``,a===t.Bughouse?(l.bughouseOrder||=[],l.bughouseOrder.push(f.bughouseOrder),h||(l.blackCountOffset=b[0].color===m?1:0)):(d&&!y?u=n+`...`:y&&(u=n+`.`),o&&(y||d)&&(u+=` `)),u+=f.san,f.annotation&&(u+=f.annotation),f.additionalAnnotation&&(u+=` `+f.additionalAnnotation.join(` `)),d=!1,f.time!==void 0&&!f.commands&&(f.commands={clk:V(f.time)}),f.commands)for(_ in f.commands)(!s||s.indexOf(_)>-1)&&(w+=`[%`+_+` `+ __get$(f.commands,_) +`]`);if(f.comment&&!c&&(w=(w+` `+ __call$(f.comment,"replace",[/(\"|\}|\%|\\)/g,`\\$1`]) ).trim()),w&&(u+=` {`+w+`}`,d=!0),l.push(u),f.lines)for(S=f.lines.length,g=0;g<S;++g)C= __get$(f.lines,g) , __get$(r,C) .length&&(v=e(n,r,C,a,o,s,c),v[0]=`(`+v[0], __set$(v,v.length-1,__get$(v,v.length-1)+`)`) ,l=l.concat(v),d=!0);y||n++}return l}function n(e,t,n){var r=t,i=e.siblingGame.pgn(),a=0,o=0,s=[];for(t.bughouseOrder=t.bughouseOrder||[],i.bughouseOrder=i.bughouseOrder||[];t.bughouseOrder.length||i.bughouseOrder.length;)!t.bughouseOrder.length||i.bughouseOrder.length&&t.bughouseOrder[0]>i.bughouseOrder[0]?(i.bughouseOrder.shift(),s.push(`B`)):(t.bughouseOrder.shift(),s.push(`A`));return t=[],s.forEach(function(s){var c,l,u=``,d;s===`A`?(c=r,++a,l=a,d=e.startingMoveNumber()):(c=i,++o,l=o,d=e.siblingGame.startingMoveNumber()),u=String(Math.floor((l+1)/2)+d-1),(c.blackCountOffset+l)%2?u+=s:u+=s.toLowerCase(),u+=`.`+(n?` `:``)+c.shift(),t.push(u)}),t}function r(e,t){return`[`+e+` "`+ __call$(String(t),"replace",[/(\"|\\)/g,`\\$1`]) +`"]`}return function(i,a,o,s,c,l){var u=typeof i.newline==`string`?i.newline:`
`,d=i.spaceAfterPeriods===void 0?!0:i.spaceAfterPeriods,f=``,p,m;for(p in f+=r(`Event`,a.Event)+u,f+=r(`Site`,a.Site)+u,f+=r(`Date`,a.Date)+u,f+=r(`Round`,a.Round)+u,c===t.Bughouse?(f+=r(`WhiteA`,a.WhiteA||`?`)+u,f+=r(`BlackA`,a.BlackA||`?`)+u,f+=r(`WhiteB`,a.WhiteB||`?`)+u,f+=r(`BlackB`,a.BlackB||`?`)+u):(f+=r(`White`,a.White)+u,f+=r(`Black`,a.Black)+u),f+=r(`Result`,a.Result)+u,c&&(f+=r(`Variant`,a.Variant)+u),a.FEN&&a.FEN!==te&&(f+=r(`SetUp`,`1`)+u,f+=r(`FEN`,a.FEN)+u),a)ve.indexOf(p)===-1&&(f+=r(p, __get$(a,p) )+u);if(f+=u,m=e(s,o,0,c,d,i.hideCommands?[]:i.restrictCommands,i.hideComments),c===t.Bughouse){if(l.isDependent)return m;m=n(l,m,d)}return m.push(a.Result),f+Ce(m.join(` `),i.maxWidth,u)}}(),Re=function(){var e=`!?~`,t=/\[%(\S+)\s([^\]]+)\]/,n=/^(?:[+=~\/\-\u2212]+|T?N|RR|D)$/;function r(e){for(var n,r=e.commands||{};n=t.exec(e.value);)e.value= __call$(e.value,"replace",[n[0],``]) .trim(), __set$(r,n[1],n[2]) ,e.commands=r}function i(e,t,n,r){for(var i;++t<n;)if((i= __get$(e,t) .trim())&&i[0]!==`%`)return i[0]===`[`&&(!r||/^\[\S+\s+".*"\]$/.test(i))}return function(t,a){var o,s,c,l,u=`tags`,d,f,p,m=[],h={type:u,value:``},g=0,_=[],v=!0;a||={},o=t.split(/\r?\n/),l=o.length;nextLine:for(s=0;s<l;++s)if(c= __get$(o,s) .trim(),c[0]!==`%`)if(!c)m.length&&(u===`tags`?(u=`san`,v=!1):u!==`tagValueStart`&&i(o,s,l,g||u===`comment`)&&(u===`comment`&&m.push(h), __get$(m,m.length-1) .type!==`tagValue`&&(_.push(m),m=[]),u=`tags`,v=!0,g=0));else{if(c=` `+c+` `,f=c.length,d=0,v)for(;d<f;++d)if(p= __get$(c,d) ,u===`tags`){if(p===`[`)u=`tagName`,h={type:u,value:``};else if(p.trim()){u=`san`,h={type:u,value:``},v=!1;break}}else if(u===`tagName`)h.value&&p.trim()===``?(m.push(h),u=`tagValueStart`):p!==` `&&(h.value+=p);else if(u===`tagValueStart`){if(p===`"`||p===``)u=`tagValue`,h={type:u,value:``};else if(p.trim()){m.push({type:`tagValue`,value:c.slice(d,-1).match(/(.*?)"?\]?$/)[1]}),u=`tags`,h={type:u,value:``};continue nextLine}}else if(u===`tagValue`)if(p===`"`||p===``)if(m.push(h), __get$(c,d+1) ===`]`)u=`tags`,h={type:u,value:``},++d;else if(c.slice(-2,-1)===`]`){h.value+=c.substr(d).match(/(.*?)"?\s*\] $/)[1],u=`tags`,h={type:u,value:``};continue nextLine}else u=`tagEnd`;else p===`\\`&&d+2<f&&(++d,p= __get$(c,d) ),d>0&&(h.value+=p);else{if(p!==`]`){if(!p.trim())continue;--d}u=`tags`,h={type:u,value:``}}for(;d<f;++d)if(p= __get$(c,d) ,u===`san`){if(e.indexOf(p)>-1)p===`!`||p===`?`||e.indexOf(p)<6&&(p= __get$([`!!`,`??`,`!?`,`?!`],e.indexOf(p)-2) )?(h.value&&m.push(h),h={type:`a`,value:p},( __get$(c,d+1) ===`!`|| __get$(c,d+1) ===`?`)&&(h.value+= __get$(c,++d) ),m.push(h),h={type:`san`,value:``}):(p===``&&h.value===`=/`?(h.type=`aa`,h.value+=p):(h.value&&(n.test(h.value)&&(h.value!==`--`||a.rejectNullMoves)&&(h.type=`aa`),m.push(h)),h={type:`aa`,value:p},p===``&& __get$(c,d+1) ===``&&(h.value=``,++d)),m.push(h),h={type:`san`,value:``});else if(p===` `||p===`	`||p===`\r`||p===`{`||p===`(`||p===`)`){if(h.value){if(h.value[0]===`$`)h.type=`nag`;else if(h.value===`*`||h.value===`1-0`||h.value===`0-1`||h.value===`1/2-1/2`||h.value===`-`)if(g||d+1<f)h.type=h.value===`*`?`cont`:`comment`;else{if(h.type=`result`,h.value===`-`&&(h.value=`1/2-1/2`),m.push(h),_.push(m),s+1===l||s+2===l&&! __get$(o,s+1) )return _;u=`tags`,v=!0,h={type:u,value:``},m=[];break}n.test(h.value)&&(h.value!==`--`||a.rejectNullMoves)&&(h.type=`aa`),m.push(h),h={type:u,value:``}}if(p===` `||p===`	`||p===`\r`)u=`san`;else if(p===`{`)u=`comment`,m.length&& __get$(m,m.length-1) .type===`comment`&&(h=m.pop(),h.value+=` `);else if(p===`(`)u=`san`,m.push({type:`variationStart`,value:++g});else{if(g<1){if(!a.commentErrors)return!1}else m.push({type:`variationEnd`,value:g--});u=`san`}h.type=u}else if(p!==`.`&&(h.value||+p!=+p|| __get$(c,d+1) ===`-`|| __get$(c,d+1) ===`/`))h.value+=p;else if(+p==+p)switch(h.number||=``,h.number+=p, __get$(c,d+1) ){case`A`:case`a`:case`B`:case`b`:h.number+= __get$(c,++d) ,m.push({type:`number`,value:h.number}),delete h.number}}else d===0&&(h.value=h.value.trim()),p===`}`?(h.value=h.value.trim(),h.value.indexOf(`[`)>-1&&r(h),m.push(h),u=`san`,h={type:u,value:``}):(p===`\\`&&d+2<f&&(p= __get$(c,++d) ),h.value+=p)}return h.value&&m.push(h),(m.length||!_.length)&&_.push(m),_}}();function ze(ve,Ce){var V,H,Be=0,Ve=!0,U=[],W=p,G=[],He=f,Ue=0,We=1,Ge=1,Ke=[],qe=[Ke],Je=0;Ke.id=Je;var Ye={},Xe=[],Ze=!1,Qe=!1,$e=jt,et=function(e,t){var n=``,r,i,a,o,s,c;return e&z.KQSIDE_CASTLE?n=e&z.KSIDE_CASTLE?`O-O`:`O-O-O`:e&z.DROP?(a=e>>j&N,r=e>>M,r&&(n+= __get$(me,r) ),n+=`@`+xe(a)):(a=e>>j&N,i=e>>A&N,o= __get$(H,i) ,o&h?(e&z.ANY_CAPTURE&&(n+=String.fromCharCode(be(i)+97)+`x`),n+=xe(a),e&z.PROMOTION&&(r=e>>M,n+=`=`+ __get$(me,r) )):(n+= __get$(ie,o&C) ,d>1&&(n+=Ft(o,i,a)),e&z.ANY_CAPTURE&&(n+=`x`),n+=xe(a))),t||(e&z.KQSIDE_CASTLE?(i=e>>A&N,a=e>>j&N):e&z.DROP_OR_PROMOTE&&(o= __get$(pe,r) +W),xt(o,i,a,e)&&($e(e,i,a,r),s=l,l=u,c=d,Be&&Lt()||bt()===l?n+=`#`:n+=`+`,u=l,l=s,d=c,Pt(Ke.pop()))),n};function tt(){var n=W===p?[4174784170,2938602761]:[0,0],r,i,a;for(a=0;a<120;++a)a&136&&(a+=8),r= __get$(H,a) ,r&&B(n, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,r&C)+8*(7-ye(a))+be(a)) );if(Qe)for(i=1;i<3;++i) __get$(G,i) &&( __get$(G,i) & __get$(G,i) -1?(B(n, __get$(e.zobristCastle,i-1) ),B(n, __get$(e.zobristCastle,i+1) )): __get$(G,i) >1<<be( __get$(U,i) )?B(n, __get$(e.zobristCastle,i-1) ):B(n, __get$(e.zobristCastle,i+1) ));else{for(i=1;i<3;++i) __get$(G,i) &&( __get$(G,i) &z.KSIDE_CASTLE&&B(n, __get$(e.zobristCastle,i-1) ), __get$(G,i) &z.QSIDE_CASTLE&&B(n, __get$(e.zobristCastle,i+1) ));Ze?je(n,V._hand):Be=== __get$(t,`3-check`) &&Ae(n,Xe)}return He!==f&&Me(H,n,He+(W===p?16:-16),h|W),n}function nt(){var e;return Ke.length?e= __get$(Ke,Ke.length-1) .hash:(Ke.hash||=tt(),e=Ke.hash),[e[0],e[1]]}function rt(e){function t(e){return/#/.test(e)&&Tt()&&(e= __call$(e,"replace",[`#`,`+`]) ),e}function n(n,r){var i=e(n,r);return i&&(typeof i==`string`?i=t(i):(i.san=t(i.san), __get$(Ke,Ke.length-1) .san=i.san)),i}return n._isBughouseified=!0,n._orig=e,n}function it(e,n){var r=Be;Be=e? __get$(t,e) ||e*1|| __get$(t,__call$(String(e),"replace",[/\s/g,``]).toLowerCase()) ||t.Chess:0,r!==Be&&(Be===t.Bughouse?(Ze=!0,V.isDependent||(V.siblingGame=ze(),V.siblingGame.hashing(Ve),V.siblingGame.isDependent=!0,V.siblingGame.siblingGame=V,V.siblingGame.header({Variant:`Bughouse`})),Ee(),$e=Nt,et=rt(et),V.move=rt(V.move)):(delete V.siblingGame,Ze=Be===t.Crazyhouse,Qe=Be===t.Chess960,Be?(Ee(),$e=Nt):$e=jt,et._isBughouseified&&(et=et._orig,V.move=V.move._orig)),n||pt(dt()))}function at(e,t){for(var n=e>7?p:m,r,i;!(e&136);){if(r= __get$(H,e) ,r&n){if(r&v){if(i)return;i=e%8+(n===p?65:97)}else if(r&b)return i}e+=t}}function ot(e,t,n){H=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=p, __set$(U,p,f) , __set$(U,m,f) , __set$(G,p,0) , __set$(G,m,0) , __set$(V._hand,p,0) , __set$(V._hand,m,0) , __set$(Xe,p,0) , __set$(Xe,m,0) ,He=f,Ue=0,We=1,t||(Ke=[],qe=[Ke],Je=0,Ke.id=Je,Ye={Event:`?`,Site:`?`,Date:`????.??.??`,Round:`?`,White:`?`,Black:`?`,Result:`*`},e?ft([`Variant`,e]):it(!1,n),n||pt(dt()))}function st(){ot(0,!1,!0),Ke.hash=[1178310168,378666140],H=[34,10,18,66,130,18,10,34,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,33,9,17,65,129,17,9,33,0,0,0,0,0,0,0,0],Ge=1, __set$(U,p,116) , __set$(U,m,4) , __set$(G,p,48) , __set$(G,m,48) }function ct(e,i,a,o){var s=0,c,l,u,d,g,_,y,S,C,w,E,D;if(o?(c=e.split(` `),D=c[3],E=c[2]):(c=e.trim().split(/\s+/),D=c[3]||`-`,E=c[2]||`-`),i===void 0?(E.charCodeAt(0)&31)<9&&it(t.Chess960,!0):it(i,!0),l=c[0],!o&&!(l=De(l,Be)))return!1;if(d=l.length,ot( __get$(n,Be) ,a,!0),Ze){if(Be===t.Bughouse&&!V.isDependent&&(_=e.split(` | `),!V.siblingGame.load(_.length===1?e:_[1],i,a,o)))return st(),!1;for(g=0;g<d;++g)if(y= __get$(l,g) ,+y!=+y)if(y===`/`)if(s>111){for(++g;g<d;++g)y= __get$(l,g) , __set$(V._hand,y<`a`?p:m,__get$(V._hand,y<`a`?p:m)+(1<<__get$(fe,y)>>>0)) ;break}else s+=8;else  __set$(H,s,__get$(ne,y)) , __get$(l,g+1) ===`~`&&(++g,H[s]|=T), __get$(H,s) &b&&( __set$(U,__get$(H,s)&x,s) ),++s;else s+=y*1}else for(g=0;g<d;++g)y= __get$(l,g) ,+y==+y?s+=y*1:y===`/`?s+=8:( __set$(H,s,__get$(ne,y)) , __get$(H,s) &b&&( __set$(U,__get$(H,s)&x,s) ),++s);if(W=c[1]===`b`?m:p,E!==`-`)if(Qe){for(C={1:[0,0],2:[0,0]},g=E.length-1;g>=0;--g)u=E.charCodeAt(g),u===75?u=at(119,-1):u===81?u=at(112,1):u===107?u=at(7,-1):u===113&&(u=at(0,1)),S=u<97?p:m,w= __get$(ge,String.fromCharCode(u)) ,(o|| __get$(H,w) ===(v|S))&&(u>=97? __get$(U,S) >=1&& __get$(U,S) <=6&&(G[S]|=1<<w): __get$(U,S) >=113&& __get$(U,S) <=118&&(G[S]|=1<<w-112),++ __get$(C,S) [( __get$(U,S) <w)*1]);( __get$(C,p) [0]>1|| __get$(C,p) [1]>1)&&( __set$(G,p,0) ),( __get$(C,m) [0]>1|| __get$(C,m) [1]>1)&&( __set$(G,m,0) )}else{if(!o)for(g=E.length-1;g>=0;--g)S=E.charCodeAt(g)<97?p:m,( __get$(H,__get$(ge,__get$(E,g))) !==(v|S)|| __get$(U,S) !==(S===p?116:4))&&(E=E.substr(0,g)+E.substr(g+1));for(g=E.length-1;g>=0;--g)switch( __get$(E,g) ){case`K`:G[p]|=z.KSIDE_CASTLE;break;case`Q`:G[p]|=z.QSIDE_CASTLE;break;case`k`:G[m]|=z.KSIDE_CASTLE;break;case`q`:G[m]|=z.QSIDE_CASTLE;break}}return!o&&(D.length!==2||W===p&&D[1]!==`6`||W===m&&D[1]!==`3`|| __get$(H,D.charCodeAt(0)-97+(8-(D[1]===`3`?4:5))*16) !==(h|Se(W))|| __get$(H,__get$(r,D)) )&&(D=`-`),He=D===`-`?f: __get$(r,D) ,Ue=c[4]*1||0,We=c[5]*1||1,Be=== __get$(t,`3-check`) &&(c[6]&&c[6]!==`+3+3`&&(_=c[6].match(/^\+([0-3])\+([0-3])$/)),_||=[0,0,0], __set$(Xe,p,_[1]*1) , __set$(Xe,m,_[2]*1) ),a||(Ge=We,pt(dt())),!0}function lt(){var e=0,t=``,n,r=``,i;for(n=0;n<120;++n)n&136&&(e&&(t+=e),t+=`/`,e=0,n+=8),i= __get$(H,n) ,i?(e&&=(t+=e,0),t+= __get$(re,i&C) ):++e;return e&&(t+=e), __get$(G,p) &z.KSIDE_CASTLE&&(r+=`K`), __get$(G,p) &z.QSIDE_CASTLE&&(r+=`Q`), __get$(G,m) &z.KSIDE_CASTLE&&(r+=`k`), __get$(G,m) &z.QSIDE_CASTLE&&(r+=`q`),t+=` `+(W===p?`w`:`b`)+` `+(r||`-`)+` `+(He===f?`-`:xe(He))+` `+Ue+` `+We,t}function ut(){var e=0,n=``,r,i,a=``,o;for(r=0;r<120;++r)r&136&&(e&&(n+=e),n+=`/`,e=0,r+=8),o= __get$(H,r) ,o?(e&&=(n+=e,0),n+= __get$(re,o&C) ,Ze&&o&T&&(n+=`~`)):++e;if(e&&(n+=e),Ze&&(n+=`/`+ke( __get$(V._hand,p) ,!0)+ke( __get$(V._hand,m) )),Qe){for(i= __get$(G,m) ,r=0;i;)i&1&&(a=String.fromCharCode(r+97)+a),i>>=1,++r;for(i= __get$(G,p) ,r=0;i;)i&1&&(a=String.fromCharCode(r+65)+a),i>>=1,++r}else  __get$(G,p) &z.KSIDE_CASTLE&&(a+=`K`), __get$(G,p) &z.QSIDE_CASTLE&&(a+=`Q`), __get$(G,m) &z.KSIDE_CASTLE&&(a+=`k`), __get$(G,m) &z.QSIDE_CASTLE&&(a+=`q`);return n+=` `+(W===p?`w`:`b`)+` `+(a||`-`)+` `+(He===f?`-`:xe(He))+` `+Ue+` `+We,Be=== __get$(t,`3-check`) ?n+=` +`+ __get$(Xe,p) +`+`+ __get$(Xe,m) :Be===t.Bughouse&&!V.isDependent&&(n+=` | `+V.siblingGame.fen()),n}function dt(){return Be?ut():lt()}function ft(e){var t,r,i;for(t=0;t<e.length;t+=2)r= __get$(e,t) ,i= __get$(e,t+1) ,r&&(r===`Variant`&&(it(i),i=Be? __get$(n,Be) :void 0),r===`Result`&&i!==`*`&&i!==`1-0`&&i!==`0-1`&&i!==`1/2-1/2`&&(i=`*`),i===void 0?_e.indexOf(r)>-1?r===`Date`? __set$(Ye,r,`????.??.??`) : __set$(Ye,r,`?`) :delete Ye[r]: __set$(Ye,r,String(i)) );return Ye}function pt(e){Ke.length>0||Je||(e===te?(delete Ye.SetUp,delete Ye.FEN,Ke.hash=[1178310168,378666140]):(Ye.SetUp=`1`,Ye.FEN=e,Ke.hash=null))}function mt(e){var t= __get$(H,__get$(r,e)) ;return t?{type: __get$(re,t&S|m) ,color:t&x,promoted:(t&T)!==0}:null}function ht(e,t){return Qe&& __get$(G,e) ?ce: __get$(G,e) &z.KSIDE_CASTLE&&! __get$(H,t+1) &&! __get$(H,t+2) ? __get$(G,e) &z.QSIDE_CASTLE&&! __get$(H,t-1) &&! __get$(H,t-2) &&! __get$(H,t-3) ?(s=z.KQSIDE_CASTLE,se):(s=z.KSIDE_CASTLE,ae): __get$(G,e) &z.QSIDE_CASTLE&&! __get$(H,t-1) &&! __get$(H,t-2) &&! __get$(H,t-3) ?(s=z.QSIDE_CASTLE,oe):R}function gt(e,t){var n,r,c,l=W,u,d,p,m,g,_,v,y,b,x,C=H;if(i=[],a=0,o=0,s=0,C[8]=C[9]=C[10]=C[11]=C[12]=C[13]=C[14]=C[15]=C[24]=C[25]=C[26]=C[27]=C[28]=C[29]=C[30]=C[31]=C[40]=C[41]=C[42]=C[43]=C[44]=C[45]=C[46]=C[47]=C[56]=C[57]=C[58]=C[59]=C[60]=C[61]=C[62]=C[63]=C[72]=C[73]=C[74]=C[75]=C[76]=C[77]=C[78]=C[79]=C[88]=C[89]=C[90]=C[91]=C[92]=C[93]=C[94]=C[95]=C[104]=C[105]=C[106]=C[107]=C[108]=C[109]=C[110]=C[111]=C[120]=C[121]=C[122]=C[123]=C[124]=C[125]=C[126]=C[127]=0,t===f){i=Ne(H,l|e);return}for(b=ht(l,t),n=0;n<120;++n)if(n&136&&(n+=8),u= __get$(H,n) ,u){if(u&l){(!e||(u|0)&e)&&i.push(n);continue}if(x= __get$(b,n-t+119) ,(x&u)!==0)if(u&h)for(_= __get$(F,u) ,r=1;r<3;++r)m=n+ __get$(_,r) ,!(m&136)&&(C[m+8]|=D,m===t&&(++a,C[n+8]|=O));else{_= __get$(F,u&S) ,g=_.length,y=u&E;attackLoop:for(r=0;r<g;++r)if(v= __get$(_,r) ,m=n,!(t>m&&v<0&&t-m>16||t<m&&v>0&&m-t>16))for(;!((m+=v)&136);){if(C[m+8]|=D,d= __get$(H,m) ,d){if(d&l){if(m===t){for(c=m-v;c!==n;c-=v)C[c+8]|=O;C[n+8]|=O,++a,y&&(m+=v,m&136||(C[m+8]|=D))}else if(y&&x&w){for(p=m;(p+=v)!==t;)if(p&136|| __get$(H,p) )continue attackLoop;C[m+8]|=k+(Math.abs(v)<<ee),++o}}break}if(!y)break}}}a>1&&(i=[t])}function _t(e,t){var n,r,i=t+16*(W===p?1:-1),o;return a===1&&( __get$(H,t+8) &O)===0&&( __get$(H,i+8) &O)===0?!1:(n= __get$(H,e) , __set$(H,t,n) , __set$(H,e,0) ,r= __get$(H,i) , __set$(H,i,0) ,o=wt(), __set$(H,e,n) , __set$(H,t,0) , __set$(H,i,r) ,!o)}function vt(e){var t,n,r;if(Qe){if( __get$(G,e) )for(t= __get$(U,e) ,n=t%8,r=0;r<8;++r) __get$(G,e) &1<<r&&Ie(H,t,r,e)&&( __set$(c,u++,(r>n?z.KSIDE_CASTLE:z.QSIDE_CASTLE)+(t<<A)+(t+(r-n)<<j)) ,++r)}else s&z.KSIDE_CASTLE&&(t= __get$(U,e) ,n=t+2, __get$(H,t+9) ===0&& __get$(H,t+10) ===0&&( __set$(c,u++,z.KSIDE_CASTLE+(t<<A)+(n<<j)) )),s&z.QSIDE_CASTLE&&(t= __get$(U,e) ,n=t-2, __get$(H,t+7) ===0&& __get$(H,t+6) ===0&&( __set$(c,u++,z.QSIDE_CASTLE+(t<<A)+(n<<j)) ))}function yt(e,t,n){var r,i,o,s,l;if(!e){for(t&&(t>>=26),s=0;s<5;++s)if((!t||(t|0)==1<<s)&& __get$(V._hand,n) & __get$(de,s) << __get$(ue,s) ){for(s===0?(r=16,i=103,o=z.DROP):(r=0,i=119,o=z.DROP|s<<M),l=r;l<=i;++l)l&136&&(l+=8), __get$(H,l) ||(a===0||a===1&& __get$(H,l+8) &O)&&( __set$(c,u++,o|l<<j) );if(t)return}}}function bt(e,t){var n,r,s,f=W,p=Se(f),m,_,v,y,b,x= __get$(U,f) ,C,w;for(gt(e,x),d=i.length,u=l,C=0;C<d;++C)if(n= __get$(i,C) ,m= __get$(H,n) ,!(a&&o&& __get$(H,n+8) &k))if(m&h)for(v= __get$(F,m) ,(o===0||( __get$(H,n+8) &k)===0|| __get$(H,n+8) >>ee===16)&&(_=n+v[0], __get$(H,_) ===0&&(Pe(H,n,_,0), __get$(he,f) ===ye(n)&&(_+=v[0], __get$(H,_) ||Pe(H,n,_,z.BIG_PAWN)))),r=1;r<3;++r)y= __get$(v,r) ,_=n+y,!(_&136||o&& __get$(H,n+8) &k&& __get$(H,n+8) >>ee!==Math.abs(y))&&( __get$(H,_) &p?Pe(H,n,_,z.CAPTURE):_===He&&_t(n,_)&&( __set$(c,u++,z.EP_CAPTURE|n<<A|_<<j) ));else{if(o&& __get$(H,n+8) &k){if(m&g)continue;if( __get$(L,n-__get$(U,f)+119) &m)y= __get$(H,n+8) >>ee,v=[y,-y];else continue}else v= __get$(F,m&S) ;if(w=n<<A,n===x){for(r=0;r<8;++r)y= __get$(v,r) ,_=n+y,_&136||( __get$(H,_) ? __get$(H,_) &p&&( __get$(H,_+8) &D)===0&&( __set$(c,u++,z.CAPTURE|w|_<<j) ):( __get$(H,_+8) &D)===0&&( __set$(c,u++,w|_<<j) ));a===0&&vt(f)}else for(s=v.length,b=m&E,r=0;r<s;++r)for(y= __get$(v,r) ,_=n;_+=y,!(_&136);){if( __get$(H,_) ){ __get$(H,_) &p&&(a===0|| __get$(H,_+8) &O)&&( __set$(c,u++,z.CAPTURE|w|_<<j) );break}else (a===0|| __get$(H,_+8) &O)&&( __set$(c,u++,w|_<<j) );if(!b)break}}return Be&&(Ze?yt(t,e,f):!Qe&&Lt()&&(u=l)),u}function xt(e,n,r,i){var a,o,s,c,l,u,d,m,g;if(Be=== __get$(t,`King of the Hill`) &&e&b&&Fe(r))return!0;if(i&z.KQSIDE_CASTLE&&(r=W===p?i&z.KSIDE_CASTLE?117:115:i&z.KSIDE_CASTLE?5:3,e=v,g=!0),a= __get$(U,Se(W)) ,a===f)return!1;if((e&b)===0&&(o= __get$(L,r-a+119) ,o&e))for(c= __get$(le,r-a+119) ,u=e&E,l=r+c;!(l&136);){if(l===a){if(e&h){if((e&x)===p?a-r<0:a-r>0)return!0;break}return!0}if(l!==n&& __get$(H,l) ||!u)break;l+=c}if(!g){if(s= __get$(L,n-a+119) ,s&E&&(c= __get$(le,n-a+119) ,c!== __get$(le,r-a+119) ))for(l=a-c;!(l&136);){if(l!==n&&(d= __get$(H,l) ,d)){if(d&W&&s&d&&d&E)return!0;break}l-=c}if(i&z.EP_CAPTURE&&(m=r+16*(W===p?1:-1),s= __get$(L,m-a+119) ,s&E))for(c= __get$(le,m-a+119) ,l=a-c;!(l&136);){if(l!==n&&l!==m){if(l===r)break;if(d= __get$(H,l) ,d){if(d&W&&s&d&&d&E)return!0;break}}l-=c}}return!1}function St(e,t){var n,r,i,a= __get$(F,g) ,o,s=g|e;for(n=0;n<8;++n)if(i=t+ __get$(a,n) ,!(i&136)&&(r= __get$(H,i) ,(r&s)===s))return!0;for(a= __get$(F,b) ,n=0;n<8;++n)for(o= __get$(a,n) ,i=t+o;!(i&136);){if(r= __get$(H,i) ,r){if(r&e&& __get$(L,t-i+119) &r)if(r&h){if(e===p?t-i<0:t-i>0)return!0}else return!0;break}i+=o}return!1}function Ct(e){return  __get$(U,e) !==f&&St(Se(e), __get$(U,e) )}function wt(){return Ct(W)}function Tt(){var e,t,n,r=1<<ue[4];return  __set$(V._hand,W,__get$(V._hand,W)+r) ,e=l,l=u,t=d,n=bt()!==l,u=l,l=e,d=t,V._hand[W]-=r,n}function Et(){return wt()&&(c[0]=0)===bt()&&!c[0]&&(Be!==t.Bughouse||!Tt())}function Dt(){var e=!wt()&&(c[0]=0)===bt()&&!c[0];return e&&Be===t.Bughouse&&!V.isDependent&&(e=V.siblingGame.inStalemate()),e&& __get$(U,W) !==f}function Ot(e){var t,n,r=100,i=0,a=0,o=0;for(n=0;n<120;++n)if(n&136&&(n+=8),t= __get$(H,n) ,t){if(e&&(t&e)===0)continue;if(r&t)return!1;if(t&g){if(a||i++)return!1}else if(t&_&&(i||(++a,(ye(n)+n)%2&&++o,o&&a!==o)))return!1}return  __get$(U,p) !==f&& __get$(U,m) !==f}function kt(){if(Ue<8)return!1;for(var e=nt(),t=!1,n,r=Ue,i=!1,a=Ke,o=a.length-1;;){if(o-=2,o<0){if(a.id){o=a.atMoveNode+o+2,a= __get$(qe,a.parentId) ;continue}if(o===-2)return!1;n=a.hash,i=!0}else n= __get$(a,o) .hash, __get$(a,o) .halfMoves>r||r<2?i=!0:r= __get$(a,o) .halfMoves;if(n[0]===e[0]&&n[1]===e[1]){if(t)return!0;t=!0}if(i)return!1}}function At(n){var r=n.move,i,a,o,s,c,l,u,d,f,m;if(Be===t.Crazyhouse||r&z.DROP?(a=V._hand,l=n.hash,m=n.color):(a=V.siblingGame._hand,n.handSibling=!0,Ve&&(u=V.siblingGame._history(),u.length?l= __get$(u,u.length-1) .hash:(u.hash||=V.siblingGame._hashPosition(),l=u.hash)),m=Se(n.color)),n.captured){switch(o=n.captured&T?h:n.captured&S,o&S){case h:d=0;break;case g:d=1;break;case _:d=2;break;case v:d=3;break;default:d=4}i=1<< __get$(ue,d) ,Ve&&(c= __get$(a,m) >> __get$(ue,d) & __get$(de,d) ,f= __get$(e.zobristPiece,c+63*d+(m===p?0:315)) )}else s=r>>M,i=-1<< __get$(ue,s) ,Ve&&(c= __get$(a,m) >> __get$(ue,s) & __get$(de,s) ,f= __get$(e.zobristPiece,c-1+63*s+(m===p?0:315)) ); __set$(a,m,__get$(a,m)+i) ,n.handChange=i,Ve&&B(l,[f[0]*31>>>0,f[1]*17>>>0])}function jt(t,n,r,i){var a=W,o=Se(a),s,c,l,u,d={move:t,epSquare:He,halfMoves:Ue,castlingW: __get$(G,p) ,castlingB: __get$(G,m) ,color:a},g,_,y=a===p,x,S;Ve&&(u=nt(),d.hash=u,B(u,e.zobristTurn),He!==f&&Me(H,u,He+(y?16:-16),h|a)),(t&z.KQSIDE_CASTLE)===0?Ze&&t&z.DROP?( __set$(H,r,__get$(pe,i)|a) ,Ve&&B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,__get$(H,r))+8*(7-ye(r))+be(r)) ),At(d),x=0):(x= __get$(H,n) ,S= __get$(H,r) ,S&&(d.captured=S,Ve&&B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,__get$(H,r)&C)+8*(7-ye(r))+be(r)) ),S&v&& __get$(G,o) &&(Qe?ye(r)===(y?0:7)&&(l=1<<be(r), __get$(G,o) &l&&(G[o]^=l,Ve&&(l>1<<be( __get$(U,a) )?B(u, __get$(e.zobristCastle,o-1) ):B(u, __get$(e.zobristCastle,o+1) )))):r===(y?7:119)? __get$(G,o) &z.KSIDE_CASTLE&&(G[o]^=z.KSIDE_CASTLE,Ve&&B(u, __get$(e.zobristCastle,o-1) )):r===(y?0:112)&& __get$(G,o) &z.QSIDE_CASTLE&&(G[o]^=z.QSIDE_CASTLE,Ve&&B(u, __get$(e.zobristCastle,o+1) )))),t&z.PROMOTION? __set$(H,r,__get$(pe,i)|a|T) : __set$(H,r,__get$(H,n)) , __set$(H,n,0) ,Ve&&(B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,x&C)+8*(7-ye(n))+be(n)) ),B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,__get$(H,r)&C)+8*(7-ye(r))+be(r)) ))):x=b,t&z.EP_CAPTURE?(y?(_=r+16,g=6):(_=r-16,g=8),d.captured=h|o, __set$(H,_,0) ,Ve&&B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,h|o)+8*(g-ye(r))+be(r)) )):x&b?(Qe?(t&z.KQSIDE_CASTLE&&( __set$(H,r,0) , __set$(H,n,0) ,t&z.KSIDE_CASTLE?y?(s=118,c=117):(s=6,c=5):y?(s=114,c=115):(s=2,c=3), __set$(H,s,a|b) , __set$(H,c,a|v) ,Ve&&(B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,b|a)+8*(7-ye(n))+be(n)) ),B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,v|a)+8*(7-ye(r))+be(r)) ),B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,b|a)+8*(7-ye(s))+be(s)) ),B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,v|a)+8*(7-ye(c))+be(c)) ))),Ve&&( __get$(G,a) & __get$(G,a) -1?(B(u, __get$(e.zobristCastle,a-1) ),B(u, __get$(e.zobristCastle,a+1) )): __get$(G,a) >1<<be( __get$(U,a) )?B(u, __get$(e.zobristCastle,a-1) ):B(u, __get$(e.zobristCastle,a+1) )), __set$(U,a,s||r) ):(t&z.KQSIDE_CASTLE&&( __set$(H,r,__get$(H,n)) , __set$(H,n,0) ,t&z.KSIDE_CASTLE?(s=r-1,c=r+1):(s=r+1,c=r-2), __set$(H,s,__get$(H,c)) , __set$(H,c,0) ,Ve&&(B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,b|a)+8*(7-ye(n))+be(n)) ),B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,v|a)+8*(7-ye(c))+be(c)) ),B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,b|a)+8*(7-ye(r))+be(r)) ),B(u, __get$(e.zobristPiece,64*__get$(e.zobristPieceValueNumbers,v|a)+8*(7-ye(s))+be(s)) ))),Ve&&( __get$(G,a) &z.KSIDE_CASTLE&&B(u, __get$(e.zobristCastle,a-1) ), __get$(G,a) &z.QSIDE_CASTLE&&B(u, __get$(e.zobristCastle,a+1) )), __set$(U,a,r) ), __set$(G,a,0) ):x&v&& __get$(G,a) &&(Qe?ye(n)===(y?7:0)&&(l=1<<be(n), __get$(G,a) &l&&(G[a]^=l,Ve&&(l>1<<be( __get$(U,a) )?B(u, __get$(e.zobristCastle,a-1) ):B(u, __get$(e.zobristCastle,a+1) )))):n===(y?119:7)? __get$(G,a) &z.KSIDE_CASTLE&&(G[a]^=z.KSIDE_CASTLE,Ve&&B(u, __get$(e.zobristCastle,a-1) )):n===(y?112:0)&& __get$(G,a) &z.QSIDE_CASTLE&&(G[a]^=z.QSIDE_CASTLE,Ve&&B(u, __get$(e.zobristCastle,a+1) ))),t&z.BIG_PAWN?(He=y?r+16:r-16,Ve&&Me(H,u,r,h|o)):He=f,x&h||t&z.ANY_CAPTURE?Ue=0:Ue++,W=o,Ke.push(d)}function Mt(){var t={color:W,san:`--`,epSquare:He},n={color:W,san:`--`},r;return Ve&&(r=nt(),t.hash=r,B(r,e.zobristTurn),He!==f&&Me(H,r,He+(W===p?16:-16),h|W)),He=f,Ue++,W=Se(W),W===p&&++We,Ke.push(t),n}function Nt(n,r,i,a){var o,s=W;jt(n,r,i,a),o= __get$(Ke,Ke.length-1) ,Ze?(Ue=o.halfMoves+1,o.captured&&At(o),Be===t.Bughouse&&(o.bughouseOrder=V.moveCount()-1+V.siblingGame.moveCount())):Be=== __get$(t,`3-check`) &&Ct(W)&&(o.checked=!0,Ve&& __get$(Xe,s) &&B(o.hash, __get$(e.zobristCheck,__get$(Xe,s)+(s===p?-1:2)) ),++Xe[s],Ve&&B(o.hash, __get$(e.zobristCheck,__get$(Xe,s)+(s===p?-1:2)) ))}function Pt(e){var n,r,i=W,a=Se(i),o=e.move,s=o>>j&N,c=o>>A&N;if(W=a, __set$(G,m,e.castlingB) , __set$(G,p,e.castlingW) ,He=e.epSquare,Ue=e.halfMoves,Be){if(Qe&&o&z.KQSIDE_CASTLE){o&z.KSIDE_CASTLE?a===p?(r=118,n=117):(r=6,n=5):a===p?(r=114,n=115):(r=2,n=3), __set$(H,r,0) , __set$(H,n,0) , __set$(H,c,a|b) , __set$(H,s,a|v) , __set$(U,a,c) ;return}if(e.handChange&&(Be===t.Crazyhouse||!e.handSibling?V._hand[a]-=e.handChange:V.siblingGame._hand[Se(a)]-=e.handChange),o&z.DROP){ __set$(H,s,0) ;return}e.checked&&--Xe[a]}o&z.PROMOTION?( __set$(H,c,h|a) ,o&z.CAPTURE? __set$(H,s,e.captured) : __set$(H,s,0) ):( __set$(H,c,__get$(H,s)) ,o&z.KQSIDE_CASTLE?( __set$(H,s,0) ,o&z.KSIDE_CASTLE?(n=s+1,r=s-1):(n=s-2,r=s+1), __set$(H,n,a|v) , __set$(H,r,0) , __set$(U,a,c) ):(s=== __get$(U,a) &&( __set$(U,a,c) ),o&z.CAPTURE? __set$(H,s,e.captured) :( __set$(H,s,0) ,o&z.EP_CAPTURE&&( __set$(H,s-(a===p?-16:16),h|i) ))))}function Ft(e,t,n){var r,i,a,o,s,l,d,f;if(u<2)return``;for(e&=S,f=0;f<u;++f)if(r= __get$(c,f) ,d=r>>j,n===d&&(o=r>>A&N,o!==t&&(i= __get$(H,o) ,i&e))){if(a=!0,ye(t)===ye(o)){if(s)return xe(t);l=!0}if(be(t)===be(o)){if(l)return xe(t);s=!0}}return a?s?String(8-ye(t)):String.fromCharCode(be(t)+97):``}function It(e,t,n){var r,i,a=e>>j&N,o={color:W,to:xe(a),flags:e&N};return!Ze||(e&z.DROP)===0?(r=e>>A&N,o.from=xe(r),o.piece= __get$(H,r) ,e&z.PROMOTION&&(i=e>>M,o.promotion= __get$(pe,i) +W),e&z.CAPTURE?o.captured= __get$(H,a) :e&z.EP_CAPTURE&&(o.captured=h|Se(W))):(i=e>>M,o.drop=i,o.piece= __get$(pe,i) +W),t?o.san=t:o.san=et(e,n),o}function Lt(){if(Be=== __get$(t,`3-check`) )return  __get$(Xe,Se(W)) ===3;if(Be=== __get$(t,`King of the Hill`) )return Fe( __get$(U,Se(W)) )}function Rt(){if(Be===t.Bughouse)return V.siblingGame.inCheckmate()}function zt(){if(Be===t.Bughouse)return V.siblingGame.in50MoveRule()||V.siblingGame.inThreefoldRepetition()}function Bt(){var e=[],t=dt(),n=Ke.length-1,r= __get$(Ke,n) ;return r?(e.parentId=Je,e.id=qe.length,Ke.curFen=t,r.lines||=[],r.lines.push(e.id),r.move?Pt(r):(He=r.epSquare,--Ue,W=Se(W)),W===m&&--We,e.atMoveNode=n,n?e.hash= __get$(Ke,n-1) .hash:e.hash=Ke.hash,Je=e.id,qe.push(e),Ke=e,!0):!1}function Vt(e){Ke.curFen=dt(),Ke= __get$(qe,e) ,Je=e,ct(Ke.curFen,Be,!0,!0)}return V={WHITE:p,BLACK:m,PAWN:h,KNIGHT:g,BISHOP:_,ROOK:v,QUEEN:y,KING:b,FLAGS:z,load:ct,reset:st,moves:function(e){var t=[],n,r=et,i,a;for(e&&(e.verbose&&(r=It),e.type&&(i=e.type|e.type<<24),a=e.noDrop),bt(i,a),n=0;n<u;++n)t.push(r( __get$(c,n) ));return t},inCheck:wt,inCheckmate:Et,inStalemate:Dt,isBughouseWin:Rt,in50MoveRule:function(){return Ue>=100},inDraw:function(){return Ue>=100||Dt()||Ot()||kt()||!!zt()},insufficientMaterial:Ot,inThreefoldRepetition:kt,isVariantWin:Lt,gameOver:function(){return V.inDraw()||Et()||!!Lt()||!!Rt()},isPositionValid:function(e){var t,n,r=0,i;if(e||={},e.pawns!==!1)for(t=0;t<=119;){if(i= __get$(H,t) ,i&h)return!1;++t===8&&(t=112)}if(e.kings!==!1){for(t=0;t<=119;++t)if(t&136&&(t+=8),i= __get$(H,t) ,i&b){if(++r>2||n&&n&i)return!1;n=i&x}if(r!==2)return!1}return!(e.check!==!1&&!(e.kings===!1&& __get$(U,Se(W)) ===f)&&Ct(Se(W)))},validateFen:Oe,fen:dt,pgn:function(e){return e||={},!e.useResultHeader&&!Je&&(Lt()||Et()?Ye.Result=W===m?`1-0`:`0-1`:V.inStalemate()?Ye.Result=`1/2-1/2`:Rt()&&(Ye.Result=V.siblingGame.turn()===p?`1-0`:`0-1`)),Le(e,Ye,qe,Ge,Be,V)},loadPgn:function(e,t,n){var r,i,a,o,s={},c,l,u=0,d;if(typeof t!=`number`&&(n||=t,t=0),n||={},typeof e==`string`&&(n.singleGame&&(e= __call$(e,"replace",[/(?:\r?\n\s*){2,}/g,`
`]) ),e=V.tokenizePgn(e,n)),t<0&&(t=e.length+t),o= __get$(e,t) ,!o)return!1;for(st(),i=o.length,r=0;r<i&&(a= __get$(o,r) ,a.type===`tagName`);++r){if(! __get$(o,r+1) || __get$(o,r+1) .type!==`tagValue`)return!1;++r,a.value===`FEN`?d=we( __get$(o,r) .value): __set$(s,a.value,__get$(o,r).value) }if(n.variant&&(s.Variant=n.variant),s.Variant&&!d&&(d=te),d||s.SetUp===`1`){if(s.SetUp===`0`)s.FEN=d;else if(!d||!ct(d,s.Variant))return!1}for(V.header(s),c=V,l=c._history();r<i;++r)if(a= __get$(o,r) ,a.type===`san`&&u===0){if(!c.move(a.value)&&(a.value!==`Z0`&&a.value!==`<>`||n.rejectNullMoves||!c.move(`--`)))if(n.commentErrors)l.length? __get$(l,l.length-1) .comment=(( __get$(l,l.length-1) .comment||``)+` `+a.value).trim():l.initComment=((l.initComment||``)+` `+a.value).trim();else if(n.skipBadLines&&(Je!==0||Ke.length&&n.allowBadMainLine))u=1;else return st(),!1}else if(a.type===`result`&&Ye.Result===`*`)ft([`Result`,a.value]);else if(a.type===`a`&&u===0&& __get$(l,l.length-1) ) __get$(l,l.length-1) .annotation=a.value;else if((a.type===`nag`||a.type===`aa`)&&u===0&& __get$(l,l.length-1) ) __get$(l,l.length-1) .additionalAnnotation||( __get$(l,l.length-1) .additionalAnnotation=[]), __get$(l,l.length-1) .additionalAnnotation.indexOf(a.value)===-1&& __get$(l,l.length-1) .additionalAnnotation.push(a.value);else if(a.type===`comment`&&u===0)l.length?(a.value&&( __get$(l,l.length-1) .comment=a.value),a.commands&&( __get$(l,l.length-1) .commands=a.commands,a.commands.clk&&( __get$(l,l.length-1) .time=Te(a.commands.clk)))):(l.initComment=String(a.value),a.commands&&(l.commands=a.commands));else if(a.type===`variationStart`){if(u>0)++u;else if(!Bt())return st(),!1;l=c._history()}else if(a.type===`variationEnd`)u>0&&--u,u===0&&(Vt(l.parentId),l=c._history());else if(a.type===`number`){if(c=/b/i.test(a.value.slice(-1))?V.siblingGame:V,!c)return!1;l=c._history()}else a.type===`cont`&&Je&&!l.length&&c.move( __get$(__get$(c._lines(),l.parentId),l.atMoveNode) .san);return!0},header:function(e){return Array.isArray(e)?ft(e):(typeof e==`object`&&Object.keys(e).forEach(function(t){ft([t, __get$(e,t) ])}),Ye)},turn:function(e){return(e===p||e===m)&&(W=e),W},move:function e(t){var n,i,a,o,s,l,d,f,m,g,_,v,y;if(typeof t==`string`){switch(o=t.length-1, __get$(t,o) ){case`+`:case`#`:t=t.substr(0,o)}for(m=P.indexOf(t[0])>6? __get$(I,t[0]) :t[0]===`O`?b:h,Ze&&(t.indexOf(`@`)===-1?g=!0:(g=!1,m<<=24)),bt(m,g),o=0;o<u;++o)if(l=et( __get$(c,o) ,!0),t===l){i= __get$(c,o) ;break}if(i)d=i>>A&N,f=i>>j&N,a=i>>M;else if(t===`--`)return Mt();else{if(t=V.fixMove(t))try{return e(t)}catch{}return null}}else{if(t.drop){switch(t.drop){case`p`:a=0;break;case`n`:a=1;break;case`b`:a=2;break;case`r`:a=3;break;case`q`:a=4;break;default:return null}m=1<<26+a}else{if(t.promotion)switch(t.promotion){case`q`:a=4;break;case`n`:a=1;break;case`r`:a=3;break;case`b`:a=2;break;default:return null}d= __get$(r,t.from) ,g=!0,m= __get$(H,d) &S}for(f= __get$(r,t.to) ,n=((a?a<<M:0)|f<<j)>>A|d,bt(m,g),o=0;o<u;++o)if( __get$(c,o) >>A===n){i= __get$(c,o) ;break}if(!i)return(t=V.fixMove(t))?e(t):null}return y=i&z.DROP_OR_PROMOTE? __get$(pe,a) +W: __get$(H,d) ,s=It(i,l,!0),_=xt(y,d,f,i),$e(i,d,f,a),_&&(Be&&Lt()||bt()===0?s.san+=`#`:s.san+=`+`),v= __get$(Ke,Ke.length-1) ,v.san=s.san,s.piece&T&&(v.promoted=!0),W===p&&++We,s},undo:function(e){var t=Ke.pop();return t?(W===p&&--We,t.move?(Pt(t),e?!0:It(t.move,t.san)):(He=t.epSquare,--Ue,W=Se(W),e?!0:{san:`--`,color:t.color})):null},clear:function(e){ot(e)},put:function(e,t,n){var i= __get$(r,t) ,a=!1,o,s= __get$(H,i) ,c=s&x,l=e.color;if(isNaN(i)||!e.type||!l||P.indexOf(e.type)===-1)return!1;if( __set$(H,i,__get$(I,e.type)|l|(e.promoted?T:0)) , __get$(H,i) &b&&( __set$(U,l,i) ),s&& __get$(H,__get$(U,c)) && __get$(H,__get$(U,c)) !==(b|c)){for(o=0;o<120;++o)o&136&&(o+=8), __get$(H,o) ===(b|c)&&( __set$(U,c,o) ,a=!0);a||( __set$(U,c,f) )}return n||ct(dt(),Be,!1,!1),!0},get:mt,remove:function(e,t){var n= __get$(H,__get$(r,e)) ,i=mt(e),a=n&x,o;if( __set$(H,__get$(r,e),0) ,n&b){for( __set$(U,a,f) , __set$(G,a,0) ,o=0;o<120;++o)if(o&136&&(o+=8), __get$(H,o) ===(b|a)){ __set$(U,n.color,o) ;break}}return t||ct(dt(),Be,!0,!1),i},history:function(e,t){for(var n=[],r,i=Ke,a=i.length;;){if(--a===-1)if(i.id&&!t){a=i.atMoveNode,i= __get$(qe,i.parentId) ;continue}else break;e?(r=It( __get$(i,a) .move, __get$(i,a) .san),r.color= __get$(i,a) .color,!a&&i.initComment&&(r.firstComment=i.initComment), __get$(i,a) .comment!==void 0&&(r.comment= __get$(i,a) .comment), __get$(i,a) .time!==void 0&&(r.time= __get$(i,a) .time), __get$(i,a) .annotation!==void 0&&(r.annotation= __get$(i,a) .annotation), __get$(i,a) .additionalAnnotation!==void 0&&(r.additionalAnnotation= __get$(i,a) .additionalAnnotation), __get$(i,a) .commands!==void 0&&(r.commands= __get$(i,a) .commands), __get$(i,a) .captured!==void 0&&(r.captured= __get$(i,a) .captured), __get$(i,a) .promoted!==void 0&&(r.promoted= __get$(i,a) .promoted), __get$(i,a) .lines!==void 0&&(r.lines= __get$(i,a) .lines), __get$(i,a) .bughouseOrder!==void 0&&(r.bughouseOrder= __get$(i,a) .bughouseOrder),P.indexOf( __get$(i,a) .san[0])>6?r.piece= __get$(I,__get$(i,a).san[0]) : __get$(i,a) .san[0]===`O`?r.piece=b:r.piece=h,r.piece|=r.color,n.unshift(r)):n.unshift( __get$(i,a) .san)}return n},hashes:function(){for(var e=[],t=Ke,n=t.length;;){if(--n===-1)if(t.id){n=t.atMoveNode,t= __get$(qe,t.parentId) ;continue}else{t.hash||nt(),e.unshift(t.hash);break}e.unshift( __get$(t,n) .hash)}return e},moveCount:function(){return Ke.length},startingMoveNumber:function(){return Ge},completeFen:we,createVariation:Bt,selectLine:Vt,hash:function(){var e=nt();return Be===t.Bughouse&&!V.isDependent?[e,V.siblingGame.hash()]:e},hashing:function(e){Ve=e,Be===t.Bughouse&&!V.isDependent&&V.siblingGame.hashing(Ve)},hand:function(){if(Ze)return ke( __get$(V._hand,p) ,!0)+ke( __get$(V._hand,m) )},checks:function(){if(Be=== __get$(t,`3-check`) )return[ __get$(Xe,p) , __get$(Xe,m) ]},threats:function(){var e=W,t=Se(e),n=[],r=[],i=[],s=[],d=[],p=He,m,h,g,_,v,y,b;if(gt(0, __get$(U,e) ),a||o)for(m=0;m<120;++m)m&136&&(m+=8), __get$(H,m+8) &O&& __get$(H,m) ?i.push(xe(m)): __get$(H,m+8) &k&&n.push(xe(m));for(W=t,He=f,bt(),m=u;m--;){if(h= __get$(c,m) ,v=h>>j&N,y=h>>A&N,h&z.DROP_OR_PROMOTE){if(b=h>>M,_= __get$(pe,b) |t,h&z.PROMOTION&&b%3!=1)continue}else _= __get$(H,y) ,b=0;if(xt(_,y,v,h)&&($e(h,y,v,b),l=m,(Be&&Lt()||bt()===m)&&r.push((h&z.DROP? __get$(re,_) .toLowerCase()+`@`:xe(y))+xe(v)),Pt(Ke.pop()),h&z.CAPTURE)){for(g=0,m=u;m>l;)if(( __get$(c,--m) >>j&N)===v){g=1,m=l;break}if(!g){s.push(xe(y)+xe(v));continue}}h&z.CAPTURE&&b!==1&&(g= __get$(H,v) &124)&&(St(e,v)?(_= __get$(H,y) &S,g>_&&g-_!==8&&d.push(xe(y)+xe(v))):s.push(xe(y)+xe(v)))}return l=0,W=e,He=p,{pins:n,checkers:i,mates:r,undefended:s,underdefended:d}},tokenizePgn:Re,fixMove:function(e){var t,n,i;if(typeof e==`string`){if(/0|[?!+#]$|[18][QNRB]$|^P/i.test(e))return  __call$(__call$(__call$(__call$(e,"replace",[/[?!+#]+$/,``]),"replace",[/0/g,`O`]),"replace",[/([18])([QNRB])$/i,`$1=$2`]),"replace",[/^P+/i,``]) ;if(n=e.indexOf(`=`)>0?-4:-2,t= __get$(r,e.substr(n,2)) ,typeof t==`number`){if( __get$(H,t) &Se(W)||/^[a-h]x?[a-h][36]$/.test(e)){if(e.indexOf(`x`)===-1)return e.slice(0,n)+`x`+e.substr(n)}else if(e.indexOf(`x`)>-1)return  __call$(e,"replace",[/x/g,``]) ;if(i=e.match(/^([KQNRB]?)([a-h][1-8]?|[1-8])x?([a-h][1-8])=?(.?)$/)){if( __get$(H,__get$(r,i[2])) )return{from:i[2],to:i[3],promotion:i[4].toLowerCase()};if(/^\d$/.test(i[2])){for(e=0,bt( __get$(I,i[1]) ,!0),n=0;n<u;++n)if( __get$(c,n) >>j===t&&ye( __get$(c,n) >>A&N)===8-i[2]){if(e)return;e= __get$(c,n) }if(e)return et(e,!0)}return i[1]+i[3]+i[4]}}}else if( __get$(H,__get$(r,e.from)) ===(b|W)&&e.to&&e.from[1]===e.to[1]){if(e.from<e.to)return`O-O`;if(e.from>e.to)return`O-O-O`}},_hand:[],_history:function(e){return e&&(Ke=e,Je=Ke.id),Ke},_lines:function(){return qe},_hashPosition:tt,_board:function(){return H}},ve&&ct(ve,Ce)||st(),V}return ze.variants=n,ze}(),r=function(t){var n=`rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1`,r=[`bench`,`d`,`eval`,`flip`,`isready`,`ponderhit`,`stop`,`uci`,`ucinewgame`],i=[{cmd:`position`,args:[`fen`,`startpos`,`moves`,`continuation`]},{cmd:`go`,args:[`binc`,`btime`,`confidence`,`depth`,`infinite`,`mate`,`mindepth`,`mintime`,`maxdepth`,`maxtime`,`movestogo`,`movetime`,`ponder`,`searchmoves`,`shallow`,`winc`,`wtime`]}],a=[`moves`,`searchmoves`],o=[`ponder`,`infinite`,`startpos`],s={depth:1,seldepth:1,time:1,nodes:1,multipv:1,cp:1,mate:1,currmovenumber:1,hashfull:1,nps:1,tbhits:1,sbhits:1,cpuload:1,bmc:1,score:2,lowerbound:2,upperbound:2,bestmove:3,ponder:3,baseTurn:3,bestmoveSan:3,ponderSan:3,pv:4,pvSan:4,string:4,refutation:4,currline:4},c=/(?:Total|Final) Evaluation[\s\S]+\n$/i;function l(e,t,n){var r=new Worker(e||`stockfish.js`),i={terminate:o,postMessage:a};function a(e){ __call$(r,"postMessage",[e]) }function o(){r.terminate()}function s(e){var t=e.concat();e.length=0,t.forEach(function(e){e.cmd?e.cmd.substr(0,2)!==`go`&&n.send(e.cmd,e.cb,e.stream):(clearTimeout(e.timer),n.getBestMove(e.args,e.cb,e.stream))})}return r.onmessage=function(e){typeof e.data==`string`&&i.onmessage(e.data)},r.onerror=function(a){if(n.fallbackPath&&n.fallbackPath!==e){try{a.preventDefault()}catch{}try{r.terminate()}catch{}return r=l(n.fallbackPath,t,n),r.onmessage=function(e){i.onmessage(e)},s(n._activeCommands()),s(n._bestMoveQueue()),!1}if(t.onError)return t.onError(a)},i}function u(e,n){n.fallbackPath=e.pathToNonWasmEngine,n.path=e.enginePath||e.pathToEngineWorker,n.wasmPath=e.pathToWasmEngine,e.engines&&(e.engines.multiThreaded&&t.supportsMultithreading()?(n.path=e.engines.multiThreaded.loader,n.wasmPath=e.engines.multiThreaded.engine):e.engines.singleThreaded&&(n.path=e.engines.singleThreaded.loader,n.wasmPath=e.engines.singleThreaded.engine),n.fallbackPath=e.engines.asm||n.fallbackPath)}function d(e,t){var n;return u(e,t),n=t.path,(t.fallbackPath&&typeof WebAssembly>`u`||!n)&&(n=t.fallbackPath),t.wasmPath&&(n+=`#`+t.wasmPath),l(n,e,t)}function f(e){for(var t=e.split(` `),n=t.length,r=t[0]===`info`?1:0,i={mtype:t[0]},a,o;r<n;++r)if(o= __get$(t,r) ,o)if(a= __get$(s,o) ,a===1){for(;! __get$(t,++r) &&r<n;); __set$(i,o,Number(__get$(t,r))) }else if(a===2) __set$(i,o,!0) ;else if(a===3){for(;! __get$(t,++r) &&r<n;); __set$(i,o,__get$(t,r)) }else for( __set$(i,o,[]) ,++r;r<n;++r)if(! __get$(s,__get$(t,r)) ) __get$(t,r) && __get$(i,o) .push( __get$(t,r) );else{--r;break}return(i.bestmove===`(none)`||i.bestmove===`0000`)&&(i.bestmove=void 0,i.bestmoveSan=void 0),(i.ponder===`(none)`||i.ponder===`0000`)&&(i.ponder=void 0,i.ponderSan=void 0),i}function p(e){var t=e.indexOf(` `);return t===-1?e:e.substr(0,t)}function m(e){return __call$(__call$(e+``,"replace",[/^([^/]+)((?:\/[^/]+){7})\/([qrbnp]*)/i,`$1$2[$3]`]),"replace",[/( \d+ \d+) \+([0-3])\+([0-3])/,function(e,t,n,r){return` `+(3-n)+`+`+(3-r)+t;}]) }function h(e){return __call$(__call$(e+``,"replace",[/\[([qrbnp]*)\]/i,`/$1`]),"replace",[/([0-3])\+([0-3]) (\d+ \d+)/,function(e,t,n,r){return r+` +`+(3-t)+`+`+(3-n);}]) }function g(e,t){var n,r=p(e),i,a,o;for(n=r===`uciok`||r===`option`?`uci`:r===`readyok`||r===`ready`?`isready`:r===`json`||e.indexOf(`info string CEEError`)>=0?`fetch`:r===`bestmove`||r===`info`?`go`:`other`,o=t.length,a=0;a<o;a+=1)if(i=p( __get$(t,a) .cmd),i===n||n===`other`&&(i===`d`||i===`eval`))return a;return 0}function _(e){var t=e.match(/id name ((\S+) ([\d.a-z]+).*)/i);if(t)return{all:t[1].trim(),short:t[2],version:t[3],full:t[2]+` `+t[3],wasm:/ wasm/i.test(e),multithreaded:/ multithreaded/i.test(e)}}function v(s,l){var u={},b,x=[],S,C=[],w,T=null;function E(e){var n,r=0,i,a,o;if(e.indexOf(`
`)>-1){for(a=e.split(`
`),o=0;o<a.length;o+=1)E( __get$(a,o) );return}if(t.log&&console.log(`debug (onmessage): `+e),u.stream&&u.stream(e),!x.length||e.indexOf(`No such option`)===0||e.indexOf(`Stockfish`)===0||e.indexOf(`Komodo`)===0||e.indexOf(`Explanation Engine`)===0||e.indexOf(`info string variant`)===0){if(s.ceeMode&&e.indexOf(`Explanation Engine`)===0){var l=e.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)\s*\(C\)/);l?T={date:l[1],increment:l[2]}:(l=e.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)\.([0-9]+)/),T={major:l[1],minor:l[2],patch:l[3]})}return}if(r=g(e,x),i= __get$(x,r) ,i.stream&&!i.discard&&i.stream(e),i.message===void 0?i.message=``:i.message!==``&&(i.message+=`
`),i.message+=e,e.indexOf(`uciok`)===0)u.name=_(i.message),n=!0;else if(e.indexOf(`ready`)===0)n=!0;else if((e.indexOf(`bestmove`)===0||p(e)===`bestmove`)&&i.cmd!==`bench`)n=!0,i.message=e;else if(i.cmd===`d`)(e.indexOf(`Legal uci moves`)===0||e.indexOf(`Key is`)===0)&&(i.done=!0,n=!0);else if(i.cmd.indexOf(`fetch`)===0)try{var d=i.message.split(`
`).filter(function(e){return e.includes(`json`)}).join(`
`);d&&(i.message=JSON.parse( __call$(__call$(d,"replace",[/^json /gm,``]),"replace",[/\n/g,``]) ),n=!0)}catch{}else i.cmd===`eval`?c.test(i.message)&&(n=!0):(e.indexOf(`pawn key`)===0||e.indexOf(`Nodes/second`)===0||e.indexOf(`Unknown command`)===0)&&(n=!0);n&&(x.splice(r,1),i.cb&&!i.discard?i.cb(i.message):i.ondiscard&&i.ondiscard())}function D(e){return e!==`ucinewgame`&&e!==`flip`&&e!==`stop`&&e!==`ponderhit`&&e.indexOf(`position`)!==0&&e.indexOf(`setoption`)!==0&&e.indexOf(`variation`)!==0&&e.indexOf(`threat-variation`)!==0&&e.indexOf(`push`)!==0&&e.indexOf(`pop`)!==0&&e.indexOf(`serve`)!==0&&e.indexOf(`speech`)!==0}u.send=function(e,n,r){var i;e=String(e).trim(),D(e)? __set$(x,x.length,{cmd:e,cb:n,stream:r}) :i=!0,b&&(t.log&&console.log(`stdin: `+e), __call$(b,"postMessage",[e]) ,i&&n&&setTimeout(n,0))},u._activeCommands=function(){return x},u._bestMoveQueue=function(){return C},u.quit=function(){if(b&&b.terminate){try{u.send(`quit`)}catch{}b.terminate(),b=null,u.ready=void 0}clearTimeout(S)},r.forEach(function(e){ __set$(u,e,function(t,n){u.send(e,t,n);}) }),i.forEach(function(e){ __set$(u,e.cmd,function(t,n,r){var i=[e.cmd];(w&&t.fen)&&(t.fen=m(t.fen)),e.args.forEach(function(e){if(__get$(t,e)||__get$(t,e)===0){if(a.indexOf(e)>-1){if(!__get$(t,e)||!__get$(t,e).length)return;Array.isArray(__get$(t,e))&&__set$(t,e,__get$(t,e).join(` `));}i.push(e),o.indexOf(e)===-1&&i.push(__get$(t,e));}}),u.send(i.join(` `),n,r);}) }),u.setoption=function(e,t){u.send(`setoption name `+e+` value `+t)},u.setVariant=function(e){var t;e!==w&&(t= __call$(String(e).toLowerCase(),"replace",[/ |-/g,``]) ,!e||t===`chess`?(t=void 0,u.setoption(`UCI_Variant`,`chess`),u.setoption(`UCI_Chess960`,`false`)):t===`chess960`?(u.setoption(`UCI_Variant`,`chess`),u.setoption(`UCI_Chess960`,`true`)):(t===`threecheck`&&(t=`3check`),u.setoption(`UCI_Variant`,t),u.setoption(`UCI_Chess960`,`false`)),w=t)},u.loadBook=function(t,n){u.pathToBook=t,e.loadBook(t,function(e,t){u.book=t,u.bookLoaded=!0,e&&(console.error(`Error loading opening book.`),console.error(e),u.pathToBook=null,u.bookLoaded=!1),n()})},u.getBookMove=function(e){var n=t.createGame(e),r=u.book.pick({fen:n.fen(),type:e.bookPick===void 0?`random`:e.bookPick,chess960:n.header().Variant===`Chess960`}),i=r&&n.move(r);if(i)return{moveSan:i.san,moveLan:r,move:{from:i.from,to:i.to,promotion:i.promotion||null},baseTurn:n.turn()===1?`b`:`w`,pv:[{moveSan:i.san,moveLan:r}],depth:null,score:null,mateIn:null,isBookMove:!0}};function O(){var e=1,r=[],i=[],a,o,s=null,c=C[0].args,l=C[0].cb,d=C[0].stream,p,m=1,g,_=[],y=14,b=v._previousCP;C[0].started=!0,v._previousCP=null;function x(e){var t=[],n= __get$(i,e) ||A( __get$(r,e) );return  __get$(r,e) .forEach(function(e,r){t.push({moveSan: __get$(n,r) ,moveLan:e})}),t}function w(e,t,n,i){var a;for(a=r.length-1;a>=0;--a)if( __get$(r,a) [0]===e)return x(a);return n?[{moveSan:t,moveLan:e},{moveSan:i,moveLan:n}]:t?[{moveSan:t,moveLan:e}]:[]}function T(e){var t=.03*32**(e.depth/y);e.cp=b+(e.cp-b)*t}function E(e){e.mate===0?(e.mateIn=0,e.cp=-31800*m):(e.mateIn=Number(e.mate*m)||null,typeof e.mateIn==`number`&&!isNaN(e.mateIn)&&typeof e.cp!=`number`?e.cp=31800*m*(e.mate/Math.abs(e.mate)):(e.cp*=m,Math.abs(e.cp)===9&&(e.cp=0),c.normalize&&e.depth<=y&&typeof b==`number`&&e.multipv===1&&T(e))),e.score=e.cp/100}function D(t){var n=f(t);if(ee(n),e>y&&a<5e3&&a>-5e3&&(v._previousCP=a),n.pv=w(n.moveLan,n.moveSan),n.pv.length===1&&n.ponder&&(n.pv=w(n.moveLan,n.moveSan,n.ponder,n.ponderSan)),_.length>1)_.splice(_.indexOf(n.moveLan),1),c.searchmoves=_,c.getNextBest=0,k(c,function(){l(n)},function(e){d&&(e.multipv=2,d(e))});else if(l)try{l(n)}catch(e){console.error(e)}C.shift(),clearTimeout(S),C.length>0&&O()}function ee(n){var r;n.baseTurn=p,n.cp=a,n.score=a/100,n.mate=o,n.mateIn=s,n.depth=e,n.moveLan=n.bestmove,n.moveLan&&(n.move=t.uciToObj(n.moveLan)[0],r=g.move(n.move),r&&(n.moveSan=n.bestmoveSan=r.san,n.ponder&&(r=g.move(t.uciToObj(n.ponder)[0]),r&&(n.ponderSan=r.san,g.undo(!0))),g.undo(!0)))}function A(e){var n,r=e.length,i=[],a;for(n=0;n<r&&(a=g.move(t.uciToObj( __get$(e,n) )[0]),a);++n)i.push(a.san);for(;n>0;--n)g.undo(!0);return i}function j(t){var n=f(t);n.score&&(n.baseTurn=p,E(n),!n.multipv&&n.depth&&(n.multipv=1),(n.multipv===1||n.depth===0)&&(a=n.cp,o=n.mate,s=n.mateIn)),n.pv&&d&&(n.pvSan=A(n.pv)),n.pv&&!(n.lowerbound||n.upperbound)&&(r.push(n.pv),d&&i.push(n.pvSan)),n.depth>e?e=n.depth:n.mtype===`bestmove`&&ee(n),d&&!(n.mateIn===0&&n.pv)&&d(n),M()}function M(){c.timeout&&(clearTimeout(S),C[0].timer=S=setTimeout(function(){u.stop(),l&&=(l(),void 0)},c.timeout))}c.difficulty>=0&&c.difficulty<20?(u.setoption(`Skill Level`,c.difficulty),c.maximumError>=0&&c.maximumError<=4999&&u.setoption(`Skill Level Maximum Error`,c.maximumError),c.errorProbability>=1&&c.errorProbability<=128&&u.setoption(`Skill Level Probability`,c.errorProbability)):u.setoption(`Skill Level`,20),c.contempt===void 0?u.setoption(`Contempt`,`0`):u.setoption(`Contempt`,c.contempt),c.multiPv>1?u.setoption(`MultiPV`,c.multiPv):u.setoption(`MultiPV`,1),!c.movetime&&(!c.wtime||!c.btime)&&!c.depth&&(c.btime=c.btime||72e3,c.wtime=c.wtime||72e3),(c.startpos||!c.fen)&&!c.moves&&!c.variant?(p=`w`,g=t.createGame({disableHashing:!0})):(g=t.createGame({fen:c.fen?h(c.fen):n,moves:c.moves,variant:c.variant,disableHashing:!0}),g.turn()===g.WHITE?p=`w`:(p=`b`,m=-1)),u.setVariant(c.variant),u.position(c),u.go(c,D,j),c.getNextBest&&l&&g.moves({verbose:!0}).forEach(function(e){e=t.normalizeMoveObj(e),_.push(e.from+e.to+(e.promotion||``))}),M()}function k(e,t,n){C.push({args:e,cb:t,stream:n}),C.length===1&&O()}u.getBestMove=function(e,t,n){var r;if(e||={},e.fen=e.fen||e.baseFen,e.is960&&(e.variant=`Chess960`),u.bookLoaded&&e.useBook&&(r=u.getBookMove(e),r))return setTimeout(function(){r.mtype=`bestmove`,t(r)},0);k(e,t,n)},u.stopAll=function(e){var n,r=x.length,i=0;function a(){--i,i===0&&e()}for(C=[],n=0;n<r;n+=1)t.log&&console.log(`debug (stop_moves): `+n,p( __get$(x,n) .cmd)),p( __get$(x,n) .cmd)===`go`&&! __get$(x,n) .discard&&(u.stop(), __get$(x,n) .discard=!0,e&&(i+=1, __get$(x,n) .ondiscard=a));e&&!i&&u.isready(e)},u.restartEngine=function(e){return u.stopAll(),u.quit(),x=[],C=[],u.bookLoaded&&!s.book&&(s=JSON.parse(JSON.stringify(s)),s.book=u.book),v(s,e)},u.stopFast=function(e,t){var n;u.stopAll(function(){clearTimeout(n),e(u)}),n=setTimeout(function(){u.restartEngine(e)},t||5e3)};function ee(){u.uci(function(){s.settings&&Object.keys(s.settings).forEach(function(e){u.setoption(e, __get$(s.settings,e) )}),u.ready=!0,A()})}function A(){u.ready&&(u.bookLoaded||!u.pathToBook)&&l&&l(u)}return typeof Worker>`u`?!1:(s.ceeMode&&(y(u,s),u.ceeVersion=function(){return JSON.parse(JSON.stringify(T))}),b=d(s,u),b.onmessage=E,s.book&&(u.book=s.book,u.bookLoaded=!0,u.pathToBook=s.pathToBook),u.getFenFromMoves=t.getFenFromMoves,u.getLegalMoves=t.getLegalMoves,u.getPositionInfo=t.getPositionInfo,u.isFenValid=t.isFenValid,u.ready=!1,ee(),!u.book&&s.pathToBook&&u.loadBook(s.pathToBook,A),u)}function y(e,n){var r=1e3,i=0,a,o;function s(e){function t(e){var n=t.callbacks;for(var r in t.callbacks={},t.original&&t.original(e),n) __call$(n,r,[e]) }return t.callbacks={},t.original=e,t}n.onError=a=s(n.onError),n.onSignal=o=s(n.onSignal);function c(n,s,c,l){var u,d=Date.now(),f=!1,p=++i;function m(){clearTimeout(u),delete a.callbacks[p],delete o.callbacks[p],f=!0}function h(e){f||(m(),l({data:e,action:s,uci:n},n))}function g(e){h({msg:`CEE process crashed unexpectedly`,code:t.ERROR_CODES.CRASH,exitCode:e,err:Error(`CEE process exited with `+e)})} __set$(a.callbacks,p,g) , __set$(o.callbacks,p,g) ,u=setTimeout(function(){h({msg:`CEE timed out`,code:t.ERROR_CODES.TIMEOUT,timeout:r,duration:Date.now()-d,err:Error(`CEE timed out`)})},r);for(var _=0;_<n.length;++_)e.send( __get$(n,_) );e.send(`fetch `+s,function(e){f||(m(),c(e,n))},function(n){n.indexOf(`info string CEEError`)>=0?h({msg:`CEE crashed with error code`,code:t.ERROR_CODES.ERROR,log:n.match(/info string CEEError\s*(.*)/)[1],err:Error(n.match(/info string CEEError\s*(.*)/)[1])}):e.ceeDebug&&n.indexOf(`not recognized`)>=0&&h({msg:`CEE received unknown UCI option (engine.ceeDebug mode on)`,option:n,code:t.ERROR_CODES.NONFATAL_ERROR,err:Error(n)})})}e.fetch=function(e,n,r){var i,a;e||=[],i=e.action||`analysis`,Array.isArray(e)?a=e:(a=e.uciCommands?e.uciCommands.map(function(e){return e}):[],e.startFen&&(e.options=e.options||{},e.options.ScoreWhiteToMove===void 0&&(e.options.ScoreWhiteToMove=!0),e.options.SerializeLikeCEAC===void 0&&(e.options.SerializeLikeCEAC=!0),t.CEE_LIB.addOptions(a,e.options),t.CEE_LIB.addVariant(a,e.variant),t.CEE_LIB.addPosition(a,e.startFen)),t.CEE_LIB.addVariations(a,e.evals&&e.evals[0]),t.CEE_LIB.addVariations(a,e.threats&&e.threats[0],`threat-variation`),(e.moves||[]).forEach(function(n,r){var i=r+1;t.CEE_LIB.addPush(a,n),t.CEE_LIB.addVariations(a,e.evals&& __get$(e.evals,i) ),t.CEE_LIB.addVariations(a,e.threats&& __get$(e.threats,i) ,`threat-variation`)})),c(a,i,n,r)},e.fetch.setTimeout=function(e){r=e},t.ERROR_CODES={TIMEOUT:1,CRASH:2,ERROR:3,NONFATAL_ERROR:4}}return v},i=function(){var t=n(),i,a=`rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1`,o=252,s=255,c={4:`p`,5:`P`,6:`p`,8:`n`,9:`N`,10:`n`,16:`b`,17:`B`,18:`b`,32:`r`,33:`R`,34:`r`,64:`q`,65:`Q`,66:`q`,128:`k`,129:`K`,130:`k`},l=`pnbrq`,u=512,d=`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?{~}(^)[_]@#$,./&-*++=`,f=`qnrbkp`;function p(e){var t,n=e.length,r=[],i,a,o;for(t=0;t<n;t+=2)o={},i=d.indexOf( __get$(e,t) ),a=d.indexOf( __get$(e,t+1) ),a>63&&(o.promotion= __get$(f,Math.floor((a-64)/3)) ,a=i+(i<16?-8:8)+(a-1)%3-1),i>75?o.drop= __get$(f,i-79) :o.from= __get$(d,i%8) +(Math.floor(i/8)+1),o.to= __get$(d,a%8) +(Math.floor(a/8)+1),r.push(o);return r}function m(e){var t,n,r=``,i,a;for(Array.isArray(e)||(e=[e]),n=e.length,t=0;t<n;t+=1)i= __get$(e,t) .drop?79+f.indexOf( __get$(e,t) .drop):d.indexOf( __get$(e,t) .from[0])+( __get$(e,t) .from[1]-1)*8,a=d.indexOf( __get$(e,t) .to[0])+( __get$(e,t) .to[1]-1)*8, __get$(e,t) .promotion&&(a=f.indexOf( __get$(e,t) .promotion)*3+64+(a<i?9+a-i:a-i-7)),r+= __get$(d,i) + __get$(d,a) ;return r}function h(e){var t=e.split(` `),n,r=t.length,i=[],a;if(e)for(n=0;n<r;++n)a= __get$(t,n) ,a.length===4?a[1]===`@`?i.push({drop:a[0].toLowerCase(),to:a.substr(2,2)}):i.push({from:a.substr(0,2),to:a.substr(2,2)}):i.push({from:a.substr(0,2),to:a.substr(2,2),promotion:a[4]});return i}function g(e,t){return e.san===t.san||e.to===t.to&&(e.from===t.from||!e.from&&!t.from)&&(e.promotion===t.promotion||!e.promotion&&!t.promotion)&&(e.drop===t.drop||!e.drop&&!t.drop)}function _(e,t,r){var i=[],a,o,s,c,l,u,d,f,p,m,h=1,g=8,_=1,v=8,y={verbose:!0};for(m=e.turn(),p=3-m,c=n(`/`,t),c.turn(p),r&&(h=g=+r[1],_=v=r.charCodeAt(0)-96),a=h;a<=g;++a)for(o=_;o<=v;++o)l=String.fromCharCode(o+96)+a,s=e.get(l),s&&s.color===p&&(c.put(s,l,!0),s.type===`p`?(u=String.fromCharCode(o-1+96)+(a+(p===1?1:-1)),d=String.fromCharCode(o+1+96)+(a+(p===1?1:-1)),c.put({type:`n`,color:m},u,!0),c.put({type:`n`,color:m},d,!0)):s.type===`k`&&(f=e.fen().split(` `)[2],f!==`-`&&c.load( __call$(c.fen(),"replace",[/^(\S+\s\S\s)(\S+)/,`$1`+f]) ,t,!0,!0)),i=i.concat(c.moves(y)),c.remove(l,!0),s.type===`p`&&(c.remove(u,!0),c.remove(d,!0)));return t&&e.hand()&&( __set$(c._hand,p,18721) ,i=i.concat(c.moves({verbose:!0}).filter(function(e){return!r||e.to===r}))),i.forEach(function(e){k(e)}),i}function v(e,n){var r=e.header().Variant,i=_(e,r,n.from),a,o,s,c,l,u=3-e.turn();for(a=i.length-1;a>=0;--a)if(o= __get$(i,a) ,g(o,n)){s=!0;break}if(s)return o.drop?e.put({type:o.drop,color:u},o.to):(c=e.remove(o.from,!0),o.flags===t.FLAGS.KSIDE_CASTLE?(l=e.remove(r===`Chess960`?o.to:`h`+o.from[1],!0),e.put(c,`g`+o.from[1],!0),e.put(l,`f`+o.from[1])):o.flags===t.FLAGS.QSIDE_CASTLE?(l=e.remove(r===`Chess960`?o.to:`a`+o.from[1],!0),e.put(c,`c`+o.from[1],!0),e.put(l,`d`+o.from[1])):(o.promotion&&(c.type=o.promotion,c.promoted=!0),l=e.get(o.to),e.put(c,o.to,c.type!==`k`&&c.type!==`r`&&(!l||l.color!==u||l.type!==`r`)))),o;if(n.from&&(e.turn(u),n=e.fixMove(n),e.turn(3-u),n))return v(e,{san:n,from:n.from})}function y(e,t){var n=t?{}:[],r=e._board(),i,a,s;if(t)for(i=112;i>=0;++i)i&136&&(i-=24),(a= __get$(r,i) )&&(s= __get$(d,i&7) +(8-(i>>4)), __set$(n,s,{type:__get$(c,a&o),color:a&3,promoted:(a&u)!==0,square:s}) );else for(i=112;i>=0;++i)i&136&&(i-=24),(a= __get$(r,i) )&&n.push({type: __get$(c,a&o) ,color:a&3,promoted:(a&u)!==0,rank:8-(i>>4),file:(i&7)+1});return n}function b(e,t){var n=Math.min(Math.max(.20773843*Math.atan(2.49085889*e/100-2.47841945*t/100)+.02262979*e/100-.02256839*t/100+.52239679,0),1),r=Math.min(Math.max(-.20720905*Math.atan(2.49626837*e/100-2.48220286*t/100)+-.02352551*e/100+.02172627*t/100+.49443923,0),1),i=Math.min(Math.max(Math.exp(.037043456*e/100+.178106427*t/100+-8.069742932)+.004823544*Math.exp(-1.364136591*(e/100-t/100)**2)+-.001625539,0),1),a=n+r+i;return{w:n/a,b:r/a,d:i/a}}function x(e,t){var n,r,i,a;if(e||={},e.disableHashing=!0,n=E(e),!n)return null;if(t){if(i=n.move(t),!i)return null;n.extended||k(i)}return a=n.fen(),!e.skipValidation&&!n.isPositionValid(e)?null:(r=a.split(` `),{fen:a,pieces:y(n),sideToMove:n.turn(),castling:r[2],epSquare:r[3]===`-`?null:r[3],halfMoves:+r[4],moveNumber:+r[5],move:i,hand:n.hand(),checks:n.checks()})}function S(t){var n=E(t),r,i,o,s,c,l,u=[``],d=[],f,p,m;if(!n)return!1;for(p=n.header(),m=p.Variant||``,l=n.hashes(),r=typeof n.origHistory==`function`?n.origHistory(!0):n.history(!0),c=l.length,i=[l[0][0],l[0][1]],d.push(e.to64BitHex(i)+m),l[0]=e.to64BitHex(l[0]),o=1;o<c;++o)i[0]=(i[0]^ __get$(l,o) [0]*(o+58465))>>>0,i[1]=(i[1]^ __get$(l,o) [1]*(o+984))>>>0, __set$(l,o,e.to64BitHex(__get$(l,o))) ,d.push(e.to64BitHex(i)+m),s=o-1,k( __get$(r,s) ),f=( __get$(r,s) .from? __get$(r,s) .from: __get$(r,s) .drop.toUpperCase()+`@`)+ __get$(r,s) .to+( __get$(r,s) .promotion||``),s&&(f= __get$(u,s) +` `+f),u.push(f);return{startingFen:p.FEN||a,hashes:l,fingerprints:d,moves:u,variant:p.Variant}}function C(e,t,n,r){var i,a,o,s,c,l,u,d,f,p,m;for(n||={},typeof t==`string`&&(t=t.trim().split(` `)),o=t.length,i=0;i<o;i+=1){if(c= __get$(t,i) .board===`b`|| __get$(t,i) .board===`B`?e.siblingGame:e,l=typeof  __get$(t,i) .moveLan==`string`?h( __get$(t,i) .moveLan)[0]:typeof  __get$(t,i) ==`string`?h( __get$(t,i) )[0]: __get$(t,i) .san? __get$(t,i) .san: __get$(t,i) ,!c.move(l))if(n.autoPromote){if(n.autoPromote===!0?l.promotion=`q`:l.promotion=n.autoPromote,!c.move(l)){if(n.skipBadLines)break;return!1}}else{if(n.skipBadLines)break;return!1}if(u=c._history(),d= __get$(u,u.length-1) ,r&&(f=parseInt( __get$(r,i) ,10)),(typeof f!=`number`||isNaN(f))&&(f=parseInt( __get$(t,i) .time,10)),typeof f==`number`&&!isNaN(f)&&(d.time=f,f=void 0), __get$(t,i) .firstComment&&(u.initComment= __get$(t,i) .firstComment), __get$(t,i) .comment&&(d.comment= __get$(t,i) .comment), __get$(t,i) .annotation&&(d.annotation= __get$(t,i) .annotation), __get$(t,i) .additionalAnnotation&&(d.additionalAnnotation= __get$(t,i) .additionalAnnotation), __get$(t,i) .commands&&(d.commands= __get$(t,i) .commands), __get$(t,i) .lines)for(s= __get$(t,i) .lines.length,a=0;a<s;++a){if(p=e._history().id,e.createVariation(),m=C(e, __get$(__get$(t,i).lines,a) ,n),!m&&!n.skipBadLines)return!1;e.selectLine(p)}}return!0}function w(e,t,n){var r=[p(t[0]),p(t[1])],i=[0,0],a=[0,0],o=r[0].length+r[1].length,s=Math.max(n[0][0]|0,n[0][1]|0,n[1][0]|0,n[1][1]|0),c,l=[0,0],u=[0,0],d,f;for(s+=600-s%600,c=[[s,s],[s,s]];o--;){if(u[0]=l[0]+ __get$(c[0],a[0]) - __get$(n[0],i[0]) ||0,u[1]=l[1]+ __get$(c[1],a[1]) - __get$(n[1],i[1]) ||0,d=u[0]<=u[1]?0:1, __get$(__get$(r,d),__get$(i,d)) ||(d^=1),f=d?e.siblingGame:e,(!f.move( __get$(__get$(r,d),__get$(i,d)) )||o&&f.inCheckmate()&&f.undo(!0))&&(d^=1,f=d?e.siblingGame:e,!f.move( __get$(__get$(r,d),__get$(i,d)) )))return!1; __get$(f._history(),__get$(i,d)) .time= __get$(__get$(n,d),__get$(i,d)) , __set$(__get$(c,d),__get$(a,d),__get$(__get$(n,d),__get$(i,d))) , __set$(l,d,__get$(u,d)) ,a[d]^=1,++i[d]}return!0}function T(e){var r,i=-1,o=0,s;function c(e,t,n){for(var r= __get$(e,t) ,i;typeof(i=r.parentId)==`number`;){if(i===n)return r.atMoveNode;r= __get$(e,i) }return!1}function l(e,t){var n={moveTime:e.moveTime,firstComment:e.firstComment,comment:e.comment,annotation:e.annotation,additionalAnnotation:e.additionalAnnotation,commands:e.commands};Object.keys(n).forEach(function(r){ __set$(e,r,__get$(t,r)) , __set$(t,r,__get$(n,r)) })}e.extended||(e.extended=!0,r={header:e.header,load:e.load,loadPgn:e.loadPgn,createVariation:e.createVariation,undo:e.undo,pgn:e.pgn},e._move=e.move,e.undo=function(){return e.siblingGame?e.deleteBughouseMove(e.curBughouseMove()):e.deletePosition(i,o)},e.getMove=function(t){return t&&(typeof t==`string`||t.to&&(t.from||t.drop))&&e._move(t)&&k(r.undo())||null},e.premove=function(){var t,r=[];return{queue:r,move:function(a){var s;return t||=n(e.fen(),e.header().Variant),s=v(t,a),!s||o||i!==e._history().length-1?(r.length||(t=void 0),null):(r.push(s),s)},consume:function(){var i=r.shift(),a,o,s;if(i){if(a=e.move(i),a){if(t=void 0,o=r.length,o)for(t=n(e.fen(),e.header().Variant),s=0;s<o;++s)v(t, __get$(r,s) );return a}e.premove.cancel()}},moves:function(n){return!o&&i===e._history().length-1&&_(t||e,e.header().Variant,n)},getPieces:function(n){return y(t||e,n)},fen:function(){return(t||e).fen()},cancel:function(){r.length=0,t=void 0}}}(),e.getPieces=function(t){return y(e,t)},e.material=function(){var t=e.getPieces(),n={imbalance:0,white:{p:8,n:2,b:2,r:2,q:1,count:0},black:{p:8,n:2,b:2,r:2,q:1,count:0}},r,i={p:1,n:3,b:3,r:5,q:9,k:0},a,o;for(r=t.length-1;r>=0;--r) __get$(t,r) .color===1?(a=n.white,o=n.black):(a=n.black,o=n.white), __get$(o,__get$(t,r).type) &&--o[ __get$(t,r) .type],a.count+= __get$(i,__get$(t,r).type) ;return n.imbalance=n.white.count-n.black.count,n},e.origHistory=e.history,e.history=function(t,n){var r=[],i,a=e._history(),o=a.length,s=e._lines(),c,l;for(typeof t==`boolean`&&(t={verbose:t}),t||={},n&&(t.noParentLines=n),t.toCurrent&&(o=e.ids().move+1);;){if(--o===-1)if(a.id&&!t.noParentLines){o=a.atMoveNode,a= __get$(s,a.parentId) ;continue}else break;if(t.verbose){for(c in i={}, __get$(a,o) )if( __get$(__get$(a,o),c) &&typeof  __get$(__get$(a,o),c) ==`object`)for(l in  __set$(i,c,__get$(__get$(a,o),c).constructor===Array?[]:{}) , __get$(__get$(a,o),c) ) __set$(__get$(i,c),l,__get$(__get$(__get$(a,o),c),l)) ;else  __set$(i,c,__get$(__get$(a,o),c)) ;r.unshift(i)}else r.unshift( __get$(a,o) .san)}return r},e._getPos=function(t,n){var s,c,l;return typeof t!=`number`&&(t=i),typeof n!=`number`&&(n=o),c=e._lines(),s= __get$(c,n) ,t>=0? __get$(s,t) :s.id?s.atMoveNode? __get$(__get$(c,s.parentId),s.atMoveNode-1) :e._getPos(s.atMoveNode-1,s.parentId):(l={fen:r.header().FEN||a,hash:s.hash,initial:!0,ids:{move:-1,line:0}},e.siblingGame&&(l.bughouseOrder=-1),l)},e.move=function(t,n){var r,a=e._history(),s,c,l;if(t&&(typeof t==`string`||t.to&&(t.from||t.drop))){if(o===a.id&&i<a.length-1||n){if(e.moveForward(n,t))return!0;i<a.length-1&&(e.selectPosition(i+1),e.createVariation(),a=e._history())}e.siblingGame&&(c=e.isDependent?e.siblingGame.fen():e.fen()),r=e._move(t),r&&(k(r),o=a.id,i=a.length-1,s= __get$(a,i) ,l=e._getPos(i-1),e.siblingGame?(s.fen=e.isDependent?e.siblingGame.fen():e.fen(),s.beforeFen=c,s.siblingIds=e.siblingGame.ids()):(s.fen=e.fen(),s.beforeFen=l.fen),l.initial?(s.moveNumber=0,s.previous=null):(s.moveNumber=l.moveNumber+1,s.previous=l.ids),o&&i===0&& __get$(__get$(e._lines(),a.parentId),a.atMoveNode) .move===s.move&&(s.isContinuation=!0),s.flags=r.flags,s.to=r.to,s.from=r.from,s.drop=r.drop,s.capturedStr=r.captured,s.promotion=r.promotion,s.piece=r.piece,r.promoted&&(s.promoted=!0),r.capturedPromotedPawn&&(s.capturedPromotedPawn=!0),s.ids={move:i,line:o})}return r},e.moveDetails=function(n){return n||= __get$(e._history(),i) ,n&&(n.lines=n.lines||null,n.flags===t.FLAGS.KSIDE_CASTLE?(n.rookFrom=e.header().Variant===`Chess960`?n.to:`h`+n.to[1],n.rookTo=`f`+n.to[1],n.kingTo=`g`+n.to[1]):n.flags===t.FLAGS.QSIDE_CASTLE?(n.rookFrom=e.header().Variant===`Chess960`?n.to:`a`+n.to[1],n.rookTo=`d`+n.to[1],n.kingTo=`c`+n.to[1]):n.flags===t.FLAGS.EP_CAPTURE&&(n.epCapture=n.to[0]+n.from[1])),n},e.header=e.headers=function(t){var n=r.header(t);return e.siblingGame&&T(e.siblingGame),n},e.load=function(t,n,a,s){var c=r.load(t,n,a,s);return e.siblingGame&&T(e.siblingGame),c&&!a&&(i=-1,o=0),c},e.removeEmptyLines=function(){var t=e._lines(),n,r;for(n=t.length-1;n>0;--n) __get$(t,n) .length||( __set$(t,n,void 0) ,r=!0);r&&e.reorderLines()},e.loadPgn=function(t,n,a){var s=r.loadPgn(t,n,a),c=e._history();return e.removeEmptyLines(),i=c.length-1,o=c.id,o&&e.selectLine(0),s},e.ids=function(){return{move:i,line:o}},e.selectLine=function(t){e.selectPosition(null,t)},e.curBughouseMove=function(){return Math.max(e._getPos().bughouseOrder,e.siblingGame._getPos().bughouseOrder)},e.deleteBughouseMove=function(t){var n=e.curBughouseMove(),r=!1,i=e,a,o,s;if(t>=0)for(n>=t&&e.selectBughouseMove(t-1);;){for(a=i._history(),o=a.length,s=0;s<o;++s)if( __get$(a,s) .bughouseOrder>=t){a.length=s,r=!0;break}if(i===e.siblingGame)break;i=e.siblingGame}return r},e.selectBughouseMove=function(t){var n=e.isDependent?e.siblingGame:e,r=n,i,a;if(t===-1)return r.selectPosition(-1,0,!0),r.siblingGame.selectPosition(-1,0,!0),n.load(n.header().FEN,`Bughouse`,!0,!0);for(;;){for(i=r._history(),a=i.length-1;a>=0;--a)if( __get$(i,a) .bughouseOrder===t)return r.selectPosition( __get$(i,a) .ids.move,0,!0),r.siblingGame.selectPosition( __get$(i,a) .siblingIds.move,0,!0),n.load( __get$(i,a) .fen,`Bughouse`,!0,!0);if(r===n.siblingGame)return!1;r=n.siblingGame}},e.moveBackward=function(t){var n;if(e.siblingGame)return e.selectBughouseMove(e.curBughouseMove()-1);if(i<=1)if(o===0){if(i===-1)return!1;e.selectPosition(i-1)}else n=e._getPos(i-1,o),n.isContinuation&&!t&&(n=e._getPos(n.ids.move-1,n.ids.line),n=e._getPos(n.ids.move+1,n.ids.line)),e.selectPosition(n.ids.move,n.ids.line);else e.selectPosition(i-1);return!0},e.moveForward=function(t,n){var r=e._lines(),a,s,c,l,u,d;if(e.siblingGame)return e.selectBughouseMove(e.curBughouseMove()+1);if(a= __get$(__get$(r,o),i+1) ,typeof n==`string`&&(n={san:n}),!a||n&&!g(n,a)){if(n&&a&&a.lines){for(u=a.lines.length,l=0;l<u;++l)if(c= __get$(r,__get$(a.lines,l)) [0],c&&g(n,c)){a=c,d=!0;break}}if(!d&&t&&(s= __get$(__get$(r,o),i) ,s&&s.lines)){for(u=s.lines.length,l=0;l<u;++l)if(c= __get$(r,__get$(s.lines,l)) [0],c&&c.isContinuation&&(c= __get$(r,__get$(s.lines,l)) [1],c&&(!n||g(n,c)))){a=c,d=!0;break}}if(!d){try{if(n&&n.san&&(n=e.fixMove(n.san))||n&&n.to&&n.from&&Math.abs(n.to.charCodeAt(0)-n.from.charCodeAt(0))>1&&(n=e.fixMove(n)))return e.moveForward(t,n)}catch{}return!1}}return e.selectPosition(a.ids.move,a.ids.line)},e.moveVariation=function(t,n){var r=e._lines(),i= __get$(r,t) ,a,o,s;if(i&&i.id){for(a= __get$(__get$(r,i.parentId),i.atMoveNode) .lines,o=a.length-1;o>=0;--o)if( __get$(a,o) ===t&&(s=o-(n?1:-1), __get$(a,s) ))return  __set$(a,o,__get$(a,s)) , __set$(a,s,t) ,e.reorderLines(),!0}return!1},e.promoteVariation=function(t,n){for(var r=e._lines(),a= __get$(r,t) ,s,c,l,u,d,f;a&&a[0]&&a.id&&(n!==-1||a.parentId);){for(l=a.parentId,s= __get$(r,l) ,u=a.atMoveNode,a[0].lines= __get$(s,u) .lines.concat(a[0].lines||[]), __get$(s,u) .lines=void 0,f=s.length-u,c=s.splice(u,f),d=0;d<f;++d) __get$(c,d) .ids.line=t, __get$(c,d) .ids.move=d;for(c.id=t,c.parentId=l,c.atMoveNode=u,c.hash=a.hash,u===0?(c.initComment=s.initComment,s.initComment=a.initComment):a.initComment&&( __get$(s,u-1) .comment=(( __get$(s,u-1) .comment||``)+` `+a.initComment).trim()), __set$(r,t,c) ,f=a.length,d=0;d<f;++d) __get$(a,d) .ids.line=l, __get$(a,d) .ids.move=d+u,s.push( __get$(a,d) );for(c[0].isContinuation=!!a[0].isContinuation, __get$(s,u) .isContinuation=!u&&typeof s.parentId==`number`&& __get$(__get$(r,s.parentId),s.atMoveNode) .move===s[0].move,f= __get$(s,u) .lines.length,d=0;d<f;++d) __get$(r,__get$(__get$(s,u).lines,d)) .atMoveNode=u, __get$(r,__get$(__get$(s,u).lines,d)) [0]&&( __get$(r,__get$(__get$(s,u).lines,d)) [0].isContinuation= __get$(r,__get$(__get$(s,u).lines,d)) [0].move=== __get$(s,u) .move);if(o===t?(o=l,i+=u):o===l&&i>=u&&(o=t,i-=u),n===1)break;t=l,a= __get$(r,t) }return s===void 0?!1:(e._history( __get$(r,o) ),e.reorderLines(),!i&& __get$(r,o) [0].isContinuation&&e.selectPosition( __get$(r,o) .atMoveNode, __get$(r,o) .parentId),!0)},e.reorderLines=function(t,n){var r=e._lines(),i,a,c,l,u,d,f,p,m,h,g=!1;for(t?m=n.length-1:(t=0,n=[r[0]],m=0,s=!1),i= __get$(r,t) ,c=i.length,a=0;a<c;++a)if(l= __get$(i,a) ,l.ids.line!==m&&(g=!0,l.ids.line=m),l.lines)for(u=l.lines.length,d=0;d<u;++d)f= __get$(l.lines,d) ,p= __get$(r,f) ,p?(p.atMoveNode=a,h=n.length, __set$(l.lines,d,h) ,p.parentId=m,!s&&f===o&&(s=!0,o=h),n.push(p),g=e.reorderLines(f,n)||g):(l.lines.length===1?delete l.lines:l.lines.splice(d,1),--d,--u);return t||e.saveLines(n,!0),g},e.createVariation=function(){var t=e._history(),n=e._lines(),a,s,c;return i===t.length-1?(a=r.createVariation(),t=e._history(),i=t.length-1,o=t.id,a):i===-1?!1:(s=[],c= __get$(t,i) ,s.parentId=t.id,s.id=n.length,c.lines||=[],c.lines.push(s.id),s.hash=e._getPos(i-1).hash,s.atMoveNode=i,n.push(s),e.selectPosition(-1,s.id))},e.selectLineEnd=function(t){return e.siblingGame?e.selectBughouseMove(e._history().length+e.siblingGame._history().length-1):(typeof t!=`number`&&(t=o),t!==o||i<e._history().length-1?e.selectPosition(null,t,!0):!1)},e.selectLineStart=function(){var t,n;return e.siblingGame?e.selectBughouseMove(-1):o?(i>1||i===1&&!e._getPos(0).isContinuation?t=e._history():(n=e._getPos(-1),t= __get$(e._lines(),n.ids.line) ),e.selectPosition(t.id?t[1]&&t[0].isContinuation?1:0:-1,t.id)):i===-1?!1:e.selectPosition(-1,0)},e.selectPosition=function(t,n,a){var s=e._lines(),c=e._history();if(typeof n==`number`&&(n!==o||a)){if(n<0||n>=s.length)return!1;if(c= __get$(s,n) ,typeof t!=`number`)t=c.length-1;else if(t<-1||t>=c.length)return!1;o=n,e._history(c),a=!0}if(typeof t==`number`&&(t!==i||a)){if(t<-1||t>=c.length)return!1;r.load(e._getPos(t).fen,r.header().Variant,!0,!0),i=t}return!0},e.resetToMainLine=function(){var t=e._lines();e.selectLineEnd(0),t.length>1&&(t.length=1,e.reorderLines())},e.updateNode=function(t,n,r){var a=e._lines(),s,c;for(c in r=typeof r==`number`?r:o,n=typeof n==`number`?n:i,s= __get$(__get$(a,r),n) || __get$(a,r) ,t) __set$(s,c,__get$(t,c)) },e.updateLineComment=function(t,n){e.updateNode({initComment:t},-1,n)},e.saveLines=function(t,n){var r=e._lines(),i,a=t.length,o,s;for(t!==r&&(r.length=0),o=0;o<a;++o){if(i= __get$(t,o) ,o&&typeof i.parentId!=`number`)return!1;t!==r&&r.push(i),i.id=o}return e._history(e._history()),n||(s=e.ids(),e.selectPosition(-1,0,!0),e.selectPosition(s.move,s.line)),!0},e.deletePosition=function(t,n){var r=e._lines(),a,s;return! __get$(r,n) ||! __get$(__get$(r,n),t) &&(t!==-1||n===0)?!1:(n&&(t===0||t===1&& __get$(r,n) [0].isContinuation)&&(t=-1),o>0&&n!==o?(a=c(r,o,n),s=a!==!1&&a>=t):s=n===o&&t<=i,s&&(t>1?e.selectPosition(t-1,n):(e.selectPosition(( __get$(r,n) [0].isContinuation||t===1)&& __get$(r,n) [1]?1:0,n),e.moveBackward())),t>0? __get$(r,n) .length=t:n? __set$(r,n,null) :r[0].length=0,e.reorderLines(),e.ids())},e.mark=function(t,n){var r=i<0? __get$(e._lines(),o) : __get$(__get$(e._lines(),o),i) ,a=t.type,s=1;t.color&&(a===`arrow`?e.mark({key:t.color+t.key,type:`cal`},n):a===`square`&&e.mark({key:t.color+t.key,type:`csl`},n)),a!==`cal`&&a!==`csl`&&(a=`c_`+a,s=0),r.commands&& __get$(r.commands,a) &&( __set$(r.commands,a,__get$(r.commands,a).split(`,`).filter(function(e){return e.slice(s).split(`;`)[0]!==t.key.slice(s);}).join(`,`)) , __get$(r.commands,a) ||delete r.commands[a]),n||(r.commands||={}, __set$(r.commands,a,(__get$(r.commands,a)?__get$(r.commands,a)+`,`:``)+t.key+(t.data?`;`+t.data.join(`;`):``)) )},e.markings=function(){var t={},n=i<0? __get$(e._lines(),o) : __get$(__get$(e._lines(),o),i) ,r,a,s,c={cal:`arrow`,csl:`square`},l,u,d,f,p;for(a in n.commands){if(s= __get$(n.commands,a) , __get$(c,a) )a= __get$(c,a) ,l=0;else if(a.substr(0,2)===`c_`)a=a.slice(2),l=1;else continue;for( __set$(t,a,__get$(t,a)||{}) ,u=s.split(`,`),d=u.length,r=0;r<d;++r)l?(f= __get$(u,r) .split(`;`),p=f.shift(), __set$(__get$(t,a),p,__get$(__get$(t,a),p)||{type:a,key:p}) , __get$(__get$(t,a),p) .data=f):(p= __get$(u,r) .slice(1), __set$(__get$(t,a),p,__get$(__get$(t,a),p)||{type:a,key:p}) , __get$(__get$(t,a),p) .color= __get$(u,r) [0])}return t},e.clearMarkings=function(){var t=i<0? __get$(e._lines(),o) : __get$(__get$(e._lines(),o),i) ,n;for(n in t.commands)/^c[sa]l$|^c_/.test(n)&&delete t.commands[n]},e.pgn=function(t){var n=e.ids(),i;return e.selectLineEnd(0),i=r.pgn(t),e.selectPosition(n.move,n.line),i},e.loadMoves=function(t,n){var r,a,s,c,u;if(n||={},typeof t==`string`&&(t=p(t)),t){for(n.atCurrent||e.selectPosition(-1,0),s=o,a=t.length,r=0;r<a;++r){if(c=e.move( __get$(t,r) ,!0),!c&&( __get$(t,r) .promotion=n.autoPromote===!0?`q`:n.autoPromote,c=e.move( __get$(t,r) ,!0),!c))return!1;o!==s&&n.method!==`merge`&&(e.promoteVariation(o,1),n.method!==`promote`&&( __get$(e._history(),i) .lines=void 0,e.reorderLines()),s=o)}if(n.method===`promote`){if(a){for( __get$(e._history(),i+1) &&(c= __get$(e._history(),i) ,e.createVariation(),e.move(c),l(e._history()[0],c),e.promoteVariation(o,1)),u=e._lines(),r=u.length-1;r>=0;--r) __get$(u,r) .length===1&& __get$(u,r) [0].isContinuation&&(l( __get$(u,r) [0], __get$(__get$(u,__get$(u,r).parentId),__get$(u,r).atMoveNode) ), __get$(u,r) .length=0);e.removeEmptyLines()}}else n.method!==`merge`&&e.deletePosition(i+1,o)}return!0})}function E(e){var t,r;if(e||={},e.game)return e.game;if(t=n(),e.analysis&&T(t),e.disableHashing&&t.hashing(!1),e.pgn){if(!t.loadPgn(e.pgn,e.index,e.options)&&(e.variant!==`detect`||!n.variants.some(function(n){return e.options=e.options||{},e.options.variant=n,t.loadPgn(e.pgn,e.index,e.options)})))return!1}else{if(e.headers&&(e.variant=e.headers.Variant||e.variant,e.fen||=e.headers.FEN),e.variant===`detect`&&e.fen&&(e.fen.indexOf(`|`)>-1?e.variant=`Bughouse`:e.fen.split(`/`).length===9?e.variant=`Crazyhouse`:e.fen.indexOf(`+`)>-1?e.variant=`3-check`:e.variant=void 0),(e.fen||e.variant)&&!t.load(e.fen||a,e.variant))return!1;e.headers&&typeof e.headers==`object`&&!Array.isArray(e.headers)&&t.header(e.headers)}if(e.tcn)if(typeof e.tcn==`object`){if(!w(t,e.tcn,e.timestamps||[[],[]]))return!1}else r=p(e.tcn);else r=e.moves;return r&&!C(t,r,e,e.timestamps)?!1:t}function D(e){var t;return e||={},e.disableHashing=!0,t=E(e),t?t.pgn(e):!1}function O(e,n){var r,i=[],a;if(t.reset(),!t.loadPgn(e))return!1;if(r=t.moveCount(),typeof n==`number`){for(n<0&&(n=r+n+1),a=r-1;a>=n&&a>=0;--a)t.undo();return t.fen()}for(a=0;a<=r;a+=1)i.unshift(t.fen()),t.undo();return i}function k(e){return e&&(e.piece&u&&(e.promoted=!0),e.piece= __get$(c,e.piece&o) ,e.captured&&=(e.captured&u&&(e.capturedPromotedPawn=!0), __get$(c,e.captured&s) ),e.promotion&&= __get$(c,e.promotion&o) ,e.drop!==void 0&&(e.drop= __get$(l,e.drop) )),e}function ee(e){var t=e.history(!0,!0),n,r,i,a,o,s,c;if(e.siblingGame){for(n=e.siblingGame.history(!0,!0),i=t.length+n.length,r=[],a=0;a<i;++a)!t.length||n.length&&n[0].bughouseOrder<t[0].bughouseOrder?(o=n.shift(),o.board=`b`):(o=t.shift(),o.board=`a`),r.push(o);t=r}for(i=t.length,a=0;a<i;++a)if(s= __get$(t,a) ,s.fen||k(s),s.lines)for(c=s.lines.length-1;c>=0;--c)e.selectLine( __get$(s.lines,c) ), __set$(s.lines,c,ee(e).moves) ;return{moves:t}}function A(e,n,r){var i=[],a,o=t;return typeof n!=`number`&&(r=n,n=void 0),a=o.tokenizePgn(e,r),n<0&&(n=a.length+n),a?(r&&r.includeFen&&(o=E({analysis:!0})),a.forEach(function(e,t){var a,s;t===n||n===void 0?o.loadPgn([e],0,r)?(s=ee(o),a=o.header(),i.push({headers:a,moves:s.moves})):i.push(!1):i.push(void 0)}),typeof n==`number`? __get$(i,n) :i):!1}function j(e,n,r){return t.reset(),t.load(n,r)?k(t.move(e)):!1}function M(e,n){return t.completeFen(e).split(` `).slice(0,n||4).join(` `)}function N(e,n,r){return t.reset(),t.load(e,r),n&&!C(t,n)?!1:t.fen()}function P(e,n){var r,i,a,o;if(typeof e==`string`){if(i=t,i.reset(),!i.load(e,n))return null}else i=E(e);for(r=i.moves({verbose:!0}),o=r.length,a=0;a<o;++a)k( __get$(r,a) );return r}function te(e,n,r){var i,a={gameOver:!1,check:!1,checkmate:!1,draw:!1,stalemate:!1,threefold:!1,insufficient:!1},o;if(Array.isArray(n)||(r=n,n=null),typeof r==`boolean`?(i=r,r={}):(r||={},i=r.variant),typeof e==`string`){if(o=t,o.reset(),o.validateFen(e,i)!==0||!o.load(e,i))return!1}else o=E(e);return n&&!C(o,n)?!1:(r.getLegalMoves&&(a.legalMoves=P({game:o})),o.inCheck()?(a.check=!0,a.checkmate=o.inCheckmate()):a.stalemate=o.inStalemate(),a.threefold=o.inThreefoldRepetition(),a.insufficient=o.insufficientMaterial(r.color),a.fiftyMoveRule=o.in50MoveRule(),a.draw=a.stalemate||a.threefold||a.insufficient||a.fiftyMoveRule||o.inDraw(),r.skipValidation||(a.isValid=o.isPositionValid(r)),i&&(a.variantWin=o.isVariantWin(),a.variantWin===void 0&&(a.variantWin=o.isBughouseWin())),a.gameOver=a.checkmate||a.draw||!!a.variantWin,a)}function F(e,n){return t.validateFen(e,n)===0}function ne(t,n){e.loadBook(t,function(t,r){if(!r||!r.json)return n(t||Error(`Invalid book`));n(t,function(t){var n,i,a,o,s,c,l,u,d;if(t.hash)i=typeof t.hash==`string`?[e.hex64ToDec(t.hash)]:[t.hash],o=1;else{if(n=E(t),!n)return!1;i=n.hashes(),o=i.length}for(a=0;a<o;++a)if(s= __get$(r.json,e.to64BitHex(__get$(i,a))) ,s){if(s.constructor===Array)if(c&&s[0].m.indexOf(c.m)===-1){for(u=s.length-1;u>=0;--u)if(!u|| __get$(s,u) .m.indexOf(c.m)!==-1){d= __get$(s,u) ,d.e=s[0].e,d.s=s[0].s,d.mate=s[0].mate,d.v=s[0].v,d.h=s[0].h,d.n=d.n||s[0].n,d.u=d.u||s[0].u,d.c=d.c||s[0].c;break}}else d=s[0];else d=s;(d.n||t.allowNameless)&&(c=d)}else t.mustEndInBook&&(c=void 0);if(c)return l={name:c.n},c.m&&(l.moves=c.m),c.d!==void 0&&(l.sdiff=c.d/100),c.c&&(l.code=c.c,l.url=c.u|| __call$(__call$(__call$(__call$(__call$(__call$(__call$(__call$(c.n,"replace",[/[\u00e1-\u00e5]/g,`a`]),"replace",[/[\u0107\u010d]/g,`c`]),"replace",[/[\u00e9\u00e8\u0117\u0113]/g,`e`]),"replace",[/[\u00f3\u00f6\u00f8]/g,`o`]),"replace",[/[\u016f\u00fc]/g,`u`]),"replace",[/['+,]/g,``]),"replace",[/[^a-z0-9.]+/gi,`-`]),"replace",[/(with-\d|St)\.+-?/,`$1-`]) ),c.e?(l.eval=c.e,l.depth=c.h,l.score=c.e[0].cp/100,c.e[0].mate!==void 0&&(l.mate=c.e[0].mate)):(l.score=c.s/100,c.mate!==void 0&&(l.mate=c.mate)),c.v&&(l.bad=!0),l},r.json)})}function I(e,t){return i||=r(I),i(e,t)}return I.supportsMultithreading=function(){var e,t=!!I._hasThreads;if(typeof I._hasThreads!=`boolean`){try{e=new Worker(`data:application/javascript,`), __call$(e,"postMessage",[new SharedArrayBuffer(1)]) ,t=!0}catch{}try{e.terminate()}catch{}I._hasThreads=t}return t},I.gameFingerprints=S,I.getFenFromMoves=N,I.getLegalMoves=P,I.getPositionInfo=te,I.isFenValid=F,I.encodeTCN=m,I.decodeTCN=p,I.uciToObj=h,I.generatePgn=D,I.pgnToFen=O,I.pgnToJson=A,I.sanToObj=j,I.completeFen=t.completeFen,I.shortenFen=M,I.createGame=E,I.getPositionDetails=x,I.predict=b,I.normalizeMoveObj=k,I.FLAGS=t.FLAGS,I.loadECO=ne,I.CEE_LIB=function(){var e={};return e.addOptions=function(e,t){for(var n in t) __get$(t,n) !==void 0&&e.push(`setoption name `+n+` value `+ __get$(t,n) );return e},e.addVariations=function(e,t,n){var r,i;t||=[],n||=`variation`;for(var a=0;a<t.length;++a)r= __get$(t,a) ,r.pv=Array.isArray(r.pv)&&r.pv.join(` `)||r.pv||``,i=n+` `+r.pv,typeof r.mateIn==`number`?i+=` mate `+r.mateIn:typeof r.mate==`number`?i+=` mate `+r.mate:i+=` cp `+Math.round(r.cp),typeof r.depth==`number`&&(i+=` depth `+r.depth),e.push(i);return e},e.addPush=function(e,t){var n;return typeof t==`string`&&(t={moveLan:t}),n=`push `+t.moveLan,t.isBook&&(n+=` isBook`),t.isRetry&&(n+=` isRetry`),e.push(n),e},e.addPosition=function(e,t){return e.push(`position fen `+t),e},e.addVariant=function(e,t){return  __call$(String(t).toLowerCase(),"replace",[/ |-/g,``]) ===`chess960`?(e.push(`setoption name UCI_Variant value chess`),e.push(`setoption name UCI_Chess960 value true`)):(e.push(`setoption name UCI_Variant value chess`),e.push(`setoption name UCI_Chess960 value false`)),e},e}(),I}();return t!==void 0&&(t.exports=i),i})()})),Tte=`/js/client-prod/assets/explanation-engine-Cz1J1fHX.js`,Ete=`/js/client-prod/assets/explanation-engine-CKY8IRWg.wasm`;export{o as A,dp as C,sS as D,ow as E,Hb as O,uv as S,kw as T,Cb as _,Cte as a,lw as b,AL as c,Zk as d,$O as f,Yx as g,K as h,i4 as i,a as k,NL as l,Qb as m,Tte as n,t2 as o,QO as p,wte as r,R2 as s,Ete as t,Rk as u,J as v,Bt as w,L_ as x,uS as y};
/*hammerhead|script|end*/
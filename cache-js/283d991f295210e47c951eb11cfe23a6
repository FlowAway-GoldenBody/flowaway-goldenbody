/*hammerhead|script|start*/if (typeof window !== 'undefined' && window){window['hammerhead|process-dom-method'] && window['hammerhead|process-dom-method']();if (window.__get$ && typeof __get$ === 'undefined')var __get$Loc = window.__get$Loc,__set$Loc = window.__set$Loc,__set$ = window.__set$,__get$ = window.__get$,__call$ = window.__call$,__get$Eval = window.__get$Eval,__proc$Script = window.__proc$Script,__proc$Html = window.__proc$Html,__get$PostMessage = window.__get$PostMessage,__get$ProxyUrl = window.__get$ProxyUrl,__rest$Array = window.__rest$Array,__rest$Object = window.__rest$Object,__arrayFrom$ = window.__arrayFrom$;} else {if (typeof __get$ === 'undefined')var __get$Loc = function(l){return l},__set$Loc = function(l,v){return l = v},__set$ = function(o,p,v){return o[p] = v},__get$ = function(o,p){return o[p]},__call$ = function(o,p,a){return o[p].apply(o,a)},__get$Eval = function(e){return e},__proc$Script = function(s){return s},__proc$Html = function(h){return h},__get$PostMessage = function(w,p){return arguments.length===1?w.postMessage:p},__get$ProxyUrl = function(u,d){return u},__rest$Array = function(a,i){return Array.prototype.slice.call(a, i)},__rest$Object = function(o,p){var k=Object.keys(o),n={};for(var i=0;i<k.length;++i)if(p.indexOf(k[i])<0)n[k[i]]=o[k[i]];return n},__arrayFrom$ = function(r){if(!r)return r;return!Array.isArray(r)&&"function"==typeof r[Symbol.iterator]?Array.from(r):r};if (typeof importScripts !== "undefined" && /\[native code]/g.test(importScripts.toString())) {var __getWorkerSettings$ = function () {return null};importScripts((location.origin || (location.protocol + "//" + location.host)) + "/worker-hammerhead.js");}}/*hammerhead|script|processing-header-end*/
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/puzzle-duel-user-data.mocker-gV1cv6S9.js","assets/random.util-FSayF0pK.js","assets/puzzle-duel-rank.mocker-CcfRv8Ql.js","assets/puzzle-duel-leaderboard.mocker-C-rjfLeC.js","assets/string.util-D6juJEzu.js","assets/person-full-name.mocker-D5ChHDcN.js","assets/username.mocker-B0Y6SpQR.js","assets/person-surname.mocker-BfFzf1yI.js","assets/user-avatar.mocker-B-ouWHso.js","assets/puzzle-duel-audio-settings.mocker-kXWk3-zz.js"])))=>i.map(i=> __get$(d,i) );
import{A as e,k as t}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/@chesscom-nyupcMS7.js" ;import{E as n,V as r,_ as i,g as a,pt as o,st as s,tt as c,v as ee,w as l}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/@vue-Bs7Bvl8t.js" ;import{t as u}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/vue-DEdtZKM-.js" ;import{n as d,t as f}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/index-wh6DItv2.js" ;import{i as p}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/ck-icon-Bc0lOl-n.js" ;import{t as m}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/translation.util-FC72oqSg.js" ;import{C as te,Dn as ne,Tn as re,Z as ie,gn as h,ut as ae,vn as g,w as oe}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/cookie-banner-CZUnWPWz.js" ;import{o as _,r as se,s as v,t as y}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/pubsub.services.wrappers-CEaDBQI0.js" ;import{t as ce}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/use-user-activity-ebCXmR_R.js" ;import{i as b,r as le}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/friends.service-LzTmcXFZ.js" ;import{t as ue}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/ck-img-_bFR3B68.js" ;let x=function(e){return e.Offline=`0`,e.Online=`1`,e}({});u(),f();var S=s({ids:[],online:[]}),C=s(new Map),w=s(!1),T=!1;function de(e={onUserPresenceChanged:()=>({})}){return{relatedUsersIds:S,onlineFriends:C,isFetchingFriends:w,start:t,stop:n,clearState:r,getOnlineUserById:i,getRelatedUsersIds:a,getUsersDetailsById:s};async function t(){ let _hh$temp0=d(),e=_hh$temp0.getters; T||!e.isAuthenticated||(o(),w.value=!0,await a(),S.value.online.length&&await s(S.value.online),w.value=!1,T=!0)}function n(){b.stop(),r(),T=!1}function r(){C.value=new Map,S.value={ids:[],online:[]},w.value=!1}function i(e){return C.value.get(e)}async function a(){let e=await le();e.success&&e.data&&(S.value.ids=e.data.ids,S.value.online=e.data.online)}async function o(){b.setReceivers({relatedUsersPresenceEvents:c}),b.start()}async function s(e){w.value=!0;let t=await ie(e);t.success&&t.data&&(e.length===1?C.value.set(e[0], __get$(t.data,e[0]) ):C.value=new Map(Object.entries(t.data))),w.value=!1}function c( _hh$temp1 ){ var _hh$temp2=__arrayFrom$(_hh$temp1),t=_hh$temp2[0],n=_hh$temp2[1]; let r=new Set(S.value.online);e.onUserPresenceChanged([t,n]),n===x.Online?S.value.ids.includes(t)&&(r.add(t),s([t])):(r.delete(t),C.value.delete(t)),S.value.online=Array.from(r)}}f(),u(),e(); var _hh$temp3=d(),E=_hh$temp3.state,D=`puzzle_duel/user/{userId}`,fe=a(()=>`puzzle_duel/user/${E.authUser?.user?.id}`); function pe(e){return v({module:`user-presence`,listeners:{userPresenceEvents:{channel:`presence/users/${e}`,messageWrapper:e=>y(e)}}})}const O=v({module:`puzzle-duel`,listeners:{puzzleDuelEvents:{channel:fe.value,messageWrapper:e=>y(e)}}}),k=h({serverRoute:`api_v2_user_stats_puzzle_duel`,urlOptions:e=>({routeParams:{id:e?.id}}),mocker:async()=>(await t(async()=>{ let _hh$temp4=await import(__get$ProxyUrl(`./puzzle-duel-user-data.mocker-gV1cv6S9.js`,"https://www.chesskid.com/js/client-prod/assets/")),e=_hh$temp4.mockPuzzleDuelUserData; return{mockPuzzleDuelUserData:e}},__vite__mapDeps([0,1,2]))).mockPuzzleDuelUserData()}),A=h({serverRoute:`callback_puzzle_duel_leaderboards`,urlOptions:e=>({queryParams:{period:e?.period}}),mocker:async()=>(await t(async()=>{ let _hh$temp5=await import(__get$ProxyUrl(`./puzzle-duel-leaderboard.mocker-C-rjfLeC.js`,"https://www.chesskid.com/js/client-prod/assets/")),e=_hh$temp5.mockPuzzleDuelLeaderboard; return{mockPuzzleDuelLeaderboard:e}},__vite__mapDeps([3,4,5,6,1,7,2,8]))).mockPuzzleDuelLeaderboard()}),j=g({serverRoute:`callback_puzzle_duel_challenge`,data:e=>({userId:e?.userId})}),M=g({serverRoute:`callback_puzzle_duel_cancel_challenge`,data:e=>({userId:e?.userId})}),N=g({serverRoute:`callback_puzzle_duel_decline_challenge`,data:e=>({userId:e?.userId})}),P=g({serverRoute:`callback_puzzle_duel_finish`,data:e=>({duelId:e?.duelId,gameDuration:e?.gameDuration,player1:e?.player1,player2:e?.player2})}),F=g({serverRoute:`callback_puzzle_duel_seek`}),I=g({serverRoute:`callback_puzzle_duel_cancel_seek`}),L=g({serverRoute:`callback_puzzle_duel_save_audio_settings`,data:e=>({playAudio:e?.isPlayingAudio,playMusic:e?.isPlayingMusic})}),R=h({serverRoute:`api_v1_settings_puzzle_duel`,mocker:async()=>(await t(async()=>{ let _hh$temp6=await import(__get$ProxyUrl(`./puzzle-duel-audio-settings.mocker-kXWk3-zz.js`,"https://www.chesskid.com/js/client-prod/assets/")),e=_hh$temp6.mockPuzzleDuelAudioSettings; return{mockPuzzleDuelAudioSettings:e}},__vite__mapDeps([9,1]))).mockPuzzleDuelAudioSettings()}),z=_({channel:D,messageCode:`GAME`,outgoingData:e=>({gameId:e.gameId,players:e.players,puzzles:e.puzzles,gameStartTime:e.gameStartTime,score:e.score,opponentGameStartTime:e.opponentGameStartTime,opponentScore:e.opponentScore,opponentPuzzleIndex:e.opponentPuzzleIndex,headToHead:e.headToHead,puzzleIndex:e.puzzleIndex})}),B=_({channel:D,messageCode:`GAME_START`,outgoingData:e=>({gameId:e.gameId,startTime:e.startTime})}),me=_({channel:D,messageCode:`GAME_CANCEL`,outgoingData:e=>({gameId:e.gameId})}),he=_({channel:D,messageCode:`PLAYER_PROGRESS`,outgoingData:e=>({gameId:e.gameId,score:e.score,puzzleIndex:e.puzzleIndex})}),ge=_({channel:D,messageCode:`GAME_END`,outgoingData:e=>({gameId:e.gameId,puzzleScores:e.puzzleScores,score:e.score})}),_e=_({channel:D,messageCode:`PING`,outgoingData:e=>({pingId:e.pingId,userId:E.authUser?.user.id})}),V=_({channel:D,messageCode:`PONG`,outgoingData:e=>({pongId:e.pongId,isBusy:e.isBusy,reachedFreeGamesLimit:e.reachedFreeGamesLimit})}),ve=se({url:`presence/capabilities/stats`}),ye=2e4,be=3,xe=20,Se=2e3,Ce=-1,we=2,H=20,Te=3,Ee=1,De=5,Oe=120,ke=3e4,Ae=.3,je=.2,Me=1e4,Ne=2e3,Pe=5,Fe=3600,Ie=`puzzle-duel`,Le=3e3,U=`puzzle_duel_notification`,Re=300,ze=[`puzzle-duel/song1`,`puzzle-duel/song2`,`puzzle-duel/song3`,`puzzle-duel/song4`],Be=[`puzzle-duel/correct-alt`,`puzzle-duel/countdown`,`puzzle-duel/defeat`,`puzzle-duel/firework1`,`puzzle-duel/firework2`,`puzzle-duel/game-end`,`puzzle-duel/game-start`,`puzzle-duel/incorrect-alt`,`puzzle-duel/reveal`,`puzzle-duel/sword`,`puzzle-duel/time-warning`,`puzzle-duel/victory`,`fastchess/capture`,`fastchess/castle`,`fastchess/illegal`,`fastchess/move-check`,`fastchess/move-opponent`,`fastchess/move-self`,`fastchess/promote`,`fastchess/tenseconds`];function W(e,t){return e.code===t}u();var Ve=[`innerHTML`],He=n({__name:`challenge-received-notification`,props:{challenger:{},actions:{}},setup(e){return(t,n)=>(r(),ee(ne,{class:`challenge-received-notification`,actions:e.actions,duration:1/0},{image:c(()=>[l(ue,{src:e.challenger.avatar},null,8,[`src`])]),content:c(()=>[i(`p`,{innerHTML:(`trans`in t?t.trans:o(m))(`i18n_translation.challenger_wants_duel`,{"%username%":e.challenger.username})},null,8,Ve)]),_:1},8,[`actions`]))}});u(),f(); var G=s(!1),K=re(),_hh$temp7=d(),q=_hh$temp7.state,J=_hh$temp7.getters,Ue=te(),_hh$temp8=ce(),We=_hh$temp8.isBusy,Y=a(()=>Ue.value.name===`puzzles-duel`),X=ae(),Z=s(``); function Ge(){return{isInitialized:G,startListeners:Ke,declineChallenge:Q,on:X.on,stop:X.stop}}function Ke(){!J.isAuthenticated||G.value||(O.setReceivers({puzzleDuelEvents(e){W(e,`PING`)&&!Y.value&&Je(e.data),W(e,`CHALLENGE`)&&!Y.value&&qe(e.data),W(e,`CHALLENGE_CANCEL`)&&!Y.value&&Ye(e.data),X.trigger(`_incoming message`,e)}}),O.start(),G.value=!0)}async function qe( _hh$temp9 ){ var e=_hh$temp9.challenger; Z.value=e.id,K.showNotification({id:U,component:He,props:{challenger:e,actions:[{text:m(`i18n_translation.accept`),icon:p.Check,handler:Xe},{text:m(`i18n_translation.decline`),icon:p.Cross,isFadedText:!0,handler:Q}]}})}async function Je(e){if(!q.authUser)return;let t=await k({id:q.authUser.user.id});if(t.success&&t.data){let n=J.isUserBasic&&(t.data.limitPeriod.gamesLeft===0||t.data.limitPeriod.secondsLeft===0);V({pongId:e.pingId,isBusy:We.value,reachedFreeGamesLimit:n,userId:e.userId})}}function Ye(e){Z.value===e.userId&&$()}async function Xe(){oe().push({name:`puzzles-duel`,query:{challenger:Z.value}}),$()}async function Q(){N({userId:Z.value}),$()}function $(){K.hideNotification(U),Z.value=``}export{P as A,_e as B,De as C,I as D,M as E,L as F,de as G,B as H,F as I,me as L,A as M,k as N,j as O,ve as P,ge as R,Ee as S,ke as T,he as U,V,pe as W,ze as _,Pe as a,Ae as b,Se as c,Re as d,Ie as f,Fe as g,H as h,be as i,R as j,N as k,Me as l,we as m,W as n,Le as o,Ce as p,ye as r,xe as s,Ge as t,Ne as u,je as v,Oe as w,Te as x,Be as y,z};
/*hammerhead|script|end*/
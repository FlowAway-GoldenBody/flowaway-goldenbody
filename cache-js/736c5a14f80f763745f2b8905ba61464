/*hammerhead|script|start*/"use strict";if (typeof window !== 'undefined' && window){window['hammerhead|process-dom-method'] && window['hammerhead|process-dom-method']();if (window.__get$ && typeof __get$ === 'undefined')var __get$Loc = window.__get$Loc,__set$Loc = window.__set$Loc,__set$ = window.__set$,__get$ = window.__get$,__call$ = window.__call$,__get$Eval = window.__get$Eval,__proc$Script = window.__proc$Script,__proc$Html = window.__proc$Html,__get$PostMessage = window.__get$PostMessage,__get$ProxyUrl = window.__get$ProxyUrl,__rest$Array = window.__rest$Array,__rest$Object = window.__rest$Object,__arrayFrom$ = window.__arrayFrom$;} else {if (typeof __get$ === 'undefined')var __get$Loc = function(l){return l},__set$Loc = function(l,v){return l = v},__set$ = function(o,p,v){return o[p] = v},__get$ = function(o,p){return o[p]},__call$ = function(o,p,a){return o[p].apply(o,a)},__get$Eval = function(e){return e},__proc$Script = function(s){return s},__proc$Html = function(h){return h},__get$PostMessage = function(w,p){return arguments.length===1?w.postMessage:p},__get$ProxyUrl = function(u,d){return u},__rest$Array = function(a,i){return Array.prototype.slice.call(a, i)},__rest$Object = function(o,p){var k=Object.keys(o),n={};for(var i=0;i<k.length;++i)if(p.indexOf(k[i])<0)n[k[i]]=o[k[i]];return n},__arrayFrom$ = function(r){if(!r)return r;return!Array.isArray(r)&&"function"==typeof r[Symbol.iterator]?Array.from(r):r};if (typeof importScripts !== "undefined" && /\[native code]/g.test(importScripts.toString())) {var __getWorkerSettings$ = function () {return null};importScripts((location.origin || (location.protocol + "//" + location.host)) + "/worker-hammerhead.js");}}/*hammerhead|script|processing-header-end*/
"use strict";(self.webpackChunkxiangqi_client=self.webpackChunkxiangqi_client||[]).push([[4441],{94441(e,t,n){n.r(t),n.d(t,{default:()=>ec});var r,i,o,a,s,c,u,l,d=n(96540),m=n(39125),f=n(67467),p=n(8604),v=n(47459),g=n(97132),y=n(56725),h=n(21340),b=n(15642),w=n(31470),A=n(65503),x=n(55491),M=n(74219),S=n(33647),k=n(20235),O=n(14038),E=n(72963),C=n(80421),_=n(47367),P=n(56735),I=n(798),j=n(7514),R=n(79996),N=n(1058),T=n(81048),G=n(13919),D=n(72742),L=n(7963),U=n(93535),W=n(56915),z=n(39030),$=n(39905),B=n(35129),H=n(84127),F=n(21784),q=n(43526),J=n(63393),Q=n(29171),V=n(41874),Z=n(83601),K=n(19809),X=n(92550),Y=n(86202),ee=n(64750),te=n(8162);function ne(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const re=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"tr5l94-0"})(["overflow-y:auto;border:1px solid ",";border-width:1px 0;height:calc(100% - ","px);",";.users-list-ad{margin:0 auto;}.user-list-tabs{height:calc(100% - ","px);",";.tab-buttons{width:95%;button.tab{padding:0;}",";}.tab-content{width:100%;",";}}.container{padding-top:20px;",";.list-heading{color:",";font-size:16px;font-weight:500;display:flex;justify-content:space-between;",";}.retry{cursor:pointer;width:20px;height:20px;filter:",";}.user-list{margin-top:18px;height:100%;width:100%;.no-users{margin-top:20px;font-weight:500;}.user-item{width:100%;display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px;color:",";position:relative;background:",";padding:12px 24px;",";&:nth-child(even){background:",";}.user{display:flex;align-items:center;width:calc(100% - ","px);.avatar{width:45px;height:45px;cursor:pointer;}.flag{font-size:14px;position:absolute;bottom:10px;left:55px;",";}.details{margin-left:10px;display:flex;flex-direction:column;align-items:flex-start;width:calc(100% - 60px);.username{color:",";font-size:14px;font-weight:600;cursor:pointer;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;}.rating{color:",";font-size:14px;font-weight:400;}}}.btn{margin:0;width:","px;border-radius:10px;height:30px;align-self:center;font-size:12px;font-weight:600;}}.load-more-btn-holder{display:flex;justify-content:center;gap:8px;.red-tertiary{border:2px solid ",";background:",";border-radius:6px;min-width:120px;color:",";box-shadow:none;font-weight:600;font-size:14px;height:38px;align-self:center;line-height:14px;padding:0px 10px;text-transform:capitalize;width:auto;img{width:18px;margin-right:8px;margin-left:-3px;}}}}}"],function(e){return e.theme.border_4},164,z.$_.phone(r||(r=ne(["\n    height: 100%;\n  "]))),50,z.$_.phone(i||(i=ne(["\n      height: calc(100% - ","px - ","px);\n    "])),50,10),z.$_.phone(o||(o=ne(["\n        width: 100%;\n      "]))),z.$_.phone(a||(a=ne(["\n        padding-top: 0;\n      "]))),z.$_.phone(s||(s=ne(["\n      padding-top: 8px;\n    "]))),function(e){return e.theme.blackToWhite},z.$_.phone(c||(c=ne(["\n        text-align: left;\n      "]))),function(e){return e.theme.toWhiteFilter},function(e){return e.theme.text_11},function(e){return e.theme.background_2},z.$_.phone(u||(u=ne(["\n          padding: 8px 12px;\n        "]))),function(e){return e.theme.background_14},112,z.$_.phone(l||(l=ne(["\n              left: 40px;\n            "]))),function(e){return e.theme.text_18},function(e){return e.theme.text_18},112,function(e){return e.theme.button_1},function(e){return e.theme.background_2},function(e){return e.theme.text_2});var ie=n(9404),oe=n(12665),ae=n(5981);function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?ce(Object(n),!0).forEach(function(t){le(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function le(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=se(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==se(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}var de=(0,ie.fromJS)({usersList:null,hasNextPage:!1,isFetchingUsersList:!1,usersListError:null,sendingUserInvite:!1,userInviteSuccess:!1,userInviteError:null,friendsList:null,friendsListSuccess:!1,friendsListError:null,invites:null,inviteLimit:!1});const me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oe.d6:var n=(0,K.HW)();return e.set("isFetchingUsersList",!0).set("invites",(0,ae.VU)(null===n||void 0===n?void 0:n.is_premium));case oe.r3:var r=t.data.items,i=(0,ae.Ox)(r);return e.set("isFetchingUsersList",!1).set("usersList",1===t.data.page?i:e.get("usersList").concat(i)).set("hasNextPage",t.data.has_next_page);case oe.Cs:return e.set("isFetchingUsersList",!1).set("usersListError",t.error);case oe.Gf:var o=t.payload.opponent,a=e.get("usersList"),s=null===a||void 0===a?void 0:a.map(function(e){return e.username===o?ue(ue({},e),{},{can_invite:!1}):e}),c=e.get("friendsList"),u=null===c||void 0===c?void 0:c.map(function(e){return e.username===o?ue(ue({},e),{},{can_invite:!1}):e});return(0,ae.oN)(o),e.set("sendingUserInvite",!0).set("userInviteSuccess",!1).set("usersList",s).set("friendsList",u);case oe.Iw:return e.set("sendingUserInvite",!1).set("userInviteSuccess",!0);case oe.D:return e.set("sendingUserInvite",!1).set("userInviteError",t.error);case oe.o4:var l=t.data.items,d=(0,ae.Ox)(l);return e.set("friendsList",d).set("friendsListSuccess",!0);case oe.fW:return e.set("friendsListError",t.error);case oe.JY:var m=(0,ae.Yd)();return e.set("invites",m);case oe.z5:return e.set("inviteLimit",t.payload);case oe.Il:return e.set("usersListError",null).set("userInviteError",null).set("friendsListError",null);case oe.sr:return de;default:return e}};var fe=n(69917),pe=n(57823),ve=function(e){return{type:oe.r3,data:e}},ge=function(e){return{type:oe.Cs,error:e}},ye=function(e){return{type:oe.Iw,data:e}},he=function(e){return{type:oe.D,error:e}},be=function(e){return{type:oe.o4,data:e}},we=function(e){return{type:oe.z5,payload:e}};function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}var xe=Me().m(Ie);function Me(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Se(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],d=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,s=0,c=e,m.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!d&&u&&!i&&t<l.length;t++){var i,o= __get$(l,t) ,f=m.p,p=o[2];n>3?(i=p===r)&&(c= __get$(o,(s=o[4])?5:(s=3,3)) ,o[4]=o[5]=e):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,m.v=r,m.n=o[1]):f<p&&(i=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,m.n=p,s=0))}if(i||n>1)return a;throw d=!0,r}return function(i,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,p),s=l,c=p;(t=s<2?e:c)||!d;){o||(s?s<3?(s>1&&(m.n=-1),f(s,c)):m.n=c:m.v=c);try{if(u=2,o){if(s||(i="next"),t= __get$(o,i) ){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(d=m.n<0)?c:n.call(r,m))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l= __get$([],r) ?t(t( __call$([],r,[]) )):(Se(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Se(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,Se(d,"constructor",u),Se(u,"constructor",c),c.displayName="GeneratorFunction",Se(u,i,"GeneratorFunction"),Se(d),Se(d,i,"Generator"),Se(d,r,function(){return this}),Se(d,"toString",function(){return"[object Generator]"}),(Me=function(){return{w:o,m}})()}function Se(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Se=function(e,t,n,r){function o(t,n){Se(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}): __set$(e,t,n) :(o("next",0),o("throw",1),o("return",2))},Se(e,t,n,r)}function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?ke(Object(n),!0).forEach(function(t){Ee(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ee(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Ae(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ae(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}var Ce={};function _e(e){var t=e.payload;return Me().m(function e(){var n,r,i,o,a,s,c,u,l,d,m;return Me().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=t.gameID,r=t.page,i=t.selectedTabIndex,o=t.refresh,a=void 0!==o&&o,s=0===i?oe.yh.USERS:oe.yh.FRIENDS,c="users/online_users?game_id=".concat(n,"&page=").concat(r,"&type=").concat(s),u="".concat(n,"_").concat(r,"_").concat(i),! __get$(Ce,u) ||a){e.n=4;break}if(l= __get$(Ce,u) ,0!==i){e.n=2;break}return e.n=1,(0,fe.yJ)(ve(Oe(Oe({},l),{},{page:r})));case 1:e.n=3;break;case 2:return e.n=3,(0,fe.yJ)(be(Oe({},l)));case 3:case 10:return e.a(2);case 4:return e.p=4,e.n=5,(0,fe.T1)(pe.Ay,c);case 5:if(d=e.v, __set$(Ce,u,d) ,0!==i){e.n=7;break}return e.n=6,(0,fe.yJ)(ve(Oe(Oe({},d),{},{page:r})));case 6:e.n=8;break;case 7:return e.n=8,(0,fe.yJ)(be(Oe({},d)));case 8:e.n=10;break;case 9:return e.p=9,m=e.v,e.n=10,(0,fe.yJ)(ge(m.error))}},e,null,[[4,9]])})()}function Pe(e){var t=e.payload;return Me().m(function e(){var n,r;return Me().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=1,e.n=2,(0,fe.T1)(pe.Ay,"v2/games/custom_game_invite",{method:"POST",body:JSON.stringify(t)});case 2:return n=e.v,e.n=3,(0,fe.yJ)(ye(n));case 3:e.n=5;break;case 4:return e.p=4,r=e.v,e.n=5,(0,fe.yJ)(he(r.error));case 5:return e.a(2)}},e,null,[[1,4]])})()}function Ie(){return Me().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,fe.p8)(oe.d6,_e);case 1:return e.n=2,(0,fe.p8)(oe.Gf,Pe);case 2:return e.a(2)}},xe)}var je=function(e){return e.get("usersList")||de},Re=function(){return(0,g.Mz)(je,function(e){var t=e.get("invites");return t&&t.toJS?t.toJS():t})};const Ne=(0,p.YK)({game:{id:"xiangqi.containers.Lobby.game",defaultMessage:"Game"},chat:{id:"xiangqi.containers.Game.GameSidebar.chat",defaultMessage:"Chat"},users:{id:"xiangqi.containers.Game.GameSidebar.users",defaultMessage:"Users"},moves:{id:"xiangqi.containers.Game.GameSidebar.moves",defaultMessage:"Moves"},viewers:{id:"xiangqi.containers.Game.GameSidebar.viewers",defaultMessage:"Viewers"},rating:{id:"xiangqi.containers.Account.rating",defaultMessage:"Rating"},invite:{id:"xiangqi.containers.Game.GamePlay.GameControls.SocialSharing.invite",defaultMessage:"Invite"},loadMore:{id:"xiangqi.containers.Account.loadMore",defaultMessage:"Load More"},success:{id:"xiangqi.containers.Account.success",defaultMessage:"Success"},error:{id:"xiangqi.containers.Account.error",defaultMessage:"Error"},availablePlayers:{id:"xiangqi.containers.Game.GameSidebar.UsersList.availablePlayers",defaultMessage:"Available"},invitationSent:{id:"xiangqi.containers.Game.GameSidebar.UsersList.invitationSent",defaultMessage:"Invitation Sent"},noUsers:{id:"xiangqi.containers.Game.GameSidebar.UsersList.noUsers",defaultMessage:"No available players to invite!"},inviteRemaining:{id:"xiangqi.containers.Game.GameSidebar.inviteRemaining",defaultMessage:"Invitations remaining: {val}"},inviteLimit:{id:"xiangqi.containers.Game.GameSidebar.inviteLimit",defaultMessage:"You are limited to sending a maximum of {val} invitations every {mins} minutes."},subscribeLink:{id:"xiangqi.containers.Game.GameSidebar.subscribeLink",defaultMessage:"Please {link} to get more invites"},friends:{id:"xiangqi.containers.Account.friends",defaultMessage:"Friends"},subscribe:{id:"xiangqi.containers.SubscriptionModal.subscribe",defaultMessage:"Subscribe"},inviteLimitReached:{id:"xiangqi.containers.Game.GameSidebar.inviteLimitReached",defaultMessage:"You\u2019ve Hit the Invitation Limit"},inviteLimitReachedDesc:{id:"xiangqi.containers.Game.GameSidebar.inviteLimitReachedDesc",defaultMessage:"Want to invite more players? Upgrade to a premium subscription and send up to 30 invitations."},upgradeNow:{id:"xiangqi.containers.Game.GameSidebar.upgradeNow",defaultMessage:"Upgrade Now"},refreshList:{id:"xiangqi.containers.Game.GameSidebar.refreshList",defaultMessage:"Refresh List"}});var Te,Ge=n(3644),De=n(25289);function Le(e,t,n,r){Te||(Te="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:Te,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ue=(0,d.memo)((0,p.j4)(function(e){var t=e.user,n=e.onInvitePress,r=e.intl,i=(0,W.W6)();return Le("div",{className:"user-item"},void 0,Le("div",{className:"user"},void 0,Le(Ge.A,{user:t,classNames:"avatar"}),Le("div",{className:"flag"},void 0,Le(De.A,{country:t.country})),Le("div",{className:"details"},void 0,Le("p",{className:"username",onClick:function(){return i.push("/@".concat(t.username))}},void 0,t.username),Le("span",{className:"rating"},void 0,d.createElement(p.sA,Ne.rating)," ",t.rating))),Le("div",{title:t.can_invite?"":r.formatMessage(Ne.invitationSent)},void 0,Le(H.A,{btnType:"red",className:"btn btn-primary",disabled:!t.can_invite,onClick:n(t.username)},void 0,d.createElement(p.sA,Ne.invite))))}));var We,ze;function $e(e,t,n,r){ze||(ze="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:ze,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Be=function(e){var t=e.friends,n=e.friendsListSuccess,r=e.onInvitePress;return $e("div",{className:"container"},void 0,$e("div",{className:"user-list"},void 0,(0,d.useMemo)(function(){return n?0===(null===t||void 0===t?void 0:t.length)?$e("p",{className:"no-users"},void 0,d.createElement(p.sA,Ne.noUsers)):(null===t||void 0===t?void 0:t.length)>0?$e("div",{className:"users"},void 0,t.map(function(e){return $e(Ue,{user:e,onInvitePress:r},e.username)})):"":We||(We=$e("div",{className:"loader"},void 0,$e(E.A,{})))},[n,t,r])))};const He=(0,d.memo)(Be);var Fe,qe;function Je(e,t,n,r){qe||(qe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:qe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Qe=(0,p.j4)(function(e){var t=e.isFetchingUsersList,n=e.usersList,r=e.hasNextPage,i=e.loadMoreClickHandler,o=e.onInvitePress,a=e.pageNum,s=e.handleRefreshList;return Je("div",{className:"container"},void 0,Je("div",{className:"user-list"},void 0,(0,d.useMemo)(function(){return t&&1===a.current?Fe||(Fe=Je("div",{className:"loader"},void 0,Je(E.A,{}))):0===(null===n||void 0===n?void 0:n.length)?Je("p",{className:"no-users"},void 0,d.createElement(p.sA,Ne.noUsers)," "):(null===n||void 0===n?void 0:n.length)>0?n.map(function(e,t){return Je(Ue,{user:e,onInvitePress:o},"user.username.".concat(t))}):""},[t,a,n]),Je("div",{className:"load-more-btn-holder"},void 0,Je(H.A,{type:"button",className:"red-tertiary",onClick:s},void 0,Je(J.A,{src:$.Ay.retryRedIcon,alt:"refresh",className:"to-white"}),d.createElement(p.sA,Ne.refreshList)),r&&Je(H.A,{btnType:"red",className:"red-tertiary",loading:t,onClick:i},void 0,d.createElement(p.sA,Ne.loadMore)))))});var Ve,Ze=n(17638),Ke=n(56640),Xe=n(37025);const Ye=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"sc-1bboze8-0"})(["padding:0 8px;text-align:center;margin:auto;",";h2{font-size:14px;font-weight:600;color:",";line-height:1;margin-bottom:4px;}p{font-size:10px;font-weight:500;color:",";.link{color:",";text-decoration:underline;}}"],z.$_.phone(Ve||(et=["\n    margin: 10px auto 0;\n  "],tt||(tt=et.slice(0)),Ve=Object.freeze(Object.defineProperties(et,{raw:{value:Object.freeze(tt)}})))),function(e){return e.theme.text_23},function(e){return e.theme.sliderLabel},function(e){return e.theme.heading_2});var et,tt,nt;function rt(e,t,n,r){nt||(nt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:nt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n= __get$(arguments,t) ;for(var r in n)({}).hasOwnProperty.call(n,r)&&( __set$(e,r,__get$(n,r)) )}return e},it.apply(null,arguments)}const ot=(0,d.memo)((0,p.j4)(function(e){var t=e.invites,n=e.intl,r=e.className,i=(0,d.useMemo)(function(){return(0,K.HW)().is_premium},[]),o=(0,d.useMemo)(function(){return{val:i?Xe.Ud.PREMIUM:Xe.Ud.BASIC,mins:Xe.Qb}},[i]);return rt(Ye,{className:r},void 0,rt(Ke.A,{},void 0,d.createElement(p.sA,it({},Ne.inviteRemaining,{values:{val:null===t||void 0===t?void 0:t.maxInvites}}))),rt(Ze.A,{},void 0,d.createElement(p.sA,it({},Ne.inviteLimit,{values:{val:o.val,mins:o.mins}}))),!i&&rt(Ze.A,{},void 0,d.createElement(p.sA,it({},Ne.subscribeLink,{values:{link:rt(W.N_,{to:function(){return{pathname:A.R7.SUBSCRIPTION,state:{showPremiumText:!0}}},className:"link"},void 0,n.formatMessage(Ne.subscribe))}}))))}));var at;function st(e,t,n,r){at||(at="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:at,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var lt="usersList",dt=(0,g.j8)({usersList:(0,g.Mz)(je,function(e){return e.get("usersList")}),isFetchingUsersList:(0,g.Mz)(je,function(e){return e.get("isFetchingUsersList")}),hasNextPage:(0,g.Mz)(je,function(e){return e.get("hasNextPage")}),usersListError:(0,g.Mz)(je,function(e){return e.get("usersListError")}),sendingUserInvite:(0,g.Mz)(je,function(e){return e.get("sendingUserInvite")}),userInviteSuccess:(0,g.Mz)(je,function(e){return e.get("userInviteSuccess")}),userInviteError:(0,g.Mz)(je,function(e){return e.get("userInviteError")}),isPremium:(0,U.iU)(),windowWidth:(0,U.f1)(),windowHeight:(0,U.gp)(),friendsList:(0,g.Mz)(je,function(e){return e.get("friendsList")}),friendsListSuccess:(0,g.Mz)(je,function(e){return e.get("friendsListSuccess")}),invites:Re()}),mt=(0,f.connect)(dt,function(e){return{makeFetchUsersList:function(t){return e(function(e){return{type:oe.d6,payload:e}}(t))},makeInviteUser:function(t){return e(function(e){return{type:oe.Gf,payload:e}}(t))},makeUpdateInviteLimit:function(){return e({type:oe.JY})},makeSetInviteLimit:function(t){return e(we(t))},makeClearErrors:function(){return e({type:oe.Il})},makeClearState:function(){return e({type:oe.sr})}}}),ft=(0,y.A)({key:lt,reducer:me}),pt=(0,h.A)({key:lt,saga:Ie,mode:A.Zc});const vt=(0,p.j4)((0,v.Zz)(mt,ft,pt)(function(e){var t,n,r=e.intl,i=e.className,o=e.usersList,a=e.isFetchingUsersList,s=e.hasNextPage,c=e.usersListError,u=e.userInviteError,l=e.makeClearErrors,m=e.makeClearState,f=e.makeFetchUsersList,p=e.makeInviteUser,v=e.gameID,g=e.isPremium,y=e.windowWidth,h=e.windowHeight,b=e.friendsList,w=e.friendsListSuccess,A=e.invites,x=e.makeUpdateInviteLimit,M=e.makeSetInviteLimit,S=(0,d.useRef)(1),k=ct((0,d.useState)(0),2),O=k[0],E=k[1],C=(0,d.useMemo)(function(){return!g&&(!(y<=z.LR.phone.maxWidth||h<=z.LR.xsmallheight.maxHeight)&&(y>=z.LR.phone.maxWidth&&h>=z.LR.smallheight.maxHeight?ee.DV.HORIZONTAL.DESKTOP.MODAL:void 0))},[h,y,z.LR,ee.DV,g]),_=(0,d.useMemo)(function(){if(!o)return[];var e=new Set;return o.filter(function(t){return!e.has(t.username)&&e.add(t.username)})},[o]),P=function(e){return function(){var t=K.Ay.getItem(oe.kx);0===(null===t||void 0===t?void 0:t.maxInvites)&&(0,ae.mL)(g)?M(!0):(x(),p({game_id:v,opponent:e}))}},I=function(){S.current+=1,f({page:S.current,gameID:v,selectedTabIndex:O})},j=function(){f({page:1,gameID:v,selectedTabIndex:O,refresh:!0})};(0,d.useEffect)(function(){return function(){m()}},[]),(0,d.useEffect)(function(){f({page:S.current,gameID:v,selectedTabIndex:O})},[O]),(0,d.useEffect)(function(){if(c||u){var e=(null===c||void 0===c?void 0:c.message)||(null===u||void 0===u?void 0:u.message);(0,Z.A)({title:r.formatMessage(Ne.error),msg:e,type:"error"}),l()}},[c,u]);var R=(0,d.useMemo)(function(){return[{text:Ne.availablePlayers,component:t||(t=st(Qe,{usersList:_,hasNextPage:s,pageNum:S,onInvitePress:P,isFetchingUsersList:a,loadMoreClickHandler:I,handleRefreshList:j}))},{text:Ne.friends,component:n||(n=st(He,{friends:b,friendsListSuccess:w,onInvitePress:P}))}]},[a,_,s,I,P,S,b,w,j]);return st(re,{className:i},void 0,C&&st(Y.A,{ad:C,wrapperClassName:"users-list-ad"}),st(X.A,{selectedTabIndex:O,tabClickHandler:E,tabs:R,className:"user-list-tabs"}),y<=z.LR.phone.maxWidth&&st(ot,{invites:A}))}));var gt,yt,ht,bt,wt,At,xt,Mt,St=n(21663),kt=n(4755);function Ot(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const Et=te.Ay.div.withConfig({displayName:"Wrapper__ContentWrapper",componentId:"zwq209-0"})(["padding:40px 30px;text-align:center;background:",";display:flex;flex-direction:column;align-items:center;",";"," .users-list{width:100%;padding:8px 4px;",";}.waiting-buttons{display:flex;align-items:center;}.modal-btn{width:auto;padding:12px 16px;margin:4px;background:",";color:",";height:60px;line-height:1;box-shadow:0px 7px 14px 0px rgba(65,69,88,0.1);min-width:100px;&:hover,&:disabled{color:",";}img{margin-right:8px;margin-top:-2px;&.to-white{filter:",";}}.md-icon{height:24px;}.ladda-label{color:",";line-height:1;font-size:20px;text-transform:capitalize;font-weight:bold;",";}",";"," &.red{background:",";border:2px solid ",";.ladda-label{color:",";}}&.red-tertiary{border:2px solid ",";background:",";.ladda-label{color:",";}}}h1{font-size:32px;line-height:1.5;text-align:center;color:",";margin-bottom:20px;font-weight:600;text-transform:capitalize;",";",";}.remaining-time{color:",";}"],function(e){return e.theme.background_16},z.$_.imac(gt||(gt=Ot(["\n    padding: 24px;\n  "]))),z.$_.phone(yt||(yt=Ot(["\n    padding: 10px;\n    height: 100%;\n  "]))),z.$_.phone(ht||(ht=Ot(["\n      padding: 0;\n      overflow: hidden;\n    "]))),z.ut.$yellow,z.ut.$red,z.ut.$yellow,function(e){return e.theme.toWhiteFilter},z.ut.$red,z.$_.imac(bt||(bt=Ot(["\n        font-size: 16px;\n    "]))),z.$_.imac(wt||(wt=Ot(["\n      height: 48px;\n      line-height: 1;\n    "]))),z.$_.phone(At||(At=Ot(["\n      padding: 10px 12px;\n      height: 40px;\n      line-height: 1;\n    "]))),z.ut.$fireBrick,z.ut.$fireBrick,z.ut.$floralWhite,function(e){return e.theme.button_1},function(e){return e.theme.background_2},function(e){return e.theme.heading_2},function(e){return e.theme.text_7},z.$_.imac(xt||(xt=Ot(["\n      font-size: 24px;\n    "]))),z.$_.phone(Mt||(Mt=Ot(["\n      font-size: 20px;\n      margin-bottom: 10px;\n    "]))),function(e){return e.theme.heading_1});var Ct,_t=n(94012);function Pt(e){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pt(e)}function It(e,t,n,r){Ct||(Ct="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:Ct,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?jt(Object(n),!0).forEach(function(t){Nt(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Nt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Pt(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Pt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Gt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var Dt=function(e){var t,n,r,i=e.gameState,o=e.isPlayer,a=e.computerGameHandler,s=e.getGameUrl,c=e.windowWidth,u=e.gamePlayers,l=e.isGuestUser,m=e.checkSearchStatus,f=e.quickGameSetting,v=e.cancelQuickGame,g=e.isFocusMode,y=e.isClubGame,h=(0,W.W6)(),b=Tt((0,d.useState)(!1),2),w=b[0],A=b[1],x=(0,d.useMemo)(function(){return c<=z.LR.phone.maxWidth},[c,z.LR]),M=(0,d.useMemo)(function(){return Object.values(u).map(function(e){return null===e||void 0===e?void 0:e.username})},[u]),S=(0,d.useMemo)(function(){return!l&&x&&o&&i===Xe._p.WAITING&&M.some(function(e){return!e})},[u,M,i,x,o,l]),k=(0,d.useMemo)(function(){var e;return null===(e=s())||void 0===e||null===(e=e.split("/"))||void 0===e?void 0:e.pop()},[s]);(0,d.useEffect)(function(){var e;A((e=i)===kt.Ln.WAITING||e===kt.Ln.BEGIN||e===kt.Ln.CREATING)},[i]);var O=(0,d.useMemo)(function(){return c<z.LR.mediumphone.maxWidth?kt.Ts.MOBILE:c>z.LR.imac.maxWidth?kt.Ts.IMAC_SIZE:kt.Ts.DESKTOP},[c]),E=(0,d.useMemo)(function(){return{content:Rt({maxWidth:O,borderRadius:12},(0,_t.OI)(k)&&{padding:"0px"}||S&&!y&&{height:"80%"}||{})}},[O,S,k,y]),C=function(){A(!1)},_=function(){A(!w)},P=function(){v(),h.push("/lobby")};return function(){var e=null;switch(i){case kt.Ln.CREATING:if((0,_t.OI)(k)){if(!x&&!g)return null;e=t||(t=It(St.A,{checkSearchStatus:m,cancelClickHandler:P,selectedTime:f,isFullWidth:!0}))}break;case kt.Ln.WAITING:e=It(Et,{},void 0,It(B.A,{},void 0,d.createElement(p.sA,V.A.waitingForOpponent)),S&&!y?n||(n=It(vt,{className:"users-list",gameID:k})):It("div",{className:"waiting-buttons"},void 0,o&&It(Q.A,{gameUrl:s,renderIcon:!1,isInviteButton:!0,className:"red-tertiary modal-btn"},void 0,It(J.A,{src:$.Ay.redShareIcon,alt:"share-icon",className:"to-white"})),It(H.A,{btnType:"yellow",onClick:a,className:"red modal-btn"},void 0,It(J.A,{src:$.Ay.botIcon,alt:"bot-icon",className:"md-icon"}),d.createElement(p.sA,V.A.vsComputer))));break;case kt.Ln.BEGIN:e=It(Et,{},void 0,It(B.A,{},void 0,d.createElement(p.sA,V.A.gameBegin)),r||(r=It(q.A,{timeout:5,onFinishHandler:C,timerClassName:"remaining-time"})));break;default:return null}return It(F.A,{isOpen:w,onRequestClose:_,onClose:_,parentSelector:function(){return i===kt.Ln.WAITING&&S?document.body:x&&i===kt.Ln.WAITING?document.querySelector(".board-wrapper")||document.body:document.querySelector("#game-area")||document.body},dontAllowClose:!S||(0,_t.OI)(k),closeButtonSize:12,styles:E},"modal-".concat(g?"focus":"normal"),e)}()};const Lt=(0,d.memo)(Dt);var Ut,Wt=n(82411),zt=n(82675),$t=n(55555),Bt=n(1294),Ht=n(3970),Ft=n(39944),qt=n(20895),Jt=n(45394),Qt=n(18766),Vt=n(99860),Zt=n(73338),Kt=n(51046),Xt=n(46692),Yt=n(26690),en=n(5757);const tn=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"sc-3v02tv-0"})(["padding:24px 32px;text-align:center;background:",";display:flex;gap:24px;flex-direction:column;align-items:center;border-radius:16px;.title{font-size:24px;font-weight:700;color:",";margin:0;}.share-row{display:flex;justify-content:space-between;width:100%;.share-item{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;.icon-wrapper{width:64px;height:64px;display:flex;align-items:center;justify-content:center;border-radius:50%;padding:24px 30px;background-color:",";.whatsapp-icon{width:24px;height:24px;}}.item-title{font-size:12px;font-weight:500;color:",";}}}.copy-link{cursor:pointer;width:400px;height:48px;border-radius:4px;border:1px solid ",";color:",";font-size:14px;font-weight:400;display:flex;padding:16px 18px;align-items:center;justify-content:space-between;:hover{background:",";}","}"],function(e){return e.theme.background_48},function(e){return e.theme.text_22},function(e){return e.theme.bg_6},function(e){return e.theme.text_22},function(e){return e.theme.border_15},function(e){return e.theme.cardText},function(e){return e.theme.border_15},z.$_.phone(Ut||(Ut=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n      width: 100%;\n\n      span{\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        max-width: 90%;\n      }\n    "]))));var nn,rn,on={position:"fixed",paddingTop:window.innerWidth>z.LR.mediumphone.maxWidth?"55px":"0px",overflow:"scroll",display:"flex",zIndex:100},an={borderRadius:"16px",maxWidth:"fit-content"};function sn(e,t,n,r){rn||(rn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:rn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function cn(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return un(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],d=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,s=0,c=e,m.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!d&&u&&!i&&t<l.length;t++){var i,o= __get$(l,t) ,f=m.p,p=o[2];n>3?(i=p===r)&&(c= __get$(o,(s=o[4])?5:(s=3,3)) ,o[4]=o[5]=e):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,m.v=r,m.n=o[1]):f<p&&(i=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,m.n=p,s=0))}if(i||n>1)return a;throw d=!0,r}return function(i,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,p),s=l,c=p;(t=s<2?e:c)||!d;){o||(s?s<3?(s>1&&(m.n=-1),f(s,c)):m.n=c:m.v=c);try{if(u=2,o){if(s||(i="next"),t= __get$(o,i) ){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(d=m.n<0)?c:n.call(r,m))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l= __get$([],r) ?t(t( __call$([],r,[]) )):(un(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,un(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,un(d,"constructor",u),un(u,"constructor",c),c.displayName="GeneratorFunction",un(u,i,"GeneratorFunction"),un(d),un(d,i,"Generator"),un(d,r,function(){return this}),un(d,"toString",function(){return"[object Generator]"}),(cn=function(){return{w:o,m}})()}function un(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}un=function(e,t,n,r){function o(t,n){un(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}): __set$(e,t,n) :(o("next",0),o("throw",1),o("return",2))},un(e,t,n,r)}function ln(e,t,n,r,i,o,a){try{var s= __call$(e,o,[a]) ,c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}const dn=(0,d.memo)((0,p.j4)(function(e){var t=e.intl,n=e.isFocusMode,r=e.isOpen,i=e.onClose,o=e.getGameUrl,a=e.shareInChat,s=e.shareInInbox,c=e.myUserInfo,u=(0,d.useMemo)(function(){return(null===c||void 0===c?void 0:c.username)||(null===c||void 0===c?void 0:c.identity)},[c]),l=(0,d.useMemo)(function(){return o()},[o]),m=(0,d.useMemo)(function(){var e;return c&&(null===(e=(0,Xt.gH)(c.rating+c.factor,t.locale))||void 0===e?void 0:e.fullTranslatedLevel)},[]),f=(0,d.useMemo)(function(){return t.formatMessage(V.A.userLevelUpShare,{username:u,level:m,game_link:""})},[t,u,m,l]),v=t.formatMessage(V.A.buddyLevelUp),g=function(){var e,n=(e=cn().m(function e(){var n;return cn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,Yt.A)(l);case 1:e.v?(0,Z.A)({title:t.formatMessage(V.A.linkCopied),msg:t.formatMessage(V.A.pasteLinkInvite),type:"success"}):(0,Z.A)({title:t.formatMessage(V.A.error),msg:t.formatMessage(V.A.errorCopyingLink),type:"error"}),e.n=3;break;case 2:e.p=2,n=e.v,console.error(n);case 3:return e.a(2)}},e,null,[[0,2]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){ln(o,r,i,a,s,"next",e)}function s(e){ln(o,r,i,a,s,"throw",e)}a(void 0)})});return function(){return n.apply(this,arguments)}}(),y=function(e){return function(){var n=t.formatMessage(V.A.userLevelUpShare,{username:u,level:m,game_link:l});e(n)}};return sn(F.A,{isOpen:r,onClose:i,closeButtonSize:14,styles:{overlay:on,content:an}},"modal-".concat(n?"focus":"normal"),sn(tn,{},void 0,sn("h2",{className:"title"},void 0,d.createElement(p.sA,V.A.shareVictory)),sn("div",{className:"share-row"},void 0,sn(en.A,{className:"share-item",onClick:y(a)},void 0,nn||(nn=sn("span",{className:"icon-wrapper"},void 0,sn(J.A,{src:$.Xj,className:"item-icon to-white",alt:"Chatroom icon"}))),sn("p",{className:"item-title"},void 0,d.createElement(p.sA,V.A.chatroom))),sn(en.A,{className:"share-item",onClick:y(s)},void 0,sn("span",{className:"icon-wrapper"},void 0,sn(J.A,{src:$.Ay.Inbox,className:"item-icon to-white",alt:"Chatroom icon"})),sn("p",{className:"item-title"},void 0,d.createElement(p.sA,V.A.inbox))),sn(Kt.uI,{url:l,quote:f,hashtag:"#xiangqi #chinesechess"},void 0,sn(en.A,{className:"share-item"},void 0,sn("span",{className:"icon-wrapper"},void 0,sn(J.A,{src:$.Ay.facebook,className:"item-icon to-white",alt:"Facebook icon"})),sn("p",{className:"item-title"},void 0,d.createElement(p.sA,V.A.facebook))))),sn("div",{className:"share-row"},void 0,sn(Kt.r6,{url:l,title:f,hashtags:["xiangqi","chinesechess"]},void 0,sn(en.A,{className:"share-item"},void 0,sn("span",{className:"icon-wrapper"},void 0,sn(J.A,{src:$.Ay.twitter,className:"item-icon to-white",alt:"Twitter icon"})),sn("p",{className:"item-title"},void 0,d.createElement(p.sA,V.A.twitter)))),sn(Kt.Kz,{url:l,title:f},void 0,sn(en.A,{className:"share-item"},void 0,sn("span",{className:"icon-wrapper"},void 0,sn(J.A,{src:$.Ay.whatsapp,className:"item-icon to-white whatsapp-icon",alt:"WhatsApp icon"})),sn("p",{className:"item-title"},void 0,d.createElement(p.sA,V.A.whatsapp)))),sn(en.A,{className:"share-item",href:"mailto:?subject=".concat(v,"&body=").concat(f,"\n").concat(l)},void 0,sn("span",{className:"icon-wrapper"},void 0,sn(J.A,{src:$.Ay.email,className:"item-icon to-white",alt:"Email icon"})),sn("p",{className:"item-title"},void 0,d.createElement(p.sA,V.A.email)))),sn("div",{className:"copy-link",onClick:g},void 0,sn("span",{},void 0,l),sn(J.A,{src:$.Ay.copylink,className:"to-white",alt:"Copy icon"}))))}));var mn=n(98053),fn=n(82703),pn=n(65497),vn=n(2404),gn=n.n(vn),yn=n(66727),hn=n(63913),bn=n(82832),wn=n(69800),An=n(64708),xn=n(37631),Mn=n(83771),Sn=n(56484),kn=n(559),On=n(37822),En=n(33037),Cn=n(44009),_n=n(14606),Pn=n(49964),In=["k","p","P","K"];function jn(e){return function(e){if(Array.isArray(e))return Rn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!= __get$(e,Symbol.iterator) ||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Rn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var Nn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.filter(function(t){var i,o,a=t.move,s=t.piece,c=t.flags,u=t.captured,l=t.uci,d="c"===c;if(d&&(i=s,o=u,(0,_n.ZB)(o)&&!["r","k","p"].includes(i.toLowerCase())))return!0;if(d&&(In.includes(s)||function(e){var t=e.captured,n=e.color,r=e.move;return(0,_n.nd)(t)&&("r"===n?r.r2>5:r.r2<6)}(t)||function(e,t){var n="".concat(e.move.c1).concat(e.move.r1),r="".concat(e.move.c2).concat(e.move.r2);return t.filter(function(t){return"c"===t.flags&&t.piece===e.captured&&t.captured===e.piece&&"".concat(t.move.c2).concat(t.move.r2)===n&&"".concat(t.move.c1).concat(t.move.r1)===r}).length>0}(t,n)))return!1;var m="".concat(a.c2).concat(a.r2);return d&&!(0,_n.vT)(e,l,r).filter(function(e){return"c"===e.flags&&"".concat(e.move.c2).concat(e.move.r2)===m}).length>0});return i.map(function(e){return{threateningPiece:e.piece,threatenedPiece:e.captured,threatenedLocation:"".concat(e.move.c2).concat(e.move.r2),threateningLocation:"".concat(e.move.c1).concat(e.move.r1)}})},Tn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e){for(var t=!0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n<e.length;n+=2)if(In.includes( __get$(e,n) .movedPiece)||(t=!1),! __get$(e,n) .isCheck)return!1;return!t&&!0}(e,t)||function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=!0,o=function(){var t= __get$(e,a) ,o=t.opponentThreateningMoves,s=t.parsedMove;if(0===o.length)return{v:!1};var c={from:"".concat(s.c1).concat(s.r1),to:"".concat(s.c2).concat(s.r2)},u=e.at(a-1),l=u.threateningMoves,d=u.parsedMove,m=u.isCheck,f=function(e,t,n){return e.filter(function(e){return!t.some(function(t){return(e.threateningLocation===t.threateningLocation||t.threateningLocation===n.to)&&e.threatenedLocation===t.threatenedLocation})})}(o,l,c);if(m||(i=!1),a>n){var p={from:"".concat(d.c1).concat(d.r1),to:"".concat(d.c2).concat(d.r2)};if(0===f.filter(function(e){return r.some(function(t){return e.threateningLocation===t.threateningLocation&&e.threatenedLocation===t.threatenedLocation})}).length&&(!r.some(function(e){return e.threatenedLocation===p.from})||!f.some(function(e){return e.threatenedLocation===p.to})))return{v:!1}}r=f},a=n;a<e.length;a+=2)if(t=o())return t.v;return!i}(e,t)};const Gn=function(e,t,n){var r=function(e,t){for(var n=0,r=t.length-1;r>=0;r-=1)if(e=== __get$(t,r) .uci)return n=t.length-r,t.length<3*n-1?0:n;return n}(e,t);if(0===r)return!1;var i=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=0,o=jn(t);r&&o.push({uci:n});for(var a=o.length-e;a>=0;a-=e)for(var s=0;s<e;s+=1){if( __get$(o,a+s) .uci!== __get$(o,o.length-e+s) .uci)return i/e;i+=1}return i/e}(r,t,e,n);if(i<3)return!1;if(n)return{isDrawn:4===i,isDisabled:!1,isPatternWarning:!1};var o=function(e,t){for(var n=[],r=e.length-t;r<e.length;r+=1){var i= __get$(e,r) .currentFen,o=(0,_n.w3)(i),a=(0,_n.w3)(i,{opponent:!0}),s=(0,_n.pV)( __get$(e,r) .uci),c={turnNow: __get$(e,r) .turn_now,currentFen: __get$(e,r) .currentFen,isCheck: __get$(e,r) .isKingInCheck,movedPiece: __get$(e,r) .piece1,captured: __get$(e,r) .piece2,parsedMove:s.move,uci:s.uci,threateningMoves:Nn(i,o,a),opponentThreateningMoves:Nn(i,a,o,!0)};n.push(c)}return n}(t,r),a=Tn(o);return{isPatternWarning:!(!a&&Tn(o,1))&&3===i,isDrawn:4===i,isDisabled:a}},Dn=Gn;var Ln,Un,Wn,zn,$n,Bn,Hn,Fn,qn,Jn,Qn,Vn,Zn,Kn,Xn,Yn;function er(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var tr=te.Ay.div.withConfig({displayName:"PlayerWrapper__DisconnectWrapper",componentId:"sc-1szgaky-0"})(["position:absolute;top:0;background:rgba(255,213,82,0.7);padding:0px 15px;width:100%;color:",";box-sizing:border-box;z-index:9;text-align:center;border-radius:5px;",";",";"],z.ut.$redHover,z.$_.phone(Ln||(Ln=er(["\n    top: 41px;\n  "]))),z.$_.xsmallheight(Un||(Un=er(["\n    top: 34px;\n  "]))));(0,te.Ay)(W.N_).withConfig({displayName:"PlayerWrapper__ProfileLink",componentId:"sc-1szgaky-1"})(["color:",";"],function(e){return e.isBlackPlayer?e.theme.blackTimers:e.theme.redTimers});te.Ay.div.withConfig({displayName:"PlayerWrapper",componentId:"sc-1szgaky-2"})(["display:flex;align-items:center;background-color:",";justify-content:flex-end;padding:10px 15px;margin:0 0 5px;height:82px;",";.player-pikafish{display:none;",";",";}"," &.bottom{margin:5px 0 0;","}.userTime{font-family:'Din';color:",";position:relative;display:flex;align-items:center;margin-right:auto;> div{margin-right:30px;"," "," &:last-child{margin-right:0;}}.timer-span{margin:0;font-size:26px;"," "," &:last-child{margin:0;}}.bottomtext{font-size:16px;font-syle:normal;display:block;text-align:center;"," ","}}.userInfo{position:relative;.playerInfo{display:flex;align-items:center;position:relative;color:",";.info{display:flex;flex-direction:column;text-align:right;",";"," .userName{margin:0 3px 0 0;vertical-align:top;font-weight:500;.star-image{width:12px;margin:-20px 0 0;}}.ratingNDFlag{display:flex;.playerRating{margin:0 3px 0 0;vertical-align:top;font-weight:500;}}}.avatarNDStatus{position:relative;margin-left:10px;.board-avatar-link img{object-fit:contain;}","}}}"],function(e){return e.theme.background_2},z.$_.xxmdesktop(Wn||(Wn=er(["\n    height: 70px;\n  "]))),z.$_.phone(zn||(zn=er(["\n      display: inline-flex;\n      margin-left: 0;\n      margin-right: auto;\n    "]))),z.$_.smallphone($n||($n=er(["\n      padding: 8px 5px;\n      width: auto;\n      margin-left: 5px;\n    "]))),z.$_.phone(Bn||(Bn=er(["\n    background: none;\n    position: absolute;\n    top: 0;\n    width: 100%;\n    height: unset;\n    left: 0;\n    padding 0px 10px;\n    margin: 0;\n    margin-top: 2px;\n  "]))),z.$_.phone(Hn||(Hn=er(["\n      position: absolute;\n      bottom: 60px;\n      top: auto;\n      width: 100%;\n      left: 0;\n      margin: 0;\n      margin-bottom: 2px;\n      padding 0px 10px;\n    "]))),function(e){return e.isBlackPlayer?e.theme.blackTimers:e.theme.redTimers},z.$_.xmldesktop(Fn||(Fn=er(["\n        margin-right: 20px;\n      "]))),z.$_.phone(qn||(qn=er(["\n        margin-right: 15px;\n      "]))),z.$_.xxmdesktop(Jn||(Jn=er(["\n        font-size: 21px;\n      "]))),z.$_.phone(Qn||(Qn=er(["\n        font-size: 18px;\n      "]))),z.$_.xmldesktop(Vn||(Vn=er(["\n        font-size: 14px;\n      "]))),z.$_.phone(Zn||(Zn=er(["\n        display: none;\n      "]))),function(e){return e.isBlackPlayer?e.theme.blackTimers:e.theme.redTimers},z.$_.xxmdesktop(Kn||(Kn=er(["\n          font-size: 14px;\n        "]))),z.$_.phone(Xn||(Xn=er(["\n          flex-direction: row;\n        "]))),z.$_.lgTablet(Yn||(Yn=er(["\n          display: none;\n        "]))));var nr;function rr(e,t,n,r){nr||(nr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:nr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ir(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return or(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?or(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function or(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}const ar=(0,p.j4)(function(e){var t=e.lastMoveTime,n=e.onTimerFinish,r=e.intl,i=e.isTwoMinutesWaiting,o=ir((0,d.useState)(null),2),a=o[0],s=o[1],c=(0,d.useRef)(null);return(0,d.useEffect)(function(){return function(){return clearTimeout(c.current)}},[]),(0,d.useEffect)(function(){var e=i?120:60,n=i?110:50;clearTimeout(c.current);var r=(0,wn.f4)(Date.now()-t),o=Math.max(e-r,0),a=Math.max(o-n,0);a>0?(s(null),c.current=setTimeout(function(){return s(o-a)},1e3*a)):s(o)},[t,i]),a?rr(tr,{},void 0,r.formatMessage(V.A.playerInitialMoveMsg),rr(q.A,{timeout:a,onFinishHandler:n})):null});var sr=n(59849),cr=n.n(sr),ur=n(79397),lr=n(62621),dr=n(17829),mr=n(12771),fr=n(79219),pr=n(48069),vr=n(22499),gr=function(){return{type:Xe.K6}},yr=function(){return{type:Xe.qH}},hr=function(){return{type:Xe.Od}},br=function(e){return{type:Xe.t_,error:e.error}},wr=function(e){return{type:Xe.u4,data:e}},Ar=function(e){return{type:Xe.SI,response:e}},xr=function(){return{type:Xe.GN}},Mr=function(){return{type:Xe.a3}},Sr=function(){return{type:Xe.ip}},kr=function(e){return{type:Xe._H,payload:e}},Or=function(e){return{type:Xe.M_,game:e}},Er=function(){return{type:Xe.Yj}},Cr=function(e){return{type:Xe.qJ,data:e}},_r=function(e){return{type:Xe.dD,data:e}},Pr=function(e){return{type:Xe.FS,data:e}},Ir=function(e){return{type:Xe.OX,game:e}},jr=function(e){return{type:Xe.hC,data:e}},Rr=function(e){return{type:Xe.wq,data:e}},Nr=function(e){return{type:Xe.au,data:e}},Tr=function(e){return{type:Xe.B$,response:e}},Gr=function(e){return{type:Xe.EO,response:e}},Dr=function(e){return{type:Xe.t8,payload:e}},Lr=function(){return{type:Xe.g9}},Ur=function(){return{type:Xe.lq}},Wr=function(){return{type:Xe.rg}},zr=function(e){return{type:Xe.Kt,response:e}},$r=function(e){return{type:Xe.Jx,error:e}},Br=function(e){return{type:Xe.vJ,response:e}},Hr=function(e){return{type:Xe.oj,error:e}},Fr=n(33769);function qr(e){return qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qr(e)}function Jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Qr(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?Jr(Object(n),!0).forEach(function(t){Vr(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Vr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=qr(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=qr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}var Zr={initFen:Xe.Jq,currentFen:Xe.Jq,turnNow:null,state:0,timers:null,moves:[],activeMoveInd:-1,sendMoveSuccess:!1},Kr=function(e){var t=e.split(" "),n=t[1].split("/"),r=t[2].split("/");return{uci:t[0],timers:{red:{game_secs:Number(n[0]),move_secs:Number( __get$(n,n.length-1) )},black:{game_secs:Number(r[0]),move_secs:Number( __get$(r,r.length-1) )}}}},Xr=function(e,t){return Qr(Qr({},e),{},{server_clock:e.server_clock+t})},Yr=function(e,t,n){return e.turn_now!==t&&((0,Mn.Of)(On.cK,{prevData:n,newData:e}),!0)},ei=function(e,t){return e.map(function(e){return Kr(e)}).map(function(e,n){return(0,Xt.S1)(e,0===n?t:null,n,!0)})},ti=function(e){return e?Qr(Qr({},e),{},{profile_image:(0,Fr.A)(e.profile_image)}):null},ni=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=ei(e.move_history,e.initial_fen).length;return cr().load((0,_n.fp)(e.fen)), __get$(Xt.LK,cr().turn()) !==e.turn_now&&(0,Mn.Of)(On.cK,{prevData:e}),{gameData:{gameID:e.id,tournamentID:e.tournament_id,gameTimer:e.game_timer,moveTimer:e.move_timer,increment:e.increment,isChallenge:e.game_type===Xe.rI.CHALLENGE,isDaily:e.is_daily,isPrivate:e.is_private,isQuick:e.game_type===Xe.rI.QUICK||e.is_quick_game,isRated:e.is_rated,isTimed:e.is_timed,archive:null!==(t=e.archive)&&void 0!==t&&t,ratingDiff:e.rating_diff,isRatingDiffValid:e.is_rating_diff_valid,isClubGame:null!==(n=e.is_club_game)&&void 0!==n&&n},players:{red:ti(e.rplayer),black:ti(e.bplayer)},gamePlay:Qr(Qr({},Zr),{},{initFen:e.initial_fen,currentFen:e.fen,turnNow:e.turn_now,state:e.state,endReason:e.end_reason,startedAt:e.startedAt,endedAt:e.endedAt,timeDiff:r,timers:Xr(e.timers,r),moves:ei(e.move_history,e.initial_fen),activeMoveInd:e.state===kt.Ln.END?-1:i-1}),gameActions:{drawRequest:e.draw_request,timeRequest:e.time_request,undoRequest:e.undo_request,rematchRequest:null}}};function ri(e){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ri(e)}function ii(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||ui(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ai(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?oi(Object(n),!0).forEach(function(t){si(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oi(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function si(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ri(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ri(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ri(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}function ci(e){return function(e){if(Array.isArray(e))return li(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!= __get$(e,Symbol.iterator) ||null!=e["@@iterator"])return Array.from(e)}(e)||ui(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ui(e,t){if(e){if("string"==typeof e)return li(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?li(e,t):void 0}}function li(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var di=(0,ie.fromJS)({initialConnect:!1,fetchGameSuccess:!1,emotionalFlavortext:"",activePreMove:null,gameData:{},expectedPlayerRating:null,gamePlayers:{},gamePlayData:Zr,gameActions:{},error:null,gameWarning:null,flipBoard:!1,isChatOpen:!1,historyMode:!1,showRefreshWarning:!1,moveTimeOutWarning:!1,moveSuccessWithAttempts:0,viewers:[],creatingQuickGame:!1,cancellingQuickGame:!1,createGameData:null,redeemReward:null,rejectedRequest:null,cancelPreMove:!1,clubGameError:null,gameAnalysis:null,localEngineConfig:null,isLoadingLocalEngineConfig:!1,isReportingUser:!1,reportUserSuccess:!1,reportUserError:null,isReportDisabled:!1});const mi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:di,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Xe.j$:return e.set("flipBoard",t.value);case Xe.K6:return e.set("isChatOpen",!e.get("isChatOpen"));case Xe.lq:return e.set("initialConnect",!1);case Xe.qH:return e.set("initialConnect",!0);case Xe.go:return e.set("expectedPlayerRating",t.payload);case Xe._H:return e.get("fetchGameSuccess")?e:e.set("fetchGameSuccess",!1).set("flipBoard",!1).set("historyMode",!1).set("activePreMove",null).set("gameData",{}).set("gamePlayers",{}).set("gamePlayData",Zr).set("gameActions",{}).set("viewers",[]).set("error",null);case Xe.M_:var n=Date.now()-t.game.server_epoch_time;n=Math.abs(n)<700?0:n;var r=ni(t.game,n),i=Object.values(r.players).find(function(e){return e&&[Xe.$X.GUEST_BOT,Xe.$X.BOT].includes(e.p_type)}),o=i&&t.game.state<Xe._p.END?[i].concat(ci(t.game.viewers||e.get("viewers"))):t.game.viewers||e.get("viewers");return e.set("fetchGameSuccess",!0).set("viewers",o).set("activePreMove",t.game.pre_move).set("gameData",r.gameData).set("gamePlayers",r.players).set("gameActions",r.gameActions).set("gamePlayData",r.gamePlay);case Xe.u$:var a=e.get("gamePlayData");return e.set("gamePlayData",ai(ai({},a),{},{state:Xe._p.RUNNING,timers:Xr(ai(ai({},a.timers),{},{server_clock:t.data.server_clock}),a.timeDiff)}));case Xe.Pf:var s=e.get("gamePlayData"),c=t.payload.move,u=c.thinking_time,l=c.move,d=s.timers,m=s.turnNow; __set$(d,m,{game_secs:__get$(d,m).game_secs-u,move_secs:__get$(d,m).move_secs-u}) ,d.server_clock+=1e3*u;var f=s.moves,p=f.length,v=(0,Xt.S1)((0,_n.pV)(l),(0,_n.fp)(t.payload.fen),p,!0);return e.set("gamePlayData",ai(ai({},s),{},{currentFen:v.currentFen,moves:[].concat(ci(f),[v]),turnNow:null,activeMoveInd:v.index,timers:ai({},d),sendMoveSuccess:!1})).set("showRefreshWarning",!1).set("moveTimeOutWarning",!1).set("moveSuccessWithAttempts",0);case Xe.zN:var g=e.get("gamePlayData"),y={},h=null;if(g.moves.length<t.data.moves_count)h=(0,Xt.S1)(Kr(t.data.move),g.currentFen,g.moves.length,!0),y=ai(ai({},g),{},{currentFen:h.currentFen,moves:[].concat(ci(g.moves),[h]),turnNow:t.data.turn_now,activeMoveInd:h.index,timers:Xr(t.data.timers,g.timeDiff),sendMoveSuccess:!0});else{var b= __get$(g.moves,g.moves.length-2) ;b||(b={currentFen:t.data.initial_fen}),h=(0,Xt.S1)(Kr(t.data.move),b.currentFen,g.moves.length-1,!0),y=ai(ai({},g),{},{turnNow:t.data.turn_now,timers:Xr(t.data.timers,g.timeDiff),sendMoveSuccess:!0})}try{if(Yr(h,t.data.turn_now,g)){var w=g.moves,x= __get$(w,w.length-2) ;return x||(x={currentFen:t.data.initial_fen,index:-1}),e.set("gamePlayData",ai(ai({},g),{},{moves:w.slice(0,w.length-1),currentFen:x.currentFen,turnNow:t.data.turn_now,activeMoveInd:x.index})).set("showRefreshWarning",!0)}}catch(t){return e.set("showRefreshWarning",!0)}return e.set("gamePlayData",y);case Xe.Iv:var M,S,k=e.get("gamePlayData"),O=e.get("gamePlayers"),E=(0,K.HW)(),C=E.identity!==(null===(M=O.red)||void 0===M?void 0:M.identity)&&E.identity!==(null===(S=O.black)||void 0===S?void 0:S.identity),_=null;try{if(_=(0,Xt.S1)(Kr(t.data.move),k.currentFen,k.moves.length,!0),Yr(_,t.data.turn_now,k))return e.get("activePreMove")?e.set("cancelPreMove",!0).set("showRefreshWarning",!0):e}catch(t){return e}var P=C&&e.get("historyMode");return e.set("gamePlayData",ai(ai({},k),{},{currentFen:_.currentFen,moves:[].concat(ci(k.moves),[_]),turnNow:t.data.turn_now,activeMoveInd:P?k.activeMoveInd:_.index,timers:Xr(t.data.timers,k.timeDiff)})).set("historyMode",P).set("activePreMove",null);case Xe.Yj:return e.set("moveTimeOutWarning",!0);case Xe.au:return e.set("moveSuccessWithAttempts",t.data);case Xe.wq:var I=t.data,j=I.join,R=I.leave,N=e.get("viewers"),T=ci(N);if(R){var G=T.findIndex(function(e){return e.username===R.username});G>-1&&T.splice(G,1)}else j&&(T=[j].concat(ci(N)));return e.set("viewers",T);case Xe.hC:var D=e.get("gamePlayData");return e.set("historyMode",t.data.historyMode).set("gamePlayData",ai(ai({},D),{},{activeMoveInd:t.data.index}));case Xe.qJ:var L=t.data,U=L.actionType,W=L.payload;if(U===Xe.y6.PRE_MOVE){var z=ii(W.move.split(""),4),$=z[0],B=z[1],H=z[2],F=z[3];return e.set("activePreMove",{c1:$,c2:H,r1:parseInt(B,10),r2:parseInt(F,10),fen:W.fen,move:W.move})}return U===Xe.y6.PRE_MOVE_CANCEL?e.set("activePreMove",null).set("cancelPreMove",!1).set("showRefreshWarning",!1).set("moveTimeOutWarning",!1).set("moveSuccessWithAttempts",0):e.set("gameActions",ai(ai({},e.get("gameActions")),{},si({},t.data.payload.action,{requestor:t.side,state:Xe.Tn.REQUESTED})));case Xe.dD:return e.set("gameActions",ai(ai({},e.get("gameActions")),{},si({},t.data.playerAction,t.data.value)));case Xe.GH:var q,J=t.data,Q=(0,K.HW)(),V=e.get("gamePlayers"),Z=(0,_n.WJ)(V.red,V.black,Q),X=null===(q=J.data)||void 0===q?void 0:q.draw_request,Y=e.get("rejectedRequest");if(Z&&X){var ee,te=Q.identity===(null===V||void 0===V||null===(ee=V.red)||void 0===ee?void 0:ee.identity)?Xe.Zl.RED:Xe.Zl.BLACK;(null===X||void 0===X?void 0:X.requester)=== __get$(Xe.Bl,te) &&(null===X||void 0===X?void 0:X.state)===Xe.Tn.REJECTED&&(Y=J.data)}return e.set("gameActions",ai(ai({},e.get("gameActions")),{},si({},J.action, __get$(J.data,__get$(Xe.E0,J.action)) ))).set("rejectedRequest",Y);case Xe.kp:return e.set("gameActions",ai(ai({},e.get("gameActions")),{},si({},t.data.playerAction,null)));case Xe.J5:return e.set("rejectedRequest",null);case Xe.FS:var ne=e.get("gamePlayData");return e.set("gamePlayData",ai(ai({},e.get("gamePlayData")),{},{timers:ai(ai({},Xr(t.data.timers,ne.timeDiff)),{},{incremented:!0})})).set("gameActions",ai(ai({},e.get("gameActions")),{},{timeRequest:t.data.time_request}));case Xe.yb:var re=t.resp;return re.state===Xe.GE.ACCEPT?e.set("createGameData",{game_id:re.data.id}).set("gameActions",ai(ai({},e.get("gameActions")),{},{rematchRequest:{state:re.state}})):e.set("gameActions",ai(ai({},e.get("gameActions")),{},{rematchRequest:re.data}));case Xe.OX:var ie=ni(t.game,e.get("gamePlayData").timeDiff);return e.set("historyMode",!1).set("gameData",ie.gameData).set("gameActions",ie.gameActions).set("gamePlayData",ie.gamePlay);case Xe.Bf:var oe,ae=e.get("gamePlayers"),se=e.get("gamePlayData"),ce=t.data,ue=ce.end_result,le=ce.end_reason,de=ce.endedAt,me=ue.red,fe=ue.black,pe=(0,K.HW)(),ve=(null===ae||void 0===ae||null===(oe=ae.red)||void 0===oe?void 0:oe.identity)===(null===pe||void 0===pe?void 0:pe.identity)?null===me||void 0===me?void 0:me.factor:null===fe||void 0===fe?void 0:fe.factor;if(ve){var ge=(0,_t.Bm)(pe)+ve;K.Ay.setItem(A.yJ,ai(ai({},pe),{},{rating:ge>0?ge:0}))}return e.set("gamePlayData",ai(ai({},se),{},{state:Xe._p.END,endReason:le,endedAt:de,timers:Xr(ce.timers,se.timeDiff)})).set("gamePlayers",{red:ai(ai({},ae.red),me),black:ai(ai({},ae.black),fe)}).set("historyMode",!1).set("creatingQuickGame",!1);case Xe.Y1:return e.set("error",null).set("createGameData",null).set("creatingQuickGame",!0);case Xe.Ye:return e.set("createGameData",null).set("error",null);case Xe.GN:return e.set("creatingQuickGame",!1).set("cancellingQuickGame",!0);case Xe.Od:return e.set("cancellingQuickGame",!1);case Xe.u4:return e.set("createGameData",ai(ai({},t.data),{},{isQuick:!0}));case Xe.t_:return e.set("error",t.error).set("creatingQuickGame",!1);case Xe.gU:return e.get("showRefreshWarning")?e:e.set("error",t.error);case Xe.k1:return e.set("gameWarning",t.data.warning);case Xe.G1:return e.set("gameWarning",null);case Xe.yZ:var ye=e.get("gamePlayData");return e.set("gamePlayData",ai(ai({},ye),{},{sendMoveSuccess:!1}));case Xe.ss:return e.set("emotionalFlavortext",t.data);case Xe.rg:return e.set("emotionalFlavortext","");case Xe.B$:case Xe.EO:return e.set("redeemReward",t.response);case Xe.pm:return e.set("clubGameError",t.error);case Xe.g9:return e.set("redeemReward",null);case Xe.bw:var he=e.get("badgesEarned"),be=he?[].concat(ci(he),ci(t.payload)):[t.payload];return e.set("badgesEarned",be);case Xe.bm:return e.set("badgesEarned",null);case Xe.OY:var we=ai(ai({},e.get("gameAnalysis")||{}),{},si({},t.moveIndex,t.analysisData));return e.set("gameAnalysis",we);case Xe.Al:return e.set("gameAnalysis",null);case Xe.Ao:return e.set("localEngineConfig",null).set("isLoadingLocalEngineConfig",!0);case Xe.Kt:return e.set("localEngineConfig",t.response).set("isLoadingLocalEngineConfig",!1);case Xe.Jx:return e.set("localEngineConfig",null).set("isLoadingLocalEngineConfig",!1);case Xe.Hl:return e.set("isReportingUser",!0).set("reportUserSuccess",!1).set("reportUserError",null).set("isReportDisabled",!1);case Xe.vJ:return e.set("isReportingUser",!1).set("reportUserSuccess",!0).set("isReportDisabled",!0);case Xe.oj:return e.set("isReportingUser",!1).set("reportUserError",t.error).set("isReportDisabled",!1);case Xe.D1:return e.set("isReportingUser",!1).set("reportUserSuccess",!1).set("reportUserError",null);case Xe.ip:return di;default:return e}};var fi=function(e){return e.get("game")||di},pi=function(){return(0,g.Mz)(fi,function(e){return e.get("fetchGameSuccess")})},vi=function(){return(0,g.Mz)(fi,function(e){return e.get("gameData")})},gi=function(){return(0,g.Mz)(fi,function(e){return e.get("gamePlayers")})},yi=function(){return(0,g.Mz)(fi,function(e){return e.get("gamePlayData")})},hi=function(){return(0,g.Mz)(fi,function(e){return e.get("historyMode")})},bi=function(){return(0,g.Mz)(fi,function(e){return e.get("flipBoard")})},wi=function(){return(0,g.Mz)(fi,function(e){return e.get("isChatOpen")})},Ai=function(){return(0,g.Mz)(fi,function(e){return e.get("viewers")})},xi=n(9260);function Mi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Si(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Si(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Si(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var ki=function(e){try{var t=K.Ay.getItem(A.Gd);if(t&&t.gameId===e&&t.encryptedAnalysis){var n=new Map,r=(0,xi.PV)(t.encryptedAnalysis),i=JSON.parse(r);return Object.entries(i).forEach(function(e){var t=Mi(e,2),r=t[0],i=t[1];n.set(parseInt(r,10),i)}),n}}catch(e){}return new Map},Oi=function(e,t,n){try{var r=K.Ay.getItem(A.Gd)||{},i={};if(r.gameId!==e)r.gameId=e,i={};else if(r.encryptedAnalysis)try{var o=(0,xi.PV)(r.encryptedAnalysis);i=JSON.parse(o)}catch(e){i={}} __set$(i,t,n) ;var a=(0,xi.FA)(JSON.stringify(i));r.encryptedAnalysis=a,delete r.analysis,K.Ay.setItem(A.Gd,r)}catch(e){}};function Ei(e){return function(e){if(Array.isArray(e))return Ni(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!= __get$(e,Symbol.iterator) ||null!=e["@@iterator"])return Array.from(e)}(e)||Ri(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ci(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return _i(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],d=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,s=0,c=e,m.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!d&&u&&!i&&t<l.length;t++){var i,o= __get$(l,t) ,f=m.p,p=o[2];n>3?(i=p===r)&&(c= __get$(o,(s=o[4])?5:(s=3,3)) ,o[4]=o[5]=e):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,m.v=r,m.n=o[1]):f<p&&(i=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,m.n=p,s=0))}if(i||n>1)return a;throw d=!0,r}return function(i,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,p),s=l,c=p;(t=s<2?e:c)||!d;){o||(s?s<3?(s>1&&(m.n=-1),f(s,c)):m.n=c:m.v=c);try{if(u=2,o){if(s||(i="next"),t= __get$(o,i) ){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(d=m.n<0)?c:n.call(r,m))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l= __get$([],r) ?t(t( __call$([],r,[]) )):(_i(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_i(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,_i(d,"constructor",u),_i(u,"constructor",c),c.displayName="GeneratorFunction",_i(u,i,"GeneratorFunction"),_i(d),_i(d,i,"Generator"),_i(d,r,function(){return this}),_i(d,"toString",function(){return"[object Generator]"}),(Ci=function(){return{w:o,m}})()}function _i(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_i=function(e,t,n,r){function o(t,n){_i(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}): __set$(e,t,n) :(o("next",0),o("throw",1),o("return",2))},_i(e,t,n,r)}function Pi(e,t,n,r,i,o,a){try{var s= __call$(e,o,[a]) ,c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Ii(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){Pi(o,r,i,a,s,"next",e)}function s(e){Pi(o,r,i,a,s,"throw",e)}a(void 0)})}}function ji(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||Ri(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ri(e,t){if(e){if("string"==typeof e)return Ni(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ni(e,t):void 0}}function Ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var Ti="TIMEOUT";const Gi=function(e){var t=e.moveHistory,n=e.initFen,r=e.gameState,i=e.isDaily,o=e.myUserInfo,a=e.isOpponentPresent,s=e.onMoveAnalyzed,c=e.onAnalysisClear,u=e.makePlayerAction,l=(0,W.g)().id,m=(0,pr.A)(),p=m.performBoardAnalysis,v=m.engineState,y=(0,f.useDispatch)(),h=(0,f.useSelector)((0,g.Mz)(fi,function(e){return e.get("isLoadingLocalEngineConfig")})),b=(0,f.useSelector)((0,g.Mz)(fi,function(e){return e.get("localEngineConfig")})),w=(0,d.useRef)(!0),x=(0,d.useRef)(new Map),M=(0,d.useRef)(!1),S=(0,d.useRef)(l),k=(0,d.useRef)(null),O=ji((0,d.useState)(new Map),2),E=O[0],C=O[1],_=ji((0,d.useState)(!1),2),P=_[0],I=_[1],j=ji((0,d.useState)(!1),2),R=j[0],N=j[1],T=(0,d.useMemo)(function(){return r===Xe._p.RUNNING},[r]),G=(0,d.useMemo)(function(){return v===fr.zN.READY},[v]),D=(0,d.useCallback)(function(){k.current&&(N(!T&&null),clearTimeout(k.current),k.current=null)},[T]),L=(0,d.useCallback)(function(){D(),N(!0),k.current=setTimeout(function(){if(w.current&&!a){var e={game_id:l,side:(null===o||void 0===o?void 0:o.side)===kt.p6.RED?kt.p6.BLACK:kt.p6.RED,reason:Xe.sj.DISCONNECT_TIMER_EXPIRED};N(null),u({event: __get$(Xe.Tb,Xe.y6.DISCONNECTION_TIMER_EXPIRED) ,payload:e}),k.current=null}},2e4)},[a]),U=(0,d.useCallback)(Ii(Ci().m(function e(){var r,i,o,a,c,u,d,m,f;return Ci().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!M.current&&0!==E.size&&G&&!h){e.n=1;break}return e.a(2);case 1:return r=E.values().next().value,M.current=!0,e.p=2,a=0===r.moveIndex?null:(null===(i=x.current.get(r.moveIndex-1))||void 0===i?void 0:i.score)||null,c=(0,_t.VF)({currentItem:r,initFen:n,moveHistory:t,previousMoveScore:a,engineConfig:b||{depth:10}}),u=(0,vr.Ek)(c),e.n=3,Promise.race([new Promise(function(e){p(u,function(t){return e(t)})}),new Promise(function(e,t){setTimeout(function(){return t(new Error(Ti))},1e4)})]);case 3:null!==(d=e.v)&&void 0!==d&&null!==(o=d.data)&&void 0!==o&&o.s&&w.current&&(m={score:d.data.s,depth:d.data.d||10,pv:d.data.pv,bestMove:d.data.bm,uci:r.move.uci||"",currentFen:r.move.currentFen,ceval:d.ceval||null,winRates:d.winRates},s(r.moveIndex,m),x.current.set(r.moveIndex,m),Oi(l,r.moveIndex,m)),e.n=5;break;case 4:e.p=4,(f=e.v).message!==Ti?(0,mr.Cp)("MP Analysis error at move ".concat(r.moveIndex),{key:"move_index",val:r.moveIndex},{key:"original_error",val:f}):(0,mr.Cp)("MP Analysis timeout at move ".concat(r.moveIndex),{key:"error_type",val:"timeout"},{key:"move_index",val:r.moveIndex});case 5:return e.p=5,w.current&&(C(function(e){var t=new Map(e);return t.delete(r.moveIndex),t}),M.current=!1),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])})),[E,G,n,t,s,h]);return(0,d.useEffect)(function(){return y({type:Xe.Ao}),w.current=!0,function(){w.current=!1,D(),c()}},[]),(0,d.useEffect)(function(){if(l)if(S.current!==l){x.current.clear(),C(new Map),M.current=!1,I(!1),S.current=l;var e=ki(l);x.current=e,e.forEach(function(e,t){s(t,e)}),I(!0)}else if(!P){var t=ki(l);x.current=t,t.forEach(function(e,t){s(t,e)}),I(!0)}},[l,ki,s,P]),(0,d.useEffect)(function(){if(G&&n&&T&&!i&&P&&!h){C(function(e){if(x.current.has(0)||e.has(0))return e;var t=new Map(e);return t.set(0,{moveIndex:0,move:{currentFen:n,turn:null,uci:"",isInitialPosition:!0}}),t})}},[G,n,T,i,P,h]),(0,d.useEffect)(function(){t&&G&&!h&&T&&!i&&P&&C(function(e){var n=new Map(e),r=!1;return t.forEach(function(e,t){var i=t+1,o=x.current.has(i),a=n.has(i);o||a||!e.currentFen||(n.set(i,{move:e,moveIndex:i}),r=!0)}),r?n:e})},[t,G,T,i,P,h]),(0,d.useEffect)(function(){E.size>0&&G&&!h&&U()},[E,G,h,U]),(0,d.useEffect)(function(){v===fr.zN.UNABLE&&(C(new Map),M.current=!1,x.current.clear(),I(!1),function(){try{K.Ay.removeItem(A.Gd)}catch(e){}}(),(0,Mn.Of)(On.$_,{location:"MP Game",game_id:l,game_state:r,move_history:t,analyzed_moves_count:x.current.size}))},[v]),(0,d.useEffect)(function(){if(!a&&T){var e,t,n=(null===o||void 0===o?void 0:o.side)===kt.p6.RED?Xe.Zl.BLACK:Xe.Zl.RED,r=Math.max.apply(Math,Ei(x.current.keys())),i=null===(e=x.current)||void 0===e?void 0:e.get(r),s=null===i||void 0===i||null===(t=i.winRates)||void 0===t?void 0: __get$(t,n) ;void 0!==s&&s<20&&L()}else D()},[a,T]),{showDisconnectTimer:R}};function Di(e){return Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Di(e)}var Li;function Ui(e,t,n,r){Li||(Li="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:Li,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Wi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function zi(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?Wi(Object(n),!0).forEach(function(t){$i(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wi(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Di(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Di(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Di(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}function Bi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Hi(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var Fi="game";const qi=function(e){var t=e.intl,n=e.locale,r=e.pieceLocale,i=e.match,o=e.windowWidth,a=e.windowHeight,s=e.gameWarning,c=e.showRefreshWarning,u=e.moveTimeOutWarning,l=e.moveSuccessWithAttempts,m=e.initialConnected,f=e.isFetchGameSuccess,p=e.historyMode,v=e.flipBoard,g=e.activePreMove,y=e.gameData,h=e.gamePlayers,b=e.gamePlayData,x=e.gameActions,M=e.gameError,S=e.isCreatingQuickGame,k=e.isChatOpen,O=e.createGameData,E=e.makeCreateQuickGame,C=e.makeClearGameCreationError,_=e.makePlayerAction,P=e.makeReplyPlayerAction,I=e.makeFlipBoard,j=e.makeToggleChat,R=e.makeInitialConnect,N=e.makeConnectGame,T=e.makeSendMove,G=e.makeNavigateHistory,D=e.makeJoinGuest,L=e.removeViewer,U=e.guestMPGamesCompleted,$=e.guestMPConsecuitiveGamesCompleted,B=e.makeGuestActivity,H=e.makeGuestActivityReset,F=e.makeClearGameWarning,q=e.makeAppendGameMessage,J=e.makeClearMoveSuccess,Q=e.makeRedeemRating,X=e.redeemReward,Y=e.makeSwitchGame,ee=e.gameViewers,te=e.drawer,ne=e.theme,re=e.isChatInjected,ie=e.expectedPlayerRatingData,oe=e.gameMessages,ae=e.APKLink,se=e.makeMBUserActivity,ce=e.mbPlayerGamesCompletedCount,ue=e.makeSetGamePlayers,le=e.makeCheckQuickGameStatus,de=e.makeCancelQuickGame,me=e.makeToggleFocusMode,fe=e.focusModeEnabled,pe=e.rejectedRequest,ve=e.makeClearRejectedRequest,ge=e.makeChangePieceHandler,ye=e.emotionalEndText,he=e.isSocketConnected,be=e.makeSetInviteLimit,we=e.showLimitModal,Ae=e.cancelPreMove,xe=e.clubGameError,Me=e.earnedBadges,Se=e.makeClearEarnedBadges,ke=e.makeUpdateGameAnalysisMove,Oe=e.makeClearGameAnalysis,Ee=e.isReportingUser,Ce=e.reportUserCheatingSuccess,_e=e.reportUserCheatingError,Pe=e.makeReportUserCheating,Ie=e.makeClearUserCheating,je=e.isReportDisabled,Re=Bi((0,d.useState)(null),2),Ne=Re[0],Te=Re[1],Ge=Bi((0,d.useState)(null),2),De=Ge[0],Le=Ge[1],Ue=Bi((0,d.useState)(null),2),We=Ue[0],ze=Ue[1],$e=Bi((0,d.useState)([]),2),Be=$e[0],He=$e[1],Fe=Bi((0,d.useState)(!1),2),qe=Fe[0],Je=Fe[1],Qe=Bi((0,d.useState)(null),2),Ve=Qe[0],Ze=Qe[1],Ke=Bi((0,d.useState)(K.Ay.getItem(Xe.cZ)||!1),2),Ye=Ke[0],et=Ke[1],tt=Bi((0,d.useState)((0,K.JP)(o>z.LR.phone.maxWidth)),2),nt=tt[0],rt=tt[1],it=Bi((0,d.useState)(!1),2),ot=it[0],at=it[1],st=Bi((0,d.useState)(null),2),ct=st[0],ut=st[1],lt=Bi((0,d.useState)(!1),2),dt=lt[0],mt=lt[1],ft=Bi((0,d.useState)(!1),2),pt=ft[0],vt=ft[1],gt=Bi((0,d.useState)(!1),2),yt=gt[0],ht=gt[1],bt=Bi((0,d.useState)(!1),2),wt=bt[0],At=bt[1],xt=Bi((0,d.useState)(!1),2),Mt=xt[0],St=xt[1],kt=Bi((0,d.useState)(null),2),Ot=kt[0],Et=kt[1],Ct=Bi((0,d.useState)(!1),2),Pt=Ct[0],It=Ct[1],jt=Bi((0,d.useState)(!1),2),Rt=jt[0],Nt=jt[1],Tt=Bi((0,d.useState)(!1),2),Gt=Tt[0],Dt=Tt[1],Lt=Bi((0,d.useState)(K.Ay.getItem(A.o5)||!1),2),Ut=Lt[0],Wt=Lt[1],zt=Bi((0,d.useState)(!1),2),$t=zt[0],Bt=zt[1],Ht=(0,d.useRef)(null),qt=(0,d.useRef)(null),Jt=(0,d.useRef)(null),Qt=(0,d.useRef)(null),Zt=[yn.zs,yn.Lv].includes(ne),Kt=(0,W.W6)(),Yt=function(){return Nt(function(e){return!e})},en=(0,d.useMemo)(function(){return!! __get$(window,"location") .hash},[ __get$(window,"location") .hash]),tn=Bi((0,d.useState)(window.innerWidth<=z.LR.phone.maxWidth&&window.innerHeight>z.LR.smallheight.maxHeight),2),nn=tn[0],rn=tn[1],on=Bi((0,d.useState)(window.innerWidth<=z.LR.phone.maxWidth&&window.innerHeight>z.LR.xsmallheight.maxHeight),2),an=on[0],sn=on[1],cn=(0,d.useMemo)(function(){return o<=z.LR.phone.maxWidth},[o]),un=(0,d.useMemo)(function(){return a<=z.LR.smallheight.maxHeight},[a]),ln=(0,d.useMemo)(function(){return(0,K.HW)()},[f,he]),dn=(0,d.useMemo)(function(){return ee.some(function(e){var t,n;return e.username===(null===(t=h.black)||void 0===t?void 0:t.username)&&e.username!==(null===ln||void 0===ln?void 0:ln.username)||e.username===(null===(n=h.red)||void 0===n?void 0:n.username)&&e.username!==(null===ln||void 0===ln?void 0:ln.username)})},[ee,h,ln]),mn=(0,d.useMemo)(function(){return!(ln&&ln.id)},[ln]),fn=(0,d.useMemo)(function(){var e;return(null===oe||void 0===oe||null===(e=oe.items)||void 0===e?void 0:e.length)>0?(0,dr.v2)(oe.items)-Ot:0},[oe,Ot]),pn=(0,d.useMemo)(function(){return y},[y]),vn=pn.isDaily,In=pn.isChallenge,jn=pn.moveTimer,Rn=pn.gameTimer,Nn=pn.increment,Tn=pn.isQuick,Gn=pn.isPrivate,Ln=pn.isRated,Un=pn.isTimed,Wn=pn.tournamentID,zn=pn.archive,$n=pn.isClubGame,Bn=(0,d.useMemo)(function(){return{id:null===y||void 0===y?void 0:y.gameID,rplayer:null===h||void 0===h?void 0:h.red,bplayer:null===h||void 0===h?void 0:h.black,is_daily:vn,game_timer:Rn,move_timer:jn}},[y,h]),Hn=(0,d.useMemo)(function(){var e,t,n;return null!==h&&void 0!==h&&null!==(e=h.red)&&void 0!==e&&e.identity?null===h||void 0===h||null===(t=h.red)||void 0===t?void 0:t.rating:null===h||void 0===h||null===(n=h.black)||void 0===n?void 0:n.rating},[h]),Fn=(0,d.useMemo)(function(){return b},[b]),qn=Fn.initFen,Jn=Fn.activeMoveInd,Qn=Fn.moves,Vn=Fn.turnNow,Zn=Fn.state,Kn=Fn.endReason,Xn=Fn.timers,Yn=Fn.sendMoveSuccess,er=(0,d.useMemo)(function(){return Zn===Xe._p.END},[Zn]),tr=(0,d.useMemo)(function(){return Qn?Qn.length:0},[Qn]),nr=(0,d.useMemo)(function(){return(0,_n.WJ)(h.red,h.black,ln)},[h,ln]),rr=(0,d.useMemo)(function(){return(0,_n.rR)(h.red,h.black,ln)},[h,ln]),ir=(0,d.useMemo)(function(){return Zn===Xe._p.RUNNING&&null!= __get$(h,Vn) && __get$(h,Vn) .identity===ln.identity},[Zn,Vn,h]),or=(0,d.useMemo)(function(){return Object.values(h).find(function(e){return(null===e||void 0===e?void 0:e.username)===(null===ln||void 0===ln?void 0:ln.username)||(null===e||void 0===e?void 0:e.identity)===(null===ln||void 0===ln?void 0:ln.identity)})},[h,ln]),sr=Gi({moveHistory:Qn,initFen:qn,gameState:Zn,isDaily:vn,isOpponentPresent:dn,myUserInfo:or,makePlayerAction:_,onMoveAnalyzed:ke,onAnalysisClear:Oe}).showDisconnectTimer,mr=(0,d.useMemo)(function(){return nn&&(!nr||er)},[nn,nr,er]),fr=(0,d.useMemo)(function(){var e,t,n=null!==h&&void 0!==h&&null!==(e=h.red)&&void 0!==e&&e.identity&&null!==h&&void 0!==h&&null!==(t=h.black)&&void 0!==t&&t.identity?"".concat(h.red.username," vs. ").concat(h.black.username):"Game Page";return"".concat(n," - Xiangqi.com Chinese Chess")},[h]),pr=(0,d.useMemo)(function(){return(0,_t.H9)(Rn,Nn,jn)},[Rn,Nn,jn]),vr=(0,d.useMemo)(function(){return Object.values(h).find(function(e){return(null===e||void 0===e?void 0:e.username)===ln.username})},[h,ln]),gr=(0,d.useMemo)(function(){var e;return nr&& __get$(h,(null===h||void 0===h||null===(e=h.red)||void 0===e?void 0:e.identity)===ln.identity?Xe.Zl.BLACK:Xe.Zl.RED) },[nr,h,ln]),yr=(0,d.useMemo)(function(){return[Xe.sj.ABANDON,Xe.sj.CHALLENGE_EXPIRED].includes(Kn)},[Kn]),hr=(0,d.useMemo)(function(){return(dn||dt)&&nr&&!yr&&!Wn},[dn,dt,_n.WJ,yr,Wn]),br=(0,d.useMemo)(function(){return!wt&&!Mt&&(null===Me||void 0===Me?void 0:Me.length)>0},[wt,Mt,Me]),wr=function(){return me({isEnabled:!0})},Ar=(0,d.useCallback)(function(){return Qn&&0!==Qn.length?Qn.map(function(e){return{uci:e.uci,notation:e.notation,index:e.index}}):null},[Qn]),xr=(0,d.useCallback)(function(e){var t={state:zi({}, __get$(Kt,"location") .state)},n=!1;tr!==e+1&&(t.hash="#".concat(e+1),n=!0), __call$(Kt,"replace",[t]) ,G({index:e,historyMode:n})},[tr,Zn,Kt]),Mr=function(){rn(window.innerWidth<=z.LR.phone.maxWidth&&window.innerHeight>z.LR.smallheight.maxHeight),sn(window.innerWidth<=z.LR.phone.maxWidth&&window.innerHeight>z.LR.xsmallheight.maxHeight)};(0,d.useEffect)(function(){return window.addEventListener("resize",Mr),function(){window.removeEventListener("resize",Mr)}},[]),(0,d.useEffect)(function(){var e,t;if(b&&b.moves&&0!==(null===(e=b.moves)||void 0===e?void 0:e.length)&&!Jt.current){var n= __get$(window,"location") .hash,r=parseInt(n.split("#")[1],10)-1,i=null===b||void 0===b||null===(t=b.moves)||void 0===t?void 0:t.length;Jt.current=!0,n&&r>-1&&r<i&&G({index:r,historyMode:r<i-1,isAutoMove:!0})}},[null===b||void 0===b?void 0:b.moves]),(0,d.useEffect)(function(){if(k){var e,t=0;(null===oe||void 0===oe||null===(e=oe.items)||void 0===e?void 0:e.length)>0&&(t=(0,dr.v2)(oe.items)),Et(t)}},[oe,k]),(0,d.useEffect)(function(){return R(),C(),Te(i.params.id),Qt.current=null,function(){ht(!1),Y({gameId:i.params.id}),Qt.current=null}},[i.params.id]),(0,d.useEffect)(function(){if(m){var e=0,t=setInterval(function(){e+=1;var n=(0,K.HW)();if(null!==n&&void 0!==n&&n.identity){if((0,_t.OI)(Ne)){var r,o,a=ur.$;a.rplayer=zi(zi(zi({},a.rplayer),n),{},{username:n.identity});var s=(null===pr||void 0===pr?void 0:pr.value)||(null===(r= __get$(Kt,"location") )||void 0===r||null===(r=r.state)||void 0===r?void 0:r.config_str)||(null===(o=K.Ay.getItem(A.XK))||void 0===o?void 0:o.value)||ur.av.value,c=(0,_t.o4)(s);if(a.timers.red={game_secs:c.gameTimer,move_secs:c.moveTimer},!mn){var u=(0,_t.mR)(a.timers.red.game_secs,a.timers.red.move_secs); __get$(ln,u) &&(a.rplayer.rating= __get$(ln,u) )}ue(a),(0,Sn.UZ)(On.kL,"Quick Game","game");var l={config_str:s},d=(0,_t.Bm)(ln);mn&&(l.guest_rating=d),E(l)}else N({game_id:i.params.id});clearInterval(t)}else e>=50&&clearInterval(t)},500);return function(){clearInterval(t)}}},[m,Ne]),(0,d.useEffect)(function(){if(M){var e=Object.keys(y).length>0;(0,lr.A)({type:"error"},t.formatMessage(V.A.error),M.message,function(){M.game_id?( __call$(Kt,"replace",["".concat(A.R7.GAME).concat(M.game_id)]) ,(0,Z.W)("error")):Kt.go(0)},!0,e,M.game_id&&V.A.goto),qt.current=null,C(),e||Kt.push(A.R7.PLAY_ONLINE)}},[M]),(0,d.useEffect)(function(){xe&&((0,Z.A)({type:"error",title:t.formatMessage(V.A.error),msg:xe.message}),Kt.push(A.R7.CLUBS_LOBBY))},[xe]),(0,d.useEffect)(function(){Ce&&((0,Z.A)({type:"success",title:t.formatMessage(V.A.reportSubmitted),msg:t.formatMessage(V.A.reportSubmitMessage)}),Ie(),Bt(!1))},[Ce]),(0,d.useEffect)(function(){null!==_e&&void 0!==_e&&_e.message&&((0,Z.A)({type:"error",title:t.formatMessage(V.A.error),msg:null===_e||void 0===_e?void 0:_e.message}),Ie(),Bt(!1))},[_e]);var Sr=(0,d.useCallback)(function(e){(0,kn.hh)(e,V.A.rematch.defaultMessage,zi(zi({},y),{},{bplayer:h.black,rplayer:h.red,fen:b.currentFen,timers:Xn}),ln)},[y,h,b]),kr=(0,d.useCallback)(function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=zi({game_id:Ne},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});e===Xe.y6.RESIGN&&(n.reason=Xe.sj.RESIGN),e===Xe.y6.REMATCH&&Sr(On.oB),Xe.QX.includes(e)&&(n.action=e),e!==Xe.y6.UNDO_MOVE&&e!==Xe.y6.PRE_MOVE_CANCEL||(qt.current=null),_({event: __get$(Xe.Tb,e) ,payload:n,actionType:e,side:t})},[Ne,y,b,h,Sr]),Or=(0,d.useCallback)(function(){if(nr){var e=Object.values(h).find(function(e){return(null===e||void 0===e?void 0:e.username)===(null===ln||void 0===ln?void 0:ln.username)||(null===e||void 0===e?void 0:e.identity)===(null===ln||void 0===ln?void 0:ln.identity)});e&&(0,Xt.AZ)(null===e||void 0===e?void 0:e.rating,e.rating+e.factor,n)&&setTimeout(function(){return At(!0)},1e3)}},[h,n,nr,ln]);(0,d.useEffect)(function(){f&&re&&(q({message:"".concat(vn?"".concat(t.formatMessage(V.A.moveTimer),": ").concat(jn/1440," ").concat(t.formatMessage(V.A.days)):"".concat(t.formatMessage(V.A.gameTime),": ").concat(Rn,"+").concat(Nn).concat(jn?"/".concat(jn):""),"\n  ").concat(t.formatMessage(V.A.rated),": ").concat("".concat(Ln?t.formatMessage(V.A.yes):t.formatMessage(V.A.no)),"\n  ").concat(t.formatMessage(V.A.challenge),": ").concat("".concat(In?t.formatMessage(V.A.yes):t.formatMessage(V.A.no)),"\n  ").concat(t.formatMessage(V.A.private),": ").concat("".concat(Gn?t.formatMessage(V.A.yes):t.formatMessage(V.A.no)),"\n  "),timestamp:null===b||void 0===b?void 0:b.startedAt}),q({message:t.formatMessage(V.A.noCaptureDraw),timestamp:null===b||void 0===b?void 0:b.startedAt}))},[f,re]),(0,d.useEffect)(function(){if(f&&!(0,_t.OI)(Ne)&&(ln.active||at(!0),mn&&!nr&&Zn===Xe._p.WAITING&&!In)){var e=(0,_t.Bm)(ln);D({game_id:i.params.id,guest_rating:e})}},[f,mn,ln,Ln,In,Zn,nr,Hn]),(0,d.useEffect)(function(){if(ie&&re){var e=JSON.stringify({expectedPlayerRatingData:ie,isChatInjected:re,focusModeEnabled:fe});Qt.current!==e&&(!function(e){if(e){var n=Object.keys(e),r=n[0],i= __get$(e,r) ,o="".concat(r,": ");o+="".concat(t.formatMessage(V.A.expectedRatingWin)," +").concat(i.win," / "),o+="".concat(t.formatMessage(V.A.expectedRatingDraw)," \xb1").concat(Math.abs(i.draw)," / "),o=(o+="".concat(t.formatMessage(V.A.expectedRatingLose)," ").concat(i.loss)).trim();var a=n[1],s= __get$(e,a) ,c="".concat(a,": ");c+="".concat(t.formatMessage(V.A.expectedRatingWin)," +").concat(s.win," / "),c+="".concat(t.formatMessage(V.A.expectedRatingDraw)," \xb1").concat(Math.abs(s.draw)," / "),c=(c+="".concat(t.formatMessage(V.A.expectedRatingLose)," ").concat(s.loss)).trim();var u="".concat(o,"\n").concat(c);q({message:u,timestamp:b.startedAt})}}(ie),Qt.current=e)}},[ie,re,fe]),(0,d.useEffect)(function(){(0,_n.C9)(h.red,h.black,ln)&&I(!0)},[y]);(0,d.useEffect)(function(){if(Jn>-1){var e=function(e){var t=v?(0,_n.Xs)(e.move,function(e){return 11-e}).move:(0,_n.pV)(e.move,function(e){return e}).move;return e.capturedPiece?En.A.capture():En.A.move(),zi(zi({},e),t)}( __get$(Qn,Jn) );Le(e),Zn===Xe._p.RUNNING&&He((0,_n.w3)((0,_n.fp)(e.currentFen)))}else Le(null),He((0,_n.w3)((0,_n.fp)(qn||Xe.Jq))),cr().in_check()?Ze("r"===cr().turn()?"K":"k"):Ze(!1)},[Jn,v,qn]),(0,d.useEffect)(function(){if(Ht.current===Xe._p.BEGIN&&Zn===Xe._p.RUNNING)En.A.startChime();else if(Ht.current===Xe._p.RUNNING&&Zn===Xe._p.END){En.A.endChime1(),mt(!0),Dt(!1),qt.current=null;var e=Object.values(h).find(function(e){return e&&[Xe.$X.GUEST_BOT,Xe.$X.BOT].includes(e.p_type)});if(e){var t=5*Math.random()+2;setTimeout(function(){return L({leave:{username:e.username}})},1e3*t)}if(nr){var n,r=(null===(n=h.red)||void 0===n?void 0:n.result)===Xe.Rs.WON?h.red:h.black;if(Xe.Jc.includes(Kn)&&r.identity===ln.identity){if(Kn!==Xe.sj.TIMER_EXPIRED&&(0,Pn.A)(),mn){B(Ft.Dc.MP_CONSECUITIVE_GAME_WIN);var i=null;0===U?i=Cn.QB.FIRST_GUEST_MP_COMPLETION:2===$&&(i=Cn.QB.THREE_CONSECUITIVE_MP_WIN),i&&setTimeout(function(){return ut(i)},1e3)}(0,w.DH)()&&(0,xn.f)()&&(0,xn.s)()}else H(Ft.Dc.MP_CONSECUITIVE_GAME_WIN);mn&&B(Ft.Dc.MP_GAME),(0,An.rr)()&&(se({activityType:Vt.eD.MP_GAMES_COMPLETED}),ce=== __get$(Vt.eS,Vt.eD.MP_GAMES_COMPLETED) -1&&ae&&It(!0)),Or(),Xe.Jc.includes(Kn)&&(0,hn.A)(bn.A.MULTI_PLAYER_GAME_COMPLETED);var o=Qn?Qn.length:0,a=zi(zi({},y),{},{myPieceCase:rr,fen:b.currentFen,id:b.gameID,endReason:b.endReason,timers:Xn,gamePlayers:h}),s=On.Mr;Tn?s=On.i4:In&&(s=On.ir),(0,kn.iU)(s,a,ln,o)}}Ht.current=Zn},[Zn]),(0,d.useEffect)(function(){if(g){var e=v?(0,_n.Xs)(g.move,function(e){return 11-e}).move:(0,_n.pV)(g.move,function(e){return e}).move;ze(zi(zi({},g),e)),En.A.move()}else ze(null)},[g,v]),(0,d.useEffect)(function(){s&&((0,Z.A)({title:t.formatMessage(V.A.warning),msg:t.formatMessage( __get$(V.A,s) ),type:"warning"}),F())},[s]),(0,d.useEffect)(function(){Ae&&kr(Xe.y6.PRE_MOVE_CANCEL)},[Ae]),(0,d.useEffect)(function(){if(c||u){qt.current=null;var e=t.formatMessage(V.A.networkIssue);(0,lr.A)({title:e,msg:t.formatMessage(V.A.networkIssueMsg),options:{removeOnHover:!1,timeOut:0}},null,null,function(){return Kt.go(0)});var n=On.KE;u&&(n=On.SG),(0,kn.BA)(n,zi(zi({},y),{},{bplayer:h.black,rplayer:h.red,fen:b.currentFen,timers:Xn}),ln,e)}},[c,u]),(0,d.useEffect)(function(){l>0&&(qt.current=null,(0,kn.BA)(On.pU,zi(zi({},y),{},{bplayer:h.black,rplayer:h.red,fen:b.currentFen,timers:Xn,moveSuccessWithAttempts:l}),ln))},[l]),(0,d.useEffect)(function(){null!==X&&void 0!==X&&X.redeemed&&!mn?vt(!0):null!==X&&void 0!==X&&X.isError?(0,Z.A)({title:"",type:"warning",msg:null===X||void 0===X?void 0:X.exception}):vt(!1)},[X]);(0,d.useEffect)(function(){if(Yn){var e,t=Xe.Zl.RED,n=Xe.Zl.BLACK,i=(null===(e=h.red)||void 0===e?void 0:e.identity)===ln.identity?{whoAmI:t,opponent:n}:{whoAmI:n,opponent:t},o=i.whoAmI,a=i.opponent;Qn.length<=2&&function(e,t,n){(0,kn.i4)(On.qR,t,n,{gameData:zi(zi({},y),{},{bplayer:h.black,rplayer:h.red,timers:Xn,fen:b.currentFen}),user:ln,activeMove:e},r)}( __get$(Qn,Qn.length-1) ,o,a),J()}},[Yn]),(0,d.useEffect)(function(){if(O&&nr){var e,t=O.game_id;O.isQuick&&(0,Mn.Of)(On.n9,{CTA_text:"Quick Game Created",location:Fi,game_timer:Rn||ur.av.name}),(Zn===Xe._p.END&&(null===x||void 0===x||null===(e=x.rematchRequest)||void 0===e?void 0:e.state)===Xe.GE.ACCEPT||Zn===Xe._p.END&&S&&O.game_id!==Ne||"create"===i.params.id)&& __call$(Kt,"replace",["/game/".concat(t)]) }},[O,Zn,nr]),(0,d.useEffect)(function(){null!==pe&&void 0!==pe&&pe.draw_request&&((0,Z.A)({title:t.formatMessage(V.A.drawRejected,{bot_name:null===gr||void 0===gr?void 0:gr.username}),type:"error"}),ve())},[pe]);var Er=function(){return"".concat( __get$(window,"location") .protocol,"//").concat( __get$(window,"location") .host,"/game/").concat(Ne)},Cr=(0,d.useCallback)(function(e){var n="".concat(t.formatMessage(V.A.gameShareInChat)," : ").concat(Er());e&&(n=e),Kt.push({pathname:A.R7.LOBBY_CHAT,state:{chatMessage:n}})},[Ne]),_r=(0,d.useCallback)(function(e){var n="".concat(t.formatMessage(V.A.gameShareInChat)," : ").concat(Er());e&&(n=e),Kt.push({pathname:A.R7.INBOX,inboxState:{gameMessage:n}})},[Ne]),Pr=(0,d.useCallback)(function(){Kt.push({pathname:"/analysis/board",state:{fen:(0,_n.fp)(qn),isFlipBoard:v,activeMove: __get$(Qn,Jn) ,activeIndex:Jn+1,movesHistory:Qn.map(function(e){return zi(zi({},e),{},{index:e.index+1})})}})},[De,v,Kt,qn,Jn,Qn]),Ir=(0,d.useCallback)(function(){(0,Sn.UZ)(On.G3,V.A.vsComputer.defaultMessage,Fi),Kt.push(A.R7.COMPUTER_LOBBY)},[]),jr=(0,d.useCallback)(function(){var e=h.red,t=h.black,n={title:"".concat(e.identity," vs. ").concat(t.identity),game_encrypted_id:Ne,initial_fen:(0,_n.fp)(qn),isFlipBoard:t.identity===ln.identity},r=(0,_t.lz)(n,Qn);Kt.push({pathname:"/note/create",state:{gameNoteData:r}})},[ln,Ne,h,qn,Qn]),Rr=(0,d.useCallback)(function(e,t){var n;if(e===Xe.y6.REMATCH){var r=t===Xe.Tn.ACCEPTED;Sr(r?On.c6:On.bV),n={game_id:Ne,accepted:r,isTimed:Un,isRated:Ln,isPrivate:Gn,gameTimer:Rn,moveTimer:jn,increment:Nn}}else n={game_id:Ne,action:e,reply:t};P({event: __get$(Xe.eo,e) ,payload:n,playerAction:e})},[Ne,Sr]),Nr=(0,d.useCallback)(function(e,t,n,r){if(!ir&&Ye)return!0;var i=v?(0,_n.Xs)("".concat(e).concat(t).concat(n).concat(r),function(e){return 11-e}).uci:"".concat(e).concat(t).concat(n).concat(r);return Be.filter(function(e){return e.uci===i}).length>0},[Be,ir,Ye]),Tr=function(){var e=!0,n=null,r=null;return Zn===Xe._p.END&&(r=t.formatMessage(V.A.gameFinishMoveMsg),n=t.formatMessage(V.A.gameFinished)),!n&&p&&(n=t.formatMessage(V.A.historyMoveTitle),r=t.formatMessage(V.A.historyMoveMsg)),n||Ye||ir||(n=t.formatMessage(V.A.invalidMoveTitle),r=t.formatMessage(V.A.notYourTurn)),(n||r)&&(e=!1,(0,Z.A)({title:n,type:"light",msg:r,options:{status:"warning"}})),e},Gr=function(e,n,r,i){if(Tr())if(cr().load(b.currentFen),(0,Xt.pK)(e,n,r,i,b.turnNow,v))(0,Z.A)({title:t.formatMessage(V.A.warning),msg:t.formatMessage(V.A.checkMateInOne),type:"warning",options:{timeOut:3e3}});else{var o=(0,_n.fp)(De?De.currentFen:b.initFen||Xe.Jq);if(Tr()&&Nr(e,n,r,i)){var a={c1:e,r1:n,c2:r,r2:i};if(qt.current&&gn()(qt.current,a))return;qt.current=a;var s=v?(0,_n.Xs)("".concat(e).concat(n).concat(r).concat(i),function(e){return 10-e}).uci:(0,_n.pV)("".concat(e).concat(n).concat(r).concat(i),function(e){return e-1}).uci;if(!ir&&(e!==r||n!==i)){var c=o.split(" ");c[1]="r"===c[1]?"b":"r";var u=c.join(" ");return cr().load(u),void(cr().move(s)&&kr(Xe.y6.PRE_MOVE,{move:(0,_n.pV)(s,function(e){return e+1}).uci,fen:cr().fen()}))}if(cr().load(o),!cr().move(s))return;var l=function(e){var n="",r="",i=!1,o=!1,a=(0,_n.pV)(e,function(e){return e+1}).uci,s=Dn(a,Qn,qe);return s?s.isDisabled?(n=t.formatMessage(V.A.invalidMoveTitle),r=t.formatMessage(V.A.threatRepeatMsg),i=!0):s.isPatternWarning?qe||(n=t.formatMessage(V.A.noThreatRepeatWarningTitle),r=t.formatMessage(V.A.noThreatRepeatWarningMsg),Je(!0)):s.isDrawn&&(o=!0):Je(!1),{isLimited:i,isDrawn:o,title:n,msg:r}}(s),d=l.isLimited,m=l.isDrawn,f=l.title,p=l.msg;if(f&&p&&(0,Z.A)({title:f,type:"light",msg:p,options:{status:"warning"}}),d)return;T({move:{game_id:Ne,move:(0,_n.pV)(s,function(e){return e+1}).uci,thinking_time:(0,wn.f4)(Date.now()-Xn.server_clock)},fen:De?De.currentFen:b.initFen||Xe.Jq}),m&&kr(Xe.y6.DRAW_BY_REPETITION)}else if(cr().in_check()){(0,Z.A)({title:"Invalid Move",msg:"Please respond to the check.",type:"warning",options:{timeOut:3e3}})}}},Dr=(0,d.useMemo)(function(){return{fen:We&&!p&&We.fen||De&&De.currentFen||qn||Xe.Jq,recentMove:De,preMove:We,cancelPreMove:function(){return kr(Xe.y6.PRE_MOVE_CANCEL)},movePiece:Gr,isLegalToMove:Nr,myPieceCase:rr,locale:n,pieceLocale:r,historyMode:p,reanimateCount:0,flipBoard:v,isMyTurnNow:ir,isPreMoveEnabled:Ye,initialCheck:Ve,windowWidth:o,isDrawArrows:nt,isRemoveDrawnArrows:!0,drawer:te,theme:ne,viewOnly:(0,_t.OI)(Ne)}},[qn,De,We,rr,ir,p,v,Nr,n,r,o,nt,Ye,kr,Ve,te,ne,Ne]),Lr=function(){K.Ay.setItem(A.Uu,!nt),rt(function(e){return!e})},Ur=(0,d.useMemo)(function(){return{gamePlayers:h,isMyTurnNow:ir,isGuestUser:mn,isGamePlayer:nr,moveCount:tr,activeMoveInd:Jn,gameID:Ne,isRated:Ln,tournamentID:Wn,gameState:Zn,endReason:Kn,flipBoard:v,handleBoardFlip:function(){return I(!v)},historyClickHandler:xr,onPlayerAction:kr,isPreMoveEnabled:Ye,onToggleEnablePreMove:function(e){Ye!==e&&(K.Ay.setItem(Xe.cZ,!Ye),et(function(e){return!e}))},handleChatClick:function(){return j()},isChatOpen:k,isDrawArrows:nt,allowSharing:!0,handleNote:jr,handleAnalysisClick:Pr,gameUrl:Er,onToggleDrawArrows:Lr,gameActions:x,windowWidth:o,shareInChat:mn?null:Cr,shareInInbox:!mn&&Zn>=Xe._p.RUNNING?_r:null,isDaily:vn,isTimed:Un,unreadCount:fn,enableFocusMode:wr,isSettingsModalOpen:Rt,toggleSettingsModal:Yt}},[mn,nr,ir,tr,Jn,Ne,Ln,Wn,Zn,Kn,v,I,j,xr,Ye,x,jr,Pr,kr,Er,Cr,o,vn,Un,h,fn,Lr]),Wr=(0,d.useCallback)(function(){return nr&&!vn&&Zn===Xe._p.RUNNING&&tr<2?Ui(ar,{lastMoveTime:Xn.server_clock,onTimerFinish:function(){return kr(Xe.y6.ABANDON)},isTwoMinutesWaiting:Boolean(Wn)&&jn>=2}):null},[nr,vn,Zn,tr,Xn,kr]);return{locale:n,match:i,windowWidth:o,isFetchGameSuccess:f,gamePlayers:h,gameActions:x,isCreatingQuickGame:S,makeCheckQuickGameStatus:le,makeCancelQuickGame:de,makeCreateQuickGame:E,redeemReward:X,user:ln,gameID:Ne,tournamentID:Wn,moveCount:tr,endReason:Kn,onPlayerAction:kr,quickGameSetting:pr,handleRedeemUserRating:function(){var e=Object.values(h).find(function(e){return e.username===ln.username}).factor,t={user_id:ln.id,activity_type:1,activity_id:null===y||void 0===y?void 0:y.gameID,rating_factor:Math.abs(e)};Q(t)},isRated:Ln,archive:zn,isGameEndModalOpen:yt,setIsGameEndModalOpen:ht,history:Kt,isUserPlaying:nr,isChallenge:In,hideGameEndModal:en,isDaily:vn,unverifiedModalOpen:ot,setUnverifiedModalOpen:at,showRedeemRatingModal:pt,closeRedeemRatingModal:function(){vt(!1),ht(!0)},currentUserData:vr,guestGameCompletedModalOpen:ct,setGuestGameCompletedModalOpen:ut,boardContext:Dr,footerContext:Ur,gameState:Zn,moveHistory:Qn,onPlayerActionReply:Rr,pageTitle:fr,getAppClickHandler:function(){(0,An.o3)(ae),It(!1)},onCancelMobileAppPrompt:function(){return It(!1)},isMobileAppPromptOpen:Pt,isWoodenTheme:Zt,isSmallMobileResolution:an,isMobileResolution:nn,renderInitialMoveTimeout:Wr,getMoves:Ar,activeMoveInd:Jn,historyClickHandler:xr,onComputerGameClicked:Ir,getGameUrl:Er,isGuestUser:mn,focusModeEnabled:fe,makeToggleFocusMode:me,isMobileDisplay:cn,isSmallMobileDisplay:un,isSettingsModalOpen:Rt,toggleSettingsModal:Yt,showMovesListOnMobile:mr,makeChangePieceHandler:ge,showRematchButton:hr,isRematchClicked:Gt,setIsRematchClicked:Dt,emotionalEndText:ye,isSocketConnected:he,isQuickGame:Tn,makeSetInviteLimit:be,showLimitModal:we,showBadgesCount:Ut,onToggleShowBadges:function(){K.Ay.setItem(A.o5,!Ut),Wt(!Ut)},isClubGame:$n,shareInChat:mn?null:Cr,shareInInbox:!mn&&Zn>=Xe._p.RUNNING?_r:null,onCloseLevelUpModal:function(){At(!1),ht(!0)},isLevelUpModalOpen:wt,onShareLevelUp:function(){At(!1),St(!0)},onCloseShareModal:function(){St(!1),ht(!0)},isShareModalOpen:Mt,myUserInfo:or,earnedBadges:Me,makeClearEarnedBadges:Se,showEarnedBadgeModal:br,gameEndInfo:Bn,showDisconnectTimer:sr,onCloseReportModal:function(){Bt(!1),ht(!0)},handleOpenReportModal:function(){ht(!1),Bt(!0)},isReportModalOpened:$t,isReportingUser:Ee,makeReportUserCheating:Pe,isReportDisabled:je}};var Ji=n(66140),Qi=n(47129),Vi=n(32641),Zi=n(9258),Ki=te.Ay.div.withConfig({displayName:"Wrapper__HistoryControlsWrapper",componentId:"sc-18nf4lm-0"})(["display:flex;background-color:",";position:relative;bottom:0px;left:0;width:100%;padding:12px 24px;margin-top:auto;img{filter:",";}ul{color:",";width:100%;}.expand-moves{flex-basis:10%;padding:0;cursor:pointer;img{float:right;}}"],function(e){return e.theme.background_41},function(e){return e.theme.brownToGrayFilter_1},function(e){return e.theme.text_11});const Xi=te.Ay.div.withConfig({displayName:"Wrapper__MoveHistoryWrapper",componentId:"sc-18nf4lm-1"})(["display:flex;height:100%;justify-content:space-between;flex-direction:column;.moves-navigator{height:calc(100% - ",");}"],"49px");function Yi(e){return Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yi(e)}var eo;function to(e,t,n,r){eo||(eo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:eo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function no(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ro(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?no(Object(n),!0).forEach(function(t){io(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):no(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function io(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Yi(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Yi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yi(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}const oo=function(e){var t=e.currentUser,n=e.movesHistory,r=e.activeMove,i=e.isComputerGame,o=e.navigateHistory,a=(0,d.useMemo)(function(){return n?n.length:0},[n]),s=(0,W.W6)(),c=(0,d.useCallback)(function(e,t){var n={state:ro({}, __get$(s,"location") .state)},r=!1;e!==t&&(n.hash="#".concat(t),r=!0), __call$(s,"replace",[n]) ,o({historyMode:r,index:t-1})},[o]),u=(0,d.useCallback)(function(e){var t=e.index,n={state:ro({}, __get$(s,"location") .state)},r=!1;a!==t+1&&(n.hash="#".concat(t+1),r=!0), __call$(s,"replace",[n]) ,o({historyMode:r,index:t})},[a,o]);return to(Xi,{className:"content"},void 0,to(Vi.A,{className:"moves-navigator",gameHistory:n,activeMove:r,navigateHistoryLocal:c,isGamePage:!0}),to(Ki,{},void 0,to(Zi.A,{game:{},activeMove:r,gameHistory:n,navigateHistory:u,user:t,isComputerGame:i})))},ao=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"sc-7k3s5f-0"})(["padding:15px;display:flex;overflow-y:scroll;text-align:start;height:100%;width:100%;.viewers-list{margin:0;height:100%;width:100%;.viewer{width:100%;display:flex;margin:0 0 20px;color:",";.avatar{cursor:pointer;}.details{margin-left:10px;display:flex;flex-direction:column;}&:last-child{margin:0;}}}"],function(e){return e.theme.text_11});var so,co=te.Ay.span.withConfig({displayName:"Wrapper__Username",componentId:"sc-7k3s5f-1"})(["color:",";cursor:pointer;"],function(e){return e.theme.userName});function uo(e,t,n,r){so||(so="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:so,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var lo=function(e){var t=e.viewers,n=(0,W.W6)();return t?uo(ao,{},void 0,uo("div",{className:"viewers-list"},void 0,t&&t.map(function(e){return uo("div",{className:"viewer"},e.username,uo(Ge.A,{user:e}),uo("div",{className:"details"},void 0,uo(co,{onClick:function(){return n.push("/@".concat(e.username))}},void 0,"@",e.username,uo(De.A,{country:e.country}))))}))):null};const mo=(0,d.memo)(lo);var fo=n(60016);function po(e){return po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},po(e)}var vo,go=["mySide"];function yo(e,t,n,r){vo||(vo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:vo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ho(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bo(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?ho(Object(n),!0).forEach(function(t){wo(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ho(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=po(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=po(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==po(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}function Ao(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return xo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var Mo=!1;const So=function(){var e,t,n,r=(0,W.W6)(),i=(0,d.useRef)(null),o=(0,d.useRef)(null),a=(0,f.useSelector)(pi()),s=(0,f.useSelector)(bi()),c=(0,f.useSelector)(wi()),u=(0,f.useSelector)(vi()),l=(0,f.useSelector)(gi()),m=(0,f.useSelector)(yi()),p=(0,f.useSelector)(hi()),v=(0,f.useSelector)(Ai()),g=(0,f.useSelector)((0,zt.xw)()),y=(0,f.useSelector)((0,U.f1)()),h=(0,f.useSelector)((0,U.gp)()),b=(0,f.useSelector)((0,Bt.vx)()),w=(0,f.useSelector)((0,U.fs)()),A=(0,f.useSelector)(Re()),x=(0,f.useDispatch)(),M=function(e){return x(jr(e))},S=Ao((0,d.useState)(0),2),k=S[0],O=S[1],E=Ao((0,d.useState)(null),2),C=E[0],_=E[1],P=Ao((0,d.useState)(window.innerWidth<=z.LR.phone.maxWidth&&window.innerHeight<=z.LR.xsmallheight.maxHeight),2),I=P[0],j=P[1],R=Ao((0,d.useState)(0),2),N=R[0],T=R[1],G=(0,d.useMemo)(function(){return y<=z.LR.phone.maxWidth},[y,z.LR]),D=(0,d.useMemo)(function(){var e;return 0!==k&&(null===b||void 0===b||null===(e=b.items)||void 0===e?void 0:e.length)>0?(0,dr.v2)(b.items)-N:0},[k,b,N]),L=(0,d.useMemo)(function(){return(0,K.HW)()},[]),B=(0,d.useMemo)(function(){return!L||!L.id},[L]),H=(0,d.useMemo)(function(){return m},[m]),F=H.activeMoveInd,q=H.moves,Q=H.turnNow,V=H.state,Z=H.timers,X=H.endReason,Y=(0,d.useMemo)(function(){return Boolean((0,fo.ny)(null===l||void 0===l?void 0:l.black))||Boolean((0,fo.ny)(null===l||void 0===l?void 0:l.red))},[l]),ee=(0,d.useMemo)(function(){return(0,_n.Kz)(C&&C.currentFen||Xe.Jq)},[C]),te=(0,d.useMemo)(function(){return q?q.length:0},[q]),ne=function(){j(window.innerWidth<=z.LR.phone.maxWidth&&window.innerHeight<=z.LR.xsmallheight.maxHeight)};(0,d.useEffect)(function(){return window.addEventListener("resize",ne),function(){window.removeEventListener("resize",ne)}},[]),(0,d.useEffect)(function(){if(F>-1){var e= __get$(q,F) ;_(e)}else _(null)},[F]),(0,d.useEffect)(function(){if(0===k){var e,t=0;(null===b||void 0===b||null===(e=b.items)||void 0===e?void 0:e.length)>0&&(t=(0,dr.v2)(b.items)),T(t)}},[b,k]),(0,d.useEffect)(function(){c&&O(0)},[c]),(0,d.useEffect)(function(){o.current||V!==Xe._p.END||O(1),V&&(o.current=V)},[V]);var re=(0,d.useMemo)(function(){return u},[u]),ie=re.gameID,oe=re.isDaily,ae=re.isTimed,se=re.isClubGame,ce=Ao(s?[Ji.AN.RED,Ji.AN.BLACK]:[Ji.AN.BLACK,Ji.AN.RED],2),ue=ce[0],le=ce[1],de=(0,d.useMemo)(function(){var e=(0,_n.Jk)(C&&C.currentFen||Xe.Jq),t=e.red,n=e.black;return{red:Math.max(t-n,0),black:Math.max(n-t,0)}},[C]),me=(0,d.useMemo)(function(){return Object.values(l).map(function(e){return null===e||void 0===e?void 0:e.username})},[l]),fe=(0,d.useMemo)(function(){return(0,_n.WJ)(l.red,l.black,L)},[l,L]),pe=(0,d.useMemo)(function(){return!B&&!G&&fe&&V===Xe._p.WAITING&&me.some(function(e){return!e})},[l,me,V,fe,B,G]),ve=(0,d.useMemo)(function(){var e=new Set;return v.filter(function(t){return!t.is_guest&&!me.includes(t.username)&&!e.has(t.username)&&e.add(t.username)})},[v,me]),ge=(0,d.useCallback)(function(e){return!!e&&v.some(function(t){return t.username===e.username})},[v]),ye=(0,d.useMemo)(function(){return Object.values(l).every(function(e){return!ge(e)})},[l,ge]),he=(0,d.useCallback)(function(e){var t=e.mySide===ue?le:ue,n= __get$(l,e.mySide) ,r= __get$(l,t) ;if(m.moves.length>=Xe.Bw&&(!ge(r)||e.side===n.side||r.p_type===Xe.$X.BOT)){e.mySide;var i=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue; __set$(n,r,__get$(e,r)) }return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n= __get$(o,r) ,-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&( __set$(i,n,__get$(e,n)) )}return i}(e,go),o=bo({game_id:ie},i);!function(e){x(Cr(e))}({event: __get$(Xe.Tb,Xe.y6.TIMER_EXPIRED) ,payload:o})}},[ie,m,ge,l]),be=(0,d.useCallback)(function(e){var t=e.index,n={state:bo({}, __get$(r,"location") .state)},i=!1;te!==t+1&&(n.hash="#".concat(t+1),i=!0), __call$(r,"replace",[n]) ,M({index:t,historyMode:i})},[te,V,r]),we=(0,d.useMemo)(function(){return w||G?[]:[{text:Ne.chat,img:yo(J.A,{src:$.Ay.GameChatIcon,alt:"chat icon"}),afterText:D>0&&yo(Ze.A,{className:"unread-count"},void 0,D>99?"".concat(99,"+"):D),component:e||(e=yo(Qi.A,{isChatOpen:c,gameId:ie,playersDisconnected:ye,gameState:V,isGamePlayer:fe,isComputerGame:Mo,gameHistory:q,navigateHistory:be,windowWidth:y,windowHeight:h,className:"game-sidebar-chat",gameEndReason:X,isBotOpponent:Y}))},{text:Ne.moves,img:yo(J.A,{src:$.Ay.gameLeaderBoardRed,alt:"moves icon"}),component:t||(t=yo(oo,{currentUser:L,movesHistory:q,activeMove:C,isComputerGame:Mo,navigateHistory:M}))},{text:Ne.viewers,img:yo(J.A,{src:$.Ay.ViewersIcon,alt:"viewers icon"}),component:n||(n=yo(mo,{viewers:ve}))}]},[L,C,g,M,ie,ye,V,Mo,q,ve,pe,D,w,fe,X]);return{sidebarRef:i,gamePlayers:l,turnNow:Q,gameState:V,pieceLocale:g,capturedPiecesMap:ee,pieceValueDiffMap:de,gameData:u,activeMove:C,historyMode:p,isComputerGame:Mo,isDaily:oe,isTimed:ae,gameTimers:Z,onTimerExpire:he,currentUser:L,isSmallMobileResolution:I,showUsersList:pe,gameID:ie,makeToggleChat:function(){return x(gr())},isChatOpen:c,SIDEBAR_TABS:we,selectedTabIndex:k,setSelectedTabIndex:O,makeCheckQuickGameStatus:function(){return x(Mr())},makeCancelQuickGame:function(){return x(xr())},fetchGameSuccess:a,top:ue,bottom:le,getOnlineStatus:ge,user:L,gameHistory:q,navigateMoveHistory:be,playersDisconnected:ye,windowWidth:y,windowHeight:h,viewers:ve,gameViewers:v,gameMessages:b,invites:A,isClubGame:se}};const ko=function(e){return{gameData:qi(e),sidebarData:So()}};var Oo,Eo,Co,_o=n(46942),Po=n.n(_o),Io=n(50356),jo=n(43088),Ro=n(60448),No=n(98950);function To(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Go,Do,Lo=(0,te.i7)(["from{width:0;}to{width:100%;}"]),Uo=te.Ay.div.withConfig({displayName:"Wrapper__BtnWrapper",componentId:"sc-184wkoc-0"})(["display:flex;align-items:center;flex-wrap:wrap;justify-content:center;button{width:auto;padding:12px 16px;margin:4px;background:",";color:",";height:60px;line-height:1;box-shadow:",";min-width:100px;border-radius:8px;&:hover,&:disabled{color:",";}img{margin-right:8px;margin-top:-2px;&.red-filter{filter:brightness(0) saturate(100%) invert(25%) sepia(22%) saturate(7464%) hue-rotate(346deg) brightness(89%) contrast(83%);}&.to-white{filter:",";}}.md-icon{height:24px;}.ladda-label{color:",";line-height:1;font-size:20px;text-transform:capitalize;font-weight:bold;",";}",";"," &.red{background:",";border:2px solid ",";.ladda-label{color:",";}}&.red-tertiary{border:2px solid ",";background:",";.ladda-label{color:",";}}&.play-online{img{width:20px;}}}"],z.ut.$yellow,z.ut.$red,z.ut.$shadow_16,z.ut.$yellow,function(e){return e.theme.toWhiteFilter},z.ut.$red,z.$_.imac(Oo||(Oo=To(["\n        font-size: 16px;\n    "]))),z.$_.imac(Eo||(Eo=To(["\n      height: 48px;\n    "]))),z.$_.phone(Co||(Co=To(["\n      padding: 10px 12px;\n      height: 40px;\n    "]))),z.ut.$fireBrick,z.ut.$fireBrick,z.ut.$floralWhite,function(e){return e.theme.button_1},function(e){return e.theme.background_2},function(e){return e.theme.heading_2}),Wo=te.Ay.div.withConfig({displayName:"Wrapper__ModalWrapper",componentId:"sc-184wkoc-1"})(["padding:32px 24px;text-align:center;background:",";display:flex;flex-direction:column;align-items:center;border-radius:16px;.report-btn{border:0;font-size:12px;line-height:1.5;font-weight:600;margin:5px 0;&[disabled]{background:transparent;text-decoration-line:none;}img{margin-right:4px;}&:hover{text-decoration-line:underline;text-decoration-thickness:2px;background:transparent;}}.tournament-back{filter:brightness(0) invert(1);}.game-end-icon{width:","px;height:","px;margin-bottom:8px;}.game-end-card-ad{display:block;min-height:50px;}h1{font-size:24px;line-height:1.5;text-align:center;color:",";font-weight:700;text-transform:capitalize;margin-bottom:4px;}.emotional-end-text{color:",";font-size:14px;font-weight:400;font-style:italic;margin-bottom:4px;}.game-end-widget{display:flex;justify-content:space-between;width:100%;align-items:center;padding:10px 20px;.vs-text{color:",";font-size:16px;font-weight:600;}.widget{.end-text{font-size:16px;font-weight:700;text-transform:capitalize;margin-bottom:4px;&.wins{color:",";}&.lose{color:",";}}.avatar{width:80px;height:80px;margin-bottom:4px;img{object-fit:contain;}}.username{font-size:16px;font-weight:700;color:",";margin:0;margin-bottom:4px;}.profile-link{color:inherit;text-decoration:none;display:contents;}.level,.rating{font-size:16px;color:",";font-weight:500;.plus{color:",";}.minus{color:",";}}.rating{font-weight:400;display:inline-block;overflow:hidden;white-space:nowrap;animation:"," 1s steps(12,end) forwards;}}}.progress-bar-container{width:100%;display:flex;flex-direction:column;gap:8px;margin:",";.title-section{font-size:14px;font-weight:600;color:",";display:flex;justify-content:space-between;align-items:center;.plus{color:",";}.minus{color:",";}}}.game-end-ad-container{position:relative;width:auto;height:50px;top:0;display:block;margin-top:5px;transform:translateY(0);}"],function(e){return e.theme.background_48},function(e){return e.isGameAbandoned?100:56},function(e){return e.isGameAbandoned?100:56},function(e){return e.theme.text_22},function(e){return e.theme.text_22},function(e){return e.theme.text_22},z.ut.$green_8,z.ut.$fireBrick_14,function(e){return e.theme.text_7},function(e){return e.theme.text_7},z.ut.$green_8,z.ut.$fireBrick_14,Lo,function(e){return e.isGameAbandoned?"32px 0 48px":"16px 0 32px"},function(e){return e.theme.text_22},z.ut.$green_8,z.ut.$fireBrick_14);function zo(e){return zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zo(e)}function $o(){return $o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n= __get$(arguments,t) ;for(var r in n)({}).hasOwnProperty.call(n,r)&&( __set$(e,r,__get$(n,r)) )}return e},$o.apply(null,arguments)}function Bo(e,t,n,r){Do||(Do="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:Do,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ho(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Fo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}function qo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Jo(e){for(var t=1;t<arguments.length;t++){var n=null!= __get$(arguments,t) ? __get$(arguments,t) :{};t%2?qo(Object(n),!0).forEach(function(t){Qo(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qo(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Qo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=zo(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=zo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==zo(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}const Vo=function(e){var t,n=e.user,r=e.gameID,i=e.tournamentID,o=e.moveCount,a=e.endReason,s=e.gamePlayers,c=e.isGamePlayer,u=e.onPlayerAction,l=e.rematchRequest,m=e.makeCreateQuickGame,f=e.makeCancelQuickGame,v=e.isCreatingQuickGame,g=e.quickGameSetting,y=e.checkQuickGameStatus,h=e.handleRedeemUserRating,b=e.isRated,w=e.isGameArchived,x=e.isGameEndModalOpen,M=e.setIsGameEndModalOpen,S=e.showRematchButton,k=e.isRematchClicked,O=e.setIsRematchClicked,E=e.emotionalEndText,C=e.isFocusMode,_=e.isQuickGame,P=e.locale,I=e.handleOpenReportModal,j=e.isReportDisabled,R=(0,W.W6)(),N=Ho((0,d.useState)(!1),2),T=N[0],G=N[1],D=Ho((0,d.useState)(!0),2),L=D[0],U=D[1],z=Ho((0,d.useState)(null),2),q=z[0],Q=z[1],Z=(0,d.useMemo)(function(){return Object.values(s).find(function(e){return(null===e||void 0===e?void 0:e.username)===(null===n||void 0===n?void 0:n.username)||(null===e||void 0===e?void 0:e.identity)===(null===n||void 0===n?void 0:n.identity)})},[s,n]),X=(0,d.useMemo)(function(){return(0,fo.ny)(s.black)||(0,fo.ny)(s.red)},[s]),te=(0,d.useMemo)(function(){return Z&&(0,Xt.gH)(Z.rating+Z.factor,P)},[Z,P]),ne=(0,d.useMemo)(function(){return Z&&Math.min(Z.factor,Z.rating+Z.factor-te.minRating)},[Z,te]),re=(0,d.useMemo)(function(){return  __get$(No.Ay,a) },[a]),ie=(0,d.useMemo)(function(){return[Xe.sj.ABANDON,Xe.sj.CHALLENGE_EXPIRED].includes(a)},[a]),oe=(0,d.useMemo)(function(){return!(n&&n.id)},[n]),ae=(0,d.useMemo)(function(){if(b&&!i&&!oe&&!w&&(0,wn.kd)()){var e,t=null!==(e=K.Ay.getItem(Xe.sS))&&void 0!==e?e:(K.Ay.setItem(Xe.sS,0),0),r=Object.values(s).find(function(e){return e.username===n.username});if((null===r||void 0===r?void 0:r.factor)<0){if(0===t)return K.Ay.setItem(Xe.sS,t?t+1:1),!0;if((0,Ro.oj)(r.rating))return K.Ay.setItem(Xe.sS,t+1),!0}}},[b,s,b,i,oe,w,n,Ro.oj,wn.kd]),se=(0,d.useMemo)(function(){return ae||S},[ae,S]),ce=(0,d.useMemo)(function(){var e=K.Ay.getItem(A.eO)||yn.Lv;return e!==yn.Lv&&e!==yn.su||!se?$.Ay.reviewIcon:$.Ay.reviewIconMain},[se]);(0,d.useEffect)(function(){x||([Xe.sj.CHECKMATE,Xe.sj.STALEMATE].includes(a)?setTimeout(function(){return M(!0)},1250):M(!0))},[a]),(0,d.useEffect)(function(){l&&l.requester&&O(!0),l&&l.rejector&&O(!1)},[l]),(0,d.useEffect)(function(){T||q||U(!0)},[T,q]);var ue,le=function(){O(!0),u(Xe.y6.REMATCH)},de=function(){(0,Sn.UZ)(On.kL,"Quick Game","game");var e={config_str:g.value};oe&&(e.guest_rating=(0,_t.Bm)((0,K.HW)())),m(e)},me=function(){U(!1),G(!0)},fe=function(){oe?R.push("/account/signup?redirect=/review/lobby/".concat(r)):R.push("/review/lobby/".concat(r))},pe=function(e){if(!e)return null;var t=e.p_type===Xe.$X.BOT?function(e){var t=(0,fo.ny)(e);return t?Jo(Jo({},e),{},{profile_image:t.profile_image}):e}(e):e,n=[Xe.$X.AUTHENTICATED,Xe.$X.BOT].includes(t.p_type)?"/@".concat(t.username):null,r=Po()({wins:t.result===Xe.Rs.WON,lose:t.result===Xe.Rs.LOST}),i=t.result===Xe.Rs.WON?V.A.wins:V.A.losses,o=(0,Xt.gH)(t.rating+t.factor,P).fullTranslatedLevel;return Bo("div",{className:"widget"},void 0,r&&Bo(Ze.A,{className:"end-text ".concat(r)},void 0,d.createElement(p.sA,i)),Bo(Ge.A,{user:t,to:n}),Bo("h4",{className:"username"},void 0,n?Bo(W.N_,{to:n,className:"profile-link"},void 0,t.username):Bo("span",{className:"profile-link"},void 0,t.username)),!Z&&!X&&Bo(Ze.A,{},void 0,Bo("span",{className:"rating"},void 0,t.rating,Bo("span",{className:t.factor>=0?"plus":"minus"},void 0," ".concat(t.factor>=0?"+":"").concat(t.factor)))),!X&&Bo(Ze.A,{className:"level"},void 0,o))};return Bo(F.A,{isOpen:x,parentSelector:function(){return document.querySelector("#game-area")||document.body},onClose:function(){return M(!1)},dontAllowClose:v,closeButtonSize:14,styles:{overlay:No.BU,content:No.Qh}},"modal-".concat(C?"focus":"normal"),(0,wn.kd)()&&Bo(jo.A,{adShown:T,setShowRewardedAd:Q,showRewardedAd:q,redeemRatingHandle:function(){G(!1),h()},closeModal:function(){return M(!1)},setRewardAdButtonAvailable:U}),v?Bo(St.A,{checkSearchStatus:y,cancelClickHandler:function(){v&&((0,Sn.UZ)(On.wV,"Cancel","game"),f())},selectedTime:g,isFullWidth:!0}):Bo(Wo,{isGameAbandoned:ie},void 0,re&&Bo(J.A,{src:re,alt:"End-icon",width:56,height:56,className:"game-end-icon ".concat(ie?"to-white":"")}),a&&Bo(B.A,{},void 0,d.createElement(p.sA, __get$(V.A,__get$(Xe.JH,a)) ),"!"),E&&Bo(Ze.A,{className:"emotional-end-text"},void 0,E),!ie&&Bo("div",{className:"game-end-widget"},void 0,pe(s.red),Bo(Ze.A,{className:"vs-text"},void 0,d.createElement(p.sA,V.A.vs)),pe(s.black)),Z&&!X&&te&&Bo("div",{className:"progress-bar-container"},void 0,Bo("p",{className:"title-section"},void 0,d.createElement(p.sA,V.A.rating),Bo("span",{className:Z.factor>=0?"plus":"minus"},void 0,Z.factor>=0?"+".concat(Z.factor):Z.factor)),Bo(Io.A,{start:te.minRating,end:te.maxRating,current:Z.rating+Z.factor,delta:ne})),(ue=oe?V.A.signUpToReview:V.A.review,Bo(Uo,{},void 0,!X&&c&&g&&_&&!i&&Bo(H.A,{btnType:"red",className:S||ie?"red":"red-tertiary",onClick:de},void 0,Bo(J.A,{src:$.Ay.plusIcon,alt:"plus-icon",className:S||ie?"":"red-filter"}),d.createElement(p.sA,$o({},V.A.newXMin,{values:{gameTimer:g.name}}))),S&&Bo(H.A,{btnType:"red",className:"".concat(ae?"red-tertiary":"red"),onClick:le,disabled:k},void 0,Bo(J.A,{src:$.Ay.rematchIconMain,alt:"rematch-icon",className:"".concat(ae?"red-filter":""," to-white ")}),d.createElement(p.sA,V.A.rematch)),ae&&Bo(H.A,{btnType:"red",className:"red",loading:!L,disabled:!L,onClick:me},void 0,Bo(J.A,{src:$.Ay.RedeemPoints,alt:"redeem points",className:"to-white"}),d.createElement(p.sA,V.A.redeemPoints)),o>2&&Bo(H.A,{btnType:"red",className:"".concat(se?"red-tertiary":"red"),onClick:fe},void 0,t||(t=Bo(J.A,{src:ce,alt:"review-icon"})),d.createElement(p.sA,ue)),!i&&ie&&Bo(H.A,{btnType:"red",className:"red-tertiary play-online",onClick:function(){return R.push("/play")}},void 0,Bo(J.A,{src:$.Ay.PlayOnlineIcon,alt:"play online",className:"to-white"}),d.createElement(p.sA,V.A.playOnline)),i&&Bo(H.A,{className:"red",btnType:"primary",onClick:function(){return R.push("/tournament/".concat(i))}},void 0,Bo(J.A,{src:$.Ay.arrowBack,className:"tournament-back",alt:"arrow-back"}),d.createElement(p.sA,V.A.tournamentBack)))),c&&!X&&!w&&!ie&&Bo(H.A,{type:"button",className:"btn-secondary report-btn",onClick:I,disabled:j},void 0,Go||(Go=Bo(J.A,{src:$.pB,alt:"report",height:14,width:14})),d.createElement(p.sA,V.A.report)),Bo(Y.A,{wrapperClassName:"game-end-ad-container",className:"game-end-card-ad",ad:ee.DV.HORIZONTAL.DESKTOP.MODAL})))};var Zo;const Ko=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"sc-1vf6pzg-0"})(["position:absolute;top:0;background:",";padding:0px 14px;width:100%;color:",";box-sizing:border-box;z-index:9;text-align:center;border-radius:4px;",";"],function(e){return e.isConnected?"".concat(z.ut.$green_8):"".concat(z.ut.$yellowHover,"E0")},function(e){return e.isConnected?z.ut.$pureWhite:z.ut.$redHover},z.$_.phone(Zo||(Zo=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    font-size: 12px;\n  "]))));function Xo(){return Xo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n= __get$(arguments,t) ;for(var r in n)({}).hasOwnProperty.call(n,r)&&( __set$(e,r,__get$(n,r)) )}return e},Xo.apply(null,arguments)}var Yo;function ea(e,t,n,r){Yo||(Yo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:Yo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ta(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return na(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?na(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function na(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var ra=function(e){var t=e.isDisconnected,n=ta((0,d.useState)(null),2),r=n[0],i=n[1],o=ta((0,d.useState)(!1),2),a=o[0],s=o[1],c=ta((0,d.useState)(!1),2),u=c[0],l=c[1],m=(0,d.useRef)(null),f=(0,d.useRef)(null);return(0,d.useEffect)(function(){return!0===t?(l(!0),i(20),m.current=setTimeout(function(){l(!1),i(null)},2e4)):!1===t&&u&&(m.current&&(clearTimeout(m.current),m.current=null),i(null),s(!0),f.current=setTimeout(function(){s(!1),l(!1)},2e3)),function(){m.current&&clearTimeout(m.current),f.current&&clearTimeout(f.current)}},[t,u]),u?a?ea(Ko,{isConnected:!0},void 0,d.createElement(p.sA,V.A.opponentBack)):r?ea(Ko,{},void 0,d.createElement(p.sA,Xo({},V.A.playerDisconnectMsg,{values:{timer:ea(q.A,{timeout:r})}}))):null:null};const ia=(0,d.memo)(ra);var oa=n(5470),aa=n(87276);const sa=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"hnb2ov-0"})(["padding:32px 24px;text-align:center;.modal-title{font-size:24px;line-height:1;font-weight:700;color:",";text-transform:capitalize;}.report-filter-select{margin:20px 0;}.report-textarea{width:100%;resize:none;font-size:16px;line-height:1.5;background:",";border-radius:16px;padding:16px;border:0;height:240px;}.submit-btn{width:100%;box-shadow:none;margin-top:16px;border-radius:8px;}"],function(e){return e.theme.text_22},function(e){return e.theme.bg_10});var ca;function ua(e,t,n,r){ca||(ca="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:ca,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function la(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return da(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?da(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function da(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}const ma=(0,d.memo)((0,p.j4)(function(e){var t=e.isOpen,n=e.onClose,r=e.intl,i=e.isReportingUser,o=e.makeReportUserCheating,a=e.user,s=e.gameID,c=e.gamePlayers,u=la((0,d.useState)(null),2),l=u[0],m=u[1],f=la((0,d.useState)(""),2),v=f[0],g=f[1],y=(0,d.useRef)(null),h=(0,d.useMemo)(function(){return(0,Xe.XX)(r)},[r]),b=(0,d.useMemo)(function(){return!l||v.length<Xe.AP||i},[l,v,i]);return ua(F.A,{isOpen:t,onRequestClose:n,onClose:n},void 0,ua(sa,{},void 0,ua(B.A,{className:"modal-title"},void 0,d.createElement(p.sA,V.A.report)),ua(oa.A,{dropdownOptions:h,onChange:function(e,t){m(t)},className:"report-filter-select",placeholder:r.formatMessage(V.A.selectOption),options:{selectValue:h.find(function(e){return e.type===(null===l||void 0===l?void 0:l.type)})}},"report-filter-select"),d.createElement(aa.A,{name:"report-description",value:v,onChange:function(e){return g(e.target.value)},rows:"4",placeholder:V.A.evidence,ref:y,className:"report-textarea"}),ua(H.A,{type:"button",className:"btn-primary submit-btn",onClick:function(){var e,t,n,r,i,u,d=a.username||a.identity,f=(null===c||void 0===c||null===(e=c.red)||void 0===e?void 0:e.username)===d?null===c||void 0===c||null===(t=c.red)||void 0===t?void 0:t.username:null===c||void 0===c||null===(n=c.black)||void 0===n?void 0:n.username,p=(null===c||void 0===c||null===(r=c.red)||void 0===r?void 0:r.username)===d?null===c||void 0===c||null===(i=c.black)||void 0===i?void 0:i.username:null===c||void 0===c||null===(u=c.red)||void 0===u?void 0:u.username,y={game_id:s,reporter_username:f,opponent_username:p,report_type:null===l||void 0===l?void 0:l.type,description:v};o(y),m(null),g("")},disabled:b,loading:i},void 0,d.createElement(p.sA,V.A.submit))))}));var fa,pa,va;function ga(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const ya=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"sc-1la5lhd-0"})(["display:flex;flex-direction:column;align-items:center;position:relative;width:100%;height:100%;position:relative;.game-header{padding:0;}.top-section{position:absolute;top:0;width:100%;.game-moves-list{background-color:",";}}.game-area-wrapper{height:calc(100% - 50px);flex-direction:column;display:flex;justify-content:center;align-items:center;width:100%;overflow:hidden;",";.board-container{width:100%;height:100%;display:flex;justify-content:center;align-items:center;position:relative;","}}"],function(e){return e.theme.hover_3},z.$_.phone(fa||(fa=ga(["\n        margin-top: ","px;\n        height: "," ;\n  \n        ",";\n      "])),function(e){return e.isMovesListVisible?76:46},function(e){return"calc(100% - ".concat(e.isMovesListVisible?76:46,"px - ").concat(46,"px)")},z.$_.smallheight(pa||(pa=ga(["\n          margin-top: ","px;\n          height: calc(100% - ","px - ","px);\n        "])),34,34,34)),z.$_.phone(va||(va=ga(["\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n\n          .board-wrapper-main {\n            flex-direction: column;\n            gap: ","px;\n            height: ",";\n\n            .board-wrapper {\n              position: relative;\n            }\n          }\n        "])),16,function(e){return e.boardHeight>0?"".concat(e.boardHeight,"px"):"100%"}));var ha=n(9401),ba=n(51096),wa=n(50477),Aa=n(65060),xa=n(39725),Ma=n(46228);function Sa(e){return Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sa(e)}function ka(e){if(null!=e){var t= __get$(e,("function"==typeof Symbol&&Symbol.iterator)||"@@iterator") ,n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&& __get$(e,n++) ,done:!e}}}}throw new TypeError(Sa(e)+" is not iterable")}function Oa(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ea(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],d=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,s=0,c=e,m.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!d&&u&&!i&&t<l.length;t++){var i,o= __get$(l,t) ,f=m.p,p=o[2];n>3?(i=p===r)&&(c= __get$(o,(s=o[4])?5:(s=3,3)) ,o[4]=o[5]=e):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,m.v=r,m.n=o[1]):f<p&&(i=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,m.n=p,s=0))}if(i||n>1)return a;throw d=!0,r}return function(i,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,p),s=l,c=p;(t=s<2?e:c)||!d;){o||(s?s<3?(s>1&&(m.n=-1),f(s,c)):m.n=c:m.v=c);try{if(u=2,o){if(s||(i="next"),t= __get$(o,i) ){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(d=m.n<0)?c:n.call(r,m))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l= __get$([],r) ?t(t( __call$([],r,[]) )):(Ea(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Ea(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,Ea(d,"constructor",u),Ea(u,"constructor",c),c.displayName="GeneratorFunction",Ea(u,i,"GeneratorFunction"),Ea(d),Ea(d,i,"Generator"),Ea(d,r,function(){return this}),Ea(d,"toString",function(){return"[object Generator]"}),(Oa=function(){return{w:o,m}})()}function Ea(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Ea=function(e,t,n,r){function o(t,n){Ea(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}): __set$(e,t,n) :(o("next",0),o("throw",1),o("return",2))},Ea(e,t,n,r)}var Ca=Oa().m(rs),_a=Oa().m(is),Pa=Oa().m(as),Ia=Oa().m(ss),ja=Oa().m(cs),Ra=Oa().m(us),Na=Oa().m(ls),Ta=Oa().m(ds),Ga=Oa().m(ms),Da=Oa().m(fs),La=Oa().m(ps),Ua=Oa().m(vs),Wa=Oa().m(hs),za=Oa().m(bs),$a=Oa().m(xs),Ba=Oa().m(Ms),Ha=Oa().m(Ss),Fa=Oa().m(ks);function qa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ja(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ja(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ja(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}function Qa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Sa(e)||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Sa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Sa(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}var Va,Za,Ka,Xa,Ya,es,ts=null,ns=function(e){return(0,ha.Od)(function(t){var n={"club.game.error":function(e){return t((n=e,{type:Xe.pm,error:n}));var n},"game.get.success":function(e){return t(Or(e.data))},"game.timer.expired":function(){return  __get$(window,"location") .reload(!0)},"game.join.opponent":function(e){return t(Or(e.data))},"game.start.success":function(e){return t((n=e.data,{type:Xe.u$,data:n}));var n},"game.error":function(e){var n,r=e.data;r&&(r.state===Xe._p.RUNNING&&t(Or(r)),t((n={message:r.message?r.message:Ma.Y.formatMessage(V.A.someError)},{type:Xe.gU,error:n})))},"game.move.success":function(e){return t((n=e.data,{type:Xe.zN,data:n}));var n},"game.move.opponent":function(e){return t((n=e.data,{type:Xe.Iv,data:n}));var n},"game.server.end":function(e){var n,r,i;"create"===(null===(n=ts)||void 0===n?void 0:n.game_id)|| __get$(window,"location") .pathname.includes(A.R7.CREATE_GAME)||(t((i=e.data,{type:Xe.Bf,data:i})),t((r=e.data,{type:Xe.yD,payload:r})))},"get.emotional.flavor.success":function(e){return t((n=e.data,{type:Xe.ss,data:n}));var n},"game.action.request.success":function(e){var n=e.action,r=e.data,i= __get$(Xe.E0,n) ;if(i){var o= __get$(r,i) ;t(_r({playerAction:n,value:o}))}},"game.action.reply.success":function(e){var n=e.data,r=n.action,i=n.data,o= __get$(i,__get$(Xe.E0,r)) .state;if([Xe.Tn.REJECTED,Xe.Tn.NEVER].includes(o))t(function(e){return{type:Xe.GH,data:e}}({data:i,action:r}));else{var a= __get$(Qa(Qa({},Xe.y6.ADD_TIME,Pr),Xe.y6.UNDO_MOVE,Ir),r) ;a&&t(a(i))}},"game.viewer":function(e){t(Rr(e))},"game.warning":function(e){var n;t((n=e,{type:Xe.k1,data:n}))},"rematch.req.success":function(e){t(_r({playerAction:Xe.y6.REMATCH,value:e.data}))},"game.rematch.reply":function(e){t(function(e){return{type:Xe.yb,resp:e}}(e))},"lobby.my.game.new":function(e){t(wr(e))},"game.get.rating":function(e){var n;t((n=e.data,{type:Xe.go,payload:n}))},"badge.awarded":function(e){return t((n=e,{type:Xe.bw,payload:n}));var n}};return Object.entries(n).forEach(function(t){var n=qa(t,2),r=n[0],i=n[1];e.on(r,i)}),(0,ba.A)(e,t),function(){Object.keys(n).forEach(function(t){e.off(t)})}})};function rs(e){var t,n;return Oa().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.n=1,(0,fe.T1)(ns,e);case 1:t=r.v,r.p=2;case 3:return r.n=4,(0,fe.s)(t);case 4:return n=r.v,r.n=5,(0,fe.yJ)(n);case 5:r.n=3;break;case 6:return r.p=6,r.n=7,(0,fe.KW)();case 7:if(!r.v){r.n=8;break}t.close();case 8:return r.f(6);case 9:return r.a(2)}},Ca,null,[[2,,6,9]])}function is(e){var t;return Oa().w(function(n){for(;;)switch(n.n){case 0:t=Oa().m(function t(){var n,r;return Oa().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,(0,fe.s)(Xe._H);case 1:n=t.v,(r=n.payload)&&e.emit("g_v2.get",r,function(t){t&&"REDIRECT"===t.status&&e.emit(t.event,r)});case 2:return t.a(2)}},t)});case 1:return n.d(ka(t()),2);case 2:n.n=1;break;case 3:return n.a(2)}},_a)}function os(e,t,n,r){return new Promise(function(i,o){var a=!1,s=setTimeout(function(){a=!0,o(new Error("Emit timeout"))},r);e.emit(t,n,function(e){a||(clearTimeout(s),e&&e.error?o(new Error(e.error)):i(e))})})}function as(e){var t;return Oa().w(function(n){for(;;)switch(n.n){case 0:if(!e.connected){n.n=1;break}return n.a(2);case 1:return n.n=2,(0,fe.O4)({connect:(0,fe.s)(wa.Hr),reconnect:(0,fe.s)(wa.Ak),timeout:(0,fe.cb)(Xe.Qq)});case 2:return t=n.v,n.a(2,t)}},Pa)}function ss(e){var t,n,r,i;return Oa().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.n=1,(0,fe.s)(Xe.Pf);case 1:t=o.v,n=t.payload,r=0,i=!1;case 2:if(i||!(r<Xe.eA)){o.n=10;break}return o.p=3,o.d(ka(as(e)),4);case 4:if(e.connected){o.n=6;break}return r+=1,o.n=5,(0,fe.cb)(Xe.jC*Math.pow(2,r-1));case 5:return o.a(3,2);case 6:return o.n=7,(0,fe.T1)(os,e,"g_v2.move",n.move,Xe.Qq);case 7:i=!0,o.n=9;break;case 8:if(o.p=8,o.v,!((r+=1)<Xe.eA)){o.n=9;break}return o.n=9,(0,fe.cb)(Xe.jC*Math.pow(2,r-1));case 9:o.n=2;break;case 10:if(!(i&&r>0)){o.n=11;break}return o.n=11,(0,fe.yJ)(Nr(r));case 11:if(i){o.n=12;break}return o.n=12,(0,fe.yJ)(Er());case 12:o.n=0;break;case 13:return o.a(2)}},Ia,null,[[3,8]])}function cs(e){var t,n,r,i;return Oa().w(function(o){for(;;)switch(o.n){case 0:return o.n=1,(0,fe.s)(Xe.qJ);case 1:t=o.v,n=t.data,r=n.event,i=n.payload,e.emit(r,i),o.n=0;break;case 2:return o.a(2)}},ja)}function us(e){var t,n,r,i;return Oa().w(function(o){for(;;)switch(o.n){case 0:return o.n=1,(0,fe.s)(Xe.kp);case 1:t=o.v,n=t.data,r=n.event,i=n.payload,e.emit(r,i),o.n=0;break;case 2:return o.a(2)}},Ra)}function ls(){return Oa().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,fe.s)(wa.Ak);case 1:return e.n=2,(0,fe.yJ)(kr(ts));case 2:e.n=0;break;case 3:return e.a(2)}},Na)}function ds(e){var t,n;return Oa().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,(0,fe.s)(Xe.al);case 1:t=r.v,n=t.payload,e.emit("g_v2.join.guest",n),r.n=0;break;case 2:return r.a(2)}},Ta)}function ms(e){var t,n;return Oa().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,(0,fe.s)(Xe.t8);case 1:t=r.v,n=t.payload,e.emit(n.leaveEvt,{game_id:n.gameId}),r.n=0;break;case 2:return r.a(2)}},Ga)}function fs(e){var t,n;return Oa().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=1,r.n=2,(0,fe.T1)(pe.Ay,"v2/games/quick-challenge",{method:"POST",body:JSON.stringify(e.payload)});case 2:return t=r.v,r.n=3,(0,fe.yJ)(Ar(t));case 3:r.n=6;break;case 4:return r.p=4,n=r.v,r.n=5,(0,fe.yJ)(br(n));case 5:xa.Ay.push("/");case 6:return r.a(2)}},Da,null,[[1,4]])}function ps(){var e;return Oa().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=1,t.n=2,(0,fe.T1)(pe.Ay,"games/check-challenge-status");case 2:if(!(e=t.v).game_id){t.n=3;break}return t.n=3,(0,fe.yJ)(wr(e));case 3:t.n=5;break;case 4:return t.p=4,t.v,t.n=5,(0,fe.yJ)(br());case 5:return t.a(2)}},La,null,[[1,4]])}function vs(){return Oa().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=1,e.n=2,(0,fe.T1)(pe.Ay,"games/cancel-quick-challenge");case 2:return e.n=3,(0,fe.yJ)(hr());case 3:e.n=5;break;case 4:return e.p=4,e.v,e.n=5,(0,fe.yJ)(br());case 5:return e.a(2)}},Ua,null,[[1,4]])}function gs(e){var t=e.data;return Oa().m(function e(){var n,r,i;return Oa().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=1,n=JSON.stringify(t),e.n=2,(0,fe.T1)(pe.Ay,"ads/redeem",{method:"POST",body:n});case 2:return r=e.v,e.n=3,(0,fe.yJ)(Tr(r));case 3:e.n=6;break;case 4:if(e.p=4,401!==(i=e.v).status){e.n=5;break}return e.a(2);case 5:return e.n=6,(0,fe.yJ)(Gr({isError:!0,exception:i.error?i.error.message:null}));case 6:return e.a(2)}},e,null,[[1,4]])})()}function ys(e){var t=e.payload;return Oa().m(function e(){var n,r;return Oa().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=1,e.n=2,(0,fe.T1)(pe.Ay,"users/report/game",{method:"POST",body:JSON.stringify(t)});case 2:return n=e.v,e.n=3,(0,fe.yJ)(Br(n));case 3:e.n=5;break;case 4:return e.p=4,r=e.v,e.n=5,(0,fe.yJ)(Hr(r.error));case 5:return e.a(2)}},e,null,[[1,4]])})()}function hs(e){var t,n,r,i,o,a,s,c,u;return Oa().w(function(l){for(;;)switch(l.n){case 0:return l.n=1,(0,fe.s)(Xe.yD);case 1:return n=l.v,r=n.payload,i=(0,K.HW)(),l.n=2,(0,fe.Lt)(gi());case 2:o=l.v,a=(null===o||void 0===o||null===(t=o.red)||void 0===t?void 0:t.identity)===(null===i||void 0===i?void 0:i.identity),(0,_n.WJ)(o.red,o.black,i)&&(s=r.end_result,c=a?s.red.result:s.black.result,u=K.Ay.getItem(A.DD),e.emit("get.emotional.flavor",{result:c,locale:u})),l.n=0;break;case 3:return l.a(2)}},Wa)}function bs(){var e;return Oa().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=1,t.n=2,(0,fe.T1)(pe.Ay,"local_engine_config/");case 2:return e=t.v,t.n=3,(0,fe.yJ)(zr(e));case 3:t.n=5;break;case 4:return t.p=4,t.v,t.n=5,(0,fe.yJ)($r());case 5:return t.a(2)}},za,null,[[1,4]])}function ws(e){var t=e.payload;return Oa().m(function e(){return Oa().w(function(e){for(;;)switch(e.n){case 0:if(ts=t,"create"===t.game_id){e.n=1;break}return e.n=1,(0,fe.yJ)(kr(t));case 1:return e.a(2)}},e)})()}function As(e){var t=e.payload;return Oa().m(function e(){var n,r;return Oa().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,fe.Lt)(yi());case 1:if(n=e.v,r="",n.state===Xe._p.END&&n.endReason!==Xe.sj.ABANDON?r="game.archived.leave":n.state!==Xe._p.END&&(r="g_v2.disconnect"),!r||"create"===t.gameId){e.n=2;break}return e.n=2,(0,fe.yJ)(Dr({leaveEvt:r,gameId:t.gameId}));case 2:return ts=null,e.n=3,(0,fe.yJ)(Lr());case 3:return e.n=4,(0,fe.yJ)(Wr());case 4:return e.n=5,(0,fe.yJ)(Sr());case 5:return e.a(2)}},e)})()}function xs(){return Oa().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,fe.s)(Vt.wV);case 1:return e.n=2,(0,fe.yJ)({type:Xe.ux});case 2:e.n=0;break;case 3:return e.a(2)}},$a)}function Ms(e){return Oa().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,(0,fe.Zy)(rs,e);case 1:return t.n=2,(0,fe.Zy)(is,e);case 2:return t.n=3,(0,fe.Zy)(ds,e);case 3:return t.n=4,(0,fe.Zy)(ss,e);case 4:return t.n=5,(0,fe.Zy)(hs,e);case 5:return t.n=6,(0,fe.Zy)(cs,e);case 6:return t.n=7,(0,fe.Zy)(us,e);case 7:return t.n=8,(0,fe.Zy)(ms,e);case 8:return t.n=9,(0,fe.Zy)(ls);case 9:return t.a(2)}},Ba)}function Ss(){var e,t;return Oa().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,(0,fe.s)(Xe.ux);case 1:return n.n=2,(0,fe.yJ)(Ur());case 2:return n.n=3,(0,fe.T1)(Aa.Ay,"xiangqi");case 3:return e=n.v,n.n=4,(0,fe.yJ)((0,Qt.Bj)());case 4:return n.n=5,(0,fe.Zy)(Ms,e);case 5:return t=n.v,n.n=6,(0,fe.yJ)(yr());case 6:return n.n=7,(0,fe.s)([Xe.ip,Vt.wV]);case 7:return n.n=8,(0,fe.ZT)(t);case 8:n.n=0;break;case 9:return n.a(2)}},Ha)}function ks(){return Oa().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,fe.Zy)(Ss);case 1:return e.n=2,(0,fe.Zy)(xs);case 2:return e.n=3,(0,fe.p8)(Xe.Sg,ws);case 3:return e.n=4,(0,fe.p8)(Xe.Ep,As);case 4:return e.n=5,(0,fe.p8)(Xe.J9,gs);case 5:return e.n=6,(0,fe.p8)(Xe.Y1,fs);case 6:return e.n=7,(0,fe.p8)(Xe.a3,ps);case 7:return e.n=8,(0,fe.p8)(Xe.GN,vs);case 8:return e.n=9,(0,fe.p8)(Xe.Ao,bs);case 9:return e.n=10,(0,fe.p8)(Xe.Hl,ys);case 10:return e.a(2)}},Fa)}function Os(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const Es=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"sc-1lvpal1-0"})(["height:100%;display:flex;flex-direction:column;.tab-text{display:flex;.unread-count{padding:0 5px;background-color:",";color:",";font-size:10px;line-height:1;min-width:15px;height:15px;border-radius:50px;font-weight:600;display:flex;align-items:center;justify-content:center;left:50%;top:-5px;}}.tabs-wrapper{border:1px solid ",";border-width:1px 0 1px 0;height:calc(100% - 164px);",";",";.tab-buttons{width:100%;",";}.tab-content{width:100%;height:calc(100% - 54px);",";",";.game-sidebar-chat{overflow:hidden;}}",";#messages{height:calc(100% - 63px);.messages-holder{padding:0px 25px;height:calc(100% - 25px);align-items:flex-start;.message{width:100%;.msg-list{width:100%;}}}}#user-input{background-color:",";margin:10px 20px;}}"],z.ut.$yellow,z.ut.$fireBrick,function(e){return e.theme.border_9},z.$_.phone(Va||(Va=Os(["\n      height: 100%;\n    "]))),z.$_.phone(Za||(Za=Os(["\n      background: ",";\n      position: fixed;\n      left: 0;\n      bottom: 55px;\n      width: 100%;\n      z-index: 99;\n      height: 82%;\n      display: none;\n\n      &.mobile-view {\n        display: block;\n        box-shadow: rgba(0, 0, 0, 0.15) 0px -1px 5px;\n        margin-bottom: 10px;\n      }\n    "])),function(e){return e.theme.background_16}),z.$_.phone(Ka||(Ka=Os(["\n        display: none;\n      "]))),z.$_.xxmdesktop(Xa||(Xa=Os(["\n        height: calc(100% - 45px);\n      "]))),z.$_.phone(Ya||(Ya=Os(["\n        height: 100%;\n      "]))),z.$_.phone(es||(es=Os(["\n      .messages-wrapper {\n        height: 100%;\n      }\n    "]))),function(e){return e.theme.hover_3});var Cs;function _s(e,t,n,r){Cs||(Cs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:Cs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ps=function(e){var t=e.showUsersList,n=e.gameID,r=e.makeToggleChat,i=e.isChatOpen,o=e.SIDEBAR_TABS,a=e.selectedTabIndex,s=e.setSelectedTabIndex,c=e.checkSearchStatus,u=e.cancelClickHandler,l=e.isClubGame,d=(0,W.W6)();return(0,_t.OI)(n)?_s(St.A,{checkSearchStatus:c,cancelClickHandler:function(){u(),d.push("/lobby")},selectedTime:ur.Ub[1],hideDetails:!0}):t&&!l?_s(vt,{gameID:n}):_s(X.A,{className:"tabs-wrapper ".concat(i?"mobile-view":""),tabs:o,selectedTabIndex:a,tabClickHandler:function(e){return s(e)},isCloseVisible:i,toggleClose:r})};var Is,js,Rs=n(47225);function Ns(e,t,n,r){js||(js="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:js,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ts=(0,p.j4)(function(e){var t,n,r=e.sidebarRef,i=e.gamePlayers,o=e.turnNow,a=e.gameState,s=e.pieceLocale,c=e.capturedPiecesMap,u=e.pieceValueDiffMap,l=e.gameData,m=e.activeMove,f=e.historyMode,p=e.isComputerGame,v=e.isDaily,g=e.isTimed,y=e.gameTimers,h=e.onTimerExpire,b=e.currentUser,w=e.isSmallMobileResolution,A=e.showUsersList,x=e.gameID,M=e.makeToggleChat,S=e.isChatOpen,k=e.SIDEBAR_TABS,O=e.selectedTabIndex,C=e.setSelectedTabIndex,_=e.makeCheckQuickGameStatus,P=e.makeCancelQuickGame,I=e.fetchGameSuccess,j=e.top,R=e.bottom,N=e.getOnlineStatus,T=e.invites,G=e.isClubGame,D=e.intl;return I?d.createElement(Es,{ref:r},Ns(Rs.A,{locale:D.locale,position:Xe.lP.TOP,isComputerGame:p,isDailyGame:v,isTimedGame:g,playerTimers:(0,fo.Ay)(a===Xe._p.END&&f&&m&&m.timers?m.timers:y,j,o,a),player: __get$(i,j) ,isOnline:N( __get$(i,j) ),isBlackPlayer:(0,_n.lO)(i.black, __get$(i,j) ),gameState:a,isMyTurn:a!==Xe._p.END&&o===j,endGameHandler:h,mySide:(null===(t= __get$(i,j) )||void 0===t?void 0:t.identity)===(null===b||void 0===b?void 0:b.identity)?j:R,pieceLocale:s,capturedPieces: __get$(c,j) ,pieceValue: __get$(u,j) ,isMoveTimeAvailable:null===l||void 0===l?void 0:l.moveTimer,showBack:w}),Ns(Ps,{showUsersList:A,gameID:x,makeToggleChat:M,isChatOpen:S,SIDEBAR_TABS:k,selectedTabIndex:O,setSelectedTabIndex:C,checkSearchStatus:_,cancelClickHandler:P,isClubGame:G}),!A||G?Ns(Rs.A,{locale:D.locale,position:Xe.lP.BOTTOM,isComputerGame:p,isDailyGame:v,isTimedGame:g,playerTimers:(0,fo.Ay)(a===Xe._p.END&&f&&m&&m.timers?m.timers:y,R,o,a),player: __get$(i,R) ,isOnline:N( __get$(i,R) ),isBlackPlayer:(0,_n.lO)(i.black, __get$(i,R) ),gameState:a,isMyTurn:a!==Xe._p.END&&o===R,endGameHandler:h,mySide:(null===(n= __get$(i,R) )||void 0===n?void 0:n.identity)===(null===b||void 0===b?void 0:b.identity)?R:j,pieceLocale:s,capturedPieces: __get$(c,R) ,pieceValue: __get$(u,R) ,isMoveTimeAvailable:null===l||void 0===l?void 0:l.moveTimer}):Ns(ot,{invites:T})):Is||(Is=Ns(Es,{},void 0,Ns(E.A,{})))});var Gs;const Ds=te.Ay.div.withConfig({displayName:"Wrapper",componentId:"bk1k1j-0"})(["text-align:center;background:",";border-radius:28px;padding:32px 24px;display:flex;flex-direction:column;align-items:center;gap:16px;z-index:8;.title{color:",";font-size:20px;font-weight:600;margin:0;}.subtitle{color:",";font-size:14px;font-weight:500;","}.buttons-wrapper{display:flex;gap:8px;width:100%;justify-content:center;.btn{height:48px;margin:0;display:flex;justify-content:center;min-height:auto;.title-wrapper{width:auto;margin-left:0;.main-title{font-size:16px;font-weight:600;}}}}"],function(e){return e.theme.baseColor},function(e){return e.theme.text_22},function(e){return e.theme.text_30},z.$_.desktop(Gs||(Gs=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n      font-size: 12px;\n    "]))));var Ls,Us;function Ws(e,t,n,r){Us||(Us="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:Us,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var zs=function(e){var t=e.isOpen,n=e.onClose,r=(0,W.W6)(),i=(0,d.useMemo)(function(){var e;return null===(e=(0,K.HW)())||void 0===e?void 0:e.is_premium},[]);return Ws(F.A,{isOpen:t,onClose:n,onRequestClose:n,styles:{overlay:oe.BU,content:oe.Qh}},void 0,Ws(Ds,{},void 0,Ls||(Ls=Ws(J.A,{src:$.RQ,alt:"Profile",width:147,height:147})),Ws(Ke.A,{className:"title"},void 0,d.createElement(p.sA,Ne.inviteLimitReached)),!i&&d.createElement(d.Fragment,null,Ws(Ze.A,{className:"subtitle"},void 0,d.createElement(p.sA,Ne.inviteLimitReachedDesc)),Ws(H.A,{type:"button",className:"btn-primary",onClick:function(){r.push({pathname:"/subscription",state:{showPremiumText:!0}}),n()}},void 0,d.createElement(p.sA,Ne.upgradeNow)))))};const $s=(0,d.memo)(zs);var Bs,Hs,Fs;function qs(e,t,n,r){Fs||(Fs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=r;else if(o>1){for(var a=Array(o),s=0;s<o;s++) __set$(a,s,__get$(arguments,s+3)) ;t.children=a}if(t&&i)for(var c in i)void 0=== __get$(t,c) &&( __set$(t,c,__get$(i,c)) );else t||(t=i||{});return{$$typeof:Fs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Js(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&& __get$(e,Symbol.iterator) ||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Qs(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qs(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}var Vs="game",Zs=(0,g.j8)({initialConnected:(0,g.Mz)(fi,function(e){return e.get("initialConnect")}),isFetchGameSuccess:pi(),historyMode:hi(),flipBoard:bi(),gameData:vi(),gamePlayers:gi(),gamePlayData:yi(),gameActions:(0,g.Mz)(fi,function(e){return e.get("gameActions")}),gameError:(0,g.Mz)(fi,function(e){return e.get("error")}),windowWidth:(0,U.f1)(),windowHeight:(0,U.gp)(),locale:(0,zt.BC)(),pieceLocale:(0,zt.xw)(),gameWarning:(0,g.Mz)(fi,function(e){return e.get("gameWarning")}),showRefreshWarning:(0,g.Mz)(fi,function(e){return e.get("showRefreshWarning")}),moveTimeOutWarning:(0,g.Mz)(fi,function(e){return e.get("moveTimeOutWarning")}),moveSuccessWithAttempts:(0,g.Mz)(fi,function(e){return e.get("moveSuccessWithAttempts")}),activePreMove:(0,g.Mz)(fi,function(e){return e.get("activePreMove")}),guestMPGamesCompleted:(0,$t._A)(Ft.Dc.MP_GAME),guestMPConsecuitiveGamesCompleted:(0,$t._A)(Ft.Dc.MP_CONSECUITIVE_GAME_WIN),isCreatingQuickGame:(0,g.Mz)(fi,function(e){return e.get("creatingQuickGame")}),createGameData:(0,g.Mz)(fi,function(e){return e.get("createGameData")}),isChatOpen:wi(),redeemReward:(0,g.Mz)(fi,function(e){return e.get("redeemReward")}),gameViewers:Ai(),drawer:(0,U.Qy)(),theme:(0,U.x6)(),isChatInjected:(0,Bt.u9)(),expectedPlayerRatingData:(0,g.Mz)(fi,function(e){return e.get("expectedPlayerRating")}),gameMessages:(0,Bt.vx)(),APKLink:(0,U.vo)(),mbPlayerGamesCompletedCount:(0,U.wE)(Vt.eD.MP_GAMES_COMPLETED),focusModeEnabled:(0,U.fs)(),rejectedRequest:(0,g.Mz)(fi,function(e){return e.get("rejectedRequest")}),emotionalEndText:(0,g.Mz)(fi,function(e){return e.get("emotionalFlavortext")}),isSocketConnected:(0,U.RU)(),showLimitModal:(0,g.Mz)(je,function(e){return e.get("inviteLimit")}),cancelPreMove:(0,g.Mz)(fi,function(e){return e.get("cancelPreMove")}),clubGameError:(0,g.Mz)(fi,function(e){return e.get("clubGameError")}),earnedBadges:(0,g.Mz)(fi,function(e){return e.get("badgesEarned")}),isReportingUser:(0,g.Mz)(fi,function(e){return e.get("isReportingUser")}),reportUserCheatingSuccess:(0,g.Mz)(fi,function(e){return e.get("reportUserSuccess")}),reportUserCheatingError:(0,g.Mz)(fi,function(e){return e.get("reportUserError")}),isReportDisabled:(0,g.Mz)(fi,function(e){return e.get("isReportDisabled")})}),Ks=(0,f.connect)(Zs,function(e){return{makePlayerAction:function(t){return e(Cr(t))},makeReplyPlayerAction:function(t){return e(function(e){return{type:Xe.kp,data:e}}(t))},makeFlipBoard:function(t){return e(function(e){return{type:Xe.j$,value:e}}(t))},makeToggleChat:function(){return e(gr())},makeInitialConnect:function(t){return e({type:Xe.ux})},makeConnectGame:function(t){return e(function(e){return{type:Xe.Sg,payload:e}}(t))},makeJoinGuest:function(t){return e(function(e){return{type:Xe.al,payload:e}}(t))},makeSendMove:function(t){return e(function(e){return{type:Xe.Pf,payload:e}}(t))},makeNavigateHistory:function(t){return e(jr(t))},makeGuestActivity:function(t){return e((0,Ht.M8)(t))},makeGuestActivityReset:function(t){return e((0,Ht.nh)(t))},makeClearGameWarning:function(){return e({type:Xe.G1})},makeAppendGameMessage:function(t){return e((0,Wt.MG)(t))},makeCreateQuickGame:function(t){return e((n=t,{type:Xe.Y1,payload:n}));var n},makeCancelQuickGame:function(){return e(xr())},makeClearGameCreationError:function(){return e({type:Xe.Ye})},makeCheckQuickGameStatus:function(){return e(Mr())},removeViewer:function(t){return e(Rr(t))},makeClearMoveSuccess:function(){return e({type:Xe.yZ})},makeRedeemRating:function(t){return e((n=t,{type:Xe.J9,data:n}));var n},makeSwitchGame:function(t){return e(function(e){return{type:Xe.Ep,payload:e}}(t))},makeMBUserActivity:function(t){return e((0,Qt.O8)(t))},makeSetGamePlayers:function(t){return e(Or(t))},makeToggleFocusMode:function(t){return e((0,Qt.W_)(t))},makeClearRejectedRequest:function(){return e({type:Xe.J5})},makeChangePieceHandler:function(t){return e((0,Jt.TO)(t))},makeSetInviteLimit:function(t){return e(we(t))},makeClearEarnedBadges:function(){return e({type:Xe.bm})},makeUpdateGameAnalysisMove:function(t,n){return e(function(e,t){return{type:Xe.OY,moveIndex:e,analysisData:t}}(t,n))},makeClearGameAnalysis:function(){return e({type:Xe.Al})},makeReportUserCheating:function(t){return e(function(e){return{type:Xe.Hl,payload:e}}(t))},makeClearUserCheating:function(){return e({type:Xe.D1})}}}),Xs=(0,y.A)({key:Vs,reducer:mi}),Ys=(0,h.A)({key:Vs,saga:ks,mode:A.Zc});const ec=(0,p.j4)((0,v.Zz)(Ks,b.A,Xs,Ys)(function(e){var t,n,r,i=ko(e),o=i.gameData,a=i.sidebarData,s=o.locale,c=o.match,u=o.windowWidth,l=o.isFetchGameSuccess,f=o.gamePlayers,p=o.gameActions,v=o.isCreatingQuickGame,g=o.makeCheckQuickGameStatus,y=o.makeCreateQuickGame,h=o.makeCancelQuickGame,b=o.redeemReward,A=o.user,U=o.gameID,W=o.tournamentID,z=o.moveCount,$=o.endReason,B=o.onPlayerAction,H=o.quickGameSetting,F=o.handleRedeemUserRating,q=o.isRated,J=o.archive,Q=o.isGameEndModalOpen,Z=o.setIsGameEndModalOpen,K=o.showRematchButton,X=o.history,Y=o.isUserPlaying,ee=o.isChallenge,te=o.hideGameEndModal,ne=o.isDaily,re=o.unverifiedModalOpen,ie=o.setUnverifiedModalOpen,oe=o.showRedeemRatingModal,ae=o.closeRedeemRatingModal,se=o.currentUserData,ce=o.guestGameCompletedModalOpen,ue=o.setGuestGameCompletedModalOpen,le=o.boardContext,de=o.footerContext,me=o.gameState,fe=o.moveHistory,pe=o.onPlayerActionReply,ve=o.pageTitle,ge=o.getAppClickHandler,ye=o.onCancelMobileAppPrompt,he=o.isMobileAppPromptOpen,be=o.isWoodenTheme,we=o.isMobileResolution,Ae=o.renderInitialMoveTimeout,xe=o.getMoves,Me=o.activeMoveInd,Se=o.historyClickHandler,ke=o.onComputerGameClicked,Oe=o.getGameUrl,Ee=o.isGuestUser,Ce=o.focusModeEnabled,_e=o.makeToggleFocusMode,Pe=o.isMobileDisplay,Ie=o.isSettingsModalOpen,je=o.toggleSettingsModal,Re=o.showMovesListOnMobile,Ne=o.makeChangePieceHandler,Te=o.isRematchClicked,Ge=o.setIsRematchClicked,De=o.emotionalEndText,Le=o.makeSetInviteLimit,Ue=o.showLimitModal,We=o.isQuickGame,ze=o.showBadgesCount,$e=o.onToggleShowBadges,Be=o.isClubGame,He=o.shareInInbox,Fe=o.shareInChat,qe=o.onCloseLevelUpModal,Je=o.isLevelUpModalOpen,Qe=o.onShareLevelUp,Ve=o.onCloseShareModal,Ze=o.isShareModalOpen,Ke=o.myUserInfo,Ye=o.earnedBadges,et=o.makeClearEarnedBadges,tt=o.showEarnedBadgeModal,nt=o.gameEndInfo,rt=o.showDisconnectTimer,it=o.onCloseReportModal,ot=o.handleOpenReportModal,at=o.isReportModalOpened,st=o.isReportingUser,ct=o.makeReportUserCheating,ut=o.isReportDisabled,lt=a.capturedPiecesMap,dt=a.pieceLocale,mt=a.activeMove,ft=a.pieceValueDiffMap,pt=a.bottom,vt=a.getOnlineStatus,gt=a.historyMode,yt=a.gameTimers,ht=a.turnNow,bt=a.onTimerExpire,wt=a.top,At=a.isTimed,xt=a.gameHistory,Mt=a.navigateMoveHistory,St=a.viewers,kt=a.gameMessages,Ot=a.playersDisconnected,Et=a.gameData.moveTimer,Ct=de.isMyTurnNow,_t=de.handleBoardFlip,Pt=de.flipBoard,It=de.isGamePlayer,jt=de.allowSharing,Rt=de.handleAnalysisClick,Nt=de.handleNote,Tt=(0,d.useMemo)(function(){return Pe?56:0},[Pe]),Gt=Js((0,k.A)(O.A,0,Tt),1)[0],Dt=(0,d.useMemo)(function(){return Gt*M.Ir+(Gt>0?Tt:0)},[Gt,Tt]);return l?d.createElement(d.Fragment,null,qs(m.mg,{},void 0,qs("title",{},void 0,ve)),!(0,w.DH)()&&qs(N.A,{isOpen:he,message:V.A.playerGamesCompleted,onGetAppPress:ge,onCancel:ye}),!we&&Ae(),!we&&me===Xe._p.RUNNING&&qs(ia,{isDisconnected:rt}),Ie&&qs(G.A,{showPreMoveToggle:me===Xe._p.RUNNING,isSettingsModalOpen:Ie,toggleSettingsModal:je,isDrawArrows:null===de||void 0===de?void 0:de.isDrawArrows,onToggleDrawArrows:null===de||void 0===de?void 0:de.onToggleDrawArrows,isPreMoveEnabled:null===de||void 0===de?void 0:de.isPreMoveEnabled,onTogglePreMove:null===de||void 0===de?void 0:de.onToggleEnablePreMove,isMobileResolution:Pe,makeChangePieceHandler:Ne,pieceLocale:dt,showBadgesCount:ze,onToggleShowBadges:$e,isFocusMode:Ce}),tt&&qs(Zt.A,{isOpen:Boolean(Ye),onClose:et,username:null===A||void 0===A?void 0:A.username,earnedBadges:Ye,gameData:nt}),(A.id&&A.active||Y||ee)&&qs(Lt,{gameState:me,isPlayer:Y,computerGameHandler:ke,getGameUrl:Oe,windowWidth:u,gamePlayers:f,isGuestUser:Ee,cancelQuickGame:h,quickGameSetting:H,checkSearchStatus:g,isFocusMode:Ce,isClubGame:Be}),Ze&&qs(dn,{isOpen:Ze,onClose:Ve,getGameUrl:Oe,isFocusMode:Ce,shareInInbox:He,shareInChat:Fe,myUserInfo:Ke,locale:s}),Je&&qs(mn.A,{isOpen:Je,onClose:qe,onShare:Qe,isFocusMode:Ce,locale:s,myUserInfo:Ke}),(!te&&me===Xe._p.END||Q)&&!Je&&!Ze&&!tt&&!at&&qs(Vo,{isFocusMode:Ce,user:A,gameID:U,tournamentID:W,moveCount:z,endReason:$,gamePlayers:f,windowWidth:u,isGamePlayer:Y,onPlayerAction:B,rematchRequest:p.rematchRequest,isCreatingQuickGame:v,quickGameSetting:H,checkQuickGameStatus:g,makeCreateQuickGame:y,makeCancelQuickGame:h,handleRedeemUserRating:F,isRated:q,isGameArchived:J,isGameEndModalOpen:Q,setIsGameEndModalOpen:Z,showRematchButton:K,isRematchClicked:Te,setIsRematchClicked:Ge,emotionalEndText:De,isQuickGame:We,locale:s,handleOpenReportModal:ot,isReportDisabled:ut}),me===Xe._p.WAITING&&A.id&&!A.active&&qs(R.A,{unverifiedModalOpen:re,cannotClose:!0,history:X,closeUnverifiedModal:function(){return ie(!1)}}),qs(pn.A,{shouldBlockHistory:"create"!==c.params.id&&me<Xe._p.END&&!ne&&Y}),qs(qt.A,{isGameModal:!0,isOpen:oe,onClose:ae,user:A,userRating:null===se||void 0===se?void 0:se.rating,userRedeemRating:null===b||void 0===b?void 0:b.data}),qs(D.A,{onClose:function(){return ue(null)},type:ce,isSubscriptionModalOpen:Boolean(ce),hideCancel:!0}),qs($s,{isOpen:Ue,onClose:function(){return Le(!1)}}),at&&qs(ma,{isOpen:at,onClose:it,isReportingUser:st,makeReportUserCheating:ct,user:A,gameID:U,gamePlayers:f}),Ce?qs(_.A,{sidebarProps:a,boardContext:le,footerContext:de,isMobileResolution:Pe,makeToggleFocusMode:_e,gameActions:p,onPlayerActionReply:pe,isComputerGame:!1,showRematchButton:K,isRematchClicked:Te,setIsRematchClicked:Ge,showBadgesCount:ze,shareInInbox:He,shareInChat:Fe}):d.createElement(d.Fragment,null,qs(L.RN,{className:"left-side-container",showRight:!0,isFullWidth:!1},void 0,qs(ya,{isWoodenTheme:be,boardHeight:Dt,isMovesListVisible:Re},void 0,d.createElement(d.Fragment,null,Pe&&Ae(),we&&me===Xe._p.RUNNING&&qs(ia,{isDisconnected:rt}),Pe&&qs("div",{className:"top-section"},void 0,qs(Rs.A,{locale:s,position:Xe.lP.TOP,isComputerGame:!1,isDailyGame:ne,isTimedGame:At,playerTimers:(0,fo.Ay)(me===Xe._p.END&&gt&&mt&&mt.timers?mt.timers:yt,wt,ht,me),player: __get$(f,wt) ,isOnline:vt( __get$(f,wt) ),isBlackPlayer:(0,_n.lO)(f.black, __get$(f,wt) ),gameState:me,isMyTurn:me!==Xe._p.END&&ht===wt,endGameHandler:bt,mySide:(null===(t= __get$(f,wt) )||void 0===t?void 0:t.identity)===(null===A||void 0===A?void 0:A.identity)?wt:pt,pieceLocale:dt,capturedPieces: __get$(lt,wt) ,pieceValue: __get$(ft,wt) ,isMoveTimeAvailable:Et}),Re&&qs(j.A,{moves:xe(),locale:s,activeMoveIndex:Me,historyClickHandler:Se,className:"game-moves-list"}))),qs("div",{className:"game-area-wrapper"},void 0,qs("div",{id:"game-area",className:"board-container"},void 0,qs("div",{className:"board-wrapper-main"},void 0,qs(S.A.Provider,{value:le},void 0,Hs||(Hs=qs(x.A,{}))),Pe&&Dt>0&&qs(T.A,{isComputerGame:!1,isMobileResolution:!0,gameState:me,moveCount:z,gameHistory:xt,activeMove:mt,toggleSettingsModal:je,navigateMoveHistory:Mt,windowWidth:u,onPlayerAction:B,user:A,handleBoardFlip:_t,flipBoard:Pt,gamePlayers:f,isMyTurnNow:Ct,isGamePlayer:It,gameActions:p,isRated:q,viewers:St,gameMessages:kt,playersDisconnected:Ot,gameID:U,allowSharing:jt,gameUrl:Oe,handleAnalysisClick:Rt,handleNoteClick:Nt,endReason:$,tournamentID:W,shareInInbox:He,shareInChat:Fe})))),qs(fn.A,{user:A,isUserPlaying:Y,userSide:Y&&A.identity===(null===f||void 0===f||null===(n=f.red)||void 0===n?void 0:n.identity)?Xe.Zl.RED:Xe.Zl.BLACK,gameState:me,moveHistory:fe,gameActions:p,onPlayerActionReply:pe},void 0,!Pe&&qs(P.A.Provider,{value:de},void 0,qs(C.A,{type:I.A.GAME}))),Pe&&qs(Rs.A,{locale:s,position:Xe.lP.BOTTOM,isComputerGame:!1,isDailyGame:ne,isTimedGame:At,playerTimers:(0,fo.Ay)(me===Xe._p.END&&gt&&mt&&mt.timers?mt.timers:yt,pt,ht,me),player: __get$(f,pt) ,isOnline:vt( __get$(f,pt) ),isBlackPlayer:(0,_n.lO)(f.black, __get$(f,pt) ),gameState:me,isMyTurn:me!==Xe._p.END&&ht===pt,endGameHandler:bt,mySide:(null===(r= __get$(f,pt) )||void 0===r?void 0:r.identity)===(null===A||void 0===A?void 0:A.identity)?pt:wt,pieceLocale:dt,capturedPieces: __get$(lt,pt) ,pieceValue: __get$(ft,pt) ,isMoveTimeAvailable:Et}))),!Pe&&qs(L.yW,{className:"right-side-container"},void 0,d.createElement(Ts,a)))):d.createElement(d.Fragment,null,qs(m.mg,{},void 0,qs("title",{},void 0,ve)),Bs||(Bs=qs(E.A,{})))}))}}]);
/*hammerhead|script|end*/
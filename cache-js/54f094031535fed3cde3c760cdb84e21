/*hammerhead|script|start*/if (typeof window !== 'undefined' && window){window['hammerhead|process-dom-method'] && window['hammerhead|process-dom-method']();if (window.__get$ && typeof __get$ === 'undefined')var __get$Loc = window.__get$Loc,__set$Loc = window.__set$Loc,__set$ = window.__set$,__get$ = window.__get$,__call$ = window.__call$,__get$Eval = window.__get$Eval,__proc$Script = window.__proc$Script,__proc$Html = window.__proc$Html,__get$PostMessage = window.__get$PostMessage,__get$ProxyUrl = window.__get$ProxyUrl,__rest$Array = window.__rest$Array,__rest$Object = window.__rest$Object,__arrayFrom$ = window.__arrayFrom$;} else {if (typeof __get$ === 'undefined')var __get$Loc = function(l){return l},__set$Loc = function(l,v){return l = v},__set$ = function(o,p,v){return o[p] = v},__get$ = function(o,p){return o[p]},__call$ = function(o,p,a){return o[p].apply(o,a)},__get$Eval = function(e){return e},__proc$Script = function(s){return s},__proc$Html = function(h){return h},__get$PostMessage = function(w,p){return arguments.length===1?w.postMessage:p},__get$ProxyUrl = function(u,d){return u},__rest$Array = function(a,i){return Array.prototype.slice.call(a, i)},__rest$Object = function(o,p){var k=Object.keys(o),n={};for(var i=0;i<k.length;++i)if(p.indexOf(k[i])<0)n[k[i]]=o[k[i]];return n},__arrayFrom$ = function(r){if(!r)return r;return!Array.isArray(r)&&"function"==typeof r[Symbol.iterator]?Array.from(r):r};if (typeof importScripts !== "undefined" && /\[native code]/g.test(importScripts.toString())) {var __getWorkerSettings$ = function () {return null};importScripts((location.origin || (location.protocol + "//" + location.host)) + "/worker-hammerhead.js");}}/*hammerhead|script|processing-header-end*/
(function(){"use strict";const ie=e=>{console.debug(e)},u=(e,t)=>{console.error(e,JSON.stringify(t)),ve("ERROR",e,Ie(e,t))},B=(e,t)=>{console.error(e,JSON.stringify(t)),ve("FATAL",e,Ie(e,t))},ve=(e,t,n)=>{var i;(i=window.ueLogError)==null||i.call(window,n,{logLevel:e,attribution:"APE-safeframe",message:t+" | "})},Ie=(e,t)=>t instanceof Error?t:t?new Error(t):new Error(e),se=(e,t,n)=>(...i)=>{try{e(...i)}catch(s){t==null||t(n||"Error in handler",s)}},At=e=>Tt(e),Pt=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/,be=e=>Pt.test(e),yt=e=>be(e)?At(e):e,Se=e=>be(e)?e:Ct(e),Ct=e=>btoa(unescape(encodeURIComponent(e))),Tt=e=>decodeURIComponent(escape(atob(e))),_t=e=>e&&e.split("&c=${AAX_PAYLOAD}").join(""),Nt=(e,t,n)=>"".concat(e).concat(n?":".concat(n.placementName):""," - ").concat(t),V=(e,t,n)=>{var s;const i=Nt(e,t,n);return(s=performance==null?void 0:performance.mark)==null||s.call(performance,i),i},N=e=>{if(window.csa)try{window.csa("Events",{producerId:"adplacements"})("setEntity",{adCreativeMetaData:e})}catch(t){u("Error with 'setEntity' CSA",t)}},p=(e,t,n=1)=>{if(window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e+":"+t.name+":"+t.id,metricValue:n},{ent:"all"})}catch(i){u("Error with 'logCsaEvent' CSA",i)}},H=(e,t=1)=>{if(window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e,metricValue:t},{ent:"all"})}catch(n){u("Error with 'incrementCounter' CSA",n)}},Lt=/(\/b|\/s|\/l).*(node=)(\d{1,12})/,re=new Map,Ae=()=>{if(!re.has( __get$(__get$(window,"location"),"href") )){const e=Lt.exec( __get$(__get$(window,"location"),"href") ),t=e&&e[3]?e[3]:null;re.set( __get$(__get$(window,"location"),"href") ,t)}return re.get( __get$(__get$(window,"location"),"href") )},Pe=e=>{const t=Ae();if(!e||!t)return null;const n=e.split(":");return n.splice(n.length-1,0,t),n.join(":")},ye=e=>{const t=Ae();return t?"".concat(e,":").concat(t):null},oe=e=> __call$(e,"replace",[/_/g,":"]) ,d=(e,t,n=1)=>{if(!Ce())return;const i=(s,r,o)=>{r&&Te("".concat(Ne(s),":").concat(r),o)};i(e,t.id,n),i(e,ye(t.id),n),i(e,oe(t.name),n),i(e,Pe(oe(t.name)),n)},m=(e,t=1)=>{Ce()&&Te(Ne(e),t)},Ce=()=>{var e;return typeof((e=window==null?void 0:window.ue)==null?void 0:e.count)=="function"},Te=(e,t)=>{var n;return(n=window==null?void 0:window.ue)==null?void 0:n.count(e,t)},_e="adplacements",Ne=e=>e.startsWith(_e)?e:"".concat(_e,":").concat(e),Mt="adload:renderstart",kt="adload:renderend",xt="adload:creativewritten",Rt="adload:start",Ot="adload:delayloadcallback",Bt="adload_renderstart",Vt="adload_renderend",Ht="adload_creativewritten",Ft="adload_start",Ut="adload_delayload",b=(e,t)=>{Wt()&&$t(e+Yt(t))},Wt=()=>{var e;return typeof((e=window==null?void 0:window.ue)==null?void 0:e.tag)=="function"},$t=e=>{var t;return(t=window==null?void 0:window.ue)==null?void 0:t.tag(e)},Yt=e=>e?":".concat(e):"",Jt=e=>{if(!(e!=null&&e.adCreativeMetaData)||!Object.keys(e.adCreativeMetaData).length){b("noadrender"),N({adrender:"false"});return}b("adrender"),b("adrender:safeframe"),Gt(e),Kt(e),zt(e),qt(e)},Gt=e=>{const t=Le(e);b("adrender","creativetemplatename:"+t),N({adrender:"true",creativeTemplateName:t,isLightAds:"false"})},Le=e=>e.adCreativeMetaData.adCreativeTemplateName? __call$(e.adCreativeMetaData.adCreativeTemplateName.toLowerCase(),"replace",[/[^0-9a-z]/g,""]) :"unknown",Kt=e=>{e.adCreativeMetaData.adCreativeId&&(b("adrender","creativeid:"+e.adCreativeMetaData.adCreativeId),N({creativeId:e.adCreativeMetaData.adCreativeId}))},zt=e=>{e.adCreativeMetaData.adProgramId&&(b("adrender","programid:"+e.adCreativeMetaData.adProgramId),N({adProgramId:e.adCreativeMetaData.adProgramId}))},qt=e=>{e.isCardsFlow!==void 0&&N({isCardsFlow:e.isCardsFlow.toString()})},Xt="aUAZqFtiIp6VxqpW3coqZ2JdZnV3RN9S8yKMRIdJ",jt="https://qdbx3pbnx6veby23pzgaowu3q40tmmrr.lambda-url.us-east-1.on.aws",ae="APE_CW_METRICS",Zt=10;let Me=!1;const ke=e=>{Me||(window.addEventListener("beforeunload",()=>en()),Me=!0);const t=xe();t.push(e),t.length>=Zt?Re(t):Dt(t)},xe=()=>{const e=localStorage.getItem(ae);if(!e)return[];try{return JSON.parse(e)}catch(t){return[]}},Re=e=>{navigator.sendBeacon(jt,JSON.stringify(Qt(e))),localStorage.removeItem(ae)},Qt=e=>({metrics:e,xApiKey:Xt}),Dt=e=>{localStorage.setItem(ae,JSON.stringify(e))},en=()=>{const e=xe();e.length>0&&Re(e)},S=(e,t)=>{const n=()=>{var i,s;return(s=(i=e==null?void 0:e.renderingWeblabs)==null?void 0: __get$(i,t) )==null?void 0:s.toLowerCase()};return{is(i){return n()===i},isInTreatment(){return!!n()&&n()!=="c"},getTreatment(){var i;return(i=n())!=null?i:"c"}}},tn=()=>S(window,"ADPT_SF_LOW_RATE_METRIC_LOGGING_1256362"),nn=()=>S(window,"ADPT_SF_SERVER_SIDE_SPONSORED_LABEL_998980"),Oe=()=>S(window,"APM_STORES_JPS_JRS_SAFEFRAME_VIEW_RATE_EXPERIMENT_1289633"),F=()=>S(window,"APM_STORES_JPS_JRS_CREATIVE_BOOKS_ADS_1277965"),Be=()=>S(window,"APM_STORES_JPS_JRS_SAFEFRAME_1318775"),sn=()=>S(window,"APM_STORES_JPS_JRS_SAFEFRAME_NEW_VIEWABILITY_TRACKER_1354300"),rn=e=>{var n,i;if(!window.APE_SF)return;const t=(i=(n=window.APE_SF).loggedMetricNames)!=null?i:n.loggedMetricNames=new Set;t.has(e.metricName)||(t.add(e.metricName),ke(e))},A=( _hh$temp0 )=>{ var e=_hh$temp0.metricName,t=_hh$temp0.adDetails,_hh$temp0$count=_hh$temp0.count,n=_hh$temp0$count===void 0?1:_hh$temp0$count,_hh$temp0$additionalDimensions=_hh$temp0.additionalDimensions,i=_hh$temp0$additionalDimensions===void 0?{}:_hh$temp0$additionalDimensions,_hh$temp0$once=_hh$temp0.once,s=_hh$temp0$once===void 0?!1:_hh$temp0$once; tn().is("t1")&&(s?rn:ke)(on(e,n,an(t,i)))},on=(e,t,n)=>({metricName:e,timestamp:new Date().getTime(),value:t,dimensions:n}),an=(e,t)=>{var n,i;return{app:"SF",siteName:e.siteName,slotName:e.slotName,pageType:e.pageType,placementId:e.placementId,mediaType:e.mediaType,programId:(n=e.adCreativeMetaData)==null?void 0:n.adProgramId,creativeTemplateName:(i=e.adCreativeMetaData)==null?void 0:i.adCreativeTemplateName,deviceType:e.deviceType,...t}},cn={DESKTOP:16,MSHOP:10,MWEB:10},y=e=>(e==null?void 0:e.length)>1&&e.charAt(e.length-1)==="%",L=e=>y(e)?e:"".concat(parseInt(e),"px"),Ve=(e,t="MWEB")=>{if(y(e))return e;const n=parseFloat(e),i= __get$(cn,t) ;return!n||!i?"inherit":"".concat(n/i,"lh")},dn=(e,t)=>{const n=i=>y(i)?i:parseInt(i);A({metricName:"creative:size:changeSize",adDetails:e,additionalDimensions:{postSize:"".concat(n(t.width),"x").concat(n(t.height))}})},ln=e=>{mn.has(e.slotName)&&A({metricName:"responsivePlacement",adDetails:e,additionalDimensions:{responsiveCreative:String(e.responsiveCreative),responsivePlacement:String(e.responsivePlacement),creativeId:e.adCreativeMetaData.adCreativeId}})},mn=new Set(["desktop-homepage-btf-card-1","desktop-homepage-btf-card-2","desktop-homepage-btf-card-3","desktop-homepage-btf-left","abgw-btf-card-1","ams-detail-right-pbook","goldbox-ads","fresh-hero-quick-promo","wfm-hero-quick-promo","fresh-odp-desktop-ad-2","dynamic-zoetrope-1","mobile-app-detail-lpo","mobile-detail-lpo","desktop-detail-lpo","ee-vssm-desktop-1","ee-vssm-desktop-5","ee-vssm-desktop-9","merchandised-search-3","merchandised-search-9","merchandised-vssm-desktop-1","merchandised-vssm-desktop-2","merchandised-vssm-desktop-3","merchandised-vssm-desktop-4","merchandised-vssm-desktop-5","merchandised-vssm-desktop-6","merchandised-vssm-mobile-1","merchandised-vssm-mobile-2","merchandised-vssm-mobile-3","merchandised-vssm-mobile-4","merchandised-vssm-mobile-5","merchandised-vssm-mobile-6"]),He="adplacements:retailClickTracking:failure",hn="adplacements:retailClickTracking:clickSuccess",un="adplacements:retailClickTracking:missingUrl",pn=async e=>{const t=document.getElementById(e);t==null||t.removeAttribute("onclick");const n=t==null?void 0:t.getAttribute("data-click-addr");if(!n){window.ue.count(un,1);return}try{(await fetch(n,{keepalive:!0})).ok?window.ue.count(hn,1):window.ue.count(He,1)}catch(i){window.ue.count(He,1)}},C=e=>{ const _hh$temp1=e,t=_hh$temp1.adUnitIframeId,n=document.getElementById(t); if(!n){ const _hh$temp2=document,i=_hh$temp2.readyState; m("getiframe:undefined"),A({metricName:"html:element:missing:iframe",adDetails:e,additionalDimensions:{readyState:i,adUnitIframeId:t}})}return n},gn=Array.from({length:100},(e,t)=>(t+1)/100),wn=(e,t)=>{const n=C(e);n&&new IntersectionObserver(i=>i.forEach(s=>fn(e,t,s)),{threshold:gn}).observe(n)},fn=(e,t, _hh$temp3 )=>{ var n=_hh$temp3.target,i=_hh$temp3.intersectionRect,s=_hh$temp3.boundingClientRect,r=_hh$temp3.intersectionRatio; const o=n,a=i.width/s.width,c=i.height/s.height;t.sendMessageToAd(e.arid,"populateSafeFrameExt",{geom:{self:{t:s.top,l:s.left,r:s.right,b:s.bottom,xiv:a,yiv:c,iv:r,z:1,w:o.offsetWidth,h:o.offsetHeight}},inViewPercentage:Math.round(r*100)})},En=(e,t)=>{const n=C(e);n&&setInterval(()=>{const i=n.getBoundingClientRect();t.sendMessageToAd(e.arid,"populateGeom",{geom:{self:{t:i.top,l:i.left,r:i.right,b:i.bottom,z:1,w:n.offsetWidth,h:n.offsetHeight}}})},250)},g=e=>{const t=document.getElementById(e.adUnitPlacementId);return t||(m("getplacement:undefined"),A({metricName:"html:element:missing:placement",adDetails:e})),t},vn="nav-ewc-persistent-hover",In="div#nav-flyout-ewc",Fe="nav-cart",bn="--nav-cart-full-width",Sn="--nav-cart-half-width",An=e=>{const t=document.documentElement,n=g(e);Ue(t,n),new MutationObserver(i=>{for(const s of i)if(s.type==="attributes"&&s.attributeName==="class"){const r=s.target;Ue(r,n)}}).observe(t,{attributes:!0,attributeFilter:["class"]})},Ue=(e,t)=>{if(e.classList.contains(vn)){t.classList.add(Fe);const n=Pn();t.style.setProperty(bn,"".concat(n,"px")),t.style.setProperty(Sn,"".concat(n/2,"px"))}else t.classList.remove(Fe)},Pn=()=>{const e=document.querySelector(In);return e instanceof HTMLElement?e.offsetWidth:0},yn=e=>({onSafeFrameReady(t){v("eventsChannel:onSafeFrameReady",t),V("perf:sf:host","safeFrameReady",t),e.sendMessageToAd(t.arid,"setupComputedAdDetails",{aPageStart:window.aPageStart,adStartTime:new Date().getTime()}),window.addEventListener("resize",()=>{e.sendCustomMessageToAd(t.arid,"resize",{height:window.innerHeight,width:window.innerWidth})}),Jt(t),An(t),wn(t,e),En(t,e)},onPreCreativeWrite(t){v("eventsChannel:onPreCreativeWrite",t);const n={id:t.placementId,name:t.placementName};d(Mt,n),p(Bt,n)},onPostCreativeWrite(t){v("eventsChannel:onPostCreativeWrite",t);const n={id:t.placementId,name:t.placementName};d(kt,n),p(Vt,n)},onCreativeBeginToRender(t){v("eventsChannel:onCreativeBeginToRender",t)},onCreativeLoad(t){v("eventsChannel:onCreativeLoad",t);const n={id:t.placementId,name:t.placementName};d(xt,n),p(Ht,n),ln(t)},onError(t){v("eventsChannel:onError",t)},onClick(t){v("eventsChannel:onClick",t),pn(t.adUnitPlacementId)}}),v=(e,t)=>{m(e),d(e,{id:t.placementId,name:t.placementName},performance.now())};function Cn(e,t,n){e.addEventListener(t,i=>{n(i)})}const We="sfVideoContinuousPlaytimeSeconds",Tn=e=>{let t=0;return Cn(e.div,We,n=>{t=n.detail.sfVideoContinuousPlaytimeSeconds}),{shouldFirePixel(){return t>=2}}},_n=["fresh-desktop-detail-ilm","wfm-desktop-detail-ilm","alm-weis-desktop-detail-ilm","alm-save-desktop-detail-ilm","alm-lucky-desktop-detail-ilm","alm-bristol-desktop-detail-ilm","alm-rite-desktop-detail-ilm","alm-bartell-desktop-detail-ilm","alm-cardenas-desktop-detail-ilm","alm-petfoodexpress-desktop-detail-ilm","alm-allthebestpetcare-desktop-detail-ilm"],Nn=(e,t,n)=>{if(window.csa)try{window.csa("Content",{element:e})("mark",t,n==null?void 0:n.getTime())}catch(i){u("Error with 'mark' CSA",i)}},$e={wb:"ues",bb:"uet",af:"uet",cf:"uet",be:"uet",ld:"uex"},Ye=( _hh$temp4 )=>{ var e=_hh$temp4.latencyEvent,t=_hh$temp4.scope,n=_hh$temp4.placement,i=_hh$temp4.timestamp; var s,r;Ln(e)&&(U(e,W(t),n.id,i),U(e,W(t),oe(n.name),i),U(e,W(t),(s=Pe(n.name))!=null?s:void 0,i),U(e,W(t),(r=ye(n.id))!=null?r:void 0,i))},Ln=e=>typeof  __get$(window,__get$($e,e)) =="function",U=(e,t,n,i=new Date)=>{const s= __get$($e,e) ;!n||typeof  __get$(window,s) !="function"|| __call$(window,s,[e,t+n,{wb:1},i]) },W=e=>"adplacements:"+Mn(e),Mn=e=>e?"".concat(e,":"):"";class kn{sendLatencyMetric( _hh$temp5 ){ var t=_hh$temp5.latencyMetricType,n=_hh$temp5.placementId,i=_hh$temp5.placementName,s=_hh$temp5.placementDivId,r=_hh$temp5.timestamp; Ye({latencyEvent:t.csmKey,scope:t.csmMessage,placement:{id:n,name:i},timestamp:r}),Nn(document.getElementById(s),t.csaKey,r)}}const T=()=>new kn,xn=(e,t)=>{const n=Rn(t);let i=0;for(const _hh$temp6 of n){ const _hh$temp7=__arrayFrom$(_hh$temp6),s=_hh$temp7[0],r=_hh$temp7[1]; if(!On(s,r))continue;const o=document.elementFromPoint(s,r);o&&Bn(o,e)&&i++}return i/n.length},Rn=e=>{const n=[];for(let i=0;i<10;i++)n.push([e.left+e.width/2,e.top+e.height*(i+.5)/10]);return n},On=(e,t)=>{const n=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight;return e>=0&&e<=n&&t>=0&&t<=i},Bn=(e,t)=>{if(!(e instanceof HTMLElement)||e===t||t.contains(e))return!1;const n=window.getComputedStyle(e);if(n.display==="none"||n.visibility==="hidden"||n.pointerEvents==="none"||parseFloat(n.opacity)<.7)return!1;const i=n.backgroundColor;return!((i==="transparent"||/,0\)$/.test(i)||i==="")&&!n.backgroundImage.includes("url"))},Vn=(e,t)=>{const n=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),i=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));if(n===0||i===0)return 0;const s=n*i,r=e.width*e.height;return s/r},$=e=>{ const _hh$temp8=e,t=_hh$temp8.height,n=_hh$temp8.top,_hh$temp8$left=_hh$temp8.left,i=_hh$temp8$left===void 0?0:_hh$temp8$left,_hh$temp8$width=_hh$temp8.width,s=_hh$temp8$width===void 0?Hn():_hh$temp8$width; return{top:n,bottom:n+t,left:i,right:i+s,width:s,height:t}},Hn=()=>window.innerWidth||document.documentElement.clientWidth,ce="mash",Fn=async e=>new Promise((t,n)=>{if(!P){n(new Error("mash:getobstructions:missing"));return}const i=setTimeout(()=>{n(new Error("mash:getobstructions:timeout"))},e),s=performance.now();P.when(ce).execute(r=>{var o,a;if(!((a=(o=r==null?void 0:r.appCX)==null?void 0:o.uiOrchestrator)!=null&&a.getObstructions)){clearTimeout(i),n(new Error("mash:getobstructions:missing"));return}r.appCX.uiOrchestrator.getObstructions({successCallback:c=>{clearTimeout(i),t({boundingBoxes:(c.boundingBoxes||[]).map($),isFullyObstructed:c.isFullyObstructed,latencyMs:performance.now()-s})},failCallback:()=>{clearTimeout(i),n(new Error("mash:getobstructions:failure"))}})})}),Un=e=>{if(!P){m("mash:missing",1);return}P.when(ce).execute(t=>{t==null||t.addEventListener("obstructionsChanged",e)})},Wn=e=>{if(!P){m("mash:missing",1);return}P.when(ce).execute(t=>{t==null||t.removeEventListener("obstructionsChanged",e)})},$n=(e,t)=>{const n=t.getObstructingRectangles();return n.length===0?0:n.reduce((s,r)=>s+Vn(e,r),0)},Yn=async e=>{try{e.setObstructingRectangles([]),e.listenerHandler||(e.listenerHandler=i=>Jn(i,e),Un(e.listenerHandler));const n=await Fn(950);e.setObstructingRectangles(Gn(n,e))}catch(n){Y(n.message,e)}},Jn=(e,t)=>{var n;t.setObstructingRectangles((((n=e==null?void 0:e.detail)==null?void 0:n.boundingBoxes)||[]).map($))},Gn=(e,t)=>e.isFullyObstructed?(Y("viewPixel:iab:obstruction:native:fullviewport",t,1),[$({height:window.innerHeight,top:0})]):(Kn(e.boundingBoxes,t),e.boundingBoxes.map($)),Y=(e,t,n=1)=>{t.metricsLogged.has(e)||(m(e,n),H(e,n),t.metricsLogged.add(e))},Kn=(e,t)=>{for(const n of e)Y("mash:getobstructions:response:height",t,n.height),Y("mash:getobstructions:response:top",t,n.top)},zn=e=>{if(e.listenerHandler){try{Wn(e.listenerHandler)}catch(t){}e.listenerHandler=void 0}},J=()=>{let e=[];const n={metricsLogged:new Set,listenerHandler:void 0,setObstructingRectangles:i=>{e=i},getObstructingRectangles:()=>e};return Yn(n),{getObstructionPercentage( _hh$temp9 ){ var i=_hh$temp9.element,_hh$temp9$elementDOMRectOverride=_hh$temp9.elementDOMRectOverride,s=_hh$temp9$elementDOMRectOverride===void 0?i.getBoundingClientRect():_hh$temp9$elementDOMRectOverride; const r=xn(i,s),o=$n(s,n);return Math.max(r,o)},cleanup(){zn(n)}}};class Je{constructor(t,n,i,s,r){this.pixel=t,this.viewabilityStandard=n,this.visibilityChangeService=i,this.viewabilityService=s,this.videoPixelValidator=r,this.metricsLogged=new Set,this.wasObstructed=!1,this.emitObstructionRecoveryMetrics=o=>{this.wasObstructed&&this.logMetrics("viewpixel:iab:obstruction:recovered",1,o)},this.logMetrics=(o,a=1,c)=>{this.metricsLogged.has(o)||(m(o,a),H(o,a),c&&(d(o,c,a),p(o,c,a)),this.metricsLogged.add(o))}}postPixelFireCleanup(t,n){t.unobserve(n.div),clearTimeout(this.viewTimerTimeoutId),clearInterval(this.obstructionCheckIntervalId),this.visibilityChangeService.removeVisibilityChangeDetection(),this.emitObstructionRecoveryMetrics(n),this.viewabilityService.cleanup()}postPlacementExitsViewportCleanup(){clearTimeout(this.viewTimerTimeoutId),clearInterval(this.obstructionCheckIntervalId),clearInterval(this.shouldFirePixelIntervalId),this.visibilityChangeService.removeVisibilityChangeDetection()}fireInObserver(t,n){this.fire(n),this.postPixelFireCleanup(t,n)}startInViewTimer(t,n){this.viewTimerTimeoutId=setTimeout(()=>this.fireInObserver(t,n),this.viewabilityStandard.thresholdTimeVisibleMs),this.performContinuousObstructionCheck(t,n),this.visibilityChangeService.setupVisibilityChangeDetection(this.viewTimerTimeoutId,t,n)}performContinuousObstructionCheck(t,n){this.obstructionCheckIntervalId=setInterval(()=>{try{this.viewabilityService.isViewabilityObstructed(n,this.viewabilityStandard.thresholdPercentage)&&(this.wasObstructed=!0,clearTimeout(this.viewTimerTimeoutId),clearInterval(this.obstructionCheckIntervalId),this.startInViewTimer(t,n))}catch(s){B(s==null?void 0:s.message,s),clearInterval(this.obstructionCheckIntervalId)}},100)}track(t){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting?this.startInViewTimer(i,t):this.postPlacementExitsViewportCleanup()})},{threshold:this.viewabilityStandard.thresholdPercentage}).observe(t.div)}async fire(t){this.videoPixelValidator&&!this.videoPixelValidator.shouldFirePixel()&&await this.waitUntilShouldFirePixel(),this.pixel.fire(t)}waitUntilShouldFirePixel(){return new Promise(t=>{this.shouldFirePixelIntervalId=setInterval(()=>{this.videoPixelValidator&&this.videoPixelValidator.shouldFirePixel()&&(clearInterval(this.shouldFirePixelIntervalId),t())},100)})}}const Ge={keepalive:!0,mode:"no-cors"};class G{constructor(t,n,i,s,r,o=[]){this.url=t,this.loggingContext=n,this.generatePixelUrl=i,this.pixelIdentifier=s,this.pixelLogger=r,this.urls3p=o,this.isFired=!1,this.pixel=a=>{const c=document.createElement("img");return c.id="".concat(this.pixelIdentifier.testId,"_").concat(a.name),c.style.display="none",c.setAttribute("pixel-url",this.generatePixelUrl(this.url,a)),c}}async fire(t){this.isFired||(await fetch(this.generatePixelUrl(this.url,t),Ge),t.div.appendChild(this.pixel(t)),this.isFired=!0,this.pixelLogger(this.pixelIdentifier,this.loggingContext,t),this.urls3p.forEach(n=>fetch(n,Ge)))}}const qn={testId:"ape_btr_impression",csmLogId:"imp:btr"},Xn={testId:"ape_impression",csmLogId:"imp:cod"},jn={testId:"ape_measurability",csmLogId:"imp:atf"},Zn={testId:"ape_impression",csmLogId:"imp:skan"},Qn={testId:"skan_view_pixel",csmLogId:"view:skan"},Dn={testId:"ape_viewability_iab",csmLogId:"view:iab"},_=(e=m,t=d)=>(n,i,s)=>{var r;e("pixel:".concat(n.csmLogId)),t("pixel:".concat(n.csmLogId),s),e("pixel:".concat(n.csmLogId,":").concat(i.aaxProgramId)),e("pixel:".concat(n.csmLogId,":device:").concat((r=s.deviceType)==null?void 0:r.toLowerCase()))},Ke={H1_DESKTOP_HEIGHT:240,H1_DESKTOP_WIDTH:940},ei=e=>{if(ti(e)){const t={height:Ke.H1_DESKTOP_HEIGHT,width:Ke.H1_DESKTOP_WIDTH};return ni(e.div,t)}return e.div.getBoundingClientRect()},ti=e=>e.name.toLowerCase()==="gateway_desktop-h1_desktop",ni=(e,t)=>{const n=e.getBoundingClientRect(),s=(n.left+n.right)/2-t.width/2;return new DOMRect(s,n.y,t.width,t.height)},ii=e=>{const t=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth,i={top:Math.max(0,e.top),left:Math.max(0,e.left),bottom:Math.min(t,e.bottom),right:Math.min(n,e.right)};if(e.top>=t||e.left>=n||e.bottom<=0||e.right<=0||e.width<=0||e.height<=0)return 0;const s=(i.right-i.left)*(i.bottom-i.top),r=e.width*e.height;return s/r},si=e=>{var n;const t=e.placement.div.getBoundingClientRect();return{v:{def:e.definition,p:e.thresholdPercentage,t:e.thresholdTimeVisibleMs,ib:e.isBtr},wh:window.innerHeight||document.documentElement.clientHeight,ww:window.innerWidth||document.documentElement.clientWidth,sx:window.scrollX,sy:window.scrollY,ah:t.height,aw:t.width,top:t.top,left:t.left,ptv:(new Date().getTime()-((n=window.aPageStart)!=null?n:0))/1e3,ttv:(new Date().getTime()-e.adStartTime)/1e3}},K=e=>{const t=new Set,n=(s,r=1,o)=>{t.has(s)||(m(s,r),H(s,r),o&&(d(s,o,r),p(s,o,r)),t.add(s))},i=(s,r)=>{const o=ei(s),a=ii(o),c=e.getObstructionPercentage({element:s.div,elementDOMRectOverride:o}),l=a-c<r;return l&&n("viewpixel:iab:obstruction",1,s),l};return{isViewabilityObstructed(s,r){return i(s,r)},cleanup(){e.cleanup()}}},ze=()=>{const e=(t,n,i)=>{document.hidden?(clearTimeout(t),n.unobserve(i.div)):n.observe(i.div)};return{removeVisibilityChangeDetection(){this.activeVisChangeHandler&&(document.removeEventListener("visibilitychange",this.activeVisChangeHandler),this.activeVisChangeHandler=void 0)},setupVisibilityChangeDetection(t,n,i){this.removeVisibilityChangeDetection(),this.activeVisChangeHandler=()=>e(t,n,i),document.addEventListener("visibilitychange",this.activeVisChangeHandler)}}},de="AppAdsMshopIOSPlugin",ri=e=>{var t;(t=window.P)==null||t.when(de).execute(n=>{n.startAttributeViewThroughAppAds({skAdNetwork:e})})},oi=e=>{var t;(t=window.P)==null||t.when(de).execute(n=>{n.endAttributeViewThroughAppAds({skAdNetwork:e})})},ai=(e,t)=>{var n;(n=window.P)==null||n.when(de).execute(i=>{i.renderClickThroughAppAds({skAdNetwork:e,fallbackUrl:t})})};class ci{constructor(t,n,i){this.loggingContext=t,this.skAdNetwork=n,this.pixelLogger=i,this.isFired=!1}async fire(t){this.isFired||(ri(this.skAdNetwork),this.isFired=!0,this.pixelLogger(Zn,this.loggingContext,t))}}class di{constructor(t,n,i){this.loggingContext=t,this.pixelLogger=n,this.skAdNetwork=i,this.isFired=!1}async fire(t){this.isFired||(oi(this.skAdNetwork),this.isFired=!0,this.pixelLogger(Qn,this.loggingContext,t))}}const li="btr_client",qe="cod_client",Xe="atf",je="v",mi="pj",hi="c",z=/\${AAX_TYPE}/,Ze=/\${AAX_PAYLOAD}/,ui="{}",pi="",Qe=(e,t,n)=>{if(t===pi)throw new Error("Invalid queryParamKey input to addJSONQueryParamToURL: "+JSON.stringify({queryParamKey:t}));const i=new URL(e),s=i.searchParams.get(t),o=JSON.parse(s||ui),a= __call$(Object,"assign",[o,n]) ;return i.searchParams.set(t,JSON.stringify(a)),i.toString()},gi=e=>Qe(_t(e),hi,{measurementMethod:li}),wi=e=>{const t=e.includes(".paets.");return Qe(e,mi,t?{}:{measurementMethod:qe})},q=()=>window.innerHeight||document.documentElement.clientHeight,le=()=>window.innerWidth||document.documentElement.clientWidth,fi=e=>e.getBoundingClientRect().top-q(),Ei=(e,t)=>({t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height,z:t}),me=e=>{const t=e.getBoundingClientRect();return Ei(t,Number(window.getComputedStyle(e,null).zIndex))},vi=e=>{const t=bi(e);return t==null?"unknown":t>=.5},Ii=e=>e.width===0&&e.height===0;function bi(e){const t=document.body.getBoundingClientRect();if(Ii(t))return null;const n=me(e),i=q(),s=le(),r=Math.max(0,Math.min(t.left+s,n.r)-n.l),o=Math.max(0,Math.min(t.top+i,n.b)-n.t),a=r*o/(n.h*Math.min(n.w,s));return Number(Math.min(1,Math.max(0,a)).toFixed(2))}const Si=(e,t)=>{const n=me(e),i=me(t),s=le(),r=q();return n&&i&&(Math.abs(n.t-i.b)<r||Math.abs(n.b-i.t)<r)&&(Math.abs(n.l-i.r)<s||Math.abs(n.r-i.l)<s)},Ai=(e,t)=>{const n={atf:vi(t.div)},i=encodeURIComponent(JSON.stringify(n));return z.test(e)? __call$(__call$(e,"replace",[z,Xe]),"replace",[Ze,i]) :"".concat( __call$(e,"replace",[/\/$/,""]) ,"/").concat(Xe,"/").concat(i)},De={set:(e,t)=>{e.div.dataset.isBtr=String(t)},get:e=>e.div.dataset.isBtr===String(!0)},Pi=e=>{const t=new Date().getTime();return(n,i)=>{const s={placement:i,definition:e.definition,thresholdPercentage:e.thresholdPercentage,thresholdTimeVisibleMs:e.thresholdTimeVisibleMs,isBtr:De.get(i),adStartTime:t},r=encodeURIComponent(JSON.stringify(si(s)));return z.test(n)? __call$(__call$(n,"replace",[z,je]),"replace",[Ze,r]) :"".concat( __call$(n,"replace",[/\/+$/,""]) ,"/").concat(je,"/").concat(r)}},X={IAB_VIDEO:{definition:"iab",thresholdPercentage:.5,thresholdTimeVisibleMs:2e3},IAB_LARGE_DISPLAY:{definition:"iab",thresholdPercentage:.3,thresholdTimeVisibleMs:1e3},IAB_DISPLAY:{definition:"iab",thresholdPercentage:.5,thresholdTimeVisibleMs:1e3},SKAN:{definition:"skan",thresholdPercentage:.5,thresholdTimeVisibleMs:2e3}},et=( _hh$temp10 )=>{ var e=_hh$temp10.target,t=_hh$temp10.onIntersection,n=_hh$temp10.onExit,i=_hh$temp10.options; const s=new IntersectionObserver((r,o)=>{r.forEach(a=>{a.isIntersecting?t(o,a):n(o,a)})},i);return s.observe(e),s},yi=async(e,t)=>{let n,i;return new Promise(s=>{i=s,n=new IntersectionObserver(r=>{r.forEach(o=>{o.target===e&&o.isIntersecting&&(i(o),n.unobserve(e))})},t),n.observe(e)})},Ci=(e,t,n,i)=>{const s=a=>{let c;const l={wasObstructed:!1};et({target:a.div,onIntersection:h=>c=r(a,h,l),onExit:()=>c==null?void 0:c(),options:{threshold:t.thresholdPercentage}})},r=(a,c,l)=>{let h=performance.now(),w=!1;const R=setInterval(()=>{o(a)||_i()?(l.wasObstructed=!0,w=!0):w?(h=performance.now(),w=!1):Ni(h,t.thresholdTimeVisibleMs)&&Li(i)&&(e.fire(a),O(l.wasObstructed),c.unobserve(a.div))},Ti),O=(fe=!1)=>{fe&&Mi(a),clearInterval(R),n.cleanup()};return O},o=a=>{try{return n.isViewabilityObstructed(a,t.thresholdPercentage)}catch(c){return B(c==null?void 0:c.message,c),!1}};return{track:s,viewabilityStandard:t}},Ti=100,_i=()=>document.hidden,Ni=(e,t)=>performance.now()-e>=t,Li=e=>e.every(t=>t.shouldFirePixel()),Mi=e=>{const t="viewpixel:iab:obstruction:recovered";m(t),H(t),d(t,e),p(t,e)},tt= _hh$temp11=>{var e=_hh$temp11.btrPixelUrl,t=_hh$temp11.loggingContext;return e?new G(e,t,gi,qn,_()):void 0;} ,nt= _hh$temp12=>{var e=_hh$temp12.aaxImpPixelUrl,t=_hh$temp12.imp3pUrls,n=_hh$temp12.loggingContext;return new G(e,n,wi,Xn,_(),t);} ,it= _hh$temp13=>{var e=_hh$temp13.aaxInstrPixelUrl,t=_hh$temp13.loggingContext;return new G(e,t,Ai,jn,_());} ,ki=(e,t,n,i,s)=>e==="V"?he(n,X.IAB_VIDEO,s()):xi(i)&&Ri(t)?he(n,X.IAB_LARGE_DISPLAY):he(n,X.IAB_DISPLAY),xi=e=>e==="DESKTOP",Ri=e=>Oi(e)>=242500,Oi=e=>e.getBoundingClientRect().height*e.getBoundingClientRect().width,he=(e,t,n)=>{const i=new G(e.aaxInstrPixelUrl,e.loggingContext,Pi(t),Dn,_());return sn().is("t1")?Ci(i,t,K(J()),n?[n]:[]):new Je(i,t,ze(),K(J()),n)},Bi=e=>{if(e.skAdNetwork)return new ci(e.loggingContext,e.skAdNetwork,_())},Vi=e=>{if(e.skAdNetwork){const t=new di(e.loggingContext,_(),e.skAdNetwork);return new Je(t,X.SKAN,ze(),K(J()),void 0)}},st=e=>e+"_Feedback",rt=0,ot=1;class Hi{constructor(t,n,i,s,r,o,a){this.parentHtmlId=t,this.feedbackStyle=n,this.labelText=i,this.labelStyle=s,this.position=r,this.urlPathAndParameter=o,this.hidden=a}async addSponsoredLabelWithFeedbackLink(t,n){t.appendChildTo(this.parentHtmlId,this);const i=await n.getSponsoredLabelAndFeedbackLink(this.urlPathAndParameter);if(!(i!=null&&i.isOk()))throw new Error("Result from the feedback service was not ok ".concat(this.urlPathAndParameter));t.updateElement(this.getHtmlId(),i)}getHtmlId(){return st(this.parentHtmlId)}isHidden(){return this.hidden}exists(t){return t.exists(this.getHtmlId())}getFeedbackSpanElement(){return document.querySelector("#".concat(this.getHtmlId()," span"))}}class Fi{constructor(t){this.parentHtmlId=t}open(t){t.clickChildLink(this)}getHtmlId(){return st(this.parentHtmlId)}}class Ui{constructor(t,n){this.feedbackHtmlPort=t,this.feedbackApiPort=n}async createSponsoredLabelWithFeedbackLink(t,n){if(!t.exists(this.feedbackHtmlPort)){n.request();try{await t.addSponsoredLabelWithFeedbackLink(this.feedbackHtmlPort,this.feedbackApiPort),n.success(),t.isHidden()||n.labelRenderedHost()}catch(i){throw n.error(),i}}}openModal(t){t.open(this.feedbackHtmlPort)}labelRendered(t){t.labelRenderedCreative()}logTransparencyInfoMissing(t){t.transparencyInfoMissing()}}const ue=e=>new Wi(e),M={REQUEST:"adfeedback_request",SUCCESS:"adfeedback_success",ERROR:"adfeedback_error",LABEL_RENDERED_CREATIVE:"adfeedback_sponsoredlabelrendered_creative",LABEL_RENDERED_HOST:"adfeedback_sponsoredlabelrendered_host"},f={REQUEST:"adfeedback:request",SUCCESS:"adfeedback:success",ERROR:"adfeedback:error",LABEL_RENDERED_CREATIVE:"adfeedback:sponsoredlabelrendered:creative",LABEL_RENDERED_HOST:"adfeedback:sponsoredlabelrendered:host",LABEL_RENDERED:"adfeedback:sponsoredlabelrendered",TRANSPARENCY_INFO_MISSING:"adfeedback:transparencyinfo:missing"};class Wi{constructor(t){this.placement=t}request(){d(f.REQUEST,this.placement),m(f.REQUEST),p(M.REQUEST,this.placement)}success(){d(f.SUCCESS,this.placement),m(f.SUCCESS),p(M.SUCCESS,this.placement)}error(){d(f.ERROR,this.placement),p(M.ERROR,this.placement)}labelRenderedCreative(){d(f.LABEL_RENDERED_CREATIVE,this.placement),m(f.LABEL_RENDERED),p(M.LABEL_RENDERED_CREATIVE,this.placement)}labelRenderedHost(){d(f.LABEL_RENDERED_HOST,this.placement),m(f.LABEL_RENDERED),p(M.LABEL_RENDERED_HOST,this.placement)}transparencyInfoMissing(){d(f.TRANSPARENCY_INFO_MISSING,this.placement),m(f.TRANSPARENCY_INFO_MISSING)}}class $i{constructor(t,n,i){this.status=t,this.html=n,this.script=i}isOk(){return this.status==="ok"}}class Yi{constructor(t){this.windowRepo=t}async getSponsoredLabelAndFeedbackLink(t){const n=await window.fetch(this.windowRepo.origin()+t);if(n.ok){const i=await n.json();return new $i(i.status,i.html,i.script)}throw Error("Could not fetch the feedback html/link/script/label")}}class Ji{appendChildTo(t,n){var s,r;n.position===ot?(s=document.getElementById(t))==null||s.prepend(i(t,n)):n.position===rt&&((r=document.getElementById(t))==null||r.append(i(t,n)));function i(o,a){const c=document.createElement("div");return c.setAttribute("id",a.getHtmlId()),c.classList.add("ape-feedback"),c.style.position="relative",c.style.height="auto",c.style.minHeight="20px",c.style.textAlign=c.id.includes("hero-quick-promo_Desktop_placement_Feedback")?"left":"right",c.style.padding="0",c.style.marginTop="2px",c.style.display=a.feedbackStyle.display,o.endsWith("_wrapper")&&(!o.includes("-ilm")&&(c.style.maxWidth="min(100vh, 100vw)"),c.style.marginLeft="auto",c.style.marginRight="auto",c.style.padding="0 5px"),c.append(l(a)),c;function l(h){const w=document.createElement("div");return w.innerHTML=h.labelText,Gi(w,h.labelStyle),w}}}updateElement(t,n){const i=document.getElementById(t);if(i){i.innerHTML=n.html,Ki(i,n);for(const s of i.children)s.tagName==="DIV"?s.removeAttribute("style"):s.tagName==="A"&&(s.style.removeProperty("position"),s.style.removeProperty("top"),s.style.removeProperty("right"),s.style.removeProperty("display"))}}clickChildLink(t){const n=document.getElementById(t.getHtmlId());for(const s of(n==null?void 0:n.children)||[])if(i(s)){s.click();return}function i(s){return s.tagName==="A"||s.tagName==="DIV"}}exists(t){return!!document.getElementById(t)}}const Gi=(e,t)=>{for(const n in t)e.style.setProperty(n, __get$(t,n) )},Ki=(e,t)=>{const n=zi(e);n.innerHTML=t.script},zi=e=>{const t=document.createElement("script");return e.prepend(t),t},qi={hostname:"www.amazon.com.be"},Xi={hostname:"www.amazon.fr"},ji={hostname:"www.amazon.de"},Zi={hostname:"www.amazon.it"},Qi={hostname:"www.amazon.nl"},Di={hostname:"www.amazon.pl"},es={hostname:"www.amazon.es"},ts={hostname:"www.amazon.se"},E=e=> __get$Loc(location) .hostname===e.hostname,ns=()=>E(qi)||E(Xi)||E(ji)||E(Zi)||E(Qi)||E(Di)||E(es)||E(ts),is=e=>!ns()||ss(e),ss=e=>{var i,s,r,o,a,c;const t=[];pe((r=(s=(i=e==null?void 0:e.url)==null?void 0:i.parameters)==null?void 0:s.adPlacementMetaData)==null?void 0:r.slotName)&&t.push("DSA Error: slotName missing");const n=(c=(a=(o=e==null?void 0:e.url)==null?void 0:o.parameters)==null?void 0:a.adCreativeMetaData)==null?void 0:c.adCreativeDetails;(!n||n.length<=0)&&t.push("DSA Error: transparency info missing"),n==null||n.every(l=>rs(l,t));for(const l of t)u(l);return t.length<=0},rs=(e,t)=>{var n,i,s,r,o;e.version||t.push("DSA Error: version missing"),pe(e.advertiserIdNS)&&t.push("DSA Error: advertiserIdNS missing"),(((n=e.selectionSignals)==null?void 0:n.context)===void 0||((i=e.selectionSignals)==null?void 0:i.context)===null)&&t.push("DSA Error: selectionSignals.context missing"),(((s=e.selectionSignals)==null?void 0: __get$(s,"location") )===void 0||((r=e.selectionSignals)==null?void 0: __get$(r,"location") )===null)&&t.push("DSA Error: selectionSignals.location missing"),pe((o=e.selectionSignals)==null?void 0:o.pastActivity)&&t.push("DSA Error: selectionSignals.pastActivity missing")},pe=e=>!(e!=null&&e.trim()),ge=()=>{return new os(e());function e(){return  new Ui(new Ji(),new Yi({origin:()=>__get$(window,"location").origin})) }};class os{constructor(t){this.feedbackService=t}async addSponsoredLabel( _hh$temp14 ){ var t=_hh$temp14.parentHtmlId,n=_hh$temp14.placement,i=_hh$temp14.feedback; return is(i)?(i.hidden&&( __call$(Object,"assign",[i.style,{display:"none"}]) , __call$(Object,"assign",[i.label.style,{display:"none"}]) ),await this.feedbackService.createSponsoredLabelWithFeedbackLink(cs(t,i),ue(n)),!0):(this.feedbackService.logTransparencyInfoMissing(ue(n)),u("Transparency Information missing"),!1)}openModal(t){this.feedbackService.openModal(new Fi(t))}labelRendered( _hh$temp15 ){ var t=_hh$temp15.placement; this.feedbackService.labelRendered(ue(t))}}const as=e=>"/af/feedback-link?pl="+e,cs=(e,t)=>{const n=JSON.parse(JSON.stringify(t.url.parameters));return n.adPlacementMetaData.pageUrl=Se(n.adPlacementMetaData.pageUrl),new Hi(e,t.style,t.label.text,t.label.style,t.position==="TOP"?ot:rt,as(encodeURIComponent(JSON.stringify(n))),t.hidden)},ds=e=>{ge().labelRendered({placement:{id:e.placementId,name:e.placementName}})},ls=e=>{var t;ge().openModal((t=e.adUnitWrapperId)!=null?t:e.adUnitPlacementId)},ms=async e=>{if(!await ge().addSponsoredLabel(hs(e)))throw new Error("Failed to create sponsored label and feedback link")},hs=e=>{var i;const t=e.adPlacementMetaData,n=e.adFeedbackInfo;return{parentHtmlId:(i=e.adUnitWrapperId)!=null?i:e.adUnitPlacementId,placement:{id:e.placementId,name:e.placementName},feedback:{position:"BOTTOM",hidden:!n.boolFeedback,style:e.feedbackDivStyle,url:{parameters:{adPlacementMetaData:{adElementId:t.adElementId,pageType:t.pageType,pageUrl:Se(t.pageUrl),slotName:t.slotName},adCreativeMetaData:e.adCreativeMetaData}},label:{text:yt(n.sponsoredText),style:e.advertisementStyle}}}};function at(e,t,n){var i={},s=i.noTrailing,r=s===void 0?!1:s,o=i.noLeading,a=o===void 0?!1:o,c=i.debounceMode,l=c===void 0?void 0:c,h,w=!1,R=0;function O(){h&&clearTimeout(h)}function fe(ee){var te=ee||{},I=te.upcomingOnly,Ee=I===void 0?!1:I;O(),w=!Ee}function It(){for(var ee=arguments.length,te=new Array(ee),I=0;I<ee;I++) __set$(te,I,__get$(arguments,I)) ;var Ee=this,bt=Date.now()-R;if(w)return;function ne(){R=Date.now(),t.apply(Ee,te)}function St(){h=void 0}!a&&l&&!h&&ne(),O(),l===void 0&&bt>e?a?(R=Date.now(),r||(h=setTimeout(l?St:ne,e))):ne():r!==!0&&(h=setTimeout(l?St:ne,l===void 0?e-bt:e))}return It.cancel=fe,It}const us="sfImpression",ct="viewablelatency",j=(e,t,n)=>({csaKey:e,csmKey:t,csmMessage:n}),ps=j("bodyBegin","bb"),gs=j("bodyBegin","bb",us),ws=j("viewablelatency:bodyBegin","bb",ct),dt=j("viewablelatency:loaded","ld",ct),k=async(e,t)=>{if(e!=null&&e.trim().match(/^\d{1,4}px$/g))return await fs(parseInt(e,10),t,(n,i)=>{const s=fi(n);return n&&s<=i})},fs=async(e,t,n)=>new Promise(i=>{const s=()=>{n(t,e)&&(i(),window.removeEventListener("scroll",r),window.removeEventListener("resize",r))},r=se(at(20,()=>{s()}),u);window.addEventListener("scroll",r),window.addEventListener("resize",r),s()}),Es=(e,t,n,i,s,r)=>{const o=e==null?void 0: __get$(e,t) ;o!=null&&o.valid&&(o.loaded=!0,o.viewed&&(T().sendLatencyMetric({latencyMetricType:dt,placementId:i,placementName:n,placementDivId:s,timestamp:new Date(r)}),d("htmlviewed:loaded",{id:i,name:n})))},Z=async e=>{const t=C(e),i={root:vs(t)?null:document.documentElement};await yi(t,i)},vs=e=>{let t=e;for(;t;){if(window.getComputedStyle(t,null).getPropertyValue("position")==="fixed")return!0;t=t.parentElement}return!1},Is=async(e,t)=>{t.firePixelsAfter&&await k(t.firePixelsAfter,g(t)),await Z(t),e.sendMessageToAd(t.arid,"fireImpression",{measurementMethod:qe,isNoInventory:!1})};class bs{constructor(t,n,i,s){this.id=t,this.name=n,this.wrapperDivId=i,this.divId=s}collapse(t,n){this.wrapperDiv&&(this.wrapperDiv.style.display="none"),this.div.style.display="none",A({metricName:"placement:collapse",adDetails:t,additionalDimensions:{code:n,isBlank:"".concat(Ss(t)),creativeId:t.adCreativeMetaData.adCreativeId}}),m("safeframe:placement:collapse"),d("safeframe:placement:collapse",{id:this.id,name:this.name})}get wrapperDiv(){return this.wrapperDivId?document.getElementById(this.wrapperDivId):null}get div(){return document.getElementById(this.divId)}}const Ss=e=>{const t=e.htmlContentEncoded.match(/<div id="ad">\s*(.*?)\s*<\/div>/s);return t?t[1].trim()==="":!1},lt=e=>new bs(e.placementId,e.placementName,e.adUnitWrapperId,e.adUnitPlacementId),As=(e,t)=>{ie("ChangeSize API has been deprecated"),Cs(e)&&Ps(e,t)&&dn(e,t)},Ps=(e,t)=>{if(!ys(t))return u("Size w:'".concat(t.width,"', h:'").concat(t.height,"' is not allow-listed for '").concat(e.placementName,"'")),!1;const n=g(e);return Ts(e,t)&&(n.style.maxHeight=L(t.height)),y(t.height)||y(t.width)?(n.style.width=L(t.width),n.style.height=L(t.height)):(n.removeAttribute("style"),n.style.aspectRatio="".concat(parseInt(t.width)," / ").concat(parseInt(t.height))),!0},ys=e=>{const t=L(e.height),n=L(e.width);return[{width:"100%",height:"169px"},{width:"300px",height:"250px"}].some(s=>t===s.height&&n===s.width)},Cs=e=>{var t,n;return e.slotName==="hero-quick-promo"&&(((t=e.adCreativeMetaData)==null?void 0:t.adCreativeTemplateName)==="Personalized Responsive eCommerce"||!((n=e.adCreativeMetaData)!=null&&n.adCreativeTemplateName))&&e.mediaType==="D"},Ts=(e,t)=>e.slotName==="hero-quick-promo"&&y(t.width),_s=(e,t)=>p(t.metricName,{name:e.placementName,id:e.placementId}),Ns=(e,t)=>{u(t.message+": "+e.placementName,t.error),u(t.message,t.error)},Ls=(e,t)=>{B(t.message+": "+e.placementName,t.error)},Q="btr:impression",Ms=new Map([["t1",.1],["t2",.2],["t3",.3],["t4",.4],["t5",.5]]),mt=e=>e!==1004&&Oe().isInTreatment(),ht=(e,t)=>{var i;const n=(i=Ms.get(Oe().getTreatment()))!=null?i:0;return!t.isViewabilityObstructed(e,n)},ks=(e,t,n)=>{const i=setInterval(()=>{ht(e,t)&&(clearInterval(i),n())},100);return i},xs=(e,t,n,i)=>{let s;et({target:e.div,onIntersection:r=>{ht(e,i)?ut(e,t,n,r):s=ks(e,i,()=>ut(e,t,n,r))},onExit:()=>{clearInterval(s)},options:{threshold:0}})},ut=async(e,t,n,i)=>{var s;await t.impressionPixel.fire(e),n&&((s=t.btrPixel)==null||s.fire(e)),t.measurabilityPixel.fire(e),i.disconnect()},Rs=async e=>{var t;e.firePixelsAfter&&await k(e.firePixelsAfter,g(e)),await Z(e),mt(Number(e.adCreativeMetaData.adProgramId))||((t=tt(D(e)))==null||t.fire({id:e.placementId,name:e.placementName,div:g(e),deviceType:e.deviceType}),Os(e))},Os=e=>{d(Q,{id:e.placementId,name:e.placementName},1),m(Q,1);const t=e.adCreativeMetaData.adProgramId?e.adCreativeMetaData.adProgramId:"unknown";m(Q+":program:"+t,1);const n=Le(e);m(Q+":template:"+n,1)},Bs=async e=>{var i,s;const t=D(e),n={id:e.placementId,name:e.placementName,div:g(e),deviceType:e.deviceType};await((i=Bi(t))==null?void 0:i.fire(n)),(s=Vi(t))==null||s.track(n)},Vs=async(e,t)=>{const n=g(e);await k(e.firePixelsAfter,n),await Z(e);const i=D(e),s={id:e.placementId,name:e.placementName,div:n,deviceType:e.deviceType};if(mt(Number(e.adCreativeMetaData.adProgramId))){const o=J();xs(s,{impressionPixel:nt(i),btrPixel:tt(i),measurabilityPixel:it(i)},t.isBtr,K(o))}else it(i).fire(s);Bs(e);const r=Hs(i,e,s);De.set(s,t.isBtr),r.track(s)},Hs=(e,t,n)=>{const i=()=>Tn(n);return ki(t.mediaType,n.div,e,t.deviceType,i)},pt="gw-video-orchestrator",Fs=(e,t,n)=>{var i;(i=window.P)==null||i.when(pt).execute(s=>{try{s.subscribe(e,t,n)}catch(r){ie("gw-video-orchestrator error: ".concat(JSON.stringify(r)))}})},Us=e=>gt(e),Ws=()=>gt(),gt=e=>{var t;(t=window.P)==null||t.when(pt).execute(n=>{n.elect(e)})};let x=null;const $s=(e,t,n)=>{const i=s=>n.sendCustomMessageToAd(e.arid,"videoAutoplayResponse",s);Gs(e.pageType)?Fs(C(e),i,t):x===e.arid?i(!0):x===null&&Ks(C(e))?(x=e.arid,i(!0)):i(!1)},Ys=()=>{Ws(),x=null},Js=e=>{Us(C(e)),x=e.arid},Gs=e=>(e==null?void 0:e.toLowerCase())==="gateway",Ks=e=>![...document.getElementsByTagName("video")].some(t=>!t.paused&&Si(e,t)),wt=new Set;class zs{constructor(t,n){this.hms=t,this.hc=n,this.expandInlineListeners=new Map,this.originalHeights=new Map,this.changeSize=As,this.fireImpressionWithDelay=async i=>{await Is(this.hms,i)},this.logAPIInvocation=(i,s)=>{const r="messenger:".concat(s.apiName);m(r),d(r,{id:i.placementId,name:i.placementName})},this.logError=Ns,this.logFatal=Ls,this.logCsaEvent=_s,this.sendLatencyMetric=(i,s)=>qs(i,s),this.fireViewableLatencyMetrics=async(i,s)=>{Es(this.hc.viewableLatencyTrackers,i.arid,i.placementName,i.placementId,i.adUnitPlacementId,s.adLoadedTimestamp)},this.countMetric=(i,s)=>{s.isGlobal?m(s.metricMsg,s.value):d(s.metricMsg,{id:i.placementId,name:i.placementName},s.value)},this.requestVideoAutoplay=(i,s)=>{m("common:supported:command:requestVideoAutoplay"),$s(i,s,this.hms)},this.releaseVideoAutoplay=()=>{m("common:supported:command:releaseVideoAutoplay"),Ys()},this.haveVideoAutoplayPermission=i=>{m("common:supported:command:haveVideoAutoplayPermission"),Js(i)},this.feedbackLabelRendered=i=>{ds(i)},this.feedbackOpenModal=i=>{ls(i)},this.collapseSlot=(i,s)=>{var r,o;if((r=window.APE_SF)!=null&&r.collapsedPlacements.has(i.adUnitPlacementId)){ie("Slot already collapsed");return}lt(i).collapse(i,s),(o=window.APE_SF)==null||o.collapsedPlacements.add(i.adUnitPlacementId)},this.sendEventAddedCreative=async i=>{wt.has(i.placementId)||(i.firePixelsAfter&&await k(i.firePixelsAfter,g(i)),await Z(i),nt(D(i)).fire({id:i.placementId,name:i.placementName,div:g(i),deviceType:i.deviceType}),wt.add(i.placementId))},this.sendEventCreativeBeginToRender=Rs,this.sendEventCreativeLoaded=async(i,s)=>{await Vs(i,s)},this.resizeForImageOnlyTemplate=i=>g(i).classList.add("is-image-oo"),this.sendSfVideoContinuousPlaytimeSeconds=(i,s)=>{const r=g(i),o=new CustomEvent(We,{detail:s});r.dispatchEvent(o)},this.expandInline=i=>{if(!F().is("t1")&&!F().is("t2")&&!Be().is("t1")){this.logError(i,{message:"expandInline called without weblab enabled"});return}const s=g(i);if(!s)return;const r=s.style.height||getComputedStyle(s).height;this.originalHeights.set(i.adUnitPlacementId,r);const o=this.expandInlineListeners.get(i.adUnitPlacementId);o&&o.forEach(( _hh$temp16 )=>{ var h=_hh$temp16.type,w=_hh$temp16.callback; window.removeEventListener(h,w)});const a=we(i.slotName)?"312px":"307px";s.style.transition="height 0.3s ease",s.style.setProperty("height",we(i.slotName)?a:Ve(a),"important");const c=h=>{this.hms.sendMessageToAd(i.arid,"triggerEventInIframe",{eventType:h.type}),this.resetSlot(i)},l=["click","swipe","tap"].map(h=>({type:h,callback:c}));l.forEach(( _hh$temp17 )=>{ var h=_hh$temp17.type,w=_hh$temp17.callback; window.addEventListener(h,w,{once:!0})}),this.expandInlineListeners.set(i.adUnitPlacementId,l)},this.resetSlot=i=>{if(!F().is("t1")&&!F().is("t2")&&!Be().is("t1")){this.logError(i,{message:"resetSlot called without weblab enabled"});return}const s=g(i);if(!s)return;s.style.transition="height 0.3s ease";const r=this.originalHeights.get(i.adUnitPlacementId)||"55px";s.style.setProperty("height",we(i.slotName)?r:Ve(r),"important"),this.originalHeights.delete(i.adUnitPlacementId)}}}const qs=(e, _hh$temp18 )=>{ var t=_hh$temp18.latencyMetricType,n=_hh$temp18.timestamp; T().sendLatencyMetric({latencyMetricType:t,placementName:e.placementName,placementId:e.placementId,placementDivId:e.adUnitPlacementId,timestamp:n})},D=e=>{var t;return{aaxImpPixelUrl:e.aaxImpPixelUrl,aaxInstrPixelUrl:e.aaxInstrPixelUrl,abpAcceptable:e.abpAcceptable,abpStatus:(t=e.abpStatus)!=null?t:"-1",btrPixelUrl:e.btrPixelUrl,skAdNetwork:e.skAdNetwork,loggingContext:{aaxProgramId:Number(e.adCreativeMetaData.adProgramId)}}},Xs=["desktop-detail-ilm","vindp-desktop-atf-ilm",..._n],we=e=>Xs.includes(e);class js{constructor(t,n){this.supportedCommands=t,this.eventsChannel=n,this.receiveMessage=async( _hh$temp19 )=>{ var _hh$temp19$data=_hh$temp19.data,i=_hh$temp19$data.command,s=_hh$temp19$data.adDetails,r=_hh$temp19$data.payload; try{const a= __get$({...this.eventsChannel,...this.supportedCommands},i) ;a&&await a(s,r)}catch(o){const a="Problem with message: "+JSON.stringify(r);u(a,o)}}}}class Zs{constructor(t){this.adMap=t,this.sendMessageToAd=(n,i,s)=>{const r= __get$(this.adMap,n) .messagePort,o={command:i,data:s}; __call$(r,"postMessage",[o]) },this.sendCustomMessageToAd=(n,i,s)=>{const r={key:i,data:s};this.sendMessageToAd(n,"customMessage",r)}}}const Qs=(e,t)=>{e.skAdNetwork&&ai(e.skAdNetwork,t)};class Ds extends zs{constructor(t,n){super(t,n),this.renderClickThroughAppAds=Qs,this.openInExternalBrowser=(i,s)=>{P==null||P.when("mash").execute(r=>{ const _hh$temp20=r,o=_hh$temp20.ThirdPartyNavigation; o&&this.openInApp3pBrowser(i,{targetURL:s.url})})},this.showEmbeddedBrowser=(i,s)=>{P==null||P.when("mash").execute(r=>{ const _hh$temp21=r,o=_hh$temp21.ThirdPartyNavigation; o&&this.openInApp3pBrowser(i,s)})},this.launchIntentURL=(i,s)=>{B("launchIntentURL is not supported")},this.openInApp3pBrowser=(i,s)=>{P==null||P.when("mash").execute(r=>{try{ const _hh$temp22=r,o=_hh$temp22.ThirdPartyNavigation; s.successCallback=()=>{this.hms.sendMessageToAd(i.arid,"mash.openInApp3pBrowser.update",{}),this.logAPIInvocation(i,"openInApp3pBrowser.success")},s.failCallback=c=>{this.hms.sendMessageToAd(i.arid,"mash.openInApp3pBrowser.update",{value:c}),this.logAPIInvocation(i,"openInApp3pBrowser.fail")};const a= __call$(Object,"assign",[{},s]) ; __call$(Object,"assign",[a,{callerIdentifier:"ad-safeframe",navigationStartTime:Date.now(),fallbackBrowser:o.Browser.EXTERNAL,dismissButtonStyle:o.DismissButtonStyle.CLOSE}]) ,o.openInApp3pBrowser(a)}catch(o){u("ThirdPartyNavigation missing",o)}})},this.onPageEvent=async(i,s)=>{await k(s.eventName,g(i)),this.hms.sendMessageToAd(i.arid,"onPageEvent.update",{})},this.getAdInfo=(i,s)=>{i.slotName&&(document.mobileAds=document.mobileAds||{}, __set$(document.mobileAds,i.slotName,s.mobileAdsInfo) )}}}class er{constructor(t={},n={},i={}){this.adMap=t,this.ADS_HANDLERS=n,this.viewableLatencyTrackers=i}}const ft=/AdPlacementStyleAssets|apePlacements/,tr=e=>{var i;const n=performance.getEntriesByType("resource").find(s=>{var r;return(r=s.name.match(ft))==null?void 0:r[0]});if(n){const s=(i=n.name.match(ft))==null?void 0:i[0];A({metricName:"asset:load:timing",adDetails:e,additionalDimensions:{...s&&{assetName:s},assetUrl:n.name,dns:String(n.domainLookupEnd-n.domainLookupStart),tcp:String(n.connectEnd-n.connectStart),ttfb:String(n.responseStart-n.requestStart),download:String(n.responseEnd-n.responseStart),total:String(n.responseEnd-n.startTime)},once:!0})}},nr=e=>{try{d("coordinate:x",e,e.div.getBoundingClientRect().x),d("coordinate:y",e,e.div.getBoundingClientRect().y)}catch(t){return}},ir=(e,t,n)=>{T().sendLatencyMetric({latencyMetricType:gs,placementId:e.placementId,placementName:e.placementName,placementDivId:e.adUnitPlacementId}),n&&(T().sendLatencyMetric({latencyMetricType:ps,placementId:e.placementId,placementName:e.placementName,placementDivId:e.adUnitPlacementId,timestamp:n}),Ye({latencyEvent:"wb",placement:t,timestamp:n})),d(Rt,t),p(Ft,t),d(Ot,t),p(Ut,t)},sr=e=>{window.addEventListener("scroll",e),window.addEventListener("resize",e),document.addEventListener("visibilitychange",e)},rr=e=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e),document.removeEventListener("visibilitychange",e)},Et=(e,t,n)=>e>0?n>e:t>0,vt=(e,t,n,i,s,r)=>{var a,c;const o=(c=(a=document==null?void 0:document.getElementById)==null?void 0:a.call(document,n))==null?void 0:c.getBoundingClientRect();if(o&&Et(o.top,o.bottom,q())&&Et(o.left,o.right,le())){if(T().sendLatencyMetric({latencyMetricType:ws,placementId:s,placementName:i,placementDivId:n,timestamp:new Date}), __get$(e,r) .loaded){T().sendLatencyMetric({latencyMetricType:dt,placementId:s,placementName:i,placementDivId:n,timestamp:new Date});const l={id:s,name:i};d("adplacements:htmlviewed:loaded:",l),d("adplacements:htmlviewed",l)}t.viewed=!0,rr(t.tracker)}},or=(e,t)=>{if(! __get$(e,t.arid) ){ __set$(e,t.arid,{valid:!1}) ;try{const n= __get$(e,t.arid) ;vt(e,n,t.adUnitPlacementId,t.placementName,t.placementId,t.arid);const i=se(at(20,()=>{vt(e,n,t.adUnitPlacementId,t.placementName,t.placementId,t.arid)}),u);sr(i),n.tracker=i,n.valid=!0}catch(n){throw u("Error initializing viewable latency instrumentation",n),n}}};class ar{constructor(t,n){this.hc=t,this.hmr=n,this.collapsedPlacements=new Set,this.initializeAdMap=(i,s)=>{try{ __set$(this.hc.adMap,i.arid,{messagePort:s}) }catch(r){u("Error creating safeFrame ".concat(i.slotName),r)}},this.secondPhaseLoadAd=async(i,s,r,o)=>{await this.setupMessageChannel(r,s,o)},this.setupMessageChannel=async(i,s,r)=>{V("perf:sf:host","Start setupMessagePort",s),this.initializeAdMap(s,i);const o=this.hc; __set$(o.ADS_HANDLERS,s.arid,__get$(o.ADS_HANDLERS,s.arid)||{}) ;const a=lt(s);nr(a),ir(s,a,r),tr(s),or(o.viewableLatencyTrackers,s);try{nn().is("t1")||await ms(s),cr(o,s,this.hmr)}catch(c){throw a.collapse(s,"HOSTSETUP"),c}}}}const cr=(e,t,n)=>{ __get$(e.adMap,t.arid) .messagePort.onmessage=n.receiveMessage},dr=()=>{const e=new er,t=new Zs(e.adMap),n=yn(t),i=new js(new Ds(t,e),n);return new ar(e,i)},lr=()=>{V("perf:sf:host","initSafeframeHostMobile"),!window.APE_SF&&(V("perf:sf:host","initSafeframeHostMobile init"),window.APE_SF=dr())};se(()=>lr(),u,"Error initializing safeFrame")()})();


/*hammerhead|script|end*/
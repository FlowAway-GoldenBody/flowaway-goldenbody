/*hammerhead|script|start*/if (typeof window !== 'undefined' && window){window['hammerhead|process-dom-method'] && window['hammerhead|process-dom-method']();if (window.__get$ && typeof __get$ === 'undefined')var __get$Loc = window.__get$Loc,__set$Loc = window.__set$Loc,__set$ = window.__set$,__get$ = window.__get$,__call$ = window.__call$,__get$Eval = window.__get$Eval,__proc$Script = window.__proc$Script,__proc$Html = window.__proc$Html,__get$PostMessage = window.__get$PostMessage,__get$ProxyUrl = window.__get$ProxyUrl,__rest$Array = window.__rest$Array,__rest$Object = window.__rest$Object,__arrayFrom$ = window.__arrayFrom$;} else {if (typeof __get$ === 'undefined')var __get$Loc = function(l){return l},__set$Loc = function(l,v){return l = v},__set$ = function(o,p,v){return o[p] = v},__get$ = function(o,p){return o[p]},__call$ = function(o,p,a){return o[p].apply(o,a)},__get$Eval = function(e){return e},__proc$Script = function(s){return s},__proc$Html = function(h){return h},__get$PostMessage = function(w,p){return arguments.length===1?w.postMessage:p},__get$ProxyUrl = function(u,d){return u},__rest$Array = function(a,i){return Array.prototype.slice.call(a, i)},__rest$Object = function(o,p){var k=Object.keys(o),n={};for(var i=0;i<k.length;++i)if(p.indexOf(k[i])<0)n[k[i]]=o[k[i]];return n},__arrayFrom$ = function(r){if(!r)return r;return!Array.isArray(r)&&"function"==typeof r[Symbol.iterator]?Array.from(r):r};if (typeof importScripts !== "undefined" && /\[native code]/g.test(importScripts.toString())) {var __getWorkerSettings$ = function () {return null};importScripts((location.origin || (location.protocol + "//" + location.host)) + "/worker-hammerhead.js");}}/*hammerhead|script|processing-header-end*/
import{a as e,r as t,t as n}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/rolldown-runtime-Cn8xt2Gj.js" ;import{i as r,n as i,r as a,t as o}from "https://beside-powerful-above-recordings.trycloudflare.com:443/d0f884c05d30463bb609a6cb6160f74f!s!utf-8/https://www.chesskid.com/js/client-prod/assets/@amplitude-BlFjiWHL.js" ;var s=n(((e,t)=>{(function(e){function n(e,t){var n=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(n>>16)<<16|n&65535}function r(e,t){return e<<t|e>>>32-t}function i(e,t,i,a,o,s){return n(r(n(n(t,e),n(a,s)),o),i)}function a(e,t,n,r,a,o,s){return i(t&n|~t&r,e,t,a,o,s)}function o(e,t,n,r,a,o,s){return i(t&r|n&~r,e,t,a,o,s)}function s(e,t,n,r,a,o,s){return i(t^n^r,e,t,a,o,s)}function c(e,t,n,r,a,o,s){return i(n^(t|~r),e,t,a,o,s)}function l(e,t){e[t>>5]|=128<<t%32, __set$(e,(t+64>>>9<<4)+14,t) ;var r,i,l,u,d,f=1732584193,p=-271733879,m=-1732584194,h=271733878;for(r=0;r<e.length;r+=16)i=f,l=p,u=m,d=h,f=a(f,p,m,h, __get$(e,r) ,7,-680876936),h=a(h,f,p,m, __get$(e,r+1) ,12,-389564586),m=a(m,h,f,p, __get$(e,r+2) ,17,606105819),p=a(p,m,h,f, __get$(e,r+3) ,22,-1044525330),f=a(f,p,m,h, __get$(e,r+4) ,7,-176418897),h=a(h,f,p,m, __get$(e,r+5) ,12,1200080426),m=a(m,h,f,p, __get$(e,r+6) ,17,-1473231341),p=a(p,m,h,f, __get$(e,r+7) ,22,-45705983),f=a(f,p,m,h, __get$(e,r+8) ,7,1770035416),h=a(h,f,p,m, __get$(e,r+9) ,12,-1958414417),m=a(m,h,f,p, __get$(e,r+10) ,17,-42063),p=a(p,m,h,f, __get$(e,r+11) ,22,-1990404162),f=a(f,p,m,h, __get$(e,r+12) ,7,1804603682),h=a(h,f,p,m, __get$(e,r+13) ,12,-40341101),m=a(m,h,f,p, __get$(e,r+14) ,17,-1502002290),p=a(p,m,h,f, __get$(e,r+15) ,22,1236535329),f=o(f,p,m,h, __get$(e,r+1) ,5,-165796510),h=o(h,f,p,m, __get$(e,r+6) ,9,-1069501632),m=o(m,h,f,p, __get$(e,r+11) ,14,643717713),p=o(p,m,h,f, __get$(e,r) ,20,-373897302),f=o(f,p,m,h, __get$(e,r+5) ,5,-701558691),h=o(h,f,p,m, __get$(e,r+10) ,9,38016083),m=o(m,h,f,p, __get$(e,r+15) ,14,-660478335),p=o(p,m,h,f, __get$(e,r+4) ,20,-405537848),f=o(f,p,m,h, __get$(e,r+9) ,5,568446438),h=o(h,f,p,m, __get$(e,r+14) ,9,-1019803690),m=o(m,h,f,p, __get$(e,r+3) ,14,-187363961),p=o(p,m,h,f, __get$(e,r+8) ,20,1163531501),f=o(f,p,m,h, __get$(e,r+13) ,5,-1444681467),h=o(h,f,p,m, __get$(e,r+2) ,9,-51403784),m=o(m,h,f,p, __get$(e,r+7) ,14,1735328473),p=o(p,m,h,f, __get$(e,r+12) ,20,-1926607734),f=s(f,p,m,h, __get$(e,r+5) ,4,-378558),h=s(h,f,p,m, __get$(e,r+8) ,11,-2022574463),m=s(m,h,f,p, __get$(e,r+11) ,16,1839030562),p=s(p,m,h,f, __get$(e,r+14) ,23,-35309556),f=s(f,p,m,h, __get$(e,r+1) ,4,-1530992060),h=s(h,f,p,m, __get$(e,r+4) ,11,1272893353),m=s(m,h,f,p, __get$(e,r+7) ,16,-155497632),p=s(p,m,h,f, __get$(e,r+10) ,23,-1094730640),f=s(f,p,m,h, __get$(e,r+13) ,4,681279174),h=s(h,f,p,m, __get$(e,r) ,11,-358537222),m=s(m,h,f,p, __get$(e,r+3) ,16,-722521979),p=s(p,m,h,f, __get$(e,r+6) ,23,76029189),f=s(f,p,m,h, __get$(e,r+9) ,4,-640364487),h=s(h,f,p,m, __get$(e,r+12) ,11,-421815835),m=s(m,h,f,p, __get$(e,r+15) ,16,530742520),p=s(p,m,h,f, __get$(e,r+2) ,23,-995338651),f=c(f,p,m,h, __get$(e,r) ,6,-198630844),h=c(h,f,p,m, __get$(e,r+7) ,10,1126891415),m=c(m,h,f,p, __get$(e,r+14) ,15,-1416354905),p=c(p,m,h,f, __get$(e,r+5) ,21,-57434055),f=c(f,p,m,h, __get$(e,r+12) ,6,1700485571),h=c(h,f,p,m, __get$(e,r+3) ,10,-1894986606),m=c(m,h,f,p, __get$(e,r+10) ,15,-1051523),p=c(p,m,h,f, __get$(e,r+1) ,21,-2054922799),f=c(f,p,m,h, __get$(e,r+8) ,6,1873313359),h=c(h,f,p,m, __get$(e,r+15) ,10,-30611744),m=c(m,h,f,p, __get$(e,r+6) ,15,-1560198380),p=c(p,m,h,f, __get$(e,r+13) ,21,1309151649),f=c(f,p,m,h, __get$(e,r+4) ,6,-145523070),h=c(h,f,p,m, __get$(e,r+11) ,10,-1120210379),m=c(m,h,f,p, __get$(e,r+2) ,15,718787259),p=c(p,m,h,f, __get$(e,r+9) ,21,-343485551),f=n(f,i),p=n(p,l),m=n(m,u),h=n(h,d);return[f,p,m,h]}function u(e){var t,n=``,r=e.length*32;for(t=0;t<r;t+=8)n+=String.fromCharCode( __get$(e,t>>5) >>>t%32&255);return n}function d(e){var t,n=[];for( __set$(n,(e.length>>2)-1,void 0) ,t=0;t<n.length;t+=1) __set$(n,t,0) ;var r=e.length*8;for(t=0;t<r;t+=8)n[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32;return n}function f(e){return u(l(d(e),e.length*8))}function p(e,t){var n,r=d(e),i=[],a=[],o;for(i[15]=a[15]=void 0,r.length>16&&(r=l(r,e.length*8)),n=0;n<16;n+=1) __set$(i,n,__get$(r,n)^909522486) , __set$(a,n,__get$(r,n)^1549556828) ;return o=l(i.concat(d(t)),512+t.length*8),u(l(a.concat(o),640))}function m(e){var t=`0123456789abcdef`,n=``,r,i;for(i=0;i<e.length;i+=1)r=e.charCodeAt(i),n+=t.charAt(r>>>4&15)+t.charAt(r&15);return n}function h(e){return unescape(encodeURIComponent(e))}function g(e){return f(h(e))}function ee(e){return m(g(e))}function _(e,t){return p(h(e),h(t))}function te(e,t){return m(_(e,t))}function v(e,t,n){return t?n?_(t,e):te(t,e):n?g(e):ee(e)}typeof define==`function`&&define.amd?define(function(){return v}):typeof t==`object`&&t.exports?t.exports=v:e.md5=v})(e)})),c=`%[a-f0-9]{2}`,l=RegExp(`(`+c+`)|([^%]+?)`,`gi`),u=RegExp(`(`+c+`)+`,`gi`);function d(e,t){try{return[decodeURIComponent(e.join(``))]}catch{}if(e.length===1)return e;t||=1;let n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],d(n),d(r))}function f(e){try{return decodeURIComponent(e)}catch{let t=e.match(l)||[];for(let n=1;n<t.length;n++)e=d(t,n).join(``),t=e.match(l)||[];return e}}function p(e){let t={"%FE%FF":`��`,"%FF%FE":`��`},n=u.exec(e);for(;n;){try{ __set$(t,n[0],decodeURIComponent(n[0])) }catch{let e=f(n[0]);e!==n[0]&&( __set$(t,n[0],e) )}n=u.exec(e)} __set$(t,`%C2`,`�`) ;let r=Object.keys(t);for(let n of r)e= __call$(e,"replace",[new RegExp(n,`g`),__get$(t,n)]) ;return e}function m(e){if(typeof e!=`string`)throw TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return p(e)}}function h(e,t){if(!(typeof e==`string`&&typeof t==`string`))throw TypeError("Expected the arguments to be of type `string`");if(e===``||t===``)return[];let n=e.indexOf(t);return n===-1?[]:[e.slice(0,n),e.slice(n+t.length)]}function g(e,t){let n={};if(Array.isArray(t))for(let r of t){let t=Object.getOwnPropertyDescriptor(e,r);t?.enumerable&&Object.defineProperty(n,r,t)}else for(let r of Reflect.ownKeys(e)){let i=Object.getOwnPropertyDescriptor(e,r);if(i.enumerable){let a= __get$(e,r) ;t(r,a,e)&&Object.defineProperty(n,r,i)}}return n}var ee=t({exclude:()=>me,extract:()=>le,parse:()=>x,parseUrl:()=>de,pick:()=>pe,stringify:()=>ue,stringifyUrl:()=>fe}),_=e=>e==null,te=e=> __call$(encodeURIComponent(e),"replace",[/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`]) ,v=Symbol(`encodeFragmentIdentifier`);function ne(e){switch(e.arrayFormat){case`index`:return t=>(n,r)=>{let i=n.length;return r===void 0||e.skipNull&&r===null||e.skipEmptyString&&r===``?n:r===null?[...n,[y(t,e),`[`,i,`]`].join(``)]:[...n,[y(t,e),`[`,y(i,e),`]=`,y(r,e)].join(``)]};case`bracket`:return t=>(n,r)=>r===void 0||e.skipNull&&r===null||e.skipEmptyString&&r===``?n:r===null?[...n,[y(t,e),`[]`].join(``)]:[...n,[y(t,e),`[]=`,y(r,e)].join(``)];case`colon-list-separator`:return t=>(n,r)=>r===void 0||e.skipNull&&r===null||e.skipEmptyString&&r===``?n:r===null?[...n,[y(t,e),`:list=`].join(``)]:[...n,[y(t,e),`:list=`,y(r,e)].join(``)];case`comma`:case`separator`:case`bracket-separator`:{let t=e.arrayFormat===`bracket-separator`?`[]=`:`=`;return n=>(r,i)=>i===void 0||e.skipNull&&i===null||e.skipEmptyString&&i===``?r:(i=i===null?``:i,r.length===0?[[y(n,e),t,y(i,e)].join(``)]:[[r,y(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,r)=>r===void 0||e.skipNull&&r===null||e.skipEmptyString&&r===``?n:r===null?[...n,y(t,e)]:[...n,[y(t,e),`=`,y(r,e)].join(``)]}}function re(e){let t;switch(e.arrayFormat){case`index`:return(e,n,r)=>{if(t=/\[(\d*)]$/.exec(e),e= __call$(e,"replace",[/\[\d*]$/,``]) ,!t){ __set$(r,e,n) ;return} __get$(r,e) ===void 0&&( __set$(r,e,{}) ), __set$(__get$(r,e),t[1],n) };case`bracket`:return(e,n,r)=>{if(t=/(\[])$/.exec(e),e= __call$(e,"replace",[/\[]$/,``]) ,!t){ __set$(r,e,n) ;return}if( __get$(r,e) ===void 0){ __set$(r,e,[n]) ;return} __set$(r,e,[...__get$(r,e),n]) };case`colon-list-separator`:return(e,n,r)=>{if(t=/(:list)$/.exec(e),e= __call$(e,"replace",[/:list$/,``]) ,!t){ __set$(r,e,n) ;return}if( __get$(r,e) ===void 0){ __set$(r,e,[n]) ;return} __set$(r,e,[...__get$(r,e),n]) };case`comma`:case`separator`:return(t,n,r)=>{let i=typeof n==`string`&&n.includes(e.arrayFormatSeparator),a=typeof n==`string`&&!i&&b(n,e).includes(e.arrayFormatSeparator);n=a?b(n,e):n, __set$(r,t,i||a?n.split(e.arrayFormatSeparator).map(t=>b(t,e)):n===null?n:b(n,e)) };case`bracket-separator`:return(t,n,r)=>{let i=/(\[])$/.test(t);if(t= __call$(t,"replace",[/\[]$/,``]) ,!i){ __set$(r,t,n&&b(n,e)) ;return}let a=n===null?[]:n.split(e.arrayFormatSeparator).map(t=>b(t,e));if( __get$(r,t) ===void 0){ __set$(r,t,a) ;return} __set$(r,t,[...__get$(r,t),...a]) };default:return(e,t,n)=>{if( __get$(n,e) ===void 0){ __set$(n,e,t) ;return} __set$(n,e,[...[__get$(n,e)].flat(),t]) }}}function ie(e){if(typeof e!=`string`||e.length!==1)throw TypeError(`arrayFormatSeparator must be single character string`)}function y(e,t){return t.encode?t.strict?te(e):encodeURIComponent(e):e}function b(e,t){return t.decode?m(e):e}function ae(e){return Array.isArray(e)?e.sort():typeof e==`object`?ae(Object.keys(e)).sort((e,t)=>Number(e)-Number(t)).map(t=> __get$(e,t) ):e}function oe(e){let t=e.indexOf(`#`);return t!==-1&&(e=e.slice(0,t)),e}function se(e){let t=``,n=e.indexOf(`#`);return n!==-1&&(t=e.slice(n)),t}function ce(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&typeof e==`string`&&e.trim()!==``?e=Number(e):t.parseBooleans&&e!==null&&(e.toLowerCase()===`true`||e.toLowerCase()===`false`)&&(e=e.toLowerCase()===`true`),e}function le(e){e=oe(e);let t=e.indexOf(`?`);return t===-1?``:e.slice(t+1)}function x(e,t){t={decode:!0,sort:!0,arrayFormat:`none`,arrayFormatSeparator:`,`,parseNumbers:!1,parseBooleans:!1,...t},ie(t.arrayFormatSeparator);let n=re(t),r=Object.create(null);if(typeof e!=`string`||(e= __call$(e.trim(),"replace",[/^[?#&]/,``]) ,!e))return r;for(let i of e.split(`&`)){if(i===``)continue; let e=t.decode?__call$(i,"replace",[/\+/g,` `]):i,_hh$temp0=__arrayFrom$(h(e,`=`)),a=_hh$temp0[0],o=_hh$temp0[1]; a===void 0&&(a=e),o=o===void 0?null:[`comma`,`separator`,`bracket-separator`].includes(t.arrayFormat)?o:b(o,t),n(b(a,t),o,r)}for(let _hh$temp1 of Object.entries(r)) {let _hh$temp2=__arrayFrom$(_hh$temp1),e=_hh$temp2[0],n=_hh$temp2[1];if(typeof n==`object`&&n)for(let _hh$temp3 of Object.entries(n)){let _hh$temp4=__arrayFrom$(_hh$temp3),e=_hh$temp4[0],r=_hh$temp4[1];__set$(n,e,ce(r,t));}else __set$(r,e,ce(n,t));} return t.sort===!1?r:(t.sort===!0?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce((e,t)=>{let n= __get$(r,t) ;return n&&typeof n==`object`&&!Array.isArray(n)? __set$(e,t,ae(n)) : __set$(e,t,n) ,e},Object.create(null))}function ue(e,t){if(!e)return``;t={encode:!0,strict:!0,arrayFormat:`none`,arrayFormatSeparator:`,`,...t},ie(t.arrayFormatSeparator);let n=n=>t.skipNull&&_( __get$(e,n) )||t.skipEmptyString&& __get$(e,n) ===``,r=ne(t),i={};for(let _hh$temp5 of Object.entries(e)) {let _hh$temp6=__arrayFrom$(_hh$temp5),t=_hh$temp6[0],r=_hh$temp6[1];n(t)||__set$(i,t,r);} let a=Object.keys(i);return t.sort!==!1&&a.sort(t.sort),a.map(n=>{let i= __get$(e,n) ;return i===void 0?``:i===null?y(n,t):Array.isArray(i)?i.length===0&&t.arrayFormat===`bracket-separator`?y(n,t)+`[]`:i.reduce(r(n),[]).join(`&`):y(n,t)+`=`+y(i,t)}).filter(e=>e.length>0).join(`&`)}function de(e,t){t={decode:!0,...t}; let _hh$temp7=__arrayFrom$(h(e,`#`)),n=_hh$temp7[0],r=_hh$temp7[1]; return n===void 0&&(n=e),{url:n?.split(`?`)?.[0]??``,query:x(le(e),t),...t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:b(r,t)}:{}}}function fe(e,t){t={encode:!0,strict:!0,[v]:!0,...t};let n=oe(e.url).split(`?`)[0]||``,r=ue({...x(le(e.url),{sort:!1}),...e.query},t);r&&=`?${r}`;let i=se(e.url);if(e.fragmentIdentifier){let r=new URL(n);r.hash=e.fragmentIdentifier,i= __get$(t,v) ?r.hash:`#${e.fragmentIdentifier}`}return`${n}${r}${i}`}function pe(e,t,n){n={parseFragmentIdentifier:!0,[v]:!1,...n}; let _hh$temp8=de(e,n),r=_hh$temp8.url,i=_hh$temp8.query,a=_hh$temp8.fragmentIdentifier; return fe({url:r,query:g(i,t),fragmentIdentifier:a},n)}function me(e,t,n){return pe(e,Array.isArray(t)?e=>!t.includes(e):(e,n)=>!t(e,n),n)}var S=ee,he=e(s()),ge=e(i());function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n= __get$(arguments,t) ==null?{}: __get$(arguments,t) ;t%2?_e(Object(n),!0).forEach(function(t){w(e,t, __get$(n,t) )}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ve(e){"@babel/helpers - typeof";return ve=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e},ve(e)}function ye(e,t){if(!(e instanceof t))throw TypeError(`Cannot call a class as a function`)}function be(e,t){for(var n=0;n<t.length;n++){var r= __get$(t,n) ;r.enumerable=r.enumerable||!1,r.configurable=!0,`value`in r&&(r.writable=!0),Object.defineProperty(e,Ae(r.key),r)}}function xe(e,t,n){return t&&be(e.prototype,t),n&&be(e,n),Object.defineProperty(e,`prototype`,{writable:!1}),e}function w(e,t,n){return t=Ae(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}): __set$(e,t,n) ,e}function Se(e){return Ce(e)||we(e)||Te(e)||De()}function Ce(e){if(Array.isArray(e))return Ee(e)}function we(e){if(typeof Symbol<`u`&& __get$(e,Symbol.iterator) !=null|| __get$(e,`@@iterator`) !=null)return Array.from(e)}function Te(e,t){if(e){if(typeof e==`string`)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`)return Array.from(e);if(n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}}function Ee(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++) __set$(r,n,__get$(e,n)) ;return r}function De(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oe(e,t){var n=typeof Symbol<`u`&& __get$(e,Symbol.iterator) || __get$(e,`@@iterator`) ;if(!n){if(Array.isArray(e)||(n=Te(e))||t&&e&&typeof e.length==`number`){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value: __get$(e,r++) }},e:function(e){throw e},f:i}}throw TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function ke(e,t){if(typeof e!=`object`||!e)return e;var n= __get$(e,Symbol.toPrimitive) ;if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function Ae(e){var t=ke(e,`string`);return typeof t==`symbol`?t:String(t)}var T={DEFAULT_INSTANCE:`$default_instance`,API_VERSION:2,MAX_STRING_LENGTH:4096,MAX_PROPERTY_KEYS:1e3,IDENTIFY_EVENT:`$identify`,GROUP_IDENTIFY_EVENT:`$groupidentify`,EVENT_LOG_URL:`api.amplitude.com`,EVENT_LOG_EU_URL:`api.eu.amplitude.com`,DYNAMIC_CONFIG_URL:`regionconfig.amplitude.com`,DYNAMIC_CONFIG_EU_URL:`regionconfig.eu.amplitude.com`,LAST_EVENT_ID:`amplitude_lastEventId`,LAST_EVENT_TIME:`amplitude_lastEventTime`,LAST_IDENTIFY_ID:`amplitude_lastIdentifyId`,LAST_SEQUENCE_NUMBER:`amplitude_lastSequenceNumber`,SESSION_ID:`amplitude_sessionId`,DEVICE_ID:`amplitude_deviceId`,OPT_OUT:`amplitude_optOut`,USER_ID:`amplitude_userId`,DEVICE_ID_INDEX:0,USER_ID_INDEX:1,OPT_OUT_INDEX:2,SESSION_ID_INDEX:3,LAST_EVENT_TIME_INDEX:4,EVENT_ID_INDEX:5,IDENTIFY_ID_INDEX:6,SEQUENCE_NUMBER_INDEX:7,COOKIE_TEST_PREFIX:`amp_cookie_test`,COOKIE_PREFIX:`amp`,STORAGE_DEFAULT:``,STORAGE_COOKIES:`cookies`,STORAGE_NONE:`none`,STORAGE_LOCAL:`localStorage`,STORAGE_SESSION:`sessionStorage`,REVENUE_EVENT:`revenue_amount`,REVENUE_PRODUCT_ID:`$productId`,REVENUE_QUANTITY:`$quantity`,REVENUE_PRICE:`$price`,REVENUE_REVENUE_TYPE:`$revenueType`,AMP_DEVICE_ID_PARAM:`amp_device_id`,AMP_REFERRER_PARAM:`amp_referrer`,REFERRER:`referrer`,REFERRING_DOMAIN:`referring_domain`,UTM_SOURCE:`utm_source`,UTM_MEDIUM:`utm_medium`,UTM_CAMPAIGN:`utm_campaign`,UTM_TERM:`utm_term`,UTM_CONTENT:`utm_content`,ATTRIBUTION_EVENT:`[Amplitude] Attribution Captured`,TRANSPORT_HTTP:`http`,TRANSPORT_BEACON:`beacon`},je={encode:function(e){for(var t=``,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},decode:function(e){for(var t=``,n=0,r=0,i=0,a=0;n<e.length;)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(i=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|i&63),n+=2):(i=e.charCodeAt(n+1),a=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63),n+=3);return t}},E=function(){if(typeof globalThis<`u`)return globalThis;if(typeof window<`u`)return window;if(typeof self<`u`)return self;if(typeof global<`u`)return global}(),D={_keyStr:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=`,encode:function(e){try{if(E.btoa&&E.atob)return E.btoa(unescape(encodeURIComponent(e)))}catch{}return D._encode(e)},_encode:function(e){var t=``,n,r,i,a,o,s,c,l=0;for(e=je.encode(e);l<e.length;)n=e.charCodeAt(l++),r=e.charCodeAt(l++),i=e.charCodeAt(l++),a=n>>2,o=(n&3)<<4|r>>4,s=(r&15)<<2|i>>6,c=i&63,isNaN(r)?s=c=64:isNaN(i)&&(c=64),t=t+D._keyStr.charAt(a)+D._keyStr.charAt(o)+D._keyStr.charAt(s)+D._keyStr.charAt(c);return t},decode:function(e){try{if(E.btoa&&E.atob)return decodeURIComponent(escape(E.atob(e)))}catch{}return D._decode(e)},_decode:function(e){var t=``,n,r,i,a,o,s,c,l=0;for(e= __call$(e,"replace",[/[^A-Za-z0-9+/=]/g,``]) ;l<e.length;)a=D._keyStr.indexOf(e.charAt(l++)),o=D._keyStr.indexOf(e.charAt(l++)),s=D._keyStr.indexOf(e.charAt(l++)),c=D._keyStr.indexOf(e.charAt(l++)),n=a<<2|o>>4,r=(o&15)<<4|s>>2,i=(s&3)<<6|c,t+=String.fromCharCode(n),s!==64&&(t+=String.fromCharCode(r)),c!==64&&(t+=String.fromCharCode(i));return t=je.decode(t),t}},Me=Object.prototype.toString;function O(e){switch(Me.call(e)){case`[object Date]`:return`date`;case`[object RegExp]`:return`regexp`;case`[object Arguments]`:return`arguments`;case`[object Array]`:return`array`;case`[object Error]`:return`error`}return e===null?`null`:e===void 0?`undefined`:e===e?e&&e.nodeType===1?`element`:typeof Buffer<`u`&&typeof Buffer.isBuffer==`function`&&Buffer.isBuffer(e)?`buffer`:(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e),ve(e)):`nan`}var k={DISABLE:0,ERROR:1,WARN:2,INFO:3},A=k.WARN,Ne=function(e){Object.prototype.hasOwnProperty.call(k,e)&&(A= __get$(k,e) )},Pe=function(){return A},j={error:function(e){A>=k.ERROR&&Fe(e)},warn:function(e){A>=k.WARN&&Fe(e)},info:function(e){A>=k.INFO&&Fe(e)}},Fe=function(e){try{console.log(`[Amplitude] `+e)}catch{}},Ie=function(e){return!e||e.length===0},Le=function(){try{if(E.sessionStorage)return!0}catch{}return!1},Re=function e(t){if(O(t)===`array`)for(var n=0;n<t.length;n++) __set$(t,n,e(__get$(t,n))) ;else if(O(t)===`object`)for(var r in t)r in t&&( __set$(t,r,e(__get$(t,r))) );else t=ze(t);return t},ze=function(e){return O(e)===`string`&&e.length>T.MAX_STRING_LENGTH?e.substring(0,T.MAX_STRING_LENGTH):e},M=function(e,t,n){return O(e)===n?!0:(j.error(`Invalid `+t+` input type. Expected `+n+` but received `+O(e)),!1)},Be=function(e){return M(e,`deviceId`,`string`)?e.indexOf(`.`)>=0?(j.error(`Device IDs may not contain '.' characters. Value will be ignored: "${e}"`),!1):!0:!1},Ve=function(e){return M(e,`transport`,`string`)?e!==T.TRANSPORT_HTTP&&e!==T.TRANSPORT_BEACON?(j.error(`transport value must be one of '${T.TRANSPORT_BEACON}' or '${T.TRANSPORT_HTTP}'`),!1):e!==T.TRANSPORT_HTTP&&typeof navigator<`u`&&!navigator.sendBeacon?(j.error(`browser does not support sendBeacon, so transport must be HTTP`),!1):!0:!1},He=function(e){var t=O(e);if(t!==`object`)return j.error(`Error: invalid properties format. Expecting Javascript object, received `+t+`, ignoring`),{};if(Object.keys(e).length>T.MAX_PROPERTY_KEYS)return j.error(`Error: too many properties (more than 1000), ignoring`),{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=r,a=O(i);a!==`string`&&(i=String(i),j.warn(`WARNING: Non-string property key, received type `+a+`, coercing to string "`+i+`"`));var o=We(i, __get$(e,r) );o!==null&&( __set$(n,i,o) )}return n},Ue=[`nan`,`function`,`arguments`,`regexp`,`element`],We=function e(t,n){var r=O(n);if(Ue.indexOf(r)!==-1)j.warn(`WARNING: Property key "`+t+`" with invalid value type `+r+`, ignoring`),n=null;else if(r===`undefined`)n=null;else if(r===`error`)n=String(n),j.warn(`WARNING: Property key "`+t+`" with value type error, coercing to `+n);else if(r===`array`){for(var i=[],a=0;a<n.length;a++){var o= __get$(n,a) ,s=O(o);if(s===`array`){j.warn(`WARNING: Cannot have `+s+` nested in an array property value, skipping`);continue}else s===`object`?i.push(He(o)):i.push(e(t,o))}n=i}else r===`object`&&(n=He(n));return n},Ge=function(e){var t=O(e);if(t!==`object`)return j.error(`Error: invalid groups format. Expecting Javascript object, received `+t+`, ignoring`),{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=r,a=O(i);a!==`string`&&(i=String(i),j.warn(`WARNING: Non-string groupType, received type `+a+`, coercing to string "`+i+`"`));var o=Ke(i, __get$(e,r) );o!==null&&( __set$(n,i,o) )}return n},Ke=function(e,t){var n=O(t);if(n===`string`)return t;if(n===`date`||n===`number`||n===`boolean`)return t=String(t),j.warn(`WARNING: Non-string groupName, received type `+n+`, coercing to string "`+t+`"`),t;if(n===`array`){for(var r=[],i=0;i<t.length;i++){var a= __get$(t,i) ,o=O(a);if(o===`array`||o===`object`){j.warn(`WARNING: Skipping nested `+o+` in array groupName`);continue}else o===`string`?r.push(a):(o===`date`||o===`number`||o===`boolean`)&&(a=String(a),j.warn(`WARNING: Non-string groupName, received type `+o+`, coercing to string "`+a+`"`),r.push(a))}return r}j.warn(`WARNING: Non-string groupName, received type `+n+`. Please use strings or array of strings for groupName`)},N={setLogLevel:Ne,getLogLevel:Pe,logLevels:k,log:j,isEmptyString:Ie,isWebWorkerEnvironment:function(){return typeof WorkerGlobalScope<`u`},getQueryParam:function(e,t){e= __call$(__call$(e,"replace",[/[[]/,`\\[`]),"replace",[/[\]]/,`\\]`]) ;var n=RegExp(`[\\?&]`+e+`=([^&#]*)`).exec(t);return n===null?void 0:decodeURIComponent( __call$(n[1],"replace",[/\+/g,` `]) )},sessionStorageEnabled:Le,truncate:Re,validateGroups:Ge,validateInput:M,validateProperties:He,validateDeviceId:Be,validateTransport:Ve,validateSessionId:function(e){return M(e,`sessionId`,`number`)&&new Date(e).getTime()>0?!0:(j.error(`sessionId value must in milliseconds since epoch (Unix Timestamp)`),!1)},getLocation:function(){return  __get$(E,"location") },getHost:function(e){var t= __get$(E,"location") ? __get$(E,"location") .hostname:``;if(e){if(typeof document<`u`){var n=document.createElement(`a`);return  __set$(n,"href",e) ,n.hostname||t}if(typeof URL==`function`)return new URL(e).hostname||t}return t}},qe=function(e){try{for(var t=document.cookie.split(`;`),n=null,r=0;r<t.length;r++){for(var i= __get$(t,r) ;i.charAt(0)===` `;)i=i.substring(1,i.length);if(i.indexOf(e)===0){n=i.substring(e.length,i.length);break}}return n}catch{return null}},Je=function(e){try{var t=document.cookie.split(`;`).map(function(e){return e.trimStart()}),n=[],r=Oe(t),i;try{for(r.s();!(i=r.n()).done;){for(var a=i.value;a.charAt(0)===` `;)a=a.substring(1);a.indexOf(e)===0&&n.push(a.substring(e.length))}}catch(e){r.e(e)}finally{r.f()}return n}catch{return[]}},Ye=function(e,t,n){var r=t===null?-1:n.expirationDays;if(r){var i=new Date;i.setTime(i.getTime()+r*24*60*60*1e3),r=i}var a=e+`=`+t;r&&(a+=`; expires=`+r.toUTCString()),a+=`; path=/`,n.domain&&(a+=`; domain=`+n.domain),n.secure&&(a+=`; Secure`),n.sameSite&&(a+=`; SameSite=`+n.sameSite),document.cookie=a},Xe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:``,t= __get$(e.split(`.`),T.LAST_EVENT_TIME_INDEX) ,n;return t&&(n=parseInt(t,32)),n||(N.log.warn(`unable to parse malformed cookie: ${e}`),0)},P={set:Ye,get:qe,getAll:Je,getLastEventTime:Xe,sortByEventTime:function(e){return Se(e).sort(function(e,t){var n=Xe(e);return Xe(t)-n})},areCookiesEnabled:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=T.COOKIE_TEST_PREFIX;if(typeof document>`u`)return!1;var n=!1;try{var r=String(Date.now());Ye(t,r,e),N.log.info(`Testing if cookies available`),n=qe(t+`=`)===r}catch(e){N.log.warn(`Error thrown when checking for cookies. Reason: "${e}"`)}finally{N.log.info(`Cleaning up cookies availability test`),Ye(t,null,e)}return n}},Ze=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_`,F=function(){for(var e=``,t=0;t<22;++t)e+=Ze.charAt(Math.floor(Math.random()*64));return e},Qe=function(e){var t=N.getHost(e).split(`.`),n=[],r=`_tldtest_`+F();if(N.isWebWorkerEnvironment())return``;for(var i=t.length-2;i>=0;--i)n.push(t.slice(i).join(`.`));for(var a=0;a<n.length;++a){var o= __get$(n,a) ,s={domain:`.`+o};if(P.set(r,1,s),P.get(r))return P.set(r,null,s),o}return``},I={expirationDays:void 0,domain:void 0},$e=function(){I={expirationDays:void 0,domain:void 0}},et=function(e){if(arguments.length===0)return I;e||={},I.expirationDays=e.expirationDays,I.secure=e.secure,I.sameSite=e.sameSite;var t=N.isEmptyString(e.domain)?`.`+Qe( __get$(N.getLocation(),"href") ):e.domain,n=Math.random();I.domain=t,nt(`amplitude_test`,n);var r=tt(`amplitude_test`);return(!r||r!==n)&&(t=null),at(`amplitude_test`),I.domain=t,I},L=function(e){var t=``;return I.domain&&(t=I.domain.charAt(0)===`.`?I.domain.substring(1):I.domain),e+t},tt=function(e){var t=L(e)+`=`,n=P.get(t);try{if(n)return JSON.parse(D.decode(n))}catch{return null}return null},nt=function(e,t){try{return P.set(L(e),D.encode(JSON.stringify(t)),I),!0}catch{return!1}},rt=function(e,t){try{return P.set(L(e),t,I),!0}catch{return!1}},it=function(e){var t=L(e)+`=`;return P.get(t)},at=function(e){try{return P.set(L(e),null,I),!0}catch{return!1}},ot={reset:$e,options:et,get:tt,set:nt,remove:at,setRaw:rt,getRaw:it},st=function(){function e(){ye(this,e),this.map=new Map,this.length=0}return xe(e,[{key:`key`,value:function(e){var t= __get$(Array.from(this.map.keys()),e) ;return this.map.get(t)}},{key:`getItem`,value:function(e){return this.map.get(e)}},{key:`setItem`,value:function(e,t){this.map.has(e)||(this.length+=1),this.map.set(e,t)}},{key:`removeItem`,value:function(e){this.map.has(e)&&(--this.length,this.map.delete(e))}},{key:`clear`,value:function(){this.map.clear(),this.length=0}}]),e}(),R;if(function(){var e=new Date,t;try{return E.localStorage.setItem(e,e),t=E.localStorage.getItem(e)===String(e),E.localStorage.removeItem(e),t}catch{}return!1}())R=E.localStorage;else if(E!==void 0&&E.globalStorage)try{R= __get$(E.globalStorage,__get$(E,"location").hostname) }catch{}else if(typeof document<`u`){var z=document.createElement(`div`),B=`localStorage`;z.style.display=`none`,document.getElementsByTagName(`head`)[0].appendChild(z),z.addBehavior&&(z.addBehavior(`#default#userdata`),R={length:0,setItem:function(e,t){z.load(B),z.getAttribute(e)||this.length++,z.setAttribute(e,t),z.save(B)},getItem:function(e){return z.load(B),z.getAttribute(e)},removeItem:function(e){z.load(B),z.getAttribute(e)&&this.length--,z.removeAttribute(e),z.save(B)},clear:function(){z.load(B);for(var e=0,t;t= __get$(z.XMLDocument.documentElement.attributes,e++) ;)z.removeAttribute(t.name);z.save(B),this.length=0},key:function(e){return z.load(B), __get$(z.XMLDocument.documentElement.attributes,e) }},z.load(B),R.length=z.XMLDocument.documentElement.attributes.length)}else N.isWebWorkerEnvironment()&&(R=new st);R||={length:0,setItem:function(e,t){},getItem:function(e){},removeItem:function(e){},clear:function(){},key:function(e){}};var V=R,ct=function(){this.storage=null};ct.prototype.getStorage=function(e){if(this.storage!==null)return this.storage;if(!e&&P.areCookiesEnabled())this.storage=ot;else{var t=`amp_cookiestore_`;this.storage={_options:{expirationDays:void 0,domain:void 0,secure:!1},reset:function(){this._options={expirationDays:void 0,domain:void 0,secure:!1}},options:function(e){return arguments.length===0?this._options:(e||={},this._options.expirationDays=e.expirationDays||this._options.expirationDays,this._options.domain=e.domain||this._options.domain||E&& __get$(E,"location") && __get$(E,"location") .hostname,this._options.secure=e.secure||!1)},get:function(e){try{return JSON.parse(V.getItem(t+e))}catch{}return null},set:function(e,n){try{return V.setItem(t+e,JSON.stringify(n)),!0}catch{}return!1},remove:function(e){try{V.removeItem(t+e)}catch{return!1}}}}return this.storage};var H,lt=(H={},w(H,T.STORAGE_COOKIES,!0),w(H,T.STORAGE_NONE,!0),w(H,T.STORAGE_LOCAL,!0),w(H,T.STORAGE_SESSION,!0),H),ut=function(){function e(t){var n=t.storageKey,r=t.disableCookies,i=t.domain,a=t.secure,o=t.sameSite,s=t.expirationDays,c=t.storage;ye(this,e),this.storageKey=n,this.domain=i,this.secure=a,this.sameSite=o,this.expirationDays=s,this.cookieDomain=``;var l=N.getLocation()? __get$(N.getLocation(),"href") :void 0,u=r?``:Qe(l);this.cookieDomain=i||(u?`.`+u:null), __get$(lt,c) ?this.storage=c:r||!P.areCookiesEnabled({domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays})?this.storage=T.STORAGE_LOCAL:this.storage=T.STORAGE_COOKIES}return xe(e,[{key:`getCookieStorageKey`,value:function(){if(!this.domain)return this.storageKey;var e=this.domain.charAt(0)===`.`?this.domain.substring(1):this.domain;return`${this.storageKey}${e?`_${e}`:``}`}},{key:`save`,value:function(e){var t=e.deviceId,n=e.userId,r=e.optOut,i=e.sessionId,a=e.lastEventTime,o=e.eventId,s=e.identifyId,c=e.sequenceNumber;if(this.storage!==T.STORAGE_NONE){var l=[t,D.encode(n||``),r?`1`:``,i?i.toString(32):`0`,a?a.toString(32):`0`,o?o.toString(32):`0`,s?s.toString(32):`0`,c?c.toString(32):`0`].join(`.`);switch(this.storage){case T.STORAGE_SESSION:E.sessionStorage&&E.sessionStorage.setItem(this.storageKey,l);break;case T.STORAGE_LOCAL:V.setItem(this.storageKey,l);break;case T.STORAGE_COOKIES:this.saveCookie(l);break}}}},{key:`saveCookie`,value:function(e){P.set(this.getCookieStorageKey(),e,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays})}},{key:`load`,value:function(){var e=this,t;if(this.storage===T.STORAGE_COOKIES){var n=this.getCookieStorageKey()+`=`,r=P.getAll(n);if(r.length===0||r.length===1)t=r[0];else{var i=P.sortByEventTime(r)[0];r.forEach(function(){return P.set(e.getCookieStorageKey(),null,{})}),this.saveCookie(i),t=P.get(n)}}if(t||=V.getItem(this.storageKey),!t)try{t=E.sessionStorage&&E.sessionStorage.getItem(this.storageKey)}catch(e){N.log.info(`window.sessionStorage unavailable. Reason: "${e}"`)}if(!t)return null;var a=t.split(`.`),o=null;if( __get$(a,T.USER_ID_INDEX) )try{o=D.decode( __get$(a,T.USER_ID_INDEX) )}catch{o=null}return{deviceId: __get$(a,T.DEVICE_ID_INDEX) ,userId:o,optOut: __get$(a,T.OPT_OUT_INDEX) ===`1`,sessionId:parseInt( __get$(a,T.SESSION_ID_INDEX) ,32),lastEventTime:parseInt( __get$(a,T.LAST_EVENT_TIME_INDEX) ,32),eventId:parseInt( __get$(a,T.EVENT_ID_INDEX) ,32),identifyId:parseInt( __get$(a,T.IDENTIFY_ID_INDEX) ,32),sequenceNumber:parseInt( __get$(a,T.SEQUENCE_NUMBER_INDEX) ,32)}}},{key:`clear`,value:function(){var e;if(this.storage===T.STORAGE_COOKIES&&(e=P.get(this.getCookieStorageKey()+`=`),P.set(this.getCookieStorageKey(),null,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:0})),e||(e=V.getItem(this.storageKey),V.clear()),!e)try{e=E.sessionStorage&&E.sessionStorage.getItem(this.storageKey),E.sessionStorage.clear()}catch(e){N.log.info(`window.sessionStorage unavailable. Reason: "${e}"`)}return!!e}}]),e}(),dt=function(e,t){var n=e?`?`+ __call$(e.split(`.`).slice(-1)[0],"replace",[/\|/g,`&`]) :``,r=function(e,t,n,r){return N.getQueryParam(e,t)||N.getQueryParam(n,r)},i=r(T.UTM_SOURCE,t,`utmcsr`,n),a=r(T.UTM_MEDIUM,t,`utmcmd`,n),o=r(T.UTM_CAMPAIGN,t,`utmccn`,n),s=r(T.UTM_TERM,t,`utmctr`,n),c=r(T.UTM_CONTENT,t,`utmcct`,n),l={},u=function(e,t){N.isEmptyString(t)||( __set$(l,e,t) )};return u(T.UTM_SOURCE,i),u(T.UTM_MEDIUM,a),u(T.UTM_CAMPAIGN,o),u(T.UTM_TERM,s),u(T.UTM_CONTENT,c),l},ft=`$add`,pt=`$append`,mt=`$clearAll`,ht=`$prepend`,gt=`$set`,_t=`$setOnce`,vt=`$unset`,yt=`$preInsert`,bt=`$postInsert`,xt=`$remove`,U=function(){this.userPropertiesOperations={},this.properties=[]};U.prototype.add=function(e,t){return O(t)===`number`||O(t)===`string`?this._addOperation(ft,e,t):N.log.error(`Unsupported type for value: `+O(t)+`, expecting number or string`),this},U.prototype.append=function(e,t){return this._addOperation(pt,e,t),this},U.prototype.clearAll=function(){return Object.keys(this.userPropertiesOperations).length>0?(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,mt)||N.log.error(`Need to send $clearAll on its own Identify object without any other operations, skipping $clearAll`),this):( __set$(this.userPropertiesOperations,mt,`-`) ,this)},U.prototype.prepend=function(e,t){return this._addOperation(ht,e,t),this},U.prototype.set=function(e,t){return this._addOperation(gt,e,t),this},U.prototype.setOnce=function(e,t){return this._addOperation(_t,e,t),this},U.prototype.unset=function(e){return this._addOperation(vt,e,`-`),this},U.prototype.preInsert=function(e,t){return this._addOperation(yt,e,t),this},U.prototype.postInsert=function(e,t){return this._addOperation(bt,e,t),this},U.prototype.remove=function(e,t){return this._addOperation(xt,e,t),this},U.prototype._addOperation=function(e,t,n){if(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,mt)){N.log.error(`This identify already contains a $clearAll operation, skipping operation `+e);return}if(this.properties.indexOf(t)!==-1){N.log.error(`User property "`+t+`" already used in this identify, skipping operation `+e);return}Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,e)||( __set$(this.userPropertiesOperations,e,{}) ), __set$(__get$(this.userPropertiesOperations,e),t,n) ,this.properties.push(t)};var St=function(e,t,n){this.url=e,this.data=t||{},this.headers=n},Ct=`Cross-Origin-Resource-Policy`;function wt(e,t){for(var n in t)n===Ct&&! __get$(t,n) ||e.setRequestHeader(n, __get$(t,n) )}St.prototype.send=function(e){if(E.XDomainRequest){var t=new E.XDomainRequest;t.open(`POST`,this.url,!0),t.onload=function(){e(200,t.responseText)},t.onerror=function(){t.responseText===`Request Entity Too Large`?e(413,t.responseText):e(500,t.responseText)},t.ontimeout=function(){},t.onprogress=function(){},t.send(S.stringify(this.data))}else if(typeof XMLHttpRequest<`u`){var n=new XMLHttpRequest;n.open(`POST`,this.url,!0),n.onreadystatechange=function(){n.readyState===4&&e(n.status,n.responseText)},wt(n,this.headers),n.send(S.stringify(this.data))}else{var r=void 0;fetch(this.url,{method:`POST`,headers:this.headers,body:S.stringify(this.data)}).then(function(e){return r=e.status,e.text()}).then(function(t){e(r,t)})}};var W=function(){this._price=null,this._productId=null,this._quantity=1,this._revenueType=null,this._properties=null};W.prototype.setProductId=function(e){return O(e)===`string`?N.isEmptyString(e)?N.log.error(`Invalid empty productId`):this._productId=e:N.log.error(`Unsupported type for productId: `+O(e)+`, expecting string`),this},W.prototype.setQuantity=function(e){return O(e)===`number`?this._quantity=parseInt(e):N.log.error(`Unsupported type for quantity: `+O(e)+`, expecting number`),this},W.prototype.setPrice=function(e){return O(e)===`number`?this._price=e:N.log.error(`Unsupported type for price: `+O(e)+`, expecting number`),this},W.prototype.setRevenueType=function(e){return O(e)===`string`?this._revenueType=e:N.log.error(`Unsupported type for revenueType: `+O(e)+`, expecting string`),this},W.prototype.setEventProperties=function(e){return O(e)===`object`?this._properties=N.validateProperties(e):N.log.error(`Unsupported type for eventProperties: `+O(e)+`, expecting object`),this},W.prototype._isValidRevenue=function(){return O(this._price)===`number`?!0:(N.log.error(`Invalid revenue, need to set price field`),!1)},W.prototype._toJSONObject=function(){var e=O(this._properties)===`object`?this._properties:{};return this._productId!==null&&( __set$(e,T.REVENUE_PRODUCT_ID,this._productId) ),this._quantity!==null&&( __set$(e,T.REVENUE_QUANTITY,this._quantity) ),this._price!==null&&( __set$(e,T.REVENUE_PRICE,this._price) ),this._revenueType!==null&&( __set$(e,T.REVENUE_REVENUE_TYPE,this._revenueType) ),e};var Tt=function e(t){return t?(t^Math.random()*16>>t/4).toString(16): __call$(`10000000-1000-4000-8000-100000000000`,"replace",[/[018]/g,e]) },Et={getLanguage:function(){return typeof navigator<`u`&&(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage)||``}},G={US:`US`,EU:`EU`},Dt=function(e){var t=T.EVENT_LOG_URL;switch(e){case G.EU:t=T.EVENT_LOG_EU_URL;break;case G.US:t=T.EVENT_LOG_URL;break}return t},Ot=function(e){var t=T.DYNAMIC_CONFIG_URL;switch(e){case G.EU:t=T.DYNAMIC_CONFIG_EU_URL;break;case G.US:t=T.DYNAMIC_CONFIG_URL;break}return t},kt=`8.21.9`,K={apiEndpoint:T.EVENT_LOG_URL,batchEvents:!1,cookieExpiration:365,cookieName:`amplitude_id`,sameSiteCookie:`Lax`,cookieForceUpgrade:!1,deferInitialization:!1,disableCookies:!1,deviceIdFromUrlParam:!1,domain:``,eventUploadPeriodMillis:30*1e3,eventUploadThreshold:30,forceHttps:!0,includeFbclid:!1,includeGclid:!1,includeReferrer:!1,includeUtm:!1,ingestionMetadata:{sourceName:``,sourceVersion:``},language:Et.getLanguage(),library:{name:`amplitude-js`,version:kt},logLevel:`WARN`,logAttributionCapturedEvent:!1,optOut:!1,onError:function(){},onExitPage:function(){},onNewSessionStart:function(){},plan:{branch:``,source:``,version:``,versionId:``},platform:`Web`,savedMaxCount:1e3,saveEvents:!0,saveParamsReferrerOncePerSession:!0,secureCookie:!1,sessionTimeout:1800*1e3,storage:T.STORAGE_DEFAULT,trackingOptions:{city:!0,country:!0,carrier:!0,device_manufacturer:!0,device_model:!0,dma:!0,ip_address:!0,language:!0,os_name:!0,os_version:!0,platform:!0,region:!0,version_name:!0},transport:T.TRANSPORT_HTTP,unsetParamsReferrerOnNewSession:!1,unsentKey:`amplitude_unsent`,unsentIdentifyKey:`amplitude_unsent_identify`,uploadBatchSize:100,headers:{"Content-Type":`application/x-www-form-urlencoded; charset=UTF-8`,"Cross-Origin-Resource-Policy":`cross-origin`},serverZone:G.US,useDynamicConfig:!1,serverZoneBasedApi:!1,sessionId:null,partnerId:``},At= new(function(){function e(){return ye(this,e),e.instance||=(this.ingestionEndpoint=T.EVENT_LOG_URL,this),e.instance;}return xe(e,[{key:`refresh`,value:function(e,t,n){var r=`https`;(!t&&__get$(E,"location").protocol!==`https:`)&&(r=`http`);var i=r+`://`+Ot(e),a=this;if(E.XDomainRequest){var o=new E.XDomainRequest();o.open(`GET`,i,!0),o.onload=function(){a.ingestionEndpoint=JSON.parse(o.responseText).ingestionEndpoint,n&&n();},o.onerror=function(){},o.ontimeout=function(){},o.onprogress=function(){},o.send();}else{var s=new XMLHttpRequest();s.open(`GET`,i,!0),s.onreadystatechange=function(){(s.readyState===4&&s.status===200)&&(a.ingestionEndpoint=JSON.parse(s.responseText).ingestionEndpoint,n&&n());},s.send();}}}]),e;}())() ,q=function(e){!a()&&!N.isWebWorkerEnvironment()&&N.log.warn(`amplitude-js will not work in a non-browser environment. If you are planning to add Amplitude to a node environment, please use @amplitude/node`),this._instanceName=N.isEmptyString(e)?T.DEFAULT_INSTANCE:e.toLowerCase(),this._unsentEvents=[],this._unsentIdentifys=[],this.options=C(C({},K),{},{headers:C({},K.headers),ingestionMetadata:C({},K.ingestionMetadata),library:C({},K.library),plan:C({},K.plan),trackingOptions:C({},K.trackingOptions)}),this._q=[],this._sending=!1,this._updateScheduled=!1,this._onInitCallbacks=[],this._onNewSessionStartCallbacks=[],this._eventId=0,this._identifyId=0,this._lastEventTime=null,this._newSession=!1,this._sequenceNumber=0,this._sessionId=null,this._isInitialized=!1,this._connector=null,this._userAgent=typeof navigator<`u`&&navigator&&navigator.userAgent||null,this._ua=new ge.default(this._userAgent).getResult()};q.prototype.Identify=U,q.prototype.Revenue=W,q.prototype.init=function(e,t,n,i){var s=this;if(O(e)!==`string`||N.isEmptyString(e)){N.log.error(`Invalid apiKey. Please re-initialize with a valid apiKey`);return}try{this._connector=o.getInstance(this._instanceName),Mt(this.options,n),(a()||N.isWebWorkerEnvironment())&&E.Prototype!==void 0&&Array.prototype.toJSON&&(r(),N.log.warn(`Prototype.js injected Array.prototype.toJSON. Deleting Array.prototype.toJSON to prevent double-stringify`)),this.options.cookieName!==K.cookieName&&N.log.warn(`The cookieName option is deprecated. We will be ignoring it for newer cookies`),this.options.serverZoneBasedApi&&(this.options.apiEndpoint=Dt(this.options.serverZone)),this._refreshDynamicConfig(),this.options.apiKey=e,this._storageSuffix=`_`+e+(this._instanceName===T.DEFAULT_INSTANCE?``:`_`+this._instanceName),this._storageSuffixV5=e.slice(0,6),this._oldCookiename=this.options.cookieName+this._storageSuffix,this._unsentKey=this.options.unsentKey+this._storageSuffix,this._unsentIdentifyKey=this.options.unsentIdentifyKey+this._storageSuffix,this._cookieName=T.COOKIE_PREFIX+`_`+this._storageSuffixV5,this.cookieStorage=new ct().getStorage(this.options.disableCookies),this.cookieStorage.options({expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie}),this._metadataStorage=new ut({storageKey:this._cookieName,disableCookies:this.options.disableCookies,expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie,storage:this.options.storage});var c=!!this.cookieStorage.get(this._oldCookiename),l=!!this._metadataStorage.load();this._useOldCookie=!l&&c&&!this.options.cookieForceUpgrade;var u=l||c;if(this.options.deferInitialization&&!u){this._deferInitialization(e,t,n,i);return}this.options.domain=this.cookieStorage.options().domain,O(this.options.logLevel)===`string`&&N.setLogLevel(this.options.logLevel);var d=zt(this);this._apiPropertiesTrackingOptions=Object.keys(d).length>0?{tracking_options:d}:{},this.options.cookieForceUpgrade&&c&&(l||Pt(this),this.cookieStorage.remove(this._oldCookiename)),Nt(this),this._pendingReadStorage=!0,this.options.saveEvents&&(this._unsentEvents=this._loadSavedUnsentEvents(this.options.unsentKey).map(function(e){return{event:e}}).concat(this._unsentEvents),this._unsentIdentifys=this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).map(function(e){return{event:e}}).concat(this._unsentIdentifys)),n&&n.onNewSessionStart&&this.onNewSessionStart(this.options.onNewSessionStart),function(e){n&&n.deviceId&&!N.validateDeviceId(n.deviceId)&&(N.log.error(`Invalid device ID rejected. Randomly generated UUID will be used instead of "${n.deviceId}"`),delete n.deviceId),s.options.deviceId=s._getInitialDeviceId(n&&n.deviceId,e),s.options.userId=O(t)===`string`&&!N.isEmptyString(t)&&t||O(t)===`number`&&t.toString()||s.options.userId||null;var r=new Date().getTime(),i=!s._sessionId||!s._lastEventTime||r-s._lastEventTime>s.options.sessionTimeout||s.options.sessionId;i&&(s.options.unsetParamsReferrerOnNewSession&&s._unsetUTMParams(),s._newSession=!0,s._sessionId=s.options.sessionId||r,s.options.sessionId=void 0,s.options.saveParamsReferrerOncePerSession&&s._trackParamsAndReferrer()),s.options.saveParamsReferrerOncePerSession||s._trackParamsAndReferrer(),s.options.saveEvents&&(jt(s._unsentEvents),jt(s._unsentIdentifys)),s._lastEventTime=r,J(s),s._pendingReadStorage=!1,s._sendEventsIfReady();for(var a=0;a<s._onInitCallbacks.length;a++) __call$(s._onInitCallbacks,a,[s]) ;s._onInitCallbacks=[],s._isInitialized=!0,i&&s._runNewSessionStartCallbacks()}(),this.runQueuedFunctions(),O(i)===`function`&&i(this);var f=this.options.onExitPage;if(O(f)===`function`&&E.addEventListener&&!this.pageHandlersAdded){this.pageHandlersAdded=!0;var p=function(){var e=s.options.transport;s.setTransport(T.TRANSPORT_BEACON),f(),s.setTransport(e)};E.addEventListener(`pagehide`,function(){p()},!1)}this._connector.eventBridge.setEventReceiver(function(e){s._logEvent(e.eventType,e.eventProperties,e.userProperties)});var m=this._connector.identityStore.editIdentity();this.options.deviceId&&m.setDeviceId(this.options.deviceId),this.options.userId&&m.setUserId(this.options.userId),m.commit()}catch(e){N.log.error(e),n&&O(n.onError)===`function`&&n.onError(e)}},q.prototype._runNewSessionStartCallbacks=function(){for(var e=0;e<this._onNewSessionStartCallbacks.length;e++) __call$(this._onNewSessionStartCallbacks,e,[this]) },q.prototype.deleteLowerLevelDomainCookies=function(){var e=N.getHost(),t=this.options.domain&&this.options.domain[0]===`.`?this.options.domain.slice(1):this.options.domain;if(!(!t||!N.isWebWorkerEnvironment())&&e!==t&&RegExp(t+`$`).test(e)){for(var n=e.split(`.`),r=t.split(`.`),i=n.length;i>r.length;--i){var a=n.slice(n.length-i).join(`.`);P.set(this._cookieName,null,{domain:`.`+a})}P.set(this._cookieName,null,{})}},q.prototype._getInitialDeviceId=function(e,t){if(e)return e;if(this.options.deviceIdFromUrlParam){var n=this._getDeviceIdFromUrlParam(this._getUrlParams());if(n)return n}return this.options.deviceId?this.options.deviceId:t||F()};var jt=function(e){for(var t=0;t<e.length;t++){var n= __get$(e,t) .event.user_properties,r= __get$(e,t) .event.event_properties,i= __get$(e,t) .event.groups; __get$(e,t) .event.user_properties=N.validateProperties(n), __get$(e,t) .event.event_properties=N.validateProperties(r), __get$(e,t) .event.groups=N.validateGroups(i)}};q.prototype._trackParamsAndReferrer=function(){var e,t,n,r;if(this.options.includeUtm&&(e=this._initUtmData()),this.options.includeReferrer&&(t=this._saveReferrer(this._getReferrer())),this.options.includeGclid&&(n=this._saveGclid(this._getUrlParams())),this.options.includeFbclid&&(r=this._saveFbclid(this._getUrlParams())),this.options.logAttributionCapturedEvent){var i=C(C(C(C({},e),t),n),r);Object.keys(i).length>0&&this.logEvent(T.ATTRIBUTION_EVENT,i)}};var Mt=function e(t,n){if(O(n)===`object`){var r=new Set([`headers`]),i=new Set([`eventUploadPeriodMillis`]),a=function(r){if(Object.prototype.hasOwnProperty.call(t,r)){var a= __get$(n,r) ,o=O( __get$(t,r) );if(!(r===`transport`&&!N.validateTransport(a))){if(r===`sessionId`&&a!==null){ __set$(t,r,N.validateSessionId(a)?a:null) ;return}else if(!N.validateInput(a,r+` option`,o))return;o===`boolean`? __set$(t,r,!!a) :o===`string`&&!N.isEmptyString(a)||o===`number`&&(a>0||a===0&&i.has(r))||o===`function`? __set$(t,r,a) :o===`object`&&e( __get$(t,r) ,a)}}};for(var o in n)r.has(o)? __set$(t,o,C(C({},__get$(t,o)),__get$(n,o))) :Object.prototype.hasOwnProperty.call(n,o)&&a(o)}};q.prototype.runQueuedFunctions=function(){var e=this._q;this._q=[];for(var t=0;t<e.length;t++){var n= __get$(this,__get$(e,t)[0]) ;O(n)===`function`&&n.apply(this, __get$(e,t) .slice(1))}},q.prototype._apiKeySet=function(e){return N.isEmptyString(this.options.apiKey)?(N.log.error(`Invalid apiKey. Please set a valid apiKey with init() before calling `+e),!1):!0},q.prototype._loadSavedUnsentEvents=function(e){var t=this._getFromStorage(V,e),n=this._parseSavedUnsentEventsString(t,e);return this._setInStorage(V,e,JSON.stringify(n)),n},q.prototype._parseSavedUnsentEventsString=function(e,t){if(N.isEmptyString(e))return[];if(O(e)===`string`)try{var n=JSON.parse(e);if(O(n)===`array`)return n}catch{}return N.log.error(`Unable to load `+t+` events. Restart with a new empty queue.`),[]},q.prototype.isNewSession=function(){return this._newSession},q.prototype.onInit=function(e){this._isInitialized?e(this):this._onInitCallbacks.push(e)},q.prototype.onNewSessionStart=function(e){this._onNewSessionStartCallbacks.push(e)},q.prototype.getSessionId=function(){return this._sessionId},q.prototype.nextEventId=function(){return this._eventId++,this._eventId},q.prototype.nextIdentifyId=function(){return this._identifyId++,this._identifyId},q.prototype.nextSequenceNumber=function(){return this._sequenceNumber++,this._sequenceNumber},q.prototype._unsentCount=function(){return this._unsentEvents.length+this._unsentIdentifys.length},q.prototype._sendEventsIfReady=function(){return this._unsentCount()===0?!1:!this.options.batchEvents||this._unsentCount()>=this.options.eventUploadThreshold||this.options.transport===T.TRANSPORT_BEACON?(this.sendEvents(),!0):(this._updateScheduled||(this._updateScheduled=!0,setTimeout(function(){this._updateScheduled=!1,this.sendEvents()}.bind(this),this.options.eventUploadPeriodMillis)),!1)},q.prototype.clearStorage=function(){return this._metadataStorage.clear()},q.prototype._getFromStorage=function(e,t){return e.getItem(t+this._storageSuffix)},q.prototype._setInStorage=function(e,t,n){e.setItem(t+this._storageSuffix,n)};var Nt=function(e){if(!e._useOldCookie){var t=e._metadataStorage.load();O(t)===`object`&&Ft(e,t);return}var n=e.cookieStorage.get(e._oldCookiename);if(O(n)===`object`){Ft(e,n);return}},Pt=function(e){var t=e.cookieStorage.get(e._oldCookiename);O(t)===`object`&&(Ft(e,t),J(e))},Ft=function(e,t){t.deviceId&&(e.options.deviceId=t.deviceId),t.userId&&(e.options.userId=t.userId),t.optOut!==null&&t.optOut!==void 0&&t.optOut!==!1&&(e.options.optOut=t.optOut),t.sessionId&&(e._sessionId=parseInt(t.sessionId,10)),t.lastEventTime&&(e._lastEventTime=parseInt(t.lastEventTime,10)),t.eventId&&(e._eventId=parseInt(t.eventId,10)),t.identifyId&&(e._identifyId=parseInt(t.identifyId,10)),t.sequenceNumber&&(e._sequenceNumber=parseInt(t.sequenceNumber,10))},J=function(e){var t={deviceId:e.options.deviceId,userId:e.options.userId,optOut:e.options.optOut,sessionId:e._sessionId,lastEventTime:e._lastEventTime,eventId:e._eventId,identifyId:e._identifyId,sequenceNumber:e._sequenceNumber};e._useOldCookie?e.cookieStorage.set(e.options.cookieName+e._storageSuffix,t):e._metadataStorage.save(t)};q.prototype._initUtmData=function(e,t){e||=this._getUrlParams(),t||=this.cookieStorage.get(`__utmz`);var n=dt(t,e);return Y(this,n),n},q.prototype._unsetUTMParams=function(){var e=new U;e.unset(T.REFERRER),e.unset(T.REFERRING_DOMAIN),e.unset(T.UTM_SOURCE),e.unset(T.UTM_MEDIUM),e.unset(T.UTM_CAMPAIGN),e.unset(T.UTM_TERM),e.unset(T.UTM_CONTENT),this.identify(e)};var Y=function(e,t){if(!(O(t)!==`object`||Object.keys(t).length===0)){var n=new U;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n.setOnce(`initial_`+r, __get$(t,r) ),n.set(r, __get$(t,r) ));e.identify(n)}};q.prototype._getReferrer=function(){return this._getReferrerFromUrlParam(this._getUrlParams())||(typeof document<`u`?document.referrer:``)},q.prototype._getUrlParams=function(){return  __get$(E,"location") .search},q.prototype._saveGclid=function(e){var t=N.getQueryParam(`gclid`,e);if(!N.isEmptyString(t)){var n={gclid:t};return Y(this,n),n}},q.prototype._saveFbclid=function(e){var t=N.getQueryParam(`fbclid`,e);if(!N.isEmptyString(t)){var n={fbclid:t};return Y(this,n),n}},q.prototype._getDeviceIdFromUrlParam=function(e){return N.getQueryParam(T.AMP_DEVICE_ID_PARAM,e)},q.prototype._getReferrerFromUrlParam=function(e){return N.getQueryParam(T.AMP_REFERRER_PARAM,e)},q.prototype._getReferringDomain=function(e){if(N.isEmptyString(e))return null;var t=e.split(`/`);return t.length>=3?t[2]:null},q.prototype._saveReferrer=function(e){if(!N.isEmptyString(e)){var t={referrer:e,referring_domain:this._getReferringDomain(e)};return Y(this,t),t}},q.prototype.saveEvents=function(){try{var e=JSON.stringify(this._unsentEvents.map(function(e){return e.event}));this._setInStorage(V,this.options.unsentKey,e)}catch{}try{var t=JSON.stringify(this._unsentIdentifys.map(function(e){return e.event}));this._setInStorage(V,this.options.unsentIdentifyKey,t)}catch{}},q.prototype.setDomain=function(e){if(this._shouldDeferCall())return this._q.push([`setDomain`].concat(Array.prototype.slice.call(arguments,0)));if(N.validateInput(e,`domain`,`string`))try{this.cookieStorage.options({expirationDays:this.options.cookieExpiration,secure:this.options.secureCookie,domain:e,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,Nt(this),J(this)}catch(e){N.log.error(e)}},q.prototype.setUserId=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(N.validateInput(t,`startNewSession`,`boolean`)){if(this._shouldDeferCall())return this._q.push([`setUserId`].concat(Array.prototype.slice.call(arguments,0)));try{this.options.userId=e!=null&&``+e||null,t&&(this.options.unsetParamsReferrerOnNewSession&&this._unsetUTMParams(),this._newSession=!0,this._sessionId=new Date().getTime(),this._runNewSessionStartCallbacks(),this.options.saveParamsReferrerOncePerSession&&this._trackParamsAndReferrer()),J(this),this._connector&&this._connector.identityStore.editIdentity().setUserId(this.options.userId).commit()}catch(e){N.log.error(e)}}},q.prototype.setGroup=function(e,t){if(this._shouldDeferCall())return this._q.push([`setGroup`].concat(Array.prototype.slice.call(arguments,0)));if(!(!this._apiKeySet(`setGroup()`)||!N.validateInput(e,`groupType`,`string`)||N.isEmptyString(e))){var n={}; __set$(n,e,t) ;var r=new U().set(e,t);this._logEvent(T.IDENTIFY_EVENT,null,null,r.userPropertiesOperations,n,null,null,null)}},q.prototype.setOptOut=function(e){if(this._shouldDeferCall())return this._q.push([`setOptOut`].concat(Array.prototype.slice.call(arguments,0)));if(N.validateInput(e,`enable`,`boolean`))try{this.options.optOut=e,J(this)}catch(e){N.log.error(e)}},q.prototype.setSessionId=function(e){if(N.validateInput(e,`sessionId`,`number`))try{this._sessionId=e,J(this)}catch(e){N.log.error(e)}},q.prototype.resetSessionId=function(){this.setSessionId(new Date().getTime())},q.prototype.regenerateDeviceId=function(){if(this._shouldDeferCall())return this._q.push([`regenerateDeviceId`].concat(Array.prototype.slice.call(arguments,0)));this.setDeviceId(F())},q.prototype.setDeviceId=function(e){if(this._shouldDeferCall())return this._q.push([`setDeviceId`].concat(Array.prototype.slice.call(arguments,0)));if(N.validateDeviceId(e))try{N.isEmptyString(e)||(this.options.deviceId=``+e,J(this),this._connector&&this._connector.identityStore.editIdentity().setDeviceId(this.options.deviceId).commit())}catch(e){N.log.error(e)}},q.prototype.setTransport=function(e){if(this._shouldDeferCall())return this._q.push([`setTransport`].concat(Array.prototype.slice.call(arguments,0)));N.validateTransport(e)&&(this.options.transport=e)},q.prototype.setUserProperties=function(e){if(this._shouldDeferCall())return this._q.push([`setUserProperties`].concat(Array.prototype.slice.call(arguments,0)));if(!(!this._apiKeySet(`setUserProperties()`)||!N.validateInput(e,`userProperties`,`object`))){var t=N.truncate(N.validateProperties(e));if(Object.keys(t).length!==0){var n=new U;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.set(r, __get$(t,r) );this.identify(n)}}},q.prototype.clearUserProperties=function(){if(this._shouldDeferCall())return this._q.push([`clearUserProperties`].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet(`clearUserProperties()`)){var e=new U;e.clearAll(),this.identify(e)}};var It=function(e,t){for(var n=0;n<t._q.length;n++){var r= __get$(e,__get$(t._q,n)[0]) ;O(r)===`function`&&r.apply(e, __get$(t._q,n) .slice(1))}return e};q.prototype.identify=function(e,t,n,r){if(this._shouldDeferCall())return this._q.push([`identify`].concat(Array.prototype.slice.call(arguments,0)));if(!this._apiKeySet(`identify()`)){Z(t,n,0,`No request sent`,{reason:`API key is not set`});return}if(O(e)===`object`&&Object.prototype.hasOwnProperty.call(e,`_q`)&&(e=It(new U,e)),e instanceof U){if(Object.keys(e.userPropertiesOperations).length>0)return this._logEvent(T.IDENTIFY_EVENT,null,null,e.userPropertiesOperations,null,null,null,t,n,r);Z(t,n,0,`No request sent`,{reason:`No user property operations`})}else N.log.error(`Invalid identify input type. Expected Identify object but saw `+O(e)),Z(t,n,0,`No request sent`,{reason:`Invalid identify input type`})},q.prototype.groupIdentify=function(e,t,n,r,i,a){if(this._shouldDeferCall())return this._q.push([`groupIdentify`].concat(Array.prototype.slice.call(arguments,0)));if(!this._apiKeySet(`groupIdentify()`)){Z(r,i,0,`No request sent`,{reason:`API key is not set`});return}if(!N.validateInput(e,`group_type`,`string`)||N.isEmptyString(e)){Z(r,i,0,`No request sent`,{reason:`Invalid group type`});return}if(t==null){Z(r,i,0,`No request sent`,{reason:`Invalid group name`});return}if(O(n)===`object`&&Object.prototype.hasOwnProperty.call(n,`_q`)&&(n=It(new U,n)),n instanceof U){if(Object.keys(n.userPropertiesOperations).length>0)return this._logEvent(T.GROUP_IDENTIFY_EVENT,null,null,null,w({},e,t),n.userPropertiesOperations,null,r,i,a);Z(r,i,0,`No request sent`,{reason:`No group property operations`})}else N.log.error(`Invalid identify input type. Expected Identify object but saw `+O(n)),Z(r,i,0,`No request sent`,{reason:`Invalid identify input type`})},q.prototype.setVersionName=function(e){if(this._shouldDeferCall())return this._q.push([`setVersionName`].concat(Array.prototype.slice.call(arguments,0)));N.validateInput(e,`versionName`,`string`)&&(this.options.versionName=e)},q.prototype._logEvent=function(e,t,n,r,i,a,o,s,c,l){if(Nt(this),!e){Z(s,c,0,`No request sent`,{reason:`Missing eventType`});return}if(this.options.optOut){Z(s,c,0,`No request sent`,{reason:`optOut is set to true`});return}try{var u=e===T.IDENTIFY_EVENT||e===T.GROUP_IDENTIFY_EVENT?this.nextIdentifyId():this.nextEventId(),d=this.nextSequenceNumber(),f=O(o)===`number`?o:new Date().getTime();l?this._sessionId=-1:(!this._sessionId||!this._lastEventTime||f-this._lastEventTime>this.options.sessionTimeout)&&(this._sessionId=f,this._runNewSessionStartCallbacks()),this._lastEventTime=f,J(this);var p=this._ua.browser.name,m=this._ua.browser.major,h=this._ua.device.model||this._ua.os.name,g=this._ua.device.vendor;r||={};var ee=C({},this._apiPropertiesTrackingOptions);n=C(C({},n||{}),ee),t||={},i||={},a||={};var _={device_id:this.options.deviceId,user_id:this.options.userId,timestamp:f,event_id:u,session_id:this._sessionId||-1,event_type:e,version_name:this.options.versionName||null,platform:X(this,`platform`)?this.options.platform:null,os_name:X(this,`os_name`)&&p||null,os_version:X(this,`os_version`)&&m||null,device_model:X(this,`device_model`)&&h||null,device_manufacturer:X(this,`device_manufacturer`)&&g||null,language:X(this,`language`)?this.options.language:null,api_properties:n,event_properties:N.truncate(N.validateProperties(t)),user_properties:N.truncate(N.validateProperties(r)),uuid:Tt(),library:this.options.library,sequence_number:d,groups:N.truncate(N.validateGroups(i)),group_properties:N.truncate(N.validateProperties(a)),user_agent:this._userAgent,partner_id:this.options.partnerId||null};return Lt(this)&&(_.plan={branch:this.options.plan.branch||void 0,source:this.options.plan.source||void 0,version:this.options.plan.version||void 0,versionId:this.options.plan.versionId||void 0}),Rt(this)&&(_.ingestion_metadata={source_name:this.options.ingestionMetadata.sourceName||void 0,source_version:this.options.ingestionMetadata.sourceVersion||void 0}),e===T.IDENTIFY_EVENT||e===T.GROUP_IDENTIFY_EVENT?(this._unsentIdentifys.push({event:_,callback:s,errorCallback:c}),this._limitEventsQueued(this._unsentIdentifys)):(this._unsentEvents.push({event:_,callback:s,errorCallback:c}),this._limitEventsQueued(this._unsentEvents)),this.options.saveEvents&&this.saveEvents(),this._sendEventsIfReady(),e===T.IDENTIFY_EVENT&&this._connector&&this._connector.identityStore.editIdentity().updateUserProperties(N.truncate(N.validateProperties(r))).commit(),u}catch(e){N.log.error(e)}};var Lt=function(e){return e.options.plan&&(e.options.plan.source||e.options.plan.branch||e.options.plan.version||e.options.plan.versionId)},Rt=function(e){return e.options.ingestionMetadata&&(e.options.ingestionMetadata.sourceName||e.options.ingestionMetadata.sourceVersion)},X=function(e,t){return!! __get$(e.options.trackingOptions,t) },zt=function(e){for(var t=[`city`,`country`,`dma`,`ip_address`,`region`],n={},r=0;r<t.length;r++){var i= __get$(t,r) ;X(e,i)||( __set$(n,i,!1) )}return n};q.prototype._limitEventsQueued=function(e){e.length>this.options.savedMaxCount&&e.splice(0,e.length-this.options.savedMaxCount).forEach(function(e){Z(e.callback,e.errorCallback,0,`No request sent`,{reason:`Event dropped because options.savedMaxCount exceeded. User may be offline or have a content blocker`})})},q.prototype.logEvent=function(e,t,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return this._shouldDeferCall()?this._q.push([`logEvent`].concat(Array.prototype.slice.call(arguments,0))):this.logEventWithTimestamp(e,t,null,n,r,i)},q.prototype.logEventWithTimestamp=function(e,t,n,r,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;return this._shouldDeferCall()?this._q.push([`logEventWithTimestamp`].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet(`logEvent()`)?N.validateInput(e,`eventType`,`string`)?N.isEmptyString(e)?(Z(r,i,0,`No request sent`,{reason:`Missing eventType`}),-1):(N.validateInput(a,`outOfSession`,`boolean`)||Z(r,i,0,`No request sent`,{reason:`Invalid outOfSession value`}),this._logEvent(e,t,null,null,null,null,n,r,i,a)):(Z(r,i,0,`No request sent`,{reason:`Invalid type for eventType`}),-1):(Z(r,i,0,`No request sent`,{reason:`API key not set`}),-1)},q.prototype.logEventWithGroups=function(e,t,n,r,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;return this._shouldDeferCall()?this._q.push([`logEventWithGroups`].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet(`logEventWithGroups()`)?N.validateInput(e,`eventType`,`string`)?(N.validateInput(a,`outOfSession`,`boolean`)||Z(event.callback,event.errorCallback,0,`No request sent`,{reason:`Invalid outOfSession value`}),this._logEvent(e,t,null,null,n,null,null,r,i,a)):(Z(event.callback,event.errorCallback,0,`No request sent`,{reason:`Invalid type for eventType`}),-1):(Z(event.callback,event.errorCallback,0,`No request sent`,{reason:`API key not set`}),-1)};var Bt=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},Z=function(e,t,n,r,i){O(e)===`function`&&e(n,r,i),O(t)===`function`&&t(n,r,i)};q.prototype.logRevenueV2=function(e){if(this._shouldDeferCall())return this._q.push([`logRevenueV2`].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet(`logRevenueV2()`))if(O(e)===`object`&&Object.prototype.hasOwnProperty.call(e,`_q`)&&(e=It(new W,e)),e instanceof W){if(e&&e._isValidRevenue())return this.logEvent(T.REVENUE_EVENT,e._toJSONObject())}else N.log.error(`Invalid revenue input type. Expected Revenue object but saw `+O(e))},q.prototype.logRevenue=function(e,t,n){return this._shouldDeferCall()?this._q.push([`logRevenue`].concat(Array.prototype.slice.call(arguments,0))):!this._apiKeySet(`logRevenue()`)||!Bt(e)||t!==void 0&&!Bt(t)?-1:this._logEvent(T.REVENUE_EVENT,{},{productId:n,special:`revenue_amount`,quantity:t||1,price:e},null,null,null,null,null)},q.prototype._logErrorsOnEvents=function(e,t,n,r){for(var i=[`_unsentEvents`,`_unsentIdentifys`],a=0;a<i.length;a++)for(var o= __get$(i,a) ,s=o===`_unsentEvents`?e:t,c=0;c< __get$(this,o) .length;c++){var l= __get$(__get$(this,o),c) ;l.event.event_id<=s&&l.errorCallback&&l.errorCallback(n,r)}},q.prototype.removeEvents=function(e,t,n,r){Vt(this,`_unsentEvents`,e,n,r),Vt(this,`_unsentIdentifys`,t,n,r)};var Vt=function(e,t,n,r,i){if(!(n<0)){for(var a=[],o=0;o< __get$(e,t) .length;o++){var s= __get$(__get$(e,t),o) ;s.event.event_id>n?a.push(s):s.callback&&s.callback(r,i)} __set$(e,t,a) }};q.prototype.sendEvents=function(){if(!this._apiKeySet(`sendEvents()`)){this.removeEvents(1/0,1/0,0,`No request sent`,{reason:`API key not set`});return}if(this.options.optOut){this.removeEvents(1/0,1/0,0,`No request sent`,{reason:`Opt out is set to true`});return}if(this._unsentCount()!==0){if(this.options.transport!==T.TRANSPORT_BEACON){if(this._sending)return;this._sending=!0}var e=(this.options.forceHttps|| __get$(E,"location") .protocol===`https:`?`https`:`http`)+`://`+this.options.apiEndpoint,t=Math.min(this._unsentCount(),this.options.uploadBatchSize),n=this._mergeEventsAndIdentifys(t),r=n.maxEventId,i=n.maxIdentifyId,a=JSON.stringify(n.eventsToSend.map(function(e){return e.event})),o=new Date().getTime(),s={client:this.options.apiKey,e:a,v:T.API_VERSION,upload_time:o,checksum:(0,he.default)(T.API_VERSION+this.options.apiKey+a+o)};if(this.options.transport===T.TRANSPORT_BEACON&&typeof navigator<`u`){navigator.sendBeacon(e,new URLSearchParams(s))?(this.removeEvents(r,i,200,`success`),this.options.saveEvents&&this.saveEvents()):this._logErrorsOnEvents(r,i,0,``);return}var c=this;try{new St(e,s,this.options.headers).send(function(e,n){c._sending=!1;try{e===200?(c.removeEvents(r,i,e,n),c.options.saveEvents&&c.saveEvents(),c._sendEventsIfReady()):(c._logErrorsOnEvents(r,i,e,n),e===413&&(c.options.uploadBatchSize===1&&c.removeEvents(r,i,e,n),c.options.uploadBatchSize=Math.ceil(t/2),c.sendEvents()))}catch{}})}catch(e){var l=0,u=`Request failed to send`;N.log.error(u),c._logErrorsOnEvents(r,i,l,u),c.removeEvents(r,i,l,u,{reason:e.message})}}},q.prototype._mergeEventsAndIdentifys=function(e){for(var t=[],n=0,r=-1,i=0,a=-1;t.length<e;){var o=void 0,s=i>=this._unsentIdentifys.length,c=n>=this._unsentEvents.length;if(c&&s){N.log.error(`Merging Events and Identifys, less events and identifys than expected`);break}else s?(o= __get$(this._unsentEvents,n++) ,r=o.event.event_id):c?(o= __get$(this._unsentIdentifys,i++) ,a=o.event.event_id):!(`sequence_number`in  __get$(this._unsentEvents,n) .event)|| __get$(this._unsentEvents,n) .event.sequence_number< __get$(this._unsentIdentifys,i) .event.sequence_number?(o= __get$(this._unsentEvents,n++) ,r=o.event.event_id):(o= __get$(this._unsentIdentifys,i++) ,a=o.event.event_id);t.push(o)}return{eventsToSend:t,maxEventId:r,maxIdentifyId:a}},q.prototype.setGlobalUserProperties=function(e){this.setUserProperties(e)},q.prototype.__VERSION__=function(){return this.options.library.version},q.prototype.setLibrary=function(e,t){e!=null&&(this.options.library.name=e),t!=null&&(this.options.library.version=t)},q.prototype._shouldDeferCall=function(){return this._pendingReadStorage||this._initializationDeferred},q.prototype._deferInitialization=function(){this._initializationDeferred=!0,this._q.push([`init`].concat(Array.prototype.slice.call(arguments,0)))},q.prototype.enableTracking=function(){this._initializationDeferred=!1,J(this),this.runQueuedFunctions()},q.prototype._refreshDynamicConfig=function(){this.options.useDynamicConfig&&At.refresh(this.options.serverZone,this.options.forceHttps,function(){this.options.apiEndpoint=At.ingestionEndpoint}.bind(this))},q.prototype.getDeviceId=function(){return this.options.deviceId},q.prototype.getUserId=function(){return this.options.userId},q.prototype.setMinTimeBetweenSessionsMillis=function(e){if(N.validateInput(e,`timeInMillis`,`number`)){if(this._shouldDeferCall())return this._q.push([`setMinTimeBetweenSessionsMillis`].concat(Array.prototype.slice.call(arguments,0)));try{this.options.sessionTimeout=e}catch(e){N.log.error(e)}}},q.prototype.setEventUploadThreshold=function(e){if(N.validateInput(e,`eventUploadThreshold`,`number`)){if(this._shouldDeferCall())return this._q.push([`setEventUploadThreshold`].concat(Array.prototype.slice.call(arguments,0)));try{this.options.eventUploadThreshold=e}catch(e){N.log.error(e)}}},q.prototype.setUseDynamicConfig=function(e){if(N.validateInput(e,`useDynamicConfig`,`boolean`)){if(this._shouldDeferCall())return this._q.push([`setUseDynamicConfig`].concat(Array.prototype.slice.call(arguments,0)));try{this.options.useDynamicConfig=e,this._refreshDynamicConfig()}catch(e){N.log.error(e)}}},q.prototype.setServerZone=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(e!==G.EU&&e!==G.US||!N.validateInput(t,`serverZoneBasedApi`,`boolean`))){if(this._shouldDeferCall())return this._q.push([`setServerZone`].concat(Array.prototype.slice.call(arguments,0)));try{this.options.serverZone=e,this.options.serverZoneBasedApi=t,t&&(this.options.apiEndpoint=Dt(this.options.serverZone))}catch(e){N.log.error(e)}}},q.prototype.setServerUrl=function(e){if(N.validateInput(e,`serverUrl`,`string`)){if(this._shouldDeferCall())return this._q.push([`setServerUrl`].concat(Array.prototype.slice.call(arguments,0)));try{this.options.apiEndpoint=e}catch(e){N.log.error(e)}}};var Q=function(){this.options=C({},K),this._q=[],this._instances={}};Q.prototype.Identify=U,Q.prototype.Revenue=W,Q.prototype.getInstance=function(e){e=N.isEmptyString(e)?T.DEFAULT_INSTANCE:e.toLowerCase();var t= __get$(this._instances,e) ;return t===void 0&&(t=new q(e), __set$(this._instances,e,t) ),t},Q.prototype.init=function(e,t,n,r){this.getInstance().init(e,t,n,function(e){this.options=e.options,O(r)===`function`&&r(e)}.bind(this))},Q.prototype.isNewSession=function(){return this.getInstance().isNewSession()},Q.prototype.getSessionId=function(){return this.getInstance().getSessionId()},Q.prototype.nextEventId=function(){return this.getInstance().nextEventId()},Q.prototype.nextIdentifyId=function(){return this.getInstance().nextIdentifyId()},Q.prototype.nextSequenceNumber=function(){return this.getInstance().nextSequenceNumber()},Q.prototype.saveEvents=function(){this.getInstance().saveEvents()},Q.prototype.setDomain=function(e){this.getInstance().setDomain(e)},Q.prototype.setUserId=function(e){this.getInstance().setUserId(e)},Q.prototype.setGroup=function(e,t){this.getInstance().setGroup(e,t)},Q.prototype.setOptOut=function(e){this.getInstance().setOptOut(e)},Q.prototype.regenerateDeviceId=function(){this.getInstance().regenerateDeviceId()},Q.prototype.setDeviceId=function(e){this.getInstance().setDeviceId(e)},Q.prototype.setUserProperties=function(e){this.getInstance().setUserProperties(e)},Q.prototype.clearUserProperties=function(){this.getInstance().clearUserProperties()},Q.prototype.identify=function(e,t){this.getInstance().identify(e,t)},Q.prototype.setVersionName=function(e){this.getInstance().setVersionName(e)},Q.prototype.logEvent=function(e,t,n){return this.getInstance().logEvent(e,t,n)},Q.prototype.logEventWithGroups=function(e,t,n,r){return this.getInstance().logEventWithGroups(e,t,n,r)},Q.prototype.logRevenueV2=function(e){return this.getInstance().logRevenueV2(e)},Q.prototype.logRevenue=function(e,t,n){return this.getInstance().logRevenue(e,t,n)},Q.prototype.removeEvents=function(e,t){this.getInstance().removeEvents(e,t)},Q.prototype.sendEvents=function(e){this.getInstance().sendEvents(e)},Q.prototype.setGlobalUserProperties=function(e){this.getInstance().setUserProperties(e)},Q.prototype.__VERSION__=kt;var $=E!==void 0&&E.amplitude||{},Ht=new Q;for(var Ut in Ht._q=$._q||[],$._iq)Object.prototype.hasOwnProperty.call($._iq,Ut)&&(Ht.getInstance(Ut)._q= __get$($._iq,Ut) ._q||[]);export{Ht as t};
/*hammerhead|script|end*/